(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1448:function(z,E,b){function a(rc){var gd=Wd.call(this)||this;gd.Dn=null;gd.$t=null;gd.oPa=function(){gd.Dn.AIb(gd.oPa);db.ULS.sendTraceTag(537162849,0,50,"ExcelLiveManager::OnRealTimeChannelInitialized");gd.Eb(gd.$.da.Aa(473)||new n(gd.$,gd.Dn,gd.$t))};gd.$=rc;gd.Tb();return gd}function c(rc){var gd=he.call(this)||this;gd.jw=null;gd.BJa=null;gd.AJa=null;gd.QAb=!1;gd.LMa=null;gd.Nkc="ExcelLiveController::";gd.$=rc;gd.QAb=
nc.g(gd.$);gd.Sai();return gd}function e(rc,gd){gd=void 0===gd?null:gd;this.container=null;this.Um=0;this.dQa=null;this.Ug=!1;gd&&(this.$=rc,this.initialize(gd),this.Ug=ob.AFrameworkApplication.sa.Pa.Ug)}function f(rc,gd){var kd=this;gd=void 0===gd?null:gd;this.Poa=null;this.FXd=this.$Ue=!0;this.container=null;this.Um=0;this.dQa=this.Jza=null;this.lastUpdateTime=0;this.$=null;this.O5h=function(){kd.FXd||(kd.XRf(),kd.FXd=!0,kd.container.classList.remove("ewa-excelLive-meetingPill-container-hidden"))};
gd&&this.initialize(rc,gd);this.$=rc}function m(rc){this.cfe=this.bfe=this.afe=null;this.uee=void 0;this.$=rc}function n(rc,gd,kd){this.oqa=this.Rib=this.vlb=this.gjb=null;this.$=rc;this.Ffe=gd;this.eo=new w(this.$,kd);this.A2=Object(pc.a)(271,this.Dn.Hj);nc.g(this.$)&&(this.Zc=this.Zc.bind(this),this.zoc=this.zoc.bind(this),this.A2.eGa(this.zoc),this.$.Zk(this.Zc));this.oqa=kd;this.E$h()}function w(rc,gd){this.Jwd=this.lVf=0;this.pkd=!1;this.Jwd=mb.HelperMethods.Zb();this.$=rc;this.$t=gd;this.ZMd=
new Map;this.vJb=new Map;this.Puc=new Map;this.tVf=this.k0j}function h(rc,gd,kd){this.controller=this.e0=null;this.BDi=1E4;this.cDb=0;this.$=rc;this.gridView=Yb.g(this.$);this.eo=new y(this.$);this.realtimeChannel=gd;this.controller=kd;this.tpb();this.gqj();this.JFj()}function y(rc){this.asb=this.KRa=this.gJf=0;this.Fbd=Number.MAX_SAFE_INTEGER;this.lBb=Number.MIN_SAFE_INTEGER;this.cDb=0;this.$=rc;this.gJf=mb.HelperMethods.Zb();this.AWd=new M}function r(rc,gd,kd){this.Nkc="ExcelLiveParticipantV0";
this.viewBlockContainerHelpers=this.kPb=this.h7=null;this.opd=this.bNa=!1;this.b3a=0;this.wTe=10;this.xTe=500;this.yTe=3E4;this.wla=0;this.$t=kd;this.realtimeChannel=gd;this.$=rc;this.gridView=Yb.g(rc);this.Odc=this.Odc.bind(this);this.zma=this.zma.bind(this);this.wTe=this.$.ya.FetchPresenterNavigationStateMaxRetries;this.xTe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.yTe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.initialize()}function x(rc,gd,kd){this.statusBarManager=
null;this.Iaa=new u;this.mtd=this.TGb=null;this.XZ=this.UGb=0;this.sTe=10;this.tTe=1E3;this.uTe=3E4;this.e0d=.98;this.Uwa=this.w6a=this.Lgc=this.nzb=this.Yod=this.ozb=this.nNa=this.npd=!1;this.Ltd=null;this.exa=this.sqd=!1;var Qc=mb.HelperMethods.Zb();this.controller=kd;this.realtimeChannel=gd;this.$=rc;this.gridView=Yb.g(rc);this.eo=new C(this.$,Qc,3);this.statusBarManager=new B(this.$,this.Iaa);this.e0d=this.$.ya.ExcelLiveViewportRoundOffFactor;this.sTe=this.$.ya.FetchPresenterNavigationStateMaxRetries;
this.tTe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.uTe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.exa=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:6175128_ExcelLiveExploreTransitionsFix");this.tpb();this.IMg();this.Uzc()}function t(rc){rc=rc.endsWith("_Vacs")?rc.split("_",1)[0]:rc;return!hb.has(rc)}function u(){return Cb.call(this)||this}function B(rc,gd){var kd=tb.call(this)||this;kd.statusBarManager=null;kd.X5b=2;kd.Sqc=null;kd.fFf=function(Qc,de){kd.X5b=de.X5b;
kd.Sqc=de.Sqc;kd.Qz()};kd.$=rc;kd.$.da.$a(29,function(Qc){kd.statusBarManager=Qc;Qc.EJ(kd)});kd.Iaa=gd;kd.Iaa.eIg(kd.fFf);return kd}function v(rc,gd){var kd=La.call(this)||this;kd.X5b=rc;kd.Sqc=gd;return kd}function C(rc,gd,kd){this.SSe=this.vtf=this.utf=this.kcd=this.NVe=this.Agg=this.wDc=this.qad=this.RSe=this.fGb=0;this.Ujc=void 0;this.erc=this.Jjc=this.Ekf=this.z$b=this.Ibd=this.MGb=this.Klc=this.W0d=this.MVd=0;this.$=rc;this.fGb=gd;this.Fuc=new Map;this.Fuc[ua[kd]]=1;this.tIa=kd;this.erc=gd;
this.RMd=new Map;this.Guc=new Map;this.brf=new M}function A(rc,gd){db.ULS.sendTraceTag(523015437,0,50,gd+" = "+rc)}function M(){this.average=0;this.max=Number.MIN_SAFE_INTEGER;this.min=Number.MAX_SAFE_INTEGER;this.asc=this.last=0}function T(rc,gd){rc=document.getElementById(rc.Lb+Tb.a.D1a);return{oPb:rc.clientWidth/gd,lPb:rc.clientHeight/gd}}function R(rc){return rb.call(this,rc)||this}function Q(rc,gd){this.$=rc;this.excelLiveManager=gd}function ea(){this.tb=null}function Z(rc){this.vwg=rc}function ca(rc){this.Zqg=
rc}function I(){}function H(){}function L(){}function U(){}function fa(rc,gd,kd,Qc){Qc=void 0===Qc?null:Qc;this.fm=new Db.a;this.$tg=rc;this.Rsg=gd;this.vb=kd;this.ojb=Qc}function aa(){}function na(){}function ha(){}function ka(rc,gd){this.La=rc;this.hXa=gd}function xa(){this.vx=this.Cm=!1}function va(rc,gd,kd,Qc,de,Xe,ge,fc,dd){var oc=this;this.Cm=!1;this.IWb=this.JXa=this.SP=this.Dga=null;this.xmb=va.REc;this.Za=new gb.a;this.Mra=new Aa(0);this.Mra.pWc(Object(kb.a)(this,this.wTi,"onStateMachineChanged"));
this.$vg=rc;this.qWb=gd;this.Zvg=kd;this.PQc=Qc;this.se=de;this.jU=Xe;ge.execute(function(Zb){oc.Cm||(oc.JXa=Zb,oc.JXa.lZa(Object(kb.a)(oc,oc.Wca,"onUpdateNotificationReceived")),oc.start())});fc.execute(function(Zb){oc.Cm||(oc.IWb=Zb,Zb.RZb(Object(kb.a)(oc,oc.GEf,"onTokenRefreshed")))});this.uje=dd}function Aa(rc){this.Za=new gb.a;this.vie=new Date;this.lib=rc;this.KIc=0}function qa(rc,gd,kd,Qc,de){var Xe=Na.call(this)||this;Xe.fGd=rc;Xe.newState=gd;Xe.y1i=kd;Xe.z1i=Qc;Xe.X0j=de;return Xe}function wa(rc,
gd){var kd=ac.call(this)||this;kd.x0j=rc;kd.q0j=gd;return kd}b.r(E);var Ta=b(556),sb=b(0),db=b(14),kb=b(82),ac=Sys.EventArgs;Am(wa,ac);Object(sb.a)(wa,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var ta;(function(rc){rc[rc.notYetStarted=0]="notYetStarted";rc[rc.polling=1]="polling";rc[rc.subscribed=2]="subscribed";rc[rc.blocked=3]="blocked";rc[rc.permanentlyStopped=4]="permanentlyStopped"})(ta||(ta={}));Object(sb.b)("RtcHostNotificationSubscriptionState",ta);var ra=b(108),Na=Sys.EventArgs;Am(qa,
Na);Object(sb.a)(qa,"StateChangedEventArgs",Sys.EventArgs,[]);var gb=b(97);Aa.prototype.event=function(rc,gd){this.currentState!==rc&&(this.gDh(this.currentState,rc,this.nNe,void 0===gd?null:gd),this.KIc=0,this.vie=new Date);this.lib=rc;this.KIc=this.nNe+1};Aa.prototype.gDh=function(rc,gd,kd,Qc){rc=new qa(rc,gd,kd,this.vie,Qc);this.Za.raiseEvent("c",rc)};Aa.prototype.pWc=function(rc){this.Za.addHandler("c",rc)};Aa.prototype.HRf=function(rc){this.Za.removeHandler("c",rc)};Ck.Object.defineProperties(Aa.prototype,
{currentState:{configurable:!0,enumerable:!0,get:function(){return this.lib}},nNe:{configurable:!0,enumerable:!0,get:function(){return this.KIc}}});Object(sb.a)(Aa,"StateMachine",null,[355]);va.prototype.start=function(){0!==this.xeb?db.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",ta[this.xeb]):(this.Mra.event(1),this.JOd(null))};va.prototype.JOd=function(){this.Dga=null;if(this.Rhf){db.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",
ta[this.xeb]);var rc=null;this.PQc&&this.PQc.length&&(rc={},rc.etts=this.PQc);this.JXa.fea(14,rc,!0);this.WWf(this.$vg)}else this.Mra.event(3)};va.prototype.WWf=function(rc){this.Dga=ra.a.d5b(1E3*rc,Object(kb.a)(this,this.JOd,"sendSubscribeEvent"),this.qWb,192,"RtcHostNotificationSubscribe");this.se.Yg(this.Dga)};va.prototype.zlj=function(rc){rc=1E3*(rc+this.Zvg);var gd=this.uje().getTime()+rc;this.xmb=new Date(gd);rc-=this.qWb;this.SP?this.se.pna(this.SP,rc):(this.SP=ra.a.d5b(rc,Object(kb.a)(this,
this.zMj,"transitionToPollingEvent"),this.qWb/2,194,"RtcHostNotificationTransitionToPolling"),this.se.Yg(this.SP))};va.prototype.zMj=function(){this.SP=null;2===this.xeb&&(this.Mra.event(1),db.ULS.shipAssertTag(573100185,502,!!this.Dga,"Missing task to ensure that we re-subscribe."))};va.prototype.GEf=function(){this.p3h()};va.prototype.p3h=function(){3===this.xeb&&this.Rhf&&(this.Mra.event(this.c6?2:1),this.JOd(null))};va.prototype.Wca=function(rc,gd){if(13===gd.type&&(rc=gd.z8,gd={},db.ULS.sendTraceTag(573100183,
502,50,"HostNotifications: Subscription status: {0}",(gd.SerializableHostNotificationSubscription=rc,gd.DurationBeforeExpirationToResubscribeInSec=this.qWb,gd)),gd=rc.cts,!this.vOj(gd))){if(rc.sb){var kd=2;this.zlj(rc.cts)}else kd=1,this.xmb=va.REc,this.SP&&(this.se.aq(this.SP),this.SP=null);this.Mra.event(kd);this.Dga?this.se.pna(this.Dga,1E3*gd):this.WWf(gd)}};va.prototype.vOj=function(rc){if(!isNaN(rc)&&isFinite(rc)&&0<rc)return!1;this.q7f(!1);return!0};va.prototype.q7f=function(rc){this.Dga&&
(this.se.aq(this.Dga),this.Dga=null);this.SP&&(this.se.aq(this.SP),this.SP=null);this.JXa&&(this.JXa.EIb(Object(kb.a)(this,this.Wca,"onUpdateNotificationReceived")),this.JXa=null);this.IWb&&(this.IWb.pKd(Object(kb.a)(this,this.GEf,"onTokenRefreshed")),this.IWb=null);rc||this.Mra.event(4)};va.prototype.wTi=function(rc,gd){rc=gd.newState;var kd=gd.fGd,Qc={};Qc.NewState=ta[rc];Qc.PreviousState=ta[kd];Qc.PreviousStateHits=gd.y1i;Qc.PreviousStateTransitionTime=gd.z1i.toISOString();Qc.IsSubscribed=this.c6;
this.xmb!==va.REc&&(Qc.SubscriptionExpiringTime=this.xmb.toISOString());db.ULS.sendTraceTag(572346515,502,4===rc?15:50,"HostNotificationChanged: {0}",Qc);this.Za.raiseEvent("HN",new wa(kd,rc))};va.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.q7f(!0),this.SP&&(this.se.aq(this.SP),this.SP=null))};Ck.Object.defineProperties(va.prototype,{xeb:{configurable:!0,enumerable:!0,get:function(){return this.Mra.currentState}},Rhf:{configurable:!0,enumerable:!0,get:function(){return!this.jU||this.jU.bjf}},
c6:{configurable:!0,enumerable:!0,get:function(){return 2===this.xeb&&this.uje()<this.xmb}}});va.REc=new Date(0);Object(sb.a)(va,"RtcHostNotificationSubscriptionManager",null,[535,2]);var ob=b(4),wb=b(255),Oa=b(738),sa=b(85);xa.prototype.fi=function(rc){var gd=this;rc.register(va,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").Ic().Oc(function(){var kd=ob.AFrameworkApplication.ga;
return new va(kd.Cd("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),kd.Cd("RtcHostNotificationRetryIntervalBufferInSeconds",120),kd.Cd("RtcHostNotificationSubscriptionLostBufferInSeconds",60),gd.jYh(kd),ob.AFrameworkApplication.Ri,Oa.SessionStatusManager.instance,rc.lc("Common.IRealtimeChannelBasic"),rc.lc("Common.ISessionExpirationManager"),function(){return new Date})})};xa.prototype.init=function(){var rc=this;ob.AFrameworkApplication.ga.tv(function(){!rc.Cm&&ob.AFrameworkApplication.ga.ra("RtcHostNotificationEnabled")&&
(rc.vx=!0,sa.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})};xa.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.vx&&sa.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())};xa.prototype.jYh=function(rc){return rc.qz("RtcEventTypesToSubscribe")?rc.Kw("RtcEventTypesToSubscribe"):null};xa.main=function(){wb.a.instance.hj(new xa)};Ck.Object.defineProperties(xa.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"RtcHostNotificationSubscription"}}});Object(sb.a)(xa,"RtcHostNotificationSubscriptionPackage",null,[4,5]);var Fa=b(106),Wa=b(27);ka.prototype.Og=function(){this.La.fc(Wa.a.Llf,Fa.a.frame,Object(kb.a)(this,this.Mlf,"livePersonaCardActionHandler"))};ka.prototype.iOb=function(){this.La.LB(Wa.a.Llf,Fa.a.frame,Object(kb.a)(this,this.Mlf,"livePersonaCardActionHandler"))};ka.prototype.Mlf=function(rc,gd,kd,Qc,de){if(!de||3===kd)return 2;if(1===kd)return this.KYa(this.hXa.kxe(de.upn||
de.aadObjectId));if(!this.kmh(de))return 8;switch(de.action){case 0:return this.KYa(this.hXa.fBg(de));case 1:return this.KYa(this.hXa.eBg(de));case 2:return this.KYa(this.hXa.gBg(de));case 3:return this.KYa(this.hXa.openCard(de));case 4:return this.KYa(this.hXa.W$i(de));default:return 2}};ka.prototype.kmh=function(rc){var gd=rc.upn||rc.aadObjectId;return rc.targetElement&&(4===rc.action||gd&&""!==gd)?!0:!1};ka.prototype.KYa=function(rc){return rc?32:8};Object(sb.a)(ka,"LivePersonaCardActor",null,
[]);var Db=b(161),pc=b(83);Object(sb.a)(ha,"BootstrapperConfig",null,[]);Object(sb.a)(na,"LivePersonaCardInitializerResult",null,[]);aa.Xue=null;Object(sb.a)(aa,"LivePersonaCardModule",null,[]);var lc=b(619);fa.prototype.init=function(){this.Fff()?this.$tg.Sti().continueWith(Object(kb.a)(this,this.rQi,"onPackageLoaded")):this.fm.setResult(Object.assign(new na,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));return this.fm.task};fa.prototype.rQi=function(){var rc=
this,gd=aa.Xue;if(gd){var kd=this.RKh();try{gd.initializeLivePersonaCardAsync(kd).then(function(){rc.fm.setResult(Object.assign(new na,{isInitialized:!0,isEnabled:!0}))}).catch(function(Qc){var de=Object(pc.a)(String,Qc);de?rc.fm.setException(Error.create(de)):rc.fm.setException(Error.create(JSON.stringify(Qc)))})}catch(Qc){this.fm.setException(Qc)}}else this.fm.setResult(Object.assign(new na,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};fa.prototype.RKh=
function(){var rc=lc.a.hK(ob.AFrameworkApplication.lcid);return Object.assign(new ha,{culture:rc?rc.name.toLocaleLowerCase():"en-us",clientType:this.vb.Va("LivePersonaCardClientType"),clientContextType:"Generic",clientCorrelationId:ob.AFrameworkApplication.userSessionId,complianceEnvironment:this.RMh(),logMessage:Object(kb.a)(this,this.logMessage,"logMessage"),getAuthToken:Object(kb.a)(this,this.getAuthToken,"getAuthToken")})};fa.prototype.Fff=function(){if(!this.vb.ra("LivePersonaCardIsEnabled")||
!this.gKg())return!1;var rc=this.vb.Va("SovereignEnvironmentName");return rc&&""!==rc?rc.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||rc.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0};fa.prototype.gKg=function(){return this.vb.ra("CoauthorGalleryLivePersonaCardIsEnabled")||!!ob.AFrameworkApplication.sa&&ob.AFrameworkApplication.sa.Pa.xSa};fa.prototype.RMh=function(){return this.vb.Va("LivePersonaCardComplianceEnvironment")};fa.prototype.logMessage=function(rc,gd,kd){var Qc=
{};rc=JSON.stringify((Qc["Log Type"]=rc,Qc["Log Result Type"]=gd,Qc.Message=kd,Qc));db.ULS.sendTraceTag(50431106,3006,50,rc)};fa.prototype.getAuthToken=function(rc,gd){var kd=this;ob.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?this.ojb.continueWith(function(Qc){Qc.Oh||Qc.ig?gd("LokiTokenManagerTask is either canceled or faulted.",ob.AFrameworkApplication.userSessionId):kd.ojb.result.dgd().then(function(de){de.isSuccess&&de.token&&de.token.length?
rc(de.token,ob.AFrameworkApplication.userSessionId):gd(de.errorMessage,ob.AFrameworkApplication.userSessionId)}).catch(function(de){return db.ULS.sendTraceTag(539617039,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(de))})}):this.Rsg.dgd().then(function(Qc){Qc.isSuccess&&Qc.token&&Qc.token.length?rc(Qc.token,ob.AFrameworkApplication.userSessionId):gd(Qc.errorMessage,ob.AFrameworkApplication.userSessionId)}).catch(function(Qc){return db.ULS.sendTraceTag(50431107,3006,
10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Qc))})};Object(sb.a)(fa,"LivePersonaCardInitializer",null,[]);Object(sb.a)(U,"Behavior",null,[]);Object(sb.a)(L,"Identifiers",null,[]);Object(sb.a)(H,"LivePersonaCardParameters",null,[]);Object(sb.a)(I,"PersonaInfo",null,[]);ca.prototype.kxe=function(rc){return this.Zqg.Fff()&&rc&&""!==rc?!!window.self.LPC:!1};ca.prototype.fBg=function(rc){return this.ZNb("addedPersonaToPageV2",rc,0)};ca.prototype.eBg=function(rc){return this.ZNb("addedPersonaToPageV2",
rc,1)};ca.prototype.gBg=function(rc){return this.ZNb("addedPersonaToPageV2",rc,2)};ca.prototype.openCard=function(rc){return this.ZNb("openCard",rc)};ca.prototype.W$i=function(rc){return this.ZNb("removedPersonaFromPage",rc)};ca.prototype.UUg=function(rc){return!!rc.targetElement&&(this.kxe(rc.upn||rc.aadObjectId)||4===rc.action)};ca.prototype.ZNb=function(rc,gd,kd){kd=void 0===kd?3:kd;if(!this.UUg(gd))return!1;kd=4!==gd.action?this.g8g(gd,kd):null;var Qc=window.self.LPC;if(Qc&&Qc[rc]){if(kd)Qc[rc](gd.targetElement,
kd);else Qc[rc](gd.targetElement);return!0}return!1};ca.prototype.g8g=function(rc,gd){gd=void 0===gd?3:gd;var kd=Object.assign(new L,{PersonaType:"User",Upn:rc.upn,AadObjectId:rc.aadObjectId});return Object.assign(new H,{personaInfo:Object.assign(new I,{identifiers:kd,displayName:rc.name,personaCoinColor:rc.color}),behavior:Object.assign(new U,{onCardOpen:function(){db.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(rc.onCardOpen)rc.onCardOpen()},onCardClose:rc.onCardClose,disableClick:2===
gd||3===gd,disableHover:0===gd||3===gd})})};Object(sb.a)(ca,"LivePersonaCardManager",null,[]);Z.prototype.Sti=function(){var rc=ob.AFrameworkApplication.BO("midgardbootstrapper.js",5);return this.vwg.Eud(rc).continueWith(function(){aa.Xue=window.self.MidgardBootstrapper})};Object(sb.a)(Z,"LivePersonaCardPackageLoader",null,[534]);var eb=b(566);ea.prototype.init=function(){ob.AFrameworkApplication.ga&&ob.AFrameworkApplication.ga.tv(Object(kb.a)(this,this.FB,"onFullAppSettingsReady"))};ea.prototype.dispose=
function(){};ea.prototype.fi=function(rc){this.tb=rc};ea.prototype.FB=function(){var rc=ob.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new fa(new Z(this.tb.resolve("Common.ISharedDependencyLoader")),null,ob.AFrameworkApplication.ga,eb.a.dr(this.tb.lc("Common.ILokiTokenManager"))):new fa(new Z(this.tb.resolve("Common.ISharedDependencyLoader")),this.tb.resolve("Common.ILokiTokenManager"),ob.AFrameworkApplication.ga);rc.init().continueWith(function(gd){gd.ig&&
gd.exception?db.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",gd.exception.message):((gd=gd.result)||db.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),gd.isInitialized?db.ULS.sendTraceTag(50431109,3006,100,"Successfully initialized LivePersonaCard"):db.ULS.sendTraceTag(595067867,3006,gd.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",gd.failureMessage))});(new ka(ob.AFrameworkApplication.Ib,
new ca(rc))).Og()};ea.main=function(){wb.a.instance.hj(new ea)};Ck.Object.defineProperties(ea.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.LivePersonaCard"}}});Object(sb.a)(ea,"LivePersonaCardPackage",null,[4,5]);var ib=b(11),cc=b(904),Pa=b(36),nc=b(162),pb=b(186);Q.prototype.$c=function(){return!1};Q.prototype.Kc=function(rc,gd){switch(gd.command){case 1491932557:return nc.g(this.$)&&2===this.excelLiveManager.yza.Um;case -440259636:return nc.f(this.$)&&2===this.excelLiveManager.yza.Um;
default:return!1}};Q.prototype.executeCommand=function(rc,gd){rc=Pa.TaskExtensions.Dl();var kd=gd.command;switch(gd.command){case -440259636:this.excelLiveManager.Lid();break;case 1491932557:this.excelLiveManager.NVd();break;default:rc=pb.a(kd)}return rc};Q.prototype.jd=function(){return!1};Object(sb.a)(Q,"ExcelLiveCommandHandler",null,[424]);var rb=cc.a;Am(R,rb);R.prototype.Nd=function(){var rc=this;this.$.da.$a(473,function(gd){rc.Dd([new Q(rc.$,gd)])})};R.ka=function(rc){cc.a.he(469,new R(rc))};
Object(sb.a)(R,"ExcelLiveCommandHandlerFactory",cc.a,[]);var Ya=b(226),ec=b(9),yd=b(48),Ub=b(25),Ob=b(45),Yb=b(21),xb=b(237),Sa=b(33),Tb=b(5),Cc=b(128),Fb=b(47),hc=b(278),cd=b(698),mb=b(10),$a;(function(rc){rc[rc.complete=0]="complete";rc[rc.nonComplete=1]="nonComplete";rc[rc.unknown=2]="unknown"})($a||($a={}));Object(sb.b)("FollowerViewState",$a);var K;(function(rc){rc[rc.none=0]="none";rc[rc.selection=1]="selection";rc[rc.scroll=2]="scroll";rc[rc.zoom=4]="zoom";rc[rc.default=0]="default"})(K||(K=
{}));Object(sb.b)("UpdateType",K);var ba=b(56),ua;(function(rc){rc[rc.presenter=0]="presenter";rc[rc.follower=1]="follower";rc[rc.explorer=2]="explorer";rc[rc.unknown=3]="unknown"})(ua||(ua={}));Object(sb.b)("ParticipantRole",ua);M.prototype.n3=function(rc){this.min=rc<this.min?rc:this.min;this.max=rc>this.max?rc:this.max;++this.asc;this.average=(rc+this.average*(this.asc-1))/this.asc;this.last=rc};M.prototype.toString=function(){return"{average: "+this.average+", min: "+this.min+", max: "+this.max+
", last: "+this.last+", recordsCount: "+this.asc+"}"};Object(sb.a)(M,"Aggregates",null,[]);C.prototype.dispose=function(){this.$=null};C.prototype.Jkc=function(){var rc=mb.HelperMethods.Zb(),gd={};gd.FollowerViewState=0<this.kcd?"Hybrid":$a[this.Ujc];gd.FollowerViewStateTransitions=this.kcd;gd.FollowerZoomInOppositeDirectionCount=this.NVe;gd.ExplorerConsumptionTrends=0<this.SSe?"WorkbookEdited":"WorkbookViewed";gd.ExplorerNSVModeTrends=this.utf;gd.ExplorerNSVSwitchTrends=this.vtf;gd.ViewportChangesInNonCompleteViewCount=
this.Agg;gd.ParticipantSessionInitTimestamp=this.fGb;gd.FirstMessageIdReceived=this.Ibd;gd.LastMessageIdReceived=this.Ekf;gd.FirstMessageReceivedTimestamp=this.z$b;gd.LastMessageReceivedTimestamp=this.Jjc;gd.TimeSinceLastMessageReceivedInMs=rc-this.Jjc;gd.TotalMessagesReceived=this.Klc;gd.MessagesReceptionLatencyAggregates=this.brf;gd.PresenterIdentifiedTimestamp=this.MGb;gd.PresenterID=this.fJf;gd.TimeToIdentifyPresenterFromCreationInMs=this.MGb-this.fGb;gd.CurrentRole=this.tIa;gd.TimeInCurrentRole=
rc-this.erc;gd.PreviousRole=this.x1i;gd.RoleSwitchCounts=this.Fuc;gd.RoleSwitchDurationsInMs=this.RMd;gd.RoleSwitchDurationsTrackerAggregates=this.Guc;rc=ba.a.Lc(gd);this.$.sendBeaconTraceTag(523015447,50,!1,"ExcelLiveFollowerOrExplorer.logSessionTelemetry: "+rc)};C.prototype.nvd=function(){2E3>mb.HelperMethods.Zb()-this.wDc&&(++this.Agg,A(mb.HelperMethods.Zb()-this.wDc,"ExcelLiveFollowerOrExplorer.logNonCompleteViewStateTelemetry: TimeElapsedSinceLastViewportChange"),this.wDc=0)};C.prototype.dMj=
function(rc,gd){this.Ujc&&rc!==this.Ujc&&++this.kcd;this.Ujc=rc;A(mb.HelperMethods.Zb()-gd,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerViewStateTransitions: TimeTakenToSyncFollowerViewport")};C.prototype.iMj=function(rc){rc=mb.HelperMethods.Zb()-rc;db.ULS.sendTraceTag(523015446,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogTimeToProcessReceivedMessage: Total time to process received message: ["+rc+"]ms with current role: ["+this.tIa+"]")};C.prototype.jMj=function(rc){db.ULS.sendTraceTag(523015445,
0,50,"ExcelLiveFollowerOrExplorer.trackAndLogTotalTimeToSyncFollowerViewport: Total time to sync: ["+(Date.now()-rc)+"]ms with current role: ["+this.tIa+"]")};C.prototype.cMj=function(rc){this.qad=mb.HelperMethods.Zb();++this.RSe;1===this.RSe&&A(mb.HelperMethods.Zb()-this.fGb,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: TimeToFirstExplorerTransition");db.ULS.sendTraceTag(523015444,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: Last Update Type from Presenter Was = {0}. Current View State = {1}",
K[rc],Yb.g(this.$).ebc().qB(!0))};C.prototype.eMj=function(){Sa.a(this.$);var rc=mb.HelperMethods.Zb()-this.W0d;1E4>rc&&(A(rc,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerZoomTrends: TimeToZoomChangeInOppositeDirection"),this.W0d=0);this.lMj()};C.prototype.lMj=function(){mb.HelperMethods.Zb()<this.fGb+12E4&&++this.NVe};C.prototype.lxi=function(){var rc=mb.HelperMethods.Zb()-this.qad;5E3>rc&&A(rc,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: TimeElapsedToSyncBackSinceBecomingExplorer");
this.qad=0};C.prototype.kxi=function(rc,gd,kd){rc=void 0===rc?!1:rc;A(mb.HelperMethods.Zb()-this.MVd,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: Synced via Presence Notification = "+rc+", IsSyncBack = "+gd+", Retries = "+kd+" TimeElapsedInSyncingExplorerBackToPresenter");this.MVd=0};C.prototype.mMj=function(rc){typeof rc===typeof cd.a?++this.utf:++this.vtf};C.prototype.pMj=function(){this.MVd=mb.HelperMethods.Zb()};C.prototype.qMj=function(){this.wDc=mb.HelperMethods.Zb()};C.prototype.rMj=
function(){this.W0d=mb.HelperMethods.Zb()};C.prototype.kMj=function(){++this.SSe};C.prototype.gMj=function(rc,gd){var kd,Qc=mb.HelperMethods.Zb(),de=Date.now();0===this.Ibd&&(this.Ibd=rc,this.z$b=Qc);this.Ekf=rc;++this.Klc;gd=de-gd;1<this.Klc&&this.brf.n3(gd);de=Qc-(null!==(kd=this.Jjc)&&void 0!==kd?kd:this.z$b);this.Jjc=Qc;db.ULS.sendTraceTag(523015443,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogMessageReceived: Received message number ["+this.Klc+"] MessageID: ["+rc+"] Time since last message: ["+
de+"]ms with reception latency: ["+gd+"]ms")};C.prototype.Cwi=function(rc){this.MGb=mb.HelperMethods.Zb();this.fJf=rc;db.ULS.sendTraceTag(523015442,0,50,"ExcelLiveFollowerOrExplorer.logPresenterIdentified: Presenter identified at ["+this.MGb+"] after ["+(this.MGb-this.z$b)+"]ms since first valid message with clientId=["+this.fJf+"]")};C.prototype.oMj=function(rc){var gd,kd;if(this.tIa!==rc){3===rc&&this.Jkc();var Qc=mb.HelperMethods.Zb(),de=ua[this.tIa],Xe=ua[rc];this.Fuc[Xe]=1+(null!==(gd=this.Fuc[Xe])&&
void 0!==gd?gd:0);gd=Qc-this.erc;this.RMd[de]=gd+(null!==(kd=this.RMd[de])&&void 0!==kd?kd:0);this.Guc.has(de)||(this.Guc[de]=new M);this.Guc[de].n3(gd);this.erc=Qc;this.x1i=this.tIa;this.tIa=rc}};Object(sb.a)(C,"ExcelLiveFollowerOrExplorerTelemetryHelper",null,[2]);var La=Sys.EventArgs;Am(v,La);Object(sb.a)(v,"ExcelLiveViewStateChangedArgs",Sys.EventArgs,[]);var ub=b(38),Va=b(1),tb=ub.a;Am(B,tb);B.prototype.Aq=function(rc){this.addHandler("followerViewStateInfoChanged",rc)};B.prototype.Xq=function(rc){this.removeHandler("followerViewStateInfoChanged",
rc)};B.prototype.Qz=function(){this.xn("QueryExcelLiveViewState")&&this.raiseEvent("followerViewStateInfoChanged")};B.prototype.fs=function(rc,gd){return"QueryExcelLiveViewState"!==rc?!1:this.X4h(gd)};B.prototype.xn=function(){return Object(nc.g)(this.$)&&Va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowExcelLiveViewStateInStatusBar",!1)};B.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.ZF(this),this.statusBarManager=null);this.Iaa.iej(this.fFf);this.$=
this.Iaa=null;tb.prototype.dispose.call(this)};B.prototype.X4h=function(rc){if(!this.$)return!1;rc.Value=String.format("View State: {0} | Presenter Visible Range: {1}",$a[this.X5b],this.Sqc);return!0};Object(sb.a)(B,"ExcelLiveStatusBarManager",ub.a,[2,543,373]);var Cb=ub.a;Am(u,Cb);u.prototype.eIg=function(rc){this.addHandler("FollowerViewStateChanged",rc)};u.prototype.iej=function(rc){this.removeHandler("FollowerViewStateChanged",rc)};u.prototype.t4i=function(rc){this.raiseEvent("FollowerViewStateChanged",
rc)};Object(sb.a)(u,"ExcelLiveFollowerOrExplorerEventManager",ub.a,[]);var nb=b(79),Ib=b(107),hb=new Set([Ib.a.Lhg,Ib.a.lse,Ib.a.N8f,Ib.a.O8f,Ib.a.Z5e,Ib.a.Xid]);x.prototype.dispose=function(){this.Ceh();2!==this.controller.Um&&(this.xIe(),this.Esb());this.gridView=this.$=this.controller=this.realtimeChannel=this.mtd=this.Ptd=this.D8a=this.Ltd=this.TGb=null};x.prototype.NVd=function(){this.eo.pMj();this.Uzc(!0)};x.prototype.Uzc=function(rc,gd){var kd=this;rc=void 0===rc?!1:rc;gd=void 0===gd?null:
gd;var Qc;rc&&this.eo.lxi();if(gd)this.cNb(gd)||this.Uwa?this.Rmd(rc):db.ULS.sendTraceTag(527496925,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Could not sync to presenter from presence update"),this.XZ=0;else if(++this.XZ,this.XZ>this.sTe)db.ULS.sendTraceTag(527496924,0,10,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Presenter Nav State not available after "+(this.XZ-1)+" retries."),this.npd=!0,this.XZ=0;else{if(1===this.XZ){var de=null!==(Qc=this.mtd)&&
void 0!==Qc?Qc:this.TGb;if(null!==de&&(this.cNb(de,!0)||this.Uwa)){this.Rmd(rc,!0,this.XZ);this.XZ=0;return}}(Qc=this.Mad())&&(this.cNb(Qc)||this.Uwa)?(this.Rmd(rc,!0,this.XZ),this.XZ=0):1!==this.controller.Um&&(this.A8(3,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry"),db.ULS.sendTraceTag(527496923,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Retry\n           "+this.XZ+" - Presenter Nav State not available."),Fb.a.instance.create(function(){kd.Uzc(rc,gd)},
hc.a.Uva(this.XZ,this.tTe,this.uTe,!0),"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry",void 0,!0))}};x.prototype.Rmd=function(rc,gd,kd){rc=void 0===rc?!1:rc;gd=void 0===gd?!1:gd;kd=void 0===kd?0:kd;this.A8(1,"ExcelLiveFollowerOrExplorer::initializeFollower");this.HMg();this.D0b();this.npd=!1;rc&&this.eo.kxi(gd,rc,kd);Va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveSurvey",!1)&&this.controller.jBc()};x.prototype.tpb=function(){this.zma=this.zma.bind(this);this.mD=
this.mD.bind(this);this.kD=this.kD.bind(this);this.If=this.If.bind(this);this.jpc=this.jpc.bind(this);this.gj=this.gj.bind(this);this.bnc=this.bnc.bind(this);this.fj=this.fj.bind(this);this.apc=this.apc.bind(this);this.Znc=this.Znc.bind(this);this.ePa=this.ePa.bind(this);this.ppc=this.ppc.bind(this);this.onScroll=this.onScroll.bind(this);this.K$a=this.K$a.bind(this);this.Zc=this.Zc.bind(this);this.u$a=this.u$a.bind(this);this.e$a=this.e$a.bind(this);this.He=this.He.bind(this);this.hpc=this.hpc.bind(this)};
x.prototype.rTe=function(){var rc=this.Mad();return this.cNb(rc)};x.prototype.Mad=function(rc){rc=void 0===rc?null:rc;if(rc=null!==rc&&void 0!==rc?rc:this.realtimeChannel.Odd())for(var gd in rc){var kd=gd,Qc=rc[gd];if(!Qc)break;if(Qc.NavigationState&&Qc.MeetingInfo&&(Qc.MeetingInfo.MeetingId===this.$.ya.MeetingId||nc.d()))return this.eo.gMj(Qc.MeetingInfo.MessageId,Qc.NavigationState.MessageBroadcastTime),this.controller.JB&&this.controller.JB===kd||this.controller.Sfg(kd,"ExcelLiveFollowerOrExplorer:extractNavigationStateFromMeetingPresence")&&
this.eo.Cwi(kd),Qc.NavigationState}return null};x.prototype.A8=function(rc,gd){this.eo.oMj(rc);this.controller.A8(rc,gd)};x.prototype.cNb=function(rc,gd){gd=void 0===gd?!1:gd;var kd=mb.HelperMethods.Zb(),Qc=this.v1g(rc,this.TGb,gd);if(0===Qc)return this.iWf(Qc,rc),!0;if(!this.qOj(rc.SheetID))return!1;Qc&4&&this.setZoom(this.TGb,rc);gd=this.q1g(rc);this.bIj(rc,Qc,gd);this.iWf(Qc,rc);rc=Ob.D(rc.VisibleAreaRange);this.Iaa.t4i(new v(gd,rc.toString()));this.eo.dMj(gd,kd);return!0};x.prototype.bIj=function(rc,
gd,kd){this.ozb=!0;0===kd?this.M8f(gd,rc):this.cIj(gd,rc)};x.prototype.iWf=function(rc,gd){this.TGb=gd;this.UGb=rc};x.prototype.qOj=function(rc){rc=this.$.xa.getItemByName(rc);var gd=this.$.xa.qa;this.Ltd=rc;if(!rc)return this.Uwa=!0,!1;if(rc!==gd){if(!rc.visible)return!1;this.nNa=!0;rc.activate();gd=rc}if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:6146876_ExcelLiveSkipNSVPrompts")){if(!gd.Yd.CK&&!gd.Yd.ty)return!0;rc={};this.$.Zd(1690118309,nb.a.Vb,0,(rc[nc.a]=!0,rc)).continueWith(function(){return!0})}return!0};
x.prototype.setZoom=function(rc,gd){rc&&rc.SheetID===gd.SheetID&&(rc=(gd.ZoomLevel-rc.ZoomLevel)/rc.ZoomLevel*100,gd=Sa.a(this.$).zoom,rc=gd+gd*rc/100,Sa.a(this.$).Rhg(rc),this.eo.rMj())};x.prototype.M8f=function(rc,gd){rc&2&&(rc=Ob.D(gd.VisibleAreaRange),this.D8a=Ub.Range.hd(rc.top,rc.left),this.Ptd=new yd.a(gd.TopLeftCellOffsets.X,gd.TopLeftCellOffsets.Y),gd=xb.a(this.D8a,this.Ptd,this.gridView.Ps,this.gridView.rb,0,0,this.$,this.gridView.a5()),this.gridView.u_b(gd,this.D8a,60,this.D8a,Ib.a.N8f))};
x.prototype.cIj=function(rc,gd){var kd=Ob.D(gd.SelectedRanges[gd.IndexOfActiveRange]),Qc=rc!==this.UGb,de=Ob.D(gd.VisibleAreaRange);rc&1?(this.Kgg=this.gridView.ebc(),this.gridView.eu(kd,64,Ib.a.O8f,!0),rc=this.gridView.gka(),this.D8a=rc.OL,this.Ptd=rc.hD,Qc&&(this.exa?this.sqd=!0:this.gridView.GZb(this.e$a))):rc&2&&(!de.Kd(kd)||this.UGb&2||this.UGb&4)&&(this.M8f(rc,gd),Qc&&this.eo.nvd());this.eo.qMj()};x.prototype.w8e=function(rc){var gd=this.gridView.ebc();return gd.Kd(rc)&&rc.Kd(gd)?!0:!1};x.prototype.v1g=
function(rc,gd,kd){kd=void 0===kd?!1:kd;if(!rc)return 0;if(!gd&&rc||kd)return 7;var Qc=Ob.D(rc.SelectedRanges[rc.IndexOfActiveRange]),de=Ob.D(gd.SelectedRanges[gd.IndexOfActiveRange]),Xe=Ob.D(rc.VisibleAreaRange),ge=Ob.D(gd.VisibleAreaRange);if(gd.SheetID===rc.SheetID&&(gd.SheetID!==rc.SheetID||gd.ZoomLevel===rc.ZoomLevel&&Qc.equals(de)&&Xe.equals(ge)&&gd.TopLeftCellOffsets.X===rc.TopLeftCellOffsets.X&&gd.TopLeftCellOffsets.Y===rc.TopLeftCellOffsets.Y))return kd?7:0;Qc=Ob.D(rc.VisibleAreaRange);kd=
Ob.D(rc.SelectedRanges[rc.IndexOfActiveRange]);Qc=Ub.Range.hd(Qc.top,Qc.left);de=new yd.a(rc.TopLeftCellOffsets.X,rc.TopLeftCellOffsets.Y);ge=Ob.D(gd.VisibleAreaRange);Xe=Ob.D(gd.SelectedRanges[gd.IndexOfActiveRange]);ge=Ub.Range.hd(ge.top,ge.left);var fc=new yd.a(gd.TopLeftCellOffsets.X,gd.TopLeftCellOffsets.Y),dd=0;rc.SheetID!==gd.SheetID?dd|=3:(Xe.equals(kd)||(dd|=1),rc.ZoomLevel!==gd.ZoomLevel&&(dd|=4),de.equals(fc)&&Qc.equals(ge)||(dd|=2));return dd};x.prototype.q1g=function(rc){var gd=T(this.$,
Sa.a(this.$).zoom),kd=gd.lPb;return gd.oPb<rc.ViewportWidth*this.e0d||kd<rc.ViewportHeight*this.e0d?1:0};x.prototype.HMg=function(){var rc=this;this.$.ea.VG(this.mD);this.$.ea.gZa(this.kD);this.$.da.$a(419,function(gd){gd.wpe(rc.K$a);gd.xpe(rc.K$a)})};x.prototype.xIe=function(){var rc=this;this.$&&(this.$.ea.bG(this.mD),this.$.ea.Obb(this.kD),this.$.da.$a(419,function(gd){gd.MRf(rc.K$a);gd.NRf(rc.K$a)}))};x.prototype.K$a=function(){this.eo.eMj()};x.prototype.mD=function(){this.$.ea.af!==ec.a.Re&&
this.$.ea.sc&&(this.Uwa&&this.$.ea.Ot(this.If),this.w6a=!0)};x.prototype.If=function(){(this.w6a||this.Uwa)&&this.rTe()&&(this.$.ea.Gv(this.If),this.Uwa=this.w6a=!1)};x.prototype.kD=function(){this.nNa?this.nNa=!1:this.w6a&&this.rTe()&&(this.w6a=!1)};x.prototype.D0b=function(){var rc=this;this.exa?(this.gridView.view.cIg(this.hpc),this.gridView.GZb(this.e$a)):(this.gridView.nZa(this.jpc),this.$.Tne(this.bnc),this.$.RA(this.fj),this.$.da.$a(419,function(gd){gd.kIg(rc.ppc)}),this.gridView.coe(this.ePa));
this.gridView.rc.sl(this.gj);this.$.da.$a(65,function(gd){gd.DGg(rc.apc)})};x.prototype.Esb=function(){this.gridView&&(this.exa?(this.gridView.view.gej(this.hpc),this.gridView.gtc(this.e$a)):(this.gridView.Wbb(this.jpc),this.gridView.QQf(this.ePa)),this.gridView.rc.kl(this.gj));if(!this.exa){this.$&&(this.$.DQf(this.bnc),this.$.AD(this.fj));var rc=this.$.da.Aa(419);rc&&rc.lej(this.ppc)}(rc=this.$.da.Aa(65))&&rc.Ycj(this.apc)};x.prototype.jpc=function(){this.nzb?this.nzb=!1:this.Lgc||this.nNa||this.ozb||
this.Jpi()||(this.Yod?this.Yod=!1:this.rma())};x.prototype.hpc=function(){this.rma()};x.prototype.e$a=function(rc,gd){1!==this.controller.Um||t(gd.gotoCaller)||db.ULS.sendTraceTag(523015448,0,50,"ExcelLiveFollowerOrExplorer.onGoToEnded: Function called for viewport sync action");this.exa?t(gd.gotoCaller)?this.rma():this.sqd&&this.w8e(this.Kgg)&&(this.eo.nvd(),this.sqd=!1):(this.gridView.gtc(this.e$a),this.w8e(this.Kgg)&&this.eo.nvd())};x.prototype.Jpi=function(){var rc=this.gridView.gka().OL;return this.Ltd===
this.$.qa&&rc.equals(this.D8a)?!0:!1};x.prototype.gj=function(){this.rma()};x.prototype.bnc=function(){this.nzb=!0};x.prototype.fj=function(){this.nzb=!0};x.prototype.ppc=function(){this.Lgc=!0};x.prototype.ePa=function(){this.Lgc=!1};x.prototype.onScroll=function(rc){this.ozb&&1===this.controller.Um&&(this.ozb=!1,this.Yod=!0);rc.stopPropagation()};x.prototype.apc=function(){this.rma()};x.prototype.rma=function(){this.ohj();this.eo.cMj(this.UGb);this.A8(2,"ExcelLiveFollowerOrExplorer::onExploreActionsObserved");
this.xIe();this.Esb();this.controller.Kze()};x.prototype.IMg=function(){this.realtimeChannel.lGa(this.zma);this.$.ea.Foe(this.Znc);this.exa||Cc.a.instance.Wd(this.gridView.domElement).ka("scroll",this.onScroll);this.$.Zk(this.Zc);this.$.qa.Yd.iGa(this.u$a);this.$.qa.Yd.OZb(this.u$a);this.$.xa.zg(this.He)};x.prototype.Ceh=function(){this.realtimeChannel&&this.realtimeChannel.mAa(this.zma);null!==this.$&&(this.$.ea.Jcj(this.Znc),this.$.sm(this.Zc),this.$.qa.Yd.Sbb(this.u$a),this.$.qa.Yd.lKd(this.u$a),
this.$.xa.Vg(this.He))};x.prototype.zma=function(rc,gd){rc=mb.HelperMethods.Zb();this.xGd(gd.i4);this.EGd(gd.jP);this.eo.iMj(rc)};x.prototype.xGd=function(rc){var gd=this;!rc||1>rc.length||2===this.controller.Um||rc.forEach(function(kd){kd===gd.controller.JB&&(gd.controller.Nsc(),gd.A8(3,"ExcelLiveFollowerOrExplorer:processDisconnectedClients"))})};x.prototype.EGd=function(rc){!rc||1>rc.length||(rc=this.Mad(rc),null!==rc&&(this.mtd=rc,2!==this.controller.Um&&(3===this.controller.Um?this.Uzc(this.npd,
rc):(this.cNb(rc),this.eo.jMj(rc.MessageOriginTime)))))};x.prototype.ohj=function(){this.Uwa=this.ozb=this.nNa=this.nzb=this.Lgc=!1};x.prototype.Znc=function(){1!==this.controller.Um||this.nNa?this.eo.kMj():this.rma()};x.prototype.u$a=function(rc,gd){this.eo.mMj(gd)};x.prototype.He=function(){this.nNa||this.exa&&this.w6a||this.rma()};x.prototype.Zc=function(rc,gd){gd.Fg||this.eo.Jkc()};Object(sb.a)(x,"ExcelLiveFollowerOrExplorer",null,[]);var zb=b(29),Gc=b(51),Fc=b(104),Ed=b(393),Jc=b(15);r.prototype.dispose=
function(){this.Esb();this.Feh();this.$=this.gridView=this.viewBlockContainerHelpers=this.kPb=this.realtimeChannel=this.eQa=this.$t=null};r.prototype.Lid=function(){db.ULS.sendTraceTag(537162846,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action performed");this.eQa&&this.eQa.Pq&&Ed.a.gz.notificationBar.removeEntry(this.eQa);if(this.opd)this.P4f(),db.ULS.sendTraceTag(537162845,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action ignored due to floating object selection.");else{var rc=!0;this.bNa||
(rc=this.q2h());rc?this.E6f():this.P4f()}};r.prototype.zma=function(rc,gd){this.xGd(gd.i4);this.EGd(gd.jP)};r.prototype.Odc=function(){var rc=this;if(0===this.$t.Um)db.ULS.sendTraceTag(529064851,0,50,"ExcelLiveParticipantV0::HandleViewportChanged: Viewport changed for presenter.");else if(!this.kPb||this.kPb&&!this.kPb.yp)this.kPb=Fb.a.instance.create(function(){rc.rma()},500,"ExcelLiveParticipantV0.HandleViewportChanged",void 0,!0)};r.prototype.rma=function(){db.ULS.sendTraceTag(529064849,0,50,"ExcelLiveParticipantV0::onExploreActionsObserved: Explore action observed.");
this.mNe();this.bNa||this.C6f("ExcelLiveParticipantV0::onExploreActionsObserved")};r.prototype.P4f=function(){this.eQa||(this.eQa=Ed.a.gz.notificationBar.laa(Jc.a.instance.fa(2218),!1),this.eQa.image=0);Ed.a.gz.notificationBar.oE(this.eQa);db.ULS.sendTraceTag(528786756,0,50,"ExcelLiveParticipantV0.GoToPresenter - Action not performed. Location not available.")};r.prototype.initialize=function(){nc.e(this.$)?(this.F$h(),this.D0b()):(this.XMg(),this.paf())};r.prototype.F$h=function(){this.$t.A8(0,this.Nkc+
"initExcelLivePresenter")};r.prototype.paf=function(){var rc=this;++this.b3a;if(this.b3a>this.wTe)db.ULS.sendTraceTag(527766151,0,10,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Presenter data not available after "+(this.b3a-1)+" retries.");else{var gd=this.vTe();gd?this.naf(gd):(db.ULS.sendTraceTag(527766150,0,15,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Retry "+this.b3a+" - Presenter data not available."),Fb.a.instance.create(function(){rc.paf()},hc.a.Uva(this.b3a,this.xTe,
this.yTe,!0),"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable",void 0,!0))}};r.prototype.naf=function(rc){rc?(this.b3a=0,db.ULS.sendTraceTag(537162844,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update received from presenter with CID: "+this.$t.JB+" and messageId:"+this.wla),this.h7=rc,this.mNe(),this.bNa&&3===this.$t.Um?this.E6f():this.bNa||this.C6f("ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer")):db.ULS.sendTraceTag(527766149,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update not from presenter.")};
r.prototype.E6f=function(){this.$t.A8(1,"ExcelLiveParticipantV0::startFollowing");this.D0b();Va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveSurvey",!1)&&this.$t.jBc()};r.prototype.C6f=function(rc){this.$t.A8(2,rc);this.Esb();this.$t.Kze()};r.prototype.XMg=function(){this.realtimeChannel.lGa(this.zma)};r.prototype.Feh=function(){this.realtimeChannel.mAa(this.zma)};r.prototype.D0b=function(){this.gridView.nZa(this.Odc)};r.prototype.Esb=function(){this.gridView.Wbb(this.Odc)};
r.prototype.xGd=function(rc){var gd=this;!rc||1>rc.length||rc.forEach(function(kd){kd===gd.$t.JB&&(gd.h7=void 0,gd.$t.Nsc(),gd.$t.A8(3,"ExcelLiveParticipantV0::onMeetingPresenceUpdated"))})};r.prototype.EGd=function(rc){!rc||1>rc.length||(rc=this.vTe(rc),this.naf(rc))};r.prototype.vTe=function(rc){rc=(void 0===rc?null:rc)||this.realtimeChannel.Odd();if(!rc)return null;this.$t.JB||this.k9h(rc);if(this.$t.JB&&(rc=rc[this.$t.JB])){var gd=rc.MeetingInfo.MessageId;if(this.wla+1<gd)db.ULS.sendTraceTag(524940886,
0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Presenter message lost. LastMessageId: "+this.wla+", CurrentMessageId: "+gd);else{if(this.wla>gd)return db.ULS.sendTraceTag(524940885,0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Older Presenter message received. LastMessageId: "+this.wla+", CurrentMessageId: "+gd),null;if(this.wla===gd)return db.ULS.sendTraceTag(524940884,0,50,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Duplicate Presenter message received. LastMessageId: "+
this.wla+", CurrentMessageId: "+gd),null}this.wla=gd;return rc.SelectedRange}return null};r.prototype.k9h=function(rc){for(var gd in rc){var kd=gd,Qc=rc[gd];if((null===Qc||void 0===Qc?0:Qc.MeetingInfo)&&Qc.MeetingInfo.IsPresenter&&Qc.MeetingInfo.MeetingId===this.$.ya.MeetingId){this.wla=Qc.MeetingInfo.MessageId-1;this.$t.Sfg(kd,"ExcelLiveParticipantV0:identifyPresenterFromPresenceData");break}}};r.prototype.mNe=function(){if(this.h7){for(var rc=this.h7.length,gd=0;gd<rc;gd++){var kd=this.h7[gd].NamedObjectName;
if(zb.a.N0c(kd)){if(db.ULS.sendTraceTag(537162837,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to false"),this.opd=!1,this.h7[gd].SheetName===this.$.xa.qa.sheetName&&this.gridView.V5(Ob.D(this.h7[gd]))){db.ULS.sendTraceTag(537162836,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.bNa=!0;return}}else if(db.ULS.sendTraceTag(537162839,
0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to true"),this.opd=!0,this.h7[gd].SheetName===this.$.xa.qa.sheetName&&this.Wii(kd)){db.ULS.sendTraceTag(537162838,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.bNa=!0;return}}db.ULS.sendTraceTag(537162835,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to false")}this.bNa=
!1};r.prototype.Wii=function(rc){var gd=this;rc=Fc.a(this.$).Iq(rc);if(!rc||!rc.floatingObject||!rc.domElement)return!1;this.viewBlockContainerHelpers||Pa.TaskExtensions.Ba(Gc.GetServiceTaskFactory.Ua(this.$.da,103,104,0),function(Qc){gd.viewBlockContainerHelpers=Qc.result},this.$.la,8);if(!this.viewBlockContainerHelpers)return!1;var kd=this.viewBlockContainerHelpers.g_(rc.mg,rc.domElement);return rc.mg.Bn.Kd(kd)?!0:!1};r.prototype.q2h=function(){db.ULS.sendTraceTag(537162834,0,50,"ExcelLiveParticipantV0.GoToPresenterLocation - Update participant viewport");
var rc=this.h7&&0<this.h7.length?this.h7[0]:null;if(!rc||!rc.SheetName)return!1;var gd=this.$.xa.getItemByName(rc.SheetName);if(!gd||gd!==this.$.qa&&!gd.visible)return db.ULS.sendTraceTag(529109851,0,15,"ExcelLiveParticipantV0.GoToPresenterLocation - sheet not available"),!1;gd!==this.$.qa&&gd.activate();this.gridView.eu(Ob.D(rc),3,"ExcelLiveParticipantV0.GoToPresenterLocation");return!0};Object(sb.a)(r,"ExcelLiveParticipantV0",null,[]);y.prototype.dispose=function(){this.AWd=this.$=null};y.prototype.hMj=
function(rc){var gd=Yb.g(this.$).ha.ta.activeRange;rc=rc.Kd(gd)?!0:!1;gd=mb.HelperMethods.Zb();if(!rc&&0===this.KRa)this.KRa=gd;else if(0<this.KRa){var kd=gd-this.KRa;this.asb+=kd;this.KRa=gd;rc&&A(kd,"ExcelLivePresenter.trackAndLogSelectionVisibility: Selection was outside presenter Viewport. TimeSpentWithoutSelectionVisible")}};y.prototype.Jkc=function(){var rc=mb.HelperMethods.Zb(),gd=rc-this.gJf,kd=0;0<this.KRa&&(kd=rc-this.KRa,this.asb+=kd);var Qc={};Qc.PercentageTimeSelectionVisible=(gd-this.asb)/
gd*100;Qc.TimeSpentWithoutSelectionVisibleSinceLastBroadcast=kd;Qc.FirstMessageBroadcastTimestamp=this.Fbd;Qc.LastMessageBroadcastTimestamp=this.lBb;Qc.TotalMessagesBroadcasted=this.cDb;Qc.TimeSinceLastBroadcastInMs=rc-this.lBb;Qc.TimeToCreateNavigationStateAggregatesInMs=this.AWd;rc=ba.a.Lc(Qc);this.$.sendBeaconTraceTag(523015439,50,!1,"ExcelLivePresenter.logSessionTelemetry: "+rc)};y.prototype.fMj=function(rc){++this.cDb;var gd=mb.HelperMethods.Zb();this.Fbd=Math.min(this.Fbd,gd);var kd=gd-this.lBb;
this.lBb=Math.max(this.lBb,gd);db.ULS.sendTraceTag(523015438,0,50,"ExcelLivePresenter.trackAndLogMessageBroadcasted: Sent message number ["+rc+"] after ["+(gd-this.ssf)+"]ms of viewport change by presenter and after ["+kd+"]ms of sending previous message")};y.prototype.nMj=function(){this.ssf=mb.HelperMethods.Zb()};y.prototype.lwi=function(){var rc=mb.HelperMethods.Zb()-this.ssf;A(rc,"ExcelLivePresenter.getCurrentViewportNavigationState: TimeToCreateNavigationState");this.AWd.n3(rc)};Object(sb.a)(y,
"ExcelLivePresenterTelemetryHelper",null,[2]);h.prototype.dispose=function(){this.Heh();this.gridView=this.$=this.realtimeChannel=this.controller=null};h.prototype.tpb=function(){this.Knc=this.Knc.bind(this);this.iwa=this.iwa.bind(this);this.zdc=this.zdc.bind(this);this.Zc=this.Zc.bind(this)};h.prototype.JFj=function(){this.Eqc(!0);this.fNg()};h.prototype.fNg=function(){this.$.xa.GJ(this.zdc);this.gridView.nZa(this.iwa);this.gridView.ha.sE(this.iwa);this.$.Zk(this.Zc)};h.prototype.Heh=function(){this.$&&
(this.$.xa.lL(this.zdc),this.$.sm(this.Zc));this.gridView&&(this.gridView.Wbb(this.iwa),this.gridView.ha.xI(this.iwa))};h.prototype.zdc=function(){this.gridView.Wbb(this.iwa);this.gridView.XP(this.Knc)};h.prototype.Knc=function(){this.Eqc();this.gridView.mL(this.Knc);this.gridView.nZa(this.iwa)};h.prototype.iwa=function(){this.$.xa&&this.$.xa.qcf||this.Eqc()};h.prototype.Zc=function(rc,gd){gd.Fg||this.eo.Jkc()};h.prototype.MNh=function(){var rc=Date.now();this.eo.nMj();var gd=this.gridView.ebc();
if(null===gd)return null;var kd=this.gridView.gka().hD;rc={MessageOriginTime:rc};rc.SheetID=this.$.qa?this.$.qa.sheetName:null;rc.ZoomLevel=Sa.a(this.$).zoom;rc.SelectedRanges=Ob.k(this.gridView.ha.ta.selectedRanges,this.$);rc.IndexOfActiveRange=this.gridView.ha.ta.sB;rc.VisibleAreaRange=Ob.v(gd,this.$);rc.TopLeftCellOffsets={};rc.TopLeftCellOffsets.X=kd.x;rc.TopLeftCellOffsets.Y=kd.y;kd=T(this.$,rc.ZoomLevel);var Qc=kd.oPb;rc.ViewportHeight=kd.lPb;rc.ViewportWidth=Qc;this.eo.hMj(gd);this.eo.lwi();
return rc};h.prototype.gqj=function(){this.e0={};this.e0.MeetingId=this.$.ya.MeetingId;this.e0.IsPresenter=!0};h.prototype.Eqc=function(rc){var gd=this;rc=void 0===rc?!1:rc;var kd=this.MNh();if(null===kd)db.ULS.sendTraceTag(527962826,0,15,"ExcelLivePresenter:postViewportUpdatesToMeetingParticipants CurrentViewportNavigationState is null");else{var Qc={};Qc.MeetingInfo=this.e0;Qc.MeetingInfo.MessageId=++this.cDb;Qc.NavigationState=kd;Qc.NavigationState.MessageBroadcastTime=Date.now();this.realtimeChannel.qYf(Qc);
this.eo.fMj(this.cDb);rc&&Va.EwaSettings.isChangeGateEnabled("OfficeVSO:6085564_ExcelLive_ResendViewportStateAfterInterval")&&Fb.a.instance.create(function(){gd.Eqc(rc)},this.BDi+this.r1g(),"ExcelLivePresenter::postViewportUpdatesToMeetingParticipants",void 0,!0)}};h.prototype.r1g=function(){var rc=void 0===rc?-3E3:rc;return Math.random()*(3E3-rc+1)+rc};Object(sb.a)(h,"ExcelLivePresenter",null,[]);var Ca=b(1203);w.prototype.dispose=function(){this.$t=this.$=null};w.prototype.bMj=function(rc,gd){var kd,
Qc,de=mb.HelperMethods.Zb(),Xe=de-this.tVf;this.pkd=this.pkd||2==gd;2!==gd&&this.pkd&&++this.lVf;db.ULS.sendTraceTag(523015441,0,50,"ExcelLiveManagerTelemetryHelper::trackAndLogConnectionStateChanged: Recorded ConnectionState change from ["+rc+"] to ["+gd+"] after ["+Xe+"]ms with current participant role ["+this.$t.Um+"]");rc=Ca.a[rc];gd=Ca.a[gd];this.vJb.has(rc)||(this.vJb[rc]=1);this.vJb[gd]=1+(null!==(kd=this.vJb[gd])&&void 0!==kd?kd:0);this.ZMd[rc]=Xe+(null!==(Qc=this.ZMd[rc])&&void 0!==Qc?Qc:
0);this.Puc.has(rc)||(this.Puc[rc]=new M);this.Puc[rc].n3(Xe);this.tVf=de};w.prototype.Zwi=function(){var rc={};rc.RTCDisconnects=this.lVf;rc.RTCConnectionStateCounts=this.vJb;rc.RTCConnectionStateDurationsInMs=this.ZMd;rc.RTCConnectionStateDurationsAggregatesInMs=this.Puc;rc.MeetingID=this.$.ya.MeetingId;rc.AmIPresenter=this.$.ya.IsMeetingPresenter;rc.MeetingManagerCreated=this.Jwd;rc.SessionDurationInMs=mb.HelperMethods.Zb()-this.Jwd;rc=ba.a.Lc(rc);this.$.sendBeaconTraceTag(523015440,50,!1,"ExcelLiveManagerTelemetryHelper.logSessionTelemetry: "+
rc)};Object(sb.a)(w,"ExcelLiveManagerTelemetryHelper",null,[]);n.prototype.dispose=function(){this.vlb&&(this.vlb.dispose(),this.vlb=null);this.gjb&&(this.gjb.dispose(),this.gjb=null);this.Rib&&(this.Rib.dispose(),this.Rib=null);nc.g(this.$)&&(this.A2.mIb(this.zoc),this.$.sm(this.Zc));this.$=this.A2=this.Ffe=this.oqa=null};n.prototype.NVd=function(){this.OVe?this.OVe.NVd():db.ULS.sendTraceTag(537162880,0,10,"ExcelLiveManager::SyncToPresenter - FollowerOrExplorer object is not available to complete the action")};
n.prototype.Lid=function(){this.iSe?this.iSe.Lid():db.ULS.sendTraceTag(537162851,0,10,"ExcelLiveManager::GoToPresenter - ExcelLiveParticipantV0 object is not available to complete the action")};n.prototype.XZb=function(rc){this.oqa.XZb(rc)};n.prototype.uKd=function(rc){this.oqa.uKd(rc)};n.prototype.E$h=function(){nc.g(this.$)?nc.e(this.$)?this.vlb=new h(this.$,this.A2,this.oqa):this.gjb=new x(this.$,this.A2,this.oqa):nc.f(this.$)&&(this.Rib=new r(this.$,this.A2,this.oqa))};n.prototype.zoc=function(rc,
gd){gd.oldState!==gd.newState&&this.eo.bMj(gd.oldState,gd.newState)};n.prototype.Zc=function(rc,gd){gd.Fg||this.eo.Zwi()};Ck.Object.defineProperties(n.prototype,{Dn:{configurable:!0,enumerable:!0,get:function(){return this.Ffe}},yza:{configurable:!0,enumerable:!0,get:function(){return this.oqa.yza}},OVe:{configurable:!0,enumerable:!0,get:function(){return this.gjb}},presenter:{configurable:!0,enumerable:!0,get:function(){return this.vlb}},iSe:{configurable:!0,enumerable:!0,get:function(){return this.Rib}}});
Object(sb.a)(n,"ExcelLiveManager",null,[577,2]);m.prototype.dispose=function(){this.$=null};m.prototype.Fkj=function(rc,gd,kd){db.ULS.sendTraceTag(527171654,0,50,"ExcelLiveFollowerOrExplorer:"+kd+" Setting presenter information to CID: "+rc+" from CID: "+this.JB);this.JB=rc;this.Jza=gd.User.UserName;this.Rqc=gd.UserColor};m.prototype.Nsc=function(){this.Rqc=this.Jza=this.JB=void 0};Ck.Object.defineProperties(m.prototype,{Um:{configurable:!0,enumerable:!0,get:function(){return this.uee},set:function(rc){this.uee=
rc}},JB:{configurable:!0,enumerable:!0,get:function(){return this.afe},set:function(rc){this.afe=rc}},Jza:{configurable:!0,enumerable:!0,get:function(){return this.bfe},set:function(rc){this.bfe=rc}},Rqc:{configurable:!0,enumerable:!0,get:function(){return this.cfe},set:function(rc){this.cfe=rc}}});Object(sb.a)(m,"ExcelLiveParticipantModel",null,[2]);var bb=b(254),dc=b(12),Ac=b(272),nd=b(22);f.prototype.PKd=function(rc,gd,kd,Qc){kd=void 0===kd?null:kd;Qc=void 0===Qc?null:Qc;this.dya(rc,gd);this.Um=
gd;this.Jza=kd;this.dQa=Qc;this.$Ue?(this.$Ue=!1,this.XRf()):(this.FXd=!1,this.container.classList.add("ewa-excelLive-meetingPill-container-hidden"))};f.prototype.dispose=function(){$removeHandler(this.container,"transitionend",this.Poa);$removeHandler(this.container,"transitioncancel",this.Poa);this.container=null};f.prototype.Wf=function(rc,gd){if(gd)return!1;rc=this.container.querySelectorAll(dc.DOMElementExtensions.sr);var kd;for(gd=0;gd<rc.length;gd++){var Qc=rc[gd];dc.DOMElementExtensions.canReceiveFocus(Qc)&&
(kd=Qc)}if(!kd)return db.ULS.sendTraceTag(529109852,0,10,"ExcelLiveMeetingPillUtility.SetFocusOnSection: Could not find focusable element in live meeting pill"),!1;kd.focus();return!0};f.prototype.sh=function(rc){return dc.DOMElementExtensions.Gf(this.uc,rc)};f.prototype.Ej=function(){};f.prototype.Rj=function(){};f.prototype.initialize=function(rc,gd){this.container=document.createElement("div");this.container.id="excelLiveMeetingPillContainer";this.container.classList.add("ewa-excelLive-meetingPill-container");
gd.appendChild(this.container);nc.c(rc)&&(this.container.style.height="32px",db.ULS.sendTraceTag(529073433,0,50,"ExcelLiveMeetingPillUtility.initialize:Changed the height of meeting pill container for mobile"));this.Poa=this.O5h;$addHandler(this.container,"transitionend",this.Poa);$addHandler(this.container,"transitioncancel",this.Poa);Ac.a(rc).ai(this)};f.prototype.XRf=function(){var rc={};rc.participantRole=this.Um;Va.EwaSettings.isChangeGateEnabled("OfficeVSO:5931413_ShortenMeetingPillDisplayNameForMobile")&&
this.$.oN?(db.ULS.sendTraceTag(527991135,0,50,"ExcelLiveMeetingPillUtility.renderMeetingPillInternal: Getting shortened user name for mobile meeting pill"),rc.presenterName=this.kZh(this.Jza)):rc.presenterName=this.Jza;rc.presenterColor=this.dQa;appChrome.renderLiveMeetingPill(this.container,rc)};f.prototype.kZh=function(rc){if(nd.a.Gh(rc))return db.ULS.sendTraceTag(527991134,0,15,"ExcelLiveMeetingPillUtility.getShortenedUserName: Username is null or empty"),rc;var gd=rc.split(" "),kd=gd.length;return 2>
kd||nd.a.Gh(gd[kd-1])?rc:gd[0]+" "+gd[kd-1].substring(0,1)};f.prototype.dya=function(rc,gd){gd=ua[gd];if(0===this.lastUpdateTime)db.ULS.sendTraceTag(527766152,0,50,rc+"::FirstRole - ["+gd+"]"),this.lastUpdateTime=mb.HelperMethods.Zb();else{var kd=ua[this.Um];if(kd===gd)db.ULS.sendTraceTag(523548820,0,15,"{0}:RoleTransition: Received transition to participant role which is same as current role: [{1}]",rc,kd);else{var Qc=mb.HelperMethods.Zb()-this.lastUpdateTime;db.ULS.sendTraceTag(528786757,0,50,"{0}:RoleTransition: Transition participant role from [{1}] to [{2}] after {3}s",
rc,kd,gd,(Qc/1E3).toFixed(2));this.lastUpdateTime=mb.HelperMethods.Zb()}}};Ck.Object.defineProperties(f.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.container}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.container&&2===this.Um}},ve:{configurable:!0,enumerable:!0,get:function(){return bb.a.Klf}}});Object(sb.a)(f,"ExcelLiveMeetingPillUtility",null,[438,2]);e.prototype.HIb=function(rc,gd){this.Um=rc;this.dQa=void 0===gd?null:gd;appChrome.renderLiveMeetingBoundary(this.container,
this.HPg)};e.prototype.dispose=function(){this.container=null;this.$.AD(this.ebb);this.$.Hdj(this.ebb)};e.prototype.initialize=function(rc){this.tpb();this.container=document.createElement("div");this.container.id="excelLiveMeetingBoundaryContainer";this.container.classList.add("ewa-excelLive-meetingBoundary-container");rc.append(this.container);this.HIb(this.Um,this.dQa);this.$.RA(this.ebb);this.$.wHg(this.ebb)};e.prototype.tpb=function(){this.ebb=this.ebb.bind(this)};e.prototype.ebb=function(){this.HIb(this.Um,
this.dQa)};Ck.Object.defineProperties(e.prototype,{vFh:{configurable:!0,enumerable:!0,get:function(){var rc;return(rc=this.Ug?document.getElementById("AdditionalBarsRegion"):document.getElementById(this.$.Lb+Tb.a.ssb))?rc.clientHeight:0}},SSg:{configurable:!0,enumerable:!0,get:function(){var rc;return(rc=this.Ug?document.getElementById("BusinessBar"):document.getElementById(this.$.Lb+Tb.a.Xve))?rc.clientHeight:0}},lAh:{configurable:!0,enumerable:!0,get:function(){var rc=null;this.Ug&&(rc=document.getElementById("FarPaneRegion"));
return rc?rc.clientWidth:0}},kKg:{configurable:!0,enumerable:!0,get:function(){var rc=nc.c(this.$)?(rc=document.getElementById(this.$.Lb+Tb.a.J0a))?rc.clientHeight:0:this.$.jla?0:this.$.$Tg();return rc}},bwj:{configurable:!0,enumerable:!0,get:function(){var rc;return(rc=this.Ug?document.getElementById("Header"):document.getElementById(Tb.a.HGa))?rc.clientHeight:0}},q1c:{configurable:!0,enumerable:!0,get:function(){return this.Ug?document.getElementById("EditorContainer"):this.$.FE}},bve:{configurable:!0,
enumerable:!0,get:function(){return this.bwj+this.kKg+this.SSg+this.vFh}},GPg:{configurable:!0,enumerable:!0,get:function(){return this.q1c.clientLeft}},IPg:{configurable:!0,enumerable:!0,get:function(){return this.q1c.clientWidth+this.lAh-3}},FPg:{configurable:!0,enumerable:!0,get:function(){if(this.Ug){var rc=document.getElementById("StatusBar");return rc.offsetTop+rc.clientHeight-this.bve}return this.q1c.clientHeight}},HPg:{configurable:!0,enumerable:!0,get:function(){var rc={};rc.participantRole=
this.Um;rc.presenterColor=this.dQa;rc.top=this.bve;rc.left=this.GPg;rc.width=this.IPg;rc.height=this.FPg;rc.size=3;return rc}}});Object(sb.a)(e,"ExcelLiveMeetingBoundaryUtility",null,[2]);var qd=b(90),Gb=b(44),Oc=b(188),he=ub.a;Am(c,he);c.prototype.dispose=function(){this.$=null;this.jw&&(this.jw.dispose(),this.jw=null);this.BJa&&(this.BJa.dispose(),this.BJa=null);this.AJa&&(this.AJa.dispose(),this.AJa=null);this.LMa&&(qd.a.Ha(this.LMa),this.LMa=null)};c.prototype.A8=function(rc,gd){this.jw.Um&&this.jw.Um===
rc||(this.jw.Um=rc,this.aSf(gd))};c.prototype.Sfg=function(rc,gd){if(!rc)return db.ULS.sendTraceTag(528086352,0,10,"ExcelLiveController:savePresenterDetails Presenter CID is undefined"),!1;var kd=this.$.ea.iid(rc);if(!kd)return db.ULS.sendTraceTag(528086351,0,10,"ExcelLiveController:savePresenterDetails Failed to get presenter information from sessionStateManager"),!1;this.jw.Fkj(rc,kd,gd);this.aSf(String.format("{0};{1}",gd,this.Nkc+"savePresenterDetails"));this.raiseEvent(c.IFd);return!0};c.prototype.Nsc=
function(){this.jw.Nsc()};c.prototype.XZb=function(rc){this.addHandler(c.IFd,rc)};c.prototype.uKd=function(rc){this.removeHandler(c.IFd,rc)};c.prototype.jBc=function(){var rc=this;this.LMa=Oc.AsyncMethodContext.av(function(){rc.$.Zd(-1404915046,-1,0,null)},this.$.ya.ExcelLiveSurveyTriggerThresholdTimeInMs,Gb.a.jBc,this.LMa)};c.prototype.Kze=function(){this.LMa&&this.LMa.cancel()};c.prototype.Sai=function(){this.jw=new m(this.$);var rc=this.$.FE;ob.AFrameworkApplication.sa.Pa.Ug&&(rc=document.getElementById("StatusBarRegion"));
this.BJa=new f(this.$,rc);rc=this.$.kr;ob.AFrameworkApplication.sa.Pa.Ug&&(rc=document.getElementById("regionComposerRoot"));this.QAb&&(this.AJa=new e(this.$,rc));rc=nc.e(this.$)?0:3;this.A8(rc,this.Nkc+"initializeController")};c.prototype.aSf=function(rc){switch(this.jw.Um){case 2:this.BJa.PKd(rc,this.jw.Um,this.jw.Jza);this.QAb&&this.AJa.HIb(this.jw.Um);break;case 1:this.BJa.PKd(rc,this.jw.Um,this.jw.Jza,this.jw.Rqc);this.QAb&&this.AJa.HIb(this.jw.Um,this.jw.Rqc);break;case 3:case 0:this.BJa.PKd(rc,
this.jw.Um),this.QAb&&this.AJa.HIb(this.jw.Um)}};Ck.Object.defineProperties(c.prototype,{yza:{configurable:!0,enumerable:!0,get:function(){return this.jw}},Um:{configurable:!0,enumerable:!0,get:function(){return this.jw.Um}},JB:{configurable:!0,enumerable:!0,get:function(){return this.jw.JB}}});c.IFd="PDS";Object(sb.a)(c,"ExcelLiveController",ub.a,[2]);var Wd=Ya.a;Am(a,Wd);a.prototype.create=function(){this.D$h()};a.prototype.dispose=function(){this.Dn&&this.Dn.AIb(this.oPa);this.Dn=null;this.$t&&
(this.$t.dispose(),this.$t=null);Wd.prototype.dispose.call(this)};a.prototype.D$h=function(){var rc=this;this.$t=new c(this.$);this.$.da.$a(26,function(gd){rc.Dn=gd;rc.$1g()})};a.prototype.$1g=function(){db.ULS.sendTraceTag(537162850,0,50,"ExcelLiveCommandHandlerFactory::ConnectToRealTimeChannel - attach RealTimeChannelInitialized handler");this.Dn.fWc(this.oPa);this.Dn.h0a()};a.ka=function(rc){db.ULS.sendTraceTag(537162848,0,50,"ExcelLiveManagerFactory::Attach: Begin service registration");rc.da.Ga(474,
new a(rc));db.ULS.sendTraceTag(537162847,0,50,"ExcelLiveManagerFactory::Attach: Complete service registration")};Object(sb.a)(a,"ExcelLiveManagerFactory",Ya.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ExcelLive");Type.registerNamespace("_Ewa");Ta.a.Li(".ewa-excelLive-meetingPill-container{height:24px;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s;position:absolute;width:100%;bottom:0;pointer-events:none;z-index:992}.ewa-excelLive-meetingPill-container-hidden{height:0 !important;overflow:hidden;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s}.ewa-excelLive-meetingBoundary-container{position:fixed;z-index:992}");
Type.registerNamespace("Common.App.RtcHostNotificationSubscription");xa.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");Type.registerNamespace("Common.App.LivePersonaCard");ea.main();Type.registerNamespace("AppRealtimeChannel");(function(){ib.a.Fa(function(rc){a.ka(rc);R.ka(rc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rt.js.map/0a0300ce2cf356d34a89da02d7dd7257/EwaDS.rt.js.map