(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1443:function(z,E,b){function a(k){var G=ij.call(this)||this;G.$=k;G.Tb();return G}function c(){}function e(k){var G=vh.call(this)||this;G.wi=null;G.lh=null;G.$=k;G.Tb();return G}function f(k,G,d){var S=og.call(this,k)||this;S.te=null;S.DAe=null;S.Np=!1;S.Eu=0;S.Zc=function(P,ja){ja.Fg||S.jg(!1)};S.ak=function(){S.jg(!1);S.raiseEvent("PQTPC");return!0};S.$=G;S.taskPaneManager=d;he.a(G).ai(S);S.$.Zk(S.Zc);return S}function m(){}
function n(k){return oh.call(this,k)||this}function w(k,G){this.Hqc=null;this.$=k;this.e0i=G}function h(k,G){var d=this;this.Gqc=this.tjb=this.Qma=this.hAc=this.powerQueryTaskPane=null;this.tGf=this.yf=!1;this.stateId=0;this.BIf=!1;this.cFb=function(){d.hideTaskPane();ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected")&&d.$.Hb.Vg(d.He)};this.onCancelQueryRefresh=function(S){d.powerQueryManager.CVg(S)&&d.Qma.r7f([S])};this.vBd=function(S){if(S&&!Dc.a(S))try{var P=
S.Result;if(P.Queries){d.G0.clear();for(var ja=Cl(P.Queries),D=ja.next();!D.done;D=ja.next()){var da=D.value;d.G0.add(da.Name,da)}}d.Xuj(P.QueryGroups);dc.ULS.sendTraceTag(537154435,0,50,"PowerQueryPaneManager.OnGetQueriesSuccess: type of queries: {0}",d.queries?Object.getType(d.queries).toString():"null");dc.ULS.sendTraceTag(537154434,0,50,"PowerQueryPaneManager.OnGetQueriesSuccess: no. queries: {0}",d.queries?d.queries.length.toString():"null");if(ue.EwaSettings.aic()&&P.PowerQueryConnectionsInfo){d.WF.clear();
for(var Ha=Cl(P.PowerQueryConnectionsInfo),jb=Ha.next();!jb.done;jb=Ha.next()){var kc=jb.value;d.WF.add(kc.QueryName,kc)}}d.Syf()}catch(Jb){dc.ULS.sendTraceTag(537154433,0,10,"PowerQueryPaneManager.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception {0}.",Jb)}};this.Tyf=function(){d.Syf()};this.IEb=function(){dc.ULS.sendTraceTag(537154432,0,15,"PowerQueryPaneManager.OnGetQueriesFailure")};this.He=function(S,P){P.qa&&2===P.qa.type&&d.TVd.xb(P.qa.name)&&d.updateTaskPane(null,null,d.TVd.getItem(P.qa.name))};
this.If=function(){var S=d.$.ea.Rm.PowerQueryStateId;dc.ULS.sendTraceTag(537154403,0,50,"PowerQueryPaneManager.OnWorkbookMetadataChanged: powerQueriesStateId: {0}, this.stateId: {1}",S,d.stateId);S>d.stateId&&d.yf&&d.eYf();d.stateId=S};this.qCf=function(S,P){S=[];for(var ja=Cl(d.WF.values),D=ja.next();!D.done;D=ja.next())if(D=D.value,P===D.ConnectionName&&(D=D.QueryName,d.u7a(D))){Array.add(S,D);break}d.Qma.N6f(S)};this.Aoc=function(S,P){if(P&&P.Result){S=P.Result;P=[];for(var ja=Cl(d.WF.values),
D=ja.next();!D.done;D=ja.next())if(D=D.value,S===D.ConnectionName&&(D=D.QueryName,d.u7a(D))){Array.add(P,D);break}d.Qma.r7f(P)}};this.$=k;this.powerQueryManager=G;this.TVd=new vb.a(!0);this.VPc=new vb.a(!1);this.G0=new vb.a(!1);this.Ybi(k);this.Pma=ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient");this.Pma||(this.$.ea.Ot(this.If),this.$.ea.Rm&&(this.stateId=this.$.ea.Rm.PowerQueryStateId));qf.a(this.$).npe(this.Aoc);qf.a(this.$).ope(this.qCf);this.Pma&&this.powerQueryManager.bIg(this.Tyf);
dc.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}function y(k,G){var d=this;this.fwa=new vb.a(!1);this.pK=new vb.a(!0);this.k5a=new vb.a(!0);this.l5a=this.F0=null;this.lOf=0;this.handleQueryGroupOperation=function(S,P){var ja={};ja.Id=P.id;ja.Name=P.name;ja.Description=P.description;ja.ParentId=P.parentId;d.jda.handleQueryGroupOperation(S,ja)};this.handleQueryAction=function(S,P){var ja={},D=d.$.da.Aa(470);ja.Name=P.name;ja.ExtraData=P.extraData;ja.Formulas=D.formulas;
D.handleQueryAction(S,ja)};this.$=k;this.jda=G;this.isVisible=!1;this.wbb=new vb.a(!0);this.DId={}}function r(){this.name=null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;this.refreshEnabled=this.inRefresh=!1}function x(){this.callbacks=this.selectedQueryKey=this.groups=this.queries=this.type=null}function t(){this.handleQueryAction=this.onCancelQueryRefresh=this.handleQueryGroupOperation=
this.onQueryRefresh=this.onQuerySelected=null}function u(){this.name=this.key=null;this.startIndex=this.count=0;this.data=this.children=null;this.level=0}function B(k){var G=Fh.call(this)||this;G.$=k;G.Tb();return G}function v(k){var G=this;this.stateId=0;this.WGe=!1;this.tjb=null;this.S$d=!1;this.e8d=null;this.If=function(){var d=G.$.ea.Rm.PowerQueryStateId;dc.ULS.sendTraceTag(537154444,0,50,"PowerQueryManager.OnWorkbookMetadataChanged: powerQueriesStateId: {0}, this.stateId: {1}",d,G.stateId);d>
G.stateId&&G.U9b().continueWith(function(S){S.result?G.stateId=d:dc.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})};this.Io=function(){G.U9b()};this.RSj=function(d){if(d&&!Dc.a(d)){d=d.Result;if(d.Queries){G.G0.clear();for(var S=Cl(d.Queries),P=S.next();!P.done;P=S.next()){P=P.value;try{G.G0.add(P.Name,P)}catch(D){dc.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}}G.tjb=
d.QueryGroups;dc.ULS.sendTraceTag(537154441,0,50,"PowerQueryManager.OnGetQueriesSuccess: no. queries: {0}",G.queries?G.queries.length.toString():"null");if(d.PowerQueryConnectionsInfo){G.WF.clear();S=[];P=Cl(d.PowerQueryConnectionsInfo);for(var ja=P.next();!ja.done;ja=P.next()){ja=ja.value;try{G.WF.add(ja.QueryName,ja)}catch(D){dc.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),S.push(ja.QueryName)}}ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6212633_BlockRefreshForQueriesWithoutConnection")&&
S.forEach(function(D){G.WF.remove(D)})}G.e8d=d.Formulas;G.WGe=!0}};this.IEb=function(){dc.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.HUi=function(d){G.Qa.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",d)};this.GUi=function(d){G.Qa.raiseEvent("OnUpdatePowerQueryDataFailed",d)};this.$=k;this.G0=new vb.a(!1);this.VPc=new vb.a(!1);this.Qa=new Zh.a;this.$.ea.Ot(this.If);ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6242825_RegisterLoadOnDemandOccurredOnPQManager")&&
this.$.ea.vM(this.Io);this.$.ea.Rm&&(this.stateId=this.$.ea.Rm.PowerQueryStateId);gf.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(d){d.isFeatureEnabled("ExcelPowerQuery",!1).then(function(S){G.S$d=S;return null})})}function C(k){return Eh.call(this,k)||this}function A(k){var G=Xg.call(this)||this;G.hqc=null;G.sbb=!1;G.Wza=null;G.AId=!1;G.Qa=new Zh.a;G.Ox=null;G.ivg=new Map;G.a8i=!1;G.TVb=[];G.eei=function(S){G.XXc(S.Ea)};G.GUg=function(){G.aQd(0);
G.iOf(!0,null,!1)};G.AQi=function(S){S.RequestId||(G.oab=null,G.$.ea.Hp(S.Errors))};G.BQi=function(S){G.oab=null;S=oe.a.pg(S.data);G.$.ea.Hp(S)};G.nCf=function(S){G.oCf(S);if(S.DepartableWebMethodOperationCompleted||S.Errors&&0<S.Errors.length)G.a8i=!1,G.Qa.raiseEvent("refreshAllCompleted",S,G)};G.YMi=function(S){S&&!Dc.a(S)&&(!(S=S.Result)||1>S.length||(G.Ox&&G.Ox.C(),G.Ox=new tg.a,G.Mag(S,0,G.Ox.token)))};G.XMi=function(S){dc.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");
S=oe.a.pg(S.data);G.$.ea.Hp(S)};G.kd=function(){G.Gnd()};G.MF=function(){ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&G.Gnd()};G.V9a=function(S,P){var ja=P.nd.block,D=ja.ze.PeriodicRefreshExpiryInSeconds;void 0!==D&&G.o0f(D);D=Sc.g(G.$);5===ja.state&&S===D.Ea&&((S=(S=D.zG(P.nd.hash))?S.uf:null)&&!S.Kd(D.ha.ta.activeCell)||G.Gnd())};G.qd=function(){G.$.ea.sc||G.clear()};G.$=k;G.zEd=-1;G.oab=null;k=Sc.g(G.$);var d=k.ha;d.sE(G.kd);d.hsa(G.kd);
k.Ea.oha(G.V9a);G.$.xa.isa(G.MF);G.$.Hb.isa(G.MF);G.XXc(k.Ea);G.XXc(zc.a(G.$).Ea);G.$.da.$a(36,G.eei);G.$.ea.gk(G.qd);ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")&&(k=G.$.ya.StartupDelayMultiplierForLabelsOnRefreshOnOpen*G.$.ya.TimeToWaitForApplyingSensitivityLabels,dc.ULS.sendTraceTag(537163332,306,50,"DataRefreshManager async call to UpdateSensitivityLabels after {0} ms.",k),Jf.a.instance.create(function(){G.HCc()},k,$f.a.Xbh,!0,!0));return G}function M(k,G,d,S,P,ja,
D,da,Ha){var jb=da?"RefreshAllDirtyDataSources":"RefreshAll";Ha=k.Na(1,Ha);var kc=Ha.context;kc.RequestId=d;kc.CompleteResponseTimeout=S;Ha.periodic=G;return Xe.i(k,jb,Ha,P,ja,D,da,G?8:0)}function T(k,G){return Mf.call(this,k,T.jR(G))||this}function R(k,G,d,S,P,ja){P=void 0===P?je.a.y6c:P;return yf.call(this,k,G,d,S,P,void 0===ja?null:ja)||this}function Q(k,G){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=k;this.pivotTableName=G}function ea(k){return qi.call(this,k)||this}function Z(k){var G=
pg.call(this)||this;G.wi=null;G.lh=null;G.$=k;G.Tb();return G}function ca(k,G,d){var S=pi.call(this,k)||this;S.te=null;S.GAe=null;S.Eu=0;S.es=!1;S.Zc=function(P,ja){ja.Fg||S.jg(!1)};S.ak=function(){S.jg(!1);S.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};S.$=G;S.taskPaneManager=d;S.$.Zk(S.Zc);S.ha=Sc.g(S.$).ha;he.a(G).ai(S);return S}function I(){}function H(k){var G=Ag.call(this)||this;G.$=k;G.Tb();return G}function L(k){var G=this;this.kqc=this.uGb=this.pivotTableSettingsTaskPane=null;
this.yf=!1;this.nda="";this.Kza=!1;this.iJf=0;this.Y3=this.Rma=this.y5b=this.hJf=null;this.es=this.POa=!1;this.GQi=function(d,S){if(Dc.a(d)){var P=d.Errors[0].Description;d=d.Errors[0].MessageId;var ja=S.KHf;S=S.LHf;var D=G.$ja();if(!D||S!==D.fda)if(G.Rma&&S===G.Rma.fda)D=G.Rma;else{dc.ULS.sendTraceTag(537154689,0,50,"OnPivotTableSettingsChanged Cannot Find PivotTable for opType: {0}",ja);return}switch(ja){case 1:D.pivotTableName=G.nda;break;case 2:D.rwGrandTotalOn=G.Kza;break;case 3:D.colGrandTotalOn=
G.Kza;break;case 12:D.errorString=G.nda;break;case 13:D.nullString=G.nda;break;case 14:D.saveSourceDataWithFile=G.Kza;break;case 15:D.refreshOnLoad=G.Kza;break;case 16:D.altText=G.nda;break;case 17:D.altTextSummary=G.nda;break;case 20:D.indentIncrement=G.iJf}dc.ULS.sendTraceTag(537154688,0,50,"OnPivotTableSettingsChangedSuccessCallback encounters error {0} {1} for opType: {2}",d,P,ja);G.updateTaskPane(G.$ja())}};this.dFb=function(){G.hideTaskPane(!0)};this.kma=function(){var d=G.gridView.inRangePicker||
G.gridView.Ni||!!(G.ha.Ue&470);Se.a.Ld(G.$)?(G.vp()&&!d&&G.ddg(),G.NCc()):G.yf&&!d&&(G.ddg(),G.Y3!==G.Rma&&G.Y3&&G.updateTaskPane(G.$ja(),!0))};this.Uq=function(){Se.a.Ld(G.$)?(G.vp()&&(G.Y3=G.$ja()),G.NCc()):G.yf&&(G.Y3=G.$ja(),G.updateTaskPane(G.Y3))};this.$=k;this.gridView=Sc.g(this.$);this.Xbi(k);this.ha=this.gridView.ha;this.ha.FJ(this.kma);this.gridView.rE(this.kma);this.gridView.XP(this.Uq);this.pM=Array(6);for(k=0;k<this.pM.length;k++)this.pM[k]=!1}function U(){this.enabled=!1;this.caption=
this.sheet=this.name=null}function fa(){this.pivotTableName=null;this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=!1;this.slicerConnections=this.altTextSummary=this.altText=null}function aa(k,G){this.$=k;this.pivotTableSettingsPaneManager=G}
function na(){this.onSettingChange=this.settingsInfo=this.type=null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=this.isRangeChanged=!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}function ha(){this.KHf=0;this.LHf=null}function ka(k,G,d,S,P){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;this.userInputInt=0;this.activeCell=k;this.pivotTableName=G;this.opType=d;this.userInputText=S;this.userInputInt=
P}function xa(k){return ki.call(this,k)||this}function va(k){var G=this;this.activeCell=this.Gc=null;this.KMi=function(d){d&&!He.a.rh(d.Errors)&&G.Utd(d.Result)};this.JMi=function(){};this.MMi=function(d){d&&!He.a.rh(d.Errors)&&G.Vtd(d.Result)};this.LMi=function(){};this.IMi=function(d,S){d&&!He.a.rh(d.Errors)&&G.Rtd(d.Result,S)};this.HMi=function(){};this.$=k;this.ha=Sc.g(this.$).ha}function Aa(){var k=Qh.call(this)||this;k.Tb();return k}function qa(k,G){return rj.call(this,k,G)||this}function wa(k,
G,d,S){var P=wi.call(this,G,k,!1)||this;P.O2d=null;P.Mi=null;P.pxc=new vb.a(!0);P.e4=new vb.a(!0);P.Tta=null;P.B1a=null;P.OIb=null;P.jPb=!1;P.rBb=null;P.hashCode=null;P.kBc=!1;P.hTa=null;P.yBb=qb.a.Ta.Wb;P.businessBar=null;P.Aoc=function(ja,D){D&&D.Result&&(ja=D.Result,ja.DataConnections&&ja.DataConnections.DataConnections&&P.mOf(ja.DataConnections))};P.zf=function(ja,D){switch(D.nd.block.state){case 1:case 3:case 5:P.Tna(D)}};P.Tm=function(){};P.Go=function(ja,D){P.W8c();D.qa&&P.isVisible&&P.Fsi(!gg.j(D.qa));
P.clearCache();P.zR=!1};P.YN=function(ja){switch(ja.au){case 1:P.kBc&&P.Iac(P.Mi)}};P.zd=function(ja,D){D.tW||(P.W8c(),ja=P.$,P.eub=Rb.d(ja.kg),ja.ea.BCa.getTime()>P.BCa.getTime()&&(P.T2b(),P.BCa=ja.ea.BCa),P.wxa&&P.Iac(P.Mi))};P.He=function(){P.gTa(!1)};P.$N=function(){P.$.ea.Ema()};P.onKeyDown=function(ja){ja=P.$.shortcutKeyManager.du(ja);P.executeRibbonCommand(ja)};P.fj=function(){P.Mi&&P.Mi.mUa()};P.Z6=function(){P.uec();P.UJ.Wba=!0};P.Y6=function(){P.UJ.tAb||P.UJ.YAb||P.fOb();P.UJ.Wba=!1};P.TEb=
function(){P.uec();P.UJ.Wba=!0};P.su=function(){P.UJ.tAb||P.UJ.YAb||P.fOb();P.UJ.Wba=!1};P.KCf=function(){P.UJ.tAb=P.kJb.FN&&P.kJb.RZi;P.UJ.tAb?P.uec():P.UJ.Wba||P.UJ.YAb||P.fOb()};P.TBf=function(){switch(ph.a(P.$).state){case 0:case 1:case 2:case 4:P.UJ.tAb||P.UJ.Wba||P.fOb();P.UJ.YAb=!1;break;case 5:case 3:case 7:case 8:case 6:P.uec(),P.UJ.YAb=!0}};P.OLi=function(ja,D){if(P.gNa(3)||P.wxa){var da=ja.Result;ja=P.wxa;if(null===da||void 0===da?0:da.ReportData)P.OIb=da.ReportData;if(da&&da.DataConnectionsInfo)if(da=
da.DataConnectionsInfo,1===da.DataConnections.length&&da.DataConnections[0].StreamingFailed)P.T2b(),P.gTa(!0);else{var Ha=!0;P.B1a=da.DataSources;for(var jb=Cl(da.DataConnections),kc=jb.next();!kc.done;kc=jb.next())if(kc=kc.value,kc.IsReady||0>kc.SourceIndex){var Jb=kc.ConnectionName.toLowerCase();P.e4.getItem(Jb)||P.e4.add(Jb,kc)}else{D.Blh();Ha=!1;break}Ha&&(ja?P.mOf(da):(P.Mi.t_=4,P.Hfb(D,null)))}else P.Mi.t_=1}};P.ZMi=function(ja){ja&&P.$.ea.Hp(ja.Errors)};P.n6a=new Di.a(k,k.ea,k.na.Kk,4,0);P.BCa=
k.ea.BCa;P.eub=!k.wc.refreshConfirmationRequired||Rb.d(k.kg);P.wNe=!1;P.domElement.classList.add(Je.a.j9b);P.domElement.style.overflow="hidden";P.domElement.tabIndex=0;P.gTa(!1);P.Fc.ka("mousedown",P.$N);P.Fc.ka("keydown",P.onKeyDown);k.xa.GJ(P.Go);k.Hb.GJ(P.Go);k.Hb.zg(P.He);k.xa.zg(P.He);k.RA(P.fj);k.zb.h_b(P.Z6);k.zb.g_b(P.Y6);k.Ka.VVc(P.TEb);k.Ka.hGa(P.su);ph.a(k).Aq(P.TBf);P.Ea.Ss(P.zf);P.Ea.UG(P.Tm);qf.a(k).Zoe(P.Aoc);k.tl(P.zd);ue.EwaSettings.qc()&&P.Nt(P.Nya);cb.a(k).gR(xh.a.idle).Aq(P.YN);
P.kJb=d;P.kJb.tE(P.KCf);P.UJ=new Ta;P.s1b=S;ta.ka(k,P);return P}function Ta(){this.YAb=this.Wba=this.tAb=!1}function sb(k,G){this.Syc=k;this.O9b=G}function db(k,G,d,S,P){var ja=this;this.interactiveReportContent=this.rqc=this.FG=null;this.Cbf=!1;this.KZi=function(){ja.interactiveReportView.Iac(ja)};this.G9d=k;this.grg=d;this.$=P;this.FG=S?new kb(G):new ac(G,d);this.t_=this.FG.Faf;this.mUa()}function kb(k){this.c6a=document.createElement("img");dd.DOMElementExtensions.setVisible(this.c6a,!0);this.c6a.setAttribute("style",
"height: 80%; width: auto");this.r7b=document.createElement("div");this.r7b.id=k;this.r7b.appendChild(this.c6a)}function ac(k,G){var d=this;this.iframe=document.createElement("iframe");this.iframe.src=G;this.iframe.frameBorder="0";this.iframe.scrolling="no";this.iframe.id=k;this.fja=Ei.a.instance.Wd(this.iframe);this.fja.ka("load",function(){InteractiveReportAPI.SetHost(d.contentWindow,G)})}function ta(k){this.interactiveReportView=k}function ra(k){return $g.call(this,k)||this}function Na(k){this.activeCell=
this.Gc=null;this.$=k;this.ha=Sc.g(this.$).ha}function gb(k,G,d){var S=be.call(this,k)||this;S.U5f=null;S.rdi=function(P,ja){1===P?(P=ja.indices,dc.ULS.sendTraceTag(537155741,0,50,"InsertSlicerDialog.ClickedOK: User clicked OK, inserting {0} Slicers",P.length),0<P.length&&S.dfh(P)):dc.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};S.vMi=function(P){S.U5f=P.Result;P={};P=(P.id=S.Cc,P.singleDimFields=S.U5f,P);S.initializeAndShow(Zb.a.instance.fa(2101),S.rdi,
P)};S.gridView=Sc.g(k);S.ta=S.gridView.ha.ta;S.ha=Sc.g(k).ha;S.pivotTableName=G;S.IEd=d;Sc.g(k).Rb.lp(S.ha.ta.activeCell);dc.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");S.Jci();return S}function ob(k){return Hf.call(this,k)||this}function wb(k){var G=this;this.Eld=!1;this.w$=this.f9h=null;this.$=k;this.gridView=Sc.g(k);gf.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(d){G.w$=d;d.isFeatureEnabled(wb.s$e,
!1).then(function(S){return G.Eld=S});G.f9h=d.cna(wb.s$e,function(S){G.Eld=S.isEnabled})})}function Oa(k,G){var d=Wg.call(this,k,new sa(k))||this;d.bTa=null;d.Dya=null;d.Maa=null;d.destinationRange=null;d.oWd=null;d.wBa=!1;d.fv=0;d.mEj="";d.sIe="";d.nbf=function(S,P){d.hide();if(1===S){var ja=S="";2!==d.fv&&(S=Oa.$Dd(P[Oa.$yc],d.$.xa),d.lEj(S,d.$)&&dc.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));1!==d.fv&&P[Oa.ead]&&
(ja=Oa.$Dd(P[Oa.F6b],d.$.xa));2===d.fv&&ja===d.sIe||d.Ici(S,ja)}else d.YLb(!0,!0),dc.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};d.qu=function(){d.aCa()};d.tnc=function(){d.destinationRange.disabled=!d.Maa.checked;d.aCa();return!1};d.$wf=function(){d.aCa();return!1};d.fEf=function(){d.aCa();return!1};d.JBd=function(S){if(Dc.a(S))d.YLb(!0,!0),dc.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");
else if(dc.ULS.sendTraceTag(537155743,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - success."),S=S.Result){var P=d.$.xa.getItemByName(S.SheetName);P&&(P.activate(),d.gridView.Eg(S,null,null,null,3,jc.a.qdi),d.YLb(!0,!1),0===d.fv&&d.Rqj(),S=de.a.Krc,S!==Sf.a(d.$).Wm.Mo&&(Sf.a(d.$).dHb(2),Sf.a(d.$).Wm.activateRibbonTab(S)))}else d.YLb(!0,!1)};d.gridView=Sc.g(d.$);d.uR=ug.a.instance;d.dw=!1;-1128516639===G?(d.fv=1,dc.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):
-63037693===G?(d.fv=2,dc.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):dc.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog");return d}function sa(k){return af.call(this,k)||this}function Fa(k,G){this.destinationRange=this.sourceRange=null;this.sourceRange=k;this.destinationRange=G}function Wa(k,G,d,S,P,ja,D){D=k.Na(1,void 0===D?null:D);D.activeCell=G;return Xe.i(k,"GetDataSourceRangeForPivotTable",
D,d,S,P,ja,0)}function Db(k,G,d,S,P,ja,D,da,Ha){Ha=k.Na(41,void 0===Ha?null:Ha);Ha.activeCell=G;Ha.newRange=d;Ha.isDataSource=S;return Xe.i(k,"ChangePivotLocation",Ha,P,ja,D,da,0)}function pc(k,G){this.title=k;this.gg=G}function lc(k,G){this.CXb=k;this.Wug=G;this.xrc=null}function eb(){}function ib(){this.G6b=this.sourceRange=this.rea=null}function cc(k){var G=Ud.call(this)||this;G.$=k;G.Tb();return G}function Pa(k,G,d,S){var P;var ja=Od.call(this,k)||this;ja.$ad=300;ja.Zad=250;ja.YQ=new ua;ja.$Q=
new ua;ja.b7c={};ja.Xj=null;ja.zi=null;ja.ZQ=null;ja.RC=null;ja.HTe=null;ja.Y9b=null;ja.Rad=null;ja.Eba=null;ja.cl=null;ja.sog=!0;ja.N6c=0;ja.dva=!1;ja.rn=null;ja.cu=null;ja.aJa=null;ja.gL=null;ja.fF=null;ja.fI=null;ja.tPb=null;ja.HW=null;ja.mmf=!1;ja.t1b=!1;ja.Npb=!1;ja.zk=null;ja.Oub=Pa.WDc;ja.currentState=ub.Q4b();ja.KGa=null;ja.kta=null;ja.WU=null;ja.YA=null;ja.K1c=null;ja.gtb=null;ja.T7b=null;ja.ftb=null;ja.R7b=null;ja.S7b=null;ja.bJa=null;ja.rza=null;ja.Uqb=null;ja.tJb=null;ja.K_d=null;ja.jbd=
null;ja.hca=0;ja.Upd=!1;ja.PKb=!1;ja.pja=null;ja.yf=!1;ja.l7a=!1;ja.s7=null;ja.qHb=null;ja.zAe=null;ja.tHb=-1;ja.jX=[];ja.pHb=!1;ja.sQa=null;ja.IHd=!1;ja.EMf=!1;ja.oHb=!1;ja.nHb="";ja.rQa=null;ja.r7=0;ja.q7="";ja.GHd=!1;ja.CMf=null;ja.lj=!1;ja.Eu=0;ja.$Ic=null;ja.ZBf=function(){if(ja.pHb&&ja.sQa){var D=document.getElementById(ja.sQa);D&&D.classList.add("fieldItemMenuOpen")}};ja.YBf=function(){if(ja.pHb&&ja.sQa){var D=document.getElementById(ja.sQa);D&&(D.classList.remove("fieldItemMenuOpen"),D.classList.contains("fieldItemOnHover")||
D.classList.contains("fieldItemOnFocus")||(D.style.visibility="hidden"))}ja.pHb=!1;ja.sQa=null};ja.ak=function(){ja.NKb(!0,null);ja.hideTaskPane();return!0};ja.Kha=function(){if(ja.$)if(cb.a(ja.$).sMa&&ja.isVisible&&ja.currentState.$Ma&&ja.$.ea.sc){if(ja.YQ.vl&&!ja.YQ.request){var D=ja.YQ;var da=ja.$.na.va;var Ha=ja.currentState.bK,jb=ja.currentState.sO,kc=ja.currentState.Mo,Jb=ja.fMi,md=ja.gMi,ce=ja.YQ.ysf(),qe=Xe.nb(da,ja.currentState.Au,ja.currentState.externalSourceIndex,Pa.Rrb(ja.currentState));
qe.type=1;qe.version=Ha;qe.relatedGroup=jb;qe.selectedTab=kc;da=Xe.i(da,"GetPivotFieldListData",qe,Jb,md,null,ce,4);D.request=da}ja.$Q.vl&&!ja.$Q.request&&(D=ja.$Q,da=ja.$.na.va,Ha=ja.currentState.aR,jb=ja.iMi,kc=ja.jMi,Jb=ja.$Q.ysf(),md=Xe.nb(da,ja.currentState.Au,ja.currentState.externalSourceIndex,Pa.Rrb(ja.currentState)),md.type=1,md.version=Ha,da=Xe.i(da,"GetPivotFieldManagerData",md,jb,kc,null,Jb,4),D.request=da)}else Pa.qZ(ja.YQ),Pa.qZ(ja.$Q)};ja.fMi=function(D,da){ja.VIf(D,da,ja.YQ)&&(D=D.Result)&&
(ja.currentState.bK=D.FieldListVersion,ja.YQ.vl=!1,ja.Fdg(D));qf.a(ja.$).HCc();ja.refresh()};ja.gMi=function(D){ja.Vwf(D,ja.YQ)};ja.iMi=function(D,da){ja.VIf(D,da,ja.$Q)&&(D=D.Result)&&(ja.currentState.aR=D.FieldWellVersion,ja.$Q.vl=!1,ja.xdg(D));ja.refresh()};ja.jMi=function(D){ja.Vwf(D,ja.$Q)};ja.lHi=function(D){if(He.a.rh(D.Errors)){ja.Npb=!1;ja.KGa=null;for(var da=0,Ha=D.Errors.length;da<Ha;++da)if(1244452614===D.Errors[da].MessageId){ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")&&
(D=Sc.g(ja.$),da=D.Rb.lp(D.ha.ta.activeCell))&&(da=Wb.Range.hd(da.kVf+1,da.left),da=ef.v(da,ja.$),D.Eg(da,null,null,null,3,jc.a.MAh));ja.currentState.bK=-1;ja.currentState.aR=-1;ja.refresh();break}}ja.dva=!0;ja.FOb()};ja.TKi=function(D){ja.t1b=!1;if(!He.a.rh(D.Errors)){if(ja.fieldList)ja.fieldList.XRj();else if(ja.xv&&0<ja.jX.length)for(D=0;D<ja.jX.length;++D)ja.jX[D].IsCollapsed=!1;ja.currentState.bK=-1;ja.refresh()}ja.FOb()};ja.onResize=function(){ja.ZIb()};ja.SBd=function(D){oc.g(D)};ja.TBd=function(D){if(D.button===
Sys.UI.MouseButton.leftButton){var da=D.target;if(da){var Ha=ja.Sbc(da);if(Ha){for(var jb=null,kc=-1,Jb=Pa.YL;Jb<=Pa.tT;Jb++)if(Ha.id.startsWith(ja.Y9b[Jb])){jb=cd(ja.ZQ[Jb],Ha.id,!1);kc=Jb;break}jb&&(ja.jea(jb,kc),ja.sog&&(ja.cl&&ja.k4(),Jb=ja.parentElement,kc=xb.ZZe(ne.HelperMethods.QKa(da,Jb),ja.RC[kc],ja.T7b.currentStyle,ja.isRtl),ja.cl=new xb(xb.Mqb(jb,Ha,kc,da.offsetWidth),ja,jb),Jb.appendChild(ja.cl.domElement),ja.cl.Vnb(ja.xEb),ja.cl.Unb(ja.wEb),ja.cl.hoe(ja.vEb),ja.raiseEvent(Pa.X9b),ja.cl.roa(D)));
oc.g(D)}}}};ja.UBd=function(D){if(!ja.cl&&D.button===Sys.UI.MouseButton.leftButton){var da=D.target;if(da&&(da=ja.aqi(da))){var Ha=ja.Did(da.id);ja.OJa(D.target,Ha.VDc,Ha.returnValue,da.id);oc.g(D)}}};ja.xEb=function(){ja.VJe(ja.cl.tGb,ja.cl.otd,!1);ja.k4();ja.raiseEvent(Pa.d3a)};ja.wEb=function(){ja.k4();ja.raiseEvent(Pa.d3a)};ja.vEb=function(){var D=ja.getElementById(mb(ja.zk,ja.ccc(ja.Oub)));if(D){var da=ja.Did(D.id);ja.OJa(D,da.VDc,da.returnValue,D.id)}ja.hdb(null,"");ja.k4();ja.raiseEvent(Pa.d3a)};
ja.$oc=function(D){return ja.v7e(D.Ca.target===ja.fF)};ja.TIi=function(D){oc.g(D);ja.NKb(!0,null);ja.hideTaskPane()};ja.JOi=function(D){oc.g(D)};ja.xma=function(D){var da=!0;switch(D.keyCode){case 32:case 13:ja.rn===ja.fieldList.domElement?da=ja.fieldList.dcd(D):ja.rn===ja.WU&&(ja.NKb(!0,null),ja.hideTaskPane())}da&&oc.g(D)};ja.il=function(D){oc.g(D)};ja.P6=function(D){var da=!1;switch(D.keyCode){case 38:case 40:if(ja.rn===ja.fieldList.domElement)da=ja.fieldList.dcd(D);else if(ja.rn!==ja.WU){da=ja.getElementById(mb(ja.zk,
ja.ccc(ja.Oub)));var Ha=ja.Did(da.id);ja.OJa(D.target,Ha.VDc,Ha.returnValue,da.id);da=!0}break;case 37:case 39:da=ja.rn===ja.fieldList.domElement?ja.fieldList.dcd(D):!0;break;case 32:case 13:da=!0;break;case 9:da=ja.v7e(!D.shiftKey)}da&&oc.g(D)};ja.kma=function(){var D=Sc.g(ja.$).ha;D.Oa.lqd&&D.Ue&470||Sc.g(ja.$).inRangePicker||Sc.g(ja.$).Ni||ja.EHb(!0,!0)};ja.If=function(){ja.refresh();ja.$.ea.Rm.FieldListForceOnTop&&ja.oyc(!1,null,!0)};ja.Fnc=function(){ja.EHb(!0,!0)};ja.zd=function(){ja.EHb(!0,
!1)};ja.ii=function(D,da){D=gg.e(da.UF)||gg.e(da.qa);ja.EHb(!0,D)};ja.Uq=function(D,da){D=Cl(da.JUj);for(da=D.next();!da.done;da=D.next())ja.Gdg(da.value);ja.Upd&&(ja.Upd=!1,ja.xW||ja.taskPaneManager.Ig&&1===ja.taskPaneManager.Ig.taskPane.eh||ja.taskPaneManager.CD(ja,!0));ja.EHb(!1,!0)};ja.Xyf=function(D,da){Sc.g(ja.$).pq||ja.Gdg(da.nd.hash)};ja.hEb=function(){ja.refresh()};ja.qd=function(){ja.rL()};ja.Io=function(){ja.rL()};ja.rEf=function(){ja.refresh()};ja.uFf=function(){ja.Kha()};ja.Wxf=function(){ja.raiseEvent(Pa.X9b)};
ja.Vxf=function(){ja.raiseEvent(Pa.d3a)};ja.$=G;ja.kg=G.kg;ja.ol=ja.de.PE();ja.taskPaneManager=d;ja.taskPaneManager.tE(ja.rEf);ja.xv=!0;ja.ard=ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableReactFieldListV2",!1);ja.thf=ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);ja.xW=Se.a.Ld(ja.$);ja.zfe=.5;ja.xv&&(ja.pja=new Ub(ja.$,ja),ja.$.Ka.VVc(ja.ZBf),ja.$.Ka.hGa(ja.YBf));
ja.xv||(ja.HW=S.i1a(k,1E3,null,ba.Hph,733));ja.Drg=!0;if(ja.F_||ja.xv)ja.$ad=400,ja.Zad=400;ja.xW||(k.style.width=ne.HelperMethods.nc(ja.$ad));df.a.equals("rtl",k.dir,!0)&&(ja.lj=!0);ja.MTe=[4,2,1,8];ja.$.tl(ja.zd);k=Sc.g(ja.$);k.Ea.Ss(ja.Xyf);k.XP(ja.Uq);zc.a(ja.$).Ea.Ss(ja.hEb);k.ha.FJ(ja.kma);k.rE(ja.kma);k.ha.Oa.AFg(ja.Fnc);ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6187406_UpdateFieldListOnSelectedChartReload")&&(null===(P=Ia.a(ja.$))||void 0===P?void 0:P.ZZb(ja.Fnc));ja.$.xa.zg(ja.ii);ja.$.ea.Ot(ja.If);
ja.$.ea.gk(ja.qd);ja.$.ea.vM(ja.Io);cb.a(ja.$).KVc(ja.uFf);he.a(ja.$).ai(ja);ja.refresh();return ja}function nc(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}function pb(){this.id=0;this.name=null}function rb(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}function Ya(){this.id=0;this.name=null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=this.canDrag=this.isMoreFields=this.isChecked=
this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=!1}function ec(k,G,d,S){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=k;this.pivotData=G;this.additionalInformation=d;this.activeCell=S}function yd(k,G,d){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=k;this.cachedItemIndex=G;this.cachedItemName=d}function Ub(k,G){this.$=k;this.fieldManagerPane=G}function Ob(){this.type=null;this.dataUpdateType=
0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=this.onSelectedTabChanged=this.onSaveFieldListSizePercentage=null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=
this.fieldListSearchInfo=null}function Yb(k,G,d,S){var P=Da.call(this,k)||this;P.a7c={};P.U1a={};P.kgb=null;P.Q5a=null;P.gL=null;P.fieldListItems=null;P.cl=null;P.YZj=!0;P.eNb=!1;P.cI=!1;P.ysc=!1;P.UAi=0;P.Elc=!1;P.nxd=!1;P.qr=null;P.cu=null;P.P$b=null;P.zk=null;P.ZJa=!0;P.Mub="";P.jTd="";P.xyc=!1;P.kTd=null;P.SG=-1;P.scrollTop=0;P.$xa="";P.mkc="";P.zla="";P.aCb="";P.bCb="";P.p7b="";P.TEb=function(){P.Elc=P.nxd};P.su=function(){P.nxd=!1;P.Elc=!1};P.LGi=function(ja){oc.g(ja);P.NYf()};P.dHi=function(ja){oc.g(ja);
P.TYf()};P.bTi=function(ja){P.KZa(P.l4);oc.g(ja)};P.dTi=function(ja){if(13===ja.keyCode){if(qc.a.cdf||qc.a.Axa)oc.g(ja),P.lQd(ja.target)}else 27===ja.keyCode&&(oc.g(ja),qc.a.Hf||qc.a.Axa?P.VTf(ja.target):P.xyc=!0)};P.aCj=function(){P.xyc?(P.xyc=!1,P.VTf(P.getElementById(Lc))):P.lQd(P.getElementById(Lc));P.kTd=null};P.cTi=function(ja){oc.g(ja);qc.a.Hf||qc.a.Axa?P.lQd(ja.target):P.kTd||(P.xyc=!1,P.kTd=Jf.a.instance.create(P.aCj,200,$f.a.FAh,!0,!0))};P.$Oi=function(ja){oc.g(ja);if(!P.cl){ja=ja.target;
var D=null,da=null;Yb.jjf(ja)&&(da=cd(P.fieldListItems,ja.id,!0),D=P.getElementById(mb(da,"fli_")));if(D){if(!P.Q5a||P.Q5a.id.localeCompare(D.id))P.Q5a=D,P.BSa(da)?P.DAj(da):P.rec()}else P.rec(),P.Q5a=null}};P.SBd=function(ja){oc.g(ja)};P.ZOi=function(){P.Q5a&&(P.rec(),P.Q5a=null)};P.UBd=function(ja){if(!P.cl&&ja.button===Sys.UI.MouseButton.leftButton){var D=ja.target;if(D){var da=Yb.Sbc(D);if(da)P.B9b(cd(P.fieldListItems,da.id,!0)),oc.g(ja);else if(D.id.startsWith("flm_")||D.id.startsWith("flimtd_"))P.OJa(ja,
D.parentNode,cd(P.fieldListItems,D.id,!0)),oc.g(ja)}}};P.TBd=function(ja){if(ja.button===Sys.UI.MouseButton.leftButton){var D=ja.target;if(D&&Yb.jjf(D)){var da=cd(P.fieldListItems,D.id,!0);P.zk=da;P.KZa(P.zo);oc.g(ja);if(D.id.startsWith("flb_"))P.raiseEvent("FieldListChanging"),P.B9b(da),P.raiseEvent("FieldListChanged");else if(D.id.startsWith("flcb_"))P.raiseEvent("FieldListChanging"),P.Tye(da),P.raiseEvent("FieldListChanged");else{var Ha=Yb.Sbc(D);if(Ha&&da&&da.CanDrag){P.cl&&P.k4();var jb=P.host.parentElement,
kc=xb.ZZe(ne.HelperMethods.QKa(D,jb),P.zo,P.zo.offsetParent.currentStyle,P.host.isRtl);P.cl=new xb(xb.Mqb(da,Ha,kc,D.offsetWidth),P.host,da);jb.appendChild(P.cl.domElement);P.cl.Vnb(P.xEb);P.cl.Unb(P.wEb);P.cl.hoe(P.vEb);P.raiseEvent("FieldListChanging");P.cl.roa(ja)}}}}};P.xEb=function(){P.host.Rih(P.cl.tGb,P.cl.otd);P.k4();P.raiseEvent("FieldListChanged")};P.wEb=function(){P.k4();P.raiseEvent("FieldListChanged")};P.vEb=function(){P.cl.tGb.IsCollapsible&&P.B9b(P.cl.tGb);P.k4();P.raiseEvent("FieldListChanged")};
P.host=d;P.$=G;P.host.F_?(P.$xa='<div id="{0}" class="{1}">{2}</div>',P.mkc='<div id="{0}" class="{1}" title="{3}">{2}</div>',P.zla=ff,P.aCb=hf,P.bCb=Bf,P.p7b=Rf):(P.$xa='<td id="{0}" class="{1}">{2}</td>',P.mkc='<td id="{0}" class="{1}" title="{3}">{2}</td>',P.zla=pd,P.aCb=Qe,P.bCb=Ze,P.p7b=Vg);P.zo=document.getElementById(S+de.a.CTe);P.TIa=document.getElementById(S+de.a.ATe);P.mua=document.getElementById(S+de.a.BTe);P.fNb=document.getElementById(S+de.a.GTe);dd.DOMElementExtensions.setVisible(P.fNb,
!1);P.l4=document.getElementById(S+de.a.ETe);P.UIa=document.getElementById(S+de.a.DTe);P.V4f=document.getElementById(S+de.a.FTe);dd.DOMElementExtensions.setVisible(P.l4,!1);P.Saa=[];P.Saa.push(P.TIa);P.Saa.push(P.mua);P.Saa.push(P.l4);P.Saa.push(P.zo);P.Ale=P.de.Wd(P.TIa);P.Ale.ka("click",P.LGi);P.kqe=P.de.Wd(P.mua);P.kqe.ka("click",P.dHi);P.yyc=P.de.Wd(P.l4.firstChild);P.yyc.ka("change",P.cTi);P.yyc.ka("click",P.bTi);P.yyc.ka("keyup",P.dTi);P.e3a=P.de.Wd(P.zo);P.e3a.ka("mousedown",P.TBd);P.e3a.ka("mouseup",
P.UBd);P.e3a.ka("mouseover",P.$Oi);P.e3a.ka("mouseout",P.ZOi);P.e3a.ka("click",P.SBd);P.$.Ka.VVc(P.TEb);P.$.Ka.hGa(P.su);return P}function xb(k,G,d,S){var P=pf.call(this,k,k,!1,void 0===S?null:S)||this;P.H7b=!1;P.sEb=function(ja){P.H7b=!0;P.Yt(ja)};P.iB=P.de.Gta();P.host=G;P.uug=d;return P}function Sa(k,G,d){G&&(G.classList.remove(sf),d&&G.classList.add(wf));return k?(d&&k.classList.remove(wf),k.classList.add(sf),k):null}function Tb(k,G){G=ne.HelperMethods.nc(Math.max(0,G));k=k.style;df.a.equals(k.maxWidth,
G,!0)||(k.maxWidth=G)}function Cc(k,G){return String.format('style="{0}:{1};"',G?"margin-right":"margin-left",ne.HelperMethods.nc(k))}function Fb(k,G,d){if(k)for(var S=0,P=k.length;S<P;S++){var ja=k[S];if(ja.ClientId===G||d&&(ja=Fb(ja.Children,G,d)))return ja}return null}function hc(k,G,d,S){k=Cl(k);for(var P=k.next();!P.done;P=k.next())if(P=P.value,P.PivotCacheIndex===G&&(P.TypeTag===d||0===d)||S&&(P=hc(P.Children,G,d,S)))return P;return null}function cd(k,G,d){if(k){var S=parseInt(G.substring(G.lastIndexOf("_")+
1,G.length),10);for(var P=0,ja=k.length;P<ja;P++){var D=k[P];if(D.ClientId===S||d&&(D=cd(D.Children,G,d)))return D}}return null}function mb(k,G){return k?G+k.ClientId:""}function $a(k,G,d){if(k)for(var S=0,P=k.length;S<P;S++){var ja=k[S];ja.ClientId=d++;ja.ClientParentId=G;d=$a(ja.Children,ja.ClientId,d)}return d}function K(){}function ba(){}function ua(){this.ZD=0;this.request=null;this.vl=!0}function La(k){var G=ld.call(this)||this;G.$=k;G.Tb();return G}function ub(k,G,d){this.T5=this.Jqd=this.pW=
this.Vhc=!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.Mfe=-1;this.jhe=1;this.ODa=this.A7d=this.z7d=-1;this.Fra=null;if(k&&(G?(this.sO=G.sO,this.Mo=G.Mo):this.Mo=d,this.pW=this.Vhc=!1,k.qa)){var S=Sc.g(k);d=G=null;if(gg.f(k.qa)){var P=zc.a(k);P.dd&&P.dd.Attributes&4&&(this.chartId=P.chartId,G=P.dd)}else gg.i(k.qa)&&((P=S.ha.Oa.oc)?(S=P.floatingObject)&&0===S.type&&S.dd&&S.dd.Attributes&4&&(this.chartId=P.floatingObject.id,G=S.dd):S.ha.ta.activeCell&&
(P=qf.a(k).TKa(),Object(qd.a)(Ne.PivotTableRange,P)&&(d=P)));G?(this.pW=!0,this.Jqd=!!(G.Attributes&256),this.anchorType=7,this.T5=!!(G.Attributes&128),this.confirmationRequiredForDataOps=!!(G.Attributes&64),this.ODa=G.ExternalSourceIndex,this.bK=G.FieldListVersion,this.aR=G.FieldWellVersion,G=this.Fra={},k.Dj(G),G.FirstColumn=G.FirstRow=-1):d&&(this.Vhc=!0,this.Jqd=d.isActionable,this.anchorType=0,this.T5=d.isOlap,this.confirmationRequiredForDataOps=d.confirmationRequiredForDataOps,this.ODa=d.externalSourceIndex,
this.bK=d.GAh,this.aR=d.PAh,this.pivotTableName=d.pivotTableName,this.Fra=ef.o(d,k))}}function Va(k){return $b.call(this,k)||this}function tb(k,G,d){G||dc.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=k;this.fieldManagerPane=G;this.pAg=d}function Cb(k,G){var d=Ce.call(this)||this;d.gridView=null;d.callout=null;d.HJi=function(S){if(S.isLoaded){d.state=1;S=d.$;var P=Sc.g(S);d.dNg(P);S.Zk(d.Zc);S.RA(d.fj);P.Nt(d.jS);zc.a(S).Nt(d.iEb);S.userOperationManager.Wu(d.aFf);
ie.a.Z2(1529658657,vg.a.uw,0,1);S.Ka.a3(d)}else d.dispose()};d.dza=function(S,P){d.allow&&0===P.u5&&(S=d.gridView.ha.Ue,1===S?(d.B1c(),d.MX()):2!==S||d.Qy.z_||(d.Qy.reset(),d.ny()))};d.gj=function(){d.ny()};d.Zc=function(){d.ny()};d.vd=function(S,P){d.callout||d.showCallout(3===S.yb,P)};d.AAd=function(){d.callout.kAa(d.AAd);d.callout=null;d.Zh.hide()};d.fj=function(){d.callout?d.ny():d.i7a()&&d.Zh.hide()};d.iEb=function(){3===d.state&&(d.state=1)};d.jS=function(){3===d.state&&(Ig.d(d.$)?Jf.a.instance.create(d.B8c,
350,$f.a.IOg,!0,!0):d.B8c())};d.aFf=function(S,P){(S=P.Hg?P.Hg.operation:null)&&S.flags&4&&(d.allow&&0===P.uu?(d.state=3,d.ny()):3===d.state&&1===P.uu&&(P=S.od?S.od.Errors:null)&&0<P.length&&d.B8c())};d.B8c=function(){d.state=1;d.MX()};d.$=k;d.state=2;d.Qy=new nb(k);d.Zh=new Ib(k,d.vd,G);he.a(d.$).ai(d);Ca.a.Xld(k.domElement.ownerDocument,Tc.a.current.np(74),d.HJi);return d}function nb(k){this.Yhb=!1;this.ODa=0;this.Fra=this.zPc=this.yPc=this.zjb=null;this.$=k;this.reset()}function Ib(k,G,d){var S=
Ue.call(this)||this;S.$=k;S.Lha=d.e5b(k,null,G,Qc.a.$8b,Tc.a.Se(9),Zb.a.instance.fa(1156),"BIXPointerDown");return S}function hb(k,G,d,S){var P=rd.call(this,k,Zb.a.instance.fa(1155),!0,4)||this;P.Baa=null;P.uHc=null;P.tC=null;P.HW=null;P.FU=null;P.fieldListSelector=null;P.Y9d=!1;P.hMi=function(ja,D){if(P.domElement&&(P.HW.kTa(),!Dc.a(ja))){var da=ja.Result;da&&P.TFj(da,D);rd.prototype.Dy.call(P,ja,null,"")}};P.rBj=function(){dd.DOMElementExtensions.Lv(P.W0b,Zb.a.instance.fa(1157));var ja=P.Kea.querySelector("."+
Jc.DNe);ja.tabIndex=-1;dd.DOMElementExtensions.setFocus(ja)};P.U9a=function(){P.close(1);return!0};P.domElement.id=k.domElement.id+"_BIExploreCallout";P.Qy=G;P.targetElement=d;P.mUf=!1;P.domElement.classList.remove(P.rtl?kd.a.M9c:kd.a.L9c);P.domElement.classList.remove(Qc.a.gq);P.domElement.classList.add(P.rtl?Jc.Bnh:Jc.Anh);(P.touchMode=S)||P.domElement.classList.add(Jc.znh);P.Kea.className=Jc.Enh;P.Kea.style.backgroundImage="";P.Hoa.className=Jc.Dnh;P.Tx.parentNode.className=Jc.DNe;k=P.Qb;k.className=
"";G=String.format('<div id="{0}"class="{1}">{2}</div><div class="{3}"><div id="{4}" class="{5}"></div><div id="{6}" class="{7}"></div></div>',"bix-subtitle",Jc.Cnh,P.Qy.F8h,Jc.tnh,"bix-fieldlistselector",Jc.Fnh,"bix-drilldetails",Jc.ynh);dd.DOMElementExtensions.Lv(k,G);P.W0b=k.lastChild;P.pec();return P}function zb(k,G,d,S,P){var ja=Ad.call(this,G)||this;ja.W1c=0;ja.pya=new vb.a(!1);ja.Gvc=-1;ja.LXf=null;ja.YM=null;ja.ZI=null;ja.vd=function(kc){kc.Mb&&ja.jrc(kc.Mb);return!0};ja.$N=function(kc){kc.button===
Sys.UI.MouseButton.leftButton&&kc.target&&(ja.jrc(kc.target),oc.g(kc))};ja.onDoubleClick=function(kc){if(kc.button===Sys.UI.MouseButton.leftButton&&kc.target){var Jb=ja.KUe(kc.target);var md=Jb.rYb;0!==Jb.returnValue&&(oc.g(kc),(kc=ja.w0e(md))&&kc.isCollapsible&&ja.GNb(kc))}};(ja.touchMode=P)?fd.a.instance.pa(rc.a.click,ja.domElement,ja.vd):(ja.Fc.ka("mousedown",ja.$N),ja.Fc.ka("dblclick",ja.onDoubleClick));ja.D5f=!qc.a.gni&&!P;if(k.isChromeRtl){var D="padding-right:{0}px;";ja.W1c=39}else D="padding-left:{0}px;",
ja.W1c=37;var da=new Pd.a(S.ExcludeHierarchies);da.C$.sort(function(kc,Jb){return kc-Jb});var Ha=-1,jb=null;k=function(){var kc=ja.vaf(d.FieldListItems,da,Ha,jb,S.Context);Ha=kc.KBb;jb=kc.we;return kc}().returnValue;if(!k)return ja;1===k.length&&(k=Array.clone(k[0].Children),k.forEach(function(kc){kc.ClientParentId=-1}));if(!k.length)return ja;ja.fieldListItems=[];k.forEach(function(kc){ja.fieldListItems.push(new Fc(ja,kc,D,Qc.a.WPe,Qc.a.XPe))});jb||(jb=zb.oCh(k,S.Context.DimensionCaption)||k[0]);
ja.we=ja.Wfd(jb.ClientId);ja.kH();return ja}function Gc(k,G){var d=vf.call(this)||this;d.Z7h=k;d.caption=G;return d}function Fc(k,G,d,S,P){var ja=this;this._element=null;this.pJ=this.visible=!0;this.fieldListSelector=k;this.KGc=G.Name||"";this.clientId=G.ClientId;this.kEa=G.IsCollapsible;this.parentId=G.ClientParentId;this.tug=G.PivotCacheIndex;this.type=G.TypeTag;this.Afg=G.UserRank;this.G8h=d;this.tGe=S;this.cbh=P;this.fieldListSelector.ODg(this.clientId,this);this.children=[];G.Children.forEach(function(D){ja.children.push(new Fc(k,
D,d,S,P))})}function Ed(k,G,d,S,P,ja){var D=sd.call(this,G)||this;D.T7c=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];D.F5b=-1;D.dtb=null;D.btb=null;D.ctb=null;D.eva=null;D.vd=function(da){for(var Ha=D.domElement,jb=da.target;jb!==Ha;){if(jb.id.startsWith("bix-drill-action")){D.drillTo(D.F5b,jb.id);oc.g(da);break}jb=jb.parentNode}};D.rDf=function(da,Ha){da=-1===D.F5b;var jb=Ha.Z7h;D.F5b=jb;var kc=null;jb===D.Cue.HierarchyId?(D.PZf(!1),D.drillUp||D.drillDown?(D.QZf(!0),dd.DOMElementExtensions.setVisible(D.domElement,
!0),kc=D.btb||D.dtb):dd.DOMElementExtensions.setVisible(D.domElement,!1)):(D.QZf(!1),kc=D.ctb,Ed.wqj(kc,Ha.caption,Zb.a.instance.fa(1158)),D.PZf(!0),dd.DOMElementExtensions.setVisible(D.domElement,!0));da||D.d_f(kc)};D.$=k;D.Qy=d;D.Cue=S.Context;k=S.DrillContext;D.drillUp=k.DrillUp;D.drillDown=k.DrillDown;D.Tkd=P;D.AJ=ja;P.RGg(D.rDf);D.kH();return D}function Jc(){}b.r(E);var Ca=b(556),bb=b(0),dc=b(14),Ac=b(90),nd=b(83),qd=b(438),Gb=b(76),Oc=b(48),he=b(272),Wd=b(179),rc=b(13),gd=b(935),kd=b(71);Jc.Anh=
"ewa-bix-ltr";Jc.Bnh="ewa-bix-rtl";Jc.Enh="ewa-bix-titlebar";Jc.Cnh="ewa-bix-subtitle";Jc.Dnh="ewa-bix-title";Jc.DNe="ewa-bix-close";Jc.Wr="clip16x16";Jc.tnh="ewa-bix-body";Jc.ynh="ewa-bix-drilldetails";Jc.vnh="ewa-bix-DrillButton";Jc.znh="ewa-bix-hover";Jc.wnh="ewa-bix-DrillLabel1";Jc.xnh="ewa-bix-DrillLabel2";Jc.Fnh="ewa-bixfl";Jc.ENe="ewa-bixfl-NoFocus";Jc.Inh="ewa-bixfl-ItemSelected";Jc.Gnh="ewa-bixfl-Icon";Jc.Hnh="ewa-bixfl-Item";Jc.Nrf="ms-core-needIEFilter";Jc.unh="ewa-bix-calloutBackground";
Jc.Rtb="ewa-ipad";Object(bb.a)(Jc,"CssClassNames",null,[]);var Qc=b(19),de=b(5),Xe=b(84),ge=b(29),fc=b(242),dd=b(12),oc=b(72),Zb=b(15),Sc=b(21),sd=fc.a;Am(Ed,sd);Ed.prototype.dispose=function(){this.Tkd&&this.Tkd.ddj(this.rDf);this.T7c=this.dtb=this.btb=this.ctb=this.eva=this.AJ=this.drillUp=this.drillDown=this.Cue=this.Qy=this.AJ=this.Tkd=this.$=null;sd.prototype.dispose.call(this)};Ed.prototype.focus=function(){this.setFocus(!0)};Ed.prototype.hasFocus=function(){var k=dd.DOMElementExtensions.kp(this.domElement);
if(!k)return!1;k=k.id;return!!k&&k.startsWith("bix-drill-action")};Ed.prototype.onKeyDown=function(k){var G=k.keyCode;k=k.shiftKey;if(this.hasFocus()){var d=!1;13===G?(this.drillTo(this.F5b,this.eva.id),d=!0):9===G&&((d=this.HN(!k))||this.XHe());return d}return 9===G?this.setInitialFocus(!k):!1};Ed.prototype.setFocus=function(k){return this.hasFocus()?this.HN(k):this.setInitialFocus(k)};Ed.prototype.kH=function(){dd.DOMElementExtensions.Bu(this.domElement,de.a.RZa,null,null);var k='<button id="{0}" class="'+
Jc.vnh+'" tabIndex="-1" title="{1}" style="display:none" onkeyup="return false;" onkeypress="return false;" role="menuitem" aria-describedby="{2} {4}"><div id="{2}"class="'+Jc.wnh+'">{3}</div><div id="{4}" class="'+Jc.xnh+'">{5}</div></button>',G="";if(this.drillDown){var d=Zb.a.instance.fa(1160);var S=this.drillDown.Caption;var P=String.format("{0} ({1})",d,S?ge.a.o_(S):"");S=S?ge.a.Sf(S):"";G+=String.format(k,"bix-drill-action-down",P,"bixdddl_1",d,"bixdddl_2",S)}this.drillUp&&(d=Zb.a.instance.fa(1159),
S=this.drillUp.Caption,P=String.format("{0} ({1})",d,S?ge.a.o_(S):""),S=S?ge.a.Sf(S):"",G+=String.format(k,"bix-drill-action-up",P,"bixddul_1",d,"bixddul_2",S));G+=String.format(k,"bix-drill-action-to","","bixddtl_1",Zb.a.instance.fa(1158),"bixddtl_2","");k=this.domElement;dd.DOMElementExtensions.Lv(k,G);this.dtb=this.getElementById("bix-drill-action-up");this.btb=this.getElementById("bix-drill-action-down");this.ctb=this.getElementById("bix-drill-action-to");this.Fc.ka("click",this.vd);k.setAttribute(de.a.r3,
"");dd.DOMElementExtensions.setVisible(k,!1)};Ed.prototype.drillTo=function(k,G){var d=this;switch(G){case "bix-drill-action-up":var S=this.drillUp.Id;break;case "bix-drill-action-down":S=this.drillDown.Id;break;case "bix-drill-action-to":S=1;break;default:return}Sc.g(this.$).Kp(!0);this.AJ.y0g(function(P,ja,D){var da=d.Qy,Ha=d.$.na.va,jb=da.confirmationRequiredForDataOps,kc=S;da=Xe.nb(Ha,da.Au,da.externalSourceIndex,d.Qy.tS);da.requiresConfirmation=jb;da.hierarchyId=k;da.levelId=kc;return Xe.i(Ha,
"BixDrill",da,P,ja,D,null,0)})};Ed.prototype.HN=function(k){var G=0;if(this.eva)switch(this.eva.id){case "bix-drill-action-down":G=0;break;case "bix-drill-action-up":G=1;break;case "bix-drill-action-to":G=2}return this.a0f(k?G+1:G-1,k)};Ed.prototype.XHe=function(){var k=this.eva;k&&(k.blur(),this.domElement.setAttribute(de.a.r3,""));this.eva=null};Ed.prototype.PZf=function(k){this.ctb&&dd.DOMElementExtensions.setVisible(this.ctb,k)};Ed.prototype.QZf=function(k){this.dtb&&dd.DOMElementExtensions.setVisible(this.dtb,
k);this.btb&&dd.DOMElementExtensions.setVisible(this.btb,k)};Ed.prototype.d_f=function(k){k!==this.eva&&this.XHe();if(!k)return!1;k.tabIndex=0;dd.DOMElementExtensions.setFocus(k);this.domElement.setAttribute(de.a.r3,k.id);this.eva=k;return!0};Ed.prototype.setInitialFocus=function(k){return this.a0f(k?0:this.T7c.length-1,k)};Ed.prototype.a0f=function(k,G){for(var d=this.T7c;0<=k&&k<d.length;){var S=dd.DOMElementExtensions.getElementById(this.domElement,d[k]);if(S&&dd.DOMElementExtensions.isVisible(S))return this.d_f(S);
k=G?k+1:k-1}return!1};Ed.wqj=function(k,G,d){d=String.format("{0} ({1})",d,G);k.setAttribute("title",d);k.lastChild.innerText=G};Object(bb.a)(Ed,"BixDrillDetails",fc.a,[]);var fd=b(228),qc=b(24),vb=b(35),Pd=b(215),Tc=b(54),Ve=Jc.Hnh,kf=Jc.Inh,of='<div id="{0}" class="'+Jc.Gnh+'" style="{1}"><div class="'+Qc.a.Wr+'"><img id="{2}" class="{3}" role="{4}" src="{5}"/></div></div>';Fc.prototype.dispose=function(){this.children&&(Ac.a.yc(this.children),this.children=null);this._element=null};Fc.prototype.bBe=
function(){for(var k=Cl(this.children),G=k.next();!G.done;G=k.next())G=G.value,G.visible=!1,G.kEa&&(G.pJ=!0,G.f1f(),0<G.children.length&&G.bBe())};Fc.prototype.wre=function(k,G){this.visible=!k;var d=11*k,S=String.format('aria-labelledby="{0}" aria-selected="false" aria-level="{1}"',this.Eva(Fc.KIf),k+1);this.kEa&&(S+=String.format('aria-expanded="false" aria-owns="{0}"',this.Eva(Fc.JIf)));this.kEa?(this.pJ=!0,d=String.format(of,this.Eva(Fc.IIf),this.l0e(d+4),this.Eva(Fc.oFd),this.tGe,de.a.Sr,Tc.a.Se(9))):
d=String.format('<div style="{0}"></div>',this.l0e(d+23));var P=String.format('<span id="{0}">{1}</span>',this.Eva(Fc.KIf),ge.a.Sf(this.KGc));G+=String.format('<div id="{0}" class="{1}" tabIndex="-1" title="{2}" role="treeitem" {3}><table cellspacing="0" cellPadding="0" role="presentation"><tr><td style="width: 8px">{4}</td><td>{5}</td></tr></table></div>',this.Eva(Fc.zab),Ve,ge.a.o_(this.KGc),S,d,P);this.kEa&&(++k,G+=String.format('<div id="{0}" role="group" style="display:none;">',this.Eva(Fc.JIf)),
this.children.forEach(function(ja){G=ja.wre(k,G)}),G+="</div>");return G};Fc.prototype.x6b=function(){this.element.blur();this.element.tabIndex=-1};Fc.prototype.nzh=function(){this.children.forEach(function(k){k.visible=!0})};Fc.prototype.FZe=function(k,G){for(var d=this.children,S=Cl(d),P=S.next();!P.done;P=S.next())if(P=P.value,!P.kEa&&5===P.type&&P.Afg>G&&(k=P,G=P.Afg,3===G))return{returnValue:k,Bqf:G};d=Cl(d);for(P=d.next();!P.done&&(S=P.value,!S.kEa||(k=S.FZe(k,G),G=k.Bqf,k=k.returnValue,3!==
G));P=d.next());return{returnValue:k,Bqf:G}};Fc.prototype.$Xh=function(){for(var k=this;-1!==k.parentId;)k=this.fieldListSelector.Wfd(k.parentId);return k};Fc.prototype.Cgc=function(k){for(var G=this;-1!==G.parentId;){if(k.clientId===G.parentId)return!0;G=this.fieldListSelector.Wfd(G.parentId)}return!1};Fc.prototype.setFocus=function(){this.element.tabIndex=0;dd.DOMElementExtensions.setFocus(this.element)};Fc.prototype.f1f=function(){var k=dd.DOMElementExtensions.getElementById(this.element,this.Eva(Fc.oFd));
if(k){var G=this.element.nextSibling;dd.DOMElementExtensions.Joa(k,this.pJ,this.tGe,this.cbh);this.element.setAttribute(de.a.gZ,this.pJ?de.a.Xo:de.a.yj);dd.DOMElementExtensions.setVisible(G,!this.pJ)}};Fc.prototype.zuj=function(){var k=String.format(".{0}",kf);k=this.fieldListSelector.domElement.querySelectorAll(k);for(var G=0;G<k.length;G++){var d=k[G];d.classList.remove(kf);d.setAttribute(de.a.Eha,"false")}this.element.classList.add(kf);this._element.setAttribute(de.a.Eha,"true")};Fc.prototype.GNb=
function(){(this.pJ=!this.pJ)?this.bBe():this.nzh();this.f1f()};Fc.prototype.Eva=function(k){return k+this.clientId};Fc.prototype.l0e=function(k){return String.format(this.G8h,k.toString())};Ck.Object.defineProperties(Fc.prototype,{caption:{configurable:!0,enumerable:!0,get:function(){return this.KGc}},element:{configurable:!0,enumerable:!0,get:function(){return this._element||(this._element=this.fieldListSelector.getElementById(Fc.zab+this.clientId))}},z6h:{configurable:!0,enumerable:!0,get:function(){return-1!==
this.parentId}},isCollapsed:{configurable:!0,enumerable:!0,get:function(){return this.pJ}},isCollapsible:{configurable:!0,enumerable:!0,get:function(){return this.kEa}},isVisible:{configurable:!0,enumerable:!0,get:function(){return this.visible}},BHf:{configurable:!0,enumerable:!0,get:function(){return this.tug}}});Fc.IIf="bixflec_";Fc.oFd="bixfleci_";Fc.zab="bixfli_";Fc.KIf="bixflil_";Fc.JIf="bixflg_";Object(bb.a)(Fc,"BixFieldListItem",null,[2]);var vf=Sys.EventArgs;Am(Gc,vf);Object(bb.a)(Gc,"BixHierarchySelectionChangedEventArgs",
Sys.EventArgs,[]);var ne=b(10),Ad=fc.a;Am(zb,Ad);zb.prototype.RGg=function(k){this.get_events().addHandler("SelectionChanged",k)};zb.prototype.ddj=function(k){this.get_events().removeHandler("SelectionChanged",k)};zb.prototype.dispose=function(){this.touchMode&&(fd.a.instance.za(rc.a.click,this.domElement,this.vd),this.touchMode=!1);this.ZI=null;this.fieldListItems&&(Ac.a.yc(this.fieldListItems),this.fieldListItems=null);this.pya=null;Ad.prototype.dispose.call(this)};zb.prototype.focus=function(){this.setFocus(!0)};
zb.prototype.ODg=function(k,G){this.pya.add(k.toString(),G)};zb.prototype.Wfd=function(k){k=k.toString();return this.pya.xb(k)?this.pya.getItem(k):null};zb.prototype.hasFocus=function(){var k=dd.DOMElementExtensions.kp(this.ZI);return k?(k=k.id)&&k.startsWith(Fc.zab)&&this.YM?!0:!1:!1};zb.prototype.onKeyDown=function(k){k=k.keyCode;if(this.hasFocus()){var G=!1;38===k||40===k?(this.HN(40===k),G=!0):37===k||39===k?(k=k===this.W1c,G=this.YM,G.isCollapsible&&G.isCollapsed!==k?this.GNb(G):k&&G.z6h&&this.HN(!1),
G=!0):13===k||32===k?((k=this.YM)&&this.select(k),G=!0):9===k&&this.YHe(!0);return G}return 9===k?this.YM?this.jea(this.YM):this.setInitialFocus(!0):!1};zb.prototype.vpj=function(){this.ZI.setAttribute(de.a.Pse,"bix-drilldetails")};zb.prototype.setFocus=function(k){return this.ZI.firstChild?this.hasFocus()?this.HN(k):this.YM?this.jea(this.YM):this.setInitialFocus(k):!1};zb.prototype.start=function(){this.we&&(this.select(this.we.$Xh()),this.YM&&this.scroll(this.YM,!0))};zb.prototype.kH=function(){var k;
this.fieldListItems.forEach(function(G){k=G.wre(0,k)});this.ZI=this.domElement;dd.DOMElementExtensions.Lv(this.ZI,k.toString());dd.DOMElementExtensions.Bu(this.ZI,de.a.p0b,null,null,null);this.ZI.setAttribute(de.a.Pt,Zb.a.instance.fa(1161));this.ZI.classList.add(Qc.a.lm);this.ZI.style.position="relative"};zb.prototype.ySh=function(k){for(;k&&k!==this.ZI;){var G=k.id;if(G&&G.startsWith(Fc.zab))return k;k=k.parentNode}return null};zb.prototype.vaf=function(k,G,d,S,P){var ja=this,D=d;if(!k||!k.length)return{returnValue:null,
KBb:d,we:S};for(var da=0,Ha={},jb=0,kc=k.length;jb<kc;Ha={rP:Ha.rP},jb++)if(Ha.rP=k[jb],zb.hki(G,Ha.rP))k[jb]=null,++da;else{Ha.rP.ClientParentId=D;Ha.rP.ClientId=++d;if(Ha.rP.IsCollapsible&&(Ha.rP.Children=function(Jb){return function(){var md=ja.vaf(Jb.rP.Children,G,d,S,P);d=md.KBb;S=md.we;return md}}(Ha)().returnValue,!Ha.rP.Children)){k[jb]=null;++da;continue}5!==Ha.rP.TypeTag&&3!==Ha.rP.TypeTag||Ha.rP.PivotCacheIndex!==P.HierarchyId||(Ha.rP.UserRank=3,S=Ha.rP)}return da?da===k.length?{returnValue:null,
KBb:d,we:S}:{returnValue:zb.Eaj(k),KBb:d,we:S}:{returnValue:k,KBb:d,we:S}};zb.prototype.YHe=function(k){var G=this.YM;G&&(G.x6b(),this.ZI.setAttribute(de.a.r3,""));this.x6b();k||(this.YM=null)};zb.prototype.x6b=function(){this.D5f&&this.ZI.classList.add(Jc.ENe)};zb.prototype.HN=function(k){var G=this.YM;if(!G)return this.setInitialFocus(k);var d=this.pya.values,S=d.length,P=Array.indexOf(d,G);for(P=k?++P:--P;0<=P&&P<S;){G=d[P];if(G.isVisible)return this.jea(G),this.scroll(G,k),!0;P=k?++P:--P}return!1};
zb.prototype.scroll=function(k,G){var d=k.element;k=d.offsetHeight;d=d.offsetTop;var S=this.ZI,P=S.scrollTop,ja=(Math.floor(S.clientHeight/k)-3)*k,D=S.scrollTop;G?d>P+k+ja&&(D=d-(k+ja)):d<P+k&&(D=d-k);S.scrollTop=D};zb.prototype.setInitialFocus=function(k){for(var G=this.pya.count,d=k?0:G-1;0<=d&&d<G;){var S=this.pya.hg(d);if(S.isVisible)return this.jea(S),this.scroll(S,!0),!0;d=k?++d:--d}return!1};zb.prototype.jea=function(k){this.YM&&k!==this.YM&&this.YHe(!1);if(!k)return!1;this.ZI.setAttribute(de.a.r3,
k.element.id);this.YM=k;-1!==this.Gvc&&(k.setFocus(),this.D5f&&this.ZI.classList.remove(Jc.ENe));return!0};zb.prototype.KUe=function(k){for(;k&&k!==this.ZI;){var G=k.id;if(G.startsWith(Fc.zab))return{returnValue:1,rYb:k};if(G.startsWith(Fc.IIf)||G.startsWith(Fc.oFd))return{returnValue:2,rYb:k};k=k.parentNode}return{returnValue:0,rYb:null}};zb.prototype.w0e=function(k){if(!k.id||!k.id.startsWith(Fc.zab)&&(k=this.ySh(k),!k))return null;k=k.id.split("_")[1];return vb.a.Nc(this.pya.nu,k)};zb.prototype.jrc=
function(k){var G=this.KUe(k);k=G.rYb;G=G.returnValue;if(0!==G&&(k=this.w0e(k)))switch(G){case 2:this.GNb(k);break;case 1:this.select(k)}};zb.prototype.select=function(k){if(k){k.zuj();this.jea(k);if(k.isCollapsible&&(k=k.FZe(null,-1).returnValue,!k))return;this.we=k;this.Gvc!==k.BHf&&(this.Gvc=k.BHf,this.LXf=k.caption,this.raiseEvent("SelectionChanged",new Gc(this.Gvc,this.LXf)),this.hasFocus()||this.x6b())}};zb.prototype.GNb=function(k){k.GNb();k.isCollapsed&&this.we&&this.we.Cgc(k)&&this.select(k);
this.scroll(k,!k.isCollapsed)};zb.oCh=function(k,G){k=Cl(k);for(var d=k.next();!d.done;d=k.next())if(d=d.value,11===d.TypeTag&&d.Name===G)return d;return null};zb.hki=function(k,G){switch(G.TypeTag){case 5:case 3:break;default:return!1}return 0<=ne.HelperMethods.Lx(k,0,k.Xja(),G.PivotCacheIndex,function(d,S){return d-S})};zb.Eaj=function(k){for(var G=null,d=0;d<k.length;d++)k[d]&&(G||(G=[]),G.push(k[d]));return G};Ck.Object.defineProperties(zb.prototype,{tni:{configurable:!0,enumerable:!0,get:function(){return!!this.fieldListItems}}});
Object(bb.a)(zb,"BixFieldListSelector",fc.a,[867]);var Xd=b(51),ee=b(36),Le=b(214),Jf=b(47),$f=b(44),Dc=b(293),Sd=b(292),te=b(61),rd=gd.a;Am(hb,rd);hb.prototype.Ski=function(k){k=document.getElementById(k);return dd.DOMElementExtensions.isVisible(k)?(this.Baa.setFocus(!0),!0):!1};hb.prototype.y0g=function(k){this.uHc=k;Sc.g(this.$).Kp(!0);this.Y9d=!0;this.close(2)};hb.prototype.dispose=function(){Ac.a.yc([this.tC,this.HW,this.Baa,this.fieldListSelector]);this.Qy=this.Baa=this.fieldListSelector=this.HW=
this.tC=null;this.Fsc();this.uHc=this.targetElement=this.W0b=null;rd.prototype.dispose.call(this)};hb.prototype.takeFocus=function(){this.setFocus()};hb.prototype.close=function(k){this.Fsc();rd.prototype.close.call(this,k)};hb.prototype.kf=function(k){var G=this;k=void 0===k?!1:k;ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,12,477,0),function(d){G.mUf||(G.HW=d.result.i1a(G.Qb,500,null,null,733),G.HW.pBa())},this.$.la);return ee.TaskExtensions.ts(ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.create(this.$.da,
84,this.la,0),function(d){G.tC=d.result;G.tC.init(G.domElement,G.targetElement,document.body,G.$.qa.displayRtl);G.tC.ACe=8;G.tC.Jqe=!0;G.tC.CGb=hb.W1h();G.OUc();G.tC.um()},this.la,3),function(){return Le.a.prototype.kf.call(G,k)},this.la,3,te.a.current)};hb.prototype.Nx=function(){return this.uHc};hb.prototype.Sha=function(){var k=this;return function(G,d,S){var P=k.$.na.va;G=k.Jja(G);d=k.dba(d);var ja=Xe.nb(P,k.Qy.Au,k.Qy.externalSourceIndex,k.Qy.tS);return Xe.i(P,"GetBixAnalysis",ja,G,d,S,null,
4)}};hb.prototype.onShow=function(){this.tC.hNd();rd.prototype.onShow.call(this)};hb.prototype.Dy=function(k){var G=this,d=k.Result;if(k.Errors&&!k.Errors.length&&d&&-1===d.Context.HierarchyId)this.mUf=!0,this.HW&&this.HW.kTa(),Jf.a.instance.create(this.rBj,1,$f.a.HOg,!0,!0),rd.prototype.Dy.call(this,k,null,"");else{var S=function(P){P.Mo=0;G.gMa(169,function(ja,D,da){var Ha=G.$.na.va,jb=P.bK,kc=P.sO,Jb=P.Mo;ja=Sd.b(ja,G.hMi);var md=Xe.nb(Ha,P.Au,P.externalSourceIndex,P.W8g());md.type=4;md.version=
jb;md.relatedGroup=kc;md.selectedTab=Jb;return Xe.i(Ha,"GetPivotFieldListData",md,ja,D,da,d,4)},16)};ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.create(this.$.da,110,this.la,0),function(P){S(P.result)},this.la,3)}};hb.prototype.onKeyDown=function(k){var G=this.ZXe();if(k.altKey&&85===k.keyCode)this.close(1),oc.g(k);else if(117===k.keyCode&&k.ctrlKey)this.close(1),oc.g(k);else if(0===G)13===k.keyCode?this.close(1):rd.prototype.onKeyDown.call(this,k);else{for(var d=!1,S=0;3>S&&!d;S++)2===G?(d=this.fieldListSelector.onKeyDown(k))||
(G=1):1===G&&((d=this.Baa.onKeyDown(k))||(G=2));d?oc.g(k):rd.prototype.onKeyDown.call(this,k)}};hb.prototype.setFocus=function(){(this.Baa||this.fieldListSelector)&&this.nMg(this.ZXe())};hb.prototype.nMg=function(k){for(var G=!1,d=0;2>d&&!G;d++)1===k&&this.Baa?(G=this.Baa.setFocus(!0))||(k=2):2===k&&this.fieldListSelector&&((G=this.fieldListSelector.setFocus(!0))||(k=1))};hb.prototype.ZXe=function(){if(!this.fieldListSelector||!this.Baa)return 0;var k=this.fieldListSelector.hasFocus(),G=this.Baa.hasFocus();
return!k&&!G||G?1:2};hb.prototype.TFj=function(k,G){var d=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new zb(this.$,d,k,G,this.touchMode);this.fieldListSelector.tni?(this.W0b.setAttribute(de.a.i0b,"true"),d=this.getElementById("bix-drilldetails"),this.Baa=new Ed(this.$,d,this.Qy,G,this.fieldListSelector,this),this.fieldListSelector.vpj(),this.fieldListSelector.start(),this.setFocus(),this.W0b.setAttribute(de.a.i0b,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=
null,dd.DOMElementExtensions.Lv(this.Qb,Zb.a.instance.fa(1157)))};hb.prototype.OUc=function(){var k=this.FU=document.createElement("div");dd.DOMElementExtensions.$_b(k);k.classList.add(Jc.unh);Wd.a.instance.pa(rc.a.pointerDown,k,this.U9a);this.domElement.ownerDocument.body.appendChild(k)};hb.prototype.Fsc=function(){this.FU&&(Wd.a.instance.za(rc.a.pointerDown,this.FU,this.U9a),dd.DOMElementExtensions.Af(this.FU),this.FU=null)};hb.W1h=function(){return hb.CGb||(hb.CGb=[0,1,4,5])};Ck.Object.defineProperties(hb.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"BIExploreCallout"}},$fi:{configurable:!0,enumerable:!0,get:function(){return this.Y9d}},ota:{configurable:!0,enumerable:!0,get:function(){return 6}},Iu:{configurable:!0,enumerable:!0,get:function(){return 561}}});hb.CGb=null;Object(bb.a)(hb,"BIExploreCallout",gd.a,[856,500]);var Ue=Gb.a;Am(Ib,Ue);Ib.prototype.dispose=function(){this.Lha.dispose();this.$=null;Ue.prototype.dispose.call(this)};Ib.prototype.getButton=function(k){return this.Lha.getButton(k)};
Ib.prototype.uBj=function(k,G,d,S){this.Lha.Jp(k+this.u2b,G+this.u2b,d,S)};Ib.prototype.vBj=function(){var k=Sc.g(this.$).ha.ta.activeCell,G=Sc.g(this.$).rb.rj(k);(k=Sc.g(this.$).qg(k,G))&&0<=k.x&&0<=k.y?this.Jp(k.bottomRight.x+this.Ez,k.bottomRight.y+this.Ez,Sc.g(this.$).rtl,G):this.hide()};Ib.prototype.Jp=function(k,G,d,S){this.Lha.Jp(k,G,d,S)};Ib.prototype.hide=function(){this.Lha.hide()};Ib.prototype.domElement=function(k){return this.Lha.domElement(k)};Ib.prototype.D2a=function(k){this.Lha.D2a(k)};
Ck.Object.defineProperties(Ib.prototype,{Ez:{configurable:!0,enumerable:!0,get:function(){return this.Lha.Ez}},u2b:{configurable:!0,enumerable:!0,get:function(){return this.Lha.u2b}}});Object(bb.a)(Ib,"BIExploreLaunchButton",Gb.a,[]);var ef=b(45);nb.prototype.reset=function(){this.zjb="";this.Fra=this.zPc=this.yPc=null};nb.prototype.Hsj=function(k,G){this.reset();this.Yhb=G.confirmationRequiredForDataOps;this.ODa=G.externalSourceIndex;this.zPc=G.pivotTableName;this.Fra=ef.o(k,this.$);k.Kd(G.CX)||
k.Kd(G.IM)?(G=Sc.g(this.$).mc(k),this.zjb=ge.a.Sf(G.text)):(k=k.top-G.top,G.UMd&&G.UMd.length>k&&(this.zjb=G.UMd[k]))};nb.prototype.Ppj=function(k,G,d){this.reset();this.ODa=G.ExternalSourceIndex;this.Yhb=!!(G.Attributes&64);this.zjb=ge.a.Sf(d.ValueString);this.yPc={};this.tS.ChartId=k;this.tS.AnchorValue2=-1;switch(d.Type){case 1:case 2:0<=d.CategoryIndex?(this.tS.AnchorType=2,this.tS.AnchorValue1=d.CategoryIndex):(this.tS.AnchorType=1,this.tS.AnchorValue1=d.SeriesIndex);break;default:0>d.CategoryIndex&&
0<=d.SeriesIndex?(this.tS.AnchorType=1,this.tS.AnchorValue1=d.SeriesIndex):(this.tS.AnchorType=3,this.tS.AnchorValue1=d.SeriesIndex,this.tS.AnchorValue2=d.CategoryIndex)}this.Fra={};this.$.Dj(this.Au);this.Au.FirstRow=-1;this.Au.FirstColumn=-1};Ck.Object.defineProperties(nb.prototype,{confirmationRequiredForDataOps:{configurable:!0,enumerable:!0,get:function(){return this.Yhb}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.ODa}},F8h:{configurable:!0,enumerable:!0,get:function(){return this.zjb}},
z_:{configurable:!0,enumerable:!0,get:function(){return!!this.tS}},Idf:{configurable:!0,enumerable:!0,get:function(){return!!this.Au}},tS:{configurable:!0,enumerable:!0,get:function(){return this.yPc}},pivotTableName:{configurable:!0,enumerable:!0,get:function(){return this.zPc}},Au:{configurable:!0,enumerable:!0,get:function(){return this.Fra}}});Object(bb.a)(nb,"BixSelectionContext",null,[]);var pe=b(1E3),Ne=b(246),gg=b(63),ie=b(328),Re=b(254),Ig=b(245),Lf=b(916),qf=b(616),vg=b(3),jc=b(107),zc=
b(562),Md=b(55),Ce=Gb.a;Am(Cb,Ce);Cb.prototype.eAe=function(){this.showCallout(!1)};Cb.prototype.dispose=function(){this.gridView&&(this.gridView.Cb.BIb(this.dza),this.gridView.rc&&this.gridView.rc.kl(this.gj));if(this.$){var k=this.$;k.userOperationManager.Cr(this.aFf);k.sm(this.Zc);k.AD(this.fj);Sc.g(k).gx(this.jS);zc.a(k).gx(this.iEb)}Ac.a.Ha(this.Zh);this.Qy=this.$=this.gridView=this.callout=this.Zh=null;Ce.prototype.dispose.call(this)};Cb.prototype.$c=function(k,G){if(1529658657===G&&(8===k||
!this.Qy.Idf))return!0;1247109494!==G&&-498523270!==G||this.ny();return!1};Cb.prototype.executeCommand=function(k,G){this.callout?this.ny():(this.scrollIntoView(),this.showCallout(3===G.method));return Md.Task.Ra(!0)};Cb.prototype.Kc=function(k,G){return 1529658657===G.command};Cb.prototype.jd=function(){return!1};Cb.prototype.ny=function(){this.B1c();this.Zh.hide()};Cb.prototype.Wf=function(k,G){this.callout&&!G&&this.callout.takeFocus();return!G};Cb.prototype.sh=function(k){return dd.DOMElementExtensions.Gf(this.uc,
k)};Cb.prototype.Ej=function(){};Cb.prototype.Rj=function(){};Cb.prototype.eKf=function(k,G,d,S,P){this.Qy.reset();if(this.allow&&!gg.e(this.$.qa))if(d&&d.Attributes&512&&S&&G){var ja=this.$.BJ;this.B1c();this.Qy.Ppj(G,d,S);this.i7a()?(G=zc.a(this.$).domElement,d=dd.DOMElementExtensions.getLocation(G),S=Math.abs(G.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===Sys.Browser.Safari&&(S=G.scrollWidth-G.offsetWidth-S),S*=-1),k=new Oc.a(k.x-d.x+S,k.y-d.y+G.scrollTop),ja&&(k.x=G.offsetWidth-k.x)):
(G=this.gridView.Tf(P).view.Pg,k=Lf.a.Es(G,this.gridView.Tf(P).domElement,new Sys.UI.Point(Math.round(k.x),Math.round(k.y)),ja));this.Zh.uBj(k.x,k.y,ja,P)}else this.ny()};Cb.prototype.dNg=function(k){k&&(this.gridView=k,this.gridView.Cb.fob(this.dza),this.gridView.rc.sl(this.gj))};Cb.prototype.MX=function(){this.Cyj()?this.Zh.vBj():this.Zh.hide()};Cb.prototype.Cyj=function(){this.Qy.reset();if(!this.allow||this.gridView.ha.Oa.oc)return!1;var k=qf.a(this.$).TKa();if(Object(qd.a)(Ne.PivotTableRange,
k)&&k.supportsBIExplore){var G=this.gridView.ha.ta.activeCell,d=this.gridView.mc(G);if(G&&d&&this.gridView.ha.ta.L_){var S=G.left-k.left,P=G.top-k.top;if(!(k.O_g&1<<S||k.Bjj&1<<P||k.I_g&1<<S||k.xjj&1<<P||d.hasAutoFilter)&&(S=G.Kd(k.CX)||G.Kd(k.IM),P=!1,k.CX&&k.IM?P=G.top<k.CX.top&&G.left<k.IM.left||G.top<k.IM.top:k.IM&&(P=G.top<k.IM.top),!S&&!P&&0<d.text.length||S&&(0<d.text.length||d.ZMa||d.q7a)))return this.Qy.Hsj(G,k),!0}}return!1};Cb.prototype.showCallout=function(k,G){var d=this;G=void 0===G?
1:G;qf.a(this.$).Vx(this.Qy.confirmationRequiredForDataOps,function(S){S&&d.Qy.Idf&&(d.callout=new hb(d.$,d.Qy,d.Zh.domElement(G),k),d.callout.initialize(),d.Zh.D2a(G),d.callout.YP(d.AAd),d.callout.kf());d.Zh.getButton(1).kcb()})};Cb.prototype.B1c=function(){this.Zh.getButton(1).kcb();this.callout&&!this.callout.$fi&&(this.callout.kAa(this.AAd),this.callout.Ut(),this.callout=null)};Cb.prototype.scrollIntoView=function(){var k=this.gridView.ha;if(1===k.Ue){k=k.ta.activeCell;var G=this.gridView.view.visibleArea,
d=this.gridView.qg(k);G&&d&&!G.contains(d)&&this.gridView.eu(k,3,jc.a.JOg)}};Cb.prototype.i7a=function(){return this.$.ea.isNamedObjectViewMode&&gg.f(this.$.qa)};Cb.ka=function(k,G){pe.a(k)||k.da.Ga(2,new Cb(k,G))};Ck.Object.defineProperties(Cb.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.callout?this.callout.domElement:null}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.callout}},ve:{configurable:!0,enumerable:!0,get:function(){return Re.a.SYc}},
H0e:{configurable:!0,enumerable:!0,get:function(){dc.ULS.shipAssertTag(537170304,8,!Sc.g(this.$).rb.dj,"GetLaunchMonocleButton is not supported in freeze pane");return Object(nd.a)(Sys.UI.Control,this.Zh.getButton(1))}},c1e:{configurable:!0,enumerable:!0,get:function(){return this.callout}},allow:{configurable:!0,enumerable:!0,get:function(){return this.$.Yf.get(6)&&1===this.state&&this.$.wc.o3(135200)}}});Object(bb.a)(Cb,"BIExploreManager",Gb.a,[424,759,438,2,760]);var ae=b(11),ud=b(904),Rb=b(102),
Ie=b(645),pa=b(150),qb=b(28),Sb=b(186);tb.prototype.$c=function(k,G){return(2140436015===G||-1006032470===G)&&!(new pa.a(this.pAg)).ke(8192)};tb.prototype.executeCommand=function(k,G,d,S){k=G.command;S=S.dka();switch(k){case 2140436015:case -1006032470:this.fieldManagerPane&&(this.fieldManagerPane.oyc(!Rb.f(this.$.kg),G,!1),dc.ULS.sendTraceTag(537162717,0,50,"{0} Field List",2140436015===k?"Show":"Hide"));break;case 589118293:case -1687560254:return this.u7b(!0,!1,S);case 1176256599:return this.u7b(!1,
!1,S);case -1751201991:return this.u7b(!0,!0,S);case -232434744:return this.u7b(!1,!0,S);default:return Sb.a(k)}return Md.Task.Ra(!0)};tb.prototype.Kc=function(k,G){k=!1;switch(G.command){case 2140436015:case -1006032470:k=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:k=!0}return k};tb.prototype.jd=function(){return!1};tb.prototype.u7b=function(k,G,d){var S=this,P=qb.a.Ta.Wb,ja=Sc.g(this.$).ha.ta.activeCell;return ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,
12,477,d),function(){qf.a(S.$).Vx(!1,function(D){if(D){Sc.g(S.$).Kp(!0);var da=ef.o(ja,S.$);S.$.ic(-867563466,function(Ha,jb,kc){return Xe.lb(S.$.na.va,da,0,!1,!1,!1,k,G,Ha,jb,kc,null,null)},P,0,6,161,function(){return new Ie.a(da,G)})}})},this.$.la,3)};tb.Yrb=function(k,G,d){var S={};k.Dj(S);S.FirstRow=G;S.FirstColumn=d;return S};Object(bb.a)(tb,"FieldListCommandHandler",null,[424]);var $b=ud.a;Am(Va,$b);Va.prototype.Nd=function(){var k=this;ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,
16,74,this.ub),function(G){k.Dd([new tb(k.$,G.result,k.$.xa)])},this.la,3)};Va.ka=function(k){ud.a.he(75,new Va(k))};Object(bb.a)(Va,"FieldListCommandHandlerFactory",ud.a,[]);var tc=b(226);ub.prototype.W8g=function(){var k={};k.AnchorType=this.anchorType;7===this.anchorType&&(k.ChartId=this.chartId);k.AnchorValue1=k.AnchorValue2=-1;return k};ub.Q4b=function(){return new ub(null,null,-1)};ub.create=function(k,G,d){return new ub(k,G,d)};ub.vif=function(k,G){return k.$Ma!==G.$Ma||k.anchorType!==G.anchorType||
k.chartId!==G.chartId||k.pivotTableName!==G.pivotTableName||!!k.Au&&!!G.Au&&k.Au.SheetName!==G.Au.SheetName};ub.fpi=function(k,G){return ub.vif(k,G)||k.sO!==G.sO||k.Mo!==G.Mo};Ck.Object.defineProperties(ub.prototype,{sO:{configurable:!0,enumerable:!0,get:function(){return this.Mfe},set:function(k){this.Mfe=k}},Mo:{configurable:!0,enumerable:!0,get:function(){return this.jhe},set:function(k){this.jhe=k}},bK:{configurable:!0,enumerable:!0,get:function(){return this.z7d},set:function(k){this.z7d=k}},
aR:{configurable:!0,enumerable:!0,get:function(){return this.A7d},set:function(k){this.A7d=k}},$Ma:{configurable:!0,enumerable:!0,get:function(){return this.pW||this.Vhc}},Jli:{configurable:!0,enumerable:!0,get:function(){return this.$Ma&&!this.Jqd}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.ODa}},Au:{configurable:!0,enumerable:!0,get:function(){return this.Fra}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.Au?this.Au.SheetName:null}},AIa:{configurable:!0,
enumerable:!0,get:function(){return this.chartId+"_"+this.pivotTableName+"_"+this.bK+"_"+this.aR}}});Object(bb.a)(ub,"FieldListRequestState",null,[785]);var ld=tc.a;Am(La,ld);La.prototype.create=function(){var k=ub.create(this.$,null,-1);this.Eb(k)};La.prototype.dispose=function(){this.$=null;ld.prototype.dispose.call(this)};La.ka=function(k){k.da.Ga(110,new La(k))};Object(bb.a)(La,"FieldListRequestStateFactory",tc.a,[]);var Vc=b(439),Se=b(37),Ge=b(1001),Af=b(109),jf=b(4),Ef=b(86),Xf=b(39),ug=b(617);
ua.prototype.ysf=function(){return this.ZD=this.correlationId+1};Ck.Object.defineProperties(ua.prototype,{correlationId:{configurable:!0,enumerable:!0,get:function(){return this.ZD}}});Object(bb.a)(ua,"DataRequestInfo",null,[]);ba.vqh="ewa-flp-react-pane";ba.uqh="ewa-flp-react-header";ba.wqh="ewa-flp-react-title";ba.sqh="ewa-flp-react-body";ba.tqh="ewa-flp-react-close-button";ba.Iph="ewa-flp-border-ltr";ba.Jph="ewa-flp-border-rtl";ba.Hph="ewa-fieldlistloadingindicator-div";ba.Hqh="ewa-flp-title";
ba.Iqh="ewa-flp-title-new";ba.BOe="ewa-flp-nov2";ba.dqh="ewa-flp-dropzones";ba.oOe="ewa-flp-close";ba.Jqh="ewa-flp-washout";ba.Mph="ewa-flp-close-hover";ba.Nph="ewa-flp-close-pressed";ba.xOe="ewa-flp-fieldmanager";ba.mqh="ewa-flp-fieldmanager-new";ba.kqh="ewa-flp-fieldlist";ba.lqh="ewa-flp-fieldlist-new";ba.S8b="ewa-flp-divtabs";ba.R8b="ewa-flp-buttontab";ba.Kph="ewa-flp-buttontab-selected";ba.yqh="ewa-flp-tabsseparator";ba.zqh="ewa-flp-tabsseparator-new";ba.pOe="ewa-flp-divshowrelatedto";ba.Qph=
"ewa-flp-divshowrelatedtolabel";ba.Rph="ewa-flp-divshowrelatedtolabel-new";ba.EOe="ewa-flp-showrelatedtoseparator";ba.DOe="ewa-flp-showrelatedtocombobox";ba.nqh="ewa-flp-fieldwell";ba.oqh="ewa-flp-fieldwell-new";ba.eqh="ewa-flp-dropzones-new";ba.aqh="ewa-flp-dropzonedescriptionearea";ba.bqh="ewa-flp-dropzonedescriptionearea-new";ba.Q9c="ewa-flp-description";ba.Zph="ewa-flp-dropzonedescription";ba.$ph="ewa-flp-dropzonedescription-new";ba.tOe="ewa-flp-dropzoneimage";ba.vOe="ewa-flp-dropzonetitle";ba.Wph=
"ewa-flp-dropzoneareatopseparator";ba.Vph="ewa-flp-dropzoneareamiddleseparator";ba.Xph="ewa-flp-dropzonebucketarea";ba.Yph="ewa-flp-dropzonebucketarea-new";ba.qOe="ewa-flp-dropzone";ba.rOe="ewa-flp-dropzoneRightColumn";ba.cqh="ewa-flp-dropzonerow";ba.Tph="ewa-flp-dropzoneQuadrant";ba.Uph="ewa-flp-dropzoneQuadrant-new";ba.sOe="ewa-flp-dropzoneTitleDiv";ba.yOe="ewa-flp-listitem";ba.iqh="ewa-flp-dzlistitem";ba.hqh="ewa-flp-dzemptylistitem";ba.fqh="ewa-flp-dzDragDropLandSiteAbove";ba.gqh="ewa-flp-dzDragDropLandSiteBelow";
ba.Fqh="ewa-flp-tdnonlabelitem";ba.Dqh="ewa-flp-tdnmenulabelitem";ba.Gqh="ewa-flp-tdnonlabelitem-new";ba.Eqh="ewa-flp-tdnmenulabelitem-new";ba.uOe="ewa-flp-dropzonespanfiltermenu";ba.Cqh="ewa-flp-tdautomarginitem";ba.AOe="ewa-flp-listitemlabel";ba.wOe="ewa-flp-dzlistitemlabel";ba.zOe="ewa-flp-listiteminputfiltermenu";ba.qqh="ewa-flp-listitemdivfiltermenu";ba.pqh="ewa-flp-listitemdivblankimage";ba.Lph="ewa-flp-checkbox";ba.T8b="ewa-flp-spanlabel";ba.Oph="ewa-flp-collapseexpand";ba.Pph="ewa-flp-dimensionseparator";
ba.xqh="ewa-flp-tableseparator";ba.Sph="ewa-flp-draggableitem";ba.jqh="ewa-flp-elementWithFocus";ba.rqh="ewa-flp-pressedelement";ba.COe="ewa-flp-selecteditem";ba.FOe="ewa-flp-unorderedlist";ba.Kqh="ewa-flp-zonelist";ba.Aqh="ewa-flp-tabstable";ba.Bqh="ewa-flp-tabstable-new";ba.kAe="clip1x1";Object(bb.a)(ba,"CssClassNames",null,[]);var Wb=b(25),Kc=b(643),Id=b(175),Bd=b(1339),oe=b(119),Hd=b(618);K.bEh="flp_activeTab";K.cEh="flp_allTab";K.eEh="flp_srt_combobox";K.fEh="flullist";Object(bb.a)(K,"CssElementIds",
null,[]);var we=b(1194),df=b(22),sf=ba.rqh,wf=ba.jqh,$e=b(115),pf=we.a;Am(xb,pf);xb.prototype.Unb=function(k){this.addHandler("DragCancelled",k)};xb.prototype.pIb=function(k){this.removeHandler("DragCancelled",k)};xb.prototype.Vnb=function(k){this.addHandler("DragFinished",k)};xb.prototype.qIb=function(k){this.removeHandler("DragFinished",k)};xb.prototype.hoe=function(k){this.addHandler("DragFinishedNoMovement",k)};xb.prototype.TQf=function(k){this.removeHandler("DragFinishedNoMovement",k)};xb.prototype.dispose=
function(){Ac.a.yc([this.iB]);pf.prototype.dispose.call(this)};xb.prototype.maf=function(){this.iB.ka("keydown",this.sEb);this.H7b=!1};xb.prototype.drag=function(k,G){pf.prototype.drag.call(this,k,G);this.vqj()};xb.prototype.isRtl=function(){return this.host.isRtl};xb.prototype.c2e=function(){return this.host.parentElement};xb.prototype.Yt=function(k){pf.prototype.Yt.call(this,k);this.iB.hB();this.H7b?(this.H7b=!1,this.raiseEvent("DragCancelled")):this.k8e?this.raiseEvent("DragFinished"):this.raiseEvent("DragFinishedNoMovement")};
xb.prototype.o0=function(k){this.Yt(ne.HelperMethods.Km(k));return!1};xb.prototype.ZK=function(k){this.drag(!1,ne.HelperMethods.Km(k));return!1};xb.prototype.vqj=function(){this.domElement.style.cursor=this.host.Sih(this.tGb,this.otd)?"move":"not-allowed"};xb.Mqb=function(k,G,d,S){var P=document.createElement("div");P.className=ba.Sph;P.style.left=ne.HelperMethods.nc(d.x);P.style.top=ne.HelperMethods.nc(d.y);P.style.width=ne.HelperMethods.nc(S);P.style.fontWeight=G.currentStyle.fontWeight;P.style.paddingRight=
G.currentStyle.paddingRight;P.style.paddingLeft=G.currentStyle.paddingLeft;P.style.textAlign=G.currentStyle.textAlign;P.innerHTML=k.Name?ge.a.Sf(k.Name):"";P.id=mb(k,"fldrag_");return P};xb.ZZe=function(k,G,d,S){k.y-=G.scrollTop;S&&qc.a.xf&&(k.x+=parseInt(d.right,10),$e.a.Hxa(G)&&(k.x+=$e.a.zu));return k};Ck.Object.defineProperties(xb.prototype,{tGb:{configurable:!0,enumerable:!0,get:function(){return this.uug}}});Object(bb.a)(xb,"FieldListDraggableItem",we.a,[]);var bg=b(157),Zd=b(95),Ma=K.fEh,Hb=
K.bEh,ic=K.cEh,Lc=K.eEh,td=ba.Kph,pd=ba.Fqh,Qe=ba.Dqh,ff=ba.Gqh,hf=ba.Eqh,yg=ba.Cqh,bf='<div ID="{0}" class="'+ba.kqh+'">',Cg='<div ID="{0}" class="'+ba.lqh+'">',Gg='<table class="'+ba.Aqh+'" ID="{4}" direction="{8}" cellspacing="0" cellPadding="0"><tr><td><div ID="{0}" class="'+ba.S8b+'"><input ID="{5}" type="button" value="{1}" class="'+ba.R8b+'" area-controls="{7}" tabindex="0"/></div></td><td style="padding-left: 2px; padding-right: 2px;"><div class="'+ba.yqh+'">&nbsp;</div></td><td><div ID="{2}" class="'+
ba.S8b+'"><input ID="{6}" type="button" value="{3}" class="'+ba.R8b+'" area-controls="{7}" tabindex="0"/></div></td></tr></table>',xg='<div class="'+ba.Bqh+'" ID="{4}" direction="{8}"><div ID="{0}" class="'+ba.S8b+'"><input ID="{5}" type="button" value="{1}" class="'+ba.R8b+'" area-controls="{7}" tabindex="0"/></div><div class="'+ba.zqh+'">&nbsp;</div><div ID="{2}" class="'+ba.S8b+'"><input ID="{6}" type="button" value="{3}" class="'+ba.R8b+'" area-controls="{7}" tabindex="0"/></div></div>',wc='<table ID="{3}" direction="{6}" cellspacing="0" cellPadding="0"><tr><td><div ID="{1}" class="'+
ba.Qph+'">{2}</div></td><td><div class="'+ba.EOe+'">&nbsp;</div></td><td><div ID="{0}" class="'+ba.pOe+'"><select id="{4}" class="'+ba.DOe+'" area-controls="{5}" tabindex="0"></select></div></td></tr></table>',jd='<div ID="{3}" direction="{6}" style="display: flex; flex-wrap: wrap; margin-bottom: 4px;"><div ID="{1}" class="'+ba.Rph+'">{2}</div><div class="'+ba.EOe+'">&nbsp;</div><div ID="{0}" class="'+ba.pOe+'"><select id="{4}" class="'+ba.DOe+'" area-controls="{5}" tabindex="0"></select></div></div>',
xd='<div ID="{0}" class="'+ba.nqh+" "+Qc.a.lm+'"></div>',me='<div ID="{0}" class="'+ba.oqh+" "+Qc.a.lm+'"></div>',Ae='<ul id="{0}" class="'+ba.FOe+'">{1}</ul>',Ze='<li id="{0}" class="'+ba.yOe+'"><table direction="{2}" cellspacing="0" cellPadding="0" style="width: 100%"><tr>{1}</tr></table></li>',Bf='<li id="{0}" class="'+ba.yOe+'"><div direction="{2}" style="width: 100%"><div style="display: flex; align-items: center">{1}</div></div></li>',Qf='<div class="'+Qc.a.Wr+'" {4}><input id="{0}" class="{1}" title="{2}" alt="{2}" type="image" src="{3}" tabindex="0" role="tree" aria-expanded="{5}"/></div>',
Vg='<div id="{0}" class="'+ba.T8b+'" title="{3}" {4}><label id="{1}" class="'+ba.AOe+' {2}" style="max-width:{5}">{3}</label></div>',Rf='<div id="{0}" class="'+ba.T8b+'" title="{3}" {4}><label id="{1}" class="'+ba.AOe+' {2}" style="width:calc(100% - 4px)">{3}</label></div>',De='<div id="{1}" {3}><input id="{0}" class="'+ba.Lph+'" type="checkbox" {2} tabindex="0"/></div>',Lg='<div class="'+Qc.a.Wr+'" {4}><img id="{0}" class="{2}" title="{1}" alt="{1}" src="{3}"/></div>',$d='<div id="{1}" class="'+
Qc.a.w1c+" "+ba.qqh+'"><input id="{0}" class="{3}" type="image" title="{2}" alt="{2}" src="{4}" style="visibility: hidden; display: none;" tabindex="0" role="{5}" {6}/></div>',le='<div id="{1}" class="'+Qc.a.Wr+'"><img id="{0}" class="{3}" title="{2}" alt="{2}" src="{4}"/></div>',lh='<div id="{1}" class="'+Qc.a.kAe+" "+ba.pqh+'"><img id="{0}" class="{2}" src="{3}" '+de.a.Rd+'="'+de.a.Sr+'"/></div>',Kf='<div class="'+ba.Pph+'"></div>',Ph='<div class="'+ba.xqh+'"></div>',Da=fc.a;Am(Yb,Da);Yb.prototype.evc=
function(k){k?this.zo.scrollTop=this.scrollTop:this.scrollTop=this.zo.scrollTop};Yb.prototype.jqi=function(k){return Xf.a.yB(dd.DOMElementExtensions.getBounds(this.zo),k)};Yb.prototype.XRj=function(){this.zk.IsCollapsed=!this.zk.IsCollapsed};Yb.prototype.dispose=function(){Ac.a.yc([this.Ale,this.kqe,this.yyc,this.e3a]);this.$&&(this.$.Ka.kKd(this.TEb),this.$.Ka.Qbb(this.su));this.fNb=this.V4f=this.TIa=this.mua=this.l4=this.UIa=this.zo=this.fieldListItems=this.$=null;this.k4();Da.prototype.dispose.call(this)};
Yb.prototype.yFg=function(k){this.addHandler("FieldListChanging",k)};Yb.prototype.bcj=function(k){this.removeHandler("FieldListChanging",k)};Yb.prototype.xFg=function(k){this.addHandler("FieldListChanged",k)};Yb.prototype.acj=function(k){this.removeHandler("FieldListChanged",k)};Yb.prototype.Vgj=function(k){k&&this.setFocus(!1,!1);return k};Yb.prototype.DMg=function(k){this.fieldListItems&&(this.Bkj(),this.fieldListItems=this.zk=this.cu=null);k&&(this.fieldListItems=k.FieldListItems,-1===this.sO&&
(this.sO=k.RelatedGroups&&0<k.RelatedGroups.length?k.RelatedGroups[0].GroupId:-1),this.eNb=k.ShowTabs,this.cI=k.IsPpm,this.ysc=k.ShowRelatedGroups,this.Mo=k.SelectedTab,this.Cti());this.NTf(this.scrollTop,this.qr!==this.zo||this.Elc?null:this.zk);this.Stj(k?k.RelatedGroups:null,this.sO);k&&(this.yuj(),this.host.F_||this.ZIb())};Yb.prototype.setFocus=function(k,G){k?(this.UPf(),G&&(this.ZJa=!0,this.zk=this.qr=null,this.Mub="")):this.Elc||(this.gL=Sa(null,this.gL,this.gL===this.cu),this.aA())};Yb.prototype.Ccb=
function(k){this.zPf();return this.v1e(k)};Yb.prototype.zPf=function(){this.qr===this.mua?this.qr.classList.remove(wf):this.qr===this.zo&&this.sJd()};Yb.prototype.dcd=function(k){var G=k.keyCode,d=!1;38===G||40===G?k.altKey?this.cu&&this.qr===this.zo&&this.BSa(this.zk)&&(G=this.getElementById(mb(this.zk,"flm_")),this.OJa(k,G.parentNode,this.zk)):this.qr===this.zo&&this.cu&&((k=this.$_f(this.fieldListItems,40===G).Ksf)&&this.Fwc(k),d=!0):37===G||39===G?this.qr===this.zo&&this.cu&&this.zk.IsCollapsible&&
(this.getElementById(mb(this.zk,"flb_")),this.B9b(this.zk),d=!0):32===G||13===G?this.qr===this.TIa?d=this.NYf():this.qr===this.mua?d=this.TYf():this.qr===this.zo&&(d=!0,this.cu&&(this.zk.ShowCheckBox&&32===G?(this.getElementById(mb(this.zk,"flcb_")),this.Tye(this.zk)):this.BSa(this.zk)&&13===G&&(G=this.getElementById(mb(this.zk,"flm_")),this.OJa(k,G.parentNode,this.zk)))):9===G&&(d=this.Ccb(!k.shiftKey));return d};Yb.prototype.oja=function(k,G){return k.Name+"_"+k.UniqueName+"_"+k.TypeTag+"_"+(G||
this.Lia)};Yb.prototype.Bkj=function(){this.cWf(this.fieldListItems,"");this.U1a[this.Lia+"_fieldWellScrollTop"]=this.zo.scrollTop};Yb.prototype.cWf=function(k,G){for(var d=0,S=k.length;d<S;d++){var P=k[d],ja="";if(P.IsCollapsible||P.Children)ja=this.oja(P,G),P.IsCollapsible&&(this.a7c[ja]=!!P.IsCollapsed),P.Children&&this.cWf(P.Children,ja);this.zk&&this.zk.ClientId===P.ClientId&&(this.Mub=ja||this.oja(P,G))}};Yb.prototype.Cti=function(){this.Rlf(this.fieldListItems,"");this.zo&&(this.scrollTop=
vb.a.fo(this.U1a,this.Lia+"_fieldWellScrollTop",0))};Yb.prototype.Rlf=function(k,G){for(var d=0,S=k.length;d<S;d++){var P=k[d],ja="";if(P.IsCollapsible||P.Children)ja=this.oja(P,G),P.IsCollapsible&&ja in this.a7c&&(P.IsCollapsed=vb.a.xg(this.a7c,ja)),P.Children&&this.Rlf(P.Children,ja);this.Mub&&df.a.equals(this.Mub,ja||this.oja(P,G),!1)&&(this.zk=P,this.Mub="")}};Yb.prototype.BSa=function(k){return 7===k.TypeTag&&this.CUe(this.fieldListItems,k.ClientParentId)?!0:k.ShowFilterArrow||k.ShowCheckBox};
Yb.prototype.DQh=function(k){return this.BSa(k)?this.getElementById(mb(k,"flm_")):k.IsCollapsible?this.getElementById(mb(k,"flb_")):k.ShowCheckBox?this.getElementById(mb(k,"flcb_")):this.getElementById(mb(k,"flfimg_"))};Yb.prototype.sJd=function(){this.cu&&this.cu.classList.remove(wf);dd.DOMElementExtensions.setVisible(this.P$b,!1);this.P$b=null};Yb.prototype.Fwc=function(k){this.sJd();this.zk=k;k=this.DQh(this.zk);k.id.startsWith("flm_")&&(this.P$b=k,dd.DOMElementExtensions.setVisible(this.P$b,!0));
dd.DOMElementExtensions.setFocus(k);this.cu=this.getElementById(mb(this.zk,"fli_"));this.cu.classList.add(wf)};Yb.prototype.XZf=function(){if(!this.fieldListItems||!this.fieldListItems.length)return!1;this.Fwc(this.zk||this.fieldListItems[0]);return!0};Yb.prototype.$_f=function(k,G){var d=this,S;var P=S=null;var ja=!1,D=k.length;if(0<D)if(this.zk)for(var da={},Ha=0;Ha<D;da={vT:da.vT},Ha++){da.vT=k[Ha];G?da.vT===this.zk&&(ja=!0,P=Yb.yNa(da.vT)?da.vT.Children[0]:Ha<k.length-1?k[Ha+1]:null):Yb.yNa(da.vT)&&
this.zk===da.vT.Children[0]?(ja=!0,P=da.vT):da.vT===this.zk?(ja=!0,0<Ha&&(P=S)):S=da.vT;if(ja)break;if(Yb.yNa(da.vT)){if(function(jb){return function(){var kc=d.$_f(jb.vT.Children,G);P=kc.Ksf;S=kc.v1i;return kc}}(da)().returnValue){P?this.Fwc(P):G&&Ha<k.length-1&&(P=k[Ha+1],this.Fwc(P));ja=!0;break}S||(S=da.vT)}}else P=k[0],ja=!0;return{returnValue:ja,Ksf:P,v1i:S}};Yb.prototype.v1e=function(k){if(this.ZJa){this.ZJa=!1;this.SG=k?0:this.Saa.length-1;var G=this.Saa[this.SG]}else this.SG=k?this.SG+1:
this.SG-1,G=0<=this.SG&&4>this.SG?this.Saa[this.SG]:null;this.qr=G;if(!G)return this.ZJa=!0,!1;k=this.b0f(k);this.ZJa=!k;return k};Yb.prototype.b0f=function(k){if(!dd.DOMElementExtensions.isVisible(this.Saa[this.SG])){this.SG=k?this.SG+1:this.SG-1;if(0>this.SG||4<=this.SG)return!1;this.qr=this.Saa[this.SG];return this.b0f(k)}return 3!==this.SG?this.aA():this.XZf()};Yb.prototype.aA=function(){!this.qr&&this.ZJa&&this.v1e(!0);if(this.qr===this.zo)return this.XZf();dd.DOMElementExtensions.setFocus(this.qr===
this.TIa?this.getElementById(Hb):this.qr===this.mua?this.getElementById(ic):this.qr===this.l4?this.getElementById(Lc):null);return!0};Yb.prototype.UPf=function(){this.qr===this.zo&&this.sJd()};Yb.prototype.OJa=function(k,G,d){if(d&&this.BSa(d)){var S={};this.gL=Sa(this.getElementById(mb(d,"fli_")),this.gL,this.gL===this.cu);if(d.ShowFilterArrow||7===d.TypeTag){var P=-1065117584;S.pivotName=this.host.pivotName;S.domElement=G;G=dd.DOMElementExtensions.getBounds(k.target);G=new Sys.UI.Point(G.x,G.y);
S.location=G;G={};this.host.chartId?(G.AnchorType=d.IsChecked?8:10,G.ChartId=this.host.chartId):G.AnchorType=d.IsChecked?9:11;if(7!==d.TypeTag)G.AnchorValue1=d.PivotCacheIndex,G.AnchorValue2=-1;else{var ja=0<=d.ClientParentId?Fb(this.fieldListItems,d.ClientParentId,!0):null;G.AnchorValue1=ja.PivotCacheIndex;G.AnchorValue2=d.PivotCacheIndex}S.cell=this.host.Au;S.dataSourceIndex=this.host.externalSourceIndex;S.requiresConfirmation=this.host.confirmationRequiredForDataOps;S.optionalPivotMenuAnchorParameter=
G}else P=330754562,S.fieldItem=d,S.versionkey=this.host.AIa;S.isChart=!!this.host.chartId;S.isPpm=this.cI;S.rawEvent=k.rawEvent;S.objectVersion=this.UAi++;k=new Zd.a(P,0,this.$.fd,30,null);var D;this.nxd=!bg.a(D=this.$.Ka.$b(k,S))&&(6!==D.status||D.result)}};Yb.prototype.Tye=function(k){if(null===k||void 0===k?0:k.ShowCheckBox)this.host.ojf(k,!k.IsChecked),this.zk=k};Yb.prototype.B9b=function(k){if(null===k||void 0===k?0:k.IsCollapsible)5===k.TypeTag&&k.IsCollapsed&&!k.Children.length?(this.host.y9b(),
this.KZa(this.zo)):(k.IsCollapsed=!k.IsCollapsed,this.NTf(this.zo.scrollTop,k))};Yb.prototype.IZh=function(k){return 11===k.TypeTag?this.cI?1===this.Mo?Qc.a.tuh:Qc.a.uuh:Qc.a.quh:19===k.TypeTag?Qc.a.yuh:29===k.TypeTag?Qc.a.VPe:31===k.TypeTag?Qc.a.VPe:2===k.Image?k.IsCollapsed?Qc.a.ruh:Qc.a.suh:23===k.TypeTag?k.IsCollapsed?Qc.a.zuh:Qc.a.Auh:13===k.TypeTag?k.IsCollapsed?Qc.a.vuh:Qc.a.wuh:""};Yb.prototype.NTf=function(k,G){var d=this.fieldListItems?String.format(Ae,Ma,this.W4b(this.fieldListItems).returnValue):
"";d?(this.zo.innerHTML=d,0<k&&(this.zo.scrollTop=k),G&&(this.zk=G,this.KZa(this.zo))):this.zo.innerHTML=""};Yb.prototype.W4b=function(k){var G=!1;var d="";if(k)for(var S=this.zo.scrollWidth-42,P=Tc.a.Se(9),ja=0,D=k.length;ja<D;ja++){var da=k[ja],Ha="";if(Yb.yNa(da)){Ha=this.W4b(da.Children);var jb=Ha.B5a;Ha=Ha.returnValue;da.ShowCheckBox||(da.IsChecked=jb)}da.IsChecked&&(G=!0);jb="";var kc=da.Name?ge.a.Sf(da.Name):"",Jb=16*Math.max(0,da.InternalMargin),md="",ce="",qe="",Ye=1,ma=0;if(da.IsCollapsible){var ab=
Yb.bgd(da,Jb,Ye);ma+=ab+16;md=String.format(Qf,mb(da,"flb_"),ba.Oph+(da.IsCollapsed?" "+Qc.a.WPe:" "+Qc.a.XPe),Zb.a.instance.fa(1143)+" "+kc,P,Cc(ab,this.host.isRtl),da.IsCollapsed?de.a.Xo:de.a.yj);++Ye}var bc=this.IZh(da);bc&&(ab=1===Ye?Jb:0,ma+=ab+16,ce=String.format(Lg,mb(da,"flimg_"),kc,bc,P,Cc(ab,this.host.isRtl)),++Ye);if(da.ShowCheckBox){var Rc=mb(da,"flldiv_flcb_");ab=Yb.bgd(da,Jb,Ye);ma+=ab+16;qe=String.format(De,mb(da,"flcb_"),Rc,da.IsChecked?'checked="checked"':"",Cc(ab,this.host.isRtl));
++Ye}ab=Yb.bgd(da,Jb,Ye);ma+=ab+10;var Nc=mb(da,"flldiv_fll_"),id=mb(da,"fll_flt_");Jb=mb(da,"flldiv_flfimg_");Jb=(Rc=9===da.FilterImage)?String.format(le,mb(da,"flfimg_"),Jb,Zb.a.instance.fa(1142),Qc.a.vJa,P):String.format(lh,mb(da,"flfimg_"),Jb,Qc.a.xuh,P);var xe=mb(da,"flldiv_flm_");xe=String.format($d,mb(da,"flm_"),xe,kc,Qc.a.TPe+" "+ba.zOe,P,da.ShowCheckBox?de.a.$Lg:de.a.RZa,da.ShowCheckBox?de.a.Ose+'="'+(da.IsChecked?de.a.yj:de.a.Xo)+'"':"");if(3===Ye){Ye=mb(da,"flitd_eci_");var cf=mb(da,"flitd_"+
(bc?"simg_":"cb_"));jb+=String.format(this.$xa,Ye,this.zla,md)+String.format(this.$xa,cf,this.zla,bc?ce:qe)}else 2===Ye&&(ce=mb(da,"flitd_"+(da.IsCollapsible?"eci_":"cb_")),jb+=String.format(this.$xa,ce,this.zla,da.IsCollapsible?md:qe));qe=mb(da,"flitd_l_");md=mb(da,"flitd_fi_");ce=mb(da,"flimtd_");this.host.F_?(ab=String.format(this.p7b,Nc,id,da.IsChecked?ba.COe:"",kc,Cc(ab,this.host.isRtl)),jb+=String.format('<div id="{0}" style="width:calc(100% - {2})">{1}</div>',qe,ab,ne.HelperMethods.nc(26+ma)),
ma=Rc?this.zla+" "+yg:this.zla,ab=Rc?this.aCb:this.aCb+" "+yg,jb+=String.format(this.$xa,md,ma,Jb)+String.format(this.mkc,ce,this.BSa(da)?ab:ma,xe,kc)):(ab=String.format(this.p7b,Nc,id,da.IsChecked?ba.COe:"",kc,Cc(ab,this.host.isRtl),ne.HelperMethods.nc(Math.max(0,S-ma))),jb+=String.format(this.$xa,qe,"",ab)+String.format(this.$xa,md,this.zla,Jb)+String.format(this.mkc,ce,this.BSa(da)?this.aCb:this.zla,xe,kc));jb=String.format(this.bCb,mb(da,"fli_"),jb,this.host.isRtl?"rtl":"ltr");d+=jb+Ha;if(da.ShowSeparator)d+=
Ph;else if(11===da.TypeTag||19===da.TypeTag||29===da.TypeTag||13===da.TypeTag)d+=Kf}return{returnValue:d,B5a:G}};Yb.prototype.KZa=function(k){this.UPf();this.SG=Array.indexOf(this.Saa,k);this.ZJa=!1;this.qr=k;this.host.hasFocus(this);return this.aA()};Yb.prototype.NYf=function(){this.Mo=1;this.host.PVd();this.bxc();return this.KZa(this.TIa)};Yb.prototype.TYf=function(){this.Mo=0;this.host.PVd();this.bxc();return this.KZa(this.mua)};Yb.prototype.lQd=function(k){if(k){k=k.getElementsByTagName("option");
for(var G=0,d=k.length;G<d;++G){var S=k[G];if(S.selected){k=parseInt(S.id.substring(6,S.id.length),10);k!==this.sO&&(this.zo.scrollTop=0,this.sO=k,this.host.bCj());break}}}};Yb.prototype.VTf=function(k){if(k)for(var G=k.getElementsByTagName("option"),d=0,S=G.length;d<S;++d){var P=G[d];P.selected=parseInt(P.id.substring(6,P.id.length),10)===this.sO;P.selected&&(k.selectedIndex=d,k.title=P.text)}};Yb.prototype.DAj=function(k){if(this.kgb){if(!this.kgb.id.localeCompare(mb(k,"flm_")))return;this.rec()}(k=
this.getElementById(mb(k,"flm_")))&&!dd.DOMElementExtensions.isVisible(k)&&(dd.DOMElementExtensions.setVisible(k,!0),this.kgb=k)};Yb.prototype.rec=function(){this.qr===this.zo&&void 0!==this.qr.ownerDocument.activeElement&&null!==this.qr.ownerDocument.activeElement&&void 0!==this.qr.ownerDocument.activeElement.id&&null!==this.qr.ownerDocument.activeElement.id&&this.qr.ownerDocument.activeElement.id.startsWith("flm_")&&this.kgb===this.qr.ownerDocument.activeElement||(dd.DOMElementExtensions.setVisible(this.kgb,
!1),this.kgb=null)};Yb.prototype.k4=function(){if(this.cl){var k=this.host.parentElement;k.removeChild(this.cl.domElement);this.cl.pIb(this.wEb);this.cl.qIb(this.xEb);this.cl.TQf(this.vEb);Ac.a.yc([this.cl]);this.cl=null;k.style.cursor="default"}};Yb.prototype.bxc=function(){var k=dd.DOMElementExtensions.getElementById(this.TIa,Hb),G=dd.DOMElementExtensions.getElementById(this.mua,ic);dd.DOMElementExtensions.toggleCssClass(k,td,1===this.Mo);dd.DOMElementExtensions.toggleCssClass(G,td,0===this.Mo)};
Yb.prototype.yuj=function(){dd.DOMElementExtensions.isVisible(this.fNb)!==this.eNb&&dd.DOMElementExtensions.setVisible(this.fNb,this.eNb);dd.DOMElementExtensions.isVisible(this.l4)!==this.ysc&&dd.DOMElementExtensions.setVisible(this.l4,this.ysc);this.UIa.innerHTML=this.ysc?Zb.a.instance.fa(1141):Zb.a.instance.fa(1140);if(this.host.F_)this.eNb&&this.bxc();else{var k=this.V4f.offsetHeight+10;this.eNb&&(k+=this.fNb.offsetHeight,this.bxc());k=ne.HelperMethods.nc(k);df.a.equals(this.zo.style.top,k,!0)||
(this.zo.style.top=k)}};Yb.prototype.Stj=function(k,G){var d=this.l4.firstChild;d.innerHTML=d.title="";for(var S=0;k&&S<k.length;S++)if(G===k[S].GroupId){d.title=k[S].GroupName;break}for(S=0;k&&S<k.length;S++){var P=document.createElement("option");P.text=k[S].GroupName;P.id="flsrt_"+k[S].GroupId;P.selected=k[S].GroupId===G;qc.a.xf?d.add(P):d.appendChild(P)}};Yb.prototype.CUe=function(k,G){var d=null;k=Cl(k);for(var S=k.next();!S.done;S=k.next()){d=S.value;if(d.ClientId===G)break;if(d=this.CUe(d.Children,
G))break}return d};Yb.prototype.ZIb=function(){this.jTd||(this.jTd=this.UIa.currentStyle.maxWidth?this.UIa.currentStyle.maxWidth:"190px");dd.DOMElementExtensions.isVisible(this.l4)?(this.UIa.style.maxWidth=this.jTd,this.l4.style.width=ne.HelperMethods.nc(Math.max(0,this.zo.offsetWidth-(this.UIa.offsetWidth+10)))):this.UIa.style.maxWidth=ne.HelperMethods.nc(this.zo.offsetWidth)};Yb.EMg=function(k,G,d,S){S=k.Lb+S;var P=dd.DOMElementExtensions.getElementById(d,S+de.a.Qad);return P?new Yb(P,k,G,S):Yb.V6g(k,
G,d,S)};Yb.V6g=function(k,G,d,S){var P=S+de.a.CTe;if(G.F_){var ja=Cg;var D=xg;var da=jd;var Ha=me}else ja=bf,D=Gg,da=wc,Ha=xd;P=String.format(ja,S+de.a.Qad)+String.format(D,S+de.a.ATe,Zb.a.instance.fa(1138),S+de.a.BTe,Zb.a.instance.fa(1139),S+de.a.GTe,Hb,ic,P,G.isRtl?"rtl":"ltr")+String.format(da,S+de.a.ETe,S+de.a.DTe,Zb.a.instance.fa(1141),S+de.a.FTe,Lc,P,G.isRtl?"rtl":"ltr")+String.format(Ha,P)+"</div>";d.innerHTML=P+d.innerHTML;return(d=dd.DOMElementExtensions.getElementById(d,S+de.a.Qad))?new Yb(d,
k,G,S):null};Yb.yNa=function(k){return k.IsCollapsible&&!k.IsCollapsed&&!!k.Children&&0<k.Children.length};Yb.bgd=function(k,G,d){return 1!==d?0:k.InternalMargin?k.IsCollapsible?G+2:k.ShowCheckBox?G+18:G+-2:G};Yb.jjf=function(k){return k&&k.id?k.id.startsWith("flitd_")||k.id.startsWith("flimtd_")||k.id.startsWith("fll_")||k.id.startsWith("flb_")||k.id.startsWith("flcb_")||k.id.startsWith("flldiv_")||k.id.startsWith("flm_")||k.id.startsWith("flimg_")||k.id.startsWith("fli_")||k.id.startsWith("flfimg_"):
!1};Yb.Sbc=function(k){return k.id.startsWith("fll_")?k:k.id.startsWith("flitd_")?(k=k.getElementsByTagName("label")[0])&&k.id.startsWith("fll_")?k:null:null};Ck.Object.defineProperties(Yb.prototype,{sO:{configurable:!0,enumerable:!0,get:function(){return vb.a.fo(this.U1a,this.Lia+"_fieldWellRelatedGroupId",-1)},set:function(k){this.U1a[this.Lia+"_fieldWellRelatedGroupId"]=k}},Mo:{configurable:!0,enumerable:!0,get:function(){return vb.a.fo(this.U1a,this.Lia+"_fieldWellSelectedTabId",1)},set:function(k){this.U1a[this.Lia+
"_fieldWellSelectedTabId"]=k}},Lia:{configurable:!0,enumerable:!0,get:function(){return(this.host.pivotName||"")+(this.host.chartId||"")}}});Object(bb.a)(Yb,"FieldList",fc.a,[]);var Mb=b(7),Bc=b(203),wd=b(1365),Nd=b(82),Pe=b(952);Object(bb.a)(Ob,"FieldListTaskPaneProps",null,[]);Ub.prototype.lG=function(k){var G=this;Bc.UISurfaces.Ok().then(function(d){d.showTaskPane("FieldListTaskPane",G.Aw(k,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})};Ub.prototype.qx=function(k,G,d,S,P,ja,D,da,Ha,jb,kc){var Jb=
this;Bc.UISurfaces.Ok().then(function(md){md.updateTaskPane("FieldListTaskPane",Jb.Aw(k,G,d,S,P,ja,D,da,Ha,jb,kc));return null})};Ub.prototype.IAa=function(){Bc.UISurfaces.Ok().then(function(k){k.setSelectedTaskPane("FieldListTaskPane");return null})};Ub.prototype.kN=function(){Bc.UISurfaces.Ok().then(function(k){k.hideTaskPane("FieldListTaskPane",2);return null})};Ub.prototype.Aw=function(k,G,d,S,P,ja,D,da,Ha,jb,kc){var Jb=this;G=Object(Mb.a)(new Ob,{type:"FieldListTaskPaneProps",fieldListItems:d,
fieldWellsItems:S,dataUpdateType:G,isDataModel:P,selectedTab:ja,isSortAscending:D,focusResetType:da,focusResetId:Ha,isRichPivotFieldList:jb,fieldListSearchInfo:kc,isOlap:this.fieldManagerPane.T5,isPivotChart:this.fieldManagerPane.pW,fieldListSizePercentage:this.fieldManagerPane.U5i,onFieldExpandCollapse:Object(Nd.a)(this.fieldManagerPane,this.fieldManagerPane.Q5i,"reactExpandCollapseItem"),onExpandCollapseAll:Object(Nd.a)(this.fieldManagerPane,this.fieldManagerPane.P5i,"reactExpandCollapseAllItems"),
onFieldCheckedChanged:Object(Nd.a)(this.fieldManagerPane,this.fieldManagerPane.Z5i,"reactItemCheckedChanged"),onFieldListItemMenuClickV2:Object(Nd.a)(this.fieldManagerPane,this.fieldManagerPane.S5i,"reactFieldListItemMenuClicked"),onSortOrderChanged:Object(Nd.a)(this.fieldManagerPane,this.fieldManagerPane.K5i,"reactChangePivotFieldListSortOrder"),onSaveFieldListSizePercentage:Object(Nd.a)(this.fieldManagerPane,this.fieldManagerPane.r6i,"reactSaveFieldListSizePercentage"),onSearchInputChanged:Object(Nd.a)(this.fieldManagerPane,
this.fieldManagerPane.T5i,"reactFieldListSearchChange"),onSelectedTabChanged:function(md){Jb.fieldManagerPane.L5i(md)},onFieldMove:function(md,ce,qe,Ye){Jb.fieldManagerPane.b6i(md,ce,qe,Ye)},onFieldWellItemMenuClickV2:function(md,ce,qe,Ye){Jb.fieldManagerPane.V5i(md,ce,qe,Ye)}});if(Se.a.Ld(this.$))return Object(Mb.a)(new wd.a,{contentProps:G,onOpen:function(){Jb.fieldManagerPane.$Bf()},onClose:function(){Jb.fieldManagerPane.bRi()},onManualClose:function(){Jb.fieldManagerPane.cRi()},title:this.fieldManagerPane.pW?
Zb.a.instance.fa(1146):Zb.a.instance.fa(1145),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});k=Object(Mb.a)(new Pe.a,{type:"ExcelLegacyTaskPaneProps",container:k,paneProps:G});return Object(Mb.a)(new wd.a,{contentProps:k,onOpen:function(){Jb.fieldManagerPane.$Bf()}})};Object(bb.a)(Ub,"FieldListReactTaskPane",null,[849]);Object(bb.a)(yd,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);ec.prototype.getActiveCell=function(){return this.activeCell};Object(bb.a)(ec,"MacroRecorderPivotTablePivotedPayload",
null,[447]);var He=b(30),ue=b(1),Ia=b(104),cb=b(66),Xb=b(912);Object(bb.a)(Ya,"FieldListItem",null,[]);Object(bb.a)(rb,"FieldListSearchInfo",null,[]);Object(bb.a)(pb,"FieldWellItem",null,[]);Object(bb.a)(nc,"FieldWellsItems",null,[]);var yc=b(563),Xc=b(67),Od=fc.a;Am(Pa,Od);Pa.prototype.ZP=function(k){this.get_events().addHandler(Pa.JTe,k)};Pa.prototype.BS=function(k){this.get_events().removeHandler(Pa.JTe,k)};Pa.prototype.tE=function(k){this.addHandler(Pa.lub,k)};Pa.prototype.dG=function(k){this.removeHandler(Pa.lub,
k)};Pa.prototype.moe=function(k){this.addHandler(Pa.X9b,k)};Pa.prototype.WQf=function(k){this.removeHandler(Pa.X9b,k)};Pa.prototype.loe=function(k){this.addHandler(Pa.d3a,k)};Pa.prototype.VQf=function(k){this.removeHandler(Pa.d3a,k)};Pa.prototype.RAj=function(){this.YA&&(!this.xv&&this.kta?dd.DOMElementExtensions.setVisible(this.kta,!1):this.s7&&dd.DOMElementExtensions.setVisible(this.s7,!1))};Pa.prototype.UH=function(){this.RAj();this.domElement.classList.remove(this.$.isChromeRtl?Pa.KAh:Pa.JAh);
this.domElement.style.width=ne.HelperMethods.nc(this.Zad);this.domElement.classList.add(Pa.dEh);this.ZIb()};Pa.prototype.jg=function(){};Pa.prototype.vp=function(){return this.CZa&&(!Rb.f(this.kg)||this.$.gl)};Pa.prototype.ns=function(){var k=ub.create(this.$,this.fieldList,this.tHb);return k.$Ma&&(!k.Jli||!ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadOnlyPivotTable",!1))&&(this.$.gl||!Rb.f(this.kg))};Pa.prototype.oS=function(){};Pa.prototype.Dne=function(k,G){(k=hc(this.zi.FieldListItems,
k,this.currentState.T5?5:17,!0))&&k.CanDrag&&this.qH(k,G,0,null,null)};Pa.prototype.qH=function(k,G,d,S,P){var ja=this;if(S&&!df.a.equals(S,this.AIa,!1))alert(Zb.a.instance.Wa(18));else{var D=this.Gac(k.PivotCacheIndex,k.PivotTableIndex);S=D.axis;var da=D.pos;var Ha=D.JHf;if(-1!==k.PivotTableIndex)var jb=S;else da=jb=0,Ha=k.PivotCacheIndex;if(0===jb){if(7===k.TypeTag&&(k=0<=k.ClientParentId?Fb(this.zi.FieldListItems,k.ClientParentId,!0):null,!k))return;da=0;Ha=k.PivotCacheIndex}if(jb!==G||0===G||
da!==d&&da!==d-1){var kc=new yd(S,k.PivotCacheIndex,k.Name);qf.a(this.$).Vx(this.currentState.confirmationRequiredForDataOps,function(Jb){Jb&&ja.applyPivot(ja.currentState,jb,da,k.TypeTag,Ha,G,d,P,Sc.g(ja.$),kc,k)})}}};Pa.prototype.b6i=function(k,G,d,S){if(this.zi&&this.Xj){var P=null;switch(G){case 0:P=Fb(this.zi.FieldListItems,k,!0);break;case 1:P=Fb(this.Xj.RowAxis,k,!1);break;case 2:P=Fb(this.Xj.ColumnAxis,k,!1);break;case 4:P=Fb(this.Xj.FilterAxis,k,!1);break;case 8:P=Fb(this.Xj.DataAxis,k,!1)}P&&
(dc.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),this.qH(P,d,S,null,null))}};Pa.prototype.Z5i=function(k,G){this.zi&&this.aca&&(k=Fb(this.zi.FieldListItems,k,!0))&&(dc.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.ojf(k,G))};Pa.prototype.Q5i=function(k){this.zi&&(k=Fb(this.zi.FieldListItems,k,!0))&&k.IsCollapsible&&(5===k.TypeTag&&k.IsCollapsed&&!k.Children.length?(Array.clear(this.jX),this.jX.push(k),this.y9b()):(k.IsCollapsed=!k.IsCollapsed,
this.yf&&this.kac(0,-1,!1,!1,!1,!1)))};Pa.prototype.P5i=function(k){this.zi&&(dc.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.jX.length&&Array.clear(this.jX),this.AMf(this.zi.FieldListItems,k)?this.y9b():this.yf&&this.kac(0,-1,!1,!1,!1,!1))};Pa.prototype.AMf=function(k,G){var d=!1;for(var S=0;S<k.length;S++){var P=k[S];G&&P.IsCollapsible&&5===P.TypeTag&&P.IsCollapsed&&!P.Children.length?(this.jX.push(P),d=!0):G&&P.IsCollapsible&&P.IsCollapsed?P.IsCollapsed=
!1:G||!P.IsCollapsible||P.IsCollapsed||(P.IsCollapsed=!0);P.IsCollapsible&&P.Children&&0<P.Children.length&&this.AMf(P.Children,G)&&(d=!0)}return d};Pa.prototype.kac=function(k,G,d,S,P,ja){if(this.zi){var D=!1,da=!1,Ha=!1,jb=null;Ha=null;var kc=k;if(this.ard){S&&0<this.jX.length&&Array.clear(this.jX);jb=this.udd(this.zi.FieldListItems,S,!1);da=jb.vxb;Ha=jb.FIa;D=jb.isRichPivotFieldList;jb=jb.returnValue;if(Ha){this.t1b||this.y9b();return}Ha=new rb;Ha.needSearchReset=ja;Ha.needSearchRestore=!ja&&P;
Ha.searchRestoreValue=Ha.needSearchRestore?this.q7:"";Ha.searchWithNoMatch=""!==this.q7&&!da;Ha.searchWithNoMatch&&S&&ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,211,212,0),function(Jb){Jb.result.readText(Zb.a.instance.fa(771))},this.$.la,3);""!==this.q7&&2===k&&(Ha.searchWithNoMatch?kc=1:d&&jb&&0<jb.length&&(G=jb[0].id))}else k=this.lXe(this.zi.FieldListItems),D=k.isRichPivotFieldList,jb=k.returnValue;this.pja.qx(this.YA,0,jb,null,this.zi.IsPpm,this.zi.SelectedTab,this.zi.IsSortAscending,
kc,G,D,Ha)}};Pa.prototype.L5i=function(k){dc.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.tHb=k;this.PVd()};Pa.prototype.V5i=function(k,G,d,S){if(this.Xj){var P=document.getElementById(d);if(P){var ja=null,D=-1;switch(G){case 4:ja=Fb(this.Xj.FilterAxis,k,!1);D=this.Xj.FilterAxis.length;break;case 2:ja=Fb(this.Xj.ColumnAxis,k,!1);D=this.Xj.ColumnAxis.length;break;case 1:ja=Fb(this.Xj.RowAxis,k,!1);D=this.Xj.RowAxis.length;break;case 8:ja=Fb(this.Xj.DataAxis,k,!1),
D=this.Xj.DataAxis.length}if(ja){G={};this.currentState.pW?(G.AnchorType=8,G.ChartId=this.currentState.chartId):G.AnchorType=9;G.AnchorValue1=ja.PivotTableIndex;G.AnchorValue2=ja.PivotCacheIndex;k=this.Gac(ja.PivotCacheIndex,ja.PivotTableIndex);var da=k.axis;var Ha=k.pos;k=new Zd.a(-1453503574,0,this.$.fd,30,null);P={domElement:P};P.fieldItem=ja;P.zoneCount=D;P.sourceAxis=da;P.sourceAxisPos=Ha;P.optionalPivotMenuAnchorParameter=G;P.isOlap=this.currentState.T5;P.isPpm=this.zi.IsPpm;P.versionkey=this.AIa;
P.isKeyboardInput=S;P.cell=this.currentState.Au;P.externalSourceIndex=this.externalSourceIndex;S=!1;ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.T5&&!this.zi.IsPpm&&this.zi.SupportsImplicitMeasures&&(ja=hc(this.zi.FieldListItems,ja.PivotCacheIndex,5,!0),S=!!ja&&!ja.IsCollapsible);P.fieldItemsupportsImplicitMeasures=S;this.sQa=d;var jb;this.pHb=!bg.a(jb=this.$.Ka.$b(k,P))&&(6!==jb.status||jb.result)}}}};Pa.prototype.S5i=function(k,G,d){if(this.zi){var S=
document.getElementById(G);if(S&&(k=Fb(this.zi.FieldListItems,k,!0))){S={domElement:S,fieldItem:k};S.versionkey=this.AIa;S.isChart=!!this.chartId;S.isPpm=this.zi.IsPpm;S.isOlap=this.currentState.T5;S.supportsImplicitMeasures=this.zi.SupportsImplicitMeasures;S.isKeyboardInput=d;this.sQa=G;G=new Zd.a(330754562,0,this.$.fd,30,null);var P;this.pHb=!bg.a(P=this.$.Ka.$b(G,S))&&(6!==P.status||P.result)}}};Pa.prototype.R5i=function(k){var G=this;k&&ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,
103,104,0),function(d){var S=d.result,P=Sc.g(G.$),ja=ef.v(Wb.Range.hd(1,1),G.$).SheetName;d=S.igb(P);if(d){S=d.tf;var D=S.uf.top;var da=S.uf.left;var Ha=d.cJ.x;var jb=d.cJ.y}else D=da=1,d=S.gLa(P),Ha=d.x,jb=d.y;G.$.userOperationManager.ic(new Id.a(203,0,function(kc,Jb,md){return Xe.N(G.$.na.va,ja,G.pivotName,k.PivotCacheIndex,0,D,da,Ha,jb,kc,Jb,md,null)},void 0,function(){return new Kc.a(ja,G.pivotName,k.PivotCacheIndex,0)}),null)},this.$.la,8)};Pa.prototype.K5i=function(k){var G=this;dc.ULS.sendTraceTag(554317775,
0,50,"React Field List: change field list sort order.");var d=Pa.Rrb(this.currentState);this.$.userOperationManager.ic(new Id.a(251,0,function(S,P,ja){var D=G.$.na.va,da=Xe.nb(D,G.currentState.Au,G.currentState.externalSourceIndex,d);da.isAscending=k;return Xe.i(D,"ChangePivotFieldListSortOrder",da,S,P,ja,null,0)}),null)};Pa.prototype.r6i=function(k){this.zfe=k};Pa.prototype.T5i=function(k){k!==this.q7&&(dc.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.q7=k,this.kac(0,
-1,!1,!0,!1,!1))};Pa.prototype.dispose=function(){var k;if(this.$){this.$.Ul(this.zd);this.xv&&(this.$.Ka.kKd(this.ZBf),this.$.Ka.Qbb(this.YBf),Array.clear(this.jX));var G=Sc.g(this.$);G&&(G.mL(this.Uq),G.aG(this.kma),G.ha&&(G.ha.tO(this.kma),G.ha.Oa.dcj(this.Fnc)),G.Ea&&G.Ea.Wq(this.Xyf));ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6187406_UpdateFieldListOnSelectedChartReload")&&(null===(k=Ia.a(this.$))||void 0===k?void 0:k.xtc(this.Fnc));k=zc.a(this.$);(null===k||void 0===k?0:k.Ea)&&k.Ea.Wq(this.hEb);
this.$.xa&&this.$.xa.Vg(this.ii);if(k=this.$.ea)k.Gv(this.If),k.Fk(this.qd),k.AS(this.Io);cb.a(this.$)&&cb.a(this.$).btc(this.uFf);this.fieldList&&(this.fieldList.bcj(this.Wxf),this.fieldList.acj(this.Vxf))}this.taskPaneManager&&this.taskPaneManager.dG(this.rEf);this.s7&&(fd.a.instance.za(rc.a.click,this.s7,this.ak),Af.KeyInputManager.instance.Uv(this.s7,this.zAe));Ac.a.yc([this.ol,this.K1c,this.gtb,this.fieldList,this.Eba,this.HW]);this.ocg();this.Eba=this.$Ic=null;this.hideTaskPane();this.pja=null;
this.k4();this.HW=this.rza=this.Uqb=this.tJb=this.jbd=this.K_d=this.fF=this.fI=this.kta=this.YA=this.T7b=this.ftb=this.R7b=this.S7b=this.bJa=this.WU=this.taskPaneManager=this.$=null;Od.prototype.dispose.call(this)};Pa.prototype.Xfh=function(){this.gL=Sa(null,this.gL,this.gL===this.cu)};Pa.prototype.Wf=function(k,G){if(this.xv){if(!G){k=dd.DOMElementExtensions.Lm(this.domElement.querySelectorAll(dd.DOMElementExtensions.sr));if(!k)return!1;dd.DOMElementExtensions.setFocus(k)}return!G}G?this.MQa(!1):
(this.gL=Sa(null,this.gL,this.gL===this.cu),this.rn||(this.rn=this.fieldList.domElement),this.rn===this.WU?dd.DOMElementExtensions.setFocus(this.WU):this.rn===this.fieldList.domElement?this.fieldList.setFocus(G,!1):this.jea(this.zk,this.Oub));return!G};Pa.prototype.sh=function(k){return dd.DOMElementExtensions.Gf(this.uc,k)};Pa.prototype.Ej=function(){};Pa.prototype.Rj=function(){this.MQa(!1);this.fieldList&&this.fieldList.zPf()};Pa.prototype.bCj=function(){this.refresh()};Pa.prototype.PVd=function(){this.refresh()};
Pa.prototype.ojf=function(k,G){k&&k.CanDrag&&this.qH(k,G?-1:0,-1,null,null)};Pa.prototype.Rih=function(k,G){this.VJe(k,G,!0)};Pa.prototype.Sih=function(k,G){var d=this.QZe(G);(k=this.OZe(k,d,!this.cl))&&this.fjf(d)?this.Ggh(this.RC[d],G):this.hdb(null,"");return k};Pa.prototype.hasFocus=function(k){this.fieldList&&k===this.fieldList&&this.rn!==this.fieldList.domElement&&(this.MQa(!1),this.rn=this.fieldList.domElement)};Pa.prototype.S6=function(){this.xW&&this.vp()&&this.ns()&&(this.isVisible=!0)};
Pa.prototype.$Bf=function(){this.IHd=!0;this.refresh()};Pa.prototype.bRi=function(){this.hideTaskPane()};Pa.prototype.cRi=function(){this.NKb(!0,null);this.hideTaskPane()};Pa.prototype.Iai=function(){this.l7a=this.yf=!0;this.xv&&this.xW?this.pja.lG(this.YA):this.xv?(this.cci(),this.pja.lG(this.YA)):(this.Tbi(),this.xW?this.taskPaneManager.qS(Pa.WI,this.SI):this.taskPaneManager.CD(this,!0))};Pa.prototype.showTaskPane=function(){this.isVisible=!0;this.xv&&this.ard&&""!==this.q7&&(this.GHd=!0);this.yf?
this.xv&&this.xW?this.pja.IAa():this.xW?this.taskPaneManager.qS(Pa.WI,this.SI):this.taskPaneManager.CD(this,!0):(this.yf=!0,this.xv&&this.pja.lG(this.YA),this.xW?this.xW&&!this.xv&&this.taskPaneManager.qS(Pa.WI,this.SI):this.taskPaneManager.CD(this,!0))};Pa.prototype.hideTaskPane=function(){this.isVisible=this.IHd=this.yf=!1;this.xv?this.pja.kN():this.xW&&this.taskPaneManager.hideTaskPane(Pa.WI)};Pa.prototype.oyc=function(k,G,d){this.NKb(k,G);this.Upd=d;this.PKb=!k&&!!G||d;k?this.hideTaskPane():this.showTaskPane()};
Pa.prototype.y9b=function(){var k=this;qf.a(this.$).Vx(this.currentState.confirmationRequiredForDataOps,function(G){G&&k.expandPivotFieldListLevels(k.currentState)})};Pa.prototype.rR=function(){return!1};Pa.prototype.W6g=function(k){var G=Tc.a.Se(9),d=String.format(Pa.zhh,Pa.LTe)+String.format(this.F_?Pa.yhh:Pa.xhh,this.titleText,Pa.KTe)+String.format(Pa.mhh,k+de.a.Tad,k+de.a.Sad,G,Zb.a.instance.fa(1154)),S=Cc(this.isRtl?Pa.etb:0,this.isRtl),P=Cc(this.isRtl?0:Pa.etb,this.isRtl);if(this.F_){var ja=
String.format(Pa.ohh,k+de.a.Yad,Zb.a.instance.fa(1147),String.format(Pa.o7b,Qc.a.vJa,Zb.a.instance.fa(1148),k+de.a.Vad,G,Pa.S0d,P),String.format(Pa.o7b,Qc.a.Nua,Zb.a.instance.fa(1149),k+de.a.Uad,G,Pa.Q0d,P),String.format(Pa.o7b,Qc.a.Oua,Zb.a.instance.fa(1150),k+de.a.Wad,G,Pa.T0d,P),String.format(Pa.o7b,Qc.a.Q2a,Zb.a.instance.fa(1153),k+de.a.Xad,G,Pa.V0d,P));d+=String.format(Pa.rhh,k+de.a.Z9b,ja)}else ja=String.format(Pa.PJe,ba.Vph,String.format(Pa.n7b,Qc.a.vJa,Zb.a.instance.fa(1148),k+de.a.Vad,G,
Pa.S0d,"",S),String.format(Pa.n7b,Qc.a.Nua,Zb.a.instance.fa(1149),k+de.a.Uad,G,Pa.Q0d,ba.rOe,P)),G=String.format(Pa.PJe,"",String.format(Pa.n7b,Qc.a.Oua,Zb.a.instance.fa(1150),k+de.a.Wad,G,Pa.T0d,"",S),String.format(Pa.n7b,Qc.a.Q2a,Zb.a.instance.fa(1153),k+de.a.Xad,G,Pa.V0d,ba.rOe,P)),ja=String.format(Pa.nhh,k+de.a.Yad,Zb.a.instance.fa(1147),ja,G),d+=String.format(Pa.qhh,k+de.a.Z9b,ja);return d};Pa.prototype.Dre=function(){var k=document.getElementsByTagName("head")[0];if(k){var G=document.createElement("link");
G.setAttribute("rel","stylesheet");G.setAttribute("type","text/css");G.setAttribute("href",dd.DOMElementExtensions.d_(this.domElement,"data-cssfile",null));k.appendChild(G)}};Pa.prototype.Tbi=function(){var k=this.$.Lb;this.YA=this.getElementById(k+de.a.Z9b);this.YA||(this.Dre(),this.domElement.innerHTML=this.W6g(k),this.tPb=this.getElementById(Pa.LTe),this.YA=this.getElementById(k+de.a.Z9b));this.kta=this.getElementById(k+de.a.Tad);this.$.gl&&dd.DOMElementExtensions.setVisible(this.kta,!1);this.$Ic=
Yb.EMg(this.$,this,this.YA,Pa.HAh);this.T7b=this.getElementById(k+de.a.Yad);this.ftb=this.getElementById(k+de.a.Vad);this.R7b=this.getElementById(k+de.a.Uad);this.S7b=this.getElementById(k+de.a.Wad);this.bJa=this.getElementById(k+de.a.Xad);this.rza=this.getElementById(Pa.KTe);this.Uqb=this.getElementById(Pa.Q0d);this.tJb=this.getElementById(Pa.T0d);this.K_d=this.getElementById(Pa.V0d);this.jbd=this.getElementById(Pa.S0d);this.RC=[this.ftb,this.R7b,this.S7b,this.bJa];this.HTe=[this.jbd,this.Uqb,this.tJb,
this.K_d];this.Y9b=[Pa.fqi,Pa.eqi,Pa.gqi,Pa.hqi];this.Rad=[this.ftb.scrollTop,this.R7b.scrollTop,this.S7b.scrollTop,this.bJa.scrollTop];this.WU=this.getElementById(k+de.a.Sad);Ac.a.Ha(this.Eba);this.Eba=new Bd.a(this.$);this.Eba.cpb(de.a.Sad,de.a.Tad,ba.oOe,ba.Mph,ba.Nph);this.Fc.ka("keydown",this.P6);this.Fc.ka("keypress",this.JOi);this.Fc.ka("keyup",this.xma);this.Fc.ka("contextmenu",this.il);this.K1c=this.de.Wd(this.kta);this.K1c.ka("click",this.TIi);this.gtb=this.de.Wd(this.T7b);this.gtb.ka("click",
this.SBd);this.gtb.ka("mousedown",this.TBd);this.gtb.ka("mouseup",this.UBd);this.ol.ka("resize",this.onResize);this.fieldList.yFg(this.Wxf);this.fieldList.xFg(this.Vxf)};Pa.prototype.cci=function(){var k=document.getElementById(this.$.Lb+de.a.ITe);if(k){this.Dre();k.classList.add(Pa.i6i);var G=this.W9g();k.appendChild(G);G=Xb.b("div",Pa.f6i,Pa.e6i);k.appendChild(G);this.YA=G}};Pa.prototype.W9g=function(){var k=Xb.b("div",Pa.k6i,Pa.j6i);this.qHb=Xb.b("span",Pa.m6i,Pa.l6i);this.qHb.innerText=this.titleText;
this.s7=Ge.a.Bb(Pa.g6i,Pa.h6i,Zb.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.s7.classList.add(jf.AFrameworkApplication.isRtl?de.a.Yaa:de.a.Zaa);fd.a.instance.pa(rc.a.click,this.s7,this.ak);this.zAe=Af.KeyInputManager.instance.zs(this.s7,this.ak,Ef.a.ei);this.$.gl&&dd.DOMElementExtensions.setVisible(this.s7,!1);k.appendChild(this.qHb);k.appendChild(this.s7);return k};Pa.prototype.Fdg=function(k){if(this.zi=k)this.currentState.bK=this.zi.FieldListVersion,this.hca=$a(this.zi.FieldListItems,
-1,this.hca);if(this.fieldList)this.fieldList.DMg(this.zi),this.zi&&(this.currentState.Mo=this.fieldList.Mo,this.currentState.sO=this.fieldList.sO,this.PKb&&(this.Wf(!0,!1),this.PKb=!1));else if(this.xv&&this.zi)if(this.yf){this.tHb=this.currentState.Mo=this.zi.SelectedTab;this.Uti();k=-1;var G=0,d=!1;this.PKb?(this.zi.FieldListItems&&0<this.zi.FieldListItems.length&&(k=this.zi.FieldListItems[0].ClientId,G=2,d=!0),this.PKb=!1):this.dva&&0===this.r7&&(this.rQa||this.oHb?this.zi.FieldListItems&&0<this.zi.FieldListItems.length&&
(k=this.oHb?this.zi.FieldListItems[0].ClientId:this.rQa.ClientId,G=2,d=this.oHb):this.EMf&&(k=this.zi.FieldListItems[0].ClientId,G=1),this.L2b());var S=!1,P=!1;this.ard&&(this.CMf!==this.zi.PivotXluid&&(this.CMf=this.zi.PivotXluid,S=!0,this.q7=""),P=!S&&this.GHd&&""!==this.q7);this.kac(G,k,d,!1,P,S);this.GHd=!1}else this.L2b()};Pa.prototype.L2b=function(){this.r7=0;this.rQa=null;this.nHb="";this.dva=this.oHb=this.EMf=!1};Pa.prototype.u3f=function(k){return 7===k.TypeTag?!1:k.ShowFilterArrow||k.ShowCheckBox};
Pa.prototype.yNa=function(k){return k.IsCollapsible&&(!k.IsCollapsed||2===k.Image)&&!!k.Children&&0<k.Children.length};Pa.prototype.vxb=function(k,G){var d=G.length;return 2<d&&'"'===G.charAt(0)&&'"'===G.charAt(d-1)?df.a.contains(k,G.substring(1,d-1),!0):df.a.V0a(G,"*")||df.a.V0a(G,"?")?(G=G.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),G="^"+df.a.VQa(df.a.VQa(G,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=k.search(new RegExp(G,"i"))):df.a.contains(k,G,!0)};Pa.prototype.udd=function(k,G,d){var S,
P,ja;var D=ja=P=S=!1;for(var da=[],Ha=0;Ha<k.length;Ha++){var jb=k[Ha],kc=!1,Jb=!1,md=!1,ce=[];if(""===this.q7){if(this.yNa(jb)){ce=this.udd(jb.Children,G,!1);Jb=ce.vxb;var qe=ce.B5a;kc=ce.isRichPivotFieldList;ce=ce.returnValue;jb.ShowCheckBox||(jb.IsChecked=qe)}}else if(2!==jb.Image&&this.vxb(jb.Name,this.q7)&&(D=md=!0,G&&jb.IsCollapsible&&jb.IsCollapsed&&(5!==jb.TypeTag||jb.Children.length?jb.IsCollapsed=!1:(this.jX.push(jb),S=!0))),G&&d&&jb.IsCollapsible&&jb.IsCollapsed&&(5!==jb.TypeTag||jb.Children.length?
jb.IsCollapsed=!1:(this.jX.push(jb),S=!0)),jb.IsCollapsible&&jb.Children&&0<jb.Children.length){ce=this.udd(jb.Children,G,md||d);Jb=ce.vxb;qe=ce.FIa;var Ye=ce.B5a;kc=ce.isRichPivotFieldList;ce=ce.returnValue;jb.ShowCheckBox||(jb.IsChecked=Ye);Jb&&(D=!0,G&&(jb.IsCollapsed=!1));qe&&(S=!0)}this.thf&&(kc||66===jb.TypeTag)&&(ja=!0);jb.IsChecked&&(P=!0);if(""===this.q7||md||Jb||d)kc=new Ya,kc.id=jb.ClientId,kc.name=jb.Name,kc.type=jb.TypeTag,kc.isCollapsible=jb.IsCollapsible,kc.showCheckBox=jb.ShowCheckBox,
kc.isMoreFields=2===jb.Image,kc.canDrag=jb.CanDrag&&7!==jb.TypeTag,kc.showSeparator=jb.ShowSeparator,kc.showMenu=this.u3f(jb),kc.isCollapsed=jb.IsCollapsed,kc.isChecked=jb.IsChecked,kc.isBolded=jb.IsBolded,kc.children=ce,da.push(kc)}return{returnValue:da,vxb:D,FIa:S,B5a:P,isRichPivotFieldList:ja}};Pa.prototype.lXe=function(k){var G=this,d;var S=d=!1;for(var P=Array(k.length),ja={},D=0;D<k.length;ja={Yy:ja.Yy,aQb:ja.aQb,WPb:ja.WPb},D++){ja.Yy=k[D];var da=new Ya;da.id=ja.Yy.ClientId;da.name=ja.Yy.Name;
da.type=ja.Yy.TypeTag;da.isCollapsible=ja.Yy.IsCollapsible;da.isCollapsed=ja.Yy.IsCollapsed;da.showCheckBox=ja.Yy.ShowCheckBox;da.isMoreFields=2===ja.Yy.Image;da.canDrag=ja.Yy.CanDrag&&7!==ja.Yy.TypeTag;da.showSeparator=ja.Yy.ShowSeparator;da.showMenu=this.u3f(ja.Yy);ja.WPb=!1;this.yNa(ja.Yy)&&(ja.aQb=void 0,da.children=function(Ha){return function(){var jb=G.lXe(Ha.Yy.Children);Ha.aQb=jb.B5a;Ha.WPb=jb.isRichPivotFieldList;return jb}}(ja)().returnValue,ja.Yy.ShowCheckBox||(ja.Yy.IsChecked=ja.aQb));
this.thf&&(ja.WPb||66===ja.Yy.TypeTag)&&(S=!0);ja.Yy.IsChecked&&(d=!0);da.isChecked=ja.Yy.IsChecked;da.isBolded=ja.Yy.IsBolded;P[D]=da}return{returnValue:P,B5a:d,isRichPivotFieldList:S}};Pa.prototype.rac=function(k){for(var G=Array(k.length),d=0;d<k.length;d++){var S=k[d],P=new pb;P.id=S.ClientId;P.name=S.Name;G[d]=P}return G};Pa.prototype.Jkj=function(){this.lWf(this.zi.FieldListItems,"")};Pa.prototype.Uti=function(){this.Zlf(this.zi.FieldListItems,"")};Pa.prototype.oja=function(k,G){return k.Name+
"_"+k.UniqueName+"_"+k.TypeTag+"_"+(G||this.Lia)};Pa.prototype.lWf=function(k,G){if(k)for(var d=0,S=k.length;d<S;d++){var P=k[d],ja="";if(P.IsCollapsible||P.Children)ja=this.oja(P,G),P.IsCollapsible&&(this.b7c[ja]=!!P.IsCollapsed),P.Children&&this.lWf(P.Children,ja);this.rQa&&P.ClientId===this.rQa.ClientId&&(this.nHb=ja||this.oja(P,G))}};Pa.prototype.Zlf=function(k,G){if(k)for(var d=0,S=k.length;d<S;d++){var P=k[d],ja="";if(P.IsCollapsible||P.Children)ja=this.oja(P,G),P.IsCollapsible&&ja in this.b7c&&
(P.IsCollapsed=vb.a.xg(this.b7c,ja)),P.Children&&this.Zlf(P.Children,ja);this.nHb&&df.a.equals(this.nHb,ja||this.oja(P,G),!1)&&(this.rQa=P,this.nHb="")}};Pa.prototype.xdg=function(k){if(this.Xj=k)this.currentState.aR=this.Xj.FieldWellVersion,this.hca=$a(this.Xj.FilterAxis,-1,this.hca),this.hca=$a(this.Xj.ColumnAxis,-1,this.hca),this.hca=$a(this.Xj.RowAxis,-1,this.hca),this.hca=$a(this.Xj.DataAxis,-1,this.hca);this.ZQ?Array.clear(this.ZQ):this.ZQ=[];if(this.Xj&&(this.ZQ.push(this.Xj.FilterAxis),this.ZQ.push(this.Xj.ColumnAxis),
this.ZQ.push(this.Xj.RowAxis),this.ZQ.push(this.Xj.DataAxis),this.xv)){if(!this.yf){this.L2b();return}k=-1;var G=0;if(this.dva&&0!==this.r7){switch(this.r7){case 1:0<this.Xj.RowAxis.length&&(k=this.Xj.RowAxis[0].ClientId,G=3);break;case 2:0<this.Xj.ColumnAxis.length&&(k=this.Xj.ColumnAxis[0].ClientId,G=3);break;case 4:0<this.Xj.FilterAxis.length&&(k=this.Xj.FilterAxis[0].ClientId,G=3);break;case 8:0<this.Xj.DataAxis.length&&(k=this.Xj.DataAxis[0].ClientId,G=3)}this.L2b()}var d=new nc;d.filtersWellItems=
this.rac(this.Xj.FilterAxis);d.columnsWellItems=this.rac(this.Xj.ColumnAxis);d.rowsWellItems=this.rac(this.Xj.RowAxis);d.valuesWellItems=this.rac(this.Xj.DataAxis);this.pja.qx(this.YA,1,null,d,!1,-1,!1,G,k,!1,null)}if(!this.xv){this.Sgj();if(k=this.fieldList.Vgj(this.rn===this.fieldList.domElement))this.rn=this.fieldList.domElement,this.dva=!1;if(k||this.dva)this.cu=this.zk=null;this.dva&&((this.rn=this.C1h(this.N6c))?this.Rna(!0):this.Ccb(!0,!0),this.dva=!1,this.N6c=0)}};Pa.prototype.FOb=function(){var k=
this.isVisible&&!this.aca;this.tPb&&k!==this.mmf&&(dd.DOMElementExtensions.setVisible(this.tPb,k),k?(this.HW.pBa(),this.tPb.style.cursor="wait"):(this.HW.kTa(),this.tPb.style.cursor="default"),this.mmf=k)};Pa.prototype.QRj=function(){this.rza&&(this.rza.innerText=this.currentState.pW?Zb.a.instance.fa(1146):this.titleText);this.xv&&this.qHb&&(this.qHb.innerText=this.currentState.pW?Zb.a.instance.fa(1146):this.titleText);this.Uqb&&(this.Uqb.innerText=this.currentState.pW?Zb.a.instance.fa(1151):Zb.a.instance.fa(1149));
this.tJb&&(this.tJb.innerText=this.currentState.pW?Zb.a.instance.fa(1152):Zb.a.instance.fa(1150))};Pa.prototype.evc=function(k){if(!this.xv&&this.YA){if(k)for(var G=Pa.YL;G<=Pa.tT;G++)this.RC[G].scrollTop=this.Rad[G];else for(G=Pa.YL;G<=Pa.tT;G++)this.Rad[G]=this.RC[G].scrollTop;this.fieldList&&this.fieldList.evc(k)}};Pa.prototype.refresh=function(){if(!this.xv||this.IHd){var k=ub.create(this.$,this.fieldList,this.tHb);this.COf(k)}};Pa.prototype.COf=function(k,G){G=void 0===G?!1:G;if(this.isVisible&&
(this.xW&&this.xv||this.YA)){k=k||ub.create(this.$,this.fieldList,this.tHb);var d=this.currentState;this.xv&&this.zi&&this.Jkj();this.currentState=k;if(ub.fpi(d,k)||G){if(this.Npb=!1,this.YQ.vl=k.$Ma,Pa.qZ(this.YQ),ub.vif(d,k)||G)this.$Q.vl=k.$Ma,Pa.qZ(this.$Q),this.Fdg(null),this.xdg(null),this.QRj(),this.MQa(!0)}else d.bK<k.bK?(this.YQ.vl=!0,Pa.qZ(this.YQ)):this.currentState.bK=d.bK,d.aR<k.aR?(this.Npb=!1,this.$Q.vl=!0,Pa.qZ(this.$Q),this.rn===this.bJa&&this.MQa(!0)):this.currentState.aR=d.aR}this.FOb();
Jf.a.instance.create(this.Kha,0,$f.a.IAh,!0,!0)};Pa.prototype.NKb=function(k,G){this.applyPivotFieldManagerHiddenState(k,G);this.kg=ne.HelperMethods.MO(k,this.kg,4);this.refresh();this.raiseEvent(Pa.lub);this.xW&&this.$.Bf()};Pa.prototype.applyPivotFieldManagerHiddenState=function(k,G){var d=this;this.$.userOperationManager.ic(new Id.a(144,0,function(S,P,ja){var D=ef.o(Sc.g(d.$).ha.ta.activeCell,d.$),da=d.$.na.va,Ha=da.Na(9);Ha.hidden=k;Ha.activeCell=D;return Xe.i(da,"ApplyPivotFieldManagerHiddenStateV2",
Ha,S,P,ja,null,0)},16),G)};Pa.prototype.VIf=function(k,G,d){ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6224863_FixFieldListDataRequestLoop")&&(d.vl=!1);if(!d.request||G!==d.correlationId)return!1;d.request=null;return He.a.rh(k.Errors)?(this.$.ea.Hp(k.Errors),!1):!0};Pa.prototype.Vwf=function(k,G){var d=oe.a.pg(k.data);this.$.ea.Hp(d);G.request=null;10!==k.data.status&&(G.vl=!1);this.Kha()};Pa.prototype.applyPivot=function(k,G,d,S,P,ja,D,da,Ha,jb,kc){var Jb=this;0<Ha.getRangeInformation(Ha.ha.ta.activeCell).length?
this.Npb=!0:(this.YQ.vl=!0,this.$Q.vl=!0);this.FOb();k.Vhc&&(this.KGa=k.pivotTableName);var md=Pa.Rrb(k),ce={FieldListType:1};ce.FieldListVersion=k.bK;ce.FieldWellVersion=k.aR;ce.SourceAxis=G;ce.SourceAxisPosition=d;ce.ItemType=S;ce.ItemIndex=P;ce.DestinationAxis=ja;ce.DestinationAxisPosition=D;this.xv&&this.GTj(kc,G,ja);G=new Id.a(145,0,function(qe,Ye,ma){var ab=Jb.$.na.va;qe=Sd.b(qe,Jb.lHi);var bc=Xe.nb(ab,k.Au,k.externalSourceIndex,md);bc.pivotFieldApplyData=ce;return Xe.i(ab,"ApplyPivot",bc,qe,
Ye,ma,null,0)},4,function(){return new ec(Jb.pivotName,ce,jb,k.Au)});this.$.userOperationManager.ic(G,da);this.N6c=ja};Pa.prototype.GTj=function(k,G,d){if(this.zi&&this.Xj)if(0===G)this.r7=0,this.rQa=k;else if(0!==d)this.r7=d;else switch(this.r7=0,this.oHb=!0,G){case 1:1<this.Xj.RowAxis.length&&(this.r7=1);break;case 2:1<this.Xj.ColumnAxis.length&&(this.r7=2);break;case 4:1<this.Xj.FilterAxis.length&&(this.r7=4);break;case 8:1<this.Xj.DataAxis.length&&(this.r7=8)}};Pa.prototype.expandPivotFieldListLevels=
function(k){var G=this,d=Pa.Rrb(k);this.t1b=!0;this.FOb();this.$.userOperationManager.ic(new Id.a(146,0,function(S,P,ja){var D=G.$.na.va;S=Sd.b(S,G.TKi);var da=Xe.nb(D,k.Au,k.externalSourceIndex,d);da.type=1;return Xe.i(D,"ExpandPivotFieldListLevels",da,S,P,ja,null,0)}),null)};Pa.prototype.h5e=function(k){return this.F_?this.isRtl?0:Pa.etb:k===Pa.U0d||k===Pa.YL?this.isRtl?Pa.etb:0:this.isRtl?0:Pa.etb};Pa.prototype.Sgj=function(){if(this.RC)for(var k=Pa.YL;k<=Pa.tT;k++){var G=this.RC[k];if(this.ZQ[k]){var d=
Cc(this.h5e(k),this.isRtl);G.innerHTML=String.format(Pa.UYj,this.W4b(this.ZQ[k],k),d)}else G.innerHTML=""}this.ZIb()};Pa.prototype.ZIb=function(){if(this.RC)for(var k=Pa.YL;k<=Pa.tT;k++){var G=this.h5e(k),d=this.RC[k];if(0<d.scrollWidth){var S=d.scrollWidth-(Pa.LBh+G),P=d.getElementsByTagName("label");if(P&&!this.F_)for(var ja=0,D=P.length;ja<D;ja++)Tb(P[ja],S);Tb(this.HTe[k],d.offsetWidth-(Pa.SKj+G))}}this.rza&&this.YA&&0<this.YA.offsetWidth&&(Tb(this.rza,this.$.gl?this.YA.offsetWidth:this.YA.offsetWidth-
Pa.gXi),this.F_||dd.DOMElementExtensions.shrinkToFit(this.rza,this.rza,!1))};Pa.prototype.Eid=function(k){return this.Y9b[k]};Pa.prototype.ccc=function(k){return Pa.oxd+this.Eid(k)};Pa.prototype.Did=function(k){var G=Pa.WDc;for(var d=Pa.YL;d<=Pa.tT;d++)if(1===k.indexOf(this.Eid(d)))return G=d,{returnValue:this.ZQ[d],VDc:G};return{returnValue:null,VDc:G}};Pa.prototype.Gac=function(k,G){for(var d,S,P=Pa.YL;P<=Pa.tT;P++){var ja=this.ZQ[P];for(d=ja.length-1;0<=d;d--)if(S=ja[d],S.PivotCacheIndex===k&&
(-1===G||S.PivotTableIndex===G))return k=this.k2e(P),S=S.PivotTableIndex,{returnValue:!0,axis:k,pos:d,JHf:S}}return{returnValue:!1,axis:0,pos:-1,JHf:-1}};Pa.prototype.hjc=function(k,G){if(k&&k.id)for(var d=Pa.YL;d<=Pa.tT;d++)if(k.id.indexOf(this.Y9b[d])===(G?1:0))return!0;return!1};Pa.prototype.aqi=function(k){return k&&k.id&&k.id.startsWith(Pa.oxd)&&this.hjc(k,!0)||k.classList.contains(ba.uOe)&&(k=k.getElementsByTagName("input")[0])&&k.id&&k.id.startsWith(Pa.oxd)&&this.hjc(k,!0)?k:null};Pa.prototype.W4b=
function(k,G){var d="";if(k)if(0<k.length)for(var S=this.F_?Pa.sEj:Pa.rEj,P=0,ja=k.length;P<ja;P++){var D=k[P],da=D.Name?ge.a.Sf(D.Name):"",Ha=String.format(S,ba.T8b,da,mb(D,this.Eid(G))),jb=Tc.a.Se(9);da=String.format(Pa.qEj,mb(D,this.ccc(G)),da,Qc.a.TPe+" "+ba.zOe,jb,de.a.RZa);d+=String.format(Pa.bCb,mb(D,Pa.jjc),Ha,da)}else d+=Pa.Skh;return d};Pa.prototype.Sbc=function(k){return this.hjc(k,!1)?k:k.id.startsWith(Pa.jjc)||k.classList.contains(ba.T8b)?(k=k.getElementsByTagName("label")[0])&&this.hjc(k,
!1)?k:null:null};Pa.prototype.VJe=function(k,G,d){this.hdb(null,"");var S=this.QZe(G);if(this.OZe(k,S,d)&&!(S===Pa.WDc||d&&S===Pa.UDc)){var P=d=0;S!==Pa.UDc&&S!==Pa.XDc&&(d=this.MTe[S],this.ZQ[S]&&(P=Pa.ZOh(this.RC[S],G)));this.qH(k,d,P,null,null)}};Pa.prototype.Ggh=function(k,G){var d=k.getElementsByTagName("li");if(d&&0<d.length){k=d.length;for(var S=0;S<k;S++){var P=d[S];if(Xf.a.yB(dd.DOMElementExtensions.getBounds(P),G)){P.classList.contains(Pa.Ysb)||this.hdb(P,Pa.Ysb);return}}0<k&&(d=d[d.length-
1],k=dd.DOMElementExtensions.getBounds(d),G.y>k.y+k.height&&(d.classList.contains(Pa.N7c)||this.hdb(d,Pa.N7c)))}else this.hdb(k.getElementsByTagName("div")[0],Pa.Ysb)};Pa.prototype.hdb=function(k,G){this.aJa&&(this.aJa.classList.remove(this.aJa.classList.contains(Pa.Ysb)?Pa.Ysb:Pa.N7c),this.aJa===this.cu&&this.cu.classList.add(wf));this.aJa=null;k&&(this.aJa=k,this.aJa===this.cu&&this.cu.classList.remove(wf),k.classList.add(G))};Pa.prototype.fjf=function(k){return k>=Pa.YL&&k<=Pa.tT};Pa.prototype.QZe=
function(k){for(var G=Pa.YL;G<=Pa.tT;G++)if(Xf.a.yB(dd.DOMElementExtensions.getBounds(this.RC[G]),k))return G;return this.fieldList.jqi(k)?Pa.UDc:Xf.a.yB(dd.DOMElementExtensions.getBounds(this.parentElement),k)?Pa.XDc:Pa.WDc};Pa.prototype.OZe=function(k,G,d){if(!d&&0===k.TypeTag){if(!this.currentState.T5||this.zi.IsPpm||G===Pa.XDc)return!0;d=this.Gac(k.PivotCacheIndex,k.PivotTableIndex).axis;var S=this.k2e(G);return k.PivotTableIndex===Pa.pWj&&(4===S||8===S)||k.IsSet&&G===Pa.YL?!1:0===S||8===d&&8===
S||8!==d&&8!==S}S=5===k.TypeTag||7===k.TypeTag;var P=17===k.TypeTag||this.zi.IsPpm;switch(G){case Pa.YL:return(S||P)&&!k.IsSet;case Pa.Khg:case Pa.U0d:return S||P||k.IsSet;case Pa.tT:return(!S||P)&&!k.IsSet;case Pa.XDc:return!d;case Pa.UDc:return!0;default:return!1}};Pa.prototype.OJa=function(k,G,d,S){if(S=cd(d,S,!1)){this.jea(S,G);this.gL=Sa(this.getElementById(mb(S,Pa.jjc)),this.gL,this.gL===this.cu);var P=new Zd.a(-1453503574,0,this.$.fd,30,null),ja={};this.currentState.pW?(ja.AnchorType=8,ja.ChartId=
this.currentState.chartId):ja.AnchorType=9;ja.AnchorValue1=S.PivotTableIndex;ja.AnchorValue2=S.PivotCacheIndex;var D=this.Gac(S.PivotCacheIndex,S.PivotTableIndex);G=D.axis;D=D.pos;var da={};this.$.Ka.$b(P,(da.domElement=k,da.cell=this.currentState.Au,da.externalSourceIndex=this.externalSourceIndex,da.fieldItem=S,da.zoneCount=d.length,da.sourceAxis=G,da.sourceAxisPos=D,da.optionalPivotMenuAnchorParameter=ja,da.isOlap=this.currentState.T5,da.isPpm=this.zi.IsPpm,da.versionkey=this.AIa,da))}};Pa.prototype.k4=
function(){if(this.cl){var k=this.parentElement;k.removeChild(this.cl.domElement);this.cl.pIb(this.wEb);this.cl.qIb(this.xEb);this.cl.TQf(this.vEb);Ac.a.Ha(this.cl);this.cl=null;k.style.cursor="default"}};Pa.prototype.clear=function(){this.currentState=ub.Q4b();this.refresh()};Pa.prototype.v7e=function(k){this.ocg();this.rn?(k=this.Rna(k),k||(this.rn=null)):k=this.GEh(k);k||this.Z8i();return k};Pa.prototype.Z8i=function(){var k=this.domElement.querySelectorAll(dd.DOMElementExtensions.sr);this.fF=
dd.DOMElementExtensions.Lm(k);this.fI=dd.DOMElementExtensions.oB(k);ug.a.instance.pa(rc.a.focus,this.fF,this.$oc);ug.a.instance.pa(rc.a.focus,this.fI,this.$oc)};Pa.prototype.ocg=function(){this.fF&&ug.a.instance.za(rc.a.focus,this.fF,this.$oc);this.fI&&ug.a.instance.za(rc.a.focus,this.fI,this.$oc);this.fI=this.fF=null};Pa.prototype.GEh=function(k){var G=!0;k?(this.rn=this.WU,dd.DOMElementExtensions.setFocus(this.WU)):(this.rn=this.bJa,G=this.Rna(k));return G};Pa.prototype.MQa=function(k){this.xv||
(this.cu&&this.cu.classList.remove(wf),(this.rn===this.fieldList.domElement||k)&&this.fieldList.setFocus(!0,k),k&&(this.zk=this.cu=this.rn=null))};Pa.prototype.jea=function(k,G){this.MQa(!1);this.zk=k;this.Oub=G;this.rn=this.RC[G];G=this.getElementById(mb(k,this.ccc(this.Oub)));dd.DOMElementExtensions.setFocus(G);this.cu=this.getElementById(mb(k,Pa.jjc));this.cu.classList.add(wf)};Pa.prototype.ksj=function(k,G,d){var S=k?k.length:0;if(!S)return!1;var P=null;if(this.zk)for(var ja=0;ja<S;ja++){if(k[ja]===
this.zk){if(d&&ja===S-1||!d&&!ja)return this.zk=null,!1;P=k[d?ja+1:ja-1];break}}else P=d?k[0]:k[S-1];if(!P)return!1;this.jea(P,G);return!0};Pa.prototype.Ccb=function(k,G){var d=!0;k?G&&dd.DOMElementExtensions.isVisible(this.kta)?(this.rn=this.WU,dd.DOMElementExtensions.setFocus(this.WU)):(this.rn=this.fieldList.domElement,this.Rna(G)):G?(this.rn=this.ftb,d=this.Rna(G)):dd.DOMElementExtensions.isVisible(this.kta)?(this.rn=this.WU,dd.DOMElementExtensions.setFocus(this.WU)):(this.rn=this.bJa,d=this.Rna(G));
return d};Pa.prototype.Rna=function(k){var G=!0;if(this.rn===this.WU)k?(this.rn=this.fieldList.domElement,G=this.Rna(k)):G=!1;else if(this.rn===this.fieldList.domElement)this.fieldList.Ccb(k)||(G=this.Ccb(!1,k));else for(var d=Pa.YL;d<=Pa.tT;d++)if(this.rn===this.RC[d]&&!this.ksj(this.ZQ[d],d,k)){k&&d<Pa.tT?(this.rn=this.RC[d+1],G=this.Rna(k)):!k&&d>Pa.YL?(this.rn=this.RC[d-1],G=this.Rna(k)):(this.MQa(!1),G=k?!1:this.Ccb(!0,k));break}return G};Pa.prototype.k2e=function(k){return this.fjf(k)?this.MTe[k]:
0};Pa.prototype.C1h=function(k){return 4===k?this.RC[Pa.YL]:2===k?this.RC[Pa.Khg]:1===k?this.RC[Pa.U0d]:8===k?this.RC[Pa.tT]:null};Pa.prototype.EHb=function(k,G){k&&(this.KGa=null);this.refresh();G&&(this.xW?!this.yf&&this.ns()&&this.vp()?this.showTaskPane():!this.yf||this.vp()&&this.ns()||this.hideTaskPane():this.raiseEvent(Pa.lub))};Pa.prototype.hJh=function(){var k=Sc.g(this.$),G=null;k=k.getRangeInformation(k.ha.ta.activeCell);for(var d=0,S=k.length;d<S;++d){var P=k[d];if(Object(qd.a)(Ne.PivotTableRange,
P)){G=P.pivotTableName;break}}return G};Pa.prototype.Gdg=function(k){var G=Sc.g(this.$),d=G.Ea.xl(k);if(d){if(this.KGa){k=d.ranges;if(!k)return;for(d=k.length-1;0<=d;--d){var S=k[d];if(Object(qd.a)(Ne.PivotTableRange,S)&&df.a.equals(S.pivotTableName,this.KGa,!1)){k=this.hJh();k&&df.a.equals(k,this.KGa,!1)||(k=ef.v(S.topLeft,this.$),G.Eg(k,null,null,null,0,jc.a.NAh));this.KGa=null;break}}}Sc.g(this.$).pq||this.refresh()}else dc.ULS.sendTraceTag(537162690,0,15,"Block {0} was removd from BlockManager",
k)};Pa.prototype.rL=function(){this.clear()};Pa.FMg=function(k,G,d){var S=Hd.a(k);if(!S){var P=document.getElementById(k.Lb+de.a.ITe);P?S=k.da.Ga(16,new Pa(P,k,G,d)):dc.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return S};Pa.Rrb=function(k){var G={};G.AnchorType=k.anchorType;7===k.anchorType&&(G.ChartId=k.chartId,G.AnchorValue1=G.AnchorValue2=-1);return G};Pa.qZ=function(k){k.request&&(jf.AFrameworkApplication.Jd.Fu(k.request.Qt),k.request=null)};
Pa.ZOh=function(k,G){var d=0;if(k=k.getElementsByTagName("li"))for(var S=k.length;d<S&&!Xf.a.yB(dd.DOMElementExtensions.getBounds(k[d]),G);d++);return d};Ck.Object.defineProperties(Pa.prototype,{pivotName:{configurable:!0,enumerable:!0,get:function(){return this.currentState.pivotTableName}},chartId:{configurable:!0,enumerable:!0,get:function(){return this.currentState.chartId}},Au:{configurable:!0,enumerable:!0,get:function(){return this.currentState.Au}},T5:{configurable:!0,enumerable:!0,get:function(){return this.currentState.T5}},
pW:{configurable:!0,enumerable:!0,get:function(){return this.currentState.pW}},confirmationRequiredForDataOps:{configurable:!0,enumerable:!0,get:function(){return this.currentState.confirmationRequiredForDataOps}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.currentState.externalSourceIndex}},bK:{configurable:!0,enumerable:!0,get:function(){return this.currentState.bK}},aR:{configurable:!0,enumerable:!0,get:function(){return this.currentState.aR}},AIa:{configurable:!0,
enumerable:!0,get:function(){return this.currentState.AIa}},isRtl:{configurable:!0,enumerable:!0,get:function(){return this.lj}},F_:{configurable:!0,enumerable:!0,get:function(){return this.Drg}},LRd:{configurable:!0,enumerable:!0,get:function(){return this.CZa&&!this.$.gl}},aca:{configurable:!0,enumerable:!0,get:function(){return!(!this.isVisible||this.YQ.vl||this.$Q.vl||this.t1b||this.Npb)}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.$.gl?Ig.a(this.YA):this.$.domElement}},
uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Xc.a)(Pa.prototype,this,"isVisible")},set:function(k){k=this.DZa&&k;!k||this.YA||this.l7a||this.Iai();k!==Object(Xc.a)(Pa.prototype,this,"isVisible")&&(k||this.evc(!1),Object(Xc.b)(Pa.prototype,this,"isVisible",k),k&&this.evc(!0),this.raiseEvent(Pa.lub));this.COf(null,k)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},
ve:{configurable:!0,enumerable:!0,get:function(){return Re.a.LAh}},eh:{configurable:!0,enumerable:!0,get:function(){return 1}},Qk:{configurable:!0,enumerable:!0,get:function(){return Qc.a.Jvh}},lN:{configurable:!0,enumerable:!0,get:function(){return Zb.a.instance.fa(1032)}},Do:{configurable:!0,enumerable:!0,get:function(){return this.$.gl?this.Zad:this.$ad}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!0}},titleText:{configurable:!0,enumerable:!0,get:function(){return Zb.a.instance.fa(1145)}},
U5i:{configurable:!0,enumerable:!0,get:function(){return this.zfe}},fieldList:{configurable:!0,enumerable:!0,get:function(){return this.$Ic}},SI:{configurable:!0,enumerable:!0,get:function(){var k=this;return this.taskPaneManager.nva(this.uc,this.titleText,this.Do,this.isResizable,function(){k.isVisible=!0},function(){k.isVisible=!1},function(){k.isVisible=!0},function(){k.isVisible=!1},this.Do)}},CZa:{configurable:!0,enumerable:!0,get:function(){return this.$.wc.o3(36896)&&this.DZa}},DZa:{configurable:!0,
enumerable:!0,get:function(){var k=new pa.a(this.$.xa);return this.$.isEditMode&&k.ke(8192)||!k.tj}},Lia:{configurable:!0,enumerable:!0,get:function(){return(this.pivotName||"")+(this.chartId||"")}}});Pa.WI="FieldManagerTaskPane";Pa.HAh="m_fieldManagerPane_";Pa.lub="fieldListPaneVisibilityChanged";Pa.X9b="FieldListPaneChanging";Pa.d3a="FieldListPaneChanged";Pa.JTe="FieldManagerRemovePaneEventKey";Pa.jjc="flzi_";Pa.fqi="flzlf_";Pa.eqi="flzlc_";Pa.gqi="flzlr_";Pa.hqi="flzlv_";Pa.oxd="m";Pa.LTe="m_washout";
Pa.KTe="m_flpTitle";Pa.S0d="m_fldzFilterTitle";Pa.Q0d="m_fldzColumnTitle";Pa.T0d="m_fldzRowTitle";Pa.V0d="m_fldzValueTitle";Pa.Ysb=ba.fqh;Pa.N7c=ba.gqh;Pa.dEh=yc.a.BOe;Pa.KAh=ba.Jph;Pa.JAh=ba.Iph;Pa.YL=0;Pa.Khg=1;Pa.U0d=2;Pa.tT=3;Pa.UDc=4;Pa.XDc=5;Pa.WDc=-1;Pa.pWj=-2;Pa.LBh=24;Pa.SKj=24;Pa.etb=8;Pa.gXi=60;Pa.zhh='<div ID="{0}" class="'+ba.Jqh+'"></div>';Pa.xhh='<div class="'+ba.Hqh+'"><div ID="{1}" class="'+yc.a.Q9c+'">{0}</div></div>';Pa.yhh='<div class="'+ba.Iqh+'"><div ID="{1}" class="'+yc.a.Q9c+
'">{0}</div></div>';Pa.mhh='<div ID="{0}" class="'+ba.oOe+'"><div class="'+Jc.Wr+'" style="display: inline-block"><input ID="{1}" class="'+Qc.a.Luh+'" src="{2}" type="image" title="{3}" tabindex="0"/></div></div>';Pa.PJe='<div class="'+ba.cqh+' {0}">{1}{2}</div>';Pa.n7b='<div class="'+ba.Tph+' {5}" ><div class="'+ba.sOe+'" {6}><div class="'+Qc.a.Wr+" "+ba.tOe+'"><img class="{0}" src="{3}" alt="{1}"/></div><span ID="{4}" class="'+ba.vOe+'">{1}</span></div><div ID="{2}" class="'+ba.qOe+" "+Qc.a.lm+
'"></div></div>';Pa.o7b='<div class="'+ba.Uph+'"><div class="'+ba.sOe+'" {5}><div class="'+Qc.a.Wr+" "+ba.tOe+'"><img class="{0}" src="{3}" alt="{1}"/></div><span ID="{4}" class="'+ba.vOe+'">{1}</span></div><div ID="{2}" class="'+ba.qOe+" "+Qc.a.lm+'"></div></div>';Pa.nhh='<div ID="{0}" class="'+ba.dqh+'"><div class="'+ba.Wph+'"></div><div class="'+ba.aqh+'"><span class="'+ba.Zph+'">{1}</span></div><div class="'+ba.Xph+'">{2}{3}</div></div>';Pa.ohh='<div ID="{0}" class="'+ba.eqh+'"><div class="'+
ba.bqh+'"><div class="'+ba.$ph+'">{1}</div></div><div class="'+ba.Yph+'">{2}{3}{4}{5}</div></div>';Pa.qhh='<div ID="{0}" class="'+ba.xOe+'">{1}</div>';Pa.rhh='<div ID="{0}" class="'+ba.mqh+'">{1}</div>';Pa.UYj='<ul class="'+ba.FOe+" "+ba.Kqh+'" {1}>{0}</ul>';Pa.bCb='<li id="{0}" class="'+ba.iqh+'">{1}{2}</li>';Pa.Skh='<div id="dzempty" class="'+ba.hqh+'"></div>';Pa.rEj='<span class="{0}" title="{1}"><label id="{2}" class="'+ba.wOe+'">{1}</label></span>';Pa.sEj='<span class="{0}" title="{1}"><label id="{2}" class="'+
ba.wOe+'" style="max-width: calc(100% - 24px)">{1}</label></span>';Pa.qEj='<span class="'+ba.uOe+'"><div class="'+Qc.a.w1c+'"><input id="{0}" class="{2}" type="image" title="{1}" alt="{1}" src="{3}" tabindex="0" role="{4}"/></div></span>';Pa.k6i="FieldListReactPaneHeaderId";Pa.f6i="FieldListReactPaneBodyId";Pa.m6i="FieldListReactPaneTitleId";Pa.g6i="FieldListReactPaneCloseButtonId";Pa.i6i=ba.vqh;Pa.j6i=ba.uqh;Pa.l6i="cui-taskPaneTitle "+ba.wqh;Pa.e6i=ba.sqh;Pa.h6i=ba.tqh;Object(bb.a)(Pa,"FieldManagerPane",
fc.a,[782,403,2,548,438]);var Ud=tc.a;Am(cc,Ud);cc.prototype.create=function(){var k=this,G=Xd.GetServiceTaskFactory.Ua(this.$.da,12,477,this.ub),d=Vc.a(this.$),S=[G,d];if(!Se.a.Ld(this.$)){var P=Xd.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ub),ja=Xd.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub);S.push(P);S.push(ja)}ee.TaskExtensions.Ba(ee.TaskExtensions.xe(S,this.la),function(){var D=Pa.FMg(k.$,d.result,G.result);D&&(Se.a.Ld(k.$)||d.result.vR(D),D.S6());k.Eb(D)},this.la,
3)};cc.prototype.dispose=function(){this.$=null;Ud.prototype.dispose.call(this)};cc.ka=function(k){k.da.Ga(74,new cc(k))};Object(bb.a)(cc,"FieldManagerTaskPaneFactory",tc.a,[]);var Fe=b(161),gf=b(85),uf=b(561);Object(bb.a)(ib,"SelectedRangeForPivot",null,[]);var Ee=b(201),mc=b(323),Uc=b(149),Vd=b(169);Ck.Object.defineProperties(eb,{gg:{configurable:!0,enumerable:!0,get:function(){return Uc.a.hp(eb.pdi,Vd.a.fa(66),Vd.a.fa(67),Vd.a.fa(68),Vd.a.fa(69),Vd.a.fa(70),Vd.a.fa(71),Vd.a.fa(72))}}});eb.pdi=
"<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(bb.a)(eb,"InsertPivotTableDialogHtml",null,[]);var Sf=b(165),Cd=b(387);lc.prototype.bindAction=function(k){this.Zab&&k&&(this.xrc=k,this.Zab.OEg(this.xrc))};lc.prototype.jPj=function(){this.Zab&&this.xrc&&this.Zab.wbj(this.xrc)};lc.prototype.isValid=function(){return!!this.Zab&&!!this.textBox};Ck.Object.defineProperties(lc.prototype,{textBox:{configurable:!0,enumerable:!0,get:function(){return this.CXb}},Zab:{configurable:!0,enumerable:!0,get:function(){return this.Wug}}});Object(bb.a)(lc,
"TextBoxRadioButtonPair",null,[860]);var Uf=b(1085),Td=b(295);Object(bb.a)(pc,"DialogData",null,[]);Object(bb.a)(Fa,"MacroRecorderPivotTableCreatedPayload",null,[447]);var kg=b(407),Gf=b(166),Kd=b(221),af=kg.a;Am(sa,af);sa.prototype.M4a=function(k){var G=af.prototype.M4a.call(this,k);var d=G.Lic;G=G.returnValue;if(!G){var S=Object(nd.a)(Kd.a,this.$.Hb);S&&S.Aj(k)&&(G=(k=S.getItemByName(k))&&1!==k.type?2===k.type?Gf.a(k):k.usedRange:null,d=2===k.type)}return{returnValue:G,Lic:d}};Object(bb.a)(sa,"PivotTableRangeHighlightPolicy",
kg.a,[]);var Wg=mc.a;Am(Oa,Wg);Oa.prototype.dispose=function(){dc.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.LBc();Wg.prototype.dispose.call(this)};Oa.prototype.Ija=function(){var k;return k=new Ee.a,k.add(Oa.$yc),k.add(Oa.F6b),k};Oa.prototype.Neh=function(){var k=!1;2!==this.fv&&(k=Oa.Peh(this.bTa.value));k||1===this.fv||(k=Oa.Oeh(this.Maa.checked,this.destinationRange.value));return k};Oa.prototype.lfc=function(k){dc.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");
var G=this.xOh();this.gg=G.gg;var d="";2!==this.fv&&(d=Oa.$Dd(k.rea,this.$.xa));var S=Oa.n0e(d,k.G6b);1===this.fv?this.mEj=d:2===this.fv&&(this.sIe=k.G6b);this.YLb(!1,!1);this.initializeAndShow(G.title,this.nbf,S);this.hVd();this.$qj();this.aCa();dc.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")};Oa.prototype.lEj=function(k,G){G=(new sa(G)).M4a(k);k=G.Lic;G=G.returnValue;return!!G&&G.N_&&!k};Oa.prototype.aCa=function(){this.Cpb.disabled=this.Neh()};Oa.prototype.hVd=
function(){this.uR.pa(rc.a.change,this.Dya,this.tnc);this.uR.pa(rc.a.change,this.Maa,this.tnc);this.uR.pa(rc.a.Sd,this.bTa,this.fEf);this.uR.pa(rc.a.Sd,this.destinationRange,this.$wf);this.KEg(this.qu);this.wBa=!0};Oa.prototype.LBc=function(){this.wBa&&(this.uR.za(rc.a.change,this.Dya,this.tnc),this.uR.za(rc.a.change,this.Maa,this.tnc),this.uR.za(rc.a.Sd,this.bTa,this.fEf),this.uR.za(rc.a.Sd,this.destinationRange,this.$wf),this.tbj(this.qu),this.wBa=!1)};Oa.prototype.$qj=function(){2===this.fv?this.destinationRange.focus():
this.bTa.focus()};Oa.prototype.a8f=function(){var k=new Td.a(this.destinationRange),G=new Uf.a(this.Maa,!1);this.oWd=new lc(k,G);this.jVd(this.oWd)};Oa.prototype.Dcg=function(){this.QYd(this.oWd)};Oa.prototype.fl=function(){Wg.prototype.fl.call(this);dc.ULS.sendTraceTag(537155777,0,50,"InsertPivotTableDialog.InitializeDialogElements");this.bTa=document.getElementById(Oa.$yc);this.Dya=document.getElementById(Oa.Hsf);this.Maa=document.getElementById(Oa.ead);this.destinationRange=document.getElementById(Oa.F6b);
switch(this.fv){case 0:case 2:this.destinationRange.value?Oa.R0f(this.Maa,this.Dya):(this.destinationRange.disabled=!0,Oa.R0f(this.Dya,this.Maa));Rb.k(this.$.kg)&&(this.Dya.checked=!1,this.Dya.disabled=!0,this.destinationRange.value="",this.Maa.checked=!0);if(2===this.fv){this.bTa.disabled=!0;var k=document.getElementById(Oa.Ybh);k.style.visibility="hidden";k.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.Dya.disabled=!0,this.Maa.disabled=!0,k=document.getElementById(Oa.hZi),
k.style.visibility="hidden",k.style.display="none"}};Oa.prototype.Ici=function(k,G){var d=this;dc.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");var S=this.$.na.va,P=1,ja=S.hc(),D=ef.o(Sc.g(this.$).ha.ta.activeCell,this.$),da=null,Ha=null;switch(this.fv){case 0:P=132;da=function(jb,kc,Jb){jb=Sd.b(jb,d.JBd);var md=S.Na(41,void 0===ja?null:ja);md.sheetRange=k;md.destinationRange=G;return Xe.i(S,"InsertPivotTable",md,jb,kc,Jb,null,0)};Ha=function(){return new Fa(k,
G)};break;case 2:P=219;da=function(jb,kc,Jb){return Db(S,D,G,!1,Sd.b(jb,d.JBd),kc,Jb,null,ja)};break;case 1:P=219,da=function(jb,kc,Jb){return Db(S,D,k,!0,Sd.b(jb,d.JBd),kc,Jb,null,ja)}}Cd.a(this.$.userOperationManager,da,function(jb){return new Id.a(P,0,jb,void 0,Ha)},null)};Oa.prototype.xOh=function(){var k=0;switch(this.fv){case 0:k=65;break;case 1:k=2104;break;case 2:k=2100}return new pc(Zb.a.instance.fa(k),eb.gg)};Oa.prototype.Rqj=function(){var k=this.$.da.Aa(16);k&&k.oyc(!1,null,!0)};Oa.prototype.YLb=
function(k,G){var d=!k,S=this.$.da.Aa(183);S&&S.q4f(d,G);k&&this.gridView.rg&&this.gridView.rg.No(de.a.k5)};Oa.n0e=function(k,G){var d=!G,S={};return S[Oa.$yc]=k,S[Oa.F6b]=G,S[Oa.Hsf]=d,S[Oa.ead]=!d,S};Oa.R0f=function(k,G){k.tabIndex=Oa.PEh;G.tabIndex=Oa.tEi};Oa.$Dd=function(k,G){k=k.startsWith("=")?k.substring(1,k.length):k;var d=ef.Z(k,G);var S=d.sheetName;var P=d.range;d.returnValue&&P&&(S||(S=G.qa.name),k=ef.x(P,S,!1,!0));return k};Oa.Peh=function(k){return df.a.Tn(k)};Oa.Oeh=function(k,G){return k&&
df.a.Tn(G)};Ck.Object.defineProperties(Oa.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertPivotTableDialog"}},cellPickerSupportOnlyRanges:{configurable:!0,enumerable:!0,get:function(){return!0},set:function(k){Object(Xc.b)(Oa.prototype,this,"cellPickerSupportOnlyRanges",k)}},pye:{configurable:!0,enumerable:!0,get:function(){return!0}},oye:{configurable:!0,enumerable:!0,get:function(){return!0}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var k=this;
return function(){var G=k.destinationRange.value;1!==k.fv&&k.destinationRange.disabled&&(G="");k.nbf(1,Oa.n0e(k.bTa.value,G))}},set:function(k){Object(Xc.b)(Oa.prototype,this,"onCommitDialogHandler",k)}}});Oa.TLe="";Oa.PEh=0;Oa.tEi=-1;Oa.$yc="sourceRange";Oa.F6b="destinationRange";Oa.Hsf="newWorksheet";Oa.ead="existingWorksheet";Oa.Ybh="DataSourceDiv";Oa.hZi="PivotDestinationDiv";Object(bb.a)(Oa,"InsertPivotTableDialog",mc.a,[]);wb.prototype.$c=function(){return!1};wb.prototype.executeCommand=function(k,
G,d){var S=this;k=ee.TaskExtensions.Dl();var P=G.command,ja=new Fe.a,D=this.gridView.ha.ta;switch(P){case 2137617149:G="StartingRanges"in d?Array.isArray(d.StartingRanges)?d.StartingRanges:null:D.selectedRanges;this.TWh(G,ja);if(this.$.Yf.get(29)&&ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Ideas",!1)&&this.Eld){var da=new Fe.a;ja.task.CWR(function(Jb){d.SourceSelection=bg.b(Jb)&&Jb.result&&Jb.result.rea?Jb.result.rea:"";return S.$.Zd(-1444574190,0,0,d).continueWith(function(md){bg.b(md)&&
md.result||(Ha=new Oa(S.$,P),Ha.lfc(Jb.result));da.setResult(!0)})});k=da.task}else{var Ha=new Oa(this.$,P);k=ja.task.continueWith(function(){Ha.lfc(ja.task.result)})}break;case -1128516639:var jb=this.$.na.va.hc(),kc=ef.o(D.activeCell,this.$);G=function(Jb,md,ce){return Wa(S.$.na.va,kc,Sd.b(Jb,function(qe){S.Eyf(qe,ja,!1)}),Sd.a(md,function(){wb.Dyf(ja,S.$)}),ce,null,jb)};G=ue.EwaSettings.qc()?new Id.a(554,0,G,88):new uf.a(554,0,G,24);G.Una(function(){return!0});this.$.userOperationManager.ic(G,
null);Ha=new Oa(this.$,P);k=ja.task.continueWith(function(){Ha.lfc(ja.task.result)});break;case -63037693:G=new ib;if(k=this.gridView.Rb.lp(D.activeCell))k=Wb.Range.hd(k.kVf+1,k.left),G.G6b=ef.h(k,this.$,!0,void 0,!0);ja.setResult(G);Ha=new Oa(this.$,P);k=ja.task.continueWith(function(){Ha.lfc(ja.task.result)})}return k};wb.prototype.Eyf=function(k,G,d){var S=k.Result,P=new ib;if(d||S){var ja=this.gridView.ha.ta.Lg;Dc.a(k)?ja&&(P.rea=this.gridView.ha.q3e(!0)):(P.rea=S,ja&&d&&this.Vkh()&&!this.gridView.Rb.Qj(this.gridView.ha.ta.ud)&&
(P.G6b=this.gridView.ha.Gdd(!0,!0)))}else if(k=this.gridView.Rb.lp(this.gridView.ha.ta.activeCell))P.rea=k.dataSource;G.setResult(P)};wb.prototype.Vkh=function(){var k=this.gridView.ha.ta.activeCell;k=new Wb.Range(k.top,k.left,k.top+1,k.left+1,!1,!1);k=this.gridView.wk("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",k);try{for(k.$$rst();k.$$mn();)if(k.$$cu().text)return!1}finally{k&&k.dispose()}return!0};wb.prototype.TWh=function(k,G){var d=this;if(1!==k.length)G.setResult(Object(Mb.a)(new ib,
{rea:""}));else{k=k[0];var S=this.gridView.Rb.Qj(k);if(S)G.setResult(Object(Mb.a)(new ib,{rea:S.name,sourceRange:S.usedRange}));else{var P=this.$.na.va.hc(),ja=ef.o(k,this.$),D=ef.v(k,this.$);k=function(da,Ha,jb){function kc(Jb){return Jb(d.$.na.va,D,ja,Sd.b(da,function(md){d.Eyf(md,G,!0)}),Sd.a(Ha,function(){wb.Dyf(G,d.$)}),jb,null,P)}return Xd.GetServiceTaskFactory.Ua(d.$.da,482,483,1).CWR(function(Jb){bg.b(Jb)&&kc(Jb.result.getExpandedRangeForPivotTable)})};k=ue.EwaSettings.qc()?new Id.a(511,0,
k,88):new uf.a(511,0,k,24);k.Una(function(){return!0});this.$.userOperationManager.ic(k,null)}}};wb.prototype.Kc=function(k,G){k=!1;switch(G.command){case -1128516639:case -63037693:case 2137617149:k=!0}return k};wb.prototype.jd=function(){return!1};wb.Dyf=function(k,G){dc.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");Sc.g(G).ha.ta.Lg?k.setResult(Object(Mb.a)(new ib,{rea:Sc.g(G).ha.Iia})):k.setResult(Object(Mb.a)(new ib,
{rea:""}))};wb.s$e="ExcelIdeas";Object(bb.a)(wb,"InsertPivotTableCommandHandler",null,[424]);var Hf=ud.a;Am(ob,Hf);ob.prototype.Nd=function(){var k=this,G=Xd.GetServiceTaskFactory.create(this.$.da,128,this.la,this.ub);ee.TaskExtensions.Ba(ee.TaskExtensions.xe([G],this.la),function(){k.Dd([new wb(k.$)])},this.la,3)};ob.ka=function(k){ud.a.he(91,new ob(k))};Object(bb.a)(ob,"InsertPivotTableCommandHandlerFactory",ud.a,[]);var Pg=b(388),be=Pg.a;Am(gb,be);gb.prototype.dfh=function(k){var G=this;ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,
103,104,0),function(d){var S=d.result,P=Sc.g(G.$),ja=S.igb(P);if(ja){var D=ja.tf;d=D.uf.top;D=D.uf.left;S=ja.cJ.x;ja=ja.cJ.y}else d=D=1,ja=S.gLa(P),S=ja.x,ja=ja.y;P=0;for(var da=Cl(k),Ha=da.next();!Ha.done;Ha=da.next())G.sdi(parseInt(Ha.value,10),d,D,S+P,ja+P),P+=22},this.$.la,8)};gb.prototype.sdi=function(k,G,d,S,P){var ja=this,D=new Id.a(203,0,function(da,Ha,jb){var kc=ja.$.na.va.hc();return Xe.N(ja.$.na.va,ja.IEd,ja.pivotTableName,k,0,G,d,S,P,da,Ha,jb,kc)},void 0,function(){return new Kc.a(ja.IEd,
ja.pivotTableName,k,0)});this.$.userOperationManager.ic(D,null)};gb.prototype.Jci=function(){var k=this,G=new Id.a(596,0,function(d,S,P){var ja=k.$.na.va.hc();return Xe.y(k.$.na.va,k.pivotTableName,k.IEd,Sd.b(d,k.vMi),S,P,ja)},16);this.$.userOperationManager.ic(G,null)};Ck.Object.defineProperties(gb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertSlicerDialog"}}});Object(bb.a)(gb,"InsertSlicerDialog",Pg.a,[]);Na.prototype.$c=function(){return!1};Na.prototype.executeCommand=
function(k,G){k=ee.TaskExtensions.Dl();G=G.command;this.activeCell=this.ha.ta.activeCell;switch(G){case -1924368815:(this.Gc=Sc.g(this.$).Rb.lp(this.activeCell))&&!this.Gc.isOlap&&new gb(this.$,this.Gc.pivotTableName,this.$.xa.qa.sheetName)}return k};Na.prototype.Kc=function(k,G){k=!1;switch(G.command){case -1924368815:k=!0}return k};Na.prototype.jd=function(){return!1};Object(bb.a)(Na,"InsertSlicerCommandHandler",null,[424]);var $g=ud.a;Am(ra,$g);ra.prototype.Nd=function(){this.Dd([new Na(this.$)])};
ra.ka=function(k){ud.a.he(353,new ra(k))};Object(bb.a)(ra,"InsertSlicerCommandHandlerFactory",ud.a,[]);var wg=b(80),We=b(391),eg=b(614),lf=b(342),Je=b(31),Di=b(656),kj=b(59),ig=b(196),Zf=b(117);ta.prototype.executeCommand=function(k,G){return Md.Task.Ra(this.interactiveReportView.refreshSelectedConnection(G))};ta.prototype.Kc=function(k,G){return 32===k&&2054778433===G.command};ta.prototype.jd=function(){return!1};ta.prototype.$c=function(k,G){return 32===k&&(1588554917===G||1891435765===G||2054778433===
G&&!this.interactiveReportView.kic)};ta.ka=function(k,G){k.Ka.a3(new ta(G))};Object(bb.a)(ta,"InteractiveReportCommandHandler",null,[424]);var Ei=b(128);ac.prototype.aSa=function(){};ac.prototype.setVisible=function(k){this.iframe&&this.iframe.style&&(this.iframe.style.visibility=k?"visible":"hidden")};ac.prototype.dispose=function(){Ac.a.Ha(this.fja);this.fja=null};Ck.Object.defineProperties(ac.prototype,{U3:{configurable:!0,enumerable:!0,get:function(){return this.iframe}},Faf:{configurable:!0,
enumerable:!0,get:function(){return 1}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return this.iframe.contentWindow}}});Object(bb.a)(ac,"IFrameContentElement",null,[868,2]);kb.prototype.aSa=function(k){this.c6a&&(this.c6a.src="data:image/png;charset=utf-8;base64,"+k,dd.DOMElementExtensions.setVisible(this.c6a,!0))};kb.prototype.setVisible=function(k){dd.DOMElementExtensions.setVisible(this.r7b,k)};kb.prototype.dispose=function(){};Ck.Object.defineProperties(kb.prototype,{U3:{configurable:!0,
enumerable:!0,get:function(){return this.r7b}},Faf:{configurable:!0,enumerable:!0,get:function(){return 7}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(bb.a)(kb,"ImageContentElement",null,[868,2]);db.prototype.aSa=function(k){this.FG.aSa(k)};db.prototype.mUa=function(){this.interactiveReportView.isVisible&&this.U3&&this.U3.style&&(dd.DOMElementExtensions.bJ(this.U3,this.interactiveReportView.domElement.clientHeight),dd.DOMElementExtensions.Jr(this.U3,this.interactiveReportView.domElement.clientWidth))};
db.prototype.d9f=function(){qc.a.xf&&dd.DOMElementExtensions.kp(this.interactiveReportView.domElement)===this.U3&&this.interactiveReportView.focus()};db.prototype.setVisible=function(k){k||this.d9f();this.FG.setVisible(k)};db.prototype.Blh=function(){Ac.a.Ha(this.rqc);this.rqc=Jf.a.instance.create(this.KZi,2E3,$f.a.Wdi)};db.prototype.dispose=function(){dd.DOMElementExtensions.Af(this.FG.U3);Ac.a.yc([this.rqc,this.FG]);this.G9d=this.FG=this.rqc=null};Ck.Object.defineProperties(db.prototype,{interactiveReportView:{configurable:!0,
enumerable:!0,get:function(){return this.G9d}},Nwa:{configurable:!0,enumerable:!0,get:function(){return this.grg}},uYj:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.WorkbookUri}},U3:{configurable:!0,enumerable:!0,get:function(){return this.FG.U3}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return this.FG.contentWindow}}});Object(bb.a)(db,"InteractiveReportFrameInfo",null,[2]);Object(bb.a)(sb,"InteractiveReportSheetData",null,[]);Object(bb.a)(Ta,"SheetVisibilityStateData",
null,[]);var ph=b(43),ji=b(53),xh=b(6),zg=b(41),wi=lf.a;Am(wa,wi);wa.prototype.a8a=function(){return!0};wa.prototype.dispose=function(){if(this.$){var k=this.$;k.xa.lL(this.Go);k.Hb.lL(this.Go);k.Hb.Vg(this.He);k.xa.Vg(this.He);ph.a(k).Xq(this.TBf);k.AD(this.fj);k.zb.Ctc(this.Z6);k.zb.Btc(this.Y6);k.Ka.kKd(this.TEb);k.Ka.Qbb(this.su);this.kJb.dG(this.KCf);this.kJb=null}this.n6a&&(this.n6a.Wq(this.zf),this.n6a.wI(this.Tm));ue.EwaSettings.qc()&&this.gx(this.Nya);Array.contains(wa.Mka,this)&&Array.remove(wa.Mka,
this);this.clearCache();Ac.a.yc([this.hTa,this.n6a,this.Mi]);this.Mi=this.n6a=this.hTa=null;dd.DOMElementExtensions.Af(this.domElement);this.pxc.clear();this.e4.clear();this.s1b=this.businessBar=this.rBb=this.Tta=this.B1a=this.OIb=null;wi.prototype.dispose.call(this)};wa.prototype.refreshSelectedConnection=function(k){var G=this.m3e();if(G){var d=G.IsEmbedded?-1:G.SourceIndex;qf.a(this.$).tbb(G.ConnectionName,d,k);return!0}return!1};wa.prototype.Iac=function(k){var G=this;dc.ULS.sendTraceTag(537155663,
0,15,"InteractiveReportView.GetBootstrapData()");var d=this.$,S=this.OIb;if(ji.c(d))dc.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent");else if(cb.a(d).xi.activityName!==xh.a.idle)this.kBc=!0;else{this.kBc=!1;var P=function(ja,D,da){var Ha=d.na.va.hc(),jb=d.na.va;ja=Sd.b(ja,G.OLi);Ha=jb.Na(1,Ha);Ha.connectionsOnly=!!S;return Xe.i(jb,"GetInteractiveReportBootstrapData",Ha,ja,D,da,k,0)};ue.EwaSettings.qc()?d.userOperationManager.ic(new Id.a(512,0,
P,64),null):d.userOperationManager.ic(new uf.a(512,0,P),null)}};wa.prototype.m3e=function(){for(var k=0;k<this.e4.count;++k)for(var G=this.e4.hg(k),d=Cl(G.SlidesIds),S=d.next();!S.done;S=d.next())if(S.value===this.Tta)return G;return null};wa.prototype.cBg=function(k,G){this.hashCode=this.Ea.esa(k,G,this.hashCode)};wa.prototype.clearCache=function(){this.Ea.LQa(this.hashCode);this.hashCode=null};wa.prototype.rcf=function(){this.W8c();var k=this.$.qa;return this.isVisible=!!k&&gg.j(k)};wa.prototype.bCg=
function(){Array.contains(wa.Mka,this)||wa.Mka.push(this)};wa.prototype.AVg=function(){Ac.a.Ha(this.hTa);this.hTa=null};wa.prototype.gTa=function(k){var G=this;this.rcf()&&(this.bCg(),this.AVg(),ee.TaskExtensions.Ba(this.Wqe,function(){var d=6===G.Wqe.status;d&&!G.wNe&&(G.Qdi(),G.wNe=!0);G.rcf()&&(G.Lti(k||!d),d||G.i4i(),G.$.Dba||G.focus())},this.UFj,0))};wa.prototype.W8c=function(){var k=this.$.workbookContext.WorkbookFileVersionId;k&&(this.rBb||(this.rBb=k),this.rBb!==k&&this.T2b())};wa.prototype.mOf=
function(k){this.B1a=k.DataSources;k=Cl(k.DataConnections);for(var G=k.next();!G.done;G=k.next()){G=G.value;var d=G.ConnectionName.toLowerCase(),S=this.e4.getItem(d);S&&(S.ConnectionString!==G.ConnectionString||new Date(S.RefreshTimestampUTC)<new Date(G.RefreshTimestampUTC))&&(G.IsEmbedded&&this.Y6i(G.SecurityToken),this.k8i(G.DataSourceName),this.e4.remove(d));this.e4.add(d,G)}this.gNa(8)&&this.isVisible&&this.Hfb(this.Mi,null)};wa.prototype.Y6i=function(k){if(this.wxa){var G=jf.AFrameworkApplication.Jd.q8a,
d=this.$.ea.sessionId;try{InteractiveReportAPI.Rebind(this.Mi.contentWindow,this.Mi.Nwa,this.B1a,k,G,d)}catch(S){dc.ULS.sendTraceTag(537155657,0,10,"RebindInteractiveReport: Failed to call Rebind: {0}",S.message)}}};wa.prototype.k8i=function(k){if(this.wxa){var G=jf.AFrameworkApplication.Jd.q8a,d=this.$.ea.sessionId;try{InteractiveReportAPI.Refresh(this.Mi.contentWindow,this.Mi.Nwa,0,k,G,d)}catch(S){dc.ULS.sendTraceTag(537155655,0,10,"RefreshInteractiveReport: Failed to call Refresh: {0}",S.message)}}};
wa.prototype.Tna=function(k){if(k.nd.block.qa.active){k=k.nd.block.ze;var G=new sb(k.SlideId,k.FallbackImage);this.pxc.add(this.GYb,G);this.Mi.interactiveReportContent||(this.Mi.interactiveReportContent=k);this.Hfb(this.Mi,G)}};wa.prototype.Fsi=function(k){if(this.wxa)try{InteractiveReportAPI.LeaveSlide(this.Mi.contentWindow,this.Mi.Nwa)}catch(G){dc.ULS.sendTraceTag(537155651,0,10,"LeaveInteractiveReport(): Failed to call LeaveSlide: {0}",G.message)}this.Tta=null;k&&(this.Mi.setVisible(!1),this.$.isEditMode&&
this.lHd(!0))};wa.prototype.T2b=function(){Ac.a.Ha(this.Mi);this.Mi=null;this.e4.clear();this.pxc.clear();this.OIb=this.B1a=this.Tta=null;this.kBc=this.jPb=!1;this.rBb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()};wa.prototype.fOb=function(){if(this.Mi&&this.jPb&&gg.j(this.$.qa))try{InteractiveReportAPI.UnHideWindowedElements(this.Mi.contentWindow,this.Mi.Nwa),this.jPb=!1}catch(k){dc.ULS.sendTraceTag(537155618,0,10,"UnHideInteractiveReport: UnHideWindowedElements failed - {0}",k.message)}};
wa.prototype.uec=function(){if(this.Mi&&!this.jPb&&gg.j(this.$.qa))try{this.Mi.d9f(),InteractiveReportAPI.HideWindowedElements(this.Mi.contentWindow,this.Mi.Nwa),this.jPb=!0}catch(k){dc.ULS.sendTraceTag(537155617,0,10,"HideInteractiveReport: HideWindowedElements failed - {0}",k.message)}};wa.prototype.Lti=function(k){var G=this.$;if(this.Mi)this.fOb(),this.Mi.mUa(),this.Mi.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(ja){}var d=this.domElement.id+"_irframe",S=document.getElementById(d);
S&&this.domElement.removeChild(S);S=G.wc;k=k||!(S.allowFiltering&&S.allowSorting&&S.allowInteractivity);var P=this.$di;P&&(S.allowHyperlinks||(P+=wa.Udi),S.inEmbedView&&(P+=wa.Vdi),S.isBiPreviewOverride&&(P+=wa.Rdi));this.Mi=new db(this,d,P,k||!this.eub,G);this.domElement.appendChild(this.Mi.U3);k||this.eub||(this.Mi.t_=8)}(this.wxa||this.gNa(1)||this.gNa(7))&&this.Hfb(this.Mi,this.FYb);this.cBg(G.qa,kj.a.n6b)};wa.prototype.rCe=function(k){var G=this;k.t_=2;qf.a(this.$).Vx(!0,function(d){k.t_=8;d&&
(G.eub=!0,G.T2b(),G.gTa(!1))})};wa.prototype.cWi=function(k){for(var G=this.e4.count,d=Array(G),S=0;S<G;++S){var P=this.e4.hg(S),ja={};ja.Name=P.ConnectionName;ja.eZj=P.ConnectionString;ja.SecurityToken=P.SecurityToken;ja.DataSourceName=P.DataSourceName;ja.oZj=0>P.SourceIndex&&P.IsEmbedded;d[S]=ja}G=jf.AFrameworkApplication.Jd.q8a;S=this.$.ea.sessionId;P=this.FYb.Syc;try{InteractiveReportAPI.OpenReport(k.contentWindow,k.Nwa,this.OIb,null,P,this.B1a,d,k.uYj,G,S),this.$.isEditMode&&this.lHd()}catch(D){dc.ULS.sendTraceTag(537155605,
0,10,"OnGetBootstrapDataSuccess: Failed to call OpenReport: {0}",D.message);return}k.t_=5;this.Tta=P;this.Hfb(k,null)};wa.prototype.Hfb=function(k,G){switch(k.t_){case 6:this.aSa(this.Mi,G);break;case 1:this.eub?(this.Iac(k),k.t_=3):this.rCe(k);break;case 4:k.Cbf&&k.interactiveReportContent&&this.cWi(k);break;case 5:this.pDi(k,G);break;case 8:this.zZf(G);this.rCe(k);break;case 7:this.zZf(G)}};wa.prototype.Qdi=function(){try{InteractiveReportAPI.RegisterEvent("Initialized",wa.Zdi),InteractiveReportAPI.RegisterEvent("UserInteractivity",
wa.dei),InteractiveReportAPI.RegisterEvent("GetFallbackImage",wa.Xdi),InteractiveReportAPI.RegisterEvent("HostKeyPressed",wa.Ydi),ue.EwaSettings.ma(34)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",wa.Tdi)}catch(k){}};wa.prototype.iPb=function(k){return!!this.Mi&&!!this.Mi.U3&&this.Mi.contentWindow===k};wa.prototype.lOi=function(k){this.iPb(k)&&(this.Mi.Cbf=!0,this.gNa(5)?this.Mi.t_=4:this.gNa(6)&&(this.Mi.t_=1),this.isVisible&&this.Hfb(this.Mi,this.FYb))};wa.prototype.mOi=function(k){if(this.isVisible&&
this.iPb(k)&&Zf.a(qb.a.Ta,this.yBb)>=wa.Zqi&&this.$.ea.sc){this.yBb=qb.a.Ta.Wb;k=this.$.na.va;var G=this.ZMi,d=k.Na(1,null);Xe.i(k,"GetSessionInformation",d,G,null,null,null,4)}};wa.prototype.jOi=function(k,G){if(this.iPb(k)){var d=this.$,S=G.SessionId;G.fZj&&(k=function(P,ja,D){var da=d.na.va.hc(),Ha=d.na.va;P=Sd.b(P);da=Ha.Na(9,da);da.sessionId=S;return Xe.i(Ha,"InteractiveReportDataWasModified",da,P,ja,D,null,0)},ue.EwaSettings.qc()?d.userOperationManager.ic(new Id.a(513,0,k,64),null):d.userOperationManager.ic(new uf.a(513,
0,k),null))}};wa.prototype.JNi=function(k,G){if(this.iPb(k)&&G){k=[];G.sZj&&k.push("Control");G.tZj&&k.push("Meta");G.rZj&&k.push("Alt");G.uZj&&k.push("Shift");var d=document.createEvent("KeyboardEvent");d.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode(G.pZj),0,k.join(" "),!1);G=new Sys.UI.DomEvent(d);G=this.$.shortcutKeyManager.du(G);this.executeRibbonCommand(G)}};wa.prototype.executeRibbonCommand=function(k){1461300262!==k&&(k=new Zd.a(k,1,1,6,null),this.$.Ka.$b(k))};wa.prototype.kOi=
function(k){this.iPb(k)&&(this.Mi.t_=6,this.aSa(this.Mi,this.FYb))};wa.prototype.zZf=function(k){this.isVisible&&k&&k.O9b&&this.Mi.aSa(k.O9b)};wa.prototype.aSa=function(k,G){if(this.isVisible&&G&&G.O9b)try{InteractiveReportAPI.SetFallbackImage(k.contentWindow,k.Nwa,G.O9b)}catch(d){}};wa.prototype.pDi=function(k,G){if(this.isVisible){if(G&&(!this.Tta||G.Syc!==this.Tta)){var d=jf.AFrameworkApplication.Jd.q8a,S=this.$.ea.sessionId;try{this.$.isEditMode&&this.lHd(),InteractiveReportAPI.Navigate(k.contentWindow,
k.Nwa,G.Syc,d,S)}catch(P){dc.ULS.sendTraceTag(537155593,0,10,"NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: {0}",P.message);return}this.Tta=G.Syc}this.gHb(!0)}};wa.prototype.gNa=function(k){return!!this.Mi&&this.Mi.t_===k};wa.prototype.lHd=function(k){var G=this;k=void 0===k?!1:k;this.businessBar?k?this.businessBar.removeEntry(19):this.businessBar.eg(19,null):this.s1b&&ee.TaskExtensions.Ba(this.s1b.value,function(d){d=d.result;G.businessBar=d;G.s1b=null;k?d.removeEntry(19):
d.eg(19,null)},this.$.la)};wa.OGa=function(k){if(!k.da.Aa(36)){var G=new eg.a(function(){return Xd.GetServiceTaskFactory.Ua(k.da,5,4,1)}),d=Xd.GetServiceTaskFactory.create(k.da,168,k.la,1);ee.TaskExtensions.Ba(d,function(){var S=k.Mf;S=new wa(k,S.appendChild(S.ownerDocument.createElement("div")),d.result,G);k.da.Ga(36,S)},k.la)}};wa.Tdi=function(k,G){wa.Mka.forEach(function(d){d.jOi(k,G)})};wa.Zdi=function(k){wa.Mka.forEach(function(G){G.lOi(k)})};wa.dei=function(k){wa.Mka.forEach(function(G){G.mOi(k)})};
wa.Xdi=function(k){wa.Mka.forEach(function(G){G.kOi(k)})};wa.Ydi=function(k,G){wa.Mka.forEach(function(d){d.JNi(k,G)})};wa.l5g=function(k){k=ue.EwaSettings.ma(24)?wa.w$g(k.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:Tc.a.loadScript(57,4,1,!0);return ee.TaskExtensions.Ba(k,function(){try{InteractiveReportAPI.InitScript(zg.c,zg.b)}catch(G){throw G;}},Tc.a.la)};wa.w$g=function(k){var G=new Fe.a;if(!k)return dc.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),
G.setException(Error.create("apiUrl is null")),G;We.a.vMe(k,function(d,S){S.succeeded?G.setResult(!0):(G.setException(Error.create("Network")),dc.ULS.sendTraceTag(537155585,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: script {0} failed to load successfully",k))},4,!0);return G};Ck.Object.defineProperties(wa.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.n6a}},Ue:{configurable:!0,enumerable:!0,get:function(){return 32}},kic:{configurable:!0,enumerable:!0,get:function(){if(this.wxa){var k=
this.m3e();return!!k&&-1!==k.SourceIndex}return!1}},UFj:{configurable:!0,enumerable:!0,get:function(){this.hTa=this.hTa||new ig.a;return this.hTa.token}},Wqe:{configurable:!0,enumerable:!0,get:function(){return this.O2d||(this.O2d=wa.l5g(this.$))}},GYb:{configurable:!0,enumerable:!0,get:function(){return this.$.qa.index.toString()}},FYb:{configurable:!0,enumerable:!0,get:function(){return this.pxc.getItem(this.GYb)}},$di:{configurable:!0,enumerable:!0,get:function(){if(ue.EwaSettings.ma(24)){var k=
wg.a.vU(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,wa.fei,this.$.workbookContext.FullDocumentInfo.WorkbookPath);k=wg.a.vU(k,wa.aei,wa.bei);k=wg.a.vU(k,wa.Sdi,this.$.ya.DataCultureTag);return k=wg.a.vU(k,wa.cei,this.$.ya.UICultureTag)}return Tc.a.current.kO.InteractiveReportServiceUrl}},wxa:{configurable:!0,enumerable:!0,get:function(){return this.gNa(5)}}});wa.Udi="&EnableHyperlinks=false";wa.Vdi="&EmbeddedView=true";wa.Rdi="&BIPreview=true";wa.fei="WORKBOOKURL";wa.aei="ServiceName";
wa.bei="ExcelServices";wa.Sdi="culture";wa.cei="uiculture";wa.Zqi=3E4;wa.Mka=[];Object(bb.a)(wa,"InteractiveReportView",lf.a,[]);var Bh=b(113),Jh=b(1196),nh=b(212),fh=b(81),rj=Bh.a;Am(qa,rj);qa.prototype.execute=function(k){var G=Object(nd.a)(6,k.Le),d=Tc.a.current.kO;k.activityState[fh.a.sM]=fh.a.y9a;k.activityState[fh.a.V2]=qa.L6g(G,d.OfferPowerBiTrialUrl,d.OfferPowerBiTrialCompleteSignUpParameter);k.activityState[fh.a.BUc]=!0;G.Uk.hz("PowerBiTrial");return 3};qa.L6g=function(k,G,d){k=new Sys.StringBuilder(k.isEditMode?
k.workbookContext.FullDocumentInfo.HostEditUrl:k.workbookContext.FullDocumentInfo.HostViewUrl);nh.a.fh(k,Jh.a.B3i,"1");k=encodeURIComponent(k.toString());return String.format("{0}&{1}={2}{3}",G,"ru",d,encodeURIComponent(String.format("?{0}={1}","returnUrl",k)))};Object(bb.a)(qa,"OfferPowerBiTrialActivity",Bh.a,[]);var Qh=tc.a;Am(Aa,Qh);Aa.prototype.create=function(){this.Eb(new qa(xh.a.CUd,xh.a.h0))};Aa.ka=function(k){k.da.Ga(79,new Aa)};Object(bb.a)(Aa,"OfferPowerBiTrialFactory",tc.a,[]);var bh=
b(1340),Xh=b(79),ci=b(56),Fg=b(644);va.prototype.$c=function(){return!1};va.prototype.executeCommand=function(k,G,d){var S=this;k=ee.TaskExtensions.Dl();var P=G.command,ja=this.$.na.va,D=null,da=1,Ha=this.$.na.va.hc();this.activeCell=ef.o(this.ha.ta.activeCell,this.$);this.Gc=Sc.g(this.$).Rb.lp(this.ha.ta.activeCell);switch(P){case 498319061:dc.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.Gc)return k;D=function(jb,kc,Jb){var md=S.activeCell,
ce=!S.Gc.showDrillIndicators,qe=ja.Na(41,void 0===Ha?null:Ha);qe.activeCell=md;qe.showDrillInIndicator=ce;return Xe.i(ja,"PivotTableShowExpandButton",qe,jb,kc,Jb,null,0)};da=218;break;case 1529441790:ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,441,442,0),function(jb){(jb=jb.result)&&jb.VAj()},this.$.la,3);break;case -1556797033:this.Gc&&this.Ogd(this.KMi,this.JMi);break;case -1611233597:this.Gc&&this.Ogd(this.MMi,this.LMi);break;case 786260386:this.Gc&&(d=Number.parseInvariant(d.MenuItemId),
this.Ogd(this.IMi,this.HMi,d));break;case 1771091375:this.showDetails();break;default:k=Sb.a(P)}D&&(k=Cd.a(this.$.userOperationManager,D,function(jb){return new Id.a(da,0,jb,void 0,null)},G));return k};va.prototype.Kc=function(k,G){k=!1;switch(G.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:k=!0;break;case 1771091375:k=ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return k};va.prototype.jd=function(){return!1};va.prototype.dispose=
function(){this.$=null};va.prototype.showDetails=function(){var k=this;Cd.a(this.$.userOperationManager,function(G,d,S){var P=k.$.na.va,ja=k.activeCell;G=Sd.b(G,Object(Nd.a)(k,k.$Si,"onShowDetailsDone"));var D=P.Na(41,null);D.activeCell=ja;return Xe.i(P,"PivotTableShowDetails",D,G,d,S,null,0)},function(G){return new Id.a(262,0,G,void 0,null)},null)};va.prototype.$Si=function(k){Dc.a(k)||((k=this.$.xa.getItemByName(k.Result.toString()))&&k.activate(),k=document.querySelector(".ewa-stb-tabs .tab-active"),
this.pNj(k))};va.prototype.pNj=function(k){var G=gf.a.instance.lc("Common.ISystemInitiatedFeedback");G&&k?(G.execute(function(d){d.logActivity("TeachingUIForShowDetails",null)}),dc.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):dc.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")};va.prototype.Ogd=function(k,G,d){var S=this;d=void 0===d?0:d;this.$.userOperationManager.ic(new Id.a(1016,0,function(P,ja,D){return Xe.B(S.$.na.va,
S.activeCell,S.Gc.externalSourceIndex,S.Gc.pivotTableName,S.$.domElement.id,S.$.isChromeRtl,S.$.workbookContext.NovMode,Sd.b(P,k),Sd.a(ja,G),D,0!==d?d:null,null,!0)},16),null)};va.prototype.Utd=function(k){if(this.tsd(k))if(this.usd(k)){var G=k.PivotFields[0];if(this.psd(G)){var d={};d.FieldId=G.IdString;d.Location=this.activeCell;d.DataSourceIndex=this.Gc.externalSourceIndex;d.SelectedFieldIndex=G.SortByValueIndex;var S=G.DisplayString;S.length>bh.n&&(S=S.substring(0,bh.n)+"...");d.ColumnName=ge.a.Sf(S);
d.SortAscend=G.IsSortedAscending&&G.IsSortedByValue;k=Object(Mb.a)(new Fg.a,{pivotName:this.Gc.pivotTableName,wMb:d,Xta:this.Pja(k.PivotDataItems,!1),Yta:this.Pja(k.PivotDataItems,!0)});G={};this.$.Zd(-1681601147,Xh.a.Vb,0,(G.launchSortByValueDialogCommandData=k,G))}else this.ui(156,"AutoFilterSortByValueIncorrectSelection")}else this.ui(747,"SortByValueNoDataFields")};va.prototype.Vtd=function(k){if(this.tsd(k))if(this.usd(k)){var G=k.PivotFields[0];if(this.psd(G)){var d={};d.FilterType=bh.e;d.AdvancedFilter=
k.AdvancedFiltering;d.Location=this.activeCell;d.DataSourceIndex=this.Gc.externalSourceIndex;d.MaxCount=bh.a;d.Title=G.DisplayString;d.IsPivotFilter=!0;d.FieldId=G.IdString;d.AnchorType=0;(G=G.FilterParameter)?(d.Count=0<G.FilterValue?G.FilterValue.toString():"",d.Top=G.IsTopFilter,d.Type=G.FilterType,d.SelectedFieldIndex=bh.g(k.PivotDataFields,G.DataFieldId)):(d.Count=bh.b,d.Top=!0,d.Type=1,d.SelectedFieldIndex=bh.o);G=new Zd.a(856841605,Xh.a.Vb,this.$.fd,0,null);d={Top10FilterParameters:d};d.PivotName=
this.Gc.pivotTableName;d.DataFieldIds=this.Pja(k.PivotDataFields,!1);d.DataFieldNames=this.Pja(k.PivotDataFields,!0);k={};k[Xh.a.Ag]=ci.a.Lc(d);this.$.Ka.$b(G,k)}}else this.ui(244,"ValueFilterNoDataFields")};va.prototype.tsd=function(k){return 1===k.PivotFields.length};va.prototype.usd=function(k){return 0<k.PivotDataFields.length&&0<k.PivotDataItems.length};va.prototype.psd=function(k){return!k.IsDataField&&!k.IsFieldInPageFilterArea};va.prototype.Rtd=function(k,G){if(this.tsd(k))if(bh.m(G)&&!this.usd(k))this.ui(244,
"ValueFilterNoDataFields");else{var d=k.PivotFields[0];if(this.psd(d)){var S=this.tCh(d.PivotFilterParameters,G),P={};P.ActiveCompareType=this.zbh(G);P.ShowDataFields=bh.m(G);P.FilterType=this.cQh(G);P.ValueTypeText=bh.j(G);P.Location=this.activeCell;P.ColumnName=d.DisplayString;P.IsPivotFilter=!0;P.IsTimeSlicer=!1;P.NonNumericCaptionFilteringEnabled=d.IsNonnumericCaptionFilteringEnabled;P.FieldId=d.IdString;P.AnchorType=0;P.ControlGroupOrder=bh.h();P.ShowWholeDays=d.IsDateField&&!bh.m(G);P.EnabledWholeDays=
d.IsEnabledWholeDays;P.WholeDays=d.IsWholeDays;P.MemberProperties=!1;P.SelectedFieldIndex=bh.o;S&&(bh.m(G)||d.IsDataField?(P.Value1=S.FilterValue1.toString(),P.Value2=S.FilterValue2.toString(),bh.m(G)&&(P.SelectedFieldIndex=bh.g(k.PivotDataFields,S.DataFieldId))):(P.Value1=S.FilterString1,P.Value2=S.FilterString2));G=new Zd.a(-2042011094,Xh.a.Vb,this.$.fd,0,null);P={CustomFilterParameters:P};P.FieldId=d.IdString;P.PivotName=this.Gc.pivotTableName;P.DataFieldIds=this.Pja(k.PivotDataFields,!1);P.DataFieldNames=
this.Pja(k.PivotDataFields,!0);k={};k[Xh.a.Ag]=ci.a.Lc(P);this.$.Ka.$b(G,k)}}};va.prototype.Pja=function(k,G){for(var d=[],S=0;S<k.length;++S)G?d.push(k[S].DisplayString):d.push(k[S].IdString);return d};va.prototype.zbh=function(k){switch(k){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;
case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14};va.prototype.cQh=function(k){return bh.j(k)?bh.c:bh.m(k)?bh.f:bh.k(k)?bh.d:""};va.prototype.tCh=function(k,G){for(var d=0;d<k.length;++d)if(k[d].FilterType===G)return k[d];return null};va.prototype.ui=function(k,G){k=He.a.gd(1,0,0,k,0,0,G);ph.a(this.$).ui(k)};Object(bb.a)(va,"PivotCommandHandler",null,[424,2]);var ki=ud.a;Am(xa,ki);xa.prototype.Nd=function(){var k=this,G=Xd.GetServiceTaskFactory.create(this.$.da,
128,this.la,this.ub);this.$.WC(function(){ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?ee.TaskExtensions.Ba(ee.TaskExtensions.xe([G],k.la),function(){k.Dd([new va(k.$)])},k.la,3):k.Dd([new va(k.$)])})};xa.ka=function(k){k.da.Ga(345,new xa(k))};Object(bb.a)(xa,"PivotCommandHandlerFactory",ud.a,[]);ka.prototype.getActiveCell=function(){return this.activeCell};Object(bb.a)(ka,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[447]);Object(bb.a)(ha,
"PivotTableSettingsPaneOperationsUserContext",null,[]);Object(bb.a)(na,"PivotTableSettingsTaskPaneProps",null,[]);aa.prototype.lG=function(k){var G=this;Bc.UISurfaces.Ok().then(function(d){d.showTaskPane("PivotTableSettingsTaskPane",G.Aw(null,k,!1,!1,!1,null,!1));return null})};aa.prototype.qx=function(k,G,d,S,P,ja,D){var da=this;Bc.UISurfaces.Ok().then(function(Ha){Ha.updateTaskPane("PivotTableSettingsTaskPane",da.Aw(k,G,d,S,P,ja,D));return null})};aa.prototype.kN=function(){Bc.UISurfaces.Ok().then(function(k){k.hideTaskPane("PivotTableSettingsTaskPane",
2);return null})};aa.prototype.Aw=function(k,G,d,S,P,ja,D){var da=this;k=Object(Mb.a)(new na,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:k,isRangeChanged:d,isNativePivotTable:S,expandAllByDefault:!0,hasLessThanTwoRowFields:P,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,needFocusOnFirstElement:D,onSaveSectionCollapseState:function(Ha,jb){da.pivotTableSettingsPaneManager.onSaveSectionCollapseState(Ha,jb)},onSettingChange:function(Ha,jb,kc){da.pivotTableSettingsPaneManager.FQi(Ha,
jb,kc,ja)}});if(Se.a.Ld(this.$))return Object(Mb.a)(new wd.a,{contentProps:k,onOpen:function(){da.pivotTableSettingsPaneManager.Ey()},onClose:function(){da.pivotTableSettingsPaneManager.GB()},onManualClose:function(){da.pivotTableSettingsPaneManager.kCd()},title:Zb.a.instance.fa(1041),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900});G=Object(Mb.a)(new Pe.a,{type:"ExcelLegacyTaskPaneProps",container:G,paneProps:k});return Object(Mb.a)(new wd.a,{contentProps:G,onOpen:function(){da.pivotTableSettingsPaneManager.Ey()}})};
Object(bb.a)(aa,"PivotTableSettingsReactTaskPane",null,[826]);Object(bb.a)(fa,"PivotTableSettingsInfo",null,[]);Object(bb.a)(U,"SlicerConnectionItem",null,[]);L.prototype.VAj=function(){var k=this;if(Se.a.Ld(this.$))this.yf?(this.es=!1,this.hideTaskPane(!0)):(this.es=!0,this.showTaskPane(!0)),this.$.Bf();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.jg(!this.yf),this.yf?this.hideTaskPane(!0):this.showTaskPane(!0);else{var G=Xd.GetServiceTaskFactory.Ua(this.$.da,346,347,0),
d=Vc.a(this.$);ee.TaskExtensions.Ba(ee.TaskExtensions.xe([G,d],this.$.la),function(){k.pivotTableSettingsTaskPane=G.result;d.result.vR(k.pivotTableSettingsTaskPane);k.S6();k.pivotTableSettingsTaskPane.jg(!0);k.showTaskPane(!0)},this.$.la,3)}};L.prototype.onSaveSectionCollapseState=function(k,G){this.pM&&0<=k&&k<this.pM.length&&(this.pM[k]=G)};L.prototype.FQi=function(k,G,d,S){function P(jb,kc,Jb){var md=new ha;md.KHf=k;md.LHf=S;var ce=D.$.na.va,qe=da,Ye=G;jb=Sd.b(jb,D.GQi);var ma=ce.Na(41,null);ma.activeCell=
qe;ma.option=k;ma.userInputText=Ye;ma.userInputInt=d;return Xe.i(ce,"PivotTableSettingsPaneOperations",ma,jb,kc,Jb,md,0)}function ja(){return new ka(da,Ha.pivotTableName,k,G,d)}var D=this,da=this.y5b,Ha=this.Y3;if(!Ha||S!==Ha.fda)if(this.Rma&&S===this.Rma.fda)Ha=this.Rma,da=this.hJf;else{dc.ULS.sendTraceTag(537154690,0,50,"OnPivotTableSettingsChanged Cannot Find PivotTable for opType: {0}",k);return}switch(k){case 1:this.nda=Ha.pivotTableName;G=255<G.length?G.substring(0,255):G;Ha.pivotTableName=
G;break;case 2:this.Kza=Ha.rwGrandTotalOn;Ha.rwGrandTotalOn=!!d;break;case 3:this.Kza=Ha.colGrandTotalOn;Ha.colGrandTotalOn=!!d;break;case 6:Ha.autoFormatOnUpdate=!!d;break;case 7:Ha.showDrillIndicators=!!d;break;case 8:Ha.showItemsWithNoDataOnRw=!!d;break;case 9:Ha.showItemsWithNoDataOnCol=!!d;break;case 10:Ha.displayErrorString=!!d;break;case 11:Ha.displayNullString=!!d;break;case 12:this.nda=Ha.errorString;Ha.errorString=G;break;case 13:this.nda=Ha.nullString;Ha.nullString=G;break;case 14:this.Kza=
Ha.saveSourceDataWithFile;Ha.saveSourceDataWithFile=!!d;break;case 15:this.Kza=Ha.refreshOnLoad;Ha.refreshOnLoad=!!d;break;case 16:this.nda=Ha.altText;Ha.altText=G;break;case 17:this.nda=Ha.altTextSummary;Ha.altTextSummary=G;break;case 20:this.iJf=Ha.indentIncrement,Ha.indentIncrement=d}dc.ULS.sendTraceTag(595125196,0,50,"OnPivotTableSettingsChanged for opType: {0}",k);ue.EwaSettings.qc()?this.$.userOperationManager.ic(new Id.a(225,0,P,64,ja),null):this.$.userOperationManager.ic(new uf.a(225,0,P,
void 0,ja),null)};L.prototype.Xbi=function(k){this.uGb=new aa(k,this)};L.prototype.S6=function(){this.kqc=this.pivotTableSettingsTaskPane.LM();this.pivotTableSettingsTaskPane.wM(this.dFb)};L.prototype.dispose=function(){this.ha.tO(this.kma);this.gridView.aG(this.kma);this.gridView.mL(this.Uq);this.$=this.gridView=this.ha=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.uO(this.dFb),this.pivotTableSettingsTaskPane=this.kqc=null);this.pM=this.uGb=null};L.prototype.Ey=
function(){this.y5b=ef.o(this.ha.ta.activeCell,this.$);this.Y3=this.$ja();this.updateTaskPane(this.$ja())};L.prototype.GB=function(){this.hideTaskPane()};L.prototype.kCd=function(){this.es=!1;this.hideTaskPane(!0);this.$.Bf()};L.prototype.vp=function(){return this.CZa&&this.es};L.prototype.ns=function(){var k=Sc.g(this.$).Rb.lp(this.ha.ta.activeCell);return!(this.ha.Ue&470)&&!!k&&!k.W7a(!0)&&this.es};L.prototype.showTaskPane=function(k){if(void 0===k?0:k)this.POa=!0,dc.ULS.sendTraceTag(537154659,
0,50,"PivotTable settings pane is opened by the user.");this.yf=!0;this.uGb.lG(this.kqc)};L.prototype.updateTaskPane=function(k,G){G=void 0===G?!1:G;if(this.yf&&k&&!k.W7a(!0)){var d=new fa;d.pivotTableName=k.vHd;d.colGrandTotalOn=k.colGrandTotalOn;d.rwGrandTotalOn=k.rwGrandTotalOn;d.indentIncrement=k.indentIncrement;d.autoFormatOnUpdate=k.autoFormatOnUpdate;d.showDrillIndicators=k.showDrillIndicators;d.showItemsWithNoDataOnRw=k.showItemsWithNoDataOnRw;d.showItemsWithNoDataOnCol=k.showItemsWithNoDataOnCol;
d.displayErrorString=k.displayErrorString;d.errorString=k.errorString;d.displayNullString=k.displayNullString;d.nullString=k.nullString;d.saveSourceDataWithFile=k.saveSourceDataWithFile;d.refreshOnLoad=k.refreshOnLoad;d.altText=k.altText;d.altTextSummary=k.altTextSummary;d.slicerConnections=this.nDj(k.slicerConnections);this.uGb.qx(d,this.kqc,G,!k.isOlap,!k.uL||2>k.uL.length,k.fda,this.POa);this.POa=!1}};L.prototype.hideTaskPane=function(k){k=void 0===k?!1:k;this.yf=!1;this.uGb.kN();k&&dc.ULS.sendTraceTag(537154658,
0,50,"PivotTable settings pane is closed by the user.")};L.prototype.nDj=function(k){var G=new Ee.a;if(k)for(var d=0;d<k.length;d++){var S=k[d],P=new U;P.name=S.Name;P.caption=S.Caption;P.sheet=S.WorksheetName;P.enabled=S.Enabled||!1;G.add(P)}return G.toArray()};L.prototype.$ja=function(){return this.gridView.Rb.lp(this.ha.ta.activeCell)};L.prototype.NCc=function(){this.vp()&&this.ns()?this.yf?this.Y3!==this.Rma&&this.Y3&&this.updateTaskPane(this.$ja(),!0):this.showTaskPane():this.yf&&this.hideTaskPane()};
L.prototype.ddg=function(){this.hJf=this.y5b;this.Rma=this.Y3;this.y5b=ef.o(this.ha.ta.activeCell,this.$);this.Y3=this.$ja()};Ck.Object.defineProperties(L.prototype,{sectionCollapseStates:{configurable:!0,enumerable:!0,get:function(){return this.pM}},CZa:{configurable:!0,enumerable:!0,get:function(){return this.$.wc.o3(4128)&&this.DZa}},DZa:{configurable:!0,enumerable:!0,get:function(){var k=new pa.a(this.$.xa);return this.$.isEditMode&&k.ke(8192)||!k.tj}}});Object(bb.a)(L,"PivotTableSettingsPaneManager",
null,[815,2]);var Ag=tc.a;Am(H,Ag);H.prototype.create=function(){this.Eb(this.$.da.Aa(441)||this.$.da.Ga(441,new L(this.$)))};H.ka=function(k){k.da.Ga(442,new H(k))};Object(bb.a)(H,"PivotTableSettingsPaneManagerFactory",tc.a,[]);I.Ish="ewa-ptsp-pane";I.Hsh="ewa-ptsp-header";I.Jsh="ewa-ptsp-title";I.Fsh="ewa-ptsp-body";I.Gsh="ewa-ptsp-close-button";Object(bb.a)(I,"CssClassNames",null,[]);var Ch=I.Ish,Yg=I.Hsh,hh="cui-taskPaneTitle "+I.Jsh,Ug=I.Fsh,yh=I.Gsh,pi=fc.a;Am(ca,pi);ca.prototype.ZP=function(k){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",
k)};ca.prototype.BS=function(k){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",k)};ca.prototype.wM=function(k){this.addHandler("PivotTableSettingsTaskPaneClosed",k)};ca.prototype.uO=function(k){this.removeHandler("PivotTableSettingsTaskPaneClosed",k)};ca.prototype.UH=function(){};ca.prototype.vp=function(){return this.CZa&&this.es};ca.prototype.ns=function(){var k=Sc.g(this.$).Rb.lp(this.ha.ta.activeCell);return!(this.ha.Ue&470)&&!!k&&!k.W7a(!0)&&this.es};ca.prototype.oS=function(){};
ca.prototype.Ej=function(){};ca.prototype.Rj=function(){};ca.prototype.rR=function(){return!1};ca.prototype.dispose=function(){this.$&&this.$.sm(this.Zc);this.te&&(fd.a.instance.za(rc.a.click,this.te,this.ak),Af.KeyInputManager.instance.Uv(this.te,this.GAe));this.te=this.taskPaneManager=this.$=null;pi.prototype.dispose.call(this)};ca.prototype.Wf=function(k,G){if(!G){k=dd.DOMElementExtensions.getElementById(this.domElement,"PivotTableName");if(!k&&(k=dd.DOMElementExtensions.Lm(this.domElement.querySelectorAll(dd.DOMElementExtensions.sr)),
!k))return!1;dd.DOMElementExtensions.setFocus(k)}return!G};ca.prototype.sh=function(k){return dd.DOMElementExtensions.Gf(this.uc,k)};ca.prototype.jg=function(k){this.es=k;var G=this.taskPaneManager;this.isVisible=k;this.taskPaneManager.px();var d=!!this.taskPaneManager.Ig&&14===this.taskPaneManager.Ig.taskPane.eh;k&&0<G.fA.length&&(!d||G.isCollapsed)&&G.CD(this,!0);this.$.Bf()};ca.prototype.LM=function(){var k=document.getElementById(this.$.Lb+de.a.HEd),G=this.jH();k.appendChild(G);G=Xb.b("div","PivotTableSettingsPaneBodyId",
Ug);k.appendChild(G);return G};ca.prototype.jH=function(){var k=Xb.b("div","PivotTableSettingsPaneHeaderId",Yg),G=Xb.b("span","PivotTableSettingsPaneTitleId",hh);G.innerText=this.titleText;this.te=Ge.a.Bb("PivotTableSettingsPaneCloseButtonId",yh,Zb.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.te.classList.add(jf.AFrameworkApplication.isRtl?de.a.Yaa:de.a.Zaa);fd.a.instance.pa(rc.a.click,this.te,this.ak);this.GAe=Af.KeyInputManager.instance.zs(this.te,this.ak,Ef.a.ei);k.appendChild(G);k.appendChild(this.te);
return k};ca.ka=function(k,G){var d=k.Lb,S=document.getElementById(d+de.a.HEd);S||(S=document.createElement("div"),S.id=k.Lb+de.a.HEd,S.classList.add(Ch),document.getElementById(d+de.a.iS).appendChild(S));d=k.da;return d.Aa(346)||d.Ga(346,new ca(S,k,G))};Ck.Object.defineProperties(ca.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Xc.a)(ca.prototype,this,"isVisible")},set:function(k){Object(Xc.a)(ca.prototype,this,"isVisible")!==k&&Object(Xc.b)(ca.prototype,this,"isVisible",
k)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},ve:{configurable:!0,enumerable:!0,get:function(){return Re.a.qZi}},eh:{configurable:!0,enumerable:!0,get:function(){return 14}},Qk:{configurable:!0,enumerable:!0,get:function(){return Qc.a.zRe}},lN:{configurable:!0,enumerable:!0,get:function(){return Zb.a.instance.fa(1041)}},titleText:{configurable:!0,enumerable:!0,get:function(){return Zb.a.instance.fa(1041)}},Do:{configurable:!0,enumerable:!0,get:function(){return 320}},
isResizable:{configurable:!0,enumerable:!0,get:function(){return!0}},uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.aP.offsetHeight}},CZa:{configurable:!0,enumerable:!0,get:function(){return this.$.wc.o3(4128)&&this.DZa}},DZa:{configurable:!0,enumerable:!0,get:function(){var k=new pa.a(this.$.xa);return this.$.isEditMode&&k.ke(8192)||!k.tj}}});Object(bb.a)(ca,"PivotTableSettingsTaskPane",fc.a,
[781,2,548,438]);var pg=tc.a;Am(Z,pg);Z.prototype.create=function(){var k=this,G=Xd.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ub),d=Xd.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub);ee.TaskExtensions.Ba(ee.TaskExtensions.ts(ee.TaskExtensions.xe([G,d],this.la),function(){return k.qD},this.la),function(){k.Eb(k.lh)},this.la,3)};Z.prototype.dispose=function(){this.lh=this.wi=this.$=null;pg.prototype.dispose.call(this)};Z.ka=function(k){k.da.Ga(347,new Z(k))};Ck.Object.defineProperties(Z.prototype,
{qD:{configurable:!0,enumerable:!0,get:function(){var k=this;this.wi||(this.wi=ee.TaskExtensions.Ba(Vc.a(this.$),function(G){k.lh=ca.ka(k.$,G.result)},this.la,3));return this.wi}}});Object(bb.a)(Z,"PivotTableSettingsTaskPaneFactory",tc.a,[]);var qi=ud.a;Am(ea,qi);ea.prototype.Nd=function(){var k=this;ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.create(this.$.da,472,this.la,this.ub),function(){var G=k.$.da.Aa(13);k.Dd([G])},this.$.la,3)};ea.ka=function(k){ud.a.he(78,new ea(k))};Object(bb.a)(ea,"BICommandHandlerFactory",
ud.a,[]);var tg=b(737),Zh=b(38),Ga=b(1032),oa=b(332),Bb=b(463),Rd=b(441);Object(bb.a)(Q,"MacroRecorderPivotTableRefreshedPayload",null,[447]);var je=b(418),yf=je.a;Am(R,yf);Ck.Object.defineProperties(R.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return 4}},zJb:{configurable:!0,enumerable:!0,get:function(){return!!(this.flags&64)}}});Object(bb.a)(R,"DepartableRefreshWebMethodOperation",je.a,[]);var Of=b(158),Mf=Of.ErrorDialog;Am(T,Mf);T.prototype.um=function(){Mf.prototype.um.call(this);
this.OBa=String.format(Zb.a.instance.Wa(7),null)};T.jR=function(k){var G=He.a.gd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");G.Description=k;G.HelpDescription=Zb.a.instance.fa(1286);G.HelpTopicId=Ga.a.K2c;return G};Object(bb.a)(T,"DataRefreshConfirmationDialog",Of.ErrorDialog,[]);var ah=b(357),Xg=Gb.a;Am(A,Xg);A.prototype.Zoe=function(k){this.Qa.addHandler("refreshCompleted",k)};A.prototype.ope=function(k){this.Qa.addHandler("singleRefreshStarted",k)};A.prototype.ERf=function(k){this.Qa.removeHandler("singleRefreshStarted",
k)};A.prototype.npe=function(k){this.Qa.addHandler("singleRefreshCompleted",k)};A.prototype.DRf=function(k){this.Qa.removeHandler("singleRefreshCompleted",k)};A.prototype.$c=function(){return!1};A.prototype.executeCommand=function(k,G,d,S){k=G.command;switch(k){case -1193102612:this.iOf(!1,G,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===d.SourceControlId);break;case 2054778433:this.refreshSelected(G,S);break;default:return Sb.a(k)}return Md.Task.Ra(!0)};A.prototype.Kc=function(k,G){k=!1;
switch(G.command){case 2054778433:case -1193102612:k=!0}return k};A.prototype.jd=function(){return!1};A.prototype.dispose=function(){if(this.$){var k=Sc.g(this.$),G=k.ha;G.xI(this.kd);G.iAa(this.kd);this.$.Hb.jAa(this.MF);this.$.xa.jAa(this.MF);k.Ea.Wq(this.V9a);k.Ea.Kbb(this.V9a);zc.a(this.$).Ea.Wq(this.V9a);this.$.da.Aa(36)&&this.$.da.Aa(36).Ea.Wq(this.V9a);this.$.ea&&this.$.ea.Fk(this.qd)}this.clear();Ac.a.yc([this.hqc,this.Qa]);this.$=this.Qa=null;Xg.prototype.dispose.call(this)};A.prototype.tbb=
function(k,G,d){var S=this;if(this.$.ea.sc){var P=null;if(this.Wza&&Object(qd.a)(Ne.PivotTableRange,this.Wza)){var ja=this.Wza;P=function(){return new Q(ja.fda,ja.pivotTableName)}}this.$.userOperationManager.ic(new R(50,0,function(D,da,Ha,jb){var kc=S.$.na.va.hc();kc.FlightHolder=S.$.ya.FlightHolder;null==D&&S.vId.set(k,kc.ClientRequestId);var Jb=S.$.na.va;da=Sd.b(da,S.jXh(k));kc=Jb.Na(1,kc);var md=kc.context;md.RequestId=D;md.CompleteResponseTimeout=2E3;kc.connectionName=k;kc.externalSourceIndex=
G;return Xe.i(Jb,"Refresh",kc,da,Ha,jb,null,0)},68,250,P),d);this.iTi(k)}};A.prototype.Vx=function(k,G){var d=this;var S=void 0===S?null:S;if(this.confirmationRequired&&k)if(this.sbb)G(!0);else if(S=S||A.ozi,ue.EwaSettings.Kz()){k=He.a.gd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");k.Caption=Zb.a.instance.Wa(7);k.Description=S;k.HelpDescription=Zb.a.instance.fa(1286);k.HelpTopicId=Ga.a.K2c;var P=new ah.a(this.$,k);P.YP(function(){d.sbb=2===P.returnValue;G(d.sbb)})}else{var ja=new T(this.$,S);ja.YP(function(){ja.hide();
d.sbb=2===ja.returnValue;G(d.sbb)});ja.kf()}else G(!0)};A.prototype.TKa=function(){if(!this.AId){var k=Sc.g(this.$);k=k.getRangeInformation(k.ha.ta.activeCell);for(var G=0,d=k.length;G<d;++G){var S=k[G];if(Object(qd.a)(Bb.a,S)){this.Wza=S;break}}this.AId=!0}return this.Wza};A.prototype.HCc=function(){if(ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")){var k=this.$.na.va.hc(),G=this.$.na.va,d=this.YMi,S=this.XMi;k=G.Na(1,k);Xe.i(G,"GetSensitivityLabelsForPowerBIDatasets",
k,d,S,null,null,4)}};A.prototype.BCe=function(){if(ue.EwaSettings.ma(131)){var k=this.$.wc;if(!k||k.inEmbedView||k.inWebPart||k.inViewerFromWebPart)return!1;k=Sc.g(this.$);for(var G=k.ha.ta.selectedRanges,d=0;d<G.length;d++)if(k.Rb.crd(G[d]))return!0}return!1};A.prototype.sBj=function(){var k=He.a.gd(1,0,0,1468,0,-853845742,"ErrorConnectingToDataSource");ph.a(this.$).Bs([k])};A.prototype.iOf=function(k,G,d){var S=this;if(this.$.ea.sc){this.T$i();if(ue.EwaSettings.isChangeGateEnabled("OfficeVSO::5788995_RemoveHasLegacyConnections")&&
0<this.$.workbookContext.LegacyConnections.length||!ue.EwaSettings.isChangeGateEnabled("OfficeVSO::5788995_RemoveHasLegacyConnections")&&this.$.workbookContext.HasLegacyConnections){var P=He.a.gd(32,2,1614,1627,0,-73730134,"BB_LegacyConnectionsWarning");P.HelpDescription=Zb.a.instance.fa(1609);P.HelpTopicId=oa.a.Lsi;var ja=Xd.GetServiceTaskFactory.Ua(this.$.da,5,4,0);ee.TaskExtensions.Ba(ja,function(){var D=ja.result;D&&D.eg(33,P)},this.$.la,3)}k?(k=this.$.na.va.hc(),this.oab=M(this.$.na.va,!0,null,
0,Sd.b(this.AQi,this.nCf),this.BQi,null,null,k)):this.$.userOperationManager.ic(new R(51,0,function(D,da,Ha,jb){var kc=S.$.na.va.hc();kc.FlightHolder=S.$.ya.FlightHolder;var Jb=null;d&&(Jb={});return M(S.$.na.va,!1,D,2E3,Sd.b(da,S.nCf),Ha,jb,Jb,kc)},68,250,function(){return new Rd.a}),G)}};A.prototype.refreshSelected=function(k,G){if(this.$.ea.sc&&gg.i(this.$.qa)&&!this.Zyb()){var d=this.TKa();if(!this.BCe()||d&&Object(qd.a)(Ne.PivotTableRange,d))d?this.tbb(this.Wza.b2g,this.Wza.externalSourceIndex,
k):this.sBj();else{var S;k=Xd.GetServiceTaskFactory.Ua(this.$.da,271,272,G.dka());ee.TaskExtensions.Ba(k,function(P){(S=P.result)&&S.refreshLinkedEntitiesInRange()},this.$.la,3)}}};A.prototype.clear=function(){this.aQd(0);this.sbb=!1;this.zEd=-1;A.MNc=null;this.oab&&(jf.AFrameworkApplication.Jd.Fu(this.oab.Qt),this.oab=null)};A.prototype.Dmi=function(){var k=!1,G=Sc.g(this.$).ha;2===G.Ue&&(k=G.Oa.oc,G=(null===k||void 0===k?0:k.floatingObject)?k.floatingObject.dd:null,k=k.Py&&!!G&&!!(G.Attributes&
4));return k};A.prototype.Zyb=function(){return 2===Sc.g(this.$).ha.Ue};A.prototype.Gnd=function(){this.AId=!1;this.Wza=null};A.prototype.aQd=function(k){var G=0<k;!G||this.$.ea.sc&&this.$.wc.allowPeriodicDataRefresh||(G=!1);Ac.a.Ha(this.hqc);this.hqc=null;G&&(this.hqc=Jf.a.instance.GC(this.GUg,k,$f.a.Vbh))};A.prototype.oCf=function(k){k.RequestId||this.Qa.raiseEvent("refreshCompleted",k,this);this.HCc()};A.prototype.jXh=function(k){var G=this;return function(d){G.oCf(d);d&&(d.DepartableWebMethodOperationCompleted||
d.Errors&&0<d.Errors.length)&&(Array.remove(G.TVb,k),d.Result=k,G.Qa.raiseEvent("singleRefreshCompleted",d,G))}};A.prototype.iTi=function(k){Array.contains(this.TVb,k)||this.TVb.push(k);this.Qa.raiseEvent("singleRefreshStarted",k,this)};A.prototype.Mag=function(k,G,d){var S=this,P=Xd.GetServiceTaskFactory.Ua(this.$.da,274,275,0),ja=!1;d.xK?dc.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):ee.TaskExtensions.Ba(P,function(){if(function(){var da=
P.result.lYc(k,ja);ja=da.JMa;return da}().returnValue)dc.ULS.sendTraceTag(537163293,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the {0} attempt.",G);else if(ja&&3>G)if(d.xK)dc.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var D=S.$.ya.TimeToWaitForApplyingSensitivityLabels;dc.ULS.sendTraceTag(537163295,306,100,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after {0} ms on the {0} attempt.",
D,G);Jf.a.instance.create(function(){S.Mag(k,G+1,d)},D,$f.a.Wbh,!0,!0)}else dc.ULS.sendTraceTag(537163294,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the {0} attempt.  Not scheduling anymore retries.",G)},d,3)};A.prototype.XXc=function(k){k.Ss(this.V9a);k=k.PYi;0<k&&this.o0f(k)};A.prototype.o0f=function(k){var G=this.$.ea.af;G>this.zEd&&(this.zEd=G,this.aQd(1E3*k))};A.prototype.T$i=function(){var k=Xd.GetServiceTaskFactory.Ua(this.$.da,5,4,0);
ee.TaskExtensions.Ba(k,function(){var G=k.result;G&&G.IMa(56)&&G.removeEntry(56)},this.$.la,3)};A.ka=function(k){k.da.Ga(13,new A(k))};Ck.Object.defineProperties(A.prototype,{kic:{configurable:!0,enumerable:!0,get:function(){return!!this.TKa()||this.BCe()||this.Dmi()}},EOf:{configurable:!0,enumerable:!0,get:function(){return this.TVb}},vId:{configurable:!0,enumerable:!0,get:function(){return this.ivg}},confirmationRequired:{configurable:!0,enumerable:!0,get:function(){return this.$.wc.refreshConfirmationRequired}}});
Ck.Object.defineProperties(A,{ozi:{configurable:!0,enumerable:!0,get:function(){return A.MNc||(A.MNc=Zb.a.instance.Wa(8)+"<br /><br />"+Zb.a.instance.Wa(10))}}});A.MNc=null;Object(bb.a)(A,"DataRefreshManager",Gb.a,[12,424]);var Eh=ud.a;Am(C,Eh);C.prototype.Nd=function(){var k=this;ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(this.$.da,470,471,this.ub),function(G){k.Dd([G.result])},this.$.la,3)};C.ka=function(k){ud.a.he(472,new C(k))};Object(bb.a)(C,"PowerQueryManagerCommandHandlerFactory",ud.a,
[]);var rh=b(1086);v.prototype.bIg=function(k){this.Qa.addHandler("OnUpdatePowerQueryDataKeySucceeded",k)};v.prototype.fej=function(k){this.Qa.removeHandler("OnUpdatePowerQueryDataKeySucceeded",k)};v.prototype.u7a=function(k){if(this.G0.xb(k)){var G=this.G0.getItem(k);if(1!==G.FillObjectType&&!G.LoadedToDataModel&&(!ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6212633_BlockRefreshForQueriesWithoutConnection")||this.WF.xb(k)))return!0}else dc.ULS.sendTraceTag(537154446,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");
return!1};v.prototype.U9b=function(){var k=this,G=new Fe.a;this.$.userOperationManager.ic(new Id.a(587,0,function(d,S,P){return rh.b(k.$.na.va,Sd.b(d,k.RSj,k.HUi,function(){G.setResult(!0)}),Sd.a(S,k.IEb,k.GUi,function(){G.setResult(!0)}),P,null)},80,function(){return new Rd.a}),null);return G.task};v.prototype.CVg=function(k){if(this.WF.xb(k)){k=this.WF.getItem(k).ConnectionName;var G=qf.a(this.$).vId;if(G&&G.has(k))return dc.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),
k=G.get(k),Xe.j(this.$.na.va,k,null,null,null),!0;dc.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map")}return!1};v.prototype.AOf=function(k){ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5842290_HandlePowerQueryRefreshFailedErrors")&&!this.eVg(k)||!this.WF.xb(k)||(k=this.WF.getItem(k),qf.a(this.$).tbb(k.ConnectionName,k.ExternalSourceIndex,null))};v.prototype.handleQueryAction=function(k,G){var d=this;this.$.userOperationManager.ic(new Id.a(1023,
0,function(S,P,ja){return rh.c(d.$.na.va,k,G,S,P,ja,null)},68),null)};v.prototype.jd=function(){return!1};v.prototype.$c=function(){return!1};v.prototype.executeCommand=function(k,G){k=ee.TaskExtensions.Dl();return-1193102612===G.command?(this.$7i(),k):Sb.a(G.command)};v.prototype.Kc=function(k,G){switch(G.command){case -1193102612:return!0}return!1};v.prototype.dispose=function(){Ac.a.yc([this.Qa]);ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6242825_RegisterLoadOnDemandOccurredOnPQManager")&&(this.$.ea.Gv(this.If),
this.$.ea.AS(this.Io),this.$=null)};v.prototype.wAj=function(k,G){var d=He.a.gd(1,2,2156,0,0,k,"PowerQueryRefreshValidationFailed");switch(k){case -1543585732:d.MessageIdName="PowerQueryRefreshProtectedSheetFailed";d.Description=String.format(Zb.a.instance.Wa(695),G,Zb.a.instance.fa(2157));break;case 165156185:d.MessageIdName="PowerQueryRefreshSheetViewFailed";d.Description=String.format(Zb.a.instance.Wa(695),G,Zb.a.instance.fa(2158));break;default:dc.ULS.sendTraceTag(529069344,0,10,"PowerQueryManager.showEwaErrorDialog: unhandled error id {0}",
k)}ue.EwaSettings.Kz()?new ah.a(this.$,d):(k=new Of.ErrorDialog(this.$,d),k.initialize(),k.kf())};v.prototype.eVg=function(k){var G=this.G0.getItem(k);return G?(G=this.CPh(G))?(this.wAj(G,k),!1):!0:(dc.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)};v.prototype.CPh=function(k){if((k=this.bZh(k))&&k.tj)return-1543585732;if(k&&k.Yd.ty)return 165156185};v.prototype.bZh=function(k){var G=void 0,d=void 0;if(3===
k.FillObjectType||2===k.FillObjectType)G=k.FillObjectName.split("!")[0];else if(0==k.FillObjectType){if(!k.FillObjectName)return dc.ULS.sendTraceTag(523534751,0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),d;(k=this.$.Hb.getItemByName(k.FillObjectName))?G=k.sheetName:dc.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}G&&(d=this.$.xa.getItemByName(G));return d};v.prototype.$7i=
function(){var k=this;this.WGe?this.jOf(this.queries):this.U9b().continueWith(function(G){G.result?k.jOf(k.queries):dc.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fatch queries")})};v.prototype.jOf=function(k){k=Cl(k);for(var G=k.next();!G.done;G=k.next())G=G.value.Name,this.u7a(G)&&this.AOf(G)};Ck.Object.defineProperties(v.prototype,{Mli:{configurable:!0,enumerable:!0,get:function(){return this.S$d}},queries:{configurable:!0,enumerable:!0,get:function(){return this.G0.values}},
groups:{configurable:!0,enumerable:!0,get:function(){return this.tjb}},formulas:{configurable:!0,enumerable:!0,get:function(){return this.e8d}},WF:{configurable:!0,enumerable:!0,get:function(){return this.VPc}}});Object(bb.a)(v,"PowerQueryManager",null,[816,424,2]);var Fh=tc.a;Am(B,Fh);B.prototype.create=function(){this.Eb(this.$.da.Aa(470)||this.$.da.Ga(470,new v(this.$)))};B.ka=function(k){k.da.Ga(471,new B(k))};Object(bb.a)(B,"PowerQueryManagerFactory",tc.a,[]);var Rh;(function(k){k[k.null=-1]=
"null";k[k.table=0]="table";k[k.connectionOnly=1]="connectionOnly";k[k.pivotTable=2]="pivotTable";k[k.pivotChart=3]="pivotChart"})(Rh||(Rh={}));Object(bb.b)("FillObjectType",Rh);var se=b(276),kh=b(358),jg=b(110);Object(bb.a)(u,"GroupInfo",null,[]);Object(bb.a)(t,"PowerQueryTaskPaneCallbacks",null,[]);Object(bb.a)(x,"PowerQueryTaskPaneProps",null,[]);Object(bb.a)(r,"QueryInfo",null,[]);y.prototype.lG=function(k){var G=this;this.isVisible=!0;Bc.UISurfaces.Ok().then(function(d){d.showTaskPane("PowerQueryTaskPane",
G.Q3c(k));return null})};y.prototype.qx=function(k,G,d,S){var P=this;d=void 0===d?null:d;S=void 0===S?null:S;if(this.isVisible){var ja=this.Q3c(k,G,d,S);Bc.UISurfaces.Ok().then(function(D){D.updateTaskPane("PowerQueryTaskPane",ja||P.Q3c(k,G,d,S));return null})}else this.Oeg(G,d)};y.prototype.kN=function(){this.isVisible=!1;Bc.UISurfaces.Ok().then(function(k){k.hideTaskPane("PowerQueryTaskPane",2);return null})};y.prototype.N6f=function(k){if(!se.a.Gh(k)){for(var G=Cl(this.F0),d=G.next();!d.done;d=
G.next())d=d.value,Array.contains(k,d.name)&&(this.wbb.add(d.name,d),this.DId[d.name]=++this.lOf,dc.ULS.sendTraceTag(537154401,0,50,"Refresh started for query #: {0}",this.lOf));this.qx(null,null,null)}};y.prototype.r7f=function(k){if(!se.a.Gh(k)){for(var G=Cl(this.F0),d=G.next();!d.done;d=G.next())d=d.value,Array.contains(k,d.name)&&(d.name in this.DId&&dc.ULS.sendTraceTag(537154400,0,50,"Refresh stoped for query #: {0}",this.DId[d.name]),this.wbb.remove(d.name));this.qx(null,null,null)}};y.prototype.Oeg=
function(k,G){k=void 0===k?null:k;G=void 0===G?null:G;ue.EwaSettings.Jgf()&&G&&G.length&&k?(this.pK.clear(),this.fwa.clear(),this.k5a.clear(),this.F0=[],this.l5a=[],this.J0i(G),this.R0i(k),this.l5a=this.l4c("root",-1).children,this.l5a=this.l5a.concat(this.l4c("Other Queries",0))):k&&(this.pK.clear(),this.fwa.clear(),this.k5a.clear(),this.l5a=this.F0=null,this.F0=this.EFe(k,0));this.S0i()};y.prototype.Q3c=function(k,G,d,S){var P=this;S=void 0===S?null:S;this.Oeg(void 0===G?null:G,void 0===d?null:
d);G=Object(Mb.a)(new t,{onQuerySelected:Object(Nd.a)(this.jda,this.jda.onQuerySelected,"onQuerySelected"),onQueryRefresh:Object(Nd.a)(this.jda,this.jda.onQueryRefresh,"onQueryRefresh"),onCancelQueryRefresh:this.jda.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,handleQueryAction:this.handleQueryAction});S=Object(Mb.a)(new x,{type:"PowerQueryTaskPaneProps",callbacks:G,queries:this.F0,groups:this.l5a,selectedQueryKey:S});if(Se.a.Ld(this.$))return Object(Mb.a)(new wd.a,
{contentProps:S,onOpen:function(){P.jda.Ey()},onClose:function(){P.jda.GB()},width:320,title:Zb.a.instance.fa(2148)});k=Object(Mb.a)(new Pe.a,{container:k,paneProps:S});return Object(Mb.a)(new wd.a,{contentProps:k,onOpen:function(){P.jda.Ey()}})};y.prototype.S0i=function(){if(this.F0)for(var k=0;k<this.F0.length;k++){var G=!1,d=this.F0[k],S=this.wbb.getItem(d.name);null!=S&&(G=new Date(d.lastRefresh),(G=(new Date(S.lastRefresh)).getTime()===G.getTime())||this.wbb.remove(S.name));d.inRefresh=G;d.refreshEnabled=
this.jda.WF.xb(d.name)}};y.prototype.J0i=function(k){k=Cl(k);for(var G=k.next();!G.done;G=k.next()){G=G.value;var d=G.HasParent?G.ParentId:"root";this.fwa.add(G.Id,G);this.qre(G,d)}k={};k.Name=Zb.a.instance.fa(2151);k.Id="Other Queries";k.Order=kh.a.wT;this.fwa.add("Other Queries",k);this.fwa.add("root",{Name:"root",Id:"root",Order:0})};y.prototype.R0i=function(k){k=Cl(k);for(var G=k.next();!G.done;G=k.next()){var d=G.value;G=d.GroupID||"Other Queries";var S=this.pK.getItem(G);if("Other Queries"!==
G&&S&&S.length){S="SubGroupOtherQueries-"+G;if(!this.fwa.xb(S)){var P={Name:S,Id:S};P.Order=kh.a.wT;this.fwa.add(S,P);this.qre(P,G)}G=S;d.GroupID=S}d=[d];this.k5a.xb(G)&&(d=d.concat(this.k5a.getItem(G)));this.k5a.add(G,d)}};y.prototype.qre=function(k,G){k=[k];this.pK.xb(G)&&(k=k.concat(this.pK.getItem(G)));this.pK.add(G,k)};y.prototype.w7g=function(k,G){var d=[];if(this.pK.xb(k)){k=this.pK.getItem(k);k.sort(function(P,ja){return ne.HelperMethods.gD(P.Order,ja.Order)});k=Cl(k);for(var S=k.next();!S.done;S=
k.next())d=d.concat(this.l4c(S.value.Id,G+1))}return d};y.prototype.l4c=function(k,G){var d=this.fwa.getItem(k),S=this.k5a.getItem(k),P=Object(Mb.a)(new u,{});P.key=d.Id;P.name=d.Name;P.data=d.Description;d=this.w7g(k,G);P.children=this.nAe(d);P.level=G;P.count=0;P.children.length&&(P.startIndex=P.children[0].startIndex,P.count+=jg.g(P.children,function(ja){return ja.count}));S&&(P.startIndex=this.F0.length,P.count+=S.length,this.F0=this.F0.concat(this.EFe(S,k.includes("SubGroupOtherQueries-")?G:
G+1)));return P};y.prototype.EFe=function(k,G){var d=[];k=Cl(k);for(var S=k.next();!S.done;S=k.next())S=S.value,S=this.wbb.xb(S.Name)&&!ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")?this.wbb.getItem(S.Name):this.J9g(S,G),d.push(S);return d};y.prototype.J9g=function(k,G){var d=new r;d.name=k.Name;d.rowsLoaded=k.RowsLoaded;d.lastRefresh=k.LastRefresh;d.fillObjectType=k.FillObjectType;d.loadedToDataModel=k.LoadedToDataModel;d.queryError=k.QueryError;
d.nestingDepth=G;d.rowsWithError=k.RowsWithError;d.groupKey=k.GroupID;return d};y.prototype.nAe=function(k){var G=[];k=Cl(k);for(var d=k.next();!d.done;d=k.next()){d=d.value;var S=Object(Mb.a)(new u,{});S.key=d.key;S.name=d.name;S.count=d.count;S.startIndex=d.startIndex;S.data=d.data;S.children=this.nAe(d.children);S.level=d.level;G.push(S)}return G};Object(bb.a)(y,"PowerQueryReactTaskPane",null,[844]);h.prototype.Xuj=function(k){this.tjb=k};h.prototype.LBj=function(){var k=this;if(Se.a.Ld(this.$))this.showTaskPane();
else if(this.powerQueryTaskPane||this.BIf)this.powerQueryTaskPane&&(this.powerQueryTaskPane.jg(!0),this.showTaskPane());else{this.BIf=!0;var G=Xd.GetServiceTaskFactory.Ua(this.$.da,408,409,0),d=Vc.a(this.$);ee.TaskExtensions.Ba(ee.TaskExtensions.xe([G,d],this.$.la),function(){k.powerQueryTaskPane=G.result;d.result.vR(k.powerQueryTaskPane);k.S6();k.powerQueryTaskPane.jg(!0);k.showTaskPane()},this.$.la,3)}};h.prototype.onQuerySelected=function(k){if(ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected"))for(var G=
Cl(this.queries),d=G.next();!d.done;d=G.next())if(d=d.value,d.FillObjectName&&d.Name===k){3!==d.FillObjectType&&2!==d.FillObjectType||df.a.contains(d.FillObjectName,"!",!0)||dc.ULS.sendTraceTag(537154438,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection Query of type : {0} and no ! on FillObjectName",Rh[d.FillObjectType]);3===d.FillObjectType?(k=d.PivotChartSheetRange,k.SheetName=d.FillObjectName.split("!")[0],G=d.FillObjectName.split("!")[1],Sc.g(this.$).ha.Oa.cta(k,G,0).continueWith(function(S){S.result||
dc.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(k=2===d.FillObjectType?d.FillObjectName.split("!")[1]:d.FillObjectName,(k=this.$.Hb.getItemByName(k))&&k.activate());break}};h.prototype.Ybi=function(k){this.Qma=new y(k,this)};h.prototype.S6=function(){this.Gqc=this.powerQueryTaskPane.LM();this.powerQueryTaskPane.wM(this.cFb)};h.prototype.dispose=function(){this.$.ea.Gv(this.If);qf.a(this.$).DRf(this.Aoc);qf.a(this.$).ERf(this.qCf);this.Pma&&
this.powerQueryManager.fej(this.Tyf);this.$=null;this.hideTaskPane();this.powerQueryTaskPane&&(this.powerQueryTaskPane.uO(this.cFb),this.powerQueryTaskPane=this.Gqc=null);this.Qma=null};h.prototype.Ey=function(){this.Pma?this.powerQueryManager.U9b():this.eYf();ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected")&&this.$.Hb.zg(this.He);Se.a.Ld(this.$)||ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5159002_FixPowerQueryPaneFocusOnOpen")||this.powerQueryTaskPane.Wf(!0,
!1)};h.prototype.GB=function(){this.yf=!1};h.prototype.onQueryRefresh=function(k){this.Pma?this.powerQueryManager.AOf(k):this.WF.xb(k)&&(k=this.WF.getItem(k),qf.a(this.$).tbb(k.ConnectionName,k.ExternalSourceIndex,null))};h.prototype.handleQueryGroupOperation=function(k,G){var d=this;Cd.a(this.$.userOperationManager,function(S,P,ja){return rh.a(d.$.na.va,k,G,S,P,ja,null)},function(S){return new Id.a(1021,0,S)},null)};h.prototype.showTaskPane=function(){this.yf||(ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5252502_AddHealthMetricsForPQTP")&&
(this.hAc=this.$.Ob.Hc("UserAction","PowerQueryTaskPaneInitialLoadTime")),this.yf=!0,this.Qma.lG(this.Gqc))};h.prototype.updateTaskPane=function(k,G,d){this.Qma.qx(this.Gqc,k,G,d);this.hAc&&ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5252502_AddHealthMetricsForPQTP")&&(this.hAc.stop(),this.hAc=null);for(k=0;k<this.queries.length;k++)G=this.queries[k],0===G.FillObjectType&&this.TVd.add(G.FillObjectName,G.Name),G.LastRefresh||dc.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")};
h.prototype.hideTaskPane=function(){this.yf=!1;this.Qma.kN()};h.prototype.eYf=function(){function k(){return new Rd.a}function G(S,P,ja){return rh.b(d.$.na.va,Sd.b(S,d.vBd),Sd.a(P,d.IEb),ja,null)}var d=this;ue.EwaSettings.qc()?this.$.userOperationManager.ic(new Id.a(587,0,G,80,k),null):this.$.userOperationManager.ic(new uf.a(587,0,G,16,k),null)};h.prototype.Syf=function(){this.updateTaskPane(this.queries,this.groups,null);this.tGf||(this.FPi(qf.a(this.$).EOf),this.tGf=!0)};h.prototype.FPi=function(k){var G=
[];k=Cl(k);for(var d=k.next();!d.done;d=k.next()){d=d.value;for(var S=Cl(this.WF.values),P=S.next();!P.done;P=S.next())if(P=P.value,d===P.ConnectionName&&(P=P.QueryName,this.u7a(P))){Array.add(G,P);break}}this.Qma.N6f(G)};h.prototype.u7a=function(k){if(this.Pma)return this.powerQueryManager.u7a(k);if(this.G0.xb(k)){if(k=this.G0.getItem(k),1!==k.FillObjectType&&!k.LoadedToDataModel)return!0}else dc.ULS.sendTraceTag(537154402,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");return!1};
Ck.Object.defineProperties(h.prototype,{queries:{configurable:!0,enumerable:!0,get:function(){return this.Pma?this.powerQueryManager.queries:this.G0.values}},groups:{configurable:!0,enumerable:!0,get:function(){return this.Pma?this.powerQueryManager.groups:this.tjb}},WF:{configurable:!0,enumerable:!0,get:function(){return this.Pma?this.powerQueryManager.WF:this.VPc}}});Object(bb.a)(h,"PowerQueryPaneManager",null,[827]);w.prototype.jd=function(){return!1};w.prototype.$c=function(){return!1};w.prototype.executeCommand=
function(k,G){this.Hqc||(this.Hqc=new h(this.$,this.e0i));k=ee.TaskExtensions.Dl();return 1156885807===G.command?(this.Hqc.LBj(),k):Sb.a(G.command)};w.prototype.dispose=function(){this.$=this.Hqc=null};w.prototype.Kc=function(k,G){k=!1;switch(G.command){case 1156885807:k=ue.EwaSettings.isChangeGateEnabled("OfficeVSO:6320032_PowerQueryTaskPane")}return k};Object(bb.a)(w,"PowerQueryPaneCommandHandler",null,[424,2]);var oh=ud.a;Am(n,oh);n.prototype.Nd=function(){var k=this;this.$.WC(function(){ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?
ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(k.$.da,470,471,1),function(G){k.Dd([new w(k.$,G.result)])},k.$.la,3):k.Dd([new w(k.$,null)])})};n.ka=function(k){ud.a.he(407,new n(k))};Object(bb.a)(n,"PowerQueryPaneCommandHandlerFactory",ud.a,[]);var Mi=b(141);m.msh="ewa-pqtp-pane";m.lsh="ewa-pqtp-header";m.nsh="ewa-pqtp-title";m.jsh="ewa-pqtp-body";m.ksh="ewa-pqtp-close-button";Object(bb.a)(m,"CssClassNames",null,[]);var Nh=m.msh,Zg=m.lsh,Df=m.jsh,Ff=m.nsh,zh=de.a.Geb+m.ksh,og=fc.a;Am(f,og);f.prototype.ZP=
function(k){this.get_events().addHandler("PQTPR",k)};f.prototype.BS=function(k){this.get_events().removeHandler("PQTPR",k)};f.prototype.wM=function(k){this.addHandler("PQTPC",k)};f.prototype.uO=function(k){this.removeHandler("PQTPC",k)};f.prototype.UH=function(){};f.prototype.vp=function(){return this.Np};f.prototype.ns=function(){return this.Np};f.prototype.oS=function(){};f.prototype.rR=function(){return!1};f.prototype.Ej=function(){};f.prototype.Rj=function(){};f.prototype.dispose=function(){this.$&&
this.$.sm(this.Zc);this.te&&(fd.a.instance.za(rc.a.click,this.te,this.ak),Af.KeyInputManager.instance.Uv(this.te,this.DAe));this.te=this.taskPaneManager=this.$=null;og.prototype.dispose.call(this)};f.prototype.Wf=function(k,G){G||(k=dd.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),k||(k=this.te),dd.DOMElementExtensions.setFocus(k));return!G};f.prototype.sh=function(k){return dd.DOMElementExtensions.Gf(this.uc,k)};f.prototype.jg=function(k){this.Np=k;var G=this.taskPaneManager;
this.isVisible=k;this.taskPaneManager.px();k&&0<G.fA.length&&(!G.Ig||17!==G.Ig.taskPane.eh||G.isCollapsed)&&G.CD(this,!0)};f.prototype.LM=function(){var k=document.getElementById(this.$.Lb+de.a.kFd);k.setAttribute(Mi.a.ariaLabel,Zb.a.instance.fa(2148));var G=this.jH();k.appendChild(G);G=Xb.b("div","PowerQueryPaneBodyId",Df);k.appendChild(G);return G};f.prototype.jH=function(){var k=Xb.b("div","PowerQueryPaneHeaderId",Zg),G=Xb.b("span","PowerQueryPaneTitleId",Ff);G.innerText=this.titleText;this.te=
Ge.a.Bb("PowerQueryPaneCloseButtonId",zh,Zb.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.te.classList.add(jf.AFrameworkApplication.isRtl?de.a.Yaa:de.a.Zaa);fd.a.instance.pa(rc.a.click,this.te,this.ak);this.DAe=Af.KeyInputManager.instance.zs(this.te,this.ak,Ef.a.ei);k.appendChild(G);k.appendChild(this.te);return k};f.ka=function(k,G){var d=k.Lb,S=document.getElementById(d+de.a.kFd);S||(S=document.createElement("div"),S.id=k.Lb+de.a.kFd,Se.a.Ld(k)||document.getElementById(d+de.a.iS).appendChild(S));
S.classList.add(Nh);d=k.da;return d.Aa(408)||d.Ga(408,new f(S,k,G))};Ck.Object.defineProperties(f.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Xc.a)(f.prototype,this,"isVisible")},set:function(k){Object(Xc.a)(f.prototype,this,"isVisible")!==k&&Object(Xc.b)(f.prototype,this,"isVisible",k)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},ve:{configurable:!0,enumerable:!0,get:function(){return Re.a.d0i}},eh:{configurable:!0,enumerable:!0,
get:function(){return 17}},Qk:{configurable:!0,enumerable:!0,get:function(){return Qc.a.Nvh}},lN:{configurable:!0,enumerable:!0,get:function(){return Zb.a.instance.fa(2148)}},titleText:{configurable:!0,enumerable:!0,get:function(){return Zb.a.instance.fa(2148)}},Do:{configurable:!0,enumerable:!0,get:function(){return 320}},uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.aP.offsetHeight}},isResizable:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(bb.a)(f,"PowerQueryTaskPane",fc.a,[780,2,548,438]);var vh=tc.a;Am(e,vh);e.prototype.create=function(){var k=this,G=Xd.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ub),d=Xd.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub);ee.TaskExtensions.Ba(ee.TaskExtensions.ts(ee.TaskExtensions.xe([G,d],this.la),function(){return k.qD},this.la),function(){k.Eb(k.lh)},this.la,3)};e.prototype.dispose=function(){this.lh=this.wi=this.$=null;vh.prototype.dispose.call(this)};
e.ka=function(k){k.da.Ga(409,new e(k))};Ck.Object.defineProperties(e.prototype,{qD:{configurable:!0,enumerable:!0,get:function(){var k=this;this.wi||(this.wi=ee.TaskExtensions.Ba(Vc.a(this.$),function(G){k.lh=f.ka(k.$,G.result)},this.la,3));return this.wi}}});Object(bb.a)(e,"PowerQueryTaskPaneFactory",tc.a,[]);c.prototype.getExpandedRangeForPivotTable=function(k,G,d,S,P,ja,D,da){da=k.Na(1,void 0===da?null:da);da.sheetRange=G;da.activeCell=d;return Xe.i(k,"GetExpandedRangeForPivotTable",da,S,P,ja,
D,0)};Object(bb.a)(c,"ExpandRange",null,[779]);var ij=tc.a;Am(a,ij);a.ka=function(k){k.da.Ga(483,new a(k))};a.prototype.create=function(){var k;this.Eb(null!==(k=this.$.da.Aa(482))&&void 0!==k?k:this.$.da.Ga(482,new c))};Object(bb.a)(a,"ExpandRangeFactory",tc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");
Ca.a.Li(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");Ca.a.Li('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
Ca.a.Li('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(function(){ae.a.Fa(function(k){ee.TaskExtensions.Ba(Xd.GetServiceTaskFactory.Ua(k.da,12,477,1),function(G){Cb.ka(k,G.result)},k.la)})})();(function(){ae.a.Fa(function(k){cc.ka(k);La.ka(k);Va.ka(k)})})();ae.a.Fa(ob.ka);(function(){ae.a.Fa(function(k){ra.ka(k)})})();ae.a.Fa(wa.OGa);ae.a.Fa(Aa.ka);(function(){ae.a.Fa(function(k){xa.ka(k);Z.ka(k);H.ka(k)})})();(function(){ae.a.Fa(function(k){A.ka(k);ea.ka(k)})})();(function(){ae.a.Fa(function(k){n.ka(k);C.ka(k);e.ka(k);B.ka(k)})})();(function(){ae.a.Fa(function(k){a.ka(k)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.bi.js.map/8a2fe0908a9249acd7b35e8b51c53ddc/EwaDS.bi.js.map