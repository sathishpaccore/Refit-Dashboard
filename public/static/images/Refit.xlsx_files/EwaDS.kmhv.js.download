(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1044:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);var c=b(14),e=b(4),f=b(39),m=b(24);a.WXe=function(n,w){switch(n){case 3:return a.z1h(w);case 2:return a.vVh(w);case 1:return a.FPh(w)}return""};a.z1h=function(n){switch(n){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString()}return""};
a.vVh=function(n){switch(n){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.FPh=function(n){switch(n){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(n,w,h){if(m.a.Fh||m.a.qp)window.setTimeout(function(){a.cOf(h,
a.adc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.kre(h),n,0,!1)};a.wZg=function(n,w,h,y){w&&y&&y();a.openInClient(n,w,h)};a.adc=function(){return m.a.Fh?1:m.a.qp?2:m.a.e8a?3:m.a.isMac?4:0};a.v1h=function(n){switch(n){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.w1h=function(n){switch(n){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";
default:return""}};a.cOf=function(n,w){1===w?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),n=a.WXe(n,w),8<m.a.U5a?f.a.rf(n,void 0,void 0,"RedirectToAppStore"):f.a.MV(n)):document.hidden||(a.Tzb?(n=e.AFrameworkApplication.ga.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.MV(n)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),
MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.WXe(n,w),null,null)))};a.kre=function(n){switch(n){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.Vdd=function(n){switch(n){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.eqd=function(n){return(n=a.ASh(n))&&""!==n?Boolean.parse(n):!1};a.vQd=function(n){a.Krj(n)};a.ASh=function(n){try{return localStorage.getItem(n)}catch(w){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+w.message),null}};a.Krj=function(n){try{localStorage.setItem(n,"true")}catch(w){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+w.message)}};Ck.Object.defineProperties(a,{Tzb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},$xc:{configurable:!0,enumerable:!0,get:function(){return(m.a.e8a||m.a.isMac)&&m.a.rp}},Yyj:{configurable:!0,enumerable:!0,
get:function(){return m.a.Fh||m.a.qp}}});a.nze="ChromeExtensionBarDismiss";Object(z.a)(a,"WildFireUtilities",null,[])},1153:function(z,E,b){function a(u,B){var v=this;this.qd=function(){w.a.xg(y.a(v.$).rd.activityState,t.a.$zd)||v.Taa.reset()};this.$=B;this.Zkc=u;this.ea=B.ea;this.ea.gk(this.qd);this.Taa=x.a.wte(this.$)}function c(u){var B=this;this.kj=this.iEc=null;this._state=0;this.moveNext=function(){try{for(B._state=1;1===B._state;)B.Ru=B.Ru()}catch(v){B.dispose(),B._state=3}};this.Cf=u;this.Ru=
this.ZL;this.moveNext()}b.r(E);z=b(0);var e=b(14),f=b(36),m=b(212),n=b(119),w=b(35),h=b(1),y=b(66),r=b(55);c.prototype.ZL=function(){this.iEc=this.Cf.$.Ob.Hc("LoadResource","DownloadACopyOperation");return this.f1d};c.prototype.f1d=function(){var u=b(1153).DownloadACopyOperation;if(this.Cf.Taa.w$e||!(this.iEc.zc<u.tlc))return this.eig;this.kj=r.Task.delay(u.wKe).g();this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext));return this.sgb};c.prototype.eig=function(){var u=b(1153).DownloadACopyOperation;
this.iEc.zc>=u.tlc&&e.ULS.sendTraceTag(537154819,0,15,"Download did not complete after 10 seconds.");y.a(this.Cf.$).rd.OJ();this._state=3};c.prototype.sgb=function(){this.kj.Dz();return this.f1d};c.prototype.dispose=function(){};Object(z.a)(c,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[2]);var x=b(1247),t=b(146);b.d(E,"DownloadACopyOperation",function(){return a});a.prototype.tih=function(){var u=this,B=this.MSg(this.$),v=this.$.userOperationManager.operationCount;
0<v&&e.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is {0}",v);this.$.userOperationManager.R4("DownloadACopyOperation.DownloadForkedFile");this.Zkc&&e.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.Taa.downloadFile(B,-21742208);h.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?f.TaskExtensions.Ba(r.Task.delay(1),function(){u.v$e()},this.Taa.la,3):f.TaskExtensions.Ba(r.Task.delay(1),
function(){u.n9h()},this.Taa.la,3)};a.prototype.dispose=function(){this.ea&&this.ea.Fk(this.qd);this.$=this.ea=null};a.prototype.v$e=function(u){var B=this;(u=void 0===u?null:u)||(u=this.$.Ob.Hc("LoadResource","DownloadACopyOperation"));!this.Taa.w$e&&u.zc<a.tlc?window.setTimeout(function(){B.v$e(u)},a.wKe):(u.zc>=a.tlc&&e.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),y.a(this.$).rd.OJ())};a.prototype.n9h=function(){new c(this)};a.prototype.MSg=function(u){var B=new Sys.StringBuilder,
v=u.workbookContext,C=u.ya;B.append(u.hea);B.append(C.FileHandlerRelativeUri);B.append("?id=");B.append(encodeURIComponent(m.a.gIb(v.WorkbookUri,"sc")));u.ea.sc&&(B.append("&sessionId="),B.append(encodeURIComponent(u.ea.sessionId)));B.append("&workbookType=FullForkedWorkbook");B.append("&dataloss=");B.append(this.Zkc?"true":"false");n.a.HZa(B,C);return B.toString()};a.tlc=1E5;a.wKe=100;Object(z.a)(a,"DownloadACopyOperation",null,[2])},1239:function(z,E,b){function a(n,w){n=m.call(this,n,w)||this;
c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");n.title="";n.message=a.iya;n.lwa=!0;return n}b.d(E,"a",function(){return a});z=b(0);var c=b(14),e=b(39),f=b(80);b=b(917);var m=b.a;Am(a,m);a.prototype.yma=function(n){m.prototype.yma.call(this,n);e.a.openWindow(4,f.a.EH(a.hpf))};a.prototype.iD=function(n){m.prototype.iD.call(this,n);a.ewd&&a.ewd(null)};a.initialize=function(n,w,h,y){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
a.iya=n;a.ipf=w;a.hpf=h;a.ewd=y};Ck.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.ipf}}});a.iya=null;a.ipf=null;a.hpf=null;a.ewd=null;Object(z.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1240:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.jnh="ewa-bb";a.lnh="ewa-bb-entry";a.mnh="ewa-bb-entry-body";a.snh="ewa-bb-icon";a.onh="ewa-bb-entry-icon";a.rnh="ewa-bb-entry-title";a.qnh="ewa-bb-entry-message";a.BNe="ewa-bb-entry-button";
a.pnh="ewa-bb-entry-link";a.nnh="ewa-bb-entry-close";a.CNe="ewa-bb-entry-button-holder";a.knh="ewa-bb-content";Object(z.a)(a,"CssClassNames",null,[])},1241:function(z,E,b){function a(e,f){e=c.call(this,e,f)||this;e.qv=!0;e.title=a.ypa;e.message=a.wpa;return e}b.d(E,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);(e=a.xpa)&&e(null)};a.initialize=function(e,f,m,n){a.ypa=e;a.wpa=f;a.vpa=m;a.xpa=n};Ck.Object.defineProperties(a.prototype,
{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.vpa}}});a.ypa=null;a.wpa=null;a.vpa=null;a.xpa=null;Object(z.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1242:function(z,E,b){function a(e,f){e=c.call(this,e,f)||this;e.qv=!0;e.title=a.ypa;e.message=a.wpa;return e}b.d(E,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);(e=a.xpa)&&e(null)};a.initialize=function(e,f,m,n){a.ypa=e;a.wpa=f;a.vpa=m;a.xpa=n};
Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.vpa}}});a.ypa=null;a.wpa=null;a.vpa=null;a.xpa=null;Object(z.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1243:function(z,E,b){function a(e,f){e=c.call(this,e,f)||this;e.qv=!0;e.title=a.ypa;e.message=a.wpa;return e}b.d(E,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);(e=a.xpa)&&e(null)};a.initialize=function(e,
f,m,n){a.ypa=e;a.wpa=f;a.vpa=m;a.xpa=n};Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.vpa}}});a.ypa=null;a.wpa=null;a.vpa=null;a.xpa=null;Object(z.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1244:function(z,E,b){function a(e,f){e=c.call(this,e,f)||this;e.qv=!0;e.title=a.KCb;e.message=a.iya;return e}b.d(E,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);a.kya&&
a.kya(null)};a.initialize=function(e,f,m,n){a.KCb=e;a.iya=f;a.U8a=m;a.kya=n};Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.U8a}}});a.KCb=null;a.iya=null;a.U8a=null;a.kya=null;Object(z.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1245:function(z,E,b){function a(e,f){e=c.call(this,e,f)||this;a.U8a&&a.kya&&(e.qv=!0);e.title=a.KCb;e.message=a.iya;return e}b.d(E,"a",function(){return a});z=b(0);b=b(917);var c=b.a;
Am(a,c);a.prototype.Fo=function(e){c.prototype.Fo.call(this,e);a.kya&&a.kya(null)};a.initialize=function(e,f,m,n){a.KCb=e;a.iya=f;a.U8a=m;a.kya=n};Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.U8a}}});a.KCb=null;a.iya=null;a.U8a=null;a.kya=null;Object(z.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1246:function(z,E,b){function a(n,w,h,y,r,x){this.EY=n;this.FY=w;this.HKc=h;this.XD=y;this.kSb=r;this.pVa=x}b.d(E,"a",
function(){return a});z=b(0);var c=b(1300),e=b(4),f=b(52),m=b(85);a.prototype.c6i=function(n){this.ouf(n)};a.prototype.Ssi=function(n){this.ouf(n)};a.prototype.ouf=function(n){var w=10;1===n?(m.a.instance.resolve("Common.IOfficeTrialExperience").Zjc(this.pVa),w=3):2===n&&((!this.HKc||this.HKc(this.XD))&&this.FY&&c.a.instance.R8g(this.FY,this.EY,this.XD),w=5);(0===n||1===n)&&this.EY&&this.EY(this.XD);e.AFrameworkApplication.Stc(f.a.NFf,this.kSb,w);this.dispose()};a.prototype.dispose=function(){this.XD=
this.FY=this.EY=null};Ck.Object.defineProperties(a.prototype,{p4f:{configurable:!0,enumerable:!0,get:function(){return!this.FY&&!this.HKc}},Ttf:{configurable:!0,enumerable:!0,get:function(){return 2===this.pVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},eNe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},i$e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},pwa:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},U8e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},pYb:{configurable:!0,enumerable:!0,get:function(){return 2===this.pVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},Im:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(z.a)(a,"AOICErrorDialogWithTrial",null,[2])},1247:function(z,E,b){function a(x,t){var u=r.call(this,x)||this;u.SUj=["id","sessionId","workbookType","workbookFileType","dataloss"];u.command=0;u.HEb=function(){var B=u.DPh();if(B){u.$.vI(!0);if(-2028960985!==u.command&&1461300262!==u.command){var v=h.a(u.$).rd.activityState;v[w.a.TYa]=n.a.download;v[y.a.AUc]=u.command}m.a(u.$).Bs(B.Errors)}};u.iframe=x;u.$=t;u.Fc.ka("load",u.HEb);return u}b.d(E,"a",function(){return a});z=b(0);var c=b(14),e=b(39);
E=b(242);var f=b(212),m=b(43),n=b(6),w=b(34),h=b(66),y=b(650),r=E.a;Am(a,r);a.prototype.downloadFile=function(x,t){var u={};(x=this.Tzh(x,u))&&e.a.Dqc("dlfr",x,u);this.command=t};a.prototype.Tzh=function(x,t){var u=x.split("?");if(2!==u.length)return x=null,c.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),x;u=u[1].split("&");u=Cl(u);for(var B=u.next();!B.done;B=u.next()){var v=B.value.split("=",2);if(2!==v.length){x=null;c.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}B=v[0];Array.contains(this.SUj,B)&&(v=decodeURIComponent(v[1]),t[B]=v,x=f.a.gIb(x,B))}return x};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.DPh=function(){try{return this.iframe.contentWindow.ewaResult}catch(t){if(!this.$.ea.wc.isDivSyndicated){var x=window.document.referrer.match(RegExp("://(.[^/]+)/"));c.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<x.length?x[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.$wa);throw t;}return null}};a.wte=function(x){var t=document.createElement("iframe");t.id="ewaFileLoader";t.style.cssText="height:0;width:0;display:none";t.src="about:blank";t.setAttribute("name","dlfr");t=x.domElement.appendChild(t);return new a(t,x)};Ck.Object.defineProperties(a.prototype,
{w$e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(z.a)(a,"FileLoader",E.a,[])},1248:function(z,E,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(E,"a",function(){return a});z=b(0);var c=b(1400),e=b(4),f=b(41),m=b(80);a.prototype.NOd=function(){return f.c([this.gba(),this])};a.prototype.execute=function(n,w,h){var y="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(y=m.a.Gl(y,"wdEnableRoaming","1"));e.AFrameworkApplication.Jd.hm(y,2,this.NOd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.J4a(),n,w,h,void 0,void 0,void 0,void 0,"6")};Object(z.a)(a,"ARoamingAppsRequest",null,[])},1252:function(z,E,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(E,"a",function(){return a});z=b(0);Object(z.a)(a,"PrintPreviewPaneProps",null,[])},1253:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.D1i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.Q8b="ewa-dlg-elements-container-rtl";a.E1i="PrintDialogLeftContainer";a.F1i="PrintDialogRightContainer";a.Lab="PrintDialogRadioButtonContainer";a.LJf="PrintRadioButtonElementInnerDiv";a.L1i="PrintRadioButtonElementOuterDiv";a.Mab="PrintDialogTitleSection";
a.iGd="PrintDialogComboBoxContainer";a.M1i="PrintRadioButtonIcon";a.C1i="PrintButtonArea";a.ax="PrintPreviewerContainer";Object(z.a)(a,"CssClassNames",null,[])},1292:function(z,E,b){function a(Fb,hc){var cd=Cc.call(this,hc)||this;cd.OEh=H.DOMElementExtensions.sr+",div";cd.gV=Array(66);cd.Cm=!1;cd.QW=function(mb){if(mb.Ca.keyCode===R.a.QD){var $a=cd.uc.querySelectorAll(cd.OEh),K=H.DOMElementExtensions.Lm($a);$a=H.DOMElementExtensions.oB($a);return H.DOMElementExtensions.Ona(mb.Ca,K,$a)}return!1};cd.wb=
Fb;cd.set_visible(!1);cd.addCssClass(U.a.jnh);Q.KeyInputManager.instance.pa(ea.a.Xb,cd.uc,cd.QW);aa.a(Fb).ai(cd);return cd}function c(Fb,hc,cd,mb,$a,K){var ba=M.call(this,Fb,hc,cd)||this;xb.a.instance.create(function(){if(ba.businessBar&&ba.businessBar.IMa(hc.aHa)){var ua=new xa.a(-847286761,0,ba.businessBar.$.fd,0,null),La={};La=(La.CalloutName=mb,La.Target=ba.xT.domElement,La);ba.businessBar.$.Ka.$b(ua,La)}},$a,K,!0,!0);return ba}function e(Fb,hc,cd,mb){Fb=Yb.call(this,Fb,hc)||this;Fb.automateCommandManager=
cd.da.Aa(352);T.ULS.shipAssertTag(526787654,0,!!Fb.automateCommandManager);Fb.id=ec.a.create();Fb.$=cd;Fb.title=wa.a.instance.fa(2223);Fb.message="";Fb.QUd=wa.a.instance.fa(2219);Fb.UWj=wa.a.instance.fa(2220);Fb.vgg=wa.a.instance.fa(2221);Fb.t2g=wa.a.instance.fa(2222);Fb.update(mb);return Fb}function f(Fb,hc){Fb=ib.call(this,Fb,hc)||this;Fb.ACa=eb.a.p5b();Fb.qv=!0;Fb.n_=Fb.ACa.bVj;Fb.title=Fb.ACa.title;Fb.message=Fb.ACa.message;return Fb}function m(Fb,hc){Fb=pc.call(this,Fb,hc)||this;Fb.qv=!0;Fb.title=
"";return Fb}function n(Fb,hc){hc=wb.call(this,Fb,hc)||this;hc.policyManager=Fb.$.da.Aa(274);if(!hc.policyManager)return T.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),hc;hc.message=hc.policyManager.qqc;hc.title=hc.policyManager.title;hc.lwa=!0;return hc}function w(Fb,hc){Fb=gb.call(this,Fb,hc)||this;Fb.qv=!0;Fb.n_=!0;return Fb}function h(Fb,hc,cd,mb){Fb=Na.call(this,Fb,hc)||this;Fb.Kxb=cd;Fb.command=mb;Fb.lwa=!0;Fb.qv=
1461300262!==mb;return Fb}function y(Fb,hc,cd){Fb=ta.call(this,Fb,hc)||this;Fb.Kxb=cd;Fb.lwa=!0;return Fb}function r(Fb,hc,cd){Fb=ac.call(this,Fb,hc)||this;Fb.Kxb=cd;Fb.qv=!0;return Fb}function x(Fb,hc){Fb=db.call(this,Fb,hc)||this;Fb.qv=!0;Fb.n_=!1;return Fb}function t(Fb,hc){Fb=sb.call(this,Fb,hc)||this;Fb.qv=!0;Fb.n_=!0;return Fb}function u(Fb,hc,cd,mb,$a,K,ba,ua){return B.call(this,Fb,0,hc,cd,mb,$a,K,ba,ua)||this}function B(Fb,hc,cd,mb,$a,K,ba,ua,La){this.qJ=this.S8=this.xT=0;this.smg=Fb;this.TKj=
hc;this.LP=cd;this.Hqg=ba;this.vjb=I.a.sw(La);this.Jog=La;this.xmg=ua;0!==mb&&(this.xT=mb);0!==$a&&(this.S8=$a);0!==K&&(this.qJ=K)}function v(Fb,hc,cd,mb,$a){Fb=C.call(this,Fb,hc,cd,mb)||this;Fb.command=$a;Fb.n_=!0;return Fb}function C(Fb,hc,cd,mb){Fb=qa.call(this,Fb,hc)||this;Fb.error=cd;Fb.options=mb;Fb.error&&Fb.options&2&&(Fb.message=Fb.error.Description);Fb.error&&Fb.options&1&&(Fb.title=Fb.error.Caption);Fb.qv=!(mb&4);return Fb}function A(Fb,hc,cd){return M.call(this,Fb,hc,cd)||this}function M(Fb,
hc,cd){Fb=va.call(this,Fb,hc)||this;Fb.qv=!0;Fb.command=cd;return Fb}b.r(E);z=b(0);var T=b(14),R=b(86),Q=b(109),ea=b(13),Z=b(90),ca=b(52),I=b(29),H=b(12),L=b(242),U=b(1240),fa=b(5),aa=b(272),na=b(1241),ha=b(917),ka=b(1318),xa=b(95),va=ha.a;Am(M,va);M.prototype.Fo=function(Fb){va.prototype.Fo.call(this,Fb);this.businessBar.$.Ka.$b(new xa.a(this.command,Fb,this.businessBar.$.fd,10,null))};Object(z.a)(M,"CommandActionBusinessBarEntry",ha.a,[]);Am(A,M);A.prototype.iD=function(Fb){M.prototype.iD.call(this,
Fb)};Object(z.a)(A,"EditAttemptReadOnlyBusinessBarEntry",M,[]);var Aa=b(43),qa=ha.a;Am(C,qa);C.prototype.Fo=function(Fb){qa.prototype.Fo.call(this,Fb);this.error.Appearance&=-33;Aa.a(this.businessBar.$).Bs([this.error])};Object(z.a)(C,"ErrorBusinessBarEntry",ha.a,[]);Am(v,C);v.prototype.m0=function(Fb){C.prototype.m0.call(this,Fb);this.businessBar.$.Ka.$b(new xa.a(this.command,Fb,this.businessBar.$.fd,10,null))};Object(z.a)(v,"ErrorAndCommandBusinessBarEntry",C,[]);var wa=b(15);B.fa=function(Fb){return wa.a.instance.fa(Fb)};
Ck.Object.defineProperties(B.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.TKj)}},message:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.LP)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.LP}},aHa:{configurable:!0,enumerable:!0,get:function(){return this.smg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.xT)}},EGa:{configurable:!0,enumerable:!0,get:function(){return B.fa(this.S8)}},link:{configurable:!0,
enumerable:!0,get:function(){return B.fa(this.qJ)}},Qk:{configurable:!0,enumerable:!0,get:function(){return this.Hqg}},VSg:{configurable:!0,enumerable:!0,get:function(){return this.xmg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.vjb}},alt:{configurable:!0,enumerable:!0,get:function(){var Fb=b(1292).BusinessBarControl;switch(this.Qk){case Fb.aja:return B.fa(26);case Fb.XB:return B.fa(25);case Fb.sj:return B.fa(24);default:return B.fa(0)}}},m9c:{configurable:!0,enumerable:!0,get:function(){return this.Jog}}});
Object(z.a)(B,"EwaBusinessBarEntry",null,[]);Am(u,B);Ck.Object.defineProperties(u.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(z.a)(u,"EwaNoTitleBusinessBarEntry",B,[]);var Ta=b(72),sb=ha.a;Am(t,sb);t.prototype.Fo=function(Fb){sb.prototype.Fo.call(this,Fb);this.set_visible(!1);this.businessBar.$.qL();this.businessBar.$.Ka.$b(new xa.a(1038998010,Fb,this.businessBar.$.fd,10,null))};t.prototype.m0=function(Fb){sb.prototype.m0.call(this,Fb);this.businessBar.$.Ka.$b(new xa.a(-722953877,
Fb,this.businessBar.$.fd,10,null))};t.prototype.iD=function(Fb){this.businessBar.removeEntry(53);Ta.g(Fb)};Object(z.a)(t,"ExternalLinksEnableContentBusinessBarEntry",ha.a,[]);var db=ha.a;Am(x,db);x.prototype.Fo=function(Fb){db.prototype.Fo.call(this,Fb);this.businessBar.$.Ka.$b(new xa.a(-722953877,Fb,this.businessBar.$.fd,10,null))};x.prototype.iD=function(Fb){this.businessBar.removeEntry(5);Ta.g(Fb)};Object(z.a)(x,"ExternalLinksShowErrorBusinessBarEntry",ha.a,[]);var kb=b(10),ac=ha.a;Am(r,ac);r.prototype.Fo=
function(Fb){ac.prototype.Fo.call(this,Fb);kb.HelperMethods.b7(this.businessBar.$.xG,this.Kxb,this.businessBar.$.nT)};Object(z.a)(r,"HelpButtonBusinessBarEntry",ha.a,[]);var ta=ha.a;Am(y,ta);y.prototype.yma=function(Fb){ta.prototype.yma.call(this,Fb);kb.HelperMethods.b7(this.businessBar.$.xG,this.Kxb,this.businessBar.$.nT)};Object(z.a)(y,"HelpTextBusinessBarEntry",ha.a,[]);var ra=b(79),Na=ha.a;Am(h,Na);h.prototype.Fo=function(Fb){Na.prototype.Fo.call(this,Fb);this.businessBar.$.Ka.$b(new xa.a(this.command,
Fb,this.businessBar.$.fd,10,null))};h.prototype.yma=function(Fb){Na.prototype.yma.call(this,Fb);var hc=new xa.a(-859308420,Fb,this.businessBar.$.fd,12,null),cd={};Fb=(cd[ra.a.Ag]="HelpID="+this.Kxb,cd.InputMethod=Fb,cd[ra.a.ld]=fa.a.fW,cd[fa.a.Doa]=!0,cd);this.businessBar.$.Ka.$b(hc,Fb)};Object(z.a)(h,"HelpTextTaskPaneAndCommandBusinessBarEntry",ha.a,[]);var gb=ha.a;Am(w,gb);w.prototype.Fo=function(Fb){gb.prototype.Fo.call(this,Fb);this.set_visible(!1);this.businessBar.$.qL();this.businessBar.$.Ka.$b(new xa.a(-1081442996,
Fb,this.businessBar.$.fd,10,null))};w.prototype.m0=function(Fb){gb.prototype.m0.call(this,Fb);this.businessBar.$.Ka.$b(new xa.a(1702917262,Fb,this.businessBar.$.fd,10,null))};w.prototype.iD=function(Fb){this.businessBar.removeEntry(57);Ta.g(Fb)};Object(z.a)(w,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ha.a,[]);var ob=b(1243),wb=ha.a;Am(n,wb);n.prototype.yma=function(Fb){wb.prototype.yma.call(this,Fb);(Fb=this.policyManager.XOi)&&Fb(null)};Ck.Object.defineProperties(n.prototype,{linkText:{configurable:!0,
enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(z.a)(n,"PolicyBusinessBarEntry",ha.a,[]);var Oa=b(1242),sa=b(1245),Fa=b(1244);b(440);var Wa=b(187),Db=b(27),pc=ha.a;Am(m,pc);m.prototype.Fo=function(Fb){pc.prototype.Fo.call(this,Fb);Wa.c(Db.a.NDi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(z.a)(m,"UnsupportedBrowserBusinessBarEntry",ha.a,[]);var lc=b(1239),eb=b(1333),ib=ha.a;Am(f,ib);f.prototype.Fo=function(Fb){ib.prototype.Fo.call(this,
Fb);this.ACa.wvf(null)};f.prototype.m0=function(Fb){ib.prototype.m0.call(this,Fb);this.ACa.zvf(null)};f.prototype.iD=function(Fb){ib.prototype.iD.call(this,Fb);this.ACa.oJe(null)};Ck.Object.defineProperties(f.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.ACa.ewe}},EGa:{configurable:!0,enumerable:!0,get:function(){return this.ACa.gwe}}});Object(z.a)(f,"WildFireMobileAppBusinessBarEntry",ha.a,[]);var cc=b(254),Pa=b(22),nc=b(232),pb=b(178),rb=b(46),Ya=b(7),ec=b(177),
yd=b(1164),Ub=b(77),Ob=b(131),Yb=ha.a;Am(e,Yb);e.prototype.update=function(Fb){this.scriptLink=Fb.scriptLink;this.runStatus=Fb.runStatus;this.buttonText=Fb.buttonText||"";this.Mui(Fb.clickId);this.Lgj();"preparing"===this.runStatus?(this.message=String.format(wa.a.instance.Ab(199),this.buttonText),this.qv=!0,this.HYa=this.QUd,this.Pqb=this.PFa=this.C$a):"running"===this.runStatus?(this.message=String.format(wa.a.instance.Ab(198),this.buttonText),this.qv=!0,this.HYa=this.QUd,this.Pqb=this.PFa=this.C$a):
"succeeded"===this.runStatus?(this.message=String.format(wa.a.instance.Ab(201),this.buttonText),this.qv=!0,this.HYa=this.vgg,this.PFa=this.eFf,this.n_=!0,this.QWc=this.UWj,this.RWc=this.XUi):"runFailed"===this.runStatus?(this.message=String.format(wa.a.instance.Ab(200),this.buttonText),this.V5a=a.aja,this.qv=!0,this.HYa=this.vgg,this.PFa=this.eFf,"false"===Fb.isOwner&&(this.n_=!0,this.QWc=this.t2g,this.RWc=this.lJi)):"fetchFailed"===this.runStatus?(this.V5a=a.aja,this.message=String.format(wa.a.instance.Ab(202),
this.buttonText)):"canceled"===this.runStatus?(this.V5a=a.XB,this.message=String.format(wa.a.instance.Ab(204),this.buttonText)):"alreadyRunning"===this.runStatus?(this.V5a=a.XB,this.message=String.format(wa.a.instance.Ab(203),this.buttonText),this.qv=!0,this.HYa=this.QUd,this.Pqb=this.PFa=this.C$a):"initializing"===this.runStatus&&(this.V5a=a.sj,this.message=wa.a.instance.fa(2224))};e.prototype.Fo=function(Fb){Yb.prototype.Fo.call(this,Fb);this.PFa&&this.PFa()};e.prototype.m0=function(Fb){Yb.prototype.m0.call(this,
Fb);this.EGa&&this.RWc()};e.prototype.iD=function(Fb){Yb.prototype.iD.call(this,Fb);this.Pqb&&this.Pqb()};e.prototype.Lgj=function(){this.message="";this.V5a=a.sj;this.qv=!1;this.HYa="";this.PFa=void 0;this.n_=!1;this.QWc="";this.RWc=void 0;this.K5a=!1;this.Pqb=void 0};e.prototype.C$a=function(){var Fb=ec.a.create().toString();this.automateCommandManager.o3h(Fb);this.ykc(-2186799,Fb)};e.prototype.eFf=function(){var Fb=ec.a.create().toString();this.automateCommandManager.n3h(Fb);this.ykc(1036446140,
Fb)};e.prototype.XUi=function(){var Fb=ec.a.create();if(this.scriptLink){var hc=new yd.b(this.scriptLink);this.automateCommandManager.p7e(this.id.toString(),JSON.stringify(hc),Fb)}this.ykc(-585097204,Fb.toString())};e.prototype.lJi=function(){var Fb=ec.a.create().toString();this.automateCommandManager.m3h(Fb);this.ykc(-639858579,Fb)};e.prototype.Mui=function(Fb){var hc=[];hc.push(Object(Ya.a)(new Ub.a,{name:"id",string:this.id.toString()}));hc.push(Object(Ya.a)(new Ub.a,{name:"hasScriptLink",bool:!!this.scriptLink}));
hc.push(Object(Ya.a)(new Ub.a,{name:"runStatus",string:this.runStatus}));hc.push(Object(Ya.a)(new Ub.a,{name:"clickId",string:Fb}));hc.push(Object(Ya.a)(new Ub.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));Wa.a(Ob.a.jGi,void 0,void 0,hc)};e.prototype.ykc=function(Fb,hc){var cd=[];cd.push(Object(Ya.a)(new Ub.a,{name:"id",string:this.id.toString()}));cd.push(Object(Ya.a)(new Ub.a,{name:"hasScriptLink",bool:!!this.scriptLink}));cd.push(Object(Ya.a)(new Ub.a,{name:"runStatus",
string:this.runStatus}));cd.push(Object(Ya.a)(new Ub.a,{name:"clickId",string:hc}));Wa.d(Fb,void 0,void 0,void 0,void 0,void 0,cd)};Ck.Object.defineProperties(e.prototype,{Qk:{configurable:!0,enumerable:!0,get:function(){return this.V5a}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.HYa}},EGa:{configurable:!0,enumerable:!0,get:function(){return this.QWc}}});Object(z.a)(e,"OfficeScriptsRunStatusBusinessBarEntry",ha.a,[]);var xb=b(47);Am(c,M);Object(z.a)(c,"CalloutBusinessBarEntry",
M,[]);var Sa=b(1),Tb=b(19);b.d(E,"BusinessBarControl",function(){return a});var Cc=L.a;Am(a,Cc);a.prototype.Wf=function(Fb,hc){hc||H.DOMElementExtensions.setFocus(this.domElement.firstChild);return!hc};a.prototype.sh=function(Fb){return H.DOMElementExtensions.Gf(this.uc,Fb)};a.prototype.Ej=function(){};a.prototype.Rj=function(){};a.prototype.dispose=function(){this.Cm||(Q.KeyInputManager.instance.za(ea.a.Xb,this.uc,this.QW),Z.a.yc(this.gV),this.gV=Array(66),this.wb=null,Cc.prototype.dispose.call(this),
this.Cm=!0)};a.prototype.IMa=function(Fb){if(!this.get_visible())return!1;Fb=this.gV[Fb];return!!Fb&&Fb.isVisible};a.prototype.vC=function(Fb){return!!this.gV[Fb]};a.prototype.vOb=function(Fb,hc){if(Fb=this.gV[Fb])Fb.update(hc),Fb.cRj()};a.prototype.oE=function(Fb,hc,cd,mb){cd=void 0===cd?null:cd;mb=void 0===mb?null:mb;var $a=!1;if(this.vC(Fb))cd=this.gV[Fb].get_visible();else{this.set_visible(!0);var K=a.m5e()[Fb];this.gV[Fb]=this.laa(Fb,hc,cd,mb);cd=!1;$a=!0;mb="";var ba=0;hc&&(mb=hc.MessageIdName,
ba=hc.MessageId);var ua=K.m9c;T.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",Fb,rb.PageLoadTrackingInfo.instance.bka(new Date));if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var La=this.gV.filter(function(ub){return null!=ub}).length;1<La&&T.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",La.toString())}pb.a(this.$).eLd(K.hash,mb,ba,ca.a.CBc,!0,1,hc,ua)}cd||!Array.contains(ka.a.cdc(),Fb)&&!$a||
(this.gV[Fb].set_visible(!0),this.$.qL())};a.prototype.removeEntry=function(Fb){return this.iaj(Fb)};a.prototype.iJd=function(){Z.a.yc(this.gV);this.gV=Array(66);this.set_visible(!1)};a.prototype.iaj=function(Fb){if(!this.vC(Fb))return!1;Z.a.Ha(this.gV[Fb]);this.gV[Fb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.qL();return!0};a.prototype.laa=function(Fb,hc,cd,mb){cd=void 0===cd?null:cd;mb=void 0===mb?null:mb;var $a=a.m5e()[Fb],K=!!(this.$.Pd&64);switch(Fb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:Fb=
new ha.a(this,$a);break;case 12:case 29:case 30:case 31:case 32:case 55:Fb=K?new M(this,$a,-8805455):new ha.a(this,$a);break;case 22:Fb=new A(this,$a,-8805455);break;case 44:case 43:Fb=K?new v(this,$a,hc,0,-8805455):new C(this,$a,hc,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:Fb=new C(this,$a,hc,0);break;case 19:Fb=new ha.a(this,$a);break;case 45:Fb=new C(this,$a,hc,0);break;case 6:case 14:Fb=new r(this,$a,hc.HelpTopicId);break;case 64:Fb=new y(this,$a,hc.HelpTopicId);break;case 36:Fb=
new y(this,$a,fa.a.$bh);break;case 16:Fb=new ha.a(this,$a);Fb.title=I.a.Sf(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Fb.message=I.a.Sf(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Fb=new M(this,$a,-1762562205);Fb.K5a=!0;break;case 20:Fb=new f(this,$a);break;case 21:case 54:Fb=new ha.a(this,$a);break;case 28:Fb=new ha.a(this,$a);break;case 24:Fb=new m(this,$a);break;case 27:Fb=new n(this,$a);break;case 37:Fb=new lc.a(this,$a);break;case 38:Fb=new na.a(this,
$a);break;case 39:Fb=new Oa.a(this,$a);break;case 40:Fb=new ob.a(this,$a);break;case 46:Fb=new ha.a(this,$a);break;case 47:Fb=new ha.a(this,$a);break;case 48:Fb=new ha.a(this,$a);break;case 49:Fb=new ha.a(this,$a);break;case 50:Fb=new ha.a(this,$a);break;case 51:Fb=new Fa.a(this,$a);break;case 52:Fb=new sa.a(this,$a);break;case 53:Fb=new t(this,$a);break;case 5:Fb=new x(this,$a);break;case 56:Fb=new M(this,$a,-1753056834);hc?(hc=hc.Directive,Pa.a.Tn(hc)||"&nbsp;"===hc||(Fb.message=hc)):cd&&(Fb.message=
cd);break;case 57:Fb=new w(this,$a);break;case 58:Fb=new ha.a(this,$a);break;case 59:case 62:Fb=new y(this,$a,fa.a.qFi);break;case 60:Fb=new h(this,$a,fa.a.iOg,-8805455);break;case 65:Fb=new h(this,$a,fa.a.H6i,1461300262);break;case 61:Fb=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new c(this,$a,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new M(this,$a,515196233);break;case 63:Fb=new e(this,$a,
this.$,mb);break;default:Fb=new C(this,$a,hc,7)}Fb.S3c();return Fb};a.m5e=function(){var Fb=nc.a.W6a()?259:258;return a.Vve||(a.Vve=[new B(0,274,275,276,0,0,a.aja,1,"BB_UnableToRefreshLock"),new B(1,274,275,276,0,0,a.aja,1,"BB_UnableToRefreshLockExpected"),new B(2,266,267,0,0,0,a.XB,5,"BB_WorkbookAlmostTooLarge"),new B(3,268,269,270,0,0,a.aja,1,"BB_WorkbookTooLarge"),new B(4,257,Fb,0,0,0,a.XB,5,"BB_ExternalWorkbookLinksDisabled"),new B(5,261,260,262,0,0,a.aja,1,"BB_ExternalWorkbookLinksShowError"),
new B(6,263,264,265,0,0,a.sj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new B(7,249,250,251,0,0,a.sj,0,"BB_UnsupportedFeatures"),new B(8,0,0,0,0,0,a.sj,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new B(9,0,0,0,0,0,a.sj,0,"BB_CollabDataStringsLocaleMismatch"),new B(10,0,0,0,0,0,a.sj,0,"BB_CollabDataLocaleMismatch"),new B(11,277,278,279,0,0,a.aja,1,"BB_LastGenericStatusError"),new B(12,280,281,282,0,0,a.XB,5,"BB_ScratchPadWarning"),new B(13,283,284,285,0,0,a.aja,1,"BB_AuthenticationLost"),new B(14,
286,287,288,0,0,a.XB,5,"BB_OdfCompatibilityIssues"),new B(15,0,574,0,0,0,a.XB,5,"BB_PivotChartInteractivityMissingWarning"),new B(16,0,0,0,0,0,a.sj,0,"BB_WorkbookIsIrmProtected"),new B(17,0,0,0,0,0,a.sj,0,"BB_BIFeatureNotAvailable"),new B(18,289,290,285,0,0,a.XB,5,"BB_AnonymousCreateMode"),new B(19,252,253,0,0,0,a.XB,5,"BB_UnsupportedInteractiveReportEditing"),new B(20,0,0,0,0,0,a.sj,0,"BB_MobileAppCampaignBizBar"),new B(21,295,296,0,0,0,a.sj,0,"BB_TransientServerCommunicationFailures"),new B(22,
1608,1619,1620,0,0,a.sj,0,"BB_EditAttemptInReadOnly"),new B(23,1608,1619,0,0,0,a.sj,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new B(24,0,kb.HelperMethods.DQj(),1597,0,0,a.sj,0,"BB_UnsupportedBrowser"),new B(25,298,299,0,0,0,a.sj,0,"BB_ReadOnlyPermissions"),new B(26,300,301,0,0,0,a.sj,0,"BB_DocumentIsIrmProtectedWarning"),new B(27,0,0,0,0,0,a.XB,5,"BB_PolicyWarningMessage"),new B(28,1252,297,0,0,0,a.sj,0,"BB_WorkingOnIt"),new B(29,1608,1606,1607,0,0,a.sj,0,"BB_PasswordProtectedWorkbookLockedForEdit"),
new B(30,1621,1622,1623,0,0,a.sj,0,"BB_WorkbookIsReadOnlyRecommended"),new B(31,1608,1624,1625,0,0,a.sj,0,"BB_WorkbookHasPasswordToModify"),new B(32,1608,1626,1629,0,0,a.sj,0,"BB_LegacySharedWorkbookEditWarning"),new B(33,1616,1627,251,0,0,a.sj,0,"BB_LegacyConnectionsWarning"),new B(34,1617,1618,0,0,0,a.sj,0,"BB_GroupedSlicers"),new B(35,311,312,0,0,0,a.XB,5,"BB_ThirdPartyAddinDisabled"),new B(36,1749,1750,0,0,1751,a.sj,0,"BB_FinanceLinkedEntityDisclaimerBar"),new B(37,0,0,0,0,0,a.sj,0,"BB_WacGdprNotice"),
new B(38,0,0,0,0,0,a.sj,0,"BB_AutomaticSensitivityLabel"),new B(39,0,0,0,0,0,a.sj,0,"BB_RecommendedSensitivityLabel"),new B(40,0,0,0,0,0,a.sj,0,"BB_MandatorySensitivityLabel"),new B(41,313,314,315,0,0,a.sj,0,"BB_LocalStorageDisabled"),new B(42,631,632,0,0,0,a.sj,0,"BB_AutoRefreshDisabled"),new B(43,993,991,995,1281,0,a.sj,0,"BB_CorruptedFileRepaired"),new B(44,994,992,995,1281,0,a.sj,0,"CorruptedOdsFileRepaired"),new B(45,271,272,273,0,0,a.XB,5,"BB_MinorVersionLimitReached"),new B(46,302,303,0,0,
0,a.XB,5,"BB_SensitivityApplicationGenericError"),new B(47,304,306,0,0,0,a.XB,5,"BB_SensitivityApplicationTooLargeFileError"),new B(48,305,306,0,0,0,a.XB,5,"BB_SensitivityApplicationLabelNotSupportedError"),new B(49,307,308,0,0,0,a.XB,5,"BB_SensitivityApplicationLabelDisabledError"),new B(50,309,310,0,0,0,a.XB,5,"BB_SensitivityApplicationMandatoryConflictError"),new B(51,0,0,0,0,0,a.XB,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new B(52,0,0,0,0,0,a.XB,5,"BB_SensitivityApplicationSetLabelError"),
new B(53,2069,2070,2071,2074,0,a.sj,0,"BB_ExternalWorkbookLinksPromptEnableContent"),new B(54,295,296,0,0,0,a.sj,0,"BB_NetworkDown"),new B(55,316,317,318,0,0,a.sj,0,"BB_DefaultToViewDueToCogs"),new B(56,1775,1776,1777,0,0,a.sj,0,"BB_RefreshLinkedEntityErrorBar"),new B(57,1752,1753,1754,1755,0,a.sj,0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new u(58,248,0,0,0,a.sj,0,"BB_CanvasHealth"),new B(59,319,320,0,0,321,a.sj,0,"BB_NovModeDepreciation"),new B(60,996,997,1281,0,998,a.sj,0,"BB_MismatchedFileFormatConverted"),
new B(61,2180,2181,2182,0,0,a.sj,0,"BB_OptimizeWorkbook"),new B(62,322,323,0,0,324,a.sj,0,"BB_NovModePostDepreciation"),new B(63,0,0,0,0,0,a.sj,0,"BB_OfficeScriptsRunning"),new B(64,2159,2160,0,0,2161,a.sj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new B(65,325,326,0,0,327,a.sj,0,"BB_ReadOnlyPivotTable")])};Ck.Object.defineProperties(a.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return cc.a.JZc}},uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.aja=Tb.a.xrh;a.XB=Tb.a.zrh;a.sj=Tb.a.yrh;a.Vve=null;Object(z.a)(a,"BusinessBarControl",L.a,[438])},1300:function(z,E,b){function a(){this.Sjb=!!r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Pa.wv}function c(A,M,T){var R=m.call(this,A,M,T)||this;A={};A=(A.errorMessage=R.fNe,A.errorFileDownloadOffer=R.Gtb,A);M={};A.helpLink=(M.type="AppLinkProps",M.id="helpLink",M.text=
R.pwa,M.onExecute=function(Q){R.ZOa(Q)},M);M=new C.a(!1,!1,!0);M.jc=1;M.Bc(1,R.Htb);M.Oe=R.id;T={};A=(T.id=R.id,T.dialogIcon=R.icon,T.bodyControls=A,T);M.initializeAndShow(R.Im,Object(h.a)(R,R.HHd,"reactOICErrorDialogHandler"),A);return R}function e(A,M,T,R){var Q=w.call(this,A,M,T,R)||this;A={};A=(A.errorMessage=Q.errorMessage,A);M={};A.helpLink=(M.type="AppLinkProps",M.id="helpLink",M.text=Q.pwa,M.onExecute=function(ea){Q.ZOa(ea)},M);Q.Lxc?(A.macOfficePreLinkText=Q.Jpf,M={},A.macOfficeLink=(M.type=
"AppLinkProps",M.id="macOfficeLink",M.text=Q.Gpf,M.onExecute=function(ea){Q.aAd(ea)},M),A.macOfficePostText=Q.Ipf):Q.Y3b&&(A.errorFileDownloadOffer=Q.Gtb);M=new C.a(!1,!1,!0);Q.Y3b?(M.jc=1,M.Bc(1,Q.Htb)):M.jc=0;M.Oe=Q.id;T={};A=(T.id=Q.id,T.dialogIcon=Q.icon,T.bodyControls=A,T);M.initializeAndShow(Q.Im,Object(h.a)(Q,Q.HHd,"reactOICErrorDialogHandler"),A);return Q}function f(A,M,T){A=m.call(this,A,M,T)||this;A.dm=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=A.fNe;M.appendChild(document.createElement("br"));
M.appendChild(document.createElement("br"));A.dm=document.createElement("a");A.dm.href="#";A.dm.innerText=A.pwa;M.appendChild(A.dm);B.a.addHandler(A.dm,"click",Object(h.a)(A,A.ZOa,"oicErrorHelpLinkHandler"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));T=document.createElement("span");T.innerText=A.Gtb;M.appendChild(T);T=new v.StandardDialog;T.Oe=A.id;T.jc=1;T.Bc(1,A.Htb);T.Ak(A.Im,null,A.icon,Object(h.a)(A,A.dud,"legacyOICErrorDialogHandler"),M);T.IX("errorMessageText");
return A}function m(A,M,T){this.EY=M;this.FY=A;this.XD=T}function n(A,M,T,R){A=w.call(this,A,M,T,R)||this;A.dm=null;A.Vqa=null;M=document.createElement("span");M.id="errorMessageText";M.innerText=A.errorMessage;M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));A.dm=document.createElement("a");A.dm.href="#";A.dm.innerText=A.pwa;M.appendChild(A.dm);B.a.addHandler(A.dm,"click",Object(h.a)(A,A.ZOa,"oicErrorHelpLinkHandler"));T=new v.StandardDialog;T.Oe=A.id;if(A.Lxc){R=
document.createElement("span");var Q=document.createElement("span");R.innerText=A.Jpf;Q.innerText=A.Ipf;A.Vqa=document.createElement("a");A.Vqa.href="#";A.Vqa.innerText=A.Gpf;M.appendChild(document.createElement("br"));M.appendChild(R);M.appendChild(A.Vqa);M.appendChild(Q);B.a.addHandler(A.Vqa,"click",Object(h.a)(A,A.aAd,"oicErrorMacOfferLinkHandler"))}else A.Y3b&&(M.appendChild(document.createElement("br")),M.appendChild(document.createElement("br")),R=document.createElement("span"),R.innerText=
A.Gtb,M.appendChild(R));A.Y3b?(T.jc=1,T.Bc(1,A.Htb)):T.jc=0;T.Ak(A.Im,null,A.icon,Object(h.a)(A,A.dud,"legacyOICErrorDialogHandler"),M);T.IX("errorMessageText");return A}function w(A,M,T,R){this.KNc=null;this.kSb=R;this.EY=A;this.FY=M;this.XD=T;this.She=this.Hpf.Yxj;A=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Vsg=A[0];this.Usg=A[1]}z=b(0);var h=b(82),y=b(14),r=b(4),x=b(52),t=b(440),u=b(85);w.prototype.HHd=function(A){this.$Db(A)};w.prototype.dud=function(A){this.$Db(A)};w.prototype.$Db=
function(A){var M=10;this.FY&&1===A&&(this.FY(this.XD),M=1);this.EY&&this.EY(this.XD);this.fG(M)};w.prototype.ZOa=function(){t.Redirect.showHelp("OICFailure");this.fG(2)};w.prototype.aAd=function(){this.Hpf.flf();this.fG(4)};w.prototype.fG=function(A){y.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.kSb,A);r.AFrameworkApplication.Stc(x.a.LFf,this.kSb,A)};w.prototype.dispose=function(){this.XD=this.EY=this.FY=null};Ck.Object.defineProperties(w.prototype,
{Hpf:{configurable:!0,enumerable:!0,get:function(){return this.KNc||(this.KNc=u.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},pwa:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Lxc:{configurable:!0,enumerable:!0,get:function(){return this.She}},Jpf:{configurable:!0,enumerable:!0,
get:function(){return this.Vsg}},Ipf:{configurable:!0,enumerable:!0,get:function(){return this.Usg}},Gpf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.She?3:2}},Gtb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Y3b:{configurable:!0,enumerable:!0,get:function(){return!!this.FY}},Htb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},
Im:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(z.a)(w,"AOICErrorDialog",null,[2]);var B=b(42),v=b(133);Am(n,w);n.prototype.dispose=function(){this.dm&&(B.a.removeHandler(this.dm,"click",Object(h.a)(this,this.ZOa,"oicErrorHelpLinkHandler")),this.dm=null);this.Vqa&&(B.a.removeHandler(this.Vqa,"click",Object(h.a)(this,this.aAd,"oicErrorMacOfferLinkHandler")),this.Vqa=null);w.prototype.dispose.call(this)};Object(z.a)(n,"OICErrorDialog",w,[]);m.prototype.HHd=
function(A){this.$Db(A)};m.prototype.dud=function(A){this.$Db(A)};m.prototype.$Db=function(A){var M=10;1===A&&(this.FY(this.XD),M=1);this.EY&&this.EY(this.XD);this.fG(M)};m.prototype.ZOa=function(){t.Redirect.showHelp("OICFailure");this.fG(2)};m.prototype.fG=function(A){r.AFrameworkApplication.Stc(x.a.MFf,3,A)};m.prototype.dispose=function(){this.XD=this.FY=this.EY=null};Ck.Object.defineProperties(m.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},fNe:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},pwa:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Gtb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Htb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Im:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(z.a)(m,"AOICErrorDialogWithDownload",null,[2]);Am(f,m);f.prototype.dispose=function(){this.dm&&(B.a.removeHandler(this.dm,"click",Object(h.a)(this,this.ZOa,"oicErrorHelpLinkHandler")),this.dm=null);m.prototype.dispose.call(this)};Object(z.a)(f,"OICErrorDialogWithDownload",m,[]);var C=b(149);Am(e,w);Object(z.a)(e,"ReactOICErrorDialog",w,[]);Am(c,m);Object(z.a)(c,"ReactOICErrorDialogWithDownload",m,[]);b.d(E,"a",function(){return a});a.prototype.Q8g=function(A,M,T){this.Sjb?new e(A,M,null,T):
new n(A,M,null,T)};a.prototype.R8g=function(A,M,T){this.Sjb?new c(A,M,T):new f(A,M,T)};a.prototype.S8g=function(A,M,T,R,Q){var ea=b(1381).ReactOICErrorDialogWithTrial,Z=b(1382).OICErrorDialogWithTrial;this.Sjb?new ea(A,M,T,null,R,Q):new Z(A,M,T,null,R,Q)};Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||(a.Ma=new a)}}});a.Ma=null;Object(z.a)(a,"OICErrorDialogFactory",null,[319])},1318:function(z,E,b){function a(ka,xa){var va=ha.call(this)||this;va.Qa=
new h.a;va.OU=null;va.BIc=[];va.anc=function(){va.$.na.rMa?va.removeEntry(13):va.eg(13,null)};va.Zya=function(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");va.removeEntry(21);va.vC(54)&&(e.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),va.removeEntry(54));va.xSf("OnNetworkResumed")};va.Th=function(qa,wa){qa=0;
for(var Ta=a.cdc().length;qa<Ta;qa++){var sb=a.cdc()[qa];va.removeEntry(sb)}wa.context&&0<wa.context.communicationErrorRetryCount&&(e.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),va.removeEntry(21));va.xSf("OnWebMethodSuccess")};va.Wn=function(qa,wa){var Ta;qa=va.IBh(wa.errors);for(var sb=[],db=0,kb=qa.length;db<kb;++db){var ac=qa[db];if(1===ac.Type&&ac.Appearance&32)sb=
va.u5h(ac,sb);else if(wa.Poj){e.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ta=(null===(Ta=wa.context)||void 0===Ta?0:Ta.stopwatch)?wa.context.stopwatch.zc:-1;5E3>ta?e.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",ta):f.AFrameworkApplication.iif()||va.ZDg(ac,
wa.context.methodName)}ta=[].concat(Dl(a.cdc()));for(var ra=0,Na=sb.length;ra<Na;++ra){var gb=sb[ra];va.eg(gb,ac);Array.remove(ta,gb)}ac=0;for(ra=ta.length;ac<ra;++ac)va.removeEntry(ta[ac])}};va.ZEb=function(qa,wa){qa=0;for(var Ta=wa.errors.length;qa<Ta;++qa){var sb=wa.errors[qa];f.AFrameworkApplication.iif()||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),va.eg(54,sb))}};va.qd=
function(qa,wa){va.Zc(qa,wa)};va.Zc=function(){var qa=va.$.ea;qa.sc||qa.Fg()||(va.iJd(),Array.clear(va.BIc))};va.zd=function(qa,wa){va.$.ea.Fg()&&!wa.tW||va.jaf(wa.tW)};va.FFb=function(){var qa=va.$.userOperationManager.Qcc();qa&&qa.operation.flags&1&&va.o4f()};va.bzf=function(){va.o4f()};va.If=function(){va.Nye();va.x4f()};va.ZN=function(){if(va.$.X5&&va.$.ea.Fg()&&va.$.ea.sc)if(va.$.ea.isEditMode)va.removeEntry(43),va.removeEntry(12),va.removeEntry(29),va.removeEntry(30),va.removeEntry(31),va.removeEntry(32),
va.removeEntry(22),va.removeEntry(55);else{var qa=va.$.da.Aa(331);qa&&qa.JJa||va.removeEntry(53);va.removeEntry(5)}};va.$=ka;va.zZa=xa;va.vMg();f.AFrameworkApplication.Jd&&f.AFrameworkApplication.Jd.hVc(va);va.pnb=Array(66);for(var Aa=0;66>Aa;Aa++)va.pnb[Aa]=null;va.hh=Z.EcmaDateClock.instance;va.Zjf=va.hh.Wb.getTime();xa&&(xa=ka.na,Aa=xa.qf,xa.iz(va.Wn),xa.Bq(va.Th),xa.Onb(va.anc),xa.cZa(va.anc),I.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Aa.zGg(va.ZEb),Aa.$nb(va.Zya)),
ka.ea.gk(va.qd),ka.ea.Ot(va.If),ka.tl(va.zd),ka.Zk(va.Zc),ka.ea.g3(va.ZN),ka.userOperationManager.Wu(va.FFb),I.EwaSettings.ma(170)&&ka.ea.Zg.get(45)&&f.AFrameworkApplication.ga.ra("SupportsPolicies")||va.a7e(),va.jaf(U.c(ka)));ka.da.Ga(5,va);return va}function c(ka,xa,va){va=void 0===va?null:va;var Aa=u.call(this)||this;Aa.aHa=ka;Aa.r7c=xa;Aa.data=va;return Aa}z=b(0);var e=b(14),f=b(4),m=b(90),n=b(24),w=b(126),h=b(38),y=b(76),r;(function(ka){ka[ka.unableToRefreshLock=0]="unableToRefreshLock";ka[ka.unableToRefreshLockExpected=
1]="unableToRefreshLockExpected";ka[ka.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";ka[ka.workbookTooLarge=3]="workbookTooLarge";ka[ka.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";ka[ka.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";ka[ka.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";ka[ka.unsupportedFeatures=7]="unsupportedFeatures";ka[ka.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";
ka[ka.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";ka[ka.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";ka[ka.lastGenericStatusError=11]="lastGenericStatusError";ka[ka.scratchPadWarning=12]="scratchPadWarning";ka[ka.authenticationLost=13]="authenticationLost";ka[ka.odfCompatibilityIssues=14]="odfCompatibilityIssues";ka[ka.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";ka[ka.workbookIsIrmProtected=16]="workbookIsIrmProtected";ka[ka.biFeatureNotAvailable=
17]="biFeatureNotAvailable";ka[ka.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";ka[ka.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";ka[ka.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";ka[ka.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";ka[ka.editAttemptInReadOnly=22]="editAttemptInReadOnly";ka[ka.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";ka[ka.unsupportedBrowser=24]="unsupportedBrowser";
ka[ka.readOnlyPermissions=25]="readOnlyPermissions";ka[ka.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";ka[ka.policyWarningMessage=27]="policyWarningMessage";ka[ka.workingOnIt=28]="workingOnIt";ka[ka.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";ka[ka.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";ka[ka.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";ka[ka.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";
ka[ka.legacyConnectionsBB=33]="legacyConnectionsBB";ka[ka.groupedSlicersBB=34]="groupedSlicersBB";ka[ka.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";ka[ka.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";ka[ka.wacGdprNotice=37]="wacGdprNotice";ka[ka.automaticSensitivityLabel=38]="automaticSensitivityLabel";ka[ka.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";ka[ka.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";ka[ka.localStorageDisabled=41]=
"localStorageDisabled";ka[ka.autoRefreshDisabled=42]="autoRefreshDisabled";ka[ka.corruptedFileRepaired=43]="corruptedFileRepaired";ka[ka.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";ka[ka.minorVersionLimitReached=45]="minorVersionLimitReached";ka[ka.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";ka[ka.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";ka[ka.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";
ka[ka.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";ka[ka.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";ka[ka.sensitivityApplicationMinorVersionLimitReachedError=51]="sensitivityApplicationMinorVersionLimitReachedError";ka[ka.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";ka[ka.promptEnableExternalLinks=53]="promptEnableExternalLinks";ka[ka.networkDown=54]="networkDown";ka[ka.defaultToViewDueToCogs=
55]="defaultToViewDueToCogs";ka[ka.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";ka[ka.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";ka[ka.canvasHealth=58]="canvasHealth";ka[ka.novModeDepreciation=59]="novModeDepreciation";ka[ka.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";ka[ka.optimizeWorkbook=61]="optimizeWorkbook";ka[ka.novModePostDepreciation=62]="novModePostDepreciation";ka[ka.officeScriptsRunning=63]="officeScriptsRunning";
ka[ka.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";ka[ka.readOnlyPivotTable=65]="readOnlyPivotTable";ka[ka.count=66]="count"})(r||(r={}));Object(z.b)("EwaBusinessBarEntryType",r);var x=b(5),t=b(1241),u=Sys.EventArgs;Am(c,u);Object(z.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var B=b(1243),v=b(1242),C=b(1245),A=b(1244),M=b(1239),T=b(520),R=b(51),Q=b(245),ea=b(36),Z=b(741),ca=b(30),I=b(1),H=b(10),L=b(21),U=b(53),fa=b(66),aa=b(1044),na=b(187);
b.d(E,"a",function(){return a});var ha=y.a;Am(a,ha);a.prototype.a7e=function(){ca.a.lr(this.$.ea.SF)&&this.Wn(this,new T.a(this.$.ea.SF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.DEg=function(ka){this.Qa.addHandler("bBarAttachedOrDetached",ka)};a.prototype.dispose=function(){if(this.$){var ka=this.$,xa=ka.na,va=xa.qf;xa.Yz(this.Wn);xa.Dr(this.Th);xa.Zsc(this.anc);xa.iIb(this.anc);va.xIb(this.Zya);va.Vcj(this.ZEb);ka.ea.Fk(this.qd);ka.ea.Gv(this.If);ka.Ul(this.zd);ka.sm(this.Zc);ka.ea.Q0(this.ZN);
ka.userOperationManager.Cr(this.FFb);L.g(ka).rc.kl(this.bzf)}m.a.Ha(this.OU);this.$=this.OU=null;ha.prototype.dispose.call(this)};a.prototype.qgi=function(ka){switch(ka){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return I.EwaSettings.ma(661);default:return!1}};a.prototype.eg=function(ka,xa,va,Aa,qa){va=void 0===va?null:va;Aa=void 0===Aa?null:Aa;qa=void 0===qa?null:qa;if(!this.$.isMobileMode||this.qgi(ka))this.zZa&&!this.vC(ka)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
e.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(r,ka)),this.pnb[ka]=this.hh.G8,this.OU.oE(ka,xa,Aa,qa),this.Qa.raiseEvent("bBarAttachedOrDetached",new c(ka,!0,va))),xa&&32===xa.Appearance&&fa.a(this.$).rd.Nla(xa)};a.prototype.OAj=function(ka,xa,va,Aa){e.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");M.a.initialize(ka,xa,va,Aa);this.eg(37,null)};a.prototype.Qzj=function(ka,xa,va,Aa){t.a.initialize(ka,xa,va,Aa);this.eg(38,null)};a.prototype.YBj=
function(ka,xa,va,Aa){v.a.initialize(ka,xa,va,Aa);this.eg(39,null)};a.prototype.mBj=function(ka,xa,va,Aa){B.a.initialize(ka,xa,va,Aa);this.eg(40,null)};a.prototype.iCj=function(ka,xa,va,Aa){A.a.initialize(ka,xa,va,Aa);this.eg(51,null)};a.prototype.hCj=function(ka,xa,va,Aa){C.a.initialize(ka,xa,va,Aa);this.eg(52,null)};a.prototype.removeEntry=function(ka){this.zZa&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",
Enum.toString(r,ka)),this.pnb[ka]=null,this.OU.removeEntry(ka)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new c(ka,!1)))};a.prototype.IMa=function(ka){return this.zZa?this.OU.IMa(ka):!1};a.prototype.vC=function(ka){return this.zZa?this.OU.vC(ka):!1};a.prototype.yDb=function(){e.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.nmc=function(){e.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");
this.removeEntry(21)};a.prototype.vMg=function(){var ka=b(1292).BusinessBarControl;if(this.zZa&&!this.OU){L.g(this.$).rc.sl(this.bzf);var xa=document.getElementById(this.$.Lb+x.a.Xve);this.OU=new ka(this.$,xa)}};a.prototype.iJd=function(){this.zZa&&this.OU.iJd()};a.prototype.xSf=function(ka){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var xa=this.hh.G8;if(3E5<=xa-this.Zjf){this.Zjf=xa;for(var va=0;66>va;va++){var Aa=this.pnb[va];Aa&&(Aa=xa-Aa,3E5<=Aa&&e.ULS.sendTraceTag(537170241,
0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",ka,Enum.toString(r,va),Aa))}}}};a.prototype.IBh=function(ka){for(var xa=[],va=Cl(ka),Aa=va.next();!Aa.done;Aa=va.next())switch(Aa.value.MessageId){case -113742550:Aa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||ca.a.qh(ka,Aa))&&xa.push(-113742550)}return ca.a.$F(ka,xa)};a.prototype.u5h=function(ka,xa){switch(ka.MessageId){case 2113407564:for(var va=ca.a.A_a([1821390342,
-943219229,-502303485,1437034227]),Aa=0;Aa<va.length;Aa++)va[Aa].HelpTopicId=ka.HelpTopicId,va[Aa].HelpDescription=ka.HelpDescription,this.BIc.push(va[Aa])}switch(ka.MessageId){case -395951567:this.eg(6,ka);break;case 1643490758:this.eg(4,ka);break;case -907264831:this.eg(5,ka);break;case 757111532:case 2113407564:this.eg(7,ka);break;case 2010656511:this.eg(15,ka);break;case 1321660996:this.$.S5c=!0;this.eg(8,ka);break;case 526339737:this.$.S5c=!0;this.eg(9,ka);break;case -407088521:this.eg(10,ka);
break;case 1756116017:this.eg(14,ka);break;case -1703455218:this.eg(17,ka);break;case 1393475740:this.eg(25,ka);break;case -949523941:this.eg(26,ka);break;case 1779381952:this.eg(42,ka);break;case 1421575100:this.eg(43,ka);break;case 613676060:this.eg(44,ka);break;case 1233668252:this.eg(60,ka);break;case 1911608588:ka=!!(this.$.Pd&64);!this.$.ea.Fg()&&ka&&xa.push(29);break;case 1544494907:break;case -655555355:xa.push(this.hsd()?1:0);break;case -1221382671:xa.push(2);break;case 1662282929:xa.push(3);
break;case 104919273:this.$.ea.Fg()||xa.push(30);break;case -689453604:ka=!!(this.$.Pd&64);this.$.ea.m8e=!0;!this.$.ea.Fg()&&ka&&xa.push(31);break;case 157762400:this.$.ea.shc=!0;!this.$.ea.Fg()&&this.$.Pd&64&&!this.$.isEditMode&&xa.push(32);break;case -73730134:I.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.Fg()&&this.$.Pd&64&&xa.push(33);break;case -293349236:xa.push(64);break;case -37299333:break;case 136737622:xa.push(45);break;case -1780327030:this.eg(53,
ka);break;case -113742550:this.eg(55,ka);break;case -260312420:this.$.ea.Fg()||xa.push(65);break;default:this.eg(11,ka)}return xa};a.prototype.wai=function(){var ka=this;if(f.AFrameworkApplication.ga.ra("WildFireExcelBizBar")&&!aa.a.eqd(aa.a.Vdd(1))&&(n.a.qp||n.a.Fh)){var xa=R.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);ea.TaskExtensions.Ba(xa,function(){ka.eg(20,null)},this.la,3)}};a.prototype.tai=function(){var ka=I.EwaSettings.ma(74),xa=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",
!1),va=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);H.HelperMethods.oSd(va||xa,ka)&&(na.a("NewBrowserSuggestionShown"),va||w.a.Mv("NewBrowserSuggestionShown","true",7),this.eg(24,null))};a.prototype.Q$h=function(ka){!ka&&Q.f(this.$)&&this.eg(59,null)};a.prototype.R$h=function(ka){!ka&&Q.g(this.$)&&this.eg(62,null)};a.prototype.jaf=function(ka){(!ka&&!this.$.printingEnabled||this.$.Yf.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(e.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.eg(16,null));this.wai();this.tai();this.Nye();this.x4f();this.Q$h(ka);this.R$h(ka)};a.prototype.Nye=function(){this.$.workbookContext.Options&32768&&this.EAj()};a.prototype.EAj=function(){this.pnb[36]||this.eg(36,null)};a.prototype.x4f=function(){I.EwaSettings.ma(661)&&this.$.workbookContext.Options&524288&&this.eg(57,null)};a.prototype.U4f=function(ka,xa){this.eg(56,ka,null,xa)};a.prototype.Yme=
function(ka,xa){var va=null,Aa=null;va=void 0===va?null:va;Aa=void 0===Aa?null:Aa;xa=void 0===xa?null:xa;this.OU.vC(ka)?this.OU.vOb(ka,xa):this.eg(ka,null,va,Aa,xa)};a.prototype.o4f=function(){this.$.Pd&8&&this.eg(12,null)};a.prototype.hsd=function(){var ka=this.$.da.Aa(38);return ka?ka.tokenExpired:!1};a.prototype.ZDg=function(ka,xa){if(!this.vC(21)&&-1387426400!==ka.MessageId){e.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var va={};
va.FailedMethod=xa;this.eg(21,ka,va)}};a.cdc=function(){return a.lqe||(a.lqe=[0,1,2,3])};Ck.Object.defineProperties(a.prototype,{v8c:{configurable:!0,enumerable:!0,get:function(){return this.BIc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.OU?this.OU.domElement:null}}});a.lqe=null;Object(z.a)(a,"BusinessBarManager",y.a,[924,2,202])},1333:function(z,E,b){function a(x,t,u,B,v,C){this.WOc=null;this._id=x;this.CPc=t;this.$pg=void 0===v?null:v;this.Ljb=B;this.Xlb=void 0===C?null:
C;this.Jpa=null;this.yYa=u;this.vmb=c.instance.UZh(t,x)}function c(){this.GFc=new w.a;this.EFc=new w.a;this.DFc=new w.a;this.sQg(this.GFc);this.rQg(this.EFc);this.qQg(this.DFc);this.KKc=new w.a;this.JKc=new w.a;this.IKc=new w.a;this.PSg(this.KKc);this.OSg(this.JKc);this.NSg(this.IKc);this.VGc=new w.a;this.LQg(this.VGc);this.YFa(this.VGc);this.YFa(this.DFc);this.YFa(this.EFc);this.YFa(this.GFc);this.YFa(this.JKc);this.YFa(this.KKc);this.YFa(this.IKc)}z=b(0);var e=b(14),f=b(82),m=b(1057),n=b(1044),
w=b(1313);c.prototype.UZh=function(x,t){switch(x){case 1:return this.f2h(t);case 2:return this.UJh(t)}return n.a.$xc?this.VGc:null};c.prototype.sQg=function(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.rQg=function(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.qQg=function(x){x.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.PSg=function(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);x.add("OverlayBig","Get the Word app");x.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover Word");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")};c.prototype.LQg=function(x){x.add("Headline",
"Get the Office Online extension for Chrome");x.add("UseAppButton","Get the extension");x.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};c.prototype.OSg=function(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",
CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);x.add("OverlayBig","Get the PowerPoint app");x.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover PowerPoint");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")};c.prototype.NSg=function(x){x.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};c.prototype.YFa=function(x){x.add("Corporation","Microsoft Corporation")};c.prototype.f2h=function(x){switch(x){case 3:return this.KKc;case 2:return this.JKc;case 1:return this.IKc}return null};c.prototype.UJh=function(x){switch(x){case 3:return this.GFc;case 2:return this.EFc;case 1:return this.DFc}return null};
Ck.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Ma||(c.Ma=new c);return c.Ma}}});c.Ma=null;Object(z.a)(c,"WildFireStringFactory",null,[]);var h=b(4),y=b(39),r=b(24);b.d(E,"a",function(){return a});a.prototype.S3c=function(){this.Jpa=new m.a(this.title,this.message,null);this.Jpa.addButton(this.ewe,Object(f.a)(this,this.wvf,"onButtonOneClick"),"");this.yYa&&this.Jpa.jDg(this.gwe,Object(f.a)(this,this.zvf,"onButtonTwoClick"));this.Jpa.Y$=Object(f.a)(this,this.oJe,
"dismissBar");this.Jpa.image=3;this.Jpa.id=16;this.Jpa.closeable=!0};a.prototype.wvf=function(){this.yYa?this.xdi():this.TUj()};a.prototype.zvf=function(){this.yYa&&this.CVi()};a.prototype.xdi=function(){e.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Ljb&&this.Xlb&&this.Xlb();n.a.cOf(this._id,this.CPc)};a.prototype.CVi=function(){this.openUrl&&(e.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Ljb&&this.Xlb&&this.Xlb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(n.a.kre(this._id),
this.openUrl,0,!1))};a.prototype.TUj=function(){n.a.$xc?this.XSg():(e.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),n.a.vQd("BizBarClicked"),1!==this.CPc&&2!==this.CPc||n.a.wZg(this.openUrl,this.Ljb,this._id,this.Xlb))};a.prototype.XSg=function(){this.Ljb?e.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):e.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");y.a.MV(h.AFrameworkApplication.ga.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.ogh=function(){this.Ljb?
e.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):e.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");n.a.vQd(n.a.nze)};a.prototype.oJe=function(){n.a.$xc?this.ogh():(n.a.vQd(n.a.Vdd(this._id)),e.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.p5b=function(){var x=h.AFrameworkApplication.sa.Pa,t=new a(x.Sj,n.a.adc(),8<r.a.U5a,1===x.Lca,function(){return x.Sx},x.VVf());e.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return t};Ck.Object.defineProperties(a.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return this.vmb.oa("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.vmb.oa("CallToAction")}},bVj:{configurable:!0,enumerable:!0,get:function(){return this.yYa}},ewe:{configurable:!0,enumerable:!0,get:function(){return this.yYa?this.vmb.oa("InstallButton"):this.vmb.oa("UseAppButton")}},gwe:{configurable:!0,enumerable:!0,get:function(){return this.yYa?this.vmb.oa("OpenAppButton"):""}},TSg:{configurable:!0,enumerable:!0,
get:function(){return this.Jpa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.WOc||(this.WOc=this.$pg());return this.WOc}}});Object(z.a)(a,"WildFireBusinessBar",null,[])},1381:function(z,E,b){function a(n,w,h,y,r,x){var t=m.call(this,n,w,h,y,r,x)||this;n={};w=(n.errorMessage=t.eNe,n.offerString=t.Ttf,n);n=new f.a(!1,!1,!0);t.p4f?(n.jc=1,h={},w.helpLink=(h.type="AppLinkProps",h.id="helpLink",h.text=t.pwa,h.onExecute=function(){e.Redirect.showHelp(t.U8e)},h)):(n.jc=4,n.Bc(2,t.i$e));n.Bc(1,
t.pYb);n.Oe=t.id;h={};w=(h.id=t.id,h.dialogIcon=t.icon,h.bodyControls=w,h);n.initializeAndShow(t.Im,Object(c.a)(t,t.c6i,"reactOICErrorDialogWithTrialHandler"),w);return t}b.r(E);b.d(E,"ReactOICErrorDialogWithTrial",function(){return a});z=b(0);var c=b(82);E=b(1246);var e=b(440),f=b(149),m=E.a;Am(a,m);Object(z.a)(a,"ReactOICErrorDialogWithTrial",E.a,[])},1382:function(z,E,b){function a(m,n,w,h,y,r){m=f.call(this,m,n,w,h,y,r)||this;n=document.createElement("span");n.innerText=m.eNe;n.appendChild(document.createElement("br"));
n.appendChild(document.createElement("br"));w=document.createElement("span");w.innerText=m.Ttf;n.appendChild(w);w=new e.StandardDialog;m.p4f?(w.jc=1,w.Kme(m.pwa,m.U8e)):(w.jc=4,w.Bc(2,m.i$e));w.Bc(1,m.pYb);w.Oe=m.id;w.Ak(m.Im,null,m.icon,Object(c.a)(m,m.Ssi,"legacyOICErrorDialogWithTrialHandler"),n);return m}b.r(E);b.d(E,"OICErrorDialogWithTrial",function(){return a});z=b(0);var c=b(82);E=b(1246);var e=b(133),f=E.a;Am(a,f);Object(z.a)(a,"OICErrorDialogWithTrial",E.a,[])},1383:function(z,E,b){function a(){return c.call(this)||
this}b.r(E);b.d(E,"CheckRoamingRightsRequest",function(){return a});z=b(0);b=b(1248);var c=b.a;Am(a,c);a.prototype.J4a=function(){return 2};a.prototype.gba=function(){return 1};Object(z.a)(a,"CheckRoamingRightsRequest",b.a,[])},1384:function(z,E,b){function a(){return c.call(this)||this}b.r(E);b.d(E,"GetRoamingLauncherRequest",function(){return a});z=b(0);b=b(1248);var c=b.a;Am(a,c);a.prototype.J4a=function(){return 0};a.prototype.gba=function(){return 2};Object(z.a)(a,"GetRoamingLauncherRequest",
b.a,[])},1400:function(z,E,b){function a(h){this.TGc=!1;this.PXa=a.tfc;this.FQc=this.JOc=0;this.platform=null;this.Pvg=h;this.cke=this.GQc=!1}function c(){this.state=this.callback=null;this.vpd=!1}function e(){this.classId=0}z=b(0);var f=b(82),m=b(41);e.KIa=function(h){try{return m.a(h)}catch(y){}return null};Object(z.a)(e,"ARoamingAppsResponse",null,[]);Object(z.a)(c,"GetRoamingAppsLauncherContext",null,[]);var n=b(4),w=b(108);b.d(E,"a",function(){return a});a.prototype.SXg=function(){n.AFrameworkApplication.Khc&&
this.roamingAppsAreEnabled&&!this.GQc&&!this.TGc&&(this.FQc=1,this.TGc=!0,this.ghj(),this.rSe())};a.prototype.ghj=function(){this.PXa=a.tfc;this.JOc=0};a.prototype.getRoamingAppsLauncher=function(h,y,r){this.mVj?(h=new c,h.callback=y,h.state=r,h.vpd=!0,this.wSe(h)):y(!1,"",r)};a.prototype.rSe=function(){var h=new (b(1383).CheckRoamingRightsRequest);h.RoamingApp=this.FQc;h.BaseDocQuerySignature=n.AFrameworkApplication.oj;h.execute(Object(f.a)(this,this.UXg,"checkUserRoamingRightsSucceeded"),Object(f.a)(this,
this.TXg,"checkUserRoamingRightsFailed"),null)};a.prototype.UXg=function(h){n.AFrameworkApplication.Kg||((h=e.KIa(h.data.me))?this.xQd(h.HasRights):this.xQd(!1))};a.prototype.TXg=function(){if(!n.AFrameworkApplication.Kg)if(this.JOc>=a.hAi)this.xQd(!1);else{var h=new w.a(2,1,this.PXa,Object(f.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);n.AFrameworkApplication.Ri.Yg(h);this.JOc++;this.PXa*=a.xij;this.PXa>a.uqf&&(this.PXa=a.uqf)}};a.prototype.xQd=function(h){this.cke=
h;this.GQc=!0;this.TGc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.rSe()};a.prototype.wSe=function(h){var y=new (b(1384).GetRoamingLauncherRequest);y.RoamingApp=this.FQc;y.BaseDocQuerySignature=n.AFrameworkApplication.oj;y.execute(Object(f.a)(this,this.ZXh,"getRoamingAppsLauncherSucceeded"),Object(f.a)(this,this.YXh,"getRoamingAppsLauncherFailed"),h)};a.prototype.ZXh=function(h){if(!n.AFrameworkApplication.Kg){var y=e.KIa(h.data.me);h=h.data.state;y?(this.platform=y.Platform,h.callback(!0,
y.Launcher,h.state)):h.callback(!1,"",h.state)}};a.prototype.YXh=function(h){if(!n.AFrameworkApplication.Kg){var y=h.data.state;5===h.data.status&&y.vpd?(y.vpd=!1,this.wSe(y)):y.callback(!1,"",y.state)}};Ck.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Pvg}},mVj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.GQc?this.cke:!1}}});Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,
get:function(){return a.jC||(a.jC=new a(n.AFrameworkApplication.OLg))}}});a.tfc=1E3;a.xij=5;a.uqf=12E5;a.hAi=5;a.jC=null;Object(z.a)(a,"RoamingAppsManager",null,[])},1435:function(z,E,b){function a(N){return Tj.call(this,N)||this}function c(N,la,Ra){var Pb=this;this.ignorePrintArea=!1;this.OMj=function(){var vc=hg.g(Pb.$).Ea;Pb.ERc=!0;vc.wzd()};this.uQi=function(){Pb.yjd()};this.tQi=function(vc,ad,Fd){Kd.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",
Fd);Pb.yjd()};this.$=N;this.ea=N.ea;this.Nia=la;this.jO=new I(1,this.ignorePrintArea);this.yD=la=new e(N,la,be.AFrameworkApplication.Jd,Ra);this.$.da.Ga(418,la);this.DJf=new C(N);this.$.da.Ga(384,this);this.ERc=!1}function e(N,la,Ra,Pb){var vc=this;this.activeCell=this.selectedRange=this.ug=this.graphServiceEndpoint=null;this.B0=0;this.Vm=this.Cv=null;this.SH=new v;this.xk=new v;this.nca=0;this.p8a=null;this.YMb=!1;this.G3a=this.ZFb=null;this.Sqd=!1;this.n7a=this.gAb=this.Ohc=!0;this.Ima=this.sza=
this.INa=null;this.hzb=!1;this.m8a=null;this.H6a=this.bMc=!1;this.lBd=function(ad){if(!(ad&&ad.data&&ad.data.me&&ad.data.responseHeaders&&ad.data.me.length)){var Fd=ad?ad.data?ad.data.me?ad.data.responseHeaders?ad.data.me.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";vc.ug&&(ad=vc.BAa(Nc.a.instance.fa(1178)),vc.joa(ad,0));Kd.ULS.sendTraceTag(593266765,
0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Fd);vc.kLd&&(ad=Object(eh.a)(new jk.a,{extendedProperties:new Map}),ad.extendedProperties.set("InvalidParameterName",Fd),$g.Health.instance.recordQosError(Dh.a.FJf,[Hc.a.GJf],!1,!0,!0,!1,ad))}else if(0<vc.nca&&ad.data.id===vc.nca){if(ad.data.responseHeaders["Content-Type"]&&(Ng.a.contains(ad.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Ng.a.contains(ad.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){Kd.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ve=null;Ng.a.contains(ad.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ve=vc.C5g(ad));Fd={};vc.rEb(Fd,null,null,ve);ad.data.responseHeaders["Total-Pdf-PageCount"]?(ve=parseInt(ad.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),vc.hzb||(vc.lGd>=ve?vc.Ima=ve:vc.hzb=!0),vc.n7a&&vc.ug&&vc.ug.setPageRangeSettings(ve,vc.lGd,vc.hzb,vc.sza,
vc.Ima)):Kd.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Fd=sk.a.oi(ad.data.me),Hg.a.A$(Fd.Errors)||Ja.a(vc.$).rd.nE(Fd.Errors[0].MessageId),vc.H7i(Fd.Errors),vc.ug&&(ve=vc.BAa(Fd.Errors[0].Description),-1831476778===Fd.Errors[0].MessageId?(Kd.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),vc.joa(ve,0,Nc.a.instance.fa(1181))):vc.joa(ve,
0)),297284985===Fd.Errors[0].MessageId?Kd.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",Fd.Errors[0].MessageId):Kd.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Fd.Errors[0].MessageId);ad=ad.data.state;ad.$9c(Fd,ad.userContext,ad.methodName)}};this.kBd=function(ad){if(0<vc.nca&&ad.data.id===vc.nca){var Fd=bk.a.pg(ad.data);vc.ug&&vc.joa(vc.BAa(Fd[0].Description),
1);Kd.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Hg.a.Xc(Fd));Fd=ad.data.state;Fd.Paa(ad,Fd.userContext,Fd.methodName);vc.$.userOperationManager.vla.operation.Una(function(){return vc.YMb})}};this.DJi=function(ad,Fd,ve){ad.Errors&&0<ad.Errors.length&&vc.ug?(Hg.a.A$(ad.Errors)||Ja.a(vc.$).rd.nE(ad.Errors[0].MessageId),vc.joa(vc.BAa(ad.Errors[0].Description),0),Kd.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
ad.Errors[0].MessageId)):(Kd.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),vc.rEb(ad,Fd,ve,null))};this.CJi=function(ad){ad=bk.a.pg(ad.data);vc.ug&&vc.joa(vc.BAa(ad[0].Description),1);Kd.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Hg.a.Xc(ad));vc.$.userOperationManager.vla.operation.Una(function(){return vc.YMb})};this.cBf=function(ad,Fd){if(Fd)switch(Fd.I1i){case 1:if(vc.xk&&
vc.G3a)switch(ad=vc.G3a.zc,vc.G3a.stop(),vc.G3a=null,vc.xk.Xv){case 1:vc.D0c(ad,4800,"ActiveSheet");break;case 0:vc.D0c(ad,6100,"CurrentSelection");break;case 2:vc.D0c(ad,7500,"EntireWorkbook")}break;case 0:vc.ZFb&&(ad=vc.ZFb.zc,vc.ZFb.stop(),2400<ad&&(Fd=Object(eh.a)(new jk.a,{extendedProperties:new Map}),Fd.extendedProperties.set("PaneLoadTime",ad.toString()),$g.Health.instance.recordQosError(Dh.a.LDj,[Hc.a.Z5f],!1,!0,!0,!1,Fd)),vc.Cv.Kei(function(ve){vc.OBj(ve)}))}};this.PF=function(ad,Fd){(1===
Fd.uu&&vc.INa===Fd.Hg||2===Fd.uu)&&vc.XLd()};this.$=N;this.Nia=la;this.J3=Ra;this.Pzd=Pb;this.kLd=wh.HelperMethods.I_;this.Qa=new ke.a;this.lGd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.zzj();this.Dbi();this.agi=this.oXg();this.Rqd=cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!Pb&&Pb.Twa()&&cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Yf.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function f(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function m(){this.onBackToSheet=null}function n(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function w(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function h(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function y(N,la,Ra,Pb,vc,ad){var Fd=x.call(this,vc)||this;Fd.Od=!1;Fd.R5f=!1;Fd.rCd=function(ve){Fd.yD.rCd(ve)};Fd.DCd=function(ve){Fd.yD.DCd(ve)};Fd.$Ri=function(){Kd.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
Fd.ZRi=function(ve){ve=bk.a.pg(ve.data);Kd.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Hg.a.Xc(ve))};Fd.PF=function(ve,Me){2===Me.uu?Fd.Bv.clear():1===Me.uu&&Fd.Bv&&Fd.Bv.contains(Me.Hg)&&(Kd.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Sj.a(Me.Hg.operation.operationName),Me.Hg.dequeueUtcTime.getTime()-Me.Hg.enqueueUtcTime.getTime()),
Fd.Bv.remove(Me.Hg))};Fd.yD=N;Fd.jO=Ra;Fd.$=la;Fd.sheetName=Pb;Fd.locale=window.navigator.browserLanguage||window.navigator.language||Fd.$.ya.UICultureTag;Fd.lXi=Fd.E3g();Fd.$.userOperationManager.Wu(Fd.PF);Fd.Bv=new oa.a;Fd.isUniversalPrintEnabled=ad;return Fd}function r(N,la){this.sheetPrintOptions=this.sheetName=null;this.sheetName=N;this.sheetPrintOptions=la}function x(N){this.wEi=[.75,.75,.7,.7,.3,.3];this.jDi=[.75,.75,.25,.25,.3,.3];this.QXj=[1,1,1,1,.5,.5];this.$be=this.Tge=this.nee=this.Xde=
this.Ake=this.i7=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Zm=N;this.Sbi();this.$bi()}function t(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function u(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function B(){this.marginValue=this.printSettingOption=null}function v(){this.margin=this.Y0=this.Zca=this.orientation=this.Xv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.g2a=!1;this.NoColor=null}function C(N){var la=
this;this.ribbonCommandInfo=this.MFb=null;this.VMj=function(Ra,Pb,vc){Pb=!!Ra&&!!Ra.RequestTelemetryData;hg.g(la.$).Ki&&hg.g(la.$).Ki.Ola(la.lLa.oa(la.ribbonCommandInfo.command),Ra.StateId,Pb?Ra.RequestTelemetryData.EcsOperationDuration:0,Pb?Ra.RequestTelemetryData.EcsRequestDuration:0,Pb?Ra.RequestTelemetryData.WfeRequestDuration:0);wh.HelperMethods.I_&&la.jXg(vc)};this.$=N;this.lLa=new ak.a;this.dwa=new ak.a;this.dwa.add(78661008,12);this.dwa.add(275604654,13);this.dwa.add(-13332329,14);this.dwa.add(-837651977,
9);this.dwa.add(-1778266776,10);this.dwa.add(845325699,11);this.Rqd=cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function A(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function M(){this.Max=this.Min=this.Index=0}function T(){this.Col=this.Row=null}function R(N){this.sheetName=null;this.sheetName=N}function Q(N){this.sheetName=null;this.sheetName=N}function ea(N){this.sharedSheetCell=null;this.sharedSheetCell=N}function Z(N){this.sharedSheetCell=
null;this.sharedSheetCell=N}function ca(N,la){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=N;this.addToPrintArea=la}function I(N,la){this.j7=0;this.j9d=!1;this.Xv=N;this.ignorePrintArea=la}function H(N,la,Ra,Pb,vc,ad,Fd,ve){var Me=ha.call(this,N,la,Ra,Pb,vc,cf.EwaSettings.ma(399))||this;Me.oda=null;Me.Haa=null;Me.Yec=null;Me.UTd=!1;Me.Nxa=null;Me.vab=null;Me.uza=null;Me.EAa=null;Me.$5a=null;Me.Nza=1;Me.Vma=1;Me.A0=0;Me.j7=1;Me.VGb=!1;Me.ys=null;Me.NJb=0;Me.MJb=0;Me.vza=null;Me.FAa=
null;Me.selectedRange=null;Me.B0=0;Me.X9a=function(){Me.B0++;Me.j7=Me.h_c();Me.C8c(Me.Haa.checked?!0:!1);Me.b8&&(Me.Yec.disabled=Me.Bw.checked);Me.sPd(Me.Haa.checked?!0:!1);Kd.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Me.j7.toString());return!0};Me.Lvf=function(){Me.B0++;Me.VGb=Me.$5a.checked;Kd.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",Me.VGb.toString())};Me.inc=
function(){Me.B0++;Me.Nza=Me.Iwe();Kd.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Me.Nza.toString());return!0};Me.Mvf=function(){Me.B0++;var fg=Me.Vma;Me.Vma=H.paperSizeOptions[Me.uza.selectedIndex];Kd.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",fg.toString(),Me.Vma.toString());return!0};Me.Nvf=function(){Me.B0++;var fg=Me.A0;Me.A0=H.scalingOptions[Me.EAa.selectedIndex];2===Me.A0?
(Me.NJb=1,Me.MJb=0):3===Me.A0?(Me.NJb=0,Me.MJb=1):1===Me.A0&&(Me.NJb=1,Me.MJb=1);Kd.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",fg.toString(),Me.A0.toString());return!0};Me.lBd=function(fg){if(fg&&fg.data&&fg.data.me&&fg.data.responseHeaders&&fg.data.me.length){if(fg.data.responseHeaders["Content-Type"]&&Ng.a.contains(fg.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){Kd.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var gh={};Me.rEb(gh,null,null)}else gh=sk.a.oi(fg.data.me),Kd.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",gh.Errors[0].MessageId);fg=fg.data.state;fg.$9c(gh,fg.userContext,fg.methodName)}else Kd.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",fg?fg.data?fg.data.me?fg.data.responseHeaders?fg.data.me.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Me.kBd=function(fg){var gh=bk.a.pg(fg.data);Kd.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Hg.a.Xc(gh));gh=fg.data.state;gh.Paa(fg,gh.userContext,gh.methodName)};Me.rEb=function(fg){fg.Errors&&0<fg.Errors.length?Kd.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
fg.Errors[0].MessageId):(6===Me.Td.Xe&&be.AFrameworkApplication.sa.Qe.ek(hg.g(Me.$).ZWf),Kd.ULS.shipAssertTag(537154309,0,!!Me.$.xa.qa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),Me.$.xa.qa&&Me.Nia.Q4f(Me.dIa()))};Me.Nia=ad;Me.activeCell=Me.$.qa.activeCell.toString();Me.Vm.SelectedRanges&&Me.Vm.SelectedRanges.Ranges&&0<Me.Vm.SelectedRanges.Ranges.length&&Me.Vm.SelectedRanges.Ranges[0]&&(Me.selectedRange=vd.B(Me.Vm.SelectedRanges.Ranges[0]).toString());
Me.sheetName=Fd;Me.jO=ve;Me.WDd={};N=0;for(la=H.paperSizeOptions.length;N<la;++N)Me.WDd[H.paperSizeOptions[N].toString()]=N;Me.locale=window.navigator.browserLanguage||window.navigator.language||Me.$.ya.UICultureTag;Me.b8=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return Me}function L(N,la){this.printSettings=this.sheetName=null;this.sheetName=N;this.printSettings=la}function U(N,la,Ra,Pb,vc){N=ha.call(this,N,la,Ra,Pb,vc)||this;N.Btb=null;return N}
function fa(N,la,Ra,Pb,vc,ad,Fd,ve){ve=N.Na(1,void 0===ve?null:ve);ve.sheetName=la;ve.locale=Ra;return ce.i(N,"GetPrintSettings",ve,Pb,vc,ad,Fd,4)}function aa(N,la,Ra,Pb,vc,ad,Fd){Fd=N.Na(1,void 0===Fd?null:Fd);Fd.ConvertInParameters=la;return ce.i(N,"ConvertWorkbookToPrintPdf",Fd,Ra,Pb,vc,ad,4)}function na(N,la,Ra,Pb,vc,ad,Fd,ve){ve=N.Na(9,void 0===ve?null:ve);ve.sheetName=la;ve.printSettings=Ra;return ce.i(N,"SetSheetPrintSettings",ve,Pb,vc,ad,Fd,0)}function ha(N,la,Ra,Pb,vc,ad){N=Xi.call(this,
N,la,Ra,void 0===ad?!1:ad)||this;N.Bw=null;N.Vm=Pb;N.DRb=vc;return N}function ka(){this.p6d=this.tb=null}function xa(N,la,Ra,Pb,vc,ad,Fd,ve,Me,fg){this.XXb=null;this.kog=N;this.Pkb=la;this.xOc=Ra;this.xrg=Pb;this.dsg=vc;this.OPc=new Gf.a(Object(af.a)(this,this.yWh,"getProbeResults"));this.WVa=ad;this.obe=Me;this.txg=Fd;this.esg=ve;this.lsg=fg}function va(N,la){this.s8f=N;this.uTa=la}function Aa(N){this.isEnabled=Boolean.parse(N.DirectPrintIsEnabled||"false");Boolean.parse(N.DirectPrintProbeIsEnabled||
"false");this.fki=Boolean.parse(N.DirectPrintEnabledForInternetExplorer||"false");this.tTa=(N.DirectPrintSupportedMimeTypes||"").split(Aa.d7c);this.uTa=(N.DirectPrintSupportedPlugins||"").split(Aa.d7c);this.H9h=(N.DirectPrintImmersivePreviewPlugins||"").split(Aa.d7c);this.Udf=Boolean.parse(N.DirectPrintEnabledForEdge||"false");this.Qgi=Boolean.parse(N.ChromePrintLayoutFixIsEnabled||"false");this.fYg=parseInt(N.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Cxd=14;this.jrf=14394;if(N=N.DirectPrintMinimalSupportedEdgeVersion){var la=
N.split(".");2===la.length?(this.Cxd=parseInt(la[0]),this.jrf=parseInt(la[1])):Kd.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",N)}else Kd.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}function qa(N,la,Ra,Pb,vc){Ra=void 0===Ra?null:Ra;Pb=void 0===Pb?!0:Pb;vc=void 0===vc?!1:vc;la=Wb.call(this,N,!0,!(qa.sUa&&Pb),new Kc(N,la),Ra,vc)||this;qa.sUa=qa.sUa&&Pb;if(qa.sUa){Pb=
document.createElement("iframe");vc=null;var ad=la.Bfh;Pb.name="pdfObjectFrame";Pb.id="pdfObjectIFrame";if(Ra&&0<Ra.count){var Fd=Ug.a.Jgd(N,Ra);N=Ug.a.HJd(N,Ra);vc=document.createElement("form");vc.id="printPreviewPostForm";vc.method="POST";vc.target=Pb.name;vc.action=N;N=Cl(Fd);for(Ra=N.next();!Ra.done;Ra=N.next())Ra=Ra.value,Fd=document.createElement("input"),Fd.type="hidden",Fd.name=Ra.key,Fd.value=Ra.value,vc.appendChild(Fd)}else Pb.src=N;ad.appendChild(Pb);vc&&(ad.appendChild(vc),vc.submit());
Sys.UI.DomElement.addCssClass(Pb,"DirectPrintPdfObjectHidden");tg.a.dh(Pb,tg.a.qC,tg.a.yj)}return la}function wa(N){this.MP=N}function Ta(N,la,Ra,Pb){Pb=void 0===Pb?null:Pb;var vc=ni.call(this)||this;vc.rqa=null;vc.em=null;vc.QP=null;vc.fn=[];vc.qVb=la;vc.MP=N;vc.tqg=Ra;vc.DWb=Pb;vc.umb=new mh.a("LoadResource","LoadPrintablePdf");return vc}function sb(N){var la=gi.call(this)||this;la.$=N;la.Tb();return la}function db(N){this.stopwatch=this.M_b=this.pAc=this.eWd=null;this.s9f=0;this.$=N;(this.yXc=
cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||N.da.Ga(322,this)}function kb(N){this.jje=0;this.t9f=N}function ac(N,la,Ra,Pb,vc,ad,Fd){this.title=N;this.body=la;this.A1i=Ra;this.primaryButtonAction=Pb;this.secondaryButtonAction=ad;this.AXf=vc;this.targetObject=Fd}function ta(N){var la=Gh.call(this)||this;la.$=N;la.Tb();return la}function ra(N){this.$=N;N.da.Ga(309,this)}function Na(N){var la=lg.call(this,N)||this;la.fp=null;la.stopwatch=null;la.eDi=function(Ra){if(1===Ra)la.$.Ka.$b(new cg.a(-2050946363,
Ha.a.Vb,2,8,null)).continueWith(function(vc){la.fp.setResult(!gc.a(vc)&&vc.result)}),Ra="Yes";else{var Pb=2===Ra;la.fp.setResult(Pb);Ra=2===Ra?"No":"Close";Pb&&la.o1i()}la.jwi(Ra);la.hide()};return la}function gb(){}function ob(N){return mf.call(this,N)||this}function wb(N){this.Ei=N}function Oa(N){var la=Be.call(this)||this;la.$=N;la.Tb();return la}function sa(N){N.da.Ga(446,this)}function Fa(N){return Qd.call(this,N)||this}function Wa(N,la){var Ra=this;this.sortOptions=this.Yyc=this.selectedRange=
null;this.qdf=!1;this.activeCell=this.$f=this.Db=this.Gc=null;this.qTi=function(Pb,vc){mj.b(Pb,-901005882)?(Ja.a(Ra.$).rd.nE(-901005882),Ra.MGd(vc)):Ra.j8e(Pb)?Ra.X6e(Pb.Errors[0]):!mj.a(Pb)&&Pb.Result&&(Ra.sortOptions=vc,Ra.Yyc=vd.D(Pb.Result.ActualSortRange),Ra.Pkf=Ra.ha().Iia,Ra.qdf||(Ra.selectedRange=Ra.ha().ta.ud,Ra.selectedRange.equals(Ra.Yyc)||Ra.pCj()),Ra.sortOptions&&Ra.sortOptions.ActiveCell&&(Pb=Ra.sortOptions.ActiveCell,Pb=new Nj.Range(Pb.FirstRow+1,Pb.FirstColumn+1,Pb.FirstRow+1,Pb.FirstColumn+
1,!0,!1),Ra.QL(Pb),Ra.QXd(Pb)))};this.onContentReady=function(){Ra.MOf(!1);var Pb=Ra.ha();Pb.ta.Lg&&Pb.ta.ud.equals(Ra.Yyc)&&Pb.updateSelection(Ra.selectedRange,Pb.ta.activeCell,0,void 0,void 0,void 0,!0)};this.QMi=function(Pb,vc){Pb&&!Hg.a.rh(Pb.Errors)&&Ra.Gc&&(Ra.Gc.Yo=Pb.Result,Ra.DKb(),Ra.applyPivotSort(vc))};this.PMi=function(){};this.$=N;this.Pkf="";this.namedSheetViewPublic=la;this.gridView=hg.g(this.$);this.$.Ob.$g("LoadResource","LoadDialogControlsStopwatch")}function Db(N,la,Ra,Pb,vc,ad,
Fd){Fd=N.Na(41,void 0===Fd?null:Fd);Fd.options=la;return ce.i(N,"Sort",Fd,Ra,Pb,vc,ad,0)}function pc(N){this.filterRange=null;this.filterRange=N}function lc(N){this.selection=null;this.selection=N}function eb(N,la,Ra,Pb){var vc=xc.call(this,N)||this;vc.eSd=!1;vc.Egc=!1;vc.d7=[];vc.Nei=function(ad,Fd){var ve=vc.s7g(ad);vc.fMa(214,function(Me,fg,gh){return ce.H(vc.$.na.va,ve,vc.e0a(Me,vc.qHh(Fd)),vc.UU(fg),gh,null)},16,!0)};vc.Mei=function(ad,Fd,ve){ad=ce.G(vc.$.na.va,Fd,vc.aIh(Fd,ve),vc.gNi,null,ad);
vc.d7.push(ad)};vc.gNi=function(){Kd.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");vc.c7b(eb.Hrb())};vc.Y6c=function(ad,Fd){if(1===ad){ad=Fd.sortRangeType;var ve={};ve.SortOptions=Fd.sortOptions;ve.ShouldRestoreSelection=vc.eSd;ve.SelectedRange=vc.selectedRange;ve.OriginalActiveCell=vc.upc;ve.TopCellAddress=vc.PTa;ve.ShouldPromptNamedSheetViewTeachingDialog=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?
0===ad||3===ad:!1;if(!cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&vc.gyj(ad)){var Me=vc.$;vc.namedSheetViewPublic.jBa().continueWith(function(fg){fg.result&&eb.PLf(Me,ve)})}else eb.PLf(vc.$,ve)}else vc.eSd&&vc.bpa(vc.selectedRange,vc.upc)};vc.h8h=function(ad,Fd){vc.eSd=!0;vc.bpa(ad,Fd)};vc.getColorName=function(ad){return Qk.a.OKa(bl.a.wH(ad))};Kd.ULS.shipAssertTag(529105669,0,!!la.ActiveCell);Kd.ULS.shipAssertTag(529105668,0,!!la.SelectedRange);Kd.ULS.shipAssertTag(529105667,
0,vd.D(la.SelectedRange).contains(vd.C(la.ActiveCell)));Kd.ULS.shipAssertTag(529105666,0,Ng.a.equals(la.SelectedRange.SheetName,la.ActiveCell.SheetName,!0));cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(vc.Hcb=new Vb.a(N,fb.a.Bbh,function(){return vc.Egc},1));vc.selectedRange=la.SelectedRange;vc.upc=la.ActiveCell;vc.LUg=la.ExpandSelection;vc.namedSheetViewPublic=Ra;vc.PTa=Pb;vc.initializeAndShow(Nc.a.instance.fa(182),vc.Y6c,vc.Fta(la));return vc}function ib(N,la){N=
Ba.call(this,N,la)||this;N.aDb=N.tdd();N.Fr();return N}function cc(N,la){var Ra=N.SortRange;N=N.SortTopToBottom?Ra.LastColumn-Ra.FirstColumn:Ra.LastRow-Ra.FirstRow;return 0<=la&&la<=N}function Pa(N,la){if(!N.SortColumnInfoItems)return Kd.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Ra=new oa.a,Pb=Cl(N.SortColumnInfoItems),vc=Pb.next();!vc.done;vc=Pb.next()){vc=vc.value;if(!cc(N,vc.ColumnOffset))return Kd.ULS.sendTraceTag(537151617,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",vc.ColumnOffset,N.SortRange),!1;if(!vc.Name)return Kd.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",vc.ColumnOffset),!1;if(vc.CellColors&&!vc.CellColors.length)return Kd.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",vc.CellColors.length),!1;if(vc.TextColors&&
!vc.TextColors.length)return Kd.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",vc.TextColors.length),!1;if(vc.Icons&&!vc.Icons.length)return Kd.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",vc.Icons.length),!1;Ra.add(vc.ColumnOffset)}if(N.SortConditions)for(Pb=Cl(N.SortConditions),vc=Pb.next();!vc.done;vc=Pb.next())if(vc=vc.value,!Ra.contains(vc.RowColOffset))return Kd.ULS.shipAssertTag(537151584,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",vc.RowColOffset),!1;if(N.HeaderColumnInfoItems){if(N.HeaderColumnInfoItems.length!==N.SortColumnInfoItems.length)return Kd.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Ra=0;Ra<N.HeaderColumnInfoItems.length;++Ra){Pb=N.HeaderColumnInfoItems[Ra];if(la&&Pb.ColumnOffset!==N.SortColumnInfoItems[Ra].ColumnOffset)return Kd.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Pb.CellColors&&1<Pb.CellColors.length)return Kd.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Pb.TextColors&&1<Pb.TextColors.length)return Kd.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(Pb.Icons&&1<Pb.Icons.length)return Kd.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function nc(N){if(!N.SortConditions)return!0;for(var la=Cl(N.SortConditions),Ra=la.next();!Ra.done;Ra=la.next()){Ra=Ra.value;if(!cc(N,Ra.RowColOffset))return Kd.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Ra.RowColOffset,
N.SortRange),!1;if(1===Ra.SortConditionType&&Ra.FillGradient&&!rb.isValid(Ra.FillGradient))return Kd.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function pb(N){return N.SortRange?4===N.SortRangeType?(Kd.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",N.SortRangeType),!1):2===N.SortRangeType&&N.SortTopToBottom&&(null==N.HeaderRowSize||
0>N.HeaderRowSize)?(Kd.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(Kd.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function rb(){}function Ya(N,la,Ra,Pb){new Sys.UI.Point(N,la);new Sys.UI.Point(Ra,Pb)}function ec(){}function yd(N,la,Ra,Pb){N=N.HeaderColumnInfo;return Pb||N?2===la&&Ra?N.CellColors&&1!==N.CellColors.length?
(Kd.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):N.TextColors&&1!==N.TextColors.length?(Kd.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):N.Icons&&1!==N.Icons.length?(Kd.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),
!1):!0:N?(Kd.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Ra),!1):!0:!0}function Ub(N,la){N=N.ColumnInfo;switch(la){case 1:return N.CellColors&&N.CellColors.length?!0:(Kd.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case 2:return N.TextColors&&N.TextColors.length?!0:(Kd.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return N.Icons&&N.Icons.length?!0:(Kd.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return Kd.ULS.sendTraceTag(537151628,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Ob(N){var la=this;this.Dw=function(Ra){switch(Ra){case 0:la.jOa("Cancel");break;case 1:la.jOa("Expand and sort");la.ESe(!0);break;case 2:la.jOa("Just sort"),la.ESe(!1)}};this.ESe=N}function Yb(N,la,Ra,Pb,vc,ad,Fd){Fd=N.Na(41,void 0===Fd?null:Fd);Fd.filterRange=la;return ce.i(N,"ReapplyAutoFilter",Fd,Ra,Pb,vc,ad,0)}function xb(N){this.options=null;this.options=N}function Sa(N){return ik.call(this,
N)||this}function Tb(N,la,Ra){var Pb=Bk.call(this)||this;Pb.Ywe=!1;Pb.Xwe=!1;Pb.THi=function(){Pb.Ywe=!0;Pb.U3f()};Pb.$=N;Pb.Sa=la;Pb.jK=Ra;Ja.a(Pb.$).GId(new Vk.a(ih.a.Lcg,ih.a.idle,Tb.HWg),new Uk.a(ih.a.AAe,ih.a.h0,null,ih.a.lP,ih.a.idle));return Pb}function Cc(N){var la=vk.call(this,N,Nc.a.instance.fa(1238))||this;la.textBox=null;la.FRa=null;la.dUa=null;la.VEf=function(){var Ra=la.$;la.Ut();var Pb=new Fb(Ra,1241,1242,1243,function(vc,ad,Fd){var ve=Ra.na.va.hc(),Me=Ra.na.va;ve=Me.Na(1,ve);return ce.i(Me,
"UnshareForm",ve,vc,ad,Fd,null,0)},16);Pb.initialize();Pb.kf()};return la}function Fb(N,la,Ra,Pb,vc,ad){ad=void 0===ad?0:ad;N=Ai.call(this,N,Nc.a.instance.fa(la),!1)||this;N.message=Ra;N.AGi=Pb;N.q0d=vc;N.operationFlags=ad;return N}function hc(N,la,Ra){var Pb=K.call(this,N,new Sys.UI.Point(hc.udh,hc.Xch),Nc.a.instance.fa(la?1236:1235))||this;Pb.n1a=null;Pb.TLc=!1;Pb.fpc=function(vc){function ad(fg,gh,Wh){return ce.F(Fd.na.va,th.b(fg,Pb.ASi),gh,Wh,ve)}var Fd=Pb.$,ve=new cd;ve.JH=vc.Values[mb.JH];var Me=
!1;switch(vc.MessageId){case mb.N1f:Pb.Ut();Me=!0;ve.hFd=1334518759;break;case mb.view:Pb.OBa=Nc.a.instance.fa(1236);Pb.Keg(!0);break;case mb.sAe:Pb.Ut(),Me=!0}cf.EwaSettings.qc()?(vc=new Jb.a(140,0,ad),vc.flags=Me?16:80):(vc=Me?new Jb.a(140,0,ad):new Ii.a(140,0,ad),vc.flags=16);Fd.userOperationManager.ic(vc,Pb.Td)};Pb.DKi=function(){var vc=Pb.$;vc.ya.SurveyRedirectUrl?(Pb.Ut(),vc.Zd(1305810481,0,8,null)):(Pb.OBa=Nc.a.instance.fa(1235),Pb.Keg(!1))};Pb.OSi=function(){var vc=Pb.$;Pb.Ut();vc.Zd(1334518759,
0,8,null)};Pb.hwf=function(vc){var ad=Pb.$;Pb.Ut();vc.MessageId===mb.CAe&&ad.ea.ycd()};Pb.hRi=function(){Pb.TLc=!0;Pb.raiseEvent(hc.eud)};Pb.ASi=function(vc,ad){if(!mj.a(vc)){vc=Pb.$;if(ad.JH){var Fd=vc.ea.xa;if(Fd.contains(ad.JH.SheetName))Pb.Unc(ad);else{var ve=null;ve=function(){Fd.jna(ve);Pb.Unc(ad)};Fd.pha(ve)}}1461300262!==ad.hFd&&vc.Zd(ad.hFd,0,8,null)}};Pb.U$d=la;Pb.Td=Ra;return Pb}function cd(){this.JH=null;this.hFd=1461300262}function mb(){}function $a(N){N=K.call(this,N,new Sys.UI.Point(960,
680),Nc.a.instance.fa(1231))||this;N.name=ja.a.NLe;return N}function K(N,la,Ra,Pb){var vc=Kk.call(this,N,Ra,2,void 0===Pb?null:Pb)||this;vc.FKc=null;vc.onResize=function(){var ad=vc.TRh();vc.QLa.setAttribute("width",ad.x.toString());vc.QLa.setAttribute("height",ad.y.toString());vc.JRj(ad);vc.EBd()};vc.Qlh=function(){var ad=vc.Tx.parentNode.style,Fd=ad.top;ad.top="2px";ad.top=Fd};vc.OHe=la;vc.$.RA(vc.onResize);vc.pec();return vc}function ba(N){return gl.call(this,N)||this}function ua(N){this.$=N}function La(N,
la,Ra,Pb,vc,ad,Fd,ve){ve=N.Na(9,void 0===ve?null:ve);ve.sheetName=la;ve.directionRtl=Ra;return ce.i(N,"ChangeSheetDirection",ve,Pb,vc,ad,Fd,0)}function ub(N,la,Ra,Pb,vc,ad,Fd,ve){ve=N.Na(9,void 0===ve?null:ve);ve.sheetName=la;ve.show=Ra;return ce.i(N,"ShowHeadings",ve,Pb,vc,ad,Fd,0)}function Va(N,la,Ra,Pb,vc,ad,Fd,ve){ve=N.Na(9,void 0===ve?null:ve);ve.sheetName=la;ve.show=Ra;return ce.i(N,"ShowGridlines",ve,Pb,vc,ad,Fd,0)}function tb(N,la){this.sheetName=null;this.value=!1;this.sheetName=N;this.value=
la}function Cb(N,la){var Ra=jj.call(this)||this;Ra.activityName=N;Ra.MM=la;Ra.Tb();return Ra}function nb(N,la,Ra,Pb,vc){N=fl.call(this,N,la)||this;nb.xwd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];nb.wwd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];nb.Bpf=[-1468309555,611268539,-1750576502,61029505];nb.Apf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];N.Fyc=Ra;N.KCj=Pb;N.SLj=vc;return N}function Ib(){var N=
rk.call(this)||this;N.Tb();return N}function hb(N,la){return $k.call(this,N,la)||this}function zb(N){var la=rl.call(this)||this;la.$=N;la.Tb();return la}function Gc(N,la){this.$=N;this.Ei=la;this.$.da.Ga(393,this)}function Fc(N){var la=Tk.call(this,N)||this;la.TEh=function(Ra,Pb,vc,ad,Fd){return 1===vc?32:Ra===Zf.a.yRa&&2===vc?(Ra=la.$.na.va.hc(),ce.ab(la.$.na.va,Fd[0],Fd[1],null,null,Ra),32):8};return la}function Ed(N,la){this.$=N;this.Ei=la}function Jc(N){return el.call(this,N)||this}function Ca(N,
la){var Ra=this;this.zRi=function(Pb,vc){if(!mj.a(Pb)&&vc){var ad=!!Pb&&!!Pb.RequestTelemetryData;hg.g(Ra.$).Ki.Ola(vc,Pb.StateId,ad?Pb.RequestTelemetryData.EcsOperationDuration:0,ad?Pb.RequestTelemetryData.EcsRequestDuration:0,ad?Pb.RequestTelemetryData.WfeRequestDuration:0)}};this.WIi=function(Pb,vc){vc&&vc.J0b&&vc.J0b.SheetName&&vc.J0b.Ranges.length&&vc.bhi&&cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Pb=zk.d(Ra.$.xa.qa),Ra.G_g(new Jk.a(vc.J0b.Ranges[0],
Pb)))};this.$=N;this.Sg=la}function bb(N,la){var Ra=Dk.call(this,N)||this;Ra.hwb=function(Pb){Pb=Ra.Tfd(Pb);return Ra.mdd(Pb)};Ra.yhj=function(Pb,vc){var ad=Ra.FAb=vc[bb.Mhi];1===Pb?(Pb=vc[bb.RCj],ad=Ra.O4e(Pb,ad),Kd.ULS.shipAssertTag(537153996,0,ad!==bb.Lba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Pb),Pb=ad!==Ra.Dmd,Kd.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Ra.isRow,Ra.FAb,
ad,Pb),Pb&&Ra.c5g(ad)):Kd.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Ra.isRow)};Ra.isRow=2040891415===la.command;Ra.gridView=hg.g(Ra.$);Ra.muc=new Gb(Ra.$.workbookContext.DxDigitNormal);Ra.Dmd=Ra.jUg();N=Ra.P3g(Ra.Dmd);la=Ra.R3g(Ra.Dmd);Ra.Im=Nc.a.instance.fa(Ra.isRow?476:477);N=Ra.$V(N,la);Ra.initializeAndShow(Ra.Im,Ra.yhj,N);Kd.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Ra.isRow);return Ra}function dc(N){this.resizeParameters=
null;this.resizeParameters=N}function Ac(N,la){this.isRow=!1;this.autoFitRange=null;this.isRow=N;this.autoFitRange=la}function nd(){var N=nj.call(this)||this;N.Tb();return N}function qd(N,la){var Ra=hk.call(this,la.domElement)||this;Ra.dUf=!1;Ra.BY=!1;Ra.jTa=null;Ra.o8a=null;Ra.im=null;Ra.ILd=!0;Ra.offset=0;Ra.wl=0;Ra.LJb=0;Ra.s1=null;Ra.xX=null;Ra.jN=null;Ra.g7h="headerResizeTooltip";Ra.uvd=null;Ra.wG=null;Ra.vAa=!1;Ra.SWa=!1;Ra.uYc=!1;Ra.$N=function(Pb){if(Ra.grid.Nq)return!1;Pb=Oj.a(Ra.grid.$).qe(Pb);
if(3===Pb.yb&&!Ra.Mif(Pb.Ca)||!Ra.QIf(Pb,!1))return!1;Kd.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var vc=Ra.zyc();Ra.vdd(Pb.clientPoint,vc,!0);Ra.vAa||(Gj.a.instance.pa(pg.a.yh,Ra.domElement.ownerDocument.body,Ra.a$a),bi.a.instance.pa(pg.a.wg,Ra.domElement.ownerDocument.body,Ra.a$a),Ra.vAa=!0);Ra.Pef()&&Ra.BY&&Ra.C$e(Pb);return!1};Ra.tEb=function(Pb){Pb=Oj.a(Ra.grid.$).qe(Pb);Ra.Pef()&&Ra.uYc&&Ra.C$e(Pb);if(cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!Pb.Ca.type.includes("touch")&&
Pb.Ca.button!==Sys.UI.MouseButton.leftButton||!Ra.z7a)return!1}else if(Pb.Ca.button!==Sys.UI.MouseButton.leftButton||!Ra.z7a)return!1;Jj.g(Pb.Ca);Ra.mMe();Pb=Oe.a.q6a;Ra.im&&(Pb=Ra.SWa?Ra.Ted():Ra.im.Uja());var vc=Pb!==Ra.wl;if(Ra.jTa&&vc&&Pb!==Oe.a.q6a){Pb=Ra.grid;vc=Ra.W2e(Pb);var ad={};ad.SheetMultiRange=vd.r(vc,Pb.$);qd.eQd(ad,Ra.isRow,Ra.wl);Ra.Elh(ad);Pb.dIj=!0}else Ra.wh(null,null),Ra.Rsc();return Ra.SWa=!1};Ra.Oca=function(Pb){Pb=Hk.a.create(Pb.eventName,Pb.Mb,Pb.Ca,Pb.yb);Pb=Oj.a(Ra.grid.$).qe(Pb);
if(!Ra.QIf(Pb,!0))return!1;Pb=Ra.grid;var vc=Ra.W2e(Pb);vc=vd.r(vc,Pb.$);Pb.Cb.Xh([Ra.isRow?13:14]);Pb.Cb.eeb();Ra.Rsc();var ad={};Pb.$.Zd(Ra.isRow?146338636:1391094586,Ha.a.Vb,30,(ad.autoFitRanges=vc,ad));return!1};Ra.jzf=function(Pb){Pb=new Sys.UI.DomEvent(Pb);Pb=Hk.a.create(pg.a.Msa,Ra.domElement,Pb,2);Ra.kzf(Pb.clientPoint,void 0)};Ra.lzf=function(Pb){Pb=new Sys.UI.DomEvent(Pb);Pb=Hk.a.create(pg.a.Msa,Ra.domElement,Pb,2);Ra.tEb(Pb)};Ra.ENi=function(Pb){Ra.Sya(Pb,Ra.im)};Ra.a$a=function(Pb){Pb=
Oj.a(Ra.grid.$).qe(Pb);cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")&&Jj.g(Pb.Ca);return Ra.kzf(Pb.clientPoint,Pb.Ca)};Ra.lS=function(Pb){if(Ra.grid.Nq)return!1;Pb=Oj.a(Ra.grid.$).qe(Pb);var vc;if(!Ra.ohf||-1!==Ra.grid.ha.selectionType)return li.a(Ra.grid.$).Oq()&&(vc=Ra.Gfd(Pb))&&(vc.mwa.style.cursor=""),!1;if(Ra.BY)return Ra.Xaf(),!1;vc=Ra.Gfd(Pb);if(!vc)return!1;vc.mwa.style.cursor=!Ra.grid.isEditing&&Ra.Fsd(vc)?Ra.isRow?"row-resize":"col-resize":
"";Jj.g(Pb.Ca);return!0};Ra.Fp=function(){Ra.Rsc()};Ra.wh=function(){if((3===Ha.a.Vb||Mf.a.xp)&&Ra.grid.ha.ta.Lg){var Pb=Ra.grid.ha.ta.ud;if(!(!Pb.isRow&&!Pb.ff||!Ra.domElement||Pb.isRow&&Ra.isRow&&!Array.contains(Ra.tf.Sn,Pb.top)||Pb.ff&&!Ra.isRow&&!Array.contains(Ra.tf.Sn,Pb.left))){var vc=Ra.grid.qg(Pb,Ra.tf.zj.paneType);if(vc){if(Ra.grid.Nq){var ad=Ra.isRow?Pb.top:Pb.left;Ra.im=Ra.tf.ks(Nj.Range.hd(Pb.top,Pb.left));if(!Ra.im){Kd.ULS.sendTraceTag(522826880,2,50,"HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index "+
ad+", is row "+Ra.isRow);return}}Ra.wG||Ra.xah();Pb.isRow&&Ra.isRow?(ze.DOMElementExtensions.setVisible(Ra.wG,!0),Ra.wG.style.top=vc.bottomRight.y-Ra.wG.offsetHeight/2+"px"):Pb.isRow||Ra.isRow||(ze.DOMElementExtensions.setVisible(Ra.wG,!0),Lk.c(Ra.wG.style,Ra.grid.rtl,vc.bottomRight.x-Ra.wG.offsetWidth/2+"px"))}}}};Ra.OF=function(Pb,vc){vc.WP&&Ra.iqb()};Ra.tf=la;Ra.isRow=la.isRow;Ra.rtl=la.zj.rtl;Ra.grid=N;Ra.iqf=Ra.isRow?Oe.a.Ywd:Oe.a.qlc;Ra.c7h=Nc.a.instance.fa(435);Ra.l7h=Nc.a.instance.fa(434);
Ra.f7h=Nc.a.instance.fa(436);qg.a(Ra.grid.$,function(Pb){Ra.uvd=Pb.CQ(Zc.a.Ghj,!1)});Ra.U8i();Ra.grid.ha.bZ(Ra.wh);Ra.grid.ha.k3(Ra.Fp);Ra.grid.Nt(Ra.wh);li.a(Ra.grid.$).tg.qha(Ra.OF);return Ra}function Gb(N){this.Z7c=N}function Oc(N,la,Ra,Pb,vc,ad,Fd){this.mwa=N;this.iDb=la;this.YOa=Ra;this.wkd=Pb;this.rcb=vc;this.Lif=ad;this.j6h=Fd}function he(){}function Wd(N){var la=Ij.call(this)||this;la.$=N;la.Tb();return la}function rc(N){var la=this;this.Poa=this.xWe=this.LGb=this.O2a=this.Qqc=this.lda=this.cQa=
null;this.zrd=this.xOb=this.FMd=!1;this.KLb=!0;this.Kgc=!1;this.gTd=!0;this.wOb=this.u1a=this.HCe=0;this.Jvc={};this.Gpc={};this.Fpc={};this.dJf=0;this.J7a=this.T$d=!1;this.Vaj=function(){ze.DOMElementExtensions.toggleCssClass(la.$.kr,"ewr-presentMode-transition",!1);$removeHandler(la.O2a,"transitionend",la.Poa)};this.fj=function(){parseInt(la.$.xw.style.right,10)!==la.HCe&&window.requestAnimationFrame(function(){la.eCc(0);la.$.Uza(sc.a.i_("PresentModeManager.OnContentAreaResized"))})};this.gza=function(){var Ra=
Object(V.a)(Vf.a,la.$.qa);if(Ra&&la.Jz){la.gridView.Hpd=!1;Ra=Ra.headersVisible;var Pb=hg.g(la.$).rtl;ze.DOMElementExtensions.toggleCssClass(la.$.kr,"ewr-presentMode-on-headers-off",!Ra);ze.DOMElementExtensions.toggleCssClass(la.$.kr,"ewr-presentMode-on-rtl",Pb);(12!==la.u1a&&!Ra||32!==la.u1a&&Ra&&!Pb||0!==la.u1a&&Ra&&Pb)&&window.requestAnimationFrame(function(){la.eCc(2)})}};this.zd=function(){la.hcf();la.zh("OnWorkbookOpened");Kd.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Fp=function(){la.zrd=!0;la.Vea("OnSelectionStarted")};this.wh=function(){la.zrd=!1;la.Vea("OnSelectionEnded");la.nWf()};this.gj=function(){la.Vea("OnEditStarted")};this.Ng=function(){la.Vea("OnEditEnded")};this.Ww=function(){if(!la.Kgc){var Ra=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");la.Vea("OnVisibleAreaChanged",!0,Ra)}};this.eEb=function(){la.Kgc=!0};this.Dp=function(){la.Vea("OnCurrentSelectionModeChanged");la.nWf();la.zh("OnCurrentSelectionModeChanged")};
this.Tm=function(){la.Vea("OnBlockCacheItemEvicted")};this.zf=function(){la.Vea("OnBlockCacheItemChanged")};this.MF=function(){la.Kgc||la.Vea("OnActiveItemPanesChanged")};this.ii=function(){la.Kgc=!1;la.lda.zh("ActiveSheetChanged");la.gza()};this.oFb=function(Ra,Pb){if(Ra=Object(V.a)(Vf.a,Pb.item))Ra.sqb(16,!0),Ra.hob(la.gza)};this.CLi=function(){gd.pji||(la.Qqc&&la.Qqc.Pq&&la.Qqc.hide(),hg.g(la.$).isEditing&&hg.g(la.$).Kp(!0),la.tyc(!1),Kd.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.DLi=function(){Kd.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=N;this.gridView=hg.g(this.$);this.Alj=N.ya.PresentModeRenderUpdateTimeout;this.initialize(N)}function gd(){}function kd(N,la){var Ra=ck.call(this,N)||this;Ra.g1i=function(){Ra.lda.bTd(!0)};Ra.lda=la;Ra.domElement.classList.add("ewr-presentMode-on");N={};N=(N[kd.ay]=Ra.Cc,N);Ra.jc=0;Ra.initializeAndShow("",Ra.g1i,N);return Ra}function Qc(N){this.L_a=this.HFd=
null;this.$=N;this.gridView=hg.g(this.$)}function de(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function Xe(){this.height=this.width=0}function ge(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function fc(N){var la=this;this.nte=this.aQa=this.FFd=this.GFd=this.kda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.uqc={};this.tqc={};this.YPa=null;this.WHf=0;this.onKeyDown=function(Ra){Ra=Ra.Ca;if(9===Ra.keyCode){var Pb=
la.kda.querySelectorAll(ze.DOMElementExtensions.sr),vc=ze.DOMElementExtensions.Lm(Pb);Pb=ze.DOMElementExtensions.oB(Pb);ze.DOMElementExtensions.Ona(Ra,vc,Pb);return!0}return!1};this.Rl=function(){var Ra=[];la.$.da.$a(337,function(Pb){la.aQa.getPresentModeFloatieControlsMap().then(function(vc){for(var ad={},Fd=0;Fd<vc.length;Fd++)ad[vc[Fd].controlId]=vc[Fd].modelType;Ra.push.apply(Ra,Pb.rda.W4a(ad));0<Ra.length&&appChrome.api.dispatch(Ra);la.Qkj()})})};this.$=N}function dd(){}function oc(N){return Qi.call(this,
N)||this}function Zb(N,la){this.$=N;this.presentModeManager=la}function Sc(N,la,Ra,Pb){var vc=Ui.call(this)||this;vc.activityName=N;vc.MM=la;vc.aK=Ra;vc.$=Pb;vc.Tb();return vc}function sd(N,la,Ra){var Pb=If.call(this,N,la)||this;Pb.yi=null;Pb.Wsi=function(vc){var ad=Pb.Is.rd,Fd=Object(V.a)(6,ad.Le);var ve=vc.Fsb;Pb.unsubscribe(function(gh){vc.remove_disposing(gh)});for(var Me=0,fg=ad.errors.length;Me<fg;Me++)-573864504===ad.errors[Me].MessageId&&ad.Nla(ad.errors[Me]);switch(ve){case 1:Fd.ea.wBc=!0;
Kd.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Pb.Bh(Fd.isEditMode?ih.a.QNb:Pb.fdh);Pb.Cp();break;case 2:Pb.Bh(ih.a.openInExcelClient);Pb.Cp();break;case 0:ad.activityState[Vh.a.Rs]=!1,Pb.Bh(Pb.aK),Pb.Cp()}};Pb.fdh=la;Pb.aK=Ra;return Pb}function fd(N,la){N=Wf.call(this,N,la)||this;N.eqa=0;N.Fr();return N}function qc(N,la,Ra,Pb){var vc=qk.call(this)||this;vc.activityName=N;vc.MM=la;vc.aK=
Ra;vc.$=Pb;vc.Tb();return vc}function vb(N,la,Ra){return vf.call(this,N,la,Ra)||this}function Pd(N,la){N=of.call(this,N)||this;N.password=null;N.hjf=la;N.jh();return N}function Tc(N,la,Ra,Pb){var vc=mi.call(this)||this;vc.activityName=N;vc.MM=la;vc.aK=Ra;vc.$=Pb;vc.Tb();return vc}function Ve(N,la,Ra){return vf.call(this,N,la,Ra)||this}function kf(N){var la=of.call(this,N)||this;la.wMd=5;la.Q$d=!1;la.passwordToModify=null;la.VGf=function(){la.$.isEditMode&&la.Nhc&&(Bj.b().P8c("PasswordToModifyPasswordVerifiedTillInteractive"),
la.$.Ul(la.VGf))};la.jh();la.$.tl(la.VGf);return la}function of(N){var la=Qj.call(this,N)||this;la.eqa=0;la.n6i=function(Ra,Pb){la.gbb(Ra,Pb)};return la}function vf(N,la,Ra){var Pb=Dj.call(this,N,la)||this;Pb.yi=null;Pb.gEd=null;Pb.kYi=function(vc,ad){Pb.hGb(vc,ad)};Pb.aK=Ra;return Pb}function ne(N){var la=kk.call(this)||this;la.$=N;N.da.Ga(56,new Xd(N));la.Tb();return la}function Ad(N,la){return Xj.call(this,N,la)||this}function Xd(N){var la=vj.call(this)||this;la.$=N;la.Tb();Xd.L1g();return la}
function ee(N,la,Ra){var Pb=Le.call(this,!0)||this;Pb.Qa=new ke.a;Pb.SVe=!1;Pb.I7c=!1;Pb.MAe=null;Pb.Gm=null;Pb.G3b=null;Pb.qd=function(){Wj.a.xg(Ja.a(Pb.$).rd.activityState,xi.a.$zd)||Pb.Taa.reset()};Pb.CKi=function(vc){Pb.BSf(vc)};Pb.BKi=function(){Pb.xAj()};Pb.$=N;Pb.ea=N.ea;Pb.jK=la;Pb.businessBar=Ra;Pb.ea.gk(Pb.qd);Pb.Taa=Oh.a.wte(Pb.$);Pb.M1g();N.da.Ga(55,Pb);Pb.Nga=Bh.a.instance.lc("Common.ISystemInitiatedFeedback");return Pb}function Le(N){this.uga=this.E6d=this.EVa=null;this.hjb=!1;this.KNc=
this.yde=null;this.xRb=this.ZD=this.LWb="";this.application=this.eC=0;this.LHj=this.zVd=!1;this.WUj=N&&be.AFrameworkApplication.ga.ra("OICLaunchDialogIsEnabled");be.AFrameworkApplication.Ib.Y4(Zf.a.kRa)||be.AFrameworkApplication.Ib.fc(Zf.a.kRa,ig.a.frame,Object(af.a)(this,this.Aij,"retryOpenInClientAction"));this.A5f=!!be.AFrameworkApplication.ga&&be.AFrameworkApplication.ga.ra("SilentExternalHandler")}function Jf(){}function $f(){}function Dc(N){var la=si.call(this)||this;la.vq=N;la.Oe="ProtocolLaunchingDialog";
be.AFrameworkApplication.Ri.C5a&&be.AFrameworkApplication.Ri.quc();be.AFrameworkApplication.sa.Pa.Kid&&la.Dme(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(af.a)(la,la.Inc,"onGiveFeedbackClick"));Dc.O7e?(la.jc=12,la.Bc(1,CommonUIStrings.l_CloseFile),la.Bc(2,CommonUIStrings.l_OICDialogContinueHere),la.Bc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(la.jc=4,la.Bc(1,CommonUIStrings.l_OICDialogContinueHere),la.Bc(2,CommonUIStrings.l_OICDialogLaunchAgain));la.bDb(CommonUIStrings.l_OICDialog2ndTitle,
5===la.vq.HFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(af.a)(la,la.PGd,"protocolLaunchingDialogResultHandler"),null);return la}function Sd(N){var la=Og.call(this)||this;la.xfa=null;la.xVa=null;la.gqa=!1;la.Npa=null;la.vq=N;la.gg=te.gg;la.Zte=!0;la.jc=5;la.Oe="ProtocolLaunchingDialog";la.SHc="OICRetryDialog";be.AFrameworkApplication.Ri.C5a&&be.AFrameworkApplication.Ri.quc();be.AFrameworkApplication.Ri.Yg(new We.a(2,1,5E3,function(){la.switchToBackupMode()},
101));la.showDialog("",Object(af.a)(la,la.PGd,"protocolLaunchingDialogResultHandler"));la.P_f();la.IX("Issues");la.FVe();Kd.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return la}function te(){}function rd(N){var la=Kg.call(this)||this;la.dDa=null;la.yVa=null;la.gqa=!1;la.vq=N;la.gg=Ue.gg;la.Zte=!0;la.jc=5;la.Oe="OICLaunchDialog";la.showDialog("",Object(af.a)(la,la.yGi,"oicLaunchDialogResultHandler"));la.P_f();la.IX("ProtocolLaunchingDialogTitle");
4!==be.AFrameworkApplication.sa.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);la.aA(la.dDa);Kd.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return la}function Ue(){}function ef(N,la,Ra,Pb,vc){var ad=document.createElement("img");ad.alt=N;ad.className=tf.getImageClassWithCluster(Ra,Pb);ad.src=la;ad.setAttribute(tg.a.Rd,tg.a.Sr);N=document.createElement("span");
N.className="ProtocolLaunchingDialogImg32Container";N.appendChild(ad);ad=document.createElement("span");ad.className="ProtocolLaunchingDialogIconContainer";ad.appendChild(N);vc.appendChild(ad)}function pe(N,la,Ra,Pb,vc,ad,Fd){var ve=document.createElement("a");ve.className="ProtocolLaunchingDialogButtonAnchor";ve.className+=" OICDialog";ve.id=N;ve.setAttribute(tg.a.Rd,tg.a.Us);ve.style.padding="0";ve.style.margin="0";Pb&&ef(vc,la,Ra,Pb,ve);N=document.createElement("span");N.className="ProtocolLaunchingDialogButtonLabel";
N.innerText=vc;ve.appendChild(N);ve.tabIndex=0;ad&&Tf.a.instance.pa(pg.a.click,ve,ad);Fd&&xe.KeyInputManager.instance.pa(pg.a.Sd,ve,Fd);return ve}function Ne(N){return N.Ca.keyCode===qi.a.ei||N.Ca.keyCode===qi.a.hpa?(N.Mb.click(),!0):!1}function gg(N){for(var la=0;la<N.children.length;la++){var Ra=N.children[la];Ra.style.position="relative";Ra.style.top=(Ra.parentNode.offsetHeight-Ra.offsetHeight)/2+"px"}}function ie(){}function Re(N,la,Ra){var Pb=this;this.La=N;this.Krg=la;this.OFc=null;(this.UXb=
be.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Bh.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(vc){Pb.OFc=vc});this.t2=Ra}function Ig(N,la,Ra){this.La=N;this.Hrg=la;this.t2=Ra}function Lf(N){var la=od.call(this)||this;la.$=N;la.Tb();return la}function qf(N){var la=Xa.call(this)||this;la.$=N;la.Tb();return la}function vg(N,la,Ra){Ra=void 0===Ra?!1:Ra;var Pb=
Lb.call(this,N,la)||this;Pb.CCb=null;Pb.sCd=function(vc){Pb.unsubscribe(function(ad){vc.remove_disposing(ad)});Pb.Bh(ih.a.Ik);Pb.Cp()};Pb.Zkc=Ra;return Pb}function jc(N){return Fi.call(this,N)||this}function zc(N,la){this.Ei=la;this.$=N}function Md(N){var la=$h.call(this)||this;la.$=N;la.Tb();return la}function Ce(N){return fi.call(this,N)||this}function ae(N){this.xo="Excel";this.$=N;this.NV=ti.a.current}function ud(N,la,Ra,Pb,vc,ad,Fd){Fd=N.Na(9,void 0===Fd?null:Fd);Fd.sheetName=la;Fd.confirmationChoice=
!0;return ce.i(N,"DeleteSheet",Fd,Ra,Pb,vc,ad,0)}function Rb(){}function Ie(N){var la=qh.call(this)||this;la.g1d=null;la.i1d=0;la.kj=null;la._state=0;la.moveNext=function(){try{for(la._state=1;1===la._state;)la.Ru=la.Ru()}catch(Ra){la.dispose(),la.kea(Ra),la._state=3}};la.Cf=N;la.Ru=la.ZL;la.moveNext();return la}function pa(){}function qb(N){return Qg.call(this,N)||this}function Sb(N,la){this.$=N;this.gridView=la}function $b(N,la,Ra){var Pb=nf.call(this,N)||this;Pb.qnb=0;Pb.rzb=!1;Pb.Y1a=null;Pb.$Ie=
!1;Pb.wrb=!0;Pb.rUc=null;Pb.Im=null;Pb.Lyd=0;Pb.Myd=null;Pb.Kyd=null;Pb.removeHyperLink=!1;Pb.cellValue=null;Pb.location=null;Pb.K8h=function(vc,ad){1===vc||2===vc?(Kd.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===vc?"OK":"Remove"),Pb.Myd=ad[$b.lti],Pb.Lyd=ad[$b.Qmj],Pb.Kyd=ad[$b.Pgh],2===vc&&(Pb.removeHyperLink=!0),Pb.commit()):Kd.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Pb.bWj=function(vc,ad){return 0!==ad&&vc.length?1===ad?Pb.e_e(vd.y(vc,Pb.ea.xa)||Pb.XCi(vc),
757):Pb.e_e(Hf.a.dpd(vc),759):null};Pb.selectedRange=la;Pb.rM=Ra;Pb.ea=N.ea;Pb.sheetName=la.SheetName;Pb.bMa();Pb.um();Pb.jc=Pb.rzb?9:1;Pb.Bc(1,Nc.a.instance.fa(4));Pb.rzb&&Pb.Bc(2,Nc.a.instance.fa(760));N={};N=(N[$b.Zfh]=Pb.$Ie,N[$b.Qgh]=Pb.Y1a,N[$b.qAg]=Pb.qnb,N[$b.rAg]=Pb.rUc,N[$b.l4g]=Pb.wrb,N);la={};N=(la[$b.ay]=Pb.Cc,la[$b.cWj]=Pb.bWj,la[$b.pPg]=N,la);Pb.initializeAndShow(Pb.Im,Pb.K8h,N);return Pb}function tc(N){return Yc.call(this,N)||this}function ld(N,la,Ra,Pb){var vc=Eb.call(this)||this;
vc.$=N;vc.businessBar=Pb;vc.openInExcelOperation=la;vc.jK=Ra;return vc}function Vc(){}function Se(N){var la=this;this.Q8h="itms-apps://";this.R8h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Sjg=function(Ra){1==Ra&&la.JEc()};this.$=N;this.Sx=be.AFrameworkApplication.sa.Pa.Sx;this.jma="ms-excel:ofe|u|"+this.Sx;this.vm=be.AFrameworkApplication.ga.Va("AppUrl");Mf.a.Rba||Mf.a.Fh?this.vm=this.Q8h+this.R8h:Mf.a.qp&&(be.AFrameworkApplication.ga.ra("UseAppAndroidMarketURL")?
(Kd.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.vm=be.AFrameworkApplication.ga.Va("WildFireMarketUrlExcelAndroid")):Mf.a.Tzb?this.vm=be.AFrameworkApplication.ga.Va("WildFireUrlChinaStoreAndroid"):4<Mf.a.WWc.b9a&&(this.vm=be.AFrameworkApplication.ga.Va("WildFireUrlExcelAndroid")))}function Ge(N){var la=rg.call(this,N)||this;la.hI=null;la.lEb=function(){Kd.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(la.$.ya.IsMeetingLiveSession)return la.JEc(),
!0;Mf.a.qp?(Kd.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),la.Sx&&la.Sx.length||Kd.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),la.openUrl("intent:"+la.Sx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+la.vm+";end","_top")):9<=Mf.a.Cld?(Kd.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),la.openUrl(la.jma,"_top"),
window.setTimeout(function(){la.openUrl(la.vm,"_blank")},9E3)):(Kd.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),la.openUrl(la.jma,"_top"),window.setTimeout(function(){la.openUrl(la.vm,"_blank")},500));return!0};la.xma=function(Ra){return Ra.Ca.keyCode===qi.a.ei||Ra.Ca.keyCode===qi.a.hpa?(Kd.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Ra.Mb.click(),!0):!1};if(1!==be.AFrameworkApplication.sa.Pa.Sj)return la;
la.Sx=la.$.workbookContext.ClientUrl;la.jma="ms-excel:ofe|u|"+la.Sx;la.vm=be.AFrameworkApplication.ga.Va("AppUrl");Mf.a.Rba?la.vm="itms-apps://"+be.AFrameworkApplication.ga.Va("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Mf.a.qp&&(cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&la.$.ya.IsMeetingLiveSession?(Kd.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),la.vm=be.AFrameworkApplication.ga.Va("WildFireMarketUrlExcelAndroid")):
Mf.a.Tzb?la.vm=be.AFrameworkApplication.ga.Va("WildFireUrlChinaStoreAndroid"):4<Mf.a.WWc.b9a&&(la.vm=be.AFrameworkApplication.ga.Va("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return la}function Af(){}function jf(N){this.calculateType=0;this.calculateType=N}function Ef(N){this.calculationMode=0;this.calculationMode=N}function Xf(N,la){var Ra=this;this.dialog=null;this.hxf=function(){Ra.dialog&&Ra.dialog.hide()};this.zGi=N;this.zb=la;this.zb.Snb(this.hxf)}
function ug(N,la){return Wb.call(this,N,void 0,void 0,la)||this}function Wb(N,la,Ra,Pb,vc,ad){la=void 0===la?!0:la;Ra=void 0===Ra?!1:Ra;Pb=void 0===Pb?null:Pb;vc=void 0===vc?null:vc;ad=void 0===ad?!1:ad;var Fd=ab.call(this)||this;Fd.CY=null;Fd.em=null;Fd.rWa=null;Fd.sWa=null;var ve=Fd.OWd?Fd.OWd:CommonUIStrings.l_DefaultDialogTitle;Wb.Pxb=ad;Fd.rSb=Pb||new Kc(N,!0);Fd.rSb.tte(Fd);var Me=[],fg=[];Wb.Hu&&(Fd.yWc&&Fd.yWc.forEach(function(Hj){Array.add(Me,Hj)}),Fd.Gpe&&Fd.Gpe.forEach(function(Hj){Array.add(fg,
Hj)}));la?Ra?(Fd.jc=4,Fd.Bc(1,Fd.buttonText),Fd.Bc(2,CommonUIStrings.l_DialogClose)):(Fd.jc=6,Fd.Bc(0,CommonUIStrings.l_DialogClose)):Fd.jc=5;ad=document.createElement("span");Fd.i5c&&(ad.className=Fd.i5c);Pb=document.createElement("a");Pb.innerText=Fd.hkc;Pb.href=N;Pb.target="_blank";Pb.id=Fd.gkc;Pb.className=ma.AFrame.nqe;var gh=!Mf.a.bD&&!!vc&&0<vc.count;if(gh){var Wh=Ug.a.Jgd(N,vc);vc=Ug.a.HJd(N,vc);Pb.href="#";Pb.target="_self";Fd.em=document.createElement("form");Fd.em.id="printPreviewPostForm1";
Fd.em.method="post";Fd.em.target="_blank";Fd.em.action=vc;vc=Cl(Wh);for(Wh=vc.next();!Wh.done;Wh=vc.next()){Wh=Wh.value;var Ci=document.createElement("input");Ci.type="hidden";Ci.name=Wh.key;Ci.value=Wh.value;Fd.em.appendChild(Ci)}}else Fd.em=null;Fd.em||Wb.Pxb?Wb.Pxb||(N={},Array.add(fg,(N.type="AppLinkProps",N.id=Fd.gkc,N.text=Fd.hkc,N.onExecute=function(){Fd.zMf()},N))):(vc={},Wh={},Array.add(fg,(Wh.type="AppLinkProps",Wh.id=Fd.gkc,Wh.text=Fd.hkc,Wh.handler=(vc.href=gh?"#":N,vc.target=gh?"_self":
"_blank",vc),Wh)));Fd.DOa&&Array.add(Me,Fd.DOa);Ra?(N=document.createElement("span"),N.innerText=Fd.DOa.replace("{0}",""),ad.appendChild(N)):Fd.arf?(N=document.createElement("span"),N.id=Fd.pi("message"),gh=document.createElement("span"),vc=document.createElement("span"),Wh=Fd.DOa.split("{0}"),gh.innerText=Wh[0],vc.innerText=Wh[1],N.appendChild(gh),N.appendChild(Pb),N.appendChild(vc),ad.appendChild(N)):(N=document.createElement("span"),N.innerText=Fd.DOa,ad.appendChild(N),ad.appendChild(document.createElement("br")),
ad.appendChild(document.createElement("br")),ad.appendChild(Pb),Wb.Pxb||Array.add(Me,"{0}"));Fd.em&&ad.appendChild(Fd.em);Wb.Hu&&(Fd.E8a&&(Fd.SBb?Fd.Bme(Fd.E8a,Fd.SBb):(Array.add(Me,"{0}"),N={},Array.add(fg,(N.type="AppLinkProps",N.id="LearnMoreLinkId",N.text=Fd.E8a,N.onExecute=function(){Fd.akc()},N)))),Fd.csa(Me,fg));Fd.bDb(ve,null,Fd.p$e,null,Object(af.a)(Fd,Fd.Dw,"dialogHandler"),Wb.Hu?null:ad);Fd.IX(Fd.pi("message"));!Wb.Hu&&Fd.SBb&&Fd.E8a&&(ve=document.createElement("div"),ve.className="WACDialogLearnMoreLinkContainer",
Fd.CY=document.createElement("a"),Fd.CY.innerText=Fd.E8a,Fd.CY.href=Fd.SBb,Fd.CY.target="_blank",Fd.CY.id=Fd.pi("LearnMoreLinkId"),Fd.CY.className=ma.AFrame.nqe,ve.appendChild(Fd.CY),la?Fd.Nb.insertBefore(ve,Fd.Nb.lastChild):Fd.Nb.appendChild(ve),Fd.IX(String.format("{0} {1}",Fd.pi("message"),Fd.pi("LearnMoreLinkId"))));Fd.Dib=Pb;Ra?Fd.aA(Fd.ZB):Fd.aA(Fd.Dib);Fd.Nmf();be.AFrameworkApplication.sa.UX.pa(pg.a.click,Fd.Dib,Object(af.a)(Fd,Fd.rKe,"downloadLinkClicked"),null);Fd.CY&&be.AFrameworkApplication.sa.UX.pa(pg.a.click,
Fd.CY,Object(af.a)(Fd,Fd.akc,"learnMoreLinkClicked"),null);Fd.qSb=!1;return Fd}function Kc(N,la){this._url=N;this.Utg=la}function Id(N){return ij.call(this,N)||this}function Bd(N){this.Ei=N}function oe(N){var la=Nh.call(this)||this;la.$=N;la.Tb();return la}function Hd(){}function we(){this.tb=null}function df(N){this.NLa=this.Qab=null;this._initialized=!1;this.nld=N}function sf(){this.tb=null}function wf(N,la,Ra,Pb,vc,ad){la=Lc.call(this,la,Ra,Pb,vc,ad)||this;la.La=N;return la}function $e(N,la,Ra,
Pb,vc,ad,Fd){la=yg.call(this,la,Ra,Pb,vc,ad,Fd)||this;la.fpg=N;return la}function pf(N,la,Ra,Pb){N=hf.call(this,N,la,Ra,Pb)||this;N.Ptg=la;return N}function bg(N){var la=Rh.call(this)||this;la.jc=1;la.Bc(1,CommonUIStrings.l_RetryButtonLabel);la.Bc(0,CommonUIStrings.l_DialogClose);la.La=N;return la}function Zd(N,la,Ra){this.La=N;this.mY=la;this.Smb=Ra}function Ma(N,la,Ra,Pb){var vc=Fh.call(this)||this;vc.q9=null;vc.$Sb=null;vc.La=N;vc.mY=la;vc.Smb=Ra;vc.Bc(1,CommonUIStrings.l_SaveButtonLabel);vc.gg=
Hb.gg;vc.Oe="FileNameDialog-SaveACopy";vc.Mh=Pb;return vc}function Hb(){}function ic(){this.tb=null}function Lc(N,la,Ra,Pb,vc){this.q9=this.Em=this.hDa=null;this.PDa=!1;this.Mh=this.Zga=null;this.oTc=N;this.zlb=la;this.Js=Ra;this.ef=Pb;this.Eh=vc}function td(N){this.vb=N;this.KFa=N.appSettings.SkyDriveUploadWebServiceBase;this.uA=N.appSettings.FileName;this.Zfa=N.Va("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function pd(N,la,Ra,Pb,vc,ad,Fd){this.JFa=N;this.uA=la;this.mWa=Ra;this.$Sb=Pb;
this.WPc=vc;this.Zfa=ad;this.Mh=Fd}function Qe(N,la,Ra){this.La=N;this.E2=la;this.mY=Ra}function ff(N,la,Ra){var Pb=rh.call(this)||this;Pb.La=N;Pb.E2=la;Pb.mY=Ra;Pb.dw=!1;Pb.jc=1;Pb.iea(1);Pb.Bc(1,CommonUIStrings.l_SignIn);Pb.Bc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Pb}function hf(N,la,Ra,Pb){this.jWb=null;this.bwg=N;this.vb=Ra;this.Pde=la;this.xbe=new Qh.a;this.Eh=Pb}function yg(N,la,Ra,Pb,vc,ad){this.Mh=null;this.Ywg=N;this.E2=la;this.Smb=Ra;this.vb=Pb;this.TQb=vc;this.Js=ad}
function bf(){}function Cg(){var N=Xg.call(this)||this;N.jc=0;N.Bc(1,CommonUIStrings.l_DialogClose);return N}function Gg(){this.Jra=this.nOc=this.iOc=this.tb=null}function xg(N,la,Ra,Pb,vc){this.Em=this.hDa=null;this.yFc=!1;this.XQc=this.q9=null;this.oTc=la;this.zlb=Ra;this.Js=Pb;this.ef=vc;this.La=N}function wc(N){this.KFa=N.appSettings.SaveAsToHostWebServiceBase;this.uA=N.appSettings.FileName;this.Zfa=N.Va("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function jd(N,la,Ra,Pb,vc,ad,Fd,
ve){this.JFa=N;this.uA=la;this.mWa=Pb;this.WPc=ad;this.q9=Ra;this.exg=vc;this.Zfa=Fd;this.Mh=ve}function xd(N,la,Ra,Pb){this.Mh=this.Vce=null;this.CFa=N;this.Js=la;this.UOc=Ra;this.ef=Pb}function me(N,la,Ra,Pb,vc,ad,Fd){this.vb=N;this.cJc=Ra;this.La=la;this.$lb=Pb;this.$ib=vc;this.UOc=ad;this.Jmg=Fd}function Ae(){return yf.call(this)||this}function Ze(N,la,Ra,Pb){var vc=this;this.Po=this.Zkb=null;this.$ib=N;this.ef=Ra;this.rug=Pb;this.YDa=new Gf.a(function(){return new Wg.a(la.value,Object(af.a)(vc,
vc.owb,"getMoreInfoEventReceived"))})}function Bf(N,la,Ra,Pb,vc,ad,Fd,ve,Me,fg){this.La=la;this.vb=N;this.mY=Pb;this.$ga=ad;this.Js=vc;this.ef=Ra;this.Oge=Fd;this.zsg=void 0===ve?null:ve;this.CFa=void 0===Me?null:Me;this.eYa=void 0===fg?null:fg}function Qf(N,la,Ra,Pb,vc,ad,Fd,ve,Me){this.lNc=null;this.uA="";this.$lb=N;this.Js=la;this.Mh=Me;this.$ga=Ra;this.ef=vc;this.aw=Pb;this.CFa=Fd;this.eYa=ve;ad&&(this.lNc=new Gf.a(function(){return new Wg.a(ad.value,null)}))}function Vg(){this.properties=this.friendlyPath=
this.folderName=null}function Rf(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function De(N,la,Ra,Pb,vc,ad,Fd,ve){N=Bc.call(this,N,la,Ra,Pb,vc,ad,ve)||this;N.ez=null;N.aRc=null;N.zqa=null;N.fTg=CommonUIStrings.l_SaveToAnotherFolder;N.gg=Lg.gg;N.Oe="FileNameDialog-SaveToSharePoint";N.$lb=Fd;N.Wtg=ve;return N}function Lg(){}function $d(){var N=pi.call(this)||this;N.jc=0;N.Bc(1,CommonUIStrings.l_DialogClose);return N}function le(){this.tb=null}
function lh(N,la,Ra,Pb,vc,ad,Fd,ve){this.Em=null;this.xXa=this.PDa=!1;this.Zga=this.Mh=this.uA=null;this.vb=la;this.JFa=this.vb.appSettings.SaveAsToHostWebServiceBase;this.V9d=Pb;this.zlb=vc;this.Wg=Ra;this.Js=ad;this.Eh=ve;this.ef=Fd;this.La=N;this.Zfa=la.Va("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function Kf(N,la,Ra){this.$ga=Ra;this.cJc=la;this.vb=N}function Ph(N,la,Ra,Pb,vc,ad){this.La=la;this.vb=N;this.mY=Pb;this.$ga=ad;this.Js=vc;this.ef=Ra}function Da(N,la,Ra,Pb,vc,ad){N=Bc.call(this,
N,la,Ra,Pb,vc,ad)||this;N.gg=Mb.gg;N.Oe="FileNameDialog-SaveAsToHost";return N}function Mb(){}function Bc(N,la,Ra,Pb,vc,ad,Fd){Fd=void 0===Fd?null:Fd;var ve=Yg.call(this)||this;ve.mJ=null;ve.La=la;ve.mY=Pb;ve.$ga=ad;ve.vb=N;ve.Js=vc;ve.ef=Ra;ve.Uib=ve.vb.ra("SaveToHostWithExtraCharsInFileName");ve.Mh=Fd;ve.Bc(1,CommonUIStrings.l_SaveButtonLabel);return ve}function wd(N,la){this.vb=N;this.La=la;this.Uib=this.vb.ra("SaveToHostWithExtraCharsInFileName")}function Nd(N,la){var Ra=ki.call(this)||this;Ra.xXa=
!1;Ra.uA=null;Ra.La=N;Ra.Uib=la;Ra.NSa=!1;return Ra}function Pe(){this.tb=null}function He(N){this.fm=null;this.Wg=N;this.xQc=3}function ue(N,la,Ra,Pb){la=cb.call(this,N,la,Ra,Pb)||this;la.options.advanced.filter=N.Va("OneDriveApiV72Filter")||"folder,photo";la.options.advanced.linkType="download";la.options.multiSelect=be.AFrameworkApplication.ire;N.ra("OneDriveApiV72CommandModeEnabled")&&(la.options.commandMode=N.Va("OneDriveApiV72CommandMode")||"none");N.ra("OneDriveApiV72QosExtraDataEnabled")&&
(la.options.qosExtradata=new Ia(be.AFrameworkApplication.userSessionId));return la}function Ia(N){this.olsSessionId=this.value=this.key=null;this.olsSessionId=N}function cb(N,la,Ra,Pb){la=Xc.call(this,N,la,Ra,Pb)||this;la.ylg=N;la.options={};la.options.advanced={};la.options.action="query";la.options.clientId=la.ga.Va("OneDriveApiV72ClientId");la.options.advanced.trapFocus=!0;return la}function Xb(N,la,Ra,Pb,vc){N=Xc.call(this,N,la,Ra,Pb)||this;N.Ode=null;N.mTb=null;N.Gog=vc;N.options={};N.options.clientId=
N.ga.Va("OneDriveApiV7ClientId");N.options.cancel=Object(af.a)(N,N.PAc,"toggleHostDivVisibility");return N}function yc(N,la,Ra,Pb,vc,ad){la=Xc.call(this,la,Ra,Pb,ad)||this;la.Mh=null;la.E2=N;la.Swg=vc;return la}function Xc(N,la,Ra,Pb){this.PEa=this.O6=null;this.tRc=this.vRc=!1;this.wXa=null;this.vb=N;this.TQb=la;this.vEa=Ra;this.Js=Pb}function Od(){}function Ud(){var N=rj.call(this)||this;N.jc=0;N.Bc(1,CommonUIStrings.l_DialogClose);return N}function Fe(){}function gf(N,la,Ra,Pb){this.Zib=N;this.bra=
la;this.x2=Ra;this.Upg=Pb}function uf(N,la,Ra,Pb,vc,ad,Fd){var ve=this;this.Po=null;this.ahe=!1;this.tqa=this.U3d=0;this.utg=N;this.uXa=la;this.QUb=Ra;this.Zib=Pb;this.bra=vc;this.x2=ad;this.YDa=new Gf.a(function(){return new Wg.a(Fd.value,Object(af.a)(ve,ve.owb,"getMoreInfoEventReceived"))})}function Ee(N,la,Ra,Pb,vc,ad,Fd,ve){var Me=this;this.CGc=null;this.FTc=!0;this.iRb="";this.tyg=0;this.cXa=null;this.WMc=3;this.vb=ve;this.x2=N;this.nj=la;this.gpg=Ra;this.lmg=Pb;this.kmg=vc;this.YDa=new Gf.a(function(){return new Wg.a(ad.value,
null)});this.Vpg=new Gf.a(function(){return new Wg.a(Fd.value,Object(af.a)(Me,Me.ECi,"mruEventResultReceived"))});this.vb.ra("WacInTabOpenMRUIsEnabledForUiHost");this.vb.ra("UiHostSupportsDocRebootFeatures")}function mc(){return ph.call(this)||this}function Uc(N,la,Ra,Pb,vc,ad){var Fd=this;this.ISc=this.Po=this.jRb=null;this.aXb=this.RRc=!1;this.lce=0;this.FRc=this.cMc=!1;this.x2=N;this.Zib=la;this.YDa=new Gf.a(function(){return new Wg.a(Ra.value,Object(af.a)(Fd,Fd.owb,"getMoreInfoEventReceived"))});
this.ltg=Pb;this.bra=vc;this.Jwg=ad;this.kmb=this.Xxc;2===this.XK.Fca&&(this.FRc=!0)}function Vd(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function Sf(){}function Cd(){}b.r(E);var Uf=b(556),Td=b(0),kg=b(255);Cd.prototype.fi=function(){};Cd.prototype.init=function(){};Cd.prototype.dispose=function(){};Cd.main=function(){kg.a.instance.hj(new Cd)};Ck.Object.defineProperties(Cd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});
Object(Td.a)(Cd,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var Gf=b(614),Kd=b(14),af=b(82),Wg=b(1017),Hf=b(29),Pg=b(130);Sf.hlh=function(N){return Sf.Rve("New",N)};Sf.ilh=function(N){return Sf.Rve("Open",N)};Sf.Ave=function(N,la){return Sf.Uha("LoadingMenuSection",Sf.mui,N,Sf.Ipb("lblLoading",la))};Sf.Jpb=function(N,la,Ra,Pb){return Sf.Uha("MessageMenuSection",Sf.Jrf,la,Sf.Ipb("lblMessage",N,void 0===Ra?null:Ra,void 0===Pb?null:Pb))};Sf.ERg=function(N){return Sf.Ave(N,CommonUIStrings.l_VoicedLoadingText)};
Sf.FRg=function(N,la){return Sf.Jpb(CommonUIStrings.l_NewCreationLocationMessage,N.Ci,la.sS,la.voa)};Sf.DRg=function(N,la){return Sf.Jpb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,la.voa,"\n\n"),N.Ci)};Sf.Cve=function(N){return Sf.Jpb(CommonUIStrings.l_NewGenericErrorMessage,N.Ci)};Sf.BRg=function(N,la,Ra){return Sf.Uha("menuNewBlank",Sf.$6h,Ra?N.Ci:null,Sf.Dpb(N.E8e,N.F8e,N.G8e,null,N.Aka,N.dyb,la,"blank"))};Sf.BSg=function(){return Sf.Ipb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};
Sf.Mve=function(){return Sf.Ipb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};Sf.CSg=function(N,la){return Sf.Uha("menuNewTemplates",N,null,la)};Sf.zRg=function(N,la){return Sf.Uha("menuNewMoreTemplates",Sf.RVe,null,Sf.Dpb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,N,la))};Sf.DQg=function(N,la,Ra){var Pb="";Ra&&la&&(Pb=Sf.Uha("BrowseMoreMenuSection",Sf.RVe,null,Sf.Dpb("btnBrowseMore",la,la,null,null,null,N||"1959943459",
Ra)));return Pb};Sf.Ipb=function(N,la,Ra,Pb){Ra=void 0===Ra?null:Ra;var vc=Pb=void 0===Pb?null:Pb;la&&0<la.length&&(vc=Sf.Dsf.gqc(la).trimEnd(),vc=0<=vc.indexOf("{0}")?String.format(vc,Pb):String.format("{0} {1}",vc,Pb));Ra=Ra&&Pb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Hf.a.nf(Ra),Hf.a.nf(Pb),Hf.a.nf(vc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Hf.a.nf(N||
""),Sf.Dsf.gqc(Hf.a.nf(la||"")),Ra)};Sf.Dpb=function(N,la,Ra,Pb,vc,ad,Fd,ve){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Hf.a.nf(N||""),Hf.a.nf(la||""),Hf.a.nf(Ra||""),Pb||"32by32",Hf.a.nf(vc||""),Hf.a.nf(ad||""),Fd,Hf.a.nf(ve||""))};Sf.Rve=function(N,la){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
N,la)};Sf.Uha=function(N,la,Ra,Pb){Ra=Ra?String.format('Title="{0}"',Hf.a.nf(Ra)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',Hf.a.nf(N||""),Hf.a.nf(la||""),Ra,Pb)};Sf.Jrf="MenuMru";Sf.mui="MenuLoading";Sf.$6h="MenuHeader";Sf.RVe="MenuFooter";Sf.Dsf=Pg.a.Yx("\n","&#10;");Object(Td.a)(Sf,"NewAndOpenXmlUtilities",
null,[]);var be=b(4),$g=b(100),wg=b(176);Object(Td.a)(Vd,"HostInformation",null,[]);var We=b(108),eg=b(39),lf=b(390),Je=b(167),Di=b(739),kj=b(638),ig=b(106),Zf=b(27);Uc.prototype.Og=function(){var N=this.XK.B9a;N.fc(Zf.a.newDocument,ig.a.frame,Object(af.a)(this,this.newDocument,"newDocument"));N.Ze(Zf.a.yqc,ig.a.frame,Object(af.a)(this,this.yqc,"populateNewMenu"),96)};Uc.prototype.newDocument=function(N,la,Ra,Pb,vc){return 1===Ra?32:2===Ra&&vc&&vc.MenuItemId&&vc.SourceControlId?this.f1a(vc.MenuItemId,
vc.SourceControlId):8};Uc.prototype.f1a=function(N,la){var Ra=this.qmc.E4c;if(null===Ra)return 8;var Pb=be.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(be.AFrameworkApplication.ola&&Pb){Kd.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var vc={};vc[lf.a.Neb]=N;vc[lf.a.$P]=this.$P;vc[lf.a.lcid]=be.AFrameworkApplication.lcid.toString();vc[lf.a.reason]=Di.a.createNew;be.AFrameworkApplication.aW().execute(function(ad){ad.Jj(Je.a.f1a,
vc)})}else Pb=(new Date).getTime(),la=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Ra,Hf.a.mf(this.ama),Hf.a.mf(N),Hf.a.mf(this.$P),Hf.a.mf(be.AFrameworkApplication.lcid.toString()),Hf.a.mf(Pb.toString()),Hf.a.mf(la),Hf.a.mf(be.AFrameworkApplication.canary),be.AFrameworkApplication.oj),(Ra=be.AFrameworkApplication.ga.Va("ScenarioId"))&&""!==Ra&&(la+="&wdscenarioid="+Hf.a.mf(Ra)),la+="&"+be.AFrameworkApplication.Fcc(),
be.AFrameworkApplication.mxa&&(la+="&"+be.AFrameworkApplication.Vbc()),(Ra=this.Po?this.Po.sS:null)&&(la+="&DestinationUrl="+Hf.a.mf(Ra)),eg.a.rf(la,"_blank",void 0,"CreateNewDocument");2===this.XK.Fca&&(la={},Kd.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(la.AppType=kj.a[this.XK.Fca],la.Template=N,la)));return 32};Uc.prototype.pxi=function(N){var la=Number.MAX_VALUE,Ra=Number.MIN_VALUE,Pb=window.performance;if(Pb&&"undefined"!==typeof Pb.getEntriesByName){for(var vc=0;vc<
N.length;vc++){var ad=Pb.getEntriesByName(N[vc]);ad&&0<ad.length&&(ad=ad[0],la=Math.min(parseInt(String(ad.fetchStart)),la),Ra=Math.max(parseInt(String(ad.responseEnd)),Ra))}Ra>la&&(N={},Kd.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(N.TotalElapsedMs=Ra-la,N.MinFetchStart=la,N.MaxResponseEnd=Ra,N)))}};Uc.prototype.yqc=function(N,la,Ra,Pb,vc){if(1===Ra)return this.FRc&&(be.AFrameworkApplication.AN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.FRc=!1),32;2!==Ra||this.cMc||(this.lce=(new Date).getTime(),N={},Kd.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(N.ShouldShowTemplates=this.Xxc,N.CachedNewMenuXmlExists=!!this.jRb,N.ShouldCallGetMoreInfo=this.XK.supportsGetMoreInfoForPersonalStorage,N)));return this.l_i(vc)};Uc.prototype.l_i=function(N){N&&(this.jRb?N.PopulationXML=this.jRb:(this.XK.supportsGetMoreInfoForPersonalStorage&&!this.Po&&this.XDi.Dz("Opened New menu",!0),N.PopulationXML=this.QIh(this.getTemplateListJson())));
return 32};Uc.prototype.ehf=function(){return!this.XK.supportsGetMoreInfoForPersonalStorage||!!this.Po&&3===this.Po.state&&!!this.Po.voa&&!!this.Po.sS};Uc.prototype.vmi=function(){return be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.K_?!0:this.ehf()};Uc.prototype.getTemplateListJson=function(){var N=this;if(!this.Xxc||!this.vmi())return null;if(this.kmb&&!this.aXb){var la="9",Ra=be.AFrameworkApplication.ga.appSettings;"NumberOfTemplatesInBackstage"in Ra&&(la=Ra.NumberOfTemplatesInBackstage);
var Pb=this.$P;"TemplateCollectionId"in Ra&&(Pb=Ra.TemplateCollectionId);la=String.format(this.XK.LW+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Hf.a.mf(be.AFrameworkApplication.lcid.toString()),Hf.a.mf(Pb),la);Boolean.parse(Ra.AppendOriginQueryParam||"false")&&(la+="&org=backstage");la+="&"+be.AFrameworkApplication.Fcc();be.AFrameworkApplication.mxa&&(la+="&"+be.AFrameworkApplication.Vbc());this.XK.zDb.hm(la,1,null,null,!1,2,function(vc){N.XK.uca("CreateNewActor.GetTemplateListJson",vc.data);
N.dJj(vc.data.me)},function(vc){N.XK.uca("CreateNewActor.GetTemplateListJson",vc.data);N.cJj()},null,void 0,void 0,void 0,void 0,"5");this.kmb=!1}return this.ISc};Uc.prototype.dJj=function(N){this.ISc=N;this.kmb=!1;this.FHb();if(be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.K_&&wg.c()){N=be.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");var la=be.AFrameworkApplication.ola;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.ISc,!0,
N&&la))}};Uc.prototype.cJj=function(){this.aXb=this.kmb=!0;this.FHb();be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.K_&&wg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));$g.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Uc.prototype.O_h=function(N){for(var la=0,Ra=0;Ra<N.length;Ra++)if("ST"===N[Ra].ImageType){la=Ra;break}var Pb=N.length?N[la]:null;N=Pb?Pb.Url||"":"";var vc,ad=Ra=la=!1;if(Pb&&
(vc=Pb.AspectRatio))vc=parseFloat(vc),1>vc?la=!0:1.5<vc?Ra=!0:1===vc&&(ad=!0);else switch(vc={},Kd.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(vc.Url=N,vc)),this.XK.Fca){case 3:la=!0;break;case 2:Ra=!0;break;case 5:ad=!0}return{returnValue:N,B9h:la?"95by123":Ra?"123by69":ad?"100by100":"123by95"}};Uc.prototype.QIh=function(N){var la=this.CRg(N,this.qmc,this.qmc.bHa||"1056925771");N=la.returnValue;if(la.xxc){this.jRb=N;la=(new Date).getTime()-this.lce;var Ra={};Kd.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Ra.ElapsedMsSinceMenuOpened=la,Ra))}return N};Uc.prototype.owb=function(N,la){Kd.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Po||3!==N.state?2===N.state&&(Kd.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.RRc=!0,this.FHb()):(this.Po=N,la||this.FHb(),be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.K_&&wg.c()&&wg.d("setFileMenuHostInformation")&&(N=Object.assign(new Vd,
{hostUrl:this.Po.sS,hostName:this.Po.voa,folderUrl:be.AFrameworkApplication.breadcrumbFolderUrl,folderName:be.AFrameworkApplication.breadcrumbFolderName}),Kd.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(N))))};Uc.prototype.CRg=function(N,la,Ra){var Pb=!1;var vc=this.ehf(),ad="";if(this.XK.supportsGetMoreInfoForPersonalStorage)if(this.RRc)ad=Sf.Cve(la),this.RRc=!1,Kd.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");
else if(this.Po)if(vc)ad=Sf.FRg(la,this.Po);else if(this.Po.Idi)Pb=!0,this.kmb=!1,ad=Sf.DRg(la,this.Po),Kd.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Pb=!0;ad=Sf.Cve(la);var Fd={};Kd.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(Fd.PersonalFileStorageUrlIsSet=!!this.Po.sS,Fd.StorageServiceDisplayNameIsSet=!!this.Po.voa,Fd))}else ad=Sf.ERg(la.Ci),Kd.ULS.sendTraceTag(5849606,
202,50,"Rendering File>New with loading spinner");vc&&(vc=ad,la=Sf.BRg(la,Ra,!ad),N=this.ASg(N,Ra),Pb=N.xxc,ad=vc+(la+N.returnValue));return{returnValue:Sf.hlh(ad),xxc:Pb}};Uc.prototype.ASg=function(N,la){var Ra=!1;if(!this.Xxc)return Ra=!0,Kd.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",xxc:Ra};var Pb="",vc="",ad="MenuTemplate";if(this.aXb)Pb=Sf.Mve(),this.aXb=!1,Kd.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");
else if(N){try{var Fd=Sys.Serialization.JavaScriptSerializer.deserialize(N,!0);Pb=this.zSg(Fd,la);Kd.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");be.AFrameworkApplication.Esf&&"OneDrive"===this.ama&&(vc=Sf.zRg(this.YDi,be.AFrameworkApplication.Esf))}catch(ve){la={},Kd.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(la.JsonToConvert=N,la)),Pb=Sf.Mve()}Ra=!0}else ad="MenuLoading",Pb=Sf.BSg(),Kd.ULS.sendTraceTag(5849611,202,50,
"Rendering File>New with template loading spinner");return{returnValue:Sf.CSg(ad,Pb)+vc,xxc:Ra}};Uc.prototype.zSg=function(N,la){for(var Ra=this,Pb="",vc=[],ad=0;ad<N.length;ad++){var Fd=N[ad],ve="";if(Fd){var Me=Fd.Title,fg=Fd.AssetId,gh=Fd.Thumbnails;fg&&Me&&gh&&(Fd=void 0,ve=this.O_h(gh),Fd=ve.B9h,ve=ve.returnValue,Pb+=Sf.Dpb("jbtnNewTemplate"+ad,Me,null,Fd,null,ve,la,fg))}vc[ad]=ve}N=new We.a(4,1,5E3,function(){Ra.pxi(vc)},106);this.XK.omc.Yg(N);return Pb};Uc.prototype.FHb=function(){this.cMc=
!0;this.XK.wsf.Wv(this.qmc.Iub);this.cMc=!1};Ck.Object.defineProperties(Uc.prototype,{$P:{configurable:!0,enumerable:!0,get:function(){switch(this.XK.Fca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},XK:{configurable:!0,enumerable:!0,get:function(){return this.x2.value}},qmc:{configurable:!0,enumerable:!0,get:function(){return this.Zib.value}},XDi:{configurable:!0,enumerable:!0,get:function(){return this.YDa.value}},YDi:{configurable:!0,
enumerable:!0,get:function(){return this.ltg.value}},ama:{configurable:!0,enumerable:!0,get:function(){return this.bra.value}},Xxc:{configurable:!0,enumerable:!0,get:function(){return this.Jwg.value}}});Object(Td.a)(Uc,"CreateNewActor",null,[]);var Ei=b(1380),ph=Ei.a;Am(mc,ph);mc.prototype.wne=function(){this.wU(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.wU(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.wU(2,CommonUIStrings.l_Open);this.wU(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.wU(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.wU(5,CommonUIStrings.l_VoicedLoadingText)};mc.$Vi=function(N){return mc.instance.fa(N)};Ck.Object.defineProperties(mc,{instance:{configurable:!0,enumerable:!0,get:function(){return mc.Ma||(mc.Ma=new mc)}}});mc.Ma=null;Object(Td.a)(mc,"MruActorIntlHelper",Ei.a,[]);var ji;(function(N){N[N.success=0]="success";N[N.failure=1]="failure";N[N.spinner=2]="spinner";N[N.none=3]="none"})(ji||(ji={}));Object(Td.b)("DisplayState",ji);var xh=b(41);Ee.prototype.ECi=
function(N,la){this.cXa=N;la||this.vOf()};Ee.prototype.S9i=function(){this.Xw.B9a.Ze(Zf.a.xqc,ig.a.frame,Object(af.a)(this,this.xqc,"populateMruMenu"),96)};Ee.prototype.xqc=function(N,la,Ra,Pb,vc){return 1!==Ra&&vc?this.i_i(vc):32};Ee.prototype.i_i=function(N){this.Nlh();this.Mlh();N.PopulationXML=Sf.ilh(this.iRb+this.CGc);return 32};Ee.prototype.Nlh=function(){var N=3,la=!1;if(this.iRb&&this.tyg===this.cXa.OKj)N={},Kd.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
(N.CacheRefresh="Not Dirty",N)),N=this.WMc;else{var Ra={};Kd.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Ra.CacheRefresh="Starting",Ra));Ra=this.Xw.Iw();this.cXa=this.DCi.Dz("File Open opened",!0);if(this.iRb&&2!==this.WMc&&3!==this.cXa.state)la=!0;else{N=this.HYh(this.cXa);be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.K_&&wg.c()&&N&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(N,!0));var Pb=this.RIh(this.cXa);N=Pb.PDi;this.iRb=
Pb.returnValue}Ra=this.Xw.Iw()-Ra;Pb={};Kd.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Pb.CacheRefresh="Complete",Pb.ElapsedMs=Ra,Pb))}2!==N&&(Ra={},Ra=(Ra.DisplayState=ji[N],Ra),1!==N&&(Ra.IsStale=la),Kd.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Ra));this.WMc=N};Ee.prototype.HYh=function(N){try{var la=xh.c(N.Xxd)}catch(Ra){la=null,Kd.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Ra)}return la};Ee.prototype.Mlh=function(){if(this.FTc){Kd.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var N=this.Kyi();this.FTc=N.vXj;this.CGc=N.returnValue}else Kd.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");N={};Kd.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(N.WaitingOnLinkInfo=this.FTc,N.NotDisplayingLink=!this.CGc,N))};Ee.prototype.RIh=function(N){if(1===N.state||0===N.state){N={};Kd.ULS.sendTraceTag(5849635,
202,50,"Open menu XML built {0}",(N.Display="Spinner",N));N=2;var la=Sf.Ave(this.hka(2),this.hka(5))}else 3===N.state&&N.Xxd?(la=this.ARg(N.Xxd),N=0):(N={},Kd.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(N.Display="Server Error",N)),la=Sf.Jpb(this.hka(1),this.hka(2)),N=1);return{returnValue:la,PDi:N}};Ee.prototype.ARg=function(N){var la=this.YCb.bHa||"2155708348";if(N.length){var Ra=Sf.Ipb("lblRecentDocuments",this.hka(3));for(var Pb=0,vc=0;vc<N.length;vc++){var ad=N[vc];"FileName"in
ad&&"DocumentUrl"in ad&&"Path"in ad&&(Ra+=Sf.Dpb("MruButton"+vc,ad.FileName.toString(),ad.Path.toString(),null,this.YCb.Aka,this.YCb.dyb,la,ad.DocumentUrl.toString()),ad.IsPinned&&Pb++)}Ra=Sf.Uha("RecentDocumentsMenuSection",Sf.Jrf,this.hka(2),Ra);la={};Kd.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(la.Display="MRU List",la.TotalDocuments=N.length,la.NumPinnedDocuments=Pb,la))}else Ra=Sf.Jpb(this.hka(0),this.hka(2)),N={},Kd.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
(N.Display="Empty MRU",N));return Ra};Ee.prototype.Kyi=function(){var N=!0;var la=this.WPg,Ra=this.VPg;if(la&&Ra||!this.Xw.supportsGetMoreInfoForPersonalStorage)N=!1;else{var Pb=this.ecc.Dz("File Open",!1);3===Pb.state&&(la=Pb.sS,Ra=Pb.voa,N=!1)}Ra=Ra?String.format(this.hka(4),Ra):null;return{returnValue:Sf.DQg(this.YCb.bHa,Ra,la),vXj:N}};Ee.prototype.vOf=function(){this.Xw.wsf.Wv(this.YCb.Iub)};Ck.Object.defineProperties(Ee.prototype,{Xw:{configurable:!0,enumerable:!0,get:function(){return this.x2.value}},
hka:{configurable:!0,enumerable:!0,get:function(){return this.nj.value}},YCb:{configurable:!0,enumerable:!0,get:function(){return this.gpg.value}},WPg:{configurable:!0,enumerable:!0,get:function(){return this.lmg.value}},VPg:{configurable:!0,enumerable:!0,get:function(){return this.kmg.value}},ecc:{configurable:!0,enumerable:!0,get:function(){return this.YDa.value}},DCi:{configurable:!0,enumerable:!0,get:function(){return this.Vpg.value}}});Object(Td.a)(Ee,"MruRenderer",null,[]);var zg=b(243),wi=
b(976);uf.prototype.f1a=function(){!this.Po&&this.Iyd.supportsGetMoreInfoForPersonalStorage?this.ecc.Dz("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};uf.prototype.owb=function(N){if(!this.Po&&3===N.state)this.Po=N;else if(2===N.state){this.ahe?Kd.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.ecc.Dz("NewDocumentFromStream",!0),this.ahe=!0);return}this.createNewDocumentFromStream()};uf.prototype.createNewDocumentFromStream=function(){this.U3d=
(new Date).getTime();var N=this.bBh.E4c;if(null===N)this.uXa(null);else{var la=this.QUb.menuItemId,Ra=this.QUb.nG,Pb=this.QUb.OGj,vc=this.QUb.gBh;this.tqa="streamBase64"===Pb?vc.length/1024:0;Kd.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.$P,this.tqa);var ad=(new Date).getTime();N=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",N,Hf.a.mf(this.ama),Hf.a.mf(la),Hf.a.mf(this.$P),Hf.a.mf(be.AFrameworkApplication.lcid.toString()),
Hf.a.mf(ad.toString()),Hf.a.mf(Ra),Hf.a.mf(be.AFrameworkApplication.canary),be.AFrameworkApplication.oj,Hf.a.mf(Pb));N+="&"+be.AFrameworkApplication.Fcc();be.AFrameworkApplication.mxa&&(N+="&"+be.AFrameworkApplication.Vbc());(la=this.Po?this.Po.sS:null)&&(N+="&DestinationUrl="+Hf.a.mf(la));this.Iyd.zDb.hm(N,2,vc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(af.a)(this,this.SDi,"newDocumentFromStreamSuccessHandler"),Object(af.a)(this,this.RDi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};uf.prototype.SDi=function(N){if(N&&N.data&&N.data.me){var la=xh.d(N.data.me);var Ra=la.ev;la.returnValue?Ra.StatusCode!==zg.a.tP&&Ra.StatusCode!==zg.a.Zrb?(Kd.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.$P,this.tqa,Ra.StatusCode),this.uXa(null)):Ra.NewDocumentUrl&&""!==Ra.NewDocumentUrl?(N=(new Date).getTime()-this.U3d,Kd.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.$P,this.tqa,N),this.utg(Ra.NewDocumentUrl)):(Kd.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.$P,this.tqa),this.uXa(null)):(Ra={},Kd.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.$P,this.tqa,(Ra.ResponseData=wi.a.pfb(N.data.me),Ra)),this.uXa(null))}else Kd.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.$P,this.tqa),this.uXa(null)};uf.prototype.RDi=function(N){N&&N.data&&Kd.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.$P,this.tqa,N.data.status);this.uXa(null)};Ck.Object.defineProperties(uf.prototype,{$P:{configurable:!0,enumerable:!0,get:function(){switch(this.Iyd.Fca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},bBh:{configurable:!0,enumerable:!0,
get:function(){return this.Zib.value}},ama:{configurable:!0,enumerable:!0,get:function(){return this.bra.value}},Iyd:{configurable:!0,enumerable:!0,get:function(){return this.x2.value}},ecc:{configurable:!0,enumerable:!0,get:function(){return this.YDa.value}}});Object(Td.a)(uf,"NewDocumentFromStreamOperation",null,[]);gf.prototype.create=function(N,la,Ra){return new uf(N,la,Ra,this.Zib,this.bra,this.x2,this.Upg)};Object(Td.a)(gf,"NewDocumentFromStreamOperationFactory",null,[950]);var Bh=b(85),Jh=
b(566),nh=b(55);Fe.prototype.fi=function(N){N.register(gf,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Ic().Oc(function(){return new gf(new Gf.a(function(){return be.AFrameworkApplication.sa.Pa.efd()}),new Gf.a(function(){return be.AFrameworkApplication.ama}),new Gf.a(function(){return N.Lh("Common.INewAndOpenCommonHelpers")}),new Gf.a(function(){return N.Lh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
Fe.prototype.init=function(){var N=this;be.AFrameworkApplication.ga.tv(function(){N.uyb()})};Fe.prototype.uyb=function(){var N=Jh.a.dr(Bh.a.instance.lc("Common.INewAndOpenCommonHelpers")),la=Jh.a.dr(Bh.a.instance.lc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));be.AFrameworkApplication.ama&&nh.Task.WAA.call(null,N,la).continueWith(function(){var Pb=new Uc(new Gf.a(function(){return N.result}),new Gf.a(function(){return be.AFrameworkApplication.sa.Pa.efd()}),new Gf.a(function(){return la.result}),
new Gf.a(function(){return be.AFrameworkApplication.sa.Pa.ffd().bHa||"1959943459"}),new Gf.a(function(){return be.AFrameworkApplication.ama}),new Gf.a(function(){return be.AFrameworkApplication.eli}));Pb.Og();Pb.FHb()});if(be.AFrameworkApplication.VMf){var Ra=Jh.a.dr(Bh.a.instance.lc("Common.IEventEmitter<Common.IMruResult>"));nh.Task.WAA.call(null,N,la,Ra).continueWith(function(){var Pb=new Ee(new Gf.a(function(){return N.result}),new Gf.a(function(){return mc.$Vi}),new Gf.a(function(){return be.AFrameworkApplication.sa.Pa.ffd()}),
new Gf.a(function(){return be.AFrameworkApplication.ZVi}),new Gf.a(function(){return be.AFrameworkApplication.YVi}),new Gf.a(function(){return la.result}),new Gf.a(function(){return Ra.result}),be.AFrameworkApplication.ga);Pb.S9i();Pb.vOf()})}};Fe.prototype.dispose=function(){};Ck.Object.defineProperties(Fe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(Td.a)(Fe,"UXPackageManager",null,[4,5,2]);var fh=b(133),rj=fh.StandardDialog;Am(Ud,rj);
Ud.prototype.displayError=function(N){this.cA(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};Ud.prototype.q7c=function(N){this.cA(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(Td.a)(Ud,"ErrorDialog",fh.StandardDialog,[936]);var Qh=b(161);Od.prototype.SXe=function(){Kd.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var N=new Qh.a;N.setResult("api.onedrive.com");return N.task};Object(Td.a)(Od,"OneDriveConsumerEndpointHelper",
null,[906]);var bh=b(52),Xh=b(391),ci=b(231);Xc.prototype.B4a=function(){this.wXa||(this.wXa=this.L$a?ci.a.create(this.L$a,null,null,null,!1):null);return this.wXa};Xc.prototype.setup=function(N){var la=this;this.PEa=N;this.vRc||this.tRc?this.vRc&&this.PEa&&this.PEa(!0):(N=this.B4a())?(this.tRc=!0,N.J8a.continueWith(function(Ra){la.oQi(Ra)}),Xh.a.Zia(N)):(Kd.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.PEa(!1))};Xc.prototype.PBd=
function(N){Kd.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",N.exception?N.exception.toString():"No error detail.")};Xc.prototype.oQi=function(N){this.tRc=!1;if(N.ig)this.PBd(N),this.PEa(!1);else try{this.vRc=!0,Kd.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Imd(),Kd.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.PEa(!0)}catch(la){Kd.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",la.toString()),this.PEa(!1)}};
Xc.prototype.startPicker=function(N){this.O6=N;this.vEa?Kd.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(Kd.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(af.a)(this,this.lAd,"onApiReady")))};Xc.prototype.lAd=function(N){N?this.Yjc():this.ui()};Xc.prototype.ui=function(){this.Js().displayError(bh.a.xVi)};Xc.prototype.onSuccess=function(N){Kd.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.O6&&this.O6(!0,N)};Xc.prototype.dispose=function(){this.wXa&&this.wXa.dispose()};Ck.Object.defineProperties(Xc.prototype,{are:{configurable:!0,enumerable:!0,get:function(){return this.TQb}},ga:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(Td.a)(Xc,"AOneDriveFilePickerApiManager",null,[303,2]);Am(yc,Xc);yc.prototype.start=function(N,la){this.Mh=N;this.startPicker(la)};yc.prototype.Imd=function(){var N={},la={};N=1===this.are||2===this.are?(N.client_id=this.ga.appSettings.UploadToSkyDriveClientId,
N):(la.client_id=this.ga.appSettings.UploadToSkyDriveClientId,la.env="INT",la);WL.init(N)};yc.prototype.startPicker=function(N){this.O6=N;!this.vEa&&this.E2.rMa?(Kd.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(af.a)(this,this.lAd,"onApiReady"))):(Kd.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Swg())};yc.prototype.Yjc=function(){try{Kd.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Mh).then(Object(af.a)(this,
this.onSuccess,"onSuccess"),Object(af.a)(this,this.N6,"onFailure"))}catch(N){Kd.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",N,N.stack),this.ui()}};yc.prototype.N6=function(N){if(N&&N.error){if("user_canceled"===N.error.code){Kd.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}Kd.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",N.error.code,N.error.message)}else Kd.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.O6&&this.O6(!1,N);this.ui()};Ck.Object.defineProperties(yc.prototype,{L$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Va("OneDriveApiUrl")}}});Object(Td.a)(yc,"OneDriveFilePickerApiManagerV5",Xc,[]);Am(Xb,Xc);Xb.prototype.start=function(N,la){var Ra=this;this.mTb=la;var Pb=this.Gog.SXe();Pb.continueWith(function(){Kd.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Ra.Ode=Pb.result;
Ra.startPicker(function(vc,ad){Ra.PAc();N(vc,ad)})},3);Pb.continueWith(function(){Kd.ULS.sendTraceTag(24134242,352,15,Pb.exception.message);Ra.PAc()},5)};Xb.prototype.Imd=function(){var N=this;this.options.success=function(la){var Ra={};Ra.data=la;N.onSuccess(Ra)};this.options.error=function(la){var Ra={};Ra.error=la;N.N6(Ra)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Ode;this.options.advanced.iframeParentDiv=this.mTb};Xb.prototype.Yjc=
function(){try{Kd.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.PAc(),OneDrive.open(this.options)}catch(N){Kd.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",N.message),this.ui()}};Xb.prototype.N6=function(N){this.O6&&this.O6(!1,N);this.ui()};Xb.prototype.PAc=function(){this.mTb.style.visibility="hidden"===this.mTb.style.visibility?"":"hidden"};Ck.Object.defineProperties(Xb.prototype,{L$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Va("OneDriveApiV72Url")}}});
Object(Td.a)(Xb,"OneDriveFilePickerApiManagerV7",Xc,[]);Am(cb,Xc);cb.prototype.start=function(N,la,Ra,Pb){this.options.advanced.iframeParentDiv=Ra;this.options.advanced.endpointHint=Pb;this.options.cancel=la;this.ylg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(N)};cb.prototype.startPicker=
function(N){this.O6=N;this.vEa?Kd.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(Kd.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(af.a)(this,this.lAd,"onApiReady")))};cb.prototype.Imd=function(){var N=this;this.options.success=function(la){var Ra={};Ra.data=la;N.onSuccess(Ra)};this.options.error=function(la){var Ra={};Ra.error=la;N.N6(Ra)}};cb.prototype.Yjc=function(){try{Kd.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(N){Kd.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",N.message,N.stack),this.ui()}};cb.prototype.PBd=function(N){Kd.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",N.exception?N.exception.toString():"No error detail.");Xh.a.Oaj(this.L$a);this.wXa=null};cb.prototype.ui=function(){this.Js().q7c(bh.a.tkj)};cb.prototype.N6=function(N){this.O6&&
this.O6(!1,N)};Ck.Object.defineProperties(cb.prototype,{L$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Va("OneDriveApiV72Url")}}});Object(Td.a)(cb,"OneDriveFilePickerApiManagerV72",Xc,[]);Object(Td.a)(Ia,"IExtraData",null,[]);Am(ue,cb);ue.prototype.Yjc=function(){try{Kd.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",be.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(N){Kd.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",N.message,N.stack),this.ui()}};Ck.Object.defineProperties(ue.prototype,{L$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Va("OneDriveApiV72Url")}}});Object(Td.a)(ue,"OneDriveFilePickerApiOpenManagerV72",cb,[]);He.prototype.SXe=function(){this.fm=new Qh.a;Kd.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.AOd();return this.fm.task};He.prototype.AOd=function(N){N=void 0===N?null:N;var la=String.format("GetMoreInfoHandler.ashx?{0}",be.AFrameworkApplication.mIa);this.Wg.j$(la,1,null,N,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(af.a)(this,this.bUh,"getMoreInfoSucceeded"),Object(af.a)(this,this.$Th,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};He.prototype.$Th=function(N){if(N.data.httpStatus===zg.a.HGb&&"X-NewKey"in
N.data.responseHeaders){Kd.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var la={};la["X-Key"]=N.data.responseHeaders["X-NewKey"];this.AOd(la)}else 0<this.xQc?(Kd.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.xQc),this.xQc--,this.AOd()):(Kd.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.fm.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
He.prototype.bUh=function(N){"PersonalFileStorageUrl"in N.data.responseHeaders&&""!==N.data.responseHeaders.PersonalFileStorageUrl?(Kd.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.fm.setResult(N.data.responseHeaders.PersonalFileStorageUrl)):(Kd.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.fm.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(Td.a)(He,"OneDriveForBusinessEndpointHelper",
null,[906]);var Fg=b(622);Pe.prototype.init=function(){};Pe.prototype.dispose=function(){};Pe.prototype.fi=function(N){var la=this;this.tb=N;this.tb.register(yc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Ic().Oc(function(){return new yc(Fg.a.instance,be.AFrameworkApplication.ga,be.AFrameworkApplication.F2a,be.AFrameworkApplication.limitedEdit,be.AFrameworkApplication.X4f,function(){return new Ud})});be.AFrameworkApplication.dif?
this.tb.register(906,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Ic().Oc(function(){return new Od}):this.tb.register(906,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Ic().Oc(function(){return new He(be.AFrameworkApplication.Jd)});this.tb.register(Xb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Ic().Oc(function(){return new Xb(be.AFrameworkApplication.ga,be.AFrameworkApplication.F2a,be.AFrameworkApplication.limitedEdit,function(){return new Ud},
la.tb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.tb.register(cb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Ic().Oc(function(){return new cb(be.AFrameworkApplication.ga,be.AFrameworkApplication.F2a,be.AFrameworkApplication.limitedEdit,function(){return new Ud})});this.tb.register(ue,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Ic().Oc(function(){return new ue(be.AFrameworkApplication.ga,be.AFrameworkApplication.F2a,
be.AFrameworkApplication.limitedEdit,function(){return new Ud})})};Pe.main=function(){kg.a.instance.hj(new Pe)};Ck.Object.defineProperties(Pe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(Td.a)(Pe,"PackageManager",null,[4,5]);var ki=fh.StandardDialog;Am(Nd,ki);Nd.prototype.displayError=function(N,la,Ra){this.uA=la;this.xXa=Ra;Kd.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",N,Ra);N=this.G0c(N);
0===N?(this.jc=6,this.Bc(0,CommonUIStrings.l_DialogClose)):(this.jc=0,this.Bc(1,CommonUIStrings.l_DialogClose));0===N&&Kd.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.cA(bh.a.skj,this.Ked(N),this.zOh(N,la),Object(af.a)(this,this.BMd,"retryDialogHandler"),!0)};Nd.prototype.BMd=function(N){1===N?(Kd.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.uA?this.La.Be(Zf.a.FJb,2,[this.uA,this.xXa]):this.La.processAction(Zf.a.FJb,2)):Kd.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};Nd.prototype.G0c=function(N){return 0>N||6<N?(Kd.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",N),0):N};Nd.prototype.zOh=function(N,la){N=this.G0c(N);return this.Uib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,la),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][N]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,la),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][N]};Nd.prototype.Ked=function(N){N=this.G0c(N);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][N]};Object(Td.a)(Nd,"ErrorRetryDialog",fh.StandardDialog,[980]);wd.prototype.create=function(){return new Nd(this.La,this.Uib)};Object(Td.a)(wd,"ErrorRetryDialogFactory",null,[966]);var Ag=b(149),Ch=b(42),Yg=Ag.a;Am(Bc,Yg);Bc.prototype.gJe=function(N,la){this.KI(1,!!N&&N!==la);this.mJ=document.getElementById(Bc.STe);Ch.a.addHandler(this.mJ,"change",Object(af.a)(this,this.Cnc,"onFileNameChange"));Ch.a.addHandler(this.mJ,"input",
Object(af.a)(this,this.Cnc,"onFileNameChange"));this.mJ.focus()};Bc.prototype.a$b=function(N){return this.Uib?(new RegExp("["+this.I8b('\\/:*?"<>|')+"]")).test(N):(new RegExp("["+this.I8b('\\/:*?"<>|#{}%~&')+"]")).test(N)};Bc.prototype.I8b=function(N){return N.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};Bc.prototype.ljd=function(){var N=Hf.a.Hq(be.AFrameworkApplication.Ll.hn);this.KI(1,!!this.mJ&&""!==this.mJ.value&&this.mJ.value!==N)};Bc.prototype.Cnc=function(){var N=this;this.mJ&&window.setTimeout(function(){N.ljd()},
0)};Bc.prototype.$9b=function(N,la){if(1!==N)Kd.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{N=la[Bc.STe];la=Bc.iGf in la?la[Bc.iGf]:!1;Kd.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Hf.a.bsc(N),la);var Ra=Hf.a.Z4(be.AFrameworkApplication.fileName);(N=N?N.trim():null)&&""!==N&&""!==Ra||1===this.sa.state?this.a$b(N)?this.Js.create().displayError(1,N,la):this.$ga.soa(N+Ra,la,
this.Mh):this.Js.create().displayError(2,N,la)}};Bc.prototype.dispose=function(){this.mJ&&(Ch.a.removeHandler(this.mJ,"change",Object(af.a)(this,this.Cnc,"onFileNameChange")),Ch.a.removeHandler(this.mJ,"input",Object(af.a)(this,this.Cnc,"onFileNameChange")),this.mJ=null);Yg.prototype.dispose.call(this)};Ck.Object.defineProperties(Bc.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.ef}}});Bc.STe="txtFileName";Bc.iGf="chkOverwrite";Object(Td.a)(Bc,"FileNameDialogBase",Ag.a,[]);
Ck.Object.defineProperties(Mb,{gg:{configurable:!0,enumerable:!0,get:function(){return Ag.a.hp(Mb.yk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Mb.yk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(Td.a)(Mb,"FileNameDialogHtml",null,[]);Am(Da,Bc);Da.prototype.NQ=function(N,la){var Ra=Hf.a.Hq(be.AFrameworkApplication.Ll.hn),Pb={};la=(Pb.txtFileName=N||Ra,Pb.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Pb.chkOverwrite=la,Pb);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(af.a)(this,this.$9b,"fileNameDialogHandler"),la);this.gJe(N,Ra)};Object(Td.a)(Da,"FileNameDialog",Bc,[979]);Ph.prototype.create=function(){return new Da(this.vb,this.La,this.ef,this.mY,this.Js,this.$ga)};Object(Td.a)(Ph,
"FileNameDialogFactory",null,[965]);var hh=b(738);Kf.prototype.Og=function(){2===be.AFrameworkApplication.sa.Pa.Sj?be.AFrameworkApplication.Ib.Ze(Zf.a.FJb,ig.a.frame,Object(af.a)(this,this.bWf,"saveAsToHostActionDispatcher"),4):be.AFrameworkApplication.Ib.fc(Zf.a.FJb,ig.a.frame,Object(af.a)(this,this.bWf,"saveAsToHostActionDispatcher"))};Kf.prototype.bWf=function(N,la,Ra,Pb,vc){return la.contextId!==ig.a.frame||N!==Zf.a.FJb?2:this.vb.ra("SaveAsToHostBrsIsEnabled")?1===Ra?hh.SessionStatusManager.instance.pxb||
be.AFrameworkApplication.P5?8:32:2===Ra?(Kd.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),N=this.cJc.create(),vc&&Object.getType(vc)===Array&&2===vc.length?N.NQ(vc[0],!!vc[1]):N.NQ(null,!1),32):8:8};Object(Td.a)(Kf,"SaveAsToHostActor",null,[]);var Ug=b(80);lh.prototype.gMb=function(){1!==this.ef.state&&(this.Em=this.zlb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.jc=5,this.Em.rv=!1,this.Em.kBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))};lh.prototype.aT=function(N){N=void 0===N?0:N;1!==this.ef.state&&this.Js.create().displayError(N,Hf.a.Hq(this.uA),this.xXa)};lh.prototype.CQa=function(){var N=this.vb.appSettings.BreadcrumbFolderUrl;Kd.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");eg.a.rf(N,eg.a.eY(3),void 0,"UploadToHostManager.RedirectToFolder")};lh.prototype.BQa=function(N){var la=!1,Ra=!1;this.vb&&(la=this.vb.ra("SaveACopyIsEnabledForUiHost"),Ra=this.vb.ra("UiHostSupportsDocRebootFeatures"));
Kd.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",N,la,Ra);if(la&&Ra){Kd.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Pb={};Pb[lf.a.xQa]="1";Pb[lf.a.documentUrl]=N;Pb[lf.a.reason]=Di.a.saveAs;be.AFrameworkApplication.aW().execute(function(vc){vc.Jj(Je.a.pua,Pb)})}else la&&!Ra&&be.AFrameworkApplication.Vba?eg.a.rf(N,eg.a.eY(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
eg.a.rf(N,eg.a.eY(3),void 0,"UploadToHostManager.RedirectToEditUrl")};lh.prototype.soa=function(N,la,Ra){Ra=void 0===Ra?null:Ra;Kd.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.V9d&&!this.V9d()&&this.Wg&&(this.Eh&&(this.Zga=this.Eh.Hc("DialogShown","SaveAsToHostUploadTime")),this.gMb(),this.xXa=la,this.uA=N,(this.Mh=Ra)&&"true"===this.Mh.SkipSaveToHost?this.t9b():this.WQ())};lh.prototype.WQ=function(){var N=this;32!==this.La.processAction(Zf.a.yRa,1)?(Kd.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.t9b()):this.La.Be(Zf.a.yRa,2,[function(){Kd.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");N.t9b()},function(la,Ra){Kd.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");N.aT(Ra)}])};lh.prototype.NUi=function(N){this.SIa();this.PDa=!1;if(N&&N.data&&N.data.me){var la=xh.d(N.data.me);var Ra=la.ev;if(la.returnValue)if(Ra.StatusCode!==
zg.a.tP&&Ra.StatusCode!==zg.a.Zrb)Kd.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),N={},N.FailureReason=Ra.StatusCode.toString(),N.ExtraInfo=Ra.ExtraInfo,this.Oda(N),this.aT(parseInt(Ra.ExtraInfo));else{Kd.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.sLd();try{Ra.NewDocumentUrl&&""!==Ra.NewDocumentUrl?this.BQa(Ra.NewDocumentUrl):this.CQa()}catch(Pb){Kd.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Pb.toString())}this.oGb()}else Ra=
{},Kd.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Ra.ResponseData=wi.a.pfb(N.data.me),Ra)),N={},this.Oda((N.FailureReason="Failed to deserialize response",N)),this.aT()}else Kd.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),N={},this.Oda((N.FailureReason="null response",N)),this.aT()};lh.prototype.MUi=function(N){if(5!==N.data.status&&12!==N.data.status||this.PDa){var la={};Kd.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(la.Status=N.data.status,la.HttpStatus=N.data.httpStatus,la));la={};this.Oda((la.FailureReason=N.data.httpStatus.toString(),la));this.SIa();this.aT();this.oGb()}else Kd.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.PDa=!0,this.Mh&&"true"===this.Mh.SkipSaveToHost?this.t9b():this.WQ()};lh.prototype.SIa=function(){this.Em&&(this.Em.close(),this.Em=null)};lh.prototype.oGb=function(){this.Zga&&(this.Zga.stop(),this.Zga=null)};lh.prototype.sLd=function(){this.Mh&&
"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.processAction(Zf.a.$tc,2)};lh.prototype.Oda=function(N){this.Mh&&"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.Be(Zf.a.uLd,2,N)};lh.prototype.t9b=function(){var N=this.JFa+this.Zfa;N=Ug.a.Gl(N,"qs",Hf.a.mf(be.AFrameworkApplication.oj));N=Ug.a.Gl(N,"n",Hf.a.mf((new Date).getTime().toString()));N=Ug.a.Gl(N,"ov",Hf.a.mf(this.xXa.toString()));N=Ug.a.Gl(N,"fn",Hf.a.mf(this.uA));this.Mh&&this.Mh.FileDownloadUrl&&(N=Ug.a.Gl(N,"furl",Hf.a.mf(this.Mh.FileDownloadUrl)));
this.Wg.hm(N,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(af.a)(this,this.NUi,"onUploadFinished"),Object(af.a)(this,this.MUi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(Td.a)(lh,"UploadToHostManager",null,[932]);var yh=b(990);le.prototype.init=function(){be.AFrameworkApplication.ga.tv(Object(af.a)(this,this.FB,"onFullAppSettingsReady"))};le.prototype.FB=function(){be.AFrameworkApplication.ga.ra("SaveAsToHostBrsIsEnabled")&&this.tb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Og()};
le.prototype.fi=function(N){this.tb=N;this.tb.register(wd,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Oc(function(){return new wd(be.AFrameworkApplication.ga,be.AFrameworkApplication.Ib)}).Ic();this.tb.register(lh,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Oc(function(){return new lh(be.AFrameworkApplication.Ib,be.AFrameworkApplication.ga,be.AFrameworkApplication.Jd,function(){return be.AFrameworkApplication.Kg},
function(){return(new yh.a).create()},N.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.MD)}).Ic();this.tb.register(Ph,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Oc(function(){return new Ph(be.AFrameworkApplication.ga,be.AFrameworkApplication.Ib,be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.Pa,N.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),N.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Ic();
this.tb.register(Kf,"Common.App.SaveAsToHost.SaveAsToHostActor").Oc(function(){return new Kf(be.AFrameworkApplication.ga,N.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),N.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Ic()};le.prototype.dispose=function(){};le.main=function(){kg.a.instance.hj(new le)};Ck.Object.defineProperties(le.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(Td.a)(le,"SaveAsToHostPackage",null,[4,5]);
var pi=fh.StandardDialog;Am($d,pi);$d.prototype.displayError=function(N,la){this.zJe(N,la,bh.a.ukj)};$d.prototype.zJe=function(N,la,Ra){Kd.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ra);this.cA(Ra,N,la,null)};$d.prototype.q7c=function(N,la){Kd.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.cA(bh.a.wkj,N,la,null,!0)};Object(Td.a)($d,"ErrorDialog",fh.StandardDialog,[293]);Ck.Object.defineProperties(Lg,{gg:{configurable:!0,
enumerable:!0,get:function(){return Ag.a.hp(Lg.yk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});Lg.yk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(Td.a)(Lg,"FileNameDialogHtml",null,[]);var pg=b(13),qi=b(86),tg=b(91);Am(De,Bc);De.prototype.NQ=function(N){var la=Hf.a.Hq(be.AFrameworkApplication.Ll.hn),Ra=be.AFrameworkApplication.breadcrumbFolderName,Pb=be.AFrameworkApplication.breadcrumbBrandName,vc={};vc=(vc.txtFileName=N||la,vc);var ad=CommonUIStrings.L_SaveAs;2===be.AFrameworkApplication.sa.Pa.Sj&&(ad=CommonUIStrings.L_SaveACopy);this.initializeAndShow(ad,Object(af.a)(this,this.$9b,"fileNameDialogHandler"),vc);this.gJe(N,la);this.NIa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");be.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.ez=document.getElementById("anotherFolder"),N=document.getElementById("folderLocation"),this.aRc=tg.a.ure(N,this.ez,"anotherFolderDescribedBy"),this.ez.className="WACButton WACDialogButtonNormal",N=!1,Ra&&Ra.length?(this.ime(this.ez,this.aRc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Pb,Ra)),
N=this.$Ag(Pb,Ra)):this.ime(this.ez,this.aRc,CommonUIStrings.l_CurrentOnlineFolder),this.WBg(this.ez),this.bBg(this.ez),N?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.ez,"SaveToAnotherLocationTwo"),Kd.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.ez,"SaveToAnotherLocationOne"),Ch.a.addHandler(this.ez,pg.a.click,Object(af.a)(this,this.ECd,"onSaveToAnotherLocationClick")),
Ch.a.addHandler(this.ez,pg.a.Xb,Object(af.a)(this,this.TCf,"onSaveToAnotherLocationKeyDown")))};De.prototype.$Ag=function(N,la){var Ra=!1;var Pb=document.getElementById("currentLocation");Pb.innerText="";var vc=this.i1e(Pb,N),ad=this.i1e(Pb,la),Fd=255,ve=255;255<vc+ad&&(Fd=Math.max(238,408-vc),ve=Math.max(170,408-ad),Ra=!0);this.sDg(Pb,N,ve,la,Fd);return Ra};De.prototype.i1e=function(N,la){var Ra=document.createElement("div");Ra.innerText=la;Ra.style.visibility="hidden";N.appendChild(Ra);la=Ra.clientWidth;
N.removeChild(Ra);return la};De.prototype.sDg=function(N,la,Ra,Pb,vc){la&&(this.gme(N,la,Ra),this.lDg(N));Pb&&this.gme(N,Pb,vc)};De.prototype.gme=function(N,la,Ra){var Pb=document.createElement("div");Pb.innerText=la;Pb.title=la;Pb.className="SaveToAnotherFolderBreadcrumb";Pb.style.maxWidth=Ra.toString()+"px";N.appendChild(Pb)};De.prototype.lDg=function(N){var la=document.createElement("span");la.id="FolderSeparator";var Ra=document.createElementNS("http://www.w3.org/2000/svg","svg");Ra.setAttribute("class",
"SeparatorCaret");var Pb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Pb.setAttribute("points","1 4 1 11 5 7.5");Ra.appendChild(Pb);la.appendChild(Ra);N.appendChild(la)};De.prototype.ime=function(N,la,Ra){Ra=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ra);la&&(la.innerText=Ra);N.tabIndex=0;N.setAttribute(tg.a.Rd,tg.a.Us)};De.prototype.bBg=function(N){var la=document.createElement("span");la.id="anotherFolderText";la.innerText=this.fTg;la.className="AnotherFolderTextSpan";
N.appendChild(la)};De.prototype.WBg=function(N){var la=document.createElement("span");la.className="cui-img-cont-float cui-img-16by16 ";this.zqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.zqa.setAttribute("class","FolderIconSVG");var Ra=document.createElementNS("http://www.w3.org/2000/svg","path");Ra.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.zqa.appendChild(Ra);la.appendChild(this.zqa);
N.appendChild(la)};De.prototype.TCf=function(N){!N||N.keyCode!==qi.a.ei&&N.keyCode!==qi.a.L1||this.ECd(N)};De.prototype.ECd=function(){if(this.mJ){var N=Hf.a.Z4(be.AFrameworkApplication.fileName),la=this.mJ.value;this.hide();la&&""!==la&&""!==N||1===this.sa.state?(""!==N&&(la+=N),this.a$b(la)?this.Js.create().displayError(1,la,!1):this.$lb.start(la,this.Wtg)):this.Js.create().displayError(2,la,!1)}};De.prototype.OWg=function(N){this.ez&&this.zqa&&(N?(this.ez.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.ez,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.zqa,"DisabledFolderIconSVG")):(this.ez.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.ez,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.zqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.ez,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.zqa,"DisabledFolderIconSVG"))))};De.prototype.ljd=function(){Bc.prototype.ljd.call(this);this.OWg(!!this.mJ&&""!==this.mJ.value)};De.prototype.dispose=function(){this.ez&&
(Ch.a.removeHandler(this.ez,pg.a.click,Object(af.a)(this,this.ECd,"onSaveToAnotherLocationClick")),Ch.a.removeHandler(this.ez,pg.a.Xb,Object(af.a)(this,this.TCf,"onSaveToAnotherLocationKeyDown")),this.ez=null);Bc.prototype.dispose.call(this)};Object(Td.a)(De,"FileNameDialog",Bc,[314]);var Zh=b(893),Ga=b(615),oa=b(201),Bb=b(1111),Rd=b(134);Object(Td.a)(Rf,"SaveAsDialogInput",null,[]);Object(Td.a)(Vg,"SaveLocation",null,[]);var je=b(356);Qf.prototype.GNh=function(){var N=new Zh.a(Ga.a.Pk());N.ia("type",
"currentHost");return Object.assign(new Vg,{folderName:this.aw.breadcrumbFolderName,friendlyPath:this.aw.breadcrumbBrandName,properties:N})};Qf.prototype.Jni=function(N){return!!N&&"ClassicMru"===N.type&&!!N.service_info&&!!N.service_info.service_id&&-1!==N.service_info.service_id.indexOf("SHAREPOINT")};Qf.prototype.ZYh=function(){if(!this.lNc||!this.CFa)return null;var N=this.lNc.value.Dz("SaveAsToSharePointDialog",!1);if(!N||3!==N.state||!N.Krf)return null;N=N.Krf;for(var la=new oa.a,Ra=0,Pb=0,
vc=0;vc<N.length;vc++){var ad=N[vc];if(this.Jni(ad)&&(Ra++,ad.sharepoint_info)){var Fd=ad.url,ve=ad.sharepoint_info.site_url,Me=ad.title;ad=Bb.b(ad,be.AFrameworkApplication.isRtl);if(Fd&&ve&&Me&&ad){Pb++;var fg=new Zh.a(Ga.a.Pk());fg.ia("type","SharePoint");fg.ia("siteUrl",ve);fg.ia("folderUrl",Fd);Pb++;la.add(Object.assign(new Vg,{folderName:Me,friendlyPath:ad,properties:fg}))}}}vc=new Map;vc.set("NumPlaces",N.length.toString());vc.set("NumSharepointPlaces",Ra.toString());vc.set("placesWithMetadata",
Pb.toString());$g.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",vc);0<Ra&&(Pb?.5>1*Pb/Ra&&$g.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):$g.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return la};Qf.prototype.yOh=function(){var N=new oa.a;N.add(this.GNh());var la=this.ZYh();la&&N.addRange(la);return Object.assign(new Rf,{enableMoreLocations:!be.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.uA,extension:Hf.a.Z4(this.aw.hn),saveLocations:N.toArray(),scenario:"SaveToSharePoint"})};Qf.prototype.vOh=function(){return{inputPropsCallback:Object(af.a)(this,this.yOh,"getDialogInput")}};Qf.prototype.NQ=function(N){this.uA=N;this.uA||(this.uA=String.format(CommonUIStrings.l_SaveACopy_Filename,Hf.a.Hq(this.aw.hn)));N={};N=(N.id="SaveAsDialog",N.bodyControls=this.vOh(),N);var la=CommonUIStrings.L_SaveAs;2===this.ef.Pa.Sj&&(la=CommonUIStrings.L_SaveACopy);var Ra=new Ag.a(!1,!1,!0);
Ra.jc=1;Ra.Oe="SaveAsDialog";Ra.Bc(1,CommonUIStrings.l_SaveButtonLabel);Ra.initializeAndShow(la,Object(af.a)(this,this.qkj,"saveAsDialogHandler"),N)};Qf.prototype.pBj=function(N,la){N&&""!==N&&""!==la||1===this.ef.state?this.Ini()?this.cui(N,la):(""!==la&&(N+=la),this.$lb.start(N,this.Mh)):(Kd.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Js.create().displayError(2,N,!1))};Qf.prototype.cui=function(N,la){var Ra=this;$g.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var Pb=this.eYa.KEe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.eYa.gfd(Pb).then(function(vc){if(vc&&0<vc.length){var ad=vc[0][lf.a.$Yi];vc=vc[0][lf.a.AHf];if(""!==ad&&""!==vc)Ra.CFa.soa(vc,N+la,ad,Ra.Mh),$g.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Ra.Js.create().displayError(0,N,!1);var Fd=Rd.a.Yr();Fd&&(Fd.set("SiteUrlAvailable",""===ad?"false":"true"),Fd.set("FolderUrlAvailable",""===vc?"false":
"true"));$g.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new je.a,{extendedProperties:Fd}))}}else Ra.Js.create().displayError(0,N,!1),$g.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(vc){"Canceled"===vc?((vc=Rd.a.Yr())&&vc.set("IsCanceled","true"),$g.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new je.a,{extendedProperties:vc}))):$g.Health.instance.recordKpiFailure("SaveACopySFP",
vc,!1,!1,null)})};Qf.prototype.Ini=function(){return this.eYa?this.eYa.Grd():(Kd.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};Qf.prototype.qkj=function(N,la){if(la&&1===N){N=la.fileName;var Ra=Hf.a.Z4(this.aw.hn);la.moreLocationsSelected&&this.pBj(N,Ra);if(la.locationCallback){var Pb=la.locationCallback();Pb?Pb.properties&&"currentHost"===Pb.properties.oa("type")?this.$ga.soa(N+Ra,!1,this.Mh):Pb.properties&&"SharePoint"===Pb.properties.oa("type")?(la=Pb.properties.oa("siteUrl"),
Pb=Pb.properties.oa("folderUrl"),this.CFa.soa(Pb,N+Ra,la,this.Mh)):Kd.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):Kd.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else Kd.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(Td.a)(Qf,"ReactSaveAsDialog",null,[314]);Bf.prototype.create=function(N){return this.ef&&this.ef.Pa.wv?new Qf(this.Oge,this.Js,this.$ga,be.AFrameworkApplication.Ll,this.ef,this.zsg,this.CFa,this.eYa,N):new De(this.vb,
this.La,this.ef,this.mY,this.Js,this.$ga,this.Oge,N)};Object(Td.a)(Bf,"FileNameDialogFactory",null,[295]);Ze.prototype.start=function(N){var la=this;if(!this.xFf)if(be.AFrameworkApplication.breadcrumbFolderUrl&&be.AFrameworkApplication.breadcrumbFolderUrl.length)this.Zkb=be.AFrameworkApplication.breadcrumbFolderUrl;else return Kd.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Po),!1;var Ra=this.rug();Ra.JBj();var Pb=Ra.GVh();if(!Pb)return Kd.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.$ib.start(function(vc,ad){Ra.hide();N(vc,ad)},function(){la.BAd(Ra)},Pb,this.Zkb);return!0};Ze.prototype.BAd=function(N){N.hide();Kd.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};Ze.prototype.$Uh=function(N){N=N.toLowerCase();N.endsWith("/")||(N+="/");var la=N.indexOf("/documents/");return-1!==la?N.substring(0,
la+1)+"_layouts/15/onedrive.aspx":""};Ze.prototype.owb=function(N){this.Po||3!==N.state||(this.Po=N)};Ck.Object.defineProperties(Ze.prototype,{xFf:{configurable:!0,enumerable:!0,get:function(){this.Zkb||(this.YDa.value.Dz("Save As",!0),this.Po&&this.Po.sS&&this.Po.sS.length&&(this.Zkb=this.$Uh(this.Po.sS)));return this.Zkb}}});Object(Td.a)(Ze,"OneDriveFilePickerHelper",null,[292]);var yf=Ag.a;Am(Ae,yf);Ae.prototype.JBj=function(){this.SHc="FilePickerDialog";this.gg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Oe="PickerDialog-MsoSp";this.showDialog("",null)};Ae.prototype.GVh=function(){return document.getElementById("FilePickerDiv")};Ae.prototype.UO=function(){};Ae.prototype.qQa=function(){};Object(Td.a)(Ae,"PickerDialog",Ag.a,[294]);var Of=b(1043),Mf=b(24);me.prototype.Og=function(){var N=this,la=this.$ib.B4a();la?Mf.a.vB||this.vb.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Ze(Zf.a.saveToSharePoint,ig.a.frame,Object(af.a)(this,this.vWf,"saveToSharePointActionDispatcher"),64):(la.J8a.continueWith(function(Ra){Ra.ig&&
N.$ib.PBd(Ra)}),this.N1b()):Kd.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};me.prototype.N1b=function(){Xh.a.KId(Object(af.a)(this,this.vWf,"saveToSharePointActionDispatcher"));Xh.a.S8c([new Of.a(Zf.a.saveToSharePoint,ig.a.frame,0)],this.$ib.B4a())};me.prototype.vWf=function(N,la,Ra,Pb,vc){return la.contextId!==ig.a.frame||N!==Zf.a.saveToSharePoint?2:this.V7a&&(this.UOc.xFf||this.mxe)?1===Ra?hh.SessionStatusManager.instance.pxb||be.AFrameworkApplication.P5?
8:this.Jmg()?32:8:2===Ra?(Kd.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(vc&&vc.SaveEntryPoint&&"VersionHistory"===vc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.mxe?(Kd.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.cJc.create(vc).NQ(null)):(Kd.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.$lb.start(null,vc)),32):8:8};Ck.Object.defineProperties(me.prototype,
{V7a:{configurable:!0,enumerable:!0,get:function(){return this.vb.ra("SaveToAnotherFolderBrsIsEnabled")}},mxe:{configurable:!0,enumerable:!0,get:function(){return this.vb.ra("UserCanWriteRelative")}}});Object(Td.a)(me,"SaveToSharePointActor",null,[]);xd.prototype.start=function(N,la){var Ra=this;Kd.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Vce=N;this.Mh=la;this.UOc.start(function(Pb,vc){Ra.A2i(Pb,vc)})||this.cTd()};xd.prototype.A2i=function(N,la){if(N)this.onSuccess(la);else this.N6(la)};
xd.prototype.cTd=function(){1!==this.ef.state&&this.Js().q7c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};xd.prototype.onSuccess=function(N){Kd.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(N&&N.data&&N.data.value&&N.data.value.length&&N.data.value[0].sharePoint){var la=N.data.value[0].sharePoint.url;N=N.data.value[0].sharePoint.listUrl;var Ra=null;if(la&&(Ra=N?this.tZh(N):this.sZh(la))){this.CFa.soa(la,
this.Vce,Ra,this.Mh);return}Kd.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!la,!Ra)}Kd.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.cTd()};xd.prototype.sZh=function(N){N.endsWith("/")||(N+="/");for(var la=0,Ra=0;Ra<N.length;Ra++)if("/"===N.charAt(Ra)&&5===++la)return N.substr(0,Ra);return null};xd.prototype.tZh=function(N){N.endsWith("/")&&(N=N.substring(0,N.length-1));var la=N.lastIndexOf("/");
return-1!==la?N.substring(0,la):null};xd.prototype.N6=function(N){Kd.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");N&&N.error?Kd.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",N.error.errorCode,N.error.message):Kd.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.cTd()};Object(Td.a)(xd,"SaveToSharePointManager",null,[961]);jd.prototype.execute=function(N,la){if(!be.AFrameworkApplication.Kg&&be.AFrameworkApplication.Jd){var Ra=
this.JFa+this.Zfa;Ra=Ug.a.Gl(Ra,"fu",Hf.a.mf(this.q9));Ra=Ug.a.Gl(Ra,"su",Hf.a.mf(this.exg));Ra=Ug.a.Gl(Ra,"fn",Hf.a.mf(this.uA));Ra=Ug.a.Gl(Ra,"n",Hf.a.mf((new Date).getTime().toString()));this.Mh&&this.Mh.FileDownloadUrl&&(Ra=Ug.a.Gl(Ra,"furl",Hf.a.mf(this.Mh.FileDownloadUrl)));Ra=Ra+"&"+this.WPc;this.mWa&&this.mWa.length?Ra=Ug.a.Gl(Ra,"fnn",Hf.a.mf(this.mWa)):Kd.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");Kd.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
be.AFrameworkApplication.Jd.hm(Ra,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,N,la,null,void 0,void 0,void 0,void 0,"9")}};Object(Td.a)(jd,"SharePointSaveAsCaller",null,[978]);wc.prototype.create=function(N,la,Ra,Pb){return new jd(this.KFa,this.uA,N,la,Ra,be.AFrameworkApplication.oj,this.Zfa,Pb)};Object(Td.a)(wc,"SharePointUploadCallerFactory",null,[960]);var ah=b(896);xg.prototype.soa=function(N,la,Ra,Pb){this.yFc=!1;Kd.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.gMb();this.q9=N;Pb&&Pb.SaveEntryPoint&&(this.XQc=Pb.SaveEntryPoint);this.hDa=this.oTc.create(N,la,Ra,Pb);Pb&&"true"===Pb.SkipSaveToHost?this.WQ():this.UEh()};xg.prototype.UEh=function(){function N(){Kd.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");la.WQ()}var la=this;32!==this.La.Be(Zf.a.yRa,2,[function(){Kd.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");la.WQ()},N])&&N()};xg.prototype.WQ=
function(){Kd.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.hDa.execute(Object(af.a)(this,this.dSi,"onSaveToSharePointUploadFinished"),Object(af.a)(this,this.cSi,"onSaveToSharePointUploadFailed"))};xg.prototype.dSi=function(N){if(N&&N.data&&N.data.me){var la=xh.d(N.data.me);var Ra=la.ev;if(la.returnValue)if(Ra.StatusCode!==zg.a.tP&&Ra.StatusCode!==zg.a.Zrb)Kd.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
N.data.status,Ra.StatusCode),Ra.StatusCode!==zg.a.oTf&&this.YJe(N.data.status)||(this.Oda(Ra.StatusCode.toString()),this.vAj(Ra.StatusCode));else{Kd.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.sLd();try{Ra.NewDocumentUrl?this.BQa(Ra.NewDocumentUrl):this.CQa()}catch(Pb){Kd.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Pb.toString())}}else Ra={},Kd.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Ra.ResponseData=wi.a.pfb(N.data.me),
Ra)),this.x7b()||(this.Oda("Failed to deserialize response"),this.eMb())}else Kd.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.x7b()||(this.Oda("Unknown"),this.eMb())};xg.prototype.cSi=function(N){N&&N.data?this.YJe(N.data.status)||(Kd.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Oda(ah.a[N.data.status]),this.eMb()):(Kd.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.x7b()||(this.Oda("Unknown"),this.eMb()))};xg.prototype.x7b=
function(){if(!this.yFc)return Kd.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.yFc=!0,this.WQ(),!0;Kd.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};xg.prototype.YJe=function(N){Kd.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",N);return this.x7b()};xg.prototype.CQa=function(){Kd.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");eg.a.rf(this.q9,eg.a.eY(3),void 0,"UploadToSharePointManager.RedirectToFolder")};
xg.prototype.BQa=function(N){var la=!1,Ra=!1;be.AFrameworkApplication.ga&&(la=be.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Ra=be.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));Kd.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",N,la);if(la&&Ra){Kd.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Pb={};Pb[lf.a.xQa]="1";Pb[lf.a.documentUrl]=N;Pb[lf.a.reason]=
Di.a.saveAs;be.AFrameworkApplication.aW().execute(function(vc){vc.Jj(Je.a.pua,Pb)})}else eg.a.rf(N,eg.a.eY(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};xg.prototype.gMb=function(){this.ef&&1===this.ef.state||(this.Em=this.zlb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.jc=5,this.Em.rv=!1,this.Em.kBa(CommonUIStrings.l_DefaultDialogTitle,null,null))};xg.prototype.SIa=function(){this.Em&&(this.Em.close(),this.Em=null)};xg.prototype.eMb=function(){this.ui(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)};xg.prototype.tBj=function(){this.ui(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};xg.prototype.BAj=function(){var N=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.ui(CommonUIStrings.l_SaveAsFileTooLargeTitle,N,bh.a.rkj)};xg.prototype.ui=function(N,la,Ra){Ra=void 0===Ra?bh.a.vkj:Ra;Kd.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",N,la);this.SIa();1!==this.ef.state&&
this.Js().zJe(N,la,Ra)};xg.prototype.vAj=function(N){Kd.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",N);switch(N){case zg.a.Pbg:this.tBj();break;case zg.a.oTf:this.BAj();break;default:this.eMb()}};xg.prototype.sLd=function(){"VersionHistory"===this.XQc&&this.La.processAction(Zf.a.$tc,2)};xg.prototype.Oda=function(N){if("VersionHistory"===this.XQc){var la={};this.La.Be(Zf.a.uLd,2,(la.FailureReason=N,la))}};Object(Td.a)(xg,"UploadToSharePointManager",null,[934]);Gg.prototype.init=
function(){};Gg.prototype.dispose=function(){};Gg.prototype.fi=function(N){var la=this;this.tb=N;this.iOc=Jh.a.dr(N.lc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.nOc=Jh.a.dr(N.lc("Common.IEventEmitter<Common.IMruResult>"));this.Jra=Jh.a.dr(N.lc("Common.App.SharedFilePicker.ISharedFilePicker"));nh.Task.WAA.call(null,this.iOc,this.nOc,this.Jra).continueWith(function(){la.s8i()})};Gg.prototype.s8i=function(){var N=this;this.tb.register(wc,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Oc(function(){return new wc(be.AFrameworkApplication.ga)}).Ic();
this.tb.register(xg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Oc(function(){return new xg(be.AFrameworkApplication.Ib,N.tb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new yh.a).create()},function(){return new $d},be.AFrameworkApplication.sa)}).Ic();this.tb.register(xd,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Oc(function(){return new xd(N.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new $d},N.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),be.AFrameworkApplication.sa)}).Ic();this.tb.register(Ze,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Oc(function(){return new Ze(N.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Gf.a(function(){return N.iOc.result}),be.AFrameworkApplication.sa,function(){return new Ae})}).Ic();this.tb.register(Bf,
"Common.App.SaveToSharePoint.FileNameDialogFactory").Oc(function(){return new Bf(be.AFrameworkApplication.ga,be.AFrameworkApplication.Ib,be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.Pa,N.tb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),N.tb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),N.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Gf.a(function(){return N.nOc.result}),N.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
N.Jra?N.Jra.result:null)}).Ic();this.tb.register(me,"Common.App.SaveToSharePoint.SaveToSharePointActor").Oc(function(){return new me(be.AFrameworkApplication.ga,be.AFrameworkApplication.Ib,N.tb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),N.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),N.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),N.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return be.AFrameworkApplication.sa.fVg})}).Ic();
be.AFrameworkApplication.ga.ra("SaveToAnotherFolderBrsIsEnabled")&&this.tb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Og()};Gg.main=function(){kg.a.instance.hj(new Gg)};Ck.Object.defineProperties(Gg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(Td.a)(Gg,"PackageManager",null,[4,5]);var Xg=fh.StandardDialog;Am(Cg,Xg);Cg.prototype.displayError=function(N){this.cA(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)};Object(Td.a)(Cg,"ErrorDialog",fh.StandardDialog,[930]);bf.default=0;Object(Td.a)(bf,"SaveToCloudErrorCodes",null,[]);yg.prototype.start=function(N){this.Mh=N;if("SharePointOnlineConsumer"===this.vb.Va("FileSource")){var la=Bh.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(la){la.start(null,N);return}}this.E2.rMa?(Kd.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.CUg()):(Kd.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),
this.showSignInDialog())};yg.prototype.showSignInDialog=function(){this.Ywg.create().NQ()};yg.prototype.ui=function(){this.Js().displayError(bf.default)};yg.prototype.CUg=function(){try{Kd.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var N={},la=(N.client_id=this.vb.appSettings.UploadToSkyDriveClientId,N.env="INT",N);if(1===this.TQb||2===this.TQb)N={},la=(N.client_id=this.vb.appSettings.UploadToSkyDriveClientId,N);N={};var Ra=(N.mode="save",N.lightbox="grey",N);WL.init(la);Kd.ULS.sendTraceTag(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Ra).then(Object(af.a)(this,this.onSuccess,"onSuccess"),Object(af.a)(this,this.N6,"onFailure"))}catch(Pb){Kd.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Pb,Pb.stack),this.ui()}};yg.prototype.onSuccess=function(N){Kd.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");N&&N.data&&N.data.folders&&this.Smb.soa(N.data.folders[0].id,N.data.folders[0].urls.viewInBrowser,
null,this.Mh)};yg.prototype.N6=function(N){if(N&&N.error){if("user_canceled"===N.error.code){Kd.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}Kd.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",N.error.code,N.error.message)}else Kd.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.ui()};Object(Td.a)(yg,"SaveToCloudManager",null,[939]);hf.prototype.V7a=function(){return this.vb.ra("SaveToCloudStorageUIIsEnabled")};
hf.prototype.yXe=function(){return Zf.a.saveToCloudStorage};hf.prototype.N1b=function(){Xh.a.KId(Object(af.a)(this,this.tWf,"saveToCloudActionDispatcher"));Xh.a.S8c([new Of.a(Zf.a.saveToCloudStorage,ig.a.frame,0)],this.Pde.B4a())};hf.prototype.Og=function(){var N=this,la=this.Pde.B4a();la?(la.m$(function(){N.xbe.setResult(!0)}),this.N1b()):Kd.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};hf.prototype.RNf=function(){Kd.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")};hf.prototype.tWf=function(N,la,Ra,Pb,vc){var ad=this;return la.contextId!==ig.a.frame||N!==this.yXe()?2:this.V7a()?1===Ra?hh.SessionStatusManager.instance.pxb||be.AFrameworkApplication.P5?8:32:2===Ra?(this.RNf(),vc&&vc.FileDownloadUrl&&Kd.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Eh&&(this.jWb=this.Eh.Hc("DialogShown","SaveToOneDriveReponseTime")),this.xbe.task.continueWith(function(){ad.jWb&&(ad.jWb.stop(),
ad.jWb=null);ad.bwg.start(vc)}),32):8:8};Object(Td.a)(hf,"SaveToCloudStorageActor",null,[940]);var Eh=b(260),rh=fh.StandardDialog;Am(ff,rh);ff.prototype.NQ=function(){this.E2.cZa(Object(af.a)(this,this.TDf,"onSignIn"));this.Ak(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(af.a)(this,this.Vci,"inputHandler"))};ff.prototype.Vci=function(N){0===N?(Kd.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.e7()};ff.prototype.nXg=
function(){var N="2";if(this.mY)switch(this.mY.Sj){case 3:N="0";break;case 2:N="3";break;case 1:N="1"}return N};ff.prototype.hide=function(){this.E2.iIb(Object(af.a)(this,this.TDf,"onSignIn"));rh.prototype.hide.call(this)};ff.prototype.e7=function(){var N=new Eh.QueryStringBuilder("Signin.aspx");N.Yi("prompt","1");N.Yi("cbcxt",this.nXg());be.AFrameworkApplication.VYa(N);eg.a.rf(N.toString(),"LoginWindow",void 0,"SignInDialog")};ff.prototype.TDf=function(){this.Pq&&this.hide();Kd.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(Zf.a.saveToCloudStorage,2)};Object(Td.a)(ff,"SignInDialog",fh.StandardDialog,[952]);Qe.prototype.create=function(){return new ff(this.La,this.E2,this.mY)};Object(Td.a)(Qe,"SignInDialogFactory",null,[938]);pd.prototype.execute=function(N,la){if(!be.AFrameworkApplication.Kg&&be.AFrameworkApplication.Jd){var Ra=this.JFa+this.Zfa;Ra=Ug.a.Gl(Ra,"fo",Hf.a.mf(this.$Sb));Ra=Ug.a.Gl(Ra,"fn",Hf.a.mf(this.uA));
Ra=Ug.a.Gl(Ra,"qs",Hf.a.mf(this.WPc));Ra=Ug.a.Gl(Ra,"n",Hf.a.mf((new Date).getTime().toString()));this.Mh&&this.Mh.FileDownloadUrl&&(Ra=Ug.a.Gl(Ra,"furl",Hf.a.mf(this.Mh.FileDownloadUrl)));this.mWa&&(Ra=Ug.a.Gl(Ra,"fnn",Hf.a.mf(this.mWa)));be.AFrameworkApplication.Jd.hm(Ra,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,N,la,null)}};Object(Td.a)(pd,"SkyDriveUploadCaller",null,[953]);td.prototype.create=function(N,la,Ra){return new pd(this.KFa,this.uA,la,N,be.AFrameworkApplication.oj,
this.Zfa,Ra)};Object(Td.a)(td,"SkydriveUploadCallerFactory",null,[937]);Lc.prototype.gMb=function(){this.ef&&1===this.ef.state||(this.Em=this.zlb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.jc=5,this.Em.rv=!1,this.Em.kBa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Lc.prototype.SIa=function(){this.Em&&(this.Em.close(),this.Em=null)};Lc.prototype.aT=function(){1!==be.AFrameworkApplication.sa.state&&this.Js().displayError(bf.default)};Lc.prototype.CQa=function(){Kd.ULS.sendTraceTag(6590599,
216,50,"Redirecting to OneDrive Folder.");eg.a.rf(this.q9,eg.a.eY(3),void 0,"UploadToCloudManager.RedirectToFolder")};Lc.prototype.BQa=function(N){var la=!1,Ra=!1;be.AFrameworkApplication.ga&&(la=be.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Ra=be.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));Kd.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",N,la);if(la&&Ra){Kd.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
var Pb={};Pb[lf.a.xQa]="1";Pb[lf.a.documentUrl]=N;be.AFrameworkApplication.aW().execute(function(vc){vc.Jj(Je.a.pua,Pb)})}else eg.a.rf(N,eg.a.eY(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};Lc.prototype.soa=function(N,la,Ra,Pb){Ra=void 0===Ra?null:Ra;Pb=void 0===Pb?null:Pb;Kd.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Eh&&(this.Zga=this.Eh.Hc("DialogShown","SaveToOneDriveUploadTime"));this.gMb();this.q9=la;this.hDa=this.oTc.create(N,Ra,Pb);this.Mh=Pb;this.WQ()};Lc.prototype.WQ=
function(){Kd.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.hDa.execute(Object(af.a)(this,this.bSi,"onSaveToCloudUploadFinished"),Object(af.a)(this,this.aSi,"onSaveToCloudUploadFailed"))};Lc.prototype.bSi=function(N){this.SIa();this.PDa=!1;if(N&&N.data&&N.data.me){var la=xh.d(N.data.me);var Ra=la.ev;if(la.returnValue)if(Ra.StatusCode!==zg.a.tP&&Ra.StatusCode!==zg.a.Zrb)Kd.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.aT();
else{Kd.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Ra.NewDocumentUrl&&""!==Ra.NewDocumentUrl?this.BQa(Ra.NewDocumentUrl):this.CQa()}catch(Pb){Kd.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Pb.toString())}this.oGb()}else Ra={},Kd.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Ra.ResponseData=wi.a.pfb(N.data.me),Ra)),this.aT()}else Kd.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.aT()};Lc.prototype.aSi=function(N){5!==N.data.status&&12!==N.data.status||this.PDa?(Kd.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",N.data.status),this.SIa(),this.aT(),this.oGb()):(Kd.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.PDa=!0,this.WQ())};Lc.prototype.oGb=function(){this.Zga&&(this.Zga.stop(),this.Zga=null)};Object(Td.a)(Lc,"UploadToCloudManager",null,[935]);ic.prototype.init=function(){be.AFrameworkApplication.ga.ra("SaveToCloudStorageUIIsEnabled")&&
this.tb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Og()};ic.prototype.dispose=function(){};ic.prototype.fi=function(N){this.tb=N;this.tb.register(Qe,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Oc(function(){return new Qe(be.AFrameworkApplication.Ib,Fg.a.instance,be.AFrameworkApplication.sa.Pa)}).Ic();this.tb.register(td,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Oc(function(){return new td(be.AFrameworkApplication.ga)}).Ic();
this.tb.register(hf,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Oc(function(){return new hf(N.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),N.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),be.AFrameworkApplication.ga,be.AFrameworkApplication.sa.MD)}).Ic();this.tb.register(Lc,"Common.App.SaveToCloudStorage.UploadToCloudManager").Oc(function(){return new Lc(N.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new yh.a).create()},
function(){return new Cg},be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.MD)}).Ic();this.tb.register(yg,"Common.App.SaveToCloudStorage.SaveToCloudManager").Oc(function(){return new yg(N.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Fg.a.instance,N.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),be.AFrameworkApplication.ga,be.AFrameworkApplication.F2a,function(){return new Cg})}).Ic()};ic.main=function(){kg.a.instance.hj(new ic)};Ck.Object.defineProperties(ic.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(Td.a)(ic,"PackageManager",null,[4,5]);Ck.Object.defineProperties(Hb,{gg:{configurable:!0,enumerable:!0,get:function(){return Ag.a.hp(Hb.yk,CommonUIStrings.l_SaveACopyFileName)}}});Hb.yk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(Td.a)(Hb,"FileNameDialogHtml",null,[]);var Fh=Ag.a;Am(Ma,Fh);Ma.prototype.NQ=function(N,la,Ra){this.$Sb=N;this.q9=Ra;N={};la=(N.txtFileName=Hf.a.Hq(be.AFrameworkApplication.Ll.hn),N.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,la),N);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(af.a)(this,this.$9b,"fileNameDialogHandler"),la);Kd.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
Ma.prototype.$9b=function(N,la){1!==N?Kd.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(N=la.txtFileName.trim(),Kd.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),la=Hf.a.Z4(be.AFrameworkApplication.fileName),N&&""!==N&&""!==la&&(N+=la),this.Smb.soa(this.$Sb,this.q9,N,this.Mh))};Object(Td.a)(Ma,"FileNameDialog",Ag.a,[951]);Zd.prototype.create=function(N){return new Ma(this.La,this.mY,this.Smb,N)};Object(Td.a)(Zd,"FileNameDialogFactory",
null,[929]);var Rh=fh.StandardDialog;Am(bg,Rh);bg.prototype.displayError=function(N){Kd.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",N);this.cA(N,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(af.a)(this,this.BMd,"retryDialogHandler"))};bg.prototype.BMd=function(N){1===N?(Kd.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Zf.a.saveACopy,2)):Kd.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(Td.a)(bg,"RetryDialog",fh.StandardDialog,[930]);Am(pf,hf);pf.prototype.V7a=function(){return this.vb.ra("SaveACopyBrsIsEnabled")};pf.prototype.yXe=function(){return Zf.a.saveACopy};pf.prototype.N1b=function(){Xh.a.KId(Object(af.a)(this,this.tWf,"saveToCloudActionDispatcher"));Xh.a.S8c([new Of.a(Zf.a.saveACopy,ig.a.frame,0)],this.Ptg.B4a())};pf.prototype.RNf=function(){Kd.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(Td.a)(pf,"SaveACopyActor",hf,
[]);Am($e,yg);$e.prototype.onSuccess=function(N){N&&N.data&&N.data.folders?(Kd.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.fpg.create(this.Mh).NQ(N.data.folders[0].id,N.data.folders[0].name,N.data.folders[0].urls.viewInBrowser)):(Kd.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.ui())};$e.prototype.N6=function(N){N&&N.error&&"user_canceled"===N.error.code&&Kd.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
yg.prototype.N6.call(this,N)};$e.prototype.ui=function(){Kd.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");yg.prototype.ui.call(this)};Object(Td.a)($e,"SaveACopyManager",yg,[]);Am(wf,Lc);wf.prototype.rrd=function(){return!!this.Mh&&!!this.Mh.SaveEntryPoint&&"VersionHistory"===this.Mh.SaveEntryPoint.toString()};wf.prototype.aT=function(){Kd.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.rrd()){var N={};this.La.Be(Zf.a.uLd,2,(N.FailureReason="Unknown",
N))}Lc.prototype.aT.call(this)};wf.prototype.CQa=function(){Kd.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.rrd()&&this.La.processAction(Zf.a.$tc,2);Lc.prototype.CQa.call(this)};wf.prototype.BQa=function(N){Kd.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",N);this.rrd()&&this.La.processAction(Zf.a.$tc,2);Lc.prototype.BQa.call(this,N)};wf.prototype.WQ=function(){var N=this;this.Mh&&"true"===this.Mh.SkipSaveToHost?Lc.prototype.WQ.call(this):
32!==this.La.processAction(Zf.a.yRa,1)?(Kd.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),Lc.prototype.WQ.call(this)):this.La.Be(Zf.a.yRa,2,[function(){Kd.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Lc.prototype.WQ.call(N)},function(){Kd.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");N.aT()}])};Object(Td.a)(wf,"SaveACopyUploadToCloudManager",
Lc,[]);sf.prototype.init=function(){be.AFrameworkApplication.ga.tv(Object(af.a)(this,this.FB,"onFullAppSettingsReady"))};sf.prototype.FB=function(){be.AFrameworkApplication.ga.ra("SaveACopyBrsIsEnabled")&&this.tb.resolve("Common.App.SaveACopy.SaveACopyActor").Og()};sf.prototype.dispose=function(){};sf.prototype.fi=function(N){this.tb=N;this.tb.register(wf,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Oc(function(){return new wf(be.AFrameworkApplication.Ib,N.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new yh.a).create()},function(){return new bg(be.AFrameworkApplication.Ib)},be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.MD)}).Ic();this.tb.register(Zd,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Oc(function(){return new Zd(be.AFrameworkApplication.Ib,be.AFrameworkApplication.sa.Pa,N.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Ic();this.tb.register(pf,"Common.App.SaveACopy.SaveACopyActor").Oc(function(){return new pf(N.resolve("Common.App.SaveACopy.SaveACopyManager"),
N.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),be.AFrameworkApplication.ga,be.AFrameworkApplication.sa.MD)}).Ic();this.tb.register($e,"Common.App.SaveACopy.SaveACopyManager").Oc(function(){return new $e(N.resolve("Common.App.SaveACopy.FileNameDialogFactory"),N.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Fg.a.instance,N.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),be.AFrameworkApplication.ga,be.AFrameworkApplication.F2a,function(){return new bg(be.AFrameworkApplication.Ib)})}).Ic()};
sf.main=function(){kg.a.instance.hj(new sf)};Ck.Object.defineProperties(sf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(Td.a)(sf,"PackageManager",null,[4,5]);var se;(function(N){N[N.myFiles=0]="myFiles";N[N.recent=1]="recent";N[N.currentFolder=2]="currentFolder";N[N.yourPhone=3]="yourPhone"})(se||(se={}));Object(Td.b)("SharedFilePickerLandingLocation",se);df.prototype.B2a=function(N){this._initialized||(N.mo(Je.a.zNf),N.Tl(Je.a.zNf,Object(af.a)(this,
this.lRi,"onReceivedPickerResponse")),this._initialized=!0)};df.prototype.gfd=function(N){var la=this;return this.NLa=new Promise(function(Ra,Pb){var vc={};vc[lf.a.ZYi]=N;la.Qab=function(ad,Fd){""===Fd?(Kd.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ra(ad)):("Canceled"===Fd?Kd.ULS.sendTraceTag(572548164,306,50,Fd):Kd.ULS.sendTraceTag(556901065,306,10,Fd),Pb(Fd))};la.nld.execute(function(ad){la.B2a(ad);ad.Jj(Je.a.dWi,vc)})})};df.prototype.lRi=function(N){this.Qab(N.Values[lf.a.Smj],
void 0===N.Values[lf.a.DEd]||null===N.Values[lf.a.DEd]?"":N.Values[lf.a.DEd])};df.prototype.Grd=function(){return be.AFrameworkApplication.ga.ra("UiHostCommonFilePicker")};df.prototype.KEe=function(N,la,Ra,Pb,vc,ad,Fd){var ve=void 0===ve?null:ve;var Me={};Me[lf.a.Emj]=N;Me[lf.a.titleText]=la;Me[lf.a.EJg]=Ra;Me[lf.a.FJg]=Pb;Me[lf.a.GJg]=!1;Me[lf.a.Fgh]=!0;Me[lf.a.nBh]=vc;Me[lf.a.cZi]=ad;Me[lf.a.bZi]=se[Fd];wg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Me[lf.a.dZi]="Dark");ve&&
(null!=ve.PWc&&(Me[lf.a.PWc]=ve.PWc),null!=ve.gmd&&(Me[lf.a.gmd]=ve.gmd));return Me};Object(Td.a)(df,"SharedFilePickerManager",null,[928]);we.prototype.fi=function(N){this.tb=N;N.register(df,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Ic().Oc(function(){return new df(N.lc("Postmessage.IHostPostmessenger"))})};we.prototype.init=function(){var N=this;be.AFrameworkApplication.ga.tv(function(){N.uyb()})};we.prototype.uyb=function(){this.tb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
we.prototype.dispose=function(){};we.main=function(){kg.a.instance.hj(new we)};Ck.Object.defineProperties(we.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(Td.a)(we,"SharedFilePickerPackage",null,[4,5]);var kh=b(1333),jg=b(1044);Hd.prototype.hme=function(N){var la=!1;N&&(N.S3c(),N.TSg&&(la=!1));return la};Hd.prototype.J5g=function(){var N=be.AFrameworkApplication.sa.Pa;N=new kh.a(N.Sj,jg.a.adc(),!1,1===N.Lca);this.hme(N)&&Kd.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};Hd.prototype.p5b=function(N,la,Ra,Pb,vc,ad){N=new kh.a(N,Ra,Pb,la,vc,ad);this.hme(N)&&Kd.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};Hd.prototype.Qah=function(){var N=be.AFrameworkApplication.sa.Pa,la=be.AFrameworkApplication.ga,Ra=N.Sj,Pb=1===N.Lca;if(la.ra(jg.a.v1h(Ra))){var vc=jg.a.adc(),ad=8<Mf.a.U5a;if(2!==Ra||2!==vc||!Pb){la=la.ra(jg.a.w1h(Ra));var Fd=N.VVf(),ve=function(){return N.Sx};la&&!jg.a.eqd(jg.a.Vdd(Ra))&&this.p5b(Ra,Pb,vc,ad,ve,Fd)}}};
Hd.prototype.init=function(){var N=be.AFrameworkApplication.ga,la=N.ra("WildFireChromeExtensionEnabled");N=N.ra("WildFireChromeExtensionBar")&&la;jg.a.$xc&&N&&!jg.a.eqd(jg.a.nze)?this.J5g():(document.body&&jg.a.Yyj&&this.Qah(),be.AFrameworkApplication.Ib.fc(Zf.a.Wtd,ig.a.frame,Object(af.a)(this,this.Wtd,"launchWildFireBusinessBar")))};Hd.prototype.Wtd=function(N,la,Ra,Pb,vc){if(1===Ra)return 32;if(!vc)return 8;this.p5b(vc.app,vc.mode,vc.platform,vc.useTwoButton,null,null);return 32};Hd.prototype.dispose=
function(){};Hd.prototype.fi=function(){};Hd.main=function(){kg.a.instance.hj(new Hd)};Ck.Object.defineProperties(Hd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(Td.a)(Hd,"PackageManager",null,[4,5]);var oh=b(226),Mi=b(1318),Nh=oh.a;Am(oe,Nh);oe.prototype.create=function(){this.Eb(this.$.da.Aa(5)||new Mi.a(this.$,!this.$.Dba))};oe.ka=function(N){N.da.Ga(4,new oe(N))};Object(Td.a)(oe,"BusinessBarManagerFactory",oh.a,[]);var Zg=b(11),Df;"undefined"==
typeof Df&&(Df={});window.MSOJS=Df;Df.Ugb=function(){function N(){return Fd()&&(aj()||3<=(Wh()?mk("version/"):0))}function la(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Ra(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Pb(){Tg||(Tg=!0,Rg=vc("Windows Phone"))}function vc(Nf){Nf=(new RegExp(Nf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var jh=-1;return null!=Nf&&2<=Nf.length&&(jh=parseFloat(Nf[1]),isNaN(jh)&&(jh=-1)),jh}function ad(){return"function"==
typeof navigator.msLaunchUri&&!Ra()&&!Hj()&&!ve()}function Fd(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function ve(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Me(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function fg(){return Me()?8==window.document.documentMode:!1}function gh(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Wh(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}
function Ci(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Hj(){var Nf=window.navigator.userAgent.toLowerCase();return 0<=Nf.indexOf("android")&&0<=Nf.indexOf("chrome")}function aj(){return 3<=(gh()?mk("firefox/"):0)}function mk(Nf){var jh=window.navigator.userAgent.toLowerCase(),ei=jh.indexOf(Nf),Uh,Ri;return 0<=ei?(Uh=ei+Nf.length,Ri=jh.length,parseInt(jh.substring(Uh,Ri))):0}function Mj(Nf,jh,ei,Uh,Ri){if(Uh&&null!=jh)jh();else if(ad())navigator.msLaunchUri(Nf,
jh,ei);else if(!(Ci()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&Fd())||ve())nk(Nf,jh,ei);else if(Ci()&&Ri)a:{try{window.open(Nf,"_self")}catch(qj){null!=ei&&ei();break a}null!=jh&&jh()}else Ej(Nf,jh,ei)}function Ej(Nf,jh,ei){var Uh=document.getElementById("OICLinkTag"),Ri;null==Uh&&(Uh=document.createElement("a"),Uh.id="OICLinkTag",Uh.style.visibility="hidden",Uh.href="",Uh.target=0==(Ke.Options&Li.SupportsTopTargetNavigation)||
Ke.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Uh),null!=Uh.addEventListener&&Uh.addEventListener("click",function(qj){null!=qj.stopPropagation&&qj.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Ri=function(qj){var cj=document.createEvent("MouseEvent");return cj.initMouseEvent(qj,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),cj},Ri.prototype=Event.prototype,window.MouseEvent=Ri),Uh.href=Nf,Uh.dispatchEvent(new MouseEvent("click"))}catch(qj){null!=ei&&ei();return}null!=
jh&&jh()}function nk(Nf,jh,ei){var Uh=document.getElementById("OICFrame");null==Uh&&(Uh=document.createElement("iframe"),Uh.className="ObjectInDialog",Uh.style.visibility="hidden",Uh.src="about:blank",document.body.appendChild(Uh),Uh.id="OICFrame");try{Uh.contentWindow.location.href=Nf}catch(Ri){null!=ei&&ei();return}null!=jh&&jh()}function Xk(Nf){return 0!=(Nf.Options&Li.SkipProtocolHandler)||fg()}function cl(Nf){return Nf===Yh.ReadOnly||Nf===Yh.ReadWrite}function kl(Nf,jh,ei,Uh){var Ri,qj;try{if(Ri=
new ActiveXObject(Ec),Ri)return qj=Ri.ViewDocument3(window.self,Nf,jh,Uh),qj?(dl(Uj.O14ActiveX),Mh.None):Mh.Failed}catch(cj){}if(Li.O14Only===(ei&Li.O14Only))return Ke.DescriptiveUnattemptedEnums?Mh.O14AttemptFailure:Mh.Unattempted;try{if(Ri=new ActiveXObject(Mc),Ri)return qj=Ri.ViewDocument3(window.self,Nf,jh,Uh),qj?(dl(Uj.O12ActiveX),Mh.None):Mh.Failed}catch(cj){}if(Li.O12UpOnly===(ei&Li.O12UpOnly))return Ke.DescriptiveUnattemptedEnums?Mh.O12UpOnlyFail:Mh.Unattempted;try{if(Ri=new ActiveXObject(zd),
Ri)return qj=cl(jh)?Ri.ViewDocument2(window.self,Nf,Uh):Ri.EditDocument2(window.self,Nf,Uh),qj?(dl(Uj.O11ActiveX),Mh.None):Mh.Failed}catch(cj){}return Ke.DescriptiveUnattemptedEnums?Mh.ActiveXUnattempted:Mh.Unattempted}function nl(Nf,jh,ei,Uh,Ri){var qj,cj,ok;Nf==zj.Visio&&ei==Yh.ReadWrite&&(ei=Yh.WriteOnly);Nf=Ri;(Uh=Uh||Ra()&&!(Pb(),8<=Rg))||(qj="",qj+=cl(ei)?uh+hi:vi,qj+=l,Nf+=pl(qj));Nf+=pl(jh);Ke.NewTelemetryDataIsEnabled&&(cj=-1!==Nf.indexOf("?")?"&":"?",cj+=Ke.SessionOrigin?"OR="+Ke.SessionOrigin+
"&":"",cj+=Ke.ClickTime?"CT="+Ke.ClickTime+"&":"",cj+=Ke.CorrelationId?"CID="+Ke.CorrelationId:"",cj="?"!=cj?cj:"",cj="&"!=cj.slice(-1)?cj:cj.slice(0,-1),Nf+=pl(cj),Ke.CorrelationIdForWinClient&&(Nf+=pl(Ke.CorrelationIdForWinClient)));jh=window.location.href;ei=Y;Uh=jh.toLowerCase().indexOf("&"+ei+"=");var Yj;ei=-1==Uh?void 0:(ok=Uh+(ei.length+2),Yj=jh.indexOf("&",ok),-1==Yj)?jh.substr(ok):jh.substring(ok,Yj);if(null!=ei&&"undefined"!=typeof ei){ok="";try{ok=decodeURIComponent(ei)}catch(Zk){}0<ok.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(ok)&&(Nf+=J,Nf+=ok)}return Nf}function ol(Nf,jh,ei,Uh,Ri,qj){var cj=vl(Nf),ok;return null==cj?(F(Ke.DescriptiveUnattemptedEnums?Mh.ProtocolHandlerIsNull:Mh.Unattempted,Ke.Application),!1):(ok=nl(Nf,jh,ei,Uh,cj),Mj(ok,xl,ul,Ri,qj),!0)}function pl(Nf){if(Fd()&&Ci()){var jh="";try{jh=decodeURI(Nf)}catch(ei){}if(jh==Nf)return encodeURI(Nf)}return Nf}function xl(){dl(Uj.ProtocolHandler)}function ul(){Ke.Options|=Li.SkipProtocolHandler;wl(Ke,
uc,ed)}function yl(){null!=Dd&&Dd(Uj.RoamingProtocolHandler)}function ql(){null!=hd&&hd(Mh.ControlNeeded)}function sl(){var Nf=document.getElementById(Jg),jh;if(null==Nf){if(jh=Ld,Fd()&&3<=(Wh()?mk("version/"):0)&&Yk(ye,!0)&&(jh=ye),!Yk(jh,!0))if(Fd()&&Yk(dg,!0))jh=dg;else return null;Nf=document.createElement("object");Nf.id=Jg;Nf.type=jh;Nf.style.width="0px";Nf.style.height="0px";Nf.style.setProperty("visibility","hidden","");document.body.appendChild(Nf);Nf=document.getElementById(Jg)}return Nf}
function Yk(Nf,jh){var ei=window.navigator.mimeTypes,Uh;return null==ei?!1:(Uh=ei[Nf],Uh)?jh&&!Uh.enabledPlugin?!1:!0:!1}function ll(Nf){try{if(null!=new ActiveXObject(Nf))return!0}catch(jh){}return!1}function tl(Nf){switch(Nf){case zj.OneNote:return bj;default:return""}}function vl(Nf){if(Nf!=zj.OneNote&&Ra()&&!(Pb(),8<=Rg))return"office:";switch(Nf){case zj.Excel:return"ms-excel:";case zj.OneNote:return"onenote:";case zj.PowerPoint:return"ms-powerpoint:";case zj.Visio:return"ms-visio:";case zj.Word:return"ms-word:";
case zj.Project:return"ms-project:";case zj.Publisher:return"ms-publisher:";case zj.Infopath:return"ms-infopath:";case zj.Access:return"ms-access:";default:return""}}function zl(Nf){switch(Nf){case zj.Excel:return"root\\office15\\excel.exe";case zj.PowerPoint:return"root\\office15\\powerpnt.exe";case zj.Visio:return"root\\office15\\visio.exe";case zj.Word:return"root\\office15\\winword.exe";case zj.Project:return"root\\office15\\winproj.exe";case zj.Publisher:return"root\\office15\\mspub.exe";case zj.Infopath:return"root\\office15\\infopath.exe";
case zj.Access:return"root\\office15\\msaccess.exe";default:return null}}function wl(Nf,jh,ei){if(Ke=Nf,uc=jh,ed=ei,Nf.DocumentUrl){var Uh=ei=jh=Nf.DocumentUrl;try{Uh=decodeURIComponent(Nf.DocumentUrl)}catch(Zk){}try{ei=encodeURI(Nf.DocumentUrl)}catch(Zk){}Ke.NewTelemetryDataIsEnabled||(jh=jh+""+Nf.CorrelationIdForWinClient,Uh+=Nf.CorrelationIdForWinClient,ei+=Nf.CorrelationIdForWinClient);Nf.Mode===Yh.ReadWrite&&Li.CheckoutRequired===(Nf.Options&Li.CheckoutRequired)&&(Nf.Mode=Yh.ForceCheckout);Li.HostIsEditOnly===
(Nf.Options&Li.HostIsEditOnly)&&(Nf.Mode=Yh.WriteOnly);if(Xk(Nf)?0:Fd()&&(Nf.Application==zj.OneNote||Yk(Te,!1)||Yk(rf,!1))||ad()||Hj()||!(N()||aj()||"ActiveXObject"in window&&!Ra()||Ci())||15<=ia())ol(Nf.Application,Nf.EncodeUrl?ei:jh,Nf.Mode,Nf.Application==zj.OneNote,Nf.SilentExternalHandler,Nf.NavigateUsingWindowOpen);else{var Ri;if(Ri=fg())a:{var qj=Nf.EncodeUrl?jh:Uh,cj=Nf.Mode,ok=tl(Nf.Application);try{Ri=(new ActiveXObject(Ab)).ViewDocument3(window.self,qj,cj,ok);break a}catch(Zk){}Ri=!1}if(Ri)dl(Uj.O15ActiveX);
else{if(N()||aj()){var Yj=Nf.EncodeUrl?jh:Uh;Uh=Nf.Mode;Ri=tl(Nf.Application);qj=sl();if(null==qj)Yj=Ke.DescriptiveUnattemptedEnums?Mh.PluginIsNull:Mh.Unattempted;else{cj=!1;try{cj=qj.ViewDocument3(window.self,Yj,Uh,Ri)}catch(Zk){}if(!cj)try{cj=cl(Uh)?qj.ViewDocument2(window.self,Yj,Ri):qj.EditDocument2(window.self,Yj,Ri)}catch(Zk){}Yj=cj?(dl(Uj.NpapiPlugin),Mh.None):Mh.Failed}}else{try{Yj=new ActiveXObject(dh),null!=Yj&&Yj.SaveSSOCreds()}catch(Zk){}Yj=kl(Nf.EncodeUrl?jh:Uh,Nf.Mode,Nf.Options,tl(Nf.Application))}if(Yj!=
Mh.None){if(Uh=Nf.CouldUseRoamingApps)zf||(zf=!0,Dg=vc("Windows NT")),Uh=6.1<=Dg&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Me()||aj()||Ci());if(Uh&&Nf.Application!=zj.OneNote){if(!Df.Ugb.dZj()){F(Mh.ControlNeeded,Ke.Application);return}if(Nf.RoamingAppsLauncher){"undefined"==typeof Nf.RoamingAppsLauncher||null==Nf.RoamingAppsLauncher?F(Ke.DescriptiveUnattemptedEnums?Mh.RoamingLauncherIsNull:Mh.Unattempted,Ke.Application):"undefined"==typeof Nf.RoamingBitsUrl||null==Nf.RoamingBitsUrl?Df.Ugb.qZj(Nf.DocumentUrl,
Nf.RoamingAppsLauncher,Nf.Application,Nf.ApplicationParameters,uc,ed):Df.Ugb.Fjg(Nf.DocumentUrl,Nf.RoamingAppsLauncher,Nf.RoamingApplicationExe,Nf.ApplicationParameters,Nf.RoamingPlatform,Nf.RoamingBitsUrl,uc,ed);return}if(!Nf.ContinueIfLauncherIsNull){F(Mh.LauncherNeeded,Ke.Application);return}}Li.NoProtocolHandlerFallback==(Nf.Options&Li.NoProtocolHandlerFallback)||Xk(Nf)||Me()||Fd()&&!(Ke.DescriptiveUnattemptedEnums?Yj>=Mh.O14Unattempted&&Yj<=Mh.DocumentUrlIsNull:Yj==Mh.Unattempted)?F(Yj,Ke.Application):
ol(Nf.Application,Nf.EncodeUrl?ei:jh,Nf.Mode,Nf.Application==zj.OneNote,Nf.SilentExternalHandler,Nf.NavigateUsingWindowOpen)}}}}else F(Ke.DescriptiveUnattemptedEnums?Mh.DocumentUrlIsNull:Mh.Unattempted,Ke.Application)}function dl(Nf){null!=uc&&uc(Nf)}function F(Nf,jh){"undefined"==typeof jh&&(jh=null);null!=ed&&ed(Nf,jh)}function ia(){var Nf=0;if(N()||aj()||Ci()){var jh=sl();try{null!=jh&&(Nf=jh.GetOfficeVersion())}catch(ei){}}else ll(Ab)?Nf=15:ll(Ec)?Nf=14:ll(Mc)?Nf=12:ll(zd)&&(Nf=11);return Nf}
function Qa(){return Fd()&&(Yk(Ld,!0)||Yk(ye,!0))}var Ab="SharePoint.OpenDocuments.5",Ec="SharePoint.OpenDocuments.4",Mc="SharePoint.OpenDocuments.3",zd="SharePoint.OpenDocuments.2",Ld="application/x-sharepoint",ye="application/x-sharepoint-webkit",Te="application/x-sharepoint-protocolhandler",rf="application/x-sharepoint-webkit-protocolhandler",dg="application/officelive",Jg="npSharePointPlugin",dh="IDBHO.IDBHOCtrl",bj="OneNote.Notebook",uh="ofv|",hi="ofc|",vi="ofe|",l="u|",J="|f|",Y="wdlor",za=
"",Ua="",Qb="",uc,ed,Dd,hd,Ke,zf,Dg,Tg,Rg,Yh={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Li={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Mh={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,
RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Uj={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},zj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Yh,OpenDocumentOptions:Li,OpenDocumentFailureType:Mh,OpenDocumentControl:Uj,OfficeApplication:zj,EditDocumentInClient:wl,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=zj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},
OfficeVersionInstalled:ia,IsO14MacPluginInstalled:Qa,OfferOfficeInDialog:function(){return la()&&11>=ia()},OfferOfficeNoIntrusive:function(){return la()&&15>ia()},OfferMacOffice:function(){return Fd()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Qa()},InstallRoamingControl:function(){gh()?window.InstallTrigger.install({Office:{URL:Ua}}):nk(Qb,null,null)},CanUseRoamingControl:function(){var Nf,jh,ei;if(ad())return!0;if(Ci())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),
!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(gh())return Nf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Nf),jh=document.createEvent("Events"),jh.initEvent("RoamingOfficeInstalled",!0,!1),Nf.dispatchEvent(jh),!!Nf.getAttribute("installed");if(Me())try{return ei=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),ei.HrExists()}catch(Uh){}return!1},InitUrls:function(Nf,jh,ei){za=Nf;Ua=ei;Qb=jh},LaunchRoamingApps:function(Nf,jh,ei,Uh,Ri,qj){Df.Ugb.Fjg(Nf,
jh,zl(ei),Uh,"x86",za,Ri,qj)},LaunchRoamingApps2:function(Nf,jh,ei,Uh,Ri,qj,cj,ok){var Yj="",Zk;if(null!=Uh&&(Yj+=" "+Uh),null!=Nf&&(Yj+=' "'+Nf+'"'),ad()||Ci())Dd=cj,hd=ok,cj='office: "'+(qj+'" "')+(ei+'" "ROAMING"'),cj+=' "'+jh+'"',cj+=' "'+Ri+'"',cj+=" "+Yj,Mj(cj,yl,ql,!1,!1);else if(gh())Nf=document.createElement("RoamingExtensionElement"),Nf.setAttribute("cabUrl",qj),Nf.setAttribute("app",ei),Nf.setAttribute("licensingEntitlements",jh),Nf.setAttribute("platform",Ri),Nf.setAttribute("args",Yj),
document.documentElement.appendChild(Nf),jh=document.createEvent("Events"),jh.initEvent("RoamingOfficeLaunch",!0,!1),Nf.dispatchEvent(jh),null!=cj&&cj(Uj.RoamingFFExtension);else if(Me()){if(Zk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Zk)try{Zk.HrConfigureSingle(qj,ei,jh,Ri,Yj),null!=cj&&cj(Uj.RoamingActiveX)}catch(El){}}else null!=ok&&ok(Mh.Failed)},ShouldShowDialog:function(){return!Ra()},NavigateToUrlUsingClickingOnATag:Ej,OpenDocumentWithProtocolHandler:ol,OpenDocumentWithProtocolHandlerNoCallBack:function(Nf,
jh,ei,Uh){var Ri=vl(Nf),qj;return null==Ri?(F(Ke.DescriptiveUnattemptedEnums?Mh.ProtocolHandlerNoCallbackIsNull:Mh.Unattempted,Ke.Application),!1):(qj=nl(Nf,jh,ei,Uh,Ri),Mj(qj,null,null,!1,!1),!0)}}}();Df.ClientUtils=Df.Ugb;var Ff=b(904),zh=b(51),og=b(36),vh=b(186);Bd.prototype.$c=function(){return!1};Bd.prototype.executeCommand=function(N,la,Ra){return 2!==this.Ei.Be(Zf.a.newDocument,2,Ra)?nh.Task.Ra(!0):vh.a(la.command)};Bd.prototype.Kc=function(N,la){return 1056925771===la.command};Bd.prototype.jd=
function(N,la,Ra){N=!0;switch(la){case "PopulateNewMenu":this.Ei&&this.Ei.Be(Zf.a.yqc,2,Ra);break;default:N=!1}return N};Object(Td.a)(Bd,"CreateNewCommandHandler",null,[424]);var ij=Ff.a;Am(Id,ij);Id.prototype.Nd=function(){var N=this,la=zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Ra=zh.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub);og.TaskExtensions.Ba(og.TaskExtensions.xe([la,Ra],this.la),function(){N.Dd([new Bd(be.AFrameworkApplication.Ib)])},this.la,3)};Id.ka=function(N){Ff.a.he(87,
new Id(N))};Object(Td.a)(Id,"CreateNewCommandHandlerFactory",Ff.a,[]);var k=b(1314),G=b(961),d=b(276),S=b(206),P=b(301),ja=b(5),D=b(159),da=b(102),Ha=b(79),jb=b(75),kc=b(387),Jb=b(175),md=b(59),ce=b(84),qe=b(337),Ye=b(648);Kc.prototype.tte=function(){};Kc.prototype.x7c=function(){this.Utg?eg.a.downloadFile(this._url):eg.a.rf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};Kc.prototype.dispose=function(){};Object(Td.a)(Kc,"OpenUrlInTabDialogDownloadBehavior",null,[134,2]);
var ma=b(257),ab=fh.StandardDialog;Am(Wb,ab);Wb.prototype.ZXc=function(){this.em&&(this.rWa||(this.rWa=Object(af.a)(this,this.IGi,"onActionButtonClicked"),this.Zy.pa(pg.a.click,this.ZB,this.rWa)),this.sWa||(this.sWa=Object(af.a)(this,this.JGi,"onActionButtonKeyUp"),this.pe.pa(pg.a.Sd,this.ZB,this.sWa)));ab.prototype.ZXc.call(this)};Wb.prototype.IGi=function(N){this.uSe(N);return!0};Wb.prototype.JGi=function(N){return this.Rjf(N,Object(af.a)(this,this.uSe,"executeDismissActionButtonFromArgs"))};Wb.prototype.uSe=
function(N){this.em&&this.em.submit();this.Tua(N.Mb)};Wb.prototype.Uud=function(){};Wb.prototype.rKe=function(){this.Pmf();this.em?this.em.submit():this.rSb.x7c();return!0};Wb.prototype.akc=function(){return!1};Wb.prototype.dispose=function(){this.rSb.dispose();this.Dib&&(be.AFrameworkApplication.sa.UX.za(pg.a.click,this.Dib,Object(af.a)(this,this.rKe,"downloadLinkClicked")),this.Dib=null);this.CY&&(be.AFrameworkApplication.sa.UX.za(pg.a.click,this.CY,Object(af.a)(this,this.akc,"learnMoreLinkClicked")),
this.CY=null);this.Zy&&this.rWa&&(this.Zy.za(pg.a.click,this.ZB,this.rWa),this.rWa=null);this.pe&&this.sWa&&(this.pe.za(pg.a.Sd,this.ZB,this.sWa),this.sWa=null);ab.prototype.dispose.call(this)};Wb.prototype.zMf=function(){this.em&&(document.body.appendChild(this.em),this.em.submit(),document.body.removeChild(this.em))};Wb.prototype.Dw=function(N){1===N&&(this.Uud(),this.em?Wb.Hu&&this.zMf():this.rSb.x7c());this.dispose()};Ck.Object.defineProperties(Wb.prototype,{p$e:{configurable:!0,enumerable:!0,
get:function(){return null}},OWd:{configurable:!0,enumerable:!0,get:function(){return null}},DOa:{configurable:!0,enumerable:!0,get:function(){return null}},SBb:{configurable:!0,enumerable:!0,get:function(){return null}},E8a:{configurable:!0,enumerable:!0,get:function(){return null}},arf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},i5c:{configurable:!0,enumerable:!0,get:function(){return null}},yWc:{configurable:!0,
enumerable:!0,get:function(){return null}},Gpe:{configurable:!0,enumerable:!0,get:function(){return null}}});Ck.Object.defineProperties(Wb,{Hu:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.sa.Pa.wv&&be.AFrameworkApplication.sa.Pa.$gf}},Pxb:{configurable:!0,enumerable:!0,get:function(){return Wb.R8d},set:function(N){Wb.R8d=N}}});Wb.R8d=!1;Object(Td.a)(Wb,"ADialogWithLinkToResource",fh.StandardDialog,[]);var bc=b(440),Rc=b(332),Nc=b(15);Am(ug,Wb);ug.prototype.Nmf=function(){Kd.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};ug.prototype.Pmf=function(){Kd.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};ug.prototype.akc=function(){bc.Redirect.showHelp(Rc.a.cGi);return!0};Ck.Object.defineProperties(ug.prototype,{DOa:{configurable:!0,enumerable:!0,get:function(){return Nc.a.instance.Wa(410)}},hkc:{configurable:!0,enumerable:!0,get:function(){return Nc.a.instance.Wa(411)}},
gkc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},SBb:{configurable:!0,enumerable:!0,get:function(){return"#"}},E8a:{configurable:!0,enumerable:!0,get:function(){return Nc.a.instance.Wa(412)}},arf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Td.a)(ug,"DownloadACopyAsOdsDialog",Wb,[]);Xf.prototype.tte=function(N){this.dialog=N};Xf.prototype.x7c=function(){this.zGi.DFf(-1059172980)};Xf.prototype.dispose=function(){this.zb.nIb(this.hxf)};Object(Td.a)(Xf,
"DownloadACopyAsOdsDialogDownloadBehavior",null,[134,2]);Object(Td.a)(Ef,"MacroRecorderWorkbookCalculationModeSetPayload",null,[447]);Object(Td.a)(jf,"MacroRecorderWorkbookRecalculatedPayload",null,[447]);var id=b(194),xe=b(109),cf=b(1),ag=b(323);Ck.Object.defineProperties(Af,{MVi:{configurable:!0,enumerable:!0,get:function(){return Af.LVi}}});Af.LVi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(Td.a)(Af,"OpenInAppDialogCopyHtml",null,[]);var tf=b(156),rg=ag.a;Am(Ge,rg);Ge.prototype.openUrl=function(N,la){var Ra=document.getElementById("link");Ra||(Ra=document.createElement("a"),Ra.id="link",Ra.style.visibility="hidden",Ra.href="",document.body.appendChild(Ra));Ra.target=la;Ra.href=N;Ra.click()};Ge.prototype.JEc=function(){var N=this;Kd.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,21,137,1),function(la){var Ra=
{};Ra.OpenInAppUrl=N.jma;Ra.StoreUrl=N.vm;la.result.Jj("UI_OpenInMobileApp",Ra)},this.$.la)};Ge.prototype.NVi=function(){Kd.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};Ge.prototype.jh=function(){this.gg=Ag.a.hp(Af.MVi,Nc.a.instance.fa(661),Nc.a.instance.fa(662),be.AFrameworkApplication.ZC,tf.getImageClass(be.AFrameworkApplication.ga.Va("AppIcon")),Nc.a.instance.fa(663));this.Oe="OpenInAppDialog";this.jc=5;this.initializeAndShow("",this.NVi.bind(this),null);this.aA(this.hI)};
Ge.prototype.Kv=function(N){rg.prototype.Kv.call(this,N);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.hI=document.getElementById("LinkToInstall");id.a.instance.pa(pg.a.click,this.hI,this.lEb);xe.KeyInputManager.instance.pa(pg.a.Sd,this.hI,this.xma)};Ge.prototype.dispose=function(){this.hI&&(id.a.instance.za(pg.a.click,this.hI,this.lEb),xe.KeyInputManager.instance.za(pg.a.Sd,this.hI,this.xma),this.hI=null);rg.prototype.dispose.call(this)};Ck.Object.defineProperties(Ge.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(Td.a)(Ge,"OpenInAppDialogCopy",ag.a,[]);Se.prototype.JEc=function(){var N=this;Kd.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,21,137,1),function(la){var Ra={};Ra[lf.a.JFf]=N.jma;Ra[lf.a.vm]=N.vm;la.result.Jj("UI_OpenInMobileApp",Ra)},this.$.la)};Se.prototype.jh=function(){Kd.ULS.sendTraceTag(523534412,0,
50,"initializeAndShowDialog: React Edit in app dialog opened.");var N=new fh.StandardDialog;N.jc=0;N.Bc(1,Nc.a.instance.fa(667));N.Ak(Nc.a.instance.fa(665),Nc.a.instance.fa(666),0,this.Sjg)};Object(Td.a)(Se,"OpenInAppDialogReact",null,[]);var ch=b(28),Hg=b(30),ri=b(370),wh=b(10),th=b(292),hg=b(21),li=b(43),Ni=b(258),Si=b(490),sj=b(395),Bj=b(49),ih=b(6),xi=b(146),uj=b(1186),Cj=b(81),Vh=b(34),yj=b(377),yi=b(261);Vc.prototype.jR=function(N,la){N=Hg.a.gd(12,1,668,0,0,0,"Blank");N.Description=String.format(Nc.a.instance.fa(669),
la);return N};Vc.prototype.vac=function(N){switch(N){case 1:case 2:return 0;default:return 2}};Object(Td.a)(Vc,"ReloadCloseConfirmation",null,[866]);var Aj=b(154),W=b(649),Ja=b(66),Eb=S.a;Am(ld,Eb);ld.prototype.$c=function(){return!1};ld.prototype.executeCommand=function(N,la,Ra,Pb){var vc=this,ad=this.z7b,Fd=this.$,ve=la.command,Me=this.openInExcelOperation,fg=this.$.Lb,gh=Ra.SourceControlId;Fd.Uk.hne(ve);Me.cxc(la.startTime.getTime().toString());N=null;switch(ve){case 1455037301:this.$.X5?Me.RCe():
Me.g3c();break;case -2044628748:case 2004484710:this.$.X5?Me.RCe():Me.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===gh?(this.uCb("CellLongPress"),Kd.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.uCb("PencilIcon"),Kd.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();
break;case -2028960985:Me.z6f();break;case -1059172980:new ug(Me.Qve(ve),new Xf(Me,Fd.zb));break;case -1285148982:this.clientWorkflow.rd.activityState[Vh.a.CUc]=!0;this.lBc(!1);break;case -75280711:this.lBc(!1);break;case -455164169:this.lBc(!0);break;case -1388494670:this.$.da.$a(400,function(Ej){Ej.Bzi();vc.lBc(!1)});break;case 810888577:be.AFrameworkApplication.tk=(new Date).getTime();Kd.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",be.AFrameworkApplication.tk);
break;case -1804063550:case -974518828:la=0;ja.a.mDd in Ra&&(la=Ra[ja.a.mDd]);Me.DFf(ve,la);break;case -1339961039:la=!1;Ra&&ja.a.jJb in Ra&&(la=Ra[ja.a.jJb]);this.reloadWorkbook(!1,la);break;case -8805455:var Wh=this.workbookContext;Fd.isEditMode||(ld.wAe(Fd),N=og.TaskExtensions.Ba(this.jK.value,function(Ej){Ej=Ej.result;var nk=Ej.isEnabled();nk&&Ye.a(Ej,Je.a.copyAndEdit,md.a.Dg.mZe(),vc.$.ea.Zg.get(2))?Kd.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
nk&&be.AFrameworkApplication.ifg?(nk={},nk[k.a.eGd]=be.AFrameworkApplication.userSessionId,nk[be.AFrameworkApplication.PBi]=ch.a.Ta.Wb.getTime().toString(),Kd.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),Ej.Jj(Je.a.editMode,nk)):ad.CopyAndEditUrl?vc.e4g():(vc.wc.supportsEditing||Wh.EditUrl)&&vc.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Fd.isEditMode&&(ld.wAe(Fd),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var Ci=Fd.na.va.hc(),Hj=-1355155015===ve?1:0,aj=function(){return new jf(Hj)};N=kc.a(this.$.userOperationManager,function(Ej,nk,Xk){return ce.V(Fd.na.va,Hj,null,Ej,nk,Xk,null,Ci)},function(Ej){return new Jb.a(128,0,Ej,void 0,aj)},la);hg.g(Fd).rg.iH(!1);break;case -1158102843:N=hg.g(Fd).rg.recalcSheet(la);hg.g(Fd).rg.iH(!1);break;case -988468372:if(cf.EwaSettings.ma(302))if(Pb=parseInt(Ra[Ha.a.ld],10),0<=Pb&&3>Pb)this.setCalculationMode(la,
Pb);else return Kd.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",Ra[Ha.a.ld]),vh.a(ve);break;case 257398710:D.a.ntw(ad.ReportAbuseUrl,Fd);break;case 1800405051:this.xkj();break;case -48469327:this.saveACopy();break;case 214430355:la=!1;Ra&&ja.a.g8c in Ra&&(la=Ra[ja.a.g8c]);if(!this.eyj(la,Ra))break;be.AFrameworkApplication.P5?this.businessBar.eg(40,null):this.businessBar.eg(la?22:23,null);break;case 1389557314:N=og.TaskExtensions.Ba(this.jK.value,function(Ej){Ye.a(Ej.result,
Je.a.oBh,null,vc.$.ea.Zg.get(6))||D.a.ntw(ad.FileVersionUrl,Fd)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:gh===fg+ja.a.Ijf?Me.psi():Me.osi();break;case 512141517:gh===fg+ja.a.Hjf?Me.zsi():Me.ysi();break;case -1224038235:var mk=G.a.On in Ra?!Ra[G.a.On]:da.j(Fd.ea.workbookContext.Options);Ra[G.a.Description]=mk?Nc.a.instance.fa(570):Nc.a.instance.fa(571);N=kc.a(this.$.userOperationManager,function(Ej,nk,Xk){var cl=vc.$.na.va,kl=cl.Na(9,null);kl.isReadOnlyRecommended=
!mk;return ce.i(cl,"SetReadOnlyRecommended",kl,Ej,nk,Xk,null,0)},function(Ej){return new Jb.a(129,0,Ej)},la);break;case 1118926154:if(this.$.isEditMode){var Mj=new Qh.a;this.$.da.$a(53,function(Ej){Ej?(Ej.Wm.jsi(vc.$.Lb+ja.a.Rsd),Mj.setResult(!0)):Kd.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});N=Mj.task}break;case -1698025133:Me.openInBrowser();break;case 520859864:N=og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,393,394,
Pb.dka()),function(Ej){Ej.result||Kd.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:N=vh.a(ve)}return N||nh.Task.Ra(!0)};ld.prototype.uCb=function(N){if(cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(wh.HelperMethods.I_){var la=new Map;la.set("EntryPoint",N);$g.Health.instance.recordKpiUsage(sj.a.KVi,0,Si.a.yBi,la)}else Kd.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};
ld.prototype.showOpenInAppDialog=function(){be.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(Kd.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new Se(this.$)).jh()):cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(Kd.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),
(new Ge(this.$)).jh()):(Kd.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),be.AFrameworkApplication.showOpenInAppDialog()))};ld.prototype.eyj=function(N,la){var Ra=this;return be.AFrameworkApplication.isMobileMode&&!jb.a(this.$.ya,30)?(this.showOpenInAppDialog(),Kd.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.uCb("CellDoubleTap"),
Kd.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):be.AFrameworkApplication.Ghc&&(N&&ri.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(Kd.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",ri.d(this.workbookContext.WorkbookFileName)?
"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):d.a.any([25,26,30,31,55,32],function(Pb){return Ra.businessBar.IMa(Pb)})?(Kd.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):la&&ja.a.T2i in la&&!N?!1:!0};ld.prototype.Kc=function(N,la){N=!1;switch(la.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:N=
!0;break;case 520859864:N=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:N=cf.EwaSettings.ma(109);break;case -1388494670:N=cf.EwaSettings.ma(109);break;case 810888577:N=cf.EwaSettings.ma(271);break;case -1224038235:N=this.$.ea.amIAlone;break;case -988468372:N=cf.EwaSettings.ma(302);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:N=!0,Kd.ULS.shipAssertTag(537162642,0,this.$.Vka,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return N};ld.prototype.jd=function(){return!1};ld.prototype.xkj=function(){var N=this;if(this.sc){var la=this.$;li.a(la).rt(new Ni.a(ih.a.Az,5,function(){la.vI(!1,!0);var Ra=N.clientWorkflow.rd.activityState;Ra[yi.a.hr]=ih.a.$da;Ra[xi.a.rU]=2;Ra[Vh.a.Rs]=la.isEditMode;Ra[xi.a.fha]=!1}))}};ld.prototype.saveACopy=function(){var N=this;if(this.sc){var la=this.$;li.a(la).rt(new Ni.a(ih.a.Az,5,function(){la.vI(!1,
!1);var Ra=N.clientWorkflow.rd,Pb=Ra.activityState;Pb[yi.a.hr]=ih.a.TVf;Pb[W.a.XYb]=N.wc.hasUnsupportedFeaturesForEdit;Pb[xi.a.fha]=!1;Ra.Lt(Hg.a.Oaa(N.businessBar.v8c,[-502303485]))}))}};ld.prototype.lBc=function(N){var la=this;li.a(this.$).rt(new Ni.a(ih.a.Kna,2,function(){la.$.vI(!0,!0);var Ra=Ja.a(la.$).rd,Pb=la.$.isEditMode;Pb=Hg.a.gd(1,1,0,0,0,Pb?-315732528:-2087635043,Pb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Pb.ForceVersionUpgrade=N;Ra.Lt([Pb]);Ra=Ja.a(la.$).rd.activityState;
Ra[yi.a.hr]=ih.a.Kna;Ra[Vh.a.Rs]=la.$.isEditMode;Ra[xi.a.fha]=!1}))};ld.prototype.closeWorkbook=function(){var N=this;if(this.sc){var la=this.$;md.a.Dg.zxc("2145659238")?og.TaskExtensions.Ba(this.jK.value,function(Ra){Ra.result.Jj(Je.a.NTe,{})},this.la,3):li.a(la).rt(new Ni.a(ih.a.Az,5,function(){la.vI(!0,!1);var Ra=N.clientWorkflow.rd.activityState;Ra[xi.a.YY]=!1;Ra[xi.a.fha]=!1;N.wc.inViewerFromWebPart?(qe.a.TGd(la,N.clientWorkflow.rd),la.Uk.hz("InViewerFromWebPart"),Ra[yi.a.hr]=ih.a.h0):(Ra[yi.a.hr]=
ih.a.Ik,la.Pd&32?Ra[xi.a.rU]=0:(Ra[xi.a.rU]=1,Ra[xi.a.MYb]=new uj.a),Ra[Aj.a.Gle]=!0)}))}};ld.prototype.e4g=function(){var N=this,la=this.wc.vbaRemovedDuringConversion;Kd.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",la);var Ra=this.$;la?li.a(Ra).rt(new Ni.a(ih.a.Az,5,function(){var Pb=Hg.a.gd(3,0,0,1232,0,1069271157,"XLSMacroFailure");N.clientWorkflow.rd.Lt([Pb]);N.clientWorkflow.rd.activityState[yi.a.hr]=ih.a.hfb})):be.AFrameworkApplication.hideHeader?
wh.HelperMethods.rf(this.z7b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):D.a.ntw(this.z7b.CopyAndEditUrl,Ra)};ld.prototype.reloadWorkbookInEditMode=function(){var N=this;if(this.sc)if(cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&md.a.Dg.rW&&md.a.Dg.BId(),be.AFrameworkApplication.Ghc&&!be.AFrameworkApplication.ola)wh.HelperMethods.rf(this.$.Hpb(!0),P.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var la=
this.$,Ra=!1,Pb=this.wc.hasUnsupportedFeaturesForEdit,vc=this.workbookContext.FileWasRepaired;ri.d(this.workbookContext.WorkbookFileName)?(Ra=!0,Kd.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Pb)):ri.a(this.workbookContext.WorkbookFileName)&&(Ra=!0,Kd.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var ad=la.Yf.get(59);ad=!(la.ea.wc.supportsEditing&&
ad);if(Ra&&!Pb||ad&&(Ra||Pb)){var Fd=ad?Pb?-2066104278:816071846:cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&jb.a(this.$.ya,25)&&!this.$.yAb?765011943:-213064907;Ra=function(){var ve=Hg.a.A_a([Fd]);N.clientWorkflow.rd.Lt(ve);N.clientWorkflow.rd.activityState[yi.a.hr]=ih.a.hfb}}else Ra=function(){la.vI(!0,!1);var ve=N.clientWorkflow.rd,Me=ve.activityState;Me[xi.a.rU]=1;Me[yj.a.RYb]=Di.a.Olc;Me[Vh.a.Rs]=!0;Me[W.a.XYb]=N.wc.hasUnsupportedFeaturesForEdit;Me[xi.a.fha]=
!!N.workbookContext.EditUrl;Me[Cj.a.V2]=N.workbookContext.EditUrl;if(!N.z7b.CopyAndEditUrl){var fg=[cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&jb.a(N.$.ya,25)&&!N.$.yAb?-943219229:1821390342];ve.Lt(Hg.a.Oaa(N.businessBar.v8c,fg))}vc&&!Pb?(ri.b(N.workbookContext.WorkbookFileName)&&cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(ve=Hg.a.A_a([-425642652]),Kd.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
ve=Hg.a.A_a([108482388]),N.clientWorkflow.rd.Lt(ve),Me[yi.a.hr]=ih.a.gWf):N.$.ea.m8e?(Kd.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Bj.b().HUd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Me[yi.a.hr]=ih.a.gGb):Me[yi.a.hr]=N.$.ea.shc?ih.a.WBb:ih.a.hfb};li.a(la).rt(new Ni.a(ih.a.Az,5,Ra))}};ld.prototype.reloadWorkbookInViewMode=function(){var N=
this;if(this.sc){cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&md.a.Dg.rW&&md.a.Dg.BId();var la=this.$;Mf.a.Fh&&hg.g(la).rc.textBox.blur();li.a(la).rt(new Ni.a(ih.a.Az,5,function(){la.vI(!la.ea.isNamedObjectViewMode,!1);var Ra=N.clientWorkflow.rd.activityState;Ra[yi.a.hr]=ih.a.nia;Ra[xi.a.rU]=1;Ra[xi.a.YY]=!0;Ra[Vh.a.Rs]=!1;Ra[Vh.a.unb]=!0;Ra[yj.a.RYb]=Di.a.Olc}))}};ld.prototype.reloadWorkbook=function(N,la){var Ra=this;if(this.sc){var Pb=this.$;Pb.bR&65536&&
li.a(Pb).rt(new Ni.a(ih.a.Az,5,function(){Pb.vI(N,!0);var vc=Ra.clientWorkflow.rd.activityState;vc[yi.a.hr]=ih.a.Jk;vc[Vh.a.FUc]=Ra.workbookContext.NovMode;la||(vc[xi.a.rU]=1,vc[xi.a.MYb]=new Vc)}))}};ld.prototype.setCalculationMode=function(N,la){function Ra(){return new Ef(la)}var Pb=this;Kd.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",la);var vc=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=la;return kc.a(this.$.userOperationManager,
function(ad,Fd,ve){var Me=Pb.$.na.va;ad=th.b(ad,ld.CSi(Pb.$,vc));Fd=th.a(Fd,ld.BSi(Pb.$,vc));var fg=Me.Na(9,null);fg.calc_type=la;return ce.i(Me,"SetCalculationOptions",fg,ad,Fd,ve,null,0)},function(ad){return new Jb.a(197,0,ad,void 0,Ra)},N)};ld.wAe=function(N){N.zb&&0<N.zb.pS&&N.zb.Z$c(function(la){la.Ut()})};ld.CSi=function(N,la){return function(Ra){Hg.a.rh(Ra.Errors)&&(N.ea.workbookContext.CalcMode=la,Kd.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
la,Hg.a.Xc(Ra.Errors)))}};ld.BSi=function(N,la){return function(){N.ea.workbookContext.CalcMode=la;Kd.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",la)}};Ck.Object.defineProperties(ld.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.sc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},z7b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return Ja.a(this.$)}},wc:{configurable:!0,enumerable:!0,get:function(){return this.$.wc}}});Object(Td.a)(ld,"FileOperationsCommandHandler",S.a,[424]);var gc=b(157),Yc=Ff.a;Am(tc,Yc);tc.prototype.Nd=function(){var N=this,la=this.$,Ra=[],Pb=zh.GetServiceTaskFactory.create(la.da,56,this.la,this.ub);Ra.push(Pb);var vc=zh.GetServiceTaskFactory.Ua(la.da,5,4,this.ub);Ra.push(vc);og.TaskExtensions.Ba(nh.Task.WAA.apply(null,Ra),function(){gc.b(Pb)&&
N.Dd([new ld(la,Pb.result,new Gf.a(function(){return zh.GetServiceTaskFactory.create(la.da,137,N.la,N.ub)}),vc.result)])},this.la,0)};tc.ka=function(N){Ff.a.he(94,new tc(N))};Object(Td.a)(tc,"FileOperationsCommandHandlerFactory",Ff.a,[]);var vd=b(45),fe;(function(N){N[N.url=0]="url";N[N.ref=1]="ref";N[N.mailto=2]="mailto"})(fe||(fe={}));Object(Td.b)("HyperlinkSelectionState",fe);var re=b(980),Oe=b(9),Wc=b(646),Pf=b(87),nf=re.a;Am($b,nf);$b.prototype.L0e=function(N,la){switch(la){case 2:return N.startsWith("mailto:")?
N:"mailto:"+N;case 1:return String.format("{0}{1}",Oe.a.zIf,this.iTh(N));default:return N}};$b.prototype.Nx=function(){var N=this,la=this.$;this.location=this.L0e(this.Myd,this.Lyd);try{this.location=Pf.a.fg(this.location)}catch(vc){Kd.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}Kd.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",fe[this.Lyd]);this.cellValue=this.Kyd.length?this.Kyd:this.Myd;la.Oy();var Ra=la.na.va.hc(),Pb=vd.s(this.selectedRange);return function(vc,ad,Fd){return ce.c(la.na.va,
Pb,N.cellValue,N.location,N.removeHyperLink,!1,123,vc,ad,Fd,N.rM.range,Ra)}};$b.prototype.vk=function(){var N=this,la=vd.s(this.selectedRange);return function(){return new Wc.a(la,N.cellValue,N.location)}};$b.prototype.Szh=function(){var N=this.rM.cell.T5a;this.rM.cell.qxb?N&&N.startsWith("mailto:")?(this.qnb=2,N=N.substr(7)):this.qnb=0:this.qnb=1;return N};$b.prototype.bMa=function(){cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.rzb=this.rM.wba:this.rzb=!!this.rM.LKa(64)||
!!this.rM.LKa(128)};$b.prototype.um=function(){if(this.rzb){this.Y1a=this.rM.text;var N=this.Szh();N&&(this.rUc=N);this.Im=Nc.a.instance.fa(820);this.wrb=this.rUc===this.Y1a}else this.rM.text?(this.Y1a=this.rM.text,this.wrb=!1):(this.Y1a="",this.wrb=!0),this.qnb=0,this.Im=Nc.a.instance.fa(819);this.rM.LH&&(this.wrb=!1,this.$Ie=!0,cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.Y1a=this.rM.formulaBarText))};$b.prototype.XCi=function(N){return this.ea.Hb.Aj(N)};
$b.prototype.e_e=function(N,la){return N?null:Nc.a.instance.fa(la)};$b.prototype.iTh=function(N){var la=vd.Z(N,this.ea.xa);var Ra=la.sheetName;var Pb=la.range;la.returnValue&&Pb&&(N=vd.x(Pb,Ra||this.sheetName,!1));return N};Ck.Object.defineProperties($b.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Iu:{configurable:!0,enumerable:!0,get:function(){return 526}}});$b.cWj="validateLinkValues";$b.pPg="bodyProps";$b.Zfh="disableDisplayText";$b.Qgh="displayTextValue";
$b.qAg="activeLinkOption";$b.rAg="activeLinkValue";$b.l4g="copyLinkValueToDisplay";$b.lti="linkValue";$b.Qmj="selectedLink";$b.Pgh="displayText";Object(Td.a)($b,"HyperlinkDialog",re.a,[]);Sb.prototype.$c=function(){return!1};Sb.prototype.Kc=function(N,la){return 1===N&&-1583422759===la.command};Sb.prototype.jd=function(){return!1};Sb.prototype.executeCommand=function(){this.$Aj();return nh.Task.Ra(!0)};Sb.prototype.$Aj=function(){var N=vd.v(this.gridView.ha.ta.ud,this.$),la=hg.e(this.gridView);(!cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.Dq([this.gridView.ha.ta.ud],!0))&&la&&new $b(this.$,N,la)};Object(Td.a)(Sb,"ShowHyperlinkCommandHandler",null,[424]);var Qg=Ff.a;Am(qb,Qg);qb.prototype.Nd=function(){this.Dd([new Sb(this.$,hg.g(this.$))])};qb.ka=function(N){Ff.a.he(105,new qb(N))};Object(Td.a)(qb,"ShowHyperlinkCommandHandlerFactory",Ff.a,[]);var Ng=b(22),ti=b(1209);pa.create="Create";pa.activate="Activate";pa.close="Close";pa.remove="Delete";pa.duplicate="Duplicate";Object(Td.a)(pa,"Actions",null,[]);var qh=nh.Task;Am(Ie,qh);
Ie.prototype.ZL=function(){this.g1d=Hg.a.gd(3,2,0,1632,0,-1244327602,"MsFormDeleteConfirmation");this.kj=li.a(this.Cf.$).ui(this.g1d).G();this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext));return this.fEc};Ie.prototype.fEc=function(){this.i1d=this.kj.Dz();0===this.i1d&&(this.Cf.$.workbookContext.Options=wh.HelperMethods.MO(!1,this.Cf.$.workbookContext.Options,2048),this.Cf.deleteMsFormMetaDataSheet());this._state=3;this.XRa(!0)};Ie.prototype.dispose=function(){};Object(Td.a)(Ie,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
nh.Task,[2]);Rb.action="Action";Rb.EDh="FlexPane";Rb.V$b="formId";Rb.id="id";Rb.title="Title";Rb.FPb="XlWorkbookId";Rb.GFh="Fragment";Rb.host="Host";Rb.QLj="TopView";Rb.S2="auth_pvr";Object(Td.a)(Rb,"Parameters",null,[]);ae.prototype.$c=function(N,la){switch(la){case -105284469:return!da.i(this.$.kg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};ae.prototype.executeCommand=function(N,la){N=og.TaskExtensions.Dl();la=la.command;switch(la){case -105284469:this.insertMsForm();
break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:N=this.deleteMsForm();break;default:N=vh.a(la)}return N};ae.prototype.Kc=function(N,la){if(!this.$.ea.Zg.get(61))return!1;N=!1;switch(la.command){case -105284469:N=da.i(this.$.kg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:N=this.hasMsForm}return N};ae.prototype.jd=function(){return!1};ae.prototype.insertMsForm=
function(){var N=Hf.a.Hq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),la={},Ra={};la[Rb.action]=pa.create;la[Rb.S2]=this.S2;Ra[Rb.action]=pa.create;Ra[Rb.FPb]=encodeURIComponent(this.APb);Ra[Rb.host]=this.xo;Ra[Rb.title]=encodeURIComponent(N);this.PCb(la,Ra);this.$.workbookContext.Options=wh.HelperMethods.MO(!1,this.$.workbookContext.Options,2048)};ae.prototype.editMsForm=function(){var N={},la={};N[Rb.S2]=this.S2;la[Rb.V$b]=this.bmc;la[Rb.FPb]=encodeURIComponent(this.APb);la[Rb.host]=
this.xo;this.PCb(N,la)};ae.prototype.previewMsForm=function(){var N={},la={};N[Rb.S2]=this.S2;la[Rb.V$b]=this.bmc;la[Rb.FPb]=encodeURIComponent(this.APb);la[Rb.host]=this.xo;la[Rb.QLj]="Preview";this.PCb(N,la)};ae.prototype.sendMsForm=function(){var N={},la={};N[Rb.S2]=this.S2;la[Rb.V$b]=this.bmc;la[Rb.EDh]="SendForm";la[Rb.FPb]=encodeURIComponent(this.APb);la[Rb.host]=this.xo;this.PCb(N,la)};ae.prototype.deleteMsForm=function(){return new Ie(this)};ae.prototype.deleteMsFormMetaDataSheet=function(){var N=
this;this.$.userOperationManager.Zt(new Jb.a(158,0,function(la,Ra,Pb){return ud(N.$.na.Uw,N.NV.Rub,th.b(la,function(){N.Wdh()}),Ra,Pb,null)}))};ae.prototype.Wdh=function(){var N={},la={};N[Rb.action]=pa.remove;N[Rb.S2]=this.S2;la[Rb.action]=pa.remove;la[Rb.host]=this.xo;la[Rb.V$b]=encodeURIComponent(this.bmc);la[Rb.FPb]=encodeURIComponent(this.APb);this.PCb(N,la)};ae.prototype.PCb=function(N,la){var Ra=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Pb="",vc="";if(la){for(var ad in la){var Fd=ad,
ve=la[ad];vc+=vc.length?"&":"";vc+=Fd+"="+ve}N||(N={});N[Rb.GFh]=encodeURIComponent(vc)}if(N)for(var Me in N)la=Me,vc=N[Me],Pb+=Pb.length?"&":"?",Pb+=la+"="+vc;window.open(Ra+Pb,"_blank")};Ck.Object.defineProperties(ae.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return da.c(this.$.kg)}},bmc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},APb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},S2:{configurable:!0,
enumerable:!0,get:function(){return Ng.a.contains(this.$.Yu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(Td.a)(ae,"MsFormCommandHandler",null,[424]);var fi=Ff.a;Am(Ce,fi);Ce.prototype.Nd=function(){var N=this,la=zh.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ub);og.TaskExtensions.Ba(og.TaskExtensions.xe([la],this.la),function(){N.Dd([new ae(N.$)])},this.la,3)};Ce.ka=function(N){N.ea.Zg.get(61)&&Ff.a.he(215,new Ce(N))};Object(Td.a)(Ce,"MsFormCommandHandlerFactory",
Ff.a,[]);var $h=oh.a;Am(Md,$h);Md.prototype.create=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(this.$.da,164,this.la,this.ub),function(){N.Eb(new Fe)},this.la,3)};Object(Td.a)(Md,"NewAndOpenUXFactory",oh.a,[]);zc.prototype.executeCommand=function(N,la,Ra){N=2;switch(la.command){case Zf.a.openUrlInNewTab:N=this.Ei.Be(Zf.a.openUrlInNewTab,2,Ra);break;case Zf.a.APa:N=this.Ei.Be(Zf.a.APa,2,Ra)}return 2!==N?nh.Task.Ra(!0):vh.a(la.command)};zc.prototype.Kc=function(N,la){return la.command===
Zf.a.openUrlInNewTab||la.command===Zf.a.APa};zc.prototype.jd=function(N,la,Ra){return"PopulateMruMenu"===la?(this.Ei.Be(Zf.a.xqc,2,Ra),!0):!1};zc.prototype.$c=function(){return!1};Object(Td.a)(zc,"OpenFromMruCommandHandler",null,[424]);var Fi=Ff.a;Am(jc,Fi);jc.prototype.Nd=function(){var N=this,la=zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Ra=zh.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub);og.TaskExtensions.Ba(og.TaskExtensions.xe([la,Ra],this.la),function(){N.Dd([new zc(N.$,
be.AFrameworkApplication.Ib)])},this.la,3)};jc.ka=function(N){Ff.a.he(88,new jc(N))};Object(Td.a)(jc,"OpenFromMruCommandHandlerFactory",Ff.a,[]);var di=b(90),V=b(83),ya=b(251),lb=b(717),Kb=b(1153),Lb=ya.a;Am(vg,Lb);vg.prototype.execute=function(N){var la=Object(V.a)(6,N.Le);if(!la.Vka)return Kd.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Jnd(N),this.Bh(ih.a.idle),1;this.CCb||(this.CCb=new Kb.DownloadACopyOperation(this.Zkc,
la));this.CCb.tih();Kd.ULS.shipAssertTag(537154817,0,3!==Ja.a(la).xi.au,"The current activity should not be closed.");return 1};vg.prototype.Jnd=function(N){var la=Object(V.a)(6,N.Le),Ra=new lb.a(la);this.subscribe(N,this.sCd,function(Pb){Ra.add_disposing(Pb)});Kd.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Ra.initialize();Ra.kf()};vg.prototype.dispose=function(){di.a.Ha(this.CCb);this.CCb=null;Lb.prototype.dispose.call(this)};
Object(Td.a)(vg,"DownloadAForkedCopyActivity",ya.a,[]);var Xa=oh.a;Am(qf,Xa);qf.prototype.create=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){N.Eb(new vg(ih.a.f2a,ih.a.Ik,!0))},this.la)};Object(Td.a)(qf,"DownloadACopyPreDatalossActivityFactory",oh.a,[]);var od=oh.a;Am(Lf,od);Lf.prototype.create=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){N.Eb(new vg(ih.a.unmergeableDownloadCopy,
ih.a.Uoa))},this.la)};Object(Td.a)(Lf,"DownloadAForkedCopyActivityFactory",oh.a,[]);Ig.prototype.Og=function(){this.La.fc(Zf.a.tryMacOffice,ig.a.frame,Object(af.a)(this,this.vUi,"onTryMacOffice"));this.La.fc(Zf.a.jbg,ig.a.frame,Object(af.a)(this,this.QEf,"onTryMacOfficeFromViewer"));this.La.fc(Zf.a.ibg,ig.a.frame,Object(af.a)(this,this.QEf,"onTryMacOfficeFromViewer"))};Ig.prototype.vUi=function(N,la,Ra,Pb,vc){if(1===Ra)return 32;vc?(N=vc.SourceControlId,"btnjTryMacOfficeForWordEditor"===N?eg.a.rf(Ug.a.h_(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===N&&eg.a.rf(Ug.a.h_(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.flf();return 32};Ig.prototype.QEf=function(N,la,Ra){if(1===Ra)return 32;switch(N){case Zf.a.jbg:eg.a.rf(Ug.a.h_(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Zf.a.ibg:eg.a.rf(Ug.a.h_(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};Ig.prototype.flf=function(){var N=void 0===N?null:N;
var la=0;N&&(la=N);eg.a.rf(2===la?"https://go.microsoft.com/fwlink/?LinkId=331579":Ig.Ayi,"_blank",void 0,"LaunchMacTrialWindow")};Ck.Object.defineProperties(Ig.prototype,{Lxc:{configurable:!0,enumerable:!0,get:function(){return this.Hrg&&Mf.a.isMac&&!Mf.a.Oli&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Yxj:{configurable:!0,enumerable:!0,get:function(){return this.Lxc}}});Ck.Object.defineProperties(Ig,{Ayi:{configurable:!0,enumerable:!0,get:function(){return Ug.a.EH("522401")}}});Object(Td.a)(Ig,
"MacOfficeOffer",null,[300]);Re.prototype.Og=function(){this.La.fc(Zf.a.tryOffice,ig.a.frame,Object(af.a)(this,this.wUi,"onTryOffice"));this.La.fc(Zf.a.tryOfficeThroughTellMe,ig.a.frame,Object(af.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.fc(Zf.a.mbg,ig.a.frame,Object(af.a)(this,this.nbg,"tryOfficeThroughViewer"));this.La.fc(Zf.a.lbg,ig.a.frame,Object(af.a)(this,this.nbg,"tryOfficeThroughViewer"))};Re.prototype.wUi=function(N,la,Ra,Pb,vc){if(this.UXb&&1===Ra)return this.isFreemiumUpsellEnabled&&
this.DLb?32:8;2===Ra&&(vc?(N=vc.SourceControlId,"btnjTryOfficeForWordEditor"===N?eg.a.rf(Ug.a.h_(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===N?eg.a.rf(Ug.a.h_(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Zjc()):this.Zjc());return 32};Re.prototype.tryOfficeThroughTellMe=function(N,la,Ra,Pb,vc){if(this.UXb&&1===Ra)return this.isFreemiumUpsellEnabled&&this.DLb?32:8;2===Ra&&(vc?(N=vc.SourceControlId,eg.a.rf(Ug.a.EH("862405")+this.yVh(N),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):eg.a.rf(Ug.a.EH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};Re.prototype.nbg=function(N,la,Ra){if(this.UXb&&1===Ra)return this.isFreemiumUpsellEnabled&&this.DLb?32:8;if(2===Ra)switch(N){case Zf.a.mbg:eg.a.rf(Ug.a.h_(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Zf.a.lbg:eg.a.rf(Ug.a.h_(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};Re.prototype.Zjc=function(N){N=void 0===N?null:N;var la=
0;N&&(la=N);eg.a.rf(Re.jTh(la),"_blank",void 0,"LaunchOfficeOffer")};Re.prototype.yVh=function(N){var la=0;switch(N){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":la=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":la=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":la=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":la=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":la=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":la=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":la=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":la=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":la=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":la=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":la=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":la=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":la=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":la=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":la=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":la=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":la=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":la=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":la=29}return 0===la?"":String.format("&pc={0:D}",la)};Re.jTh=function(N){if(Mf.a.Fh)switch(N){case 1:return Ug.a.EH("393806");case 2:return Ug.a.EH("393810");case 3:return Ug.a.EH("393809");case 5:return Ug.a.EH("393805")}else if(Mf.a.qp)switch(N){case 1:return Ug.a.EH("521979");
case 3:return Ug.a.EH("521980");case 5:return Ug.a.EH("521978");case 2:return Ug.a.EH("522490")}else{if(2===N)return Ug.a.EH("517778");if(1===N)return Ug.a.h_(30)}return Ug.a.EH("522402")};Ck.Object.defineProperties(Re.prototype,{Stf:{configurable:!0,enumerable:!0,get:function(){return this.DLb}},eGi:{configurable:!0,enumerable:!0,get:function(){return this.DLb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},DLb:{configurable:!0,enumerable:!0,get:function(){return this.Krg&&!Mf.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,
enumerable:!0,get:function(){var N=!1;this.OFc&&(N=this.OFc.isFreemiumUpsellEnabled());return N}}});Object(Td.a)(Re,"OfficeTrialExperience",null,[299]);ie.prototype.fi=function(N){N.register(Re,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Ic().Oc(function(){return new Re(be.AFrameworkApplication.Ib,be.AFrameworkApplication.dAb,be.AFrameworkApplication.lcid)});N.register(Ig,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Ic().Oc(function(){return new Ig(be.AFrameworkApplication.Ib,
be.AFrameworkApplication.whc,be.AFrameworkApplication.lcid)})};Object(Td.a)(ie,"OpenInClientConfiguration",null,[5]);var Yd=b(1400),ke=b(38),Yf=b(1300),Tf=b(228);Ck.Object.defineProperties(Ue,{gg:{configurable:!0,enumerable:!0,get:function(){return Ag.a.hp(Ue.yk,CommonUIStrings.l_OICLaunchDialogTitle)}}});Ue.yk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Td.a)(Ue,"OICLaunchDialogHtml",null,[]);var Kg=Ag.a;Am(rd,Kg);rd.prototype.h$a=function(){this.dDa=pe("BtnRichClient",this.vq.Osb,this.vq.kyb,this.vq.Vld,CommonUIStrings.l_OICLaunchRichClient,Object(af.a)(this,this.MCf,"onRichClientButtonClick"),Ne);document.getElementById("OICLaunchRichClient").appendChild(this.dDa);gg(this.dDa);this.yVa=pe("BtnReturn",this.vq.Osb,this.vq.kyb,this.vq.K$e,CommonUIStrings.l_OICReturnToOnlineClient,Object(af.a)(this,this.JCf,"onReturnButtonClick"),Ne);document.getElementById("OICReturnToApp").appendChild(this.yVa);
gg(this.yVa)};rd.prototype.JCf=function(){this.hide();this.vq.ucb();return!0};rd.prototype.MCf=function(){Kd.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();be.AFrameworkApplication.Ib.processAction(Zf.a.kRa,2);return!0};rd.prototype.yGi=function(){this.vq.ucb()};rd.prototype.dispose=function(){this.gqa||(this.dDa&&(Tf.a.instance.za(pg.a.click,this.dDa,Object(af.a)(this,this.MCf,"onRichClientButtonClick")),xe.KeyInputManager.instance.za(pg.a.Sd,this.dDa,Ne)),this.yVa&&
(Tf.a.instance.za(pg.a.click,this.yVa,Object(af.a)(this,this.JCf,"onReturnButtonClick")),xe.KeyInputManager.instance.za(pg.a.Sd,this.yVa,Ne)),Kg.prototype.dispose.call(this),this.gqa=!0)};Object(Td.a)(rd,"OICLaunchDialog",Ag.a,[]);Ck.Object.defineProperties(te,{gg:{configurable:!0,enumerable:!0,get:function(){return Ag.a.hp(te.yk,CommonUIStrings.l_OICDialogTitle)}}});te.yk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Td.a)(te,"ProtocolLaunchingDialogV2Html",null,[]);var Og=Ag.a;Am(Sd,Og);Sd.prototype.h$a=function(){var N=document.getElementById("Issues");if(N){ef("",this.vq.Osb,this.vq.kyb,this.vq.Vld,N);var la=document.createElement("span");la.className="WACDialogSectionTitle";la.innerText=5===this.vq.HFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;N.appendChild(la);gg(N);N.style.display="none"}be.AFrameworkApplication.sa.Pa.Kid?(this.xVa=pe("GiveFeedback",this.vq.Osb,
this.vq.kyb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(af.a)(this,this.Inc,"onGiveFeedbackClick"),Object(af.a)(this,this.Wyf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.xVa),gg(this.xVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===be.AFrameworkApplication.sa.Pa.editMode||be.AFrameworkApplication.$fh?document.getElementById("ButtonEdit").style.display="none":(this.xfa=pe("Edit",this.vq.Osb,this.vq.kyb,
"",2===be.AFrameworkApplication.sa.Pa.Sj?4===be.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===be.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(af.a)(this,this.yxf,"onEditClick"),Object(af.a)(this,this.Dxf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.xfa),gg(this.xfa));0===be.AFrameworkApplication.sa.Pa.editMode&&
!be.AFrameworkApplication.dAb&&N&&(N.style.display="none")};Sd.prototype.HVe=function(){return this.Npa?(this.aA(this.Npa),!0):!1};Sd.prototype.FVe=function(){return this.xfa?(this.aA(this.xfa),!0):!1};Sd.prototype.Dxf=function(N){return this.xAd(N,0)};Sd.prototype.Wyf=function(N){return this.xAd(N,2)};Sd.prototype.HCf=function(N){return this.xAd(N,1)};Sd.prototype.xAd=function(N,la){var Ra=!1;if(N.Ca.keyCode===qi.a.ei||N.Ca.keyCode===qi.a.hpa)N.Mb.click(),Ra=!0;else if(N.Ca.keyCode===Sys.UI.Key.down||
N.Ca.keyCode===Sys.UI.Key.up)switch(la){case 1:Ra=this.FVe();break;case 0:Ra=this.HVe()}return Ra};Sd.prototype.yxf=function(){this.hide();4===be.AFrameworkApplication.sa.Pa.editMode?(Kd.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.vq.ucb()):(Kd.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.vq.jjd());return!0};Sd.prototype.Inc=function(){Kd.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.vq.O6e();return!0};Sd.prototype.Hoc=
function(){Kd.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";be.AFrameworkApplication.Ib.processAction(Zf.a.kRa,2);return!0};Sd.prototype.PGd=function(){this.vq.ucb()};Sd.prototype.switchToBackupMode=function(){var N=document.getElementById("ProtocolLaunchingDialogTitle");if(N){N.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(N=document.getElementById("Issues"))N.style.display="block";(N=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!N.children.length&&(this.Npa=pe("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(af.a)(this,this.Hoc,"onRetryOICClick"),Object(af.a)(this,this.HCf,"onRetryOICKeyUp")),N.appendChild(this.Npa),gg(this.Npa),this.xfa||this.HVe())}};Sd.prototype.dispose=function(){this.gqa||(this.xfa&&(Tf.a.instance.za(pg.a.click,this.xfa,Object(af.a)(this,this.yxf,"onEditClick")),xe.KeyInputManager.instance.za(pg.a.Sd,this.xfa,Object(af.a)(this,this.Dxf,"onEditKeyUp"))),this.xVa&&(Tf.a.instance.za(pg.a.click,
this.xVa,Object(af.a)(this,this.Inc,"onGiveFeedbackClick")),xe.KeyInputManager.instance.za(pg.a.Sd,this.xVa,Object(af.a)(this,this.Wyf,"onGiveFeedbackKeyUp"))),this.Npa&&(Tf.a.instance.za(pg.a.click,this.Npa,Object(af.a)(this,this.Hoc,"onRetryOICClick")),xe.KeyInputManager.instance.za(pg.a.Sd,this.Npa,Object(af.a)(this,this.HCf,"onRetryOICKeyUp"))),Og.prototype.dispose.call(this),this.gqa=!0)};Object(Td.a)(Sd,"ProtocolLaunchingDialog",Ag.a,[]);var Hh=b(456),si=fh.StandardDialog;Am(Dc,si);Dc.prototype.Inc=
function(N){Kd.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Uxf(N)};Dc.prototype.Hoc=function(){Kd.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");be.AFrameworkApplication.Ib.processAction(Zf.a.kRa,2)};Dc.prototype.PGd=function(N){Dc.O7e?3===N?this.CUf():2===N||0===N?this.continueEditing():1===N&&this.WZg():2===N?this.CUf():(1===N||0===N)&&this.continueEditing()};Dc.prototype.WZg=function(){Kd.ULS.sendTraceTag(577783557,211,50,"Closing the document");be.AFrameworkApplication.Ib.Be(Zf.a.close,
2,Hh.a)};Dc.prototype.CUf=function(){Kd.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(af.a)(this,this.Hoc,"onRetryOICClick"),0)};Dc.prototype.continueEditing=function(){4===be.AFrameworkApplication.sa.Pa.editMode||be.AFrameworkApplication.ga.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===be.AFrameworkApplication.sa.mode?(Kd.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.vq.ucb()):(Kd.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),
this.vq.jjd())};Ck.Object.defineProperties(Dc,{O7e:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.ga.ra("OICDialogThreeActions")&&32===be.AFrameworkApplication.Ib.processAction(Zf.a.close,1)}}});Object(Td.a)(Dc,"StandardProtocolLaunchingDialog",fh.StandardDialog,[]);Object(Td.a)($f,"EditDocumentInClientParams",null,[]);Jf.k8c=function(N,la,Ra,Pb,vc,ad,Fd,ve,Me,fg,gh,Wh,Ci,Hj,aj,mk){Fd=void 0===Fd?!1:Fd;ve=void 0===ve?!1:ve;Me=void 0===Me?"":Me;fg=void 0===fg?!1:fg;gh=
void 0===gh?!1:gh;Wh=void 0===Wh?!1:Wh;Ci=void 0===Ci?"":Ci;Hj=void 0===Hj?"":Hj;aj=void 0===aj?"":aj;mk=void 0===mk?!1:mk;var Mj=new $f;Mj.DocumentUrl=N;Mj.Mode=la;Mj.Options=Ra;Mj.Application=Pb;Mj.SilentExternalHandler=Fd;Mj.EncodeUrl=ve;Mj.CorrelationIdForWinClient=Me;Mj.NavigateUsingWindowOpen=fg;Mj.DescriptiveUnattemptedEnums=gh;Mj.NoBrowserModalDialogs=Wh;Mj.SessionOrigin=Ci;Mj.CorrelationId=Hj;Mj.ClickTime=aj;Mj.NewTelemetryDataIsEnabled=mk;MSOJS.ClientUtils.EditDocumentInClient(Mj,vc,ad)};
Object(Td.a)(Jf,"ClientUtils",null,[]);var Vj=b(187),mg=b(516),Ti=b(177),Bg=b(1033),Zj=b(77);Le.prototype.cxc=function(N,la,Ra,Pb){la=void 0===la?"":la;Pb=void 0===Pb?!1:Pb;this.ZD=(void 0===Ra?"":Ra)||Ti.a.create().toString();this.LWb=la||mg.a.C1e();Pb&&(N=((new Date).getTime()-parseFloat(N)).toString());this.xRb=N};Le.prototype.Aij=function(N,la,Ra){return la.contextId!==ig.a.frame?2:1===Ra?32:this.kRa()};Le.prototype.IHj=function(){return!(2===this.application&&be.AFrameworkApplication.ga.ra("IsEmbeddedScenario"))};
Le.prototype.closeApplication=function(){this.zVd||this.Oyh()};Le.prototype.ucb=function(){this.LHj||this.czh()};Le.prototype.uNf=function(N){this.WUj&&Mf.a.Fh?new rd(this):this.F3b(N)};Le.prototype.F3b=function(N){N=this.Rri(N);var la=N.returnValue;Kd.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===la,N.UBa);return la};Le.prototype.TGa=function(N,la,Ra,Pb,vc,ad){this.EVa=N;this.E6d=la;this.uga=ad;this.application=Ra;this.eC=Pb;be.AFrameworkApplication.downloadCopyOnOpenInClient?this.clf():
be.AFrameworkApplication.limitedEdit&&!be.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?be.AFrameworkApplication.X4f():this.sOg(vc)};Le.prototype.kRa=function(){this.xGi&&this.Kui();return this.F3b(this.hjb)};Le.prototype.lYf=function(){var N=new Bg.a(Je.a.openInClient);N.Values["ui-language"]=be.AFrameworkApplication.lcid.toString();N.Values[k.a.u5c]=be.AFrameworkApplication.userSessionId;return this.uga.value.send(N)?32:8};Le.prototype.Kui=function(){$g.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new je.a,{inStaging:!0}))};Le.prototype.ioj=function(N){var la=new Bg.a(Je.a.eXj);la.Values["ui-language"]=be.AFrameworkApplication.lcid.toString();la.Values[k.a.u5c]=be.AFrameworkApplication.userSessionId;la.Values[lf.a.dXj]=N;this.uga.value.send(la)};Le.prototype.Rri=function(N){this.hjb=N;this.ioj(5===this.eC?Le.QVi:Le.SVi);return 5===this.eC?this.Qri():this.Wri()};Le.prototype.Qri=function(){this.ilf();return{returnValue:32,UBa:"HostEditUrl,"}};
Le.prototype.Wri=function(){var N,la=N="";be.AFrameworkApplication.sne&&(la="|f|"+be.AFrameworkApplication.userSessionId);var Ra=be.AFrameworkApplication.ga.ra("IsAssignmentMode")&&be.AFrameworkApplication.ga.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||be.AFrameworkApplication.isUnifiedHostMode||Mf.a.nla,Pb=be.AFrameworkApplication.ga.ra("UnattemptedEnumIsEnabled"),vc=be.AFrameworkApplication.ga.ra("NoBrowserModalDialogs");if(be.AFrameworkApplication.Ib.rmc){var ad=be.AFrameworkApplication.Ib.m_(3588168074);
ad&&this.cxc(ad.TriggerTime,ad.sessionOrigin,ad.correlationId,!0)}if(be.AFrameworkApplication.FIf){N+="NewOrder,";ad=8;this.uga&&this.uga.value&&this.uga.value.isEnabled()&&be.AFrameworkApplication.h_d&&(N+="Post,",ad=this.lYf());if(32===ad)return{returnValue:ad,UBa:N};Kd.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return be.AFrameworkApplication.Ll.M$a?(Kd.ULS.shipAssertTag(5566816,211,!!be.AFrameworkApplication.Ll.M$a),N+="HostUrl,",{returnValue:be.AFrameworkApplication.sa.x9a(be.AFrameworkApplication.Ll.M$a),
UBa:N}):this.EVa?(Kd.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",be.AFrameworkApplication.userSessionId),N+="DocUrl,",Jf.k8c(this.EVa,this.eC,this.options,this.application,Object(af.a)(this,this.Cxf,"onEditInClientSuccess"),Object(af.a)(this,this.Bxf,"onEditInClientFailure"),this.A5f,be.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),la,Ra,Pb,vc,this.LWb,this.ZD,this.xRb,be.AFrameworkApplication.Ib.rmc),{returnValue:32,UBa:N}):{returnValue:8,UBa:N}}N+="OldOrder,";
if(!this.EVa&&be.AFrameworkApplication.Ll.M$a)return this.uga&&this.uga.value&&this.uga.value.isEnabled()&&be.AFrameworkApplication.h_d?(N+="Post,",la=this.lYf()):(Kd.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),la=8),32!==la?(Kd.ULS.shipAssertTag(22595484,211,!!be.AFrameworkApplication.Ll.M$a),N+="HostUrl,",{returnValue:be.AFrameworkApplication.sa.x9a(be.AFrameworkApplication.Ll.M$a),UBa:N}):{returnValue:la,UBa:N};Kd.ULS.sendTraceTag(22595485,211,
15,"Try to open doc in rich client, SessionId {0}",be.AFrameworkApplication.userSessionId);N+="DocUrl,";Jf.k8c(this.EVa,this.eC,this.options,this.application,Object(af.a)(this,this.Cxf,"onEditInClientSuccess"),Object(af.a)(this,this.Bxf,"onEditInClientFailure"),this.A5f,be.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),la,Ra,Pb,vc,this.LWb,this.ZD,this.xRb,be.AFrameworkApplication.Ib.rmc);return{returnValue:32,UBa:N}};Le.prototype.BSf=function(N){be.AFrameworkApplication.$m.setDw(8981,N)};Le.prototype.Cxf=
function(N){this.BSf(N);Kd.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===N&&MSOJS.ClientUtils.ShouldShowDialog()?(this.B8f||this.ilf(),this.mwi()):this.zVd||this.closeApplication()};Le.prototype.Bxf=function(N,la){la=void 0===la?0:la;Kd.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",N,la);if(5===N)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Ra=!!this.E6d&&!this.hjb,Pb=0;1===N&&(Pb=2);6<=N&&13>=N&&
(Pb=1,1===la&&(this.zVd=!0));this.yAc.eGi?(Kd.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",Pb),Yf.a.instance.S8g(this.hjb?Object(af.a)(this,this.muf,"oicErrorDialogHandlerCloseForced"):Object(af.a)(this,this.nuf,"oicErrorDialogHandlerNoCloseForced"),Ra?Object(af.a)(this,this.$zf,"onLaunchDownload"):null,this.VIe(!1)?Object(af.a)(this,this.P8h,"iHaveOfficeButtonHandler"):null,Pb,la)):(Kd.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",
Pb),Yf.a.instance.Q8g(this.hjb?Object(af.a)(this,this.muf,"oicErrorDialogHandlerCloseForced"):Object(af.a)(this,this.nuf,"oicErrorDialogHandlerNoCloseForced"),Ra?Object(af.a)(this,this.$zf,"onLaunchDownload"):null,Pb))}};Le.prototype.mwi=function(){try{var N=[Object.assign(new Zj.a,{name:"CorrelationId",string:this.ZD}),Object.assign(new Zj.a,{name:"SessionOrigin",string:this.LWb}),Object.assign(new Zj.a,{name:"ClickTime",string:this.xRb}),Object.assign(new Zj.a,{name:"ProtocolHandlerFinishedTimestamp",
double:(new Date).getTime()})];Vj.a("OpenInClientCompleted",!0,0,N)}catch(la){Kd.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+la.toString())}};Le.prototype.ilf=function(){be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.wv&&be.AFrameworkApplication.ga.ra("StandardProtocolDialogIsEnabled")?new Dc(this):new Sd(this)};Le.prototype.muf=function(){this.closeApplication()};Le.prototype.nuf=function(){this.ucb()};Le.prototype.$zf=function(){this.clf()};Le.prototype.P8h=function(){return this.VIe(!0)};
Le.prototype.VIe=function(N){var la=(Mf.a.G_||Mf.a.$H)&&!!be.AFrameworkApplication.T6b;la&&N&&(eg.a.rf(be.AFrameworkApplication.T6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return la};Ck.Object.defineProperties(Le.prototype,{HFf:{configurable:!0,enumerable:!0,get:function(){return this.eC}},options:{configurable:!0,enumerable:!0,get:function(){var N=0;be.AFrameworkApplication.Dgj&&(N|=1);be.AFrameworkApplication.openInClientEditOnly&&(N|=4);this.IHj()&&(N|=64);return N}},Osb:{configurable:!0,
enumerable:!0,get:function(){return be.AFrameworkApplication.ZC}},kyb:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.fyb}},K$e:{configurable:!0,enumerable:!0,get:function(){return""}},Vld:{configurable:!0,enumerable:!0,get:function(){return""}},B8f:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.ga.ra("OneNoteMobileViewerIsEnabled")}},yAc:{configurable:!0,enumerable:!0,get:function(){return this.yde||(this.yde=Bh.a.instance.resolve("Common.IOfficeTrialExperience"))}},
xGi:{configurable:!0,enumerable:!0,get:function(){return!!be.AFrameworkApplication.ga&&be.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}}});Le.SVi="OpenInDesktop";Le.QVi="OpenInBrowser";Object(Td.a)(Le,"AOpenInClientOperation",null,[]);var zi=b(208),sg=b(212),bk=b(119),lj=b(47),pk=b(44),wk=b(196),cg=b(95),Wj=b(35),dj=b(521),Oh=b(1247),Mg=b(650);Am(ee,Le);ee.prototype.e1g=function(){this.uNf(this.SVe)};ee.prototype.f3g=function(){var N=this,
la=this.$;og.TaskExtensions.Ba(this.jK.value,function(Ra){N.TGa(la.workbookContext.ClientUrl,be.AFrameworkApplication.q4,1,la.isEditMode?2:0,!0,new Gf.a(function(){return Ra.result}))},this.la,3)};ee.prototype.jjd=function(){0!==md.a.Dg.editMode&&(this.$.zb.Mz=!1)};ee.prototype.O6e=function(){var N={};N[ja.a.R9b]=!1;N[ja.a.HV]="OpenInExcel";this.$.Zd(802602464,Ha.a.Vb,8,N)};ee.prototype.g3c=function(){var N=this;if(this.ea.sc){var la=this.$;la.isEditMode&&og.TaskExtensions.Ba(this.jK.value,function(Ra){N.TGa(la.workbookContext.ClientUrl,
be.AFrameworkApplication.q4,1,2,!1,new Gf.a(function(){return Ra.result}))},this.la,3)}};ee.prototype.RCe=function(){var N=this;this.ea.sc&&og.TaskExtensions.Ba(this.jK.value,function(la){N.TGa(N.$.workbookContext.ClientUrl,be.AFrameworkApplication.q4,1,N.$.isEditMode?2:0,!1,new Gf.a(function(){return la.result}))},this.la,3)};ee.prototype.cxc=function(N){Le.prototype.cxc.call(this,N)};ee.prototype.openInExcelClient=function(){var N=this;this.ea.sc&&(this.$.isEditMode||og.TaskExtensions.Ba(this.jK.value,
function(la){N.TGa(N.$.workbookContext.ClientUrl,be.AFrameworkApplication.q4,1,0,!1,new Gf.a(function(){return la.result}))},this.la,3))};ee.prototype.openInBrowser=function(){var N=this;this.ea.sc&&og.TaskExtensions.Ba(this.jK.value,function(la){N.TGa(N.$.workbookContext.ClientUrl,be.AFrameworkApplication.q4,1,5,!1,new Gf.a(function(){return la.result}))},this.la,3)};ee.prototype.downloadFile=function(N){var la=this.Qve(N);this.Taa.downloadFile(la,N);this.lvi()};ee.prototype.lvi=function(){be.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.Nga&&this.Nga.execute(function(N){return N.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})};ee.prototype.DFf=function(N,la){la=void 0===la?0:la;if(this.ea.sc){var Ra=this.$;Ja.a(Ra).sMa?this.EFf(N,Ra):0<la?this.EFj(N,Ra,la):this.K3f(Ra)}};ee.prototype.TGa=function(N,la,Ra,Pb,vc,ad){this.$.zb.Mz=!cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.wc.inWebPart;this.SVe=vc;this.G3b=null;this.I7c=
!1;this.xOg(N,la,Pb,vc,ad)};ee.prototype.F3b=function(N){var la=this.$.wc;Kd.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",la.inEmbedView,la.inWebPart,la.isDivSyndicated,this.$.isEditMode?zi.a.edit:zi.a.view);return ee.$ff()?(this.d3b(),Jf.k8c(this.EVa,this.eC,this.options,1,this.CKi,this.BKi,!1,be.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")),32):Le.prototype.F3b.call(this,N)};ee.prototype.Oyh=function(){this.CTf();
var N=this.$;if(!this.ea.wc.inWebPart&&this.ea.sc&&!N.isEditMode){var la=new cg.a(2145659238,Ha.a.Vb,this.$.fd,0,null);this.MAe=lj.a.instance.create(function(){N.Ka.$b(la)},0,pk.a.TVi)}};ee.prototype.dispose=function(){this.ea&&this.ea.Fk(this.qd);di.a.yc([this.Qa,this.MAe,this.Gm]);this.$=this.ea=null};ee.prototype.czh=function(){this.CTf()};ee.prototype.clf=function(){var N=this;lj.a.instance.create(function(){N.$.Ka.$b(new cg.a(-2028960985,Ha.a.Vb,0,30,null))},0,pk.a.UVi,!0,!0)};ee.prototype.sOg=
function(N){var la=this.$,Ra=Ja.a(this.$).rd.activityState;Ra[dj.a.Hle]=!0;la.isEditMode&&this.ea.sc?(this.d3b(),li.a(la).rt(new Ni.a(ih.a.Az,5,function(){la.vI(!1);Ra[yi.a.hr]=ih.a.f3b;Ra[dj.a.AAg]=N;Ra[xi.a.Lbd]=!0;la.isEditMode&&(Ra[xi.a.rU]=1,Ra[xi.a.YY]=!0,Ra[Aj.a.VYb]=!0,Ra[Aj.a.GUc]=!0);Ra[dj.a.Kle]=1455037301}))):this.uNf(N)};ee.prototype.z6f=function(){var N=be.AFrameworkApplication.q4;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.x9a(N,!0)){var la=this.$.ea.wc;Kd.ULS.sendTraceTag(537154773,
0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",N,la.inEmbedView,la.inWebPart,la.isDivSyndicated,this.$.isEditMode?zi.a.edit:zi.a.view)}}else this.Taa.downloadFile(N,-2028960985);this.I7c=!0;this.d3b()};ee.prototype.osi=function(){this.yAc.Stf&&this.yAc.Zjc(1)};ee.prototype.psi=function(){this.yAc.Stf&&wh.HelperMethods.rf(Ug.a.h_(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};ee.prototype.ysi=function(){wh.HelperMethods.rf(Ug.a.h_(31),"_blank",
void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};ee.prototype.zsi=function(){wh.HelperMethods.rf(Ug.a.h_(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};ee.prototype.Qve=function(N){var la=new Sys.StringBuilder,Ra=this.$.workbookContext,Pb=this.$.ya;la.append(this.$.hea);la.append(Pb.FileHandlerRelativeUri);la.append("?id=");la.append(encodeURIComponent(sg.a.gIb(Ra.WorkbookUri,"sc")));this.$.ea.sc&&(la.append("&sessionId="),la.append(encodeURIComponent(this.$.ea.sessionId)));
switch(N){case -974518828:la.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:la.append("&workbookType=FullWorkbook");break;case -1059172980:la.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:la.clear()}bk.a.HZa(la,Pb);return la.toString()};ee.prototype.M1g=function(){Yd.a.instance.SXg();var N=this.$.ya;MSOJS.ClientUtils.InitUrls(N.RoamingAppsX86RootUrl,N.RoamingAppsControlInstallerUrl,N.RoamingAppsFirefoxExtensionUrl)};ee.prototype.CTf=function(){var N=
this.$;this.ea.sc||qe.a.TGd(N,Ja.a(N).rd);this.d3b();this.G3b&&this.G3b(this,this.I7c);N.frame.Bt.km(this.$.frame.iba());N.frame.UX.km(this.$.frame.iba());N.zb.Mz=!1;hg.g(N).focus()};ee.prototype.xOg=function(N,la,Ra,Pb,vc){var ad=this.$;be.AFrameworkApplication.sa&&!ee.$ff()&&(ad.frame.Bt.un(ad.frame.iba()),ad.frame.UX.un(ad.frame.iba()));Le.prototype.TGa.call(this,N,la,1,Ra,Pb,vc)};ee.prototype.d3b=function(){var N=this.$;Ja.a(N).xi.activityName===ih.a.openInExcelClient&&Ja.a(N).rd.OJ()};ee.prototype.xAj=
function(){var N=Hg.a.gd(1,0,678,679,0,1341525452,"OpenInExcelActiveXError");li.a(this.$).Bs([N])};ee.prototype.EFj=function(N,la,Ra){var Pb=this,vc=null,ad=window.setTimeout(function(){Ja.a(la).btc(vc);Pb.K3f(la)},Ra);vc=function(){Ja.a(la).sMa&&(Ja.a(la).btc(vc),window.clearTimeout(ad),Pb.EFf(N,la))};Ja.a(la).KVc(vc)};ee.prototype.K3f=function(N){var la=Hg.a.gd(1,1,0,693,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");li.a(N).Bs([la])};ee.prototype.EFf=function(N,la){var Ra=this;li.a(la).rt(new Ni.a(ih.a.Az,
5,function(){la.vI(!1);var Pb=Ja.a(la).rd,vc=Pb.activityState;vc[yi.a.hr]=ih.a.qKe;vc[W.a.XYb]=la.ea.wc.hasUnsupportedFeaturesForEdit;vc[Mg.a.AUc]=N;Pb.Lt(Hg.a.Oaa(Ra.businessBar.v8c,[1437034227]))}))};ee.$ff=function(){return 1<md.a.getRegisteredEwaInstances().length};Ck.Object.defineProperties(ee.prototype,{K$e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.Gm=this.Gm||new wk.a;return this.Gm.token}},Vld:{configurable:!0,
enumerable:!0,get:function(){return"excel32"}},B8f:{configurable:!0,enumerable:!0,get:function(){return this.ea.wc.inWebPart}}});Object(Td.a)(ee,"OpenInExcelOperation",Le,[947,2]);var vj=oh.a;Am(Xd,vj);Xd.prototype.create=function(){var N=this;if(this.$.da.Aa(55))this.Eb(this.$.da.Aa(55));else{var la=zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Ra=zh.GetServiceTaskFactory.Ua(this.$.da,5,4,this.ub);og.TaskExtensions.Ba(nh.Task.WAA(la,Ra),function(){N.Eb(new ee(N.$,new Gf.a(function(){return zh.GetServiceTaskFactory.create(N.$.da,
137,N.la,N.ub)}),Ra.result))},this.la,3)}};Xd.L1g=function(){Xd.puf||(Xd.puf=!0,(new ie).fi(Bh.a.instance),Bh.a.instance.resolve("Common.IOfficeTrialExperience").Og(),Bh.a.instance.resolve("Common.IMacOfficeOffer").Og())};Xd.puf=!1;Object(Td.a)(Xd,"OpenInClientFactory",oh.a,[]);var Hi=b(113),Pj=b(412),Xj=Hi.a;Am(Ad,Xj);Ad.prototype.execute=function(N){var la=Object(V.a)(6,N.Le);og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(la.da,56,la.la,0),function(Ra){la.downloadCopyOnOpenInClient?(N.activityState[Pj.a.Ile]=
!0,Ra.result.z6f()):Ra.result.f3g()},la.la,3);return 1};Object(Td.a)(Ad,"OpenInExcelClientActivity",Hi.a,[]);var kk=oh.a;Am(ne,kk);ne.prototype.create=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){N.Eb(new Ad(ih.a.openInExcelClient,ih.a.idle))},this.la)};Object(Td.a)(ne,"OpenInExcelClientActivityFactory",oh.a,[]);var Dj=ya.a;Am(vf,Dj);vf.prototype.initialize=function(N){Dj.prototype.initialize.call(this,N)};vf.prototype.execute=
function(N){this.yi=N;N=Object(V.a)(6,this.yi.Le);this.Prb(N);return 1};vf.prototype.aJ=function(N){Dj.prototype.aJ.call(this,N)};vf.prototype.Prb=function(){var N=this;this.subscribe(this.yi,this.kYi,function(la){N.gEd.add_disposing(la)})};vf.prototype.hGb=function(N){this.unsubscribe(function(la){N.remove_disposing(la)});this.yi.activityState[Vh.a.W2]=0};Object(Td.a)(vf,"PasswordProtectedFileActivity",ya.a,[]);var Fj=b(388),Qj=Fj.a;Am(of,Qj);of.prototype.gbb=function(N){this.eqa=N};of.prototype.X3=
function(){var N={};N[Fj.a.description]=Nc.a.instance.fa(1933);N[Fj.a.Nma]=Nc.a.instance.fa(1929);N[Fj.a.UGf]=Nc.a.instance.fa(1951);N[Fj.a.SGf]=Nc.a.instance.fa(1952);N[Fj.a.TGf]=Nc.a.instance.fa(1930);N[Fj.a.imd]=Nc.a.instance.fa(1936);N[Fj.a.Ite]=Nc.a.instance.fa(1631);N[Fj.a.vWj]=Nc.a.instance.Wa(25);N[Fj.a.hgg]=Object(af.a)(this,this.CUa,"verifySubmittedPassword");return N};of.prototype.Fta=function(){var N={};N[ag.a.ay]=this.Cc;N[Fj.a.Rue]=this.X3();return N};of.prototype.jh=function(){this.jc=
1;this.initializeAndShow(this.Im,this.n6i,this.Fta())};Ck.Object.defineProperties(of.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},Fsb:{configurable:!0,enumerable:!0,get:function(){return this.eqa}},Im:{configurable:!0,enumerable:!0,get:function(){return Nc.a.instance.fa(1932)}}});Object(Td.a)(of,"PasswordProtectedFilePasswordInputDialog",Fj.a,[]);var mj=b(293);Am(kf,of);kf.prototype.gbb=function(N,la){of.prototype.gbb.call(this,N,la);Kd.ULS.sendTraceTag(537154755,
0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",N)};kf.prototype.CUa=function(N,la){this.passwordToModify=N;var Ra={};Ra.FileModifyPassword=Hf.a.mf(N);ce.ob(this.$.na.va,Ra,this.RUi(la),this.QUi(la),null,null)};kf.prototype.X3=function(){var N=of.prototype.X3.call(this);N[Fj.a.imd]=Nc.a.instance.fa(1937);N[Fj.a.description]=Nc.a.instance.Wa(24);return N};kf.prototype.jh=function(){Bj.b().P8c("PasswordToModifyDialogShown");Kd.ULS.sendTraceTag(557446529,
0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");of.prototype.jh.call(this)};kf.prototype.RUi=function(N){var la=this;return function(Ra){Hg.a.qh(Ra.Errors,[-2019873242])&&la.c7b(la.Hrb());if(!Ra||mj.a(Ra))if(0<la.wMd)la.sMf(N);else{Kd.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",Hg.a.Xc(Ra.Errors));la.$.ea.Hp(Ra.Errors);la.hide();return}la.Q$d=Ra.Result;la.Nhc&&
(Bj.b().HUd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),Kd.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));N(la.Nhc?0:1)}};kf.prototype.QUi=function(N){var la=this;return function(){0<la.wMd?la.sMf(N):(Kd.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),
N(3))}};kf.prototype.sMf=function(N){--this.wMd;this.CUa(this.passwordToModify,N)};kf.prototype.Hrb=function(){return Hg.a.gd(1,0,1630,1631,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Ck.Object.defineProperties(kf.prototype,{Nhc:{configurable:!0,enumerable:!0,get:function(){return this.Q$d}},Im:{configurable:!0,enumerable:!0,get:function(){return Nc.a.instance.fa(1934)}}});Object(Td.a)(kf,"PasswordProtectedFileModifyPasswordInputDialog",of,[]);Am(Ve,vf);Ve.prototype.Prb=function(N){this.gEd=
new kf(N);vf.prototype.Prb.call(this,N)};Ve.prototype.hGb=function(N,la){var Ra=N.Fsb,Pb=N.Nhc,vc=N.passwordToModify;vf.prototype.hGb.call(this,N,la);this.yi.sya([2001366804]);switch(Ra){case 1:Pb?(la=Object(V.a)(6,this.yi.Le),this.yi.activityState[Vh.a.Yle]=Hf.a.mf(vc),this.yi.activityState[Vh.a.SYa]=!0,N.passwordToModify="",this.Bh(la.isEditMode?ih.a.Uj:this.MM)):Kd.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Cp();break;case 0:this.yi.activityState[Vh.a.Rs]=!1;this.Bh(this.aK);this.Cp();break;default:Kd.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Ra)}};Object(Td.a)(Ve,"PasswordProtectedFileModifyActivity",vf,[]);var mi=oh.a;Am(Tc,mi);Tc.prototype.create=function(){this.Eb(new Ve(this.activityName,this.MM,this.aK))};Tc.ka=function(N){N.da.Ga(434,new Tc(ih.a.gGb,ih.a.hfb,ih.a.xHa,N))};Object(Td.a)(Tc,"PasswordProtectedFileModifyActivityFactory",
oh.a,[]);Am(Pd,of);Pd.prototype.CUa=function(N,la){this.password=N;la(0)};Pd.prototype.X3=function(){var N=of.prototype.X3.call(this);this.hjf&&(N[Fj.a.Dmh]=1);return N};Pd.prototype.jh=function(){Kd.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.hjf);of.prototype.jh.call(this);li.a(this.$).Xpe()};Object(Td.a)(Pd,"PasswordProtectedFileOpenPasswordInputDialog",of,[]);Am(vb,vf);vb.prototype.Prb=function(N){var la=
Hg.a.qh(this.yi.errors,[1217361942]);this.gEd=new Pd(N,la);N.Zfc||N.OIe();vf.prototype.Prb.call(this,N)};vb.prototype.hGb=function(N,la){var Ra=N.password;N.password="";var Pb=N.Fsb;vf.prototype.hGb.call(this,N,la);this.yi.activityState[Vh.a.KUc]=Hf.a.mf(Ra);this.yi.activityState[Vh.a.SYa]=!0;this.yi.sya([110414285,1217361942]);Kd.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Pb);switch(Pb){case 1:this.Bh(this.MM);
this.Cp();break;case 0:this.Bh(this.aK),this.Cp()}};Object(Td.a)(vb,"PasswordProtectedFileOpenActivity",vf,[]);var qk=oh.a;Am(qc,qk);qc.prototype.create=function(){this.Eb(new vb(this.activityName,this.MM,this.aK))};qc.ka=function(N){N.da.Ga(386,new qc(ih.a.Xpc,ih.a.Uj,ih.a.Ik,N))};Object(Td.a)(qc,"PasswordProtectedFileOpenActivityFactory",oh.a,[]);var xk=b(398),Wf=xk.a;Am(fd,Wf);fd.prototype.WO=function(N,la){this.eqa=N;Wf.prototype.WO.call(this,N,la)};fd.prototype.Fr=function(){Wf.prototype.Fr.call(this);
this.jc=9;var N=this.aTh();this.Bc(1,Nc.a.instance.fa(1629));this.Bc(2,Nc.a.instance.fa(973));this.Ak(Nc.a.instance.fa(699),Pf.a.fg(N),this.icon,this.XO)};fd.prototype.aTh=function(){return String.format(Nc.a.instance.fa(700))};Ck.Object.defineProperties(fd.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},Fsb:{configurable:!0,enumerable:!0,get:function(){return this.eqa}}});Object(Td.a)(fd,"LegacySharedWorkbookDialog",xk.a,[]);var If=ya.a;Am(sd,If);sd.prototype.initialize=
function(N){If.prototype.initialize.call(this,N)};sd.prototype.execute=function(N){this.yi=N;this.x6g();return 1};sd.prototype.aJ=function(N){If.prototype.aJ.call(this,N)};sd.prototype.x6g=function(){var N=Object(V.a)(6,this.yi.Le),la=Hg.a.A_a([-573864504]);la[0].HelpDescription=Nc.a.instance.fa(702);la[0].HelpTopicId=Rc.a.Xsi;var Ra=new fd(N,la[0]);this.subscribe(this.yi,this.Wsi,function(Pb){Ra.add_disposing(Pb)})};Object(Td.a)(sd,"LegacySharedWorkbookActivity",ya.a,[]);var Ui=oh.a;Am(Sc,Ui);Sc.prototype.create=
function(){this.Eb(new sd(this.activityName,this.MM,this.aK))};Sc.ka=function(N){N.da.Ga(460,new Sc(ih.a.WBb,ih.a.hfb,ih.a.xHa,N))};Object(Td.a)(Sc,"LegacySharedWorkbookActivityFactory",oh.a,[]);Zb.prototype.$c=function(){return!1};Zb.prototype.Kc=function(N,la){if(!cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(la.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Jz;default:return!1}};Zb.prototype.executeCommand=function(N,
la){N=og.TaskExtensions.Dl();la=la.command;switch(la){case 642419866:this.presentModeManager.tyc(!this.presentModeManager.Jz);this.presentModeManager.zh("TogglePresentMode");break;case 588342182:this.presentModeManager.J7a=!this.presentModeManager.J7a;this.presentModeManager.J4f(this.presentModeManager.J7a,"TogglePresentModeOverlay");this.presentModeManager.zh("TogglePresentModeOverlay");break;default:N=vh.a(la)}return N};Zb.prototype.jd=function(){return!1};Object(Td.a)(Zb,"PresentModeCommandHandler",
null,[424]);var Qi=Ff.a;Am(oc,Qi);oc.prototype.Nd=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,423,424,this.ub),function(la){N.Dd([new Zb(N.$,la.result)])},this.la,3)};oc.ka=function(N){Ff.a.he(420,new oc(N))};Object(Td.a)(oc,"PresentModeCommandHandlerFactory",Ff.a,[]);var ai=b(126),O=b(112);dd.psh="ewa-presentMode-overlay";dd.qsh="ewa-presentMode-panel-container";dd.rsh="ewa-presentMode-rowHdrParent-container";Object(Td.a)(dd,"CssClassNames",null,[]);var Ea=b(19),
Nb=b(153),sc=b(304),Zc=b(131),Ic=b(121),Gd=b(465),ze=b(12),Vf=b(99),Cf=b(359),qg=b(132),Sg=b(442),Sh=b(272),ii=b(254),ui=b(188);fc.prototype.dispose=function(){this.$=this.FFd=this.GFd=this.kda=this.aQa=null};fc.prototype.ibi=function(){var N=this;window.requestAnimationFrame(function(){N.kda=document.createElement("div");N.$.xw.insertBefore(N.kda,N.$.xw.lastChild);N.kda.id=N.$.Lb+ja.a.G$b;N.kda.classList.add(dd.qsh);N.GFd=document.getElementById(N.$.Lb+ja.a.d6c);N.FFd=[N.$.FE];N.isInitialized=!0});
this.aQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.aQa.initializePresentModeFloatie()};fc.prototype.x_h=function(){var N={};N.PollingCountPerCaller=O.a.toJSON(this.tqc);N.PollingDurationPerCaller=O.a.toJSON(this.uqc);return N};fc.prototype.bTd=function(N){this.isInitialized?N?(this.aQa.showPresentModeFloatie(this.kda,this.GFd,this.FFd),this.zh("ShowOrHideFloatiePanel"),this.w9i()):(this.aQa.hidePresentModeFloatie(),this.ZPj()):Kd.ULS.sendTraceTag(537154326,
0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};fc.prototype.zh=function(N){this.WHf=wh.HelperMethods.Zb();this.YPa=N;this.nte=ui.AsyncMethodContext.av(this.Rl,100,pk.a.f1i+N,this.nte)};fc.prototype.Wf=function(N,la){if(la)return!1;N=ze.DOMElementExtensions.Lm(this.kda.querySelectorAll(ze.DOMElementExtensions.sr));if(!N)return Kd.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),
!1;N.focus();return!0};fc.prototype.sh=function(N){return ze.DOMElementExtensions.Gf(this.uc,N)};fc.prototype.Ej=function(){};fc.prototype.Rj=function(){};fc.prototype.w9i=function(){var N=this;Sh.a(this.$).ai(this);this.$.da.$a(15,function(la){N.ewaAccessibilityManager=la;N.ewaAccessibilityManager.mode=5});xe.KeyInputManager.instance.pa(pg.a.Xb,this.uc,this.onKeyDown)};fc.prototype.ZPj=function(){Sh.a(this.$).Xz(this);hg.g(this.$).g1();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0);xe.KeyInputManager.instance.za(pg.a.Xb,this.uc,this.onKeyDown)};fc.prototype.Qkj=function(){var N=wh.HelperMethods.Zb()-this.WHf,la=this.uqc[this.YPa]?this.uqc[this.YPa]:0;this.uqc[this.YPa]=la>N?la:N;this.tqc[this.YPa]=this.tqc[this.YPa]?this.tqc[this.YPa]+1:1};Ck.Object.defineProperties(fc.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.kda}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.aQa.updatePresentModeFloatieShyState(2);return!!this.kda}},ve:{configurable:!0,
enumerable:!0,get:function(){return ii.a.eJf}}});Object(Td.a)(fc,"PresentModeFloatieManager",null,[949,438,2]);var eh=b(7),Kj=b(60);Object(Td.a)(ge,"OverlayCavityInfo",null,[]);Object(Td.a)(Xe,"OverlayContainerInfo",null,[]);Object(Td.a)(de,"PresentModeOverlayProps",null,[]);Qc.prototype.Rbi=function(){var N=this;this.HFd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){N.L_a=Array(5);for(var la,Ra,Pb=1;4>=Pb;Pb++)la=document.createElement("div"),
ze.DOMElementExtensions.setVisible(la,!1),la.id=String.format("{0}-{1}","PresentModeOverlay",Pb),ze.DOMElementExtensions.toggleCssClass(la,dd.psh,!0),Ra=N.gridView.Tf(Pb).domElement,Ra.insertBefore(la,Ra.firstChild),N.L_a[Pb]=la})};Qc.prototype.I4f=function(N){N&&this.kTj();for(var la=1;4>=la;la++)this.Agf(la)&&ze.DOMElementExtensions.setVisible(this.L_a[la],N);ze.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-overlay",N)};Qc.prototype.kTj=function(){for(var N=this.oUg(),la,Ra=1;4>=
Ra;Ra++)la=Ra,N[la]&&this.HFd.showOverlayWithCavity(this.L_a[la],N[la])};Qc.prototype.dispose=function(){this.HFd=this.L_a=this.gridView=this.$=null};Qc.prototype.oUg=function(){for(var N,la,Ra=hg.g(this.$).rtl,Pb,vc=Array(5),ad=1;4>=ad;ad++)la=ad,this.Agf(ad)&&(N=this.gridView.Tf(ad),Pb=this.gridView.ha.Oa.J5?this.wQh(ad,N,Ra):this.oRh(ad,N,Ra),N=this.c9g(N),vc[la]=this.w9g(this.L_a[la].id,N,Pb));return vc};Qc.prototype.Agf=function(N){return this.gridView.rb.sR(N)};Qc.prototype.c9g=function(N){return Object(eh.a)(new Xe,
{width:N.Bn.width,height:N.Bn.height})};Qc.prototype.w9g=function(N,la,Ra){return Object(eh.a)(new de,{containerId:N,overlayContainerInfo:la,overlayCavityInfos:Ra?[Ra]:null})};Qc.prototype.wQh=function(N,la,Ra){var Pb=hg.g(this.$).ha.Oa.oc;if(!Pb)return Kd.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var vc=Pb.extension.zQh(N);N=vc.vCa;Pb=vc.rotation;var ad=vc.translateX;var Fd=vc.translateY;return vc.returnValue?
(vc=N.x-la.Bn.x,Object(eh.a)(new ge,{left:(Ra?la.Bn.width-(vc+N.width):vc)-3+1,top:N.y-la.Bn.y-3+1,width:N.width+5,height:N.height+5,angle:Pb,translateX:ad,translateY:Fd})):null};Qc.prototype.oRh=function(N,la,Ra){N=this.gridView.Cb.vvb(this.gridView.ha.ta.activeRange,N)||Kj.a.D4;if(!N.Te(la.Bn))return null;var Pb=N.x-la.Bn.x;return Object(eh.a)(new ge,{left:Ra?la.Bn.width-(Pb+N.width)-2:Pb-3,top:N.y-la.Bn.y-3,width:N.width+5,height:N.height+5})};Object(Td.a)(Qc,"PresentModeOverlayRenderer",null,
[948,2]);var ck=Fj.a;Am(kd,ck);kd.prototype.hide=function(){ck.prototype.hide.call(this);ai.a.Mv(ja.a.O4f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Ck.Object.defineProperties(kd.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(Td.a)(kd,"PresentModeWelcomeDialog",Fj.a,[]);gd.requestFullscreen=function(N){N.webkitRequestFullscreen?N.webkitRequestFullscreen():N.msRequestFullscreen?N.msRequestFullscreen():N.mozRequestFullScreen?
N.mozRequestFullScreen():N.requestFullscreen?N.requestFullscreen():Kd.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};gd.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():Kd.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Ck.Object.defineProperties(gd,
{hGh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},iGh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?
"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},pji:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(Td.a)(gd,"FullscreenUtils",null,[]);rc.prototype.tyc=function(N){var la=this;this.Jz!==N&&(this.T$d=N,this.J7a=this.Jz,this.hcf(),this.KLb=this.x3f(),window.requestAnimationFrame(function(){ze.DOMElementExtensions.toggleCssClass(la.$.kr,
"ewr-presentMode-transition",!0);$addHandler(la.O2a,"transitionend",la.Poa);la.zBj(!N);la.VWi();ze.DOMElementExtensions.toggleCssClass(la.$.kr,"ewr-presentMode-on",N);la.yBj(N);Nb.b(la.$).G4f(la.Jz);Nb.c(la.$).G4f(la.Jz);la.$.tAa();la.cQa.I4f(la.KLb);if(la.Jz){la.$Za();ai.a.get(ja.a.O4f)?la.lda.bTd(la.Jz):la.Qqc=new kd(la.$,la.lda);var Ra=Sg.b(la.$);Ra&&(la.FMd=Ra.D8c(!1));la.dJf=wh.HelperMethods.Zb()}else la.lda.bTd(N),la.FMd&&(Ra=Sg.b(la.$))&&(Ra.D8c(!0),la.FMd=!1),la.H6b(),la.Bwi()}))};rc.prototype.J4f=
function(N,la){this.gTd=N;this.Vea(la)};rc.prototype.zh=function(N){this.lda.zh(N)};rc.prototype.dispose=function(){this.H6b();this.cQa&&(this.cQa.dispose(),this.cQa=null);this.gridView=this.$=null};rc.prototype.zBj=function(N){var la=this.$.da.Aa(25);void 0===la||null===la?Kd.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):N?la.nyc():la.sec()};rc.prototype.VWi=function(){var N=this;ze.DOMElementExtensions.toggleCssClass(document.getElementById(be.AFrameworkApplication.X2a),
Ea.a.gq,this.Jz);ze.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-on",this.Jz);this.CBj(this.Jz);this.gridView.Hpd=!this.Jz;this.ATj();this.$.da.$a(32,function(la){la.WTj(N.Jz)});Ic.b(this.$,function(la){la.Jdg(N.Jz)})};rc.prototype.CBj=function(N){if(this.LGb)if(N){if(N=Object(V.a)(Vf.a,this.$.qa))ze.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-on-headers-off",!N.headersVisible),ze.DOMElementExtensions.toggleCssClass(this.$.kr,"ewr-presentMode-on-rtl",hg.g(this.$).rtl);
this.eCc(0)}else this.$.kr.classList.remove("ewr-presentMode-on-headers-off"),this.$.kr.classList.remove("ewr-presentMode-on-rtl"),this.eCc(1)};rc.prototype.eCc=function(N){var la=Object(V.a)(Vf.a,this.$.qa);if(la){var Ra=parseInt(this.$.xw.style.right,10);if(1===N||2===N){if(isNaN(Ra)||Ra<this.u1a)return;Ra-=this.u1a}if(0===N||2===N)N=la.headersVisible,la=hg.g(this.$).rtl,N=N?la?0:32:12,Ra=isNaN(Ra)?N:Ra+N,this.u1a=N;this.$.xw.style.right=wh.HelperMethods.nc(Ra);this.HCe=Ra}};rc.prototype.ATj=function(){var N=
document.getElementById(this.$.Lb+ja.a.i6b).parentNode;ze.DOMElementExtensions.toggleCssClass(N,dd.rsh,this.Jz)};rc.prototype.initialize=function(N){this.cQa=new Qc(N);this.cQa.Rbi();this.lda=new fc(N);this.lda.ibi();this.O2a=document.getElementById("MainApp");this.xWe=this.CLi;$addHandler(this.O2a,gd.hGh,this.xWe);$addHandler(this.O2a,gd.iGh,this.DLi);this.LGb||(this.LGb=document.createElement("div"),this.LGb.className="ewa-presentMode-right-frame",this.$.FE.appendChild(this.LGb));this.Poa=this.Vaj};
rc.prototype.$Za=function(){this.gridView.ha.k3(this.Fp);this.gridView.ha.aZ(this.wh);this.gridView.Ac.sl(this.gj);this.gridView.Ac.To(this.Ng);this.gridView.rE(this.Dp);this.gridView.view.Ts(this.Ww);this.gridView.FVc(this.eEb);this.gridView.Ea.UG(this.Tm);this.gridView.Ea.Ss(this.zf);this.$.xa.zg(this.ii);this.$.xa.isa(this.MF);this.$.xa.pha(this.oFb);this.$.RA(this.fj);this.$.tl(this.zd);var N=Object(V.a)(Cf.a,this.$.xa);N=Cl(N.items);for(var la=N.next();!la.done;la=N.next())la.value.hob(this.gza)};
rc.prototype.H6b=function(){this.gridView&&(this.gridView.ha.B7(this.Fp),this.gridView.ha.qX(this.wh),this.gridView.Ac.kl(this.gj),this.gridView.Ac.Zn(this.Ng),this.gridView.aG(this.Dp),this.gridView.view.Yq(this.Ww),this.gridView.UJd(this.eEb),this.gridView.Ea.wI(this.Tm),this.gridView.Ea.Wq(this.zf));if(this.$){this.$.xa.Vg(this.ii);this.$.xa.jAa(this.MF);this.$.xa.jna(this.oFb);this.$.AD(this.fj);this.$.Ul(this.zd);var N=Object(V.a)(Cf.a,this.$.xa);N=Cl(N.items);for(var la=N.next();!la.done;la=
N.next())la.value.CKd(this.gza)}};rc.prototype.x3f=function(){if(!this.Jz||!this.J7a)return!1;if(1===this.gridView.ha.Ue){var N=this.$.qa.activeRange.isSingle,la=1===this.$.qa.selectedRanges.length&&!N,Ra=this.gridView.isEditing,Pb=this.zrd;la||Kd.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",N);return this.gTd&&la&&!Ra&&!Pb}return this.gTd};rc.prototype.yBj=function(N){N?gd.requestFullscreen(this.O2a):
gd.exitFullscreen()};rc.prototype.Vea=function(N,la,Ra){var Pb=this;Ra=void 0===Ra?!1:Ra;void 0!==la&&la||(this.KLb=this.x3f());Kd.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",N,this.KLb,Ra);if(this.xOb&&Ra)Kd.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.wOb),window.cancelAnimationFrame(this.wOb),this.wOb=0;else if(this.xOb){Kd.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",N);return}Ra?this.wZd(wh.HelperMethods.Zb(),N):(this.wOb=window.requestAnimationFrame(function(vc){Pb.wZd(vc,N)}),this.xOb=!0)};rc.prototype.wZd=function(N,la){var Ra=this,Pb=wh.HelperMethods.Zb();if(Pb-N>this.Alj)this.wOb=window.requestAnimationFrame(function(ad){Ra.wZd(ad,la)}),this.xOb=!1,Kd.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Pb-
N);else{this.cQa.I4f(this.KLb);this.xOb=!1;var vc=wh.HelperMethods.Zb();N=wh.HelperMethods.Zb()-N;Pb=vc-Pb;this.Dkj(N,la);Kd.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Pb,N)}};rc.prototype.hcf=function(){var N=this;kc.a(this.$.userOperationManager,function(la,Ra,Pb){var vc=N.$.na.va,ad=N.Jz,Fd=vc.Na(41,null);Fd.shouldEnablePresentMode=ad;return ce.i(vc,"SetPresentMode",Fd,la,Ra,Pb,null,0)},function(la){return new Jb.a(252,
0,la)},null)};rc.prototype.nWf=function(){var N=Gd.a(this.gridView.Ue);1!==this.gridView.Ue||this.$.qa.activeRange.isSingle||(N="Range");this.Jvc[N]=this.Jvc[N]?this.Jvc[N]+1:1};rc.prototype.Dkj=function(N,la){var Ra=this.Gpc[la]?this.Gpc[la]:0;this.Gpc[la]=Ra>N?Ra:N;this.Fpc[la]=this.Fpc[la]?this.Fpc[la]+1:1};rc.prototype.Bwi=function(){var N={},la=wh.HelperMethods.Zb()-this.dJf;N.PresentModeDuration=la;N.SelectionCountPerObject=O.a.toJSON(this.Jvc);N.OverlayCountPerCaller=O.a.toJSON(this.Fpc);N.OverlayDurationPerCaller=
O.a.toJSON(this.Gpc);la=this.lda.x_h();for(var Ra in la)N[Ra]=la[Ra];qg.b(this.$).Vd(Zc.a.e1i,N,void 0,!0)};Ck.Object.defineProperties(rc.prototype,{Jz:{configurable:!0,enumerable:!0,get:function(){return this.T$d}}});Object(Td.a)(rc,"PresentModeManager",null,[923,2]);var dk=b(256),Ij=oh.a;Am(Wd,Ij);Wd.prototype.create=function(){var N=this,la=zh.GetServiceTaskFactory.Ua(this.$.da,283,284,1);og.TaskExtensions.Ba(la,function(){og.TaskExtensions.Ba(dk.c(la.result.Jn.loadScript("presentMode")),function(){var Ra=
N.$.da.Aa(423);Ra||(Ra=new rc(N.$),N.$.da.Ga(423,Ra));N.Eb(Ra)},N.$.la,3)},this.$.la,3)};Wd.ka=function(N){N.da.Ga(424,new Wd(N))};Object(Td.a)(Wd,"PresentModeManagerFactory",oh.a,[]);var Gj=b(179),bi=b(160),Hk=b(727),yk=b(88),ej=b(31);he.Ush="ewa-resizehdr-row-hidden";he.Tsh="ewa-resizehdr-col-hidden";Object(Td.a)(he,"CssClassNames",null,[]);var Gi=b(62),Nj=b(25),Ek=b(150),sh=b(54),Jj=b(72),Lk=b(259),Wi=b(389);Object(Td.a)(Oc,"HeaderEventCachedInfo",null,[]);Gb.prototype.hDe=function(N){N=wh.HelperMethods.JEd(N);
return Math.max(0,Math.min(Gb.xqf,N))};Gb.prototype.ZCe=function(N){return this.yZi(N)};Gb.prototype.H_g=function(N){return Math.round(this.Z7c*N+2*this.TZe()+1)};Gb.prototype.yZi=function(N){return Math.max(0,Math.min(Gb.gqf,(Math.max(0,Math.min(Oe.a.qlc,N))-2*this.TZe()-1)/this.Z7c))};Gb.prototype.TZe=function(){return Math.floor(Math.max((this.Z7c+3)/4,2))};Gb.prototype.bcc=function(N,la){return la?N?Gb.xqf:Oe.a.Ywd:N?Gb.gqf:Oe.a.qlc};Gb.xqf=409;Gb.gqf=255;Object(Td.a)(Gb,"ResizeHeadersConverter",
null,[]);var Oj=b(33),hk=yk.a;Am(qd,hk);qd.prototype.Sya=function(N,la){this.U0i(la,N.clientX,N.clientY);N=this.zyc();this.vdd(this.jTa,N,!0);this.BY&&this.Xaf();this.vAa||(N=this.domElement.ownerDocument.body,N.addEventListener(pg.a.Msa,this.jzf),N.addEventListener(pg.a.$Ga,this.lzf),this.vAa=!0)};qd.prototype.dispose=function(){this.g1c();this.grid.ha&&(this.grid.ha.A7(this.wh),this.grid.ha.B7(this.Fp));this.grid.gx(this.wh);li.a(this.grid.$)&&li.a(this.grid.$).tg.kna(this.OF);Tf.a.instance.za(pg.a.jk,
this.domElement,this.Oca);Gj.a.instance.za(pg.a.$d,this.domElement.ownerDocument.body,this.tEb);bi.a.instance.za(pg.a.Ce,this.domElement.ownerDocument.body,this.tEb);Mf.a.xp||(Gj.a.instance.za(pg.a.pointerDown,this.domElement,this.$N),Gj.a.instance.za(pg.a.yh,this.domElement,this.lS));this.vAa&&(Gj.a.instance.za(pg.a.yh,this.domElement.ownerDocument.body,this.a$a),bi.a.instance.za(pg.a.wg,this.domElement.ownerDocument.body,this.a$a),this.vAa=!1);this.wG&&(Gj.a.instance.za(pg.a.pointerDown,this.wG,
this.$N),Tf.a.instance.za(pg.a.jk,this.wG,this.Oca),this.g1c(),this.wG=null);this.dUf&&(ze.DOMElementExtensions.Af(qd.scb),qd.scb=null);this.tf=null;hk.prototype.dispose.call(this)};qd.prototype.U8i=function(){Tf.a.instance.pa(pg.a.jk,this.domElement,this.Oca);Gj.a.instance.pa(pg.a.$d,this.domElement.ownerDocument.body,this.tEb);bi.a.instance.pa(pg.a.Ce,this.domElement.ownerDocument.body,this.tEb);Mf.a.xp||(Gj.a.instance.pa(pg.a.pointerDown,this.domElement,this.$N),Gj.a.instance.pa(pg.a.yh,this.domElement,
this.lS))};qd.prototype.mmh=function(){if(!qd.scb){document.getElementById(qd.cUf);this.dUf=!0;var N=qd.scb=document.createElement("div");this.grid.$.frame.iba().appendChild(N);N.id=qd.cUf;N.className=ej.a.Vsh;ze.DOMElementExtensions.setVisible(N,!1)}};qd.prototype.mMe=function(){this.vAa&&(this.grid.Nq?(this.domElement.removeEventListener(pg.a.Msa,this.jzf),this.domElement.removeEventListener(pg.a.$Ga,this.lzf)):(Gj.a.instance.za(pg.a.yh,this.domElement.ownerDocument.body,this.a$a),bi.a.instance.za(pg.a.wg,
this.domElement.ownerDocument.body,this.a$a)),this.vAa=!1);this.BY=!1;this.Dij();this.LJd();Wi.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};qd.prototype.Dij=function(){this.grid.Cb.Xh([this.isRow?13:14]);this.grid.Cb.eeb()};qd.prototype.kzf=function(N,la){if(!this.BY)return!1;this.grid.Nq||cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")||Jj.g(la);la=this.isRow;if(!this.grid.Nq&&!this.s1){this.s1=document.createElement("div");this.s1.style.cssText=
"position: relative; width: inherit; height: inherit;"+(la?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Ra=this.im.iK();Ra.nextSibling;)this.s1.appendChild(Ra.nextSibling);Ra.parentNode.appendChild(this.s1)}Ra=la?N.y-this.o8a.y:(this.rtl?-1:1)*(N.x-this.o8a.x);var Pb=la?N.y-this.jTa.y:(this.rtl?-1:1)*(N.x-this.jTa.x),vc=this.im.Uja();if(vc===Oe.a.q6a)return!1;Ra&&(0<this.wl||0<vc+Pb)&&vc+Pb<=this.iqf&&(this.wl=this.zyc(Pb),this.vdd(N,this.wl,!1),this.grid.Nq?this.wl>=qd.H8e?(this.ILd=
!0,this.im.setCellExtent(this.wl)):this.ILd&&(this.ILd=!1,this.im.setCellExtent(qd.H8e)):(ze.DOMElementExtensions.kUa(this.im.iK(),!la,Math.max(this.LJb+Pb,0)),this.s1.style[la?"top":this.rtl?"right":"left"]=Math.max(Pb,-this.LJb)+"px"),ze.DOMElementExtensions.kUa(this.im.tf.domElement,!la,(la?this.im.tf.gQ:this.im.tf.hQ)+Math.max(Pb,-this.LJb)),this.o8a=new Sys.UI.Point(N.x,N.y),ze.DOMElementExtensions.setVisible(this.wG,!1));return!0};qd.prototype.vdd=function(N,la,Ra){this.jN&&Ra&&(Kd.ULS.sendTraceTag(537154051,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.LJd());this.jN||Ra||Kd.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.uvd&&this.uvd(function(){var Pb={};return Pb.Location="canvas",Pb});this.jN?this.rXe(la):(this.jN=document.createElement("div"),this.jN.id=this.g7h,this.rXe(la),this.jN.className=ej.a.krh,la=document.getElementById(this.grid.$.Lb+
ja.a.Trf),la.insertBefore(this.jN,la.firstChild),N=Oj.a(this.grid.$).aka(N),this.jN.style.left=(this.rtl?Math.max(N.x-this.jN.offsetWidth,0):N.x-Math.max(N.x+this.jN.offsetWidth-la.offsetWidth,0)).toString()+"px",la=document.getElementById(ja.a.HGa),this.jN.style.top=(N.y-(be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.Ug?0:la.offsetHeight)-this.jN.offsetHeight).toString()+"px")};qd.prototype.LJd=function(){ze.DOMElementExtensions.Af(this.jN);this.jN=null};qd.prototype.rXe=function(N){var la=
new Gb(this.grid.$.workbookContext.DxDigitNormal);la=this.isRow?la.hDe(N).toFixed(2):la.ZCe(N).toFixed(2);this.jN.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.c7h:this.l7h,la,N.toString(),this.f7h)};qd.prototype.QIf=function(N,la){var Ra;if(-1!==this.grid.ha.selectionType||2===N.yb&&N.Ca.button!==Sys.UI.MouseButton.leftButton||!this.Fsd(Ra=this.Gfd(N))||!this.ohf)return!1;Jj.g(N.Ca);this.jTa=this.o8a=new Sys.UI.Point(N.clientPoint.x,N.clientPoint.y);this.KTg(Ra,la);if(!this.im)return!1;
this.BY=!0;this.Lmi(this.im,Ra)&&this.dai();return this.RIf(la)};qd.prototype.U0i=function(N,la,Ra){this.BY=!0;this.im=N;this.jTa=this.o8a=new Sys.UI.Point(la,Ra);!this.xX&&this.im&&(this.xX=this.im.getRange());this.RIf(!1)};qd.prototype.RIf=function(N){var la={};qg.b(this.grid.$).Vd(Zc.a.xhj,(la.IsResizingHiddenHeader=this.SWa,la.IsAutoFitting=N,la.NumberOfSelectedRanges=this.grid.ha.ta.YK,la.Location="canvas",la));this.LJb=this.grid.Nq?this.nPh():this.Ted();this.offset=this.im.qba();this.wl=this.im.Uja();
if(this.wl===Oe.a.q6a)return!1;Wi.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};qd.prototype.Lmi=function(N,la){var Ra=this.im.iK();if(!Ra)return Kd.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Ra=Ra.nextSibling;if(!Ra)return!1;N=N.getRange();Ra=this.tf.xva(Ra).getRange();if(!N||!Ra)return Kd.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var Pb=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");
N=Pb&&this.isRow?N.bottom:N.right;Ra=Pb&&this.isRow?Ra.bottom:Ra.right;return N+1!==Ra&&N!==Ra&&this.Fsd(la,!0)};qd.prototype.dai=function(){var N=this.im.iK(),la=this.tf.xva(N.nextSibling);qd.Mmi(la,this.isRow)?(this.im=la,this.xX=this.im.getRange()):(this.TBg(N),this.im=la,N=this.im.getRange(),this.xX=this.isRow?new Nj.Range(N.top-1,N.left,N.top-1,N.right,!1,!0):new Nj.Range(N.top,N.left-1,N.bottom,N.left-1,!1,!0),this.SWa=!0)};qd.prototype.TBg=function(N){var la=this.tf.xva(N.nextSibling),Ra=qd.B7g(la,
this.isRow,this.rtl);Ra&&N.parentNode.insertBefore(Ra,la.iK())};qd.prototype.W2e=function(N){var la=this.xX,Ra=N.ha.ta.selectedRanges;if(N.ha.ta.Tsb(la))if(this.isRow){if(d.a.all(Ra,function(Pb){return Pb.isRow}))return Ra}else if(d.a.all(Ra,function(Pb){return Pb.ff}))return Ra;return[la]};qd.prototype.nPh=function(){return this.im.Uja()-qd.tdc};qd.prototype.Ted=function(){var N=this.im.iK().style;return Math.max(0,Math.min(this.iqf,0|parseInt(this.isRow?N.height:N.width,10)))};qd.prototype.zyc=
function(N){N=void 0===N?0:N;var la=this.grid,Ra=this.tf.zj.paneType;Ra=this.isRow?3===Ra?[3,2]:[1,4]:4===Ra?[2,4]:[1,3];var Pb=la.view.visibleArea.bottomRight,vc=this.im.Uja();vc===Oe.a.q6a&&(vc=0);N=this.SWa?Math.max(this.Ted(),0):Math.max(vc+N,0);Pb=this.isRow?new Kj.a(0,this.offset,Pb.x,N):new Kj.a(this.offset,0,N,Pb.y);vc=[this.isRow?13:14];la.Cb.vj(Nj.Range.hd(1,1),vc,!1);la.Cb.Gn(vc,Pb,Ra);return N};qd.prototype.g1c=function(){this.xX=this.jTa=this.o8a=null;if(this.s1){var N=this.s1.parentNode;
if(N)for(N.removeChild(this.s1);this.s1.firstChild;)N.appendChild(this.s1.firstChild);this.s1=null}this.im=null;ze.DOMElementExtensions.setVisible(qd.scb,!1);this.BY=!1;this.LJd();ze.DOMElementExtensions.setVisible(this.wG,!1)};qd.prototype.Gfd=function(N){if(ze.DOMElementExtensions.Hz(N.Mb,"a"))return null;var la=this.Mif(N.Ca);if(la&&this.grid.ha.ta.Lg){var Ra=this.grid.ha.ta.ud;Ra=this.tf.ks(Nj.Range.hd(Ra.bottom,Ra.right))}else Ra=this.tf.xva(N.Mb);if(!Ra)return null;var Pb=Ra.iK(),vc=new Sys.UI.Bounds(Pb.offsetLeft,
Pb.offsetTop,Pb.offsetWidth,Pb.offsetHeight),ad=ze.DOMElementExtensions.getBoundingClientRect(N.Mb);ad=new Sys.UI.Point(N.clientPoint.x-ad.x,N.clientPoint.y-ad.y);this.isRow&&!la&&(ad.y+=wh.HelperMethods.VC(N.Mb,Pb,this.rtl).y);return new Oc(Pb,ad,vc,Ra.getRange(),Math.max(qd.uBi,Math.min(qd.oAi,(this.isRow?vc.height:vc.width)*qd.Hhj)),la,!this.isRow&&0<Pb.getElementsByTagName("input").length)};qd.prototype.Fsd=function(N,la){la=void 0===la?!1:la;if(!N||this.grid.isEditing)return!1;if(N.Lif)return!0;
var Ra=N.YOa,Pb=N.rcb,vc=this.tf.zj.paneType,ad=this.grid.Tf(vc).Hh,Fd=!!ad&&ad.top===N.wkd.top,ve=!!ad&&ad.left===N.wkd.left;vc=!!ad&&ad.bottom===N.wkd.bottom&&(3===vc||2===vc);this.isRow?(ve=N.iDb.y,N=ve<=Pb&&!Fd,Ra=ve>=Ra.height-Pb-(vc?qd.aGh:0),la=la?N:Ra||N):(vc=N.j6h,Fd=this.rtl,ad=N.iDb.x,N=ad<=Pb&&(!ve||Fd)&&(!vc||!Fd),Ra=ad>=Ra.width-Pb&&(!Fd||!ve)&&(!vc||Fd),la=la?Fd?Ra:N:N||Ra);return la};qd.prototype.KTg=function(N,la){var Ra=this.isRow;if(N.Lif)this.im=this.tf.xva(N.mwa);else if(Ra&&
N.iDb.y<=N.rcb&&N.YOa.height>N.rcb||!Ra&&N.YOa.width>N.rcb&&(!this.rtl&&N.iDb.x<=N.rcb||this.rtl&&N.iDb.x>=N.YOa.width-N.rcb)){if(this.im=N.mwa.previousSibling?this.tf.xva(N.mwa.previousSibling):this.RSh(),la&&N.mwa.classList.contains(Ra?ej.a.dSe:ej.a.cSe)&&(N=this.tf.xva(N.mwa)))N=N.getRange(),this.xX=Ra?new Nj.Range(N.top-1,N.left,N.top-1,N.right,!1,!0):new Nj.Range(N.top,N.left-1,N.bottom,N.left-1,!1,!0)}else this.im=this.tf.xva(N.mwa);!this.xX&&this.im&&(this.xX=this.im.getRange())};qd.prototype.RSh=
function(){var N=this.isRow?1:0;return(N=this.tf.zj.zG(this.tf.zj.Ea.Tg(this.grid.$.qa,Gi.a.KM(this.tf.position.X+N-1,this.tf.position.Y-N,this.tf.position.PaneType))))?N.QSh():null};qd.prototype.Xaf=function(){var N=this.Ihj;ze.DOMElementExtensions.setVisible(N,!0);N.style.cursor=this.isRow?ej.a.mPe:ej.a.INe;this.zyc()};qd.prototype.Elh=function(N){var la={};this.grid.$.Zd(this.isRow?745189930:-445963340,Ha.a.Vb,30,(la.resizeRowColumnParameters=N,la))};qd.prototype.xah=function(){var N=document.createElement("div");
N.className=ej.a.Uth;var la=document.createElement("div");la.className=Ea.a.Wr;N.appendChild(la);var Ra=document.createElement("img");Ra.src=sh.a.Se(0);Ra.className=this.isRow?Ea.a.Ssh:Ea.a.Nsh;la.appendChild(Ra);this.tf.XA.domElement.parentNode.insertBefore(N,this.tf.XA.domElement);this.grid.Nq?N.addEventListener(pg.a.Qha,this.ENi):(Gj.a.instance.pa(pg.a.pointerDown,N,this.$N),Tf.a.instance.pa(pg.a.jk,N,this.Oca));ze.DOMElementExtensions.setVisible(N,!1);this.wG=N};qd.prototype.Rsc=function(){this.g1c();
this.wG&&(this.tf.XA.domElement.parentNode.removeChild(this.wG),this.wG=null)};qd.prototype.Mif=function(N){return ze.DOMElementExtensions.Gf(this.wG,N.target)};qd.prototype.iqb=function(){this.BY&&(this.mMe(),ze.DOMElementExtensions.kUa(this.im.iK(),!this.isRow,this.LJb),this.Rsc(),this.SWa=!1)};qd.prototype.Pef=function(){return cf.EwaSettings.ma(688)};qd.prototype.C$e=function(N){(N=N.Ca.rawEvent)&&N.detail===qd.nmj&&(N.type===pg.a.mq?(this.BY=!1,this.uYc=!0):N.type===pg.a.oI&&(this.BY=!0,this.uYc=
!1))};qd.x7g=function(N,la){return new qd(N,la)};qd.eQd=function(N,la,Ra){if(la)for(N.ColumnWidth=-1,N.RowHeight=Ra,N=Cl(N.SheetMultiRange.Ranges),la=N.next();!la.done;la=N.next())la=la.value,la.FirstColumn=0,la.LastColumn=0;else for(N.RowHeight=-1,N.ColumnWidth=Ra,N=Cl(N.SheetMultiRange.Ranges),la=N.next();!la.done;la=N.next())la=la.value,la.FirstRow=0,la.LastRow=0};qd.Mmi=function(N,la){if(!N||!N.iK())return Kd.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Ra=N.getRange();
N=N.iK().style;if(!Ra||!N)return Kd.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;N=la?N.height:N.width;return(la?Ra.top:Ra.left)===(la?Oe.a.Ih:Oe.a.Qh)&&N===qd.Jhg};qd.B7g=function(N,la,Ra){if(!N)return Kd.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Pb=N.iK();if(!Pb||!Pb.style)return Kd.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;N=document.createElement("div");var vc=Pb.style;N.style.top=la?vc.top:qd.Jhg;
la||(Ra?N.style.right=vc.right:N.style.left=vc.left);N.classList.add(la?he.Ush:he.Tsh);N.classList.add(la?ej.a.Ztb:ej.a.Ytb);Ra=document.createElement("div");Ra.classList.add(la?ej.a.QRe:ej.a.J$c);Pb=la?Number.parseInvariant(Pb.innerText):Nj.Range.D0a(Pb.innerText);Ra.innerText=la?(Pb-1).toString():Nj.Range.XU(Pb-1);N.appendChild(Ra);return N};Ck.Object.defineProperties(qd.prototype,{z7a:{configurable:!0,enumerable:!0,get:function(){return this.BY}},ohf:{configurable:!0,enumerable:!0,get:function(){var N=
(new Ek.a(this.grid.$.xa)).ke(this.isRow?16:8),la=this.grid.$.zb.Mz,Ra=this.grid.Ni,Pb=li.a(this.grid.$).Oq();return N&&!la&&!Ra&&!Pb}},Ihj:{configurable:!0,enumerable:!0,get:function(){this.mmh();return qd.scb}}});qd.uBi=0;qd.oAi=5;qd.tdc=1;qd.H8e=1;qd.aGh=3;qd.Hhj=.1;qd.cUf="ewa-rszrbg";qd.Jhg="0px";qd.nmj=2;qd.scb=null;Object(Td.a)(qd,"HeaderResizeBehavior",yk.a,[921]);var nj=oh.a;Am(nd,nj);nd.prototype.create=function(){this.Eb(qd.x7g)};nd.ka=function(N){N.da.Ga(136,new nd)};Object(Td.a)(nd,"HeaderResizeBehaviorFactory",
oh.a,[]);var Ik=b(444),Ii=b(561),Rk=b(70);Object(Td.a)(Ac,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[447]);Object(Td.a)(dc,"MacroRecorderSheetRowsColumnsResizedPayload",null,[447]);var Dk=Fj.a;Am(bb,Dk);bb.prototype.$V=function(N,la){var Ra={};return Ra[bb.x5]=this.Cc,Ra[bb.Ymi]=this.isRow,Ra[bb.Bai]=N,Ra[bb.Aai]=la,Ra[bb.Zji]=this.FAb,Ra[bb.Sfd]=this.hwb,Ra};bb.prototype.jUg=function(){var N=this.iJh();try{return this.JNh(N)}finally{N&&N.dispose()}};bb.prototype.c5g=function(N){var la={};
la.SheetMultiRange=vd.r(this.gridView.ha.ta.selectedRanges,this.$);bb.eQd(la,this.isRow,N);N={};this.$.Zd(this.isRow?745189930:-445963340,Ha.a.Vb,8,(N.resizeRowColumnParameters=la,N))};bb.prototype.O4e=function(N,la){return Ng.a.S5(N)?la?this.O3g(N):this.Q3g(N):bb.Lba};bb.prototype.Q3g=function(N){return Math.floor(parseFloat(N))};bb.prototype.O3g=function(N){N=parseFloat(N);return 0>N?bb.Lba:N?this.isRow?wh.HelperMethods.GZi(N):this.muc.H_g(N):0};bb.prototype.R3g=function(N){return N===bb.Lba?"":
this.isRow?this.muc.hDe(N).toString():this.muc.ZCe(N).toFixed(2)};bb.prototype.P3g=function(N){return N===bb.Lba?"":N.toString()};bb.prototype.JNh=function(N){if(!N||!N.$$mn()||!N.uo)return bb.Lba;var la=Object(V.a)(479,N.uo);if(!la)return bb.Lba;for(la=this.isRow?la.yyb:la.Bmd;N.$$mn();){var Ra=Object(V.a)(479,N.uo);if(Ra&&(this.isRow?Ra.yyb:Ra.Bmd)!==la)return bb.Lba}return la};bb.prototype.iJh=function(){for(var N=[],la=Cl(this.gridView.ha.ta.selectedRanges),Ra=la.next();!Ra.done;Ra=la.next()){Ra=
Ra.value.clone();var Pb=this.gridView.Tf(this.gridView.rb.rj(Ra));Pb=Ra.Te(Pb.Hh);if(!Pb)return null;this.isRow?Ra.right=Ra.left=Pb.left:Ra.top=Ra.bottom=Pb.top;N.push(Ra)}return N.length?this.gridView.naa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",N):null};bb.prototype.Tfd=function(N){if(!Ng.a.S5(N))return 1;N=this.O4e(N,this.FAb);return!N&&this.Kmi()?3:this.Epi(N)?0:2};bb.prototype.Kmi=function(){var N=this.gridView.ha.ta.selectedRanges;return this.isRow&&vd.P(N)||!this.isRow&&
vd.O(N)};bb.prototype.mdd=function(N){var la="";switch(N){case 0:la="";break;case 1:la=Nc.a.instance.fa(764);break;case 2:N=this.FAb;la=String.format(Nc.a.instance.Ab(99),0,this.bcc(N));break;case 3:la=Nc.a.instance.fa(765)}return la};bb.prototype.Epi=function(N){return 0<=N&&N<=this.bcc(!1)};bb.prototype.bcc=function(N){return this.muc.bcc(N,this.isRow)};bb.eQd=function(N,la,Ra){if(la)for(N.ColumnWidth=bb.Lba,N.RowHeight=Ra,N=Cl(N.SheetMultiRange.Ranges),la=N.next();!la.done;la=N.next())la=la.value,
la.FirstColumn=0,la.LastColumn=0;else for(N.RowHeight=bb.Lba,N.ColumnWidth=Ra,N=Cl(N.SheetMultiRange.Ranges),la=N.next();!la.done;la=N.next())la=la.value,la.FirstRow=0,la.LastRow=0};Ck.Object.defineProperties(bb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},FAb:{configurable:!0,enumerable:!0,get:function(){return bb.fae},set:function(N){bb.fae=N}}});bb.x5="id";bb.Ymi="isRow";bb.Bai="initialSizeInPx";bb.Aai="initialSizeInDefaultUnits";bb.Zji="isInitialUnitsDefaultUnits";
bb.Sfd="getInputErrorIfInvalid";bb.RCj="size";bb.Mhi="isDefaultUnits";bb.Lba=-1;bb.fae=!0;Object(Td.a)(bb,"ResizeHeadersDialog",Fj.a,[]);var Jk=b(354),Sk=b(567),zk=b(63);Ca.prototype.$c=function(N,la){N=!0;switch(la){case -445963340:case 1391094586:N=this.ke(8);break;case 745189930:case 146338636:N=this.ke(16)}return!N};Ca.prototype.executeCommand=function(N,la,Ra){var Pb=og.TaskExtensions.Dl();var vc=hg.g(this.$);N=Ti.a.create().toString();var ad=la.command;switch(ad){case 1391094586:case 146338636:var Fd=
1391094586===ad;(N=Ra.autoFitRanges)&&N.Ranges&&N.Ranges.length||(N=vd.r(vc.ha.ta.selectedRanges,this.$));Pb=this.Ahh(Fd?1:0,N,la);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Fd=-445963340===ad||-706918724===ad||369708605===ad;if(-445963340===ad||745189930===ad)Fd=Ik.a(la.command),vc.Ki.e8(16,N,Fd),Ra=Ra.resizeRowColumnParameters;else{var ve=vc.ha.ta.selectedRanges;if(-706918724===ad&&6===la.Xe&&vd.O(ve)){Kd.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");
break}if(1051390410===ad&&6===la.Xe&&vd.P(ve)){Kd.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}vc=369708605===ad||1542466017===ad?-2:0;Ra={};Ra.SheetMultiRange=vd.r(ve,this.$);if(Fd)for(Pb=Cl(Ra.SheetMultiRange.Ranges),ad=Pb.next();!ad.done;ad=Pb.next())ad=ad.value,ad.FirstRow=0,ad.LastRow=0;else for(Pb=Cl(Ra.SheetMultiRange.Ranges),ad=Pb.next();!ad.done;ad=Pb.next())ad=ad.value,ad.FirstColumn=0,
ad.LastColumn=0;Ra.RowHeight=Fd?-1:vc;Ra.ColumnWidth=Fd?vc:-1}Pb=this.Uhh(Ra,la,N);break;case 957527587:case 2040891415:new bb(this.$,la)}return Pb};Ca.prototype.G_g=function(){cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,426,427,1),function(){},this.$.la,3)};Ca.prototype.Kc=function(N,la,Ra,Pb){if(N=!!Ra&&!!Pb&&1===Pb.Qx)switch(la.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:N=!1}return N};Ca.prototype.jd=function(){return!1};Ca.prototype.Uvi=function(N){Kd.ULS.sendTraceTag(537154004,0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",N.success,Object(Sk.c)(N)?void 0:N.reason)};Ca.prototype.ke=function(N){return(new Ek.a(this.$.xa)).ke(N)};Ca.prototype.Ahh=function(N,la,Ra){function Pb(){return new Ac(Fd,la)}var vc=this,ad=this.$.na.va.hc(),Fd=0===N;return kc.a(this.$.userOperationManager,function(ve,Me,fg){var gh=
vc.$.na.va;ve=th.b(ve,vc.WIi);var Wh={bhi:!Fd,J0b:la},Ci=gh.Na(41,ad);Ci.isRow=Fd;Ci.autoFitRanges=la;return ce.i(gh,"AutoFit",Ci,ve,Me,fg,Wh,0)},function(ve){return new Jb.a(135,0,ve,void 0,Pb)},Ra)};Ca.prototype.Uhh=function(N,la,Ra){function Pb(){return new dc(N)}function vc(gh,Wh,Ci){ad.$.Oy();vd.i(Fd,",",ad.$,!1);var Hj=ad.$.na.va;gh=th.b(gh,ad.zRi);var aj=Hj.Na(41,void 0===fg?null:fg);aj.resizeRowColumnParameters=N;return ce.i(Hj,"ResizeRowsColumns",aj,gh,Wh,Ci,Ra,0)}var ad=this,Fd=vd.g(N.SheetMultiRange.Ranges),
ve=la.command;if(745189930===ve||-445963340===ve){Kd.ULS.shipAssertTag(537154002,0,this.$.activeItemName===N.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var Me=hg.g(this.$);ve=745189930===ve;Me=this.Sg.eBj(Me,Fd,ve?N.RowHeight:N.ColumnWidth,ve);this.Uvi(Me);Object(Sk.c)(Me)&&hg.g(this.$).Ki.o1(Ra,Rk.BasicTelemetryCalculator.wR)}var fg=this.$.na.va.hc({Lla:!0,Lka:3});return Me&&Object(Sk.c)(Me)?cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,
vc,function(gh){return new Jb.a(136,0,gh,64,Pb)},la):kc.a(this.$.userOperationManager,vc,function(gh){return new Ii.a(136,0,gh,void 0,Pb)},la):kc.a(this.$.userOperationManager,vc,function(gh){return new Jb.a(136,0,gh,void 0,Pb)},la)};Object(Td.a)(Ca,"ResizeCommandHandler",null,[424]);var el=Ff.a;Am(Jc,el);Jc.prototype.Nd=function(){var N=this,la=zh.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub);og.TaskExtensions.Ba(la,function(){N.Dd([new Ca(N.$,la.result)])},this.la,3)};Jc.ka=function(N){Ff.a.he(113,
new Jc(N))};Object(Td.a)(Jc,"ResizeCommandHandlerFactory",Ff.a,[]);Ed.prototype.$c=function(){return!1};Ed.prototype.executeCommand=function(N,la,Ra){N=2;switch(la.command){case -309686558:N=this.Ei.Be(Zf.a.saveACopy,2,Ra);break;case 617689800:N=this.Ei.Be(Zf.a.saveToCloudStorage,2,Ra);break;case -1244760097:N=this.Ei.Be(Zf.a.saveToSharePoint,2,Ra)}return 2===N&&la?vh.a(la.command):nh.Task.Ra(!0)};Ed.prototype.Kc=function(N,la){N=!1;switch(la.command){case -1244760097:case -309686558:case 617689800:N=
!0,Kd.ULS.shipAssertTag(537153984,0,this.$.Vka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return N};Ed.prototype.jd=function(){return!1};Object(Td.a)(Ed,"SaveToHostCommandHandler",null,[424]);var Tk=Ff.a;Am(Fc,Tk);Fc.prototype.Nd=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){N.Dd([new Ed(N.$,be.AFrameworkApplication.Ib)])},this.la,3);be.AFrameworkApplication.Ib.fc(Zf.a.yRa,ig.a.frame,
this.TEh)};Fc.ka=function(N){Ff.a.he(267,new Fc(N))};Object(Td.a)(Fc,"SaveToHostCommandHandlerFactory",Ff.a,[]);Gc.prototype.$c=function(N){switch(N){case -309686558:return 8===this.Ei.processAction(Zf.a.saveACopy,1,null);case 617689800:return 8===this.Ei.Be(Zf.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Ei.Be(Zf.a.saveToSharePoint,1,null)}return!1};Gc.prototype.dispose=function(){this.$=null};Object(Td.a)(Gc,"SaveToHostManager",null,[920,2]);var rl=oh.a;Am(zb,rl);zb.prototype.create=
function(){this.Eb(this.$.da.Aa(393)||new Gc(this.$,be.AFrameworkApplication.Ib))};zb.ka=function(N){N.da.Ga(394,new zb(N))};Object(Td.a)(zb,"SaveToHostManagerFactory",oh.a,[]);var $k=Hi.a;Am(hb,$k);hb.prototype.execute=function(N){var la=Object(V.a)(6,N.Le);Kd.ULS.shipAssertTag(537153921,0,Hg.a.Gob(N.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");la.vI(!0,!0);N.activityState[Vh.a.QYb]=la.ea.sessionId;N.activityState[Vh.a.tnb]=!0;N.activityState[Vh.a.WYb]=
!0;Kd.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(Td.a)(hb,"SessionReloadActivity",Hi.a,[]);var rk=oh.a;Am(Ib,rk);Ib.prototype.create=function(){this.Eb(new hb(ih.a.$cb,ih.a.Jk))};Ib.ka=function(N){N.da.Ga(142,new Ib)};Object(Td.a)(Ib,"SessionReloadActivityFactory",oh.a,[]);var sk=b(56),Eg=b(278),tk=b(110),Zi=b(46),Uk=b(253),Mk=b(114),fl=Hi.a;Am(nb,fl);nb.prototype.execute=function(N){var la=Object(V.a)(6,N.Le);N.activityState[Vh.a.bsa]=
!0;var Ra=nb.pZh(N);if(nb.Qwj(N,Ra))return nb.Dzi(N),Ra=50,0<N.errors.length&&(Ra=15),Kd.ULS.sendTraceTag(537153891,0,Ra,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",Hg.a.Xc(N.errors)),N.activityState[Vh.a.bsa]=!1,this.Bh(ih.a.idle),3;switch(Ra){case 1:case 3:this.Mci(N,Ra);break;case 2:this.Lci(N);break;case 0:N.activityState[Vh.a.TYa]=null}Kd.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",
Ra,this.activityName,this.k0,la.ea.o8);var Pb=Wj.a.xg(N.activityState,Mk.a.kfb);Kd.ULS.shipAssertTag(40502925,0,!Pb||Pb&&(1===Ra||3===Ra),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",Pb,Ra);la=la.Uk.reloadCount;return 0!==Ra&&0<la?(Pb=Eg.a.Uva(la,200),Kd.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Ra,la,Pb,this.activityName),lj.a.instance.create(function(){nb.OJ(N)},Pb,pk.a.apj),
1):3};nb.prototype.Mci=function(N,la){Kd.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Ra=Object(V.a)(6,N.Le);N.activityState[Vh.a.tnb]=!0;Ra.Zfc||Zi.PageLoadTrackingInfo.instance.Nj("ReopenOnLoad");!nb.isEditMode(N)&&Hg.a.Gob(N.errors)&&(Kd.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),N.activityState[Vh.a.QYb]=Ra.ea.sessionId,N.activityState[Vh.a.WYb]=
!0);N.Lwd();3===la?(Ra.ea.Fg()||Ra.ea.hFi(),Ra.vI(!0,!0),this.Bh(this.SLj),N.activityState[Vh.a.Ole]=Ra.workbookContext.CalcMode):(cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===la&&Ra.vI(!0,!0),N.activityState[Vh.a.CUc]=!1,this.Bh(this.Fyc))};nb.prototype.Lci=function(N){Kd.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");N.activityState[Vh.a.TYa]=null;N.Lwd();this.Bh(this.KCj);N=Object(V.a)(6,
N.Le);N.Zfc||(Zi.PageLoadTrackingInfo.instance.Nj("RefreshOnLoad"),N.NIb())};nb.OJ=function(N){N.OJ()};nb.pZh=function(N){var la=Object(V.a)(6,N.Le),Ra=la.ea,Pb=nb.isEditMode(N),vc=Hg.a.qh(N.errors,Pb?nb.wwd:nb.xwd),ad=Hg.a.qh(N.errors,Pb?nb.Apf:nb.Bpf),Fd=la.yR,ve=la.Uk.reloadCount,Me=la.ya.MaxConsecutiveSilentReloadAllowed,fg=la.Uk.i8e(),gh=Hg.a.Xc(N.errors),Wh=Hg.a.Xc(N.Pza),Ci=0<Hg.a.UM(function(mk){return!mk.triggerSilentReopenOnly},N.errors).length,Hj=vc,aj=Wj.a.xg(N.activityState,Mk.a.kfb);
aj&&(Hj=!0);vc={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Pb,isSilentReopenError:vc,isSilentRefreshError:ad};vc.reloadSequenceCount=la.Uk.JQa;vc.reloadCount=ve;vc.maxReloads=Me;vc.stopSilentReloads=fg;vc.errorNames=gh;vc.processedErrorNames=Wh;vc.isClientDirty=Fd;vc.errorsForSilentReopenOnly=Ci;vc.triggerSilentReloadAfterTokenRefresh=aj;vc.IsReopenDisabled=la.fNa;Fd=sk.a.Lc(vc);Kd.ULS.sendTraceTag(21837004,0,50,Fd);if(!fg){if(Hj&&(Pb?nb.Hwj(N):nb.Jwj(N)))return Uk.a.w2f(N,la)?
3:la.fNa?2:1;if(ad&&(Pb||!Ra.mbb))return 2}return 0};nb.Qwj=function(N,la){for(var Ra=Cl(N.errors),Pb=Ra.next();!Pb.done;Pb=Ra.next())if(Pb=Pb.value,-1337545025===Pb.MessageId||-238814601===Pb.MessageId)return!1;return Hg.a.UM(function(vc){return!vc.triggerSilentReopenOnly},N.errors).length?3!==la:!1};nb.Dzi=function(N){var la=Hg.a.UM(function(Pb){return!Pb.triggerSilentReopenOnly},N.errors);la=Cl(la);for(var Ra=la.next();!Ra.done;Ra=la.next())N.Nla(Ra.value)};nb.isEditMode=function(N){var la=Object(V.a)(6,
N.Le);return la.ea.sc?la.uv&&!!(la.Pd&64):Wj.a.xg(N.activityState,Vh.a.Rs)};nb.Jwj=function(N){var la=Object(V.a)(6,N.Le),Ra=Hg.a.Oaa(N.errors,nb.xwd);if(tk.b(Ra,function(Pb){return Pb.ForceVersionUpgrade}))return!1;N=Hg.a.Gob(N.errors);return!la.ea.mbb||N?!0:!1};nb.Hwj=function(N){N=Hg.a.Oaa(N.errors,nb.wwd);return!tk.b(N,function(la){return la.ForceVersionUpgrade})};nb.xwd=null;nb.wwd=null;nb.Bpf=null;nb.Apf=null;Object(Td.a)(nb,"SessionReloadSilentActivity",Hi.a,[]);var jj=oh.a;Am(Cb,jj);Cb.prototype.create=
function(){this.Eb(new nb(this.activityName,this.MM,ih.a.Jk,ih.a.uj,ih.a.QNb))};Cb.ka=function(N){N.da.Ga(143,new Cb(ih.a.Kna,ih.a.N0b));N.da.Ga(144,new Cb(ih.a.iwc,ih.a.BPa));N.da.Ga(145,new Cb(ih.a.jwc,ih.a.oDd));N.da.Ga(154,new Cb(ih.a.adb,ih.a.lP))};Object(Td.a)(Cb,"SessionReloadSilentActivityFactory",oh.a,[]);tb.prototype.getSheetName=function(){return this.sheetName};tb.prototype.getValue=function(){return this.value};Object(Td.a)(tb,"MacroRecorderSheetOptionToggledPayload",null,[447]);ua.prototype.$c=
function(){return!1};ua.prototype.executeCommand=function(N,la){function Ra(){return new tb(Pb.SheetName,fg)}var Pb={};this.$.Dj(Pb);N=la.command;var vc=Object(V.a)(Vf.a,this.$.xa.getItemByName(Pb.SheetName));if(!vc)return vh.a(N);switch(N){case 705559150:case -1411193626:var ad=16;var Fd=!vc.hideGridLines;var ve=Va;var Me=183;var fg=vc.hideGridLines;break;case -2052321504:case 515737500:ad=4;Fd=!vc.headersVisible;ve=ub;Me=184;fg=!vc.headersVisible;break;case -1478455630:ad=2;Fd=!vc.displayRtl;ve=
La;Me=185;fg=!vc.displayRtl;hg.g(this.$).Ea.$Qj(Fd);break;default:return vh.a(N)}vc.sqb(ad,Fd);var gh=this.$.na.va;return kc.a(this.$.userOperationManager,function(Wh,Ci,Hj){return ve(gh,Pb.SheetName,fg,th.b(Wh,function(aj){ua.uFb(aj,vc,ad,Fd)}),th.a(Ci,function(){ua.CEb(vc,ad,Fd)}),Hj,null)},function(Wh){return new Jb.a(Me,0,Wh,void 0,Ra)},la)};ua.prototype.Kc=function(N,la){N=!1;switch(la.command){case -1411193626:case 515737500:case -1478455630:N=!0;break;case 705559150:case -2052321504:N=Wi.a(this.$)}return N};
ua.prototype.jd=function(){return!1};ua.uFb=function(N,la,Ra,Pb){Hg.a.lr(N.Errors)&&la.sqb(Ra,!Pb)};ua.CEb=function(N,la,Ra){N.sqb(la,!Ra)};Object(Td.a)(ua,"SheetOptionsToggleCommandHandler",null,[424]);var gl=Ff.a;Am(ba,gl);ba.prototype.Nd=function(){this.Dd([new ua(this.$)])};ba.ka=function(N){Ff.a.he(100,new ba(N))};Object(Td.a)(ba,"SheetOptionsToggleCommandHandlerFactory",Ff.a,[]);var tj=b(214),Kk=tj.a;Am(K,Kk);K.prototype.initialize=function(){var N=this.$.Lb+"iframeDialog_frame",la=this.$.Lb+
"iframeDialog";var Ra=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',N,this.H_e(la));this.Qb.style.margin=wh.HelperMethods.nc(0);this.Qb.style.marginBottom=wh.HelperMethods.nc(-2);this.Qb.innerHTML=Ra;this.FKc=document.getElementById(N);this.domElement.id=la;this.onResize(null,Sys.EventArgs.Empty);Mf.a.ohc&&lj.a.instance.create(this.Qlh,50,pk.a.N8h,!0,!0);Kk.prototype.initialize.call(this)};K.prototype.dispose=function(){this.$&&this.$.AD(this.onResize);
Kk.prototype.dispose.call(this)};K.prototype.setFocus=function(){ze.DOMElementExtensions.setFocus(this.QLa)};K.prototype.onHide=function(){this.QLa.contentWindow.close();ze.DOMElementExtensions.Af(this.QLa);this.FKc=null;Kk.prototype.onHide.call(this)};K.prototype.JRj=function(N){var la=this.domElement.style;la.width=wh.HelperMethods.nc(N.x);la.marginLeft=wh.HelperMethods.nc(-N.x/2)};K.prototype.TRh=function(){var N=ze.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
N.width),this.OHe.x),Math.min(Math.floor(.9*N.height),this.OHe.y))};Ck.Object.defineProperties(K.prototype,{QLa:{configurable:!0,enumerable:!0,get:function(){return this.FKc}}});Object(Td.a)(K,"IFrameDialog",tj.a,[]);Am($a,K);$a.prototype.H_e=function(N){var la=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);sg.a.fh(la,ja.a.Xnh,N);jb.a(this.$.ya,34)&&sg.a.fh(la,ja.a.JNe,"1");jb.a(this.$.ya,35)&&sg.a.fh(la,ja.a.KNe,"1");return la.toString()};$a.prototype.onShow=function(){Kd.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");K.prototype.onShow.call(this)};Ck.Object.defineProperties($a.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(Td.a)($a,"EmbeddingDialog",K,[]);mb.N1f="FrameDialog_ShareFromEdit";mb.view="FrameDialog_View";mb.sAe="FrameDialog_CloseAndRefresh";mb.Ovj="FrameDialog_ShareFromView";mb.edit="FrameDialog_Edit";mb.i8i="FrameDialog_RefreshGrid";mb.$Zg="FrameDialog_CloseMe";mb.CAe="FrameDialog_CloseMeError";
mb.ready="FrameDialog_Ready";mb.FZi="FrameDialog_PleaseClose";mb.JH="GotoRange";Object(Td.a)(mb,"PostMessageConstants",null,[]);var uk=b(107);Object(Td.a)(cd,"SessionUpdateContext",null,[]);Am(hc,K);hc.prototype.jGg=function(N){this.addHandler(hc.eud,N)};hc.prototype.Gcj=function(N){this.removeHandler(hc.eud,N)};hc.prototype.dispose=function(){di.a.Ha(this.n1a);this.n1a=null;K.prototype.dispose.call(this)};hc.prototype.initialize=function(){K.prototype.initialize.call(this);var N=Ug.a.nba(this.$.ya.FormLightBoxUrl),
la=this.n1a=new k.a(this.QLa.contentWindow,N);la.isEnabled()&&la.XFa(N)&&(this.dna(mb.N1f,this.fpc),this.dna(mb.view,this.fpc),this.dna(mb.sAe,this.fpc),this.dna(mb.Ovj,this.OSi),this.dna(mb.edit,this.DKi),this.dna(mb.i8i,this.fpc),this.dna(mb.ready,this.hRi),this.dna(mb.$Zg,this.hwf),this.dna(mb.CAe,this.hwf))};hc.prototype.close=function(N){N===this.closeAction&&this.Aff&&this.n1a.send(new Bg.a(mb.FZi))||K.prototype.close.call(this,N)};hc.prototype.H_e=function(){return this.IEe(this.cic)};hc.prototype.IEe=
function(N){var la=this.$.ya,Ra=new Sys.StringBuilder(la.FormLightBoxUrl);sg.a.fh(Ra,ja.a.pFh,this.$.ea.sessionId);sg.a.fh(Ra,ja.a.nFh,N?ja.a.oFh:ja.a.mFh);bk.a.HZa(Ra,la);return Ra.toString()};hc.prototype.Keg=function(N){this.TLc=!1;this.QLa.src=this.IEe(N);this.U$d=N};hc.prototype.dna=function(N,la){this.n1a.mo(N);this.n1a.Tl(N,la)};hc.prototype.Unc=function(N){var la=this.$.ea.xa.getItemByName(N.JH.SheetName);la&&0===la.Ty&&hg.g(this.$).Eg(N.JH,null,null,null,20,uk.a.YEh)};Ck.Object.defineProperties(hc.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},Aff:{configurable:!0,enumerable:!0,get:function(){return this.TLc}},cic:{configurable:!0,enumerable:!0,get:function(){return this.U$d}}});hc.udh=900;hc.Xch=1200;hc.eud="lightBoxReady";Object(Td.a)(hc,"FormDialog",K,[499]);var Fk;(function(N){N[N.comment=10]="comment";N[N.range=12]="range";N[N.table=13]="table";N[N.chart=14]="chart"})(Fk||(Fk={}));Object(Td.b)("NavigationType",Fk);var Ak=b(1084),ek=b(116),ml=b(620),hl=b(1146),wj=
b(295),Nk=b(935),Ai=Nk.a;Am(Fb,Ai);Fb.prototype.initialize=function(){var N="<div class='"+ek.a.wo+"'>\r\n\t<div class='"+ek.a.ZNe+"'>\r\n\t\t<div class='"+Ea.a.v1c+"'>\r\n\t\t\t<img src='{0}' class='"+Ea.a.lRe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+ek.a.cOe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";N=String.format(N,sh.a.Se(13),Nc.a.instance.fa(25),Nc.a.instance.fa(this.message));this.Qb.innerHTML=N;this.addButton(0,this.AGi);this.addButton(1);Ai.prototype.initialize.call(this)};
Fb.prototype.Nx=function(){return this.q0d};Ck.Object.defineProperties(Fb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Iu:{configurable:!0,enumerable:!0,get:function(){return 1005}},ota:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(Td.a)(Fb,"WebMethodConfirmationDialog",Nk.a,[]);var vk=Ak.a;Am(Cc,vk);Cc.prototype.dispose=function(){this.dUa&&this.dUa.Hda(this.VEf);di.a.yc([this.textBox,this.FRa,this.dUa]);this.dUa=
this.FRa=this.textBox=null;vk.prototype.dispose.call(this)};Cc.prototype.initialize=function(){var N="<div class='"+ek.a.wo+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+ek.a.Otb+"'>\r\n\t<input type='text' id='{1}' class='"+ek.a.QC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";N=String.format(N,Nc.a.instance.fa(1239),"sfd_input","sfd_unshare",Ea.a.gq,Nc.a.instance.fa(1240));this.Qb.innerHTML=N;this.textBox=new wj.a(this.getElementById("sfd_input"));
this.FRa=new hl.a(this.textBox.domElement);this.dUa=ml.a.create(this.getElementById("sfd_unshare"));this.dUa.h3(this.VEf);this.textBox.text=Nc.a.instance.fa(733);this.textBox.enabled=!1;this.textBox.readOnly=!Mf.a.Fh;this.addButton(1,10);vk.prototype.initialize.call(this)};Cc.prototype.Sha=function(){var N=this;return function(la,Ra,Pb){var vc=N.$.na.va.hc(),ad=N.$.na.va;la=N.Jja(la);Ra=N.dba(Ra);vc=ad.Na(1,vc);return ce.i(ad,"ShareForm",vc,la,Ra,Pb,null,0)}};Cc.prototype.Dy=function(N,la,Ra){this.textBox.text=
N.Result;this.textBox.enabled=!0;ze.DOMElementExtensions.setVisible(this.dUa.domElement,!0);vk.prototype.Dy.call(this,N,la,Ra)};Cc.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(N){}vk.prototype.setFocus.call(this)};Ck.Object.defineProperties(Cc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(Td.a)(Cc,"ShareFormDialog",Ak.a,[]);var Ok=b(718),Vk=b(143),al=b(265),il=b(16),Bk=S.a;Am(Tb,Bk);Tb.prototype.$c=
function(N,la){N=this.$.workbookContext.FullDocumentInfo;switch(la){case 353606613:case -1099009678:case 192430811:return!cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return la=al.a()&&this.$.ea.Zg.get(5),!N.FileSharingUrl&&!la;case -1570751769:case 1986648902:return 131072!==(this.$.bR&131072);case 330035228:return!(this.z3a(!0)&&this.QDc);case -509039657:return!(this.z3a()&&this.QDc);case 1334518759:return!(this.z3a()&&
this.QDc&&this.hxe())}return!1};Tb.prototype.executeCommand=function(N,la,Ra){N=this.$.workbookContext.FullDocumentInfo;var Pb=Zf.a.workflow,vc=og.TaskExtensions.Dl(),ad=la.command;if(ad===Pb||-266099===ad)return this.W5h(la,Pb,N);switch(ad){case 1986648902:this.$0f();break;case -1570751769:this.I3h(la);break;case 869186573:la=Zf.a.Nvj;vc=be.AFrameworkApplication.ga.ra("ShareMenuIsEnabled");Pb=null;(cf.EwaSettings.ma(565)||vc)&&Ra&&"CopyLink"===Ra.SourceControlId?(Pb={},Pb[lf.a.kLb]="copy",la=Zf.a.M1f):
vc&&Ra&&"ManageAccess"===Ra.SourceControlId?(Pb={},Pb[lf.a.kLb]="manageAccess",la=Zf.a.Pvj):Ra&&"LinkToComment"===Ra.SourceControlId&&(Pb={},Pb[lf.a.kLb]="copy",Pb[lf.a.O1f]=Ra.navId,la=Zf.a.M1f);vc=this.b5f(N,Pb);Vj.c(la);break;case -1099009678:vc=this.QQd(12,N);break;case 192430811:vc=this.QQd(13,N);break;case 353606613:vc=this.QQd(14,N);break;case -59906385:case 1197060601:this.k5h(la,N);break;case 1305810481:this.K6e(!1,la);break;case 330035228:this.K6e(!0,la);break;case -509039657:this.deleteForm();
break;case 1334518759:la.qzb=!0;this.shareForm();break;case 710925581:md.a.Dg.zxc("710925581")&&(vc=og.TaskExtensions.Ba(this.jK.value,function(Fd){Fd.result.Jj(Je.a.conversation,{})},this.la,3));break;case 327119921:this.y3h();break;default:vc=vh.a(ad)}return vc};Tb.prototype.Kc=function(N,la){N=!1;la=la.command;if(la===Zf.a.workflow)return!0;switch(la){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:N=
!0;break;case 353606613:case -1099009678:case 192430811:N=cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return N};Tb.prototype.jd=function(N,la,Ra){if("PopulateFormMenu"===la){la=this.QDc?this.hxe()?Tb.izh:Tb.jzh:Tb.WDi;N=this.Sa.Pc();for(var Pb=0;Pb<la.length;Pb++)N.buttons.push(this.Sa.Bb(la[Pb]));la=this.Sa.Zp("Forms.Flyout");la.Dc.push(N);Ra.MenuItems=la.sC();return!0}return!1};Tb.prototype.W5h=function(N,la,Ra){return this.qNd&&
N.command===la?(this.oNd(N,-266099),og.TaskExtensions.h5()):og.TaskExtensions.Ba(this.jK.value,function(Pb){Ye.a(Pb.result,Je.a.workflow,null,Ra.WorkflowPostMessage)||wh.HelperMethods.rf(Ra.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)};Tb.prototype.hxe=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Zg.get(26)};Tb.prototype.y3h=function(){var N=Ti.a.create().toString();Kd.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+
N);var la=this.$.frame,Ra=la.x9a,Pb=this.$,vc=new Eh.QueryStringBuilder(be.AFrameworkApplication.ga.Va("TeamsMeetingShareEndpoint"));vc.Yi("deeplinkId",N);vc.Yi("lm","deeplink");N=vc.Yi;var ad={};var Fd=new Eh.QueryStringBuilder(be.AFrameworkApplication.ga.Va("TeamsAppSharingUrl"));Fd.Yi("auth","2");Fd.Yi("flight","officeunihost");Fd.Yi("source","TEAMS-ELECTRON.meetingStage.deeplink");var ve={};ve.fileType=Hf.a.Z4(Pb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);ve.objectUrl=Pb.workbookContext.FullDocumentInfo.WorkbookPath;
ve.baseUrl=Pb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Pb=Pb.workbookContext.WorkbookFileVersionId;for(var Me=decodeURIComponent(Pb);Pb!=Me;)Pb=Me,Me=decodeURIComponent(Pb);0>Pb.indexOf("{")||0>Pb.indexOf("}")?(Kd.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+Pb),Pb=""):Pb=Pb.substring(Pb.indexOf("{")+1,Pb.indexOf("}")).toLowerCase();ve.fileId=Pb;ve=xh.c(xh.c(ve));Fd.Yi("subEntityId",ve.substring(1,ve.length-1));ad.appSharingUrl=Fd.toString();
ad.appId=be.AFrameworkApplication.ga.Va("TeamsAppId");ad=JSON.stringify(ad);N.call(vc,"appContext",ad);Ra.call(la,vc.toString(),!0)};Tb.prototype.I3h=function(N){this.qNd?this.oNd(N,1986648902):this.$0f()};Tb.prototype.K6e=function(N,la){!N&&this.$.ya.SurveyRedirectUrl?this.U2i():(N=new hc(this.$,N,la),N.initialize(),N.kf())};Tb.prototype.k5h=function(N,la){var Ra=this;this.qNd&&1197060601===N.command?this.oNd(N,-59906385):og.TaskExtensions.Ba(this.jK.value,function(Pb){Pb=Pb.result;Pb&&Ye.a(Pb,Je.a.replyWithChanges,
null,Ra.$.ea.Zg.get(8))||(Pb=new Sys.StringBuilder(la.ReplyWithChangesUrl),sg.a.fh(Pb,Hh.e,Hh.d),D.a.ntw(Pb.toString(),Ra.$))},this.la,3)};Tb.prototype.oNd=function(N,la){var Ra=this,Pb=Ja.a(this.$).rd.activityState,vc=new cg.a(la,N.method,N.mode,N.Xe,N.tabName);li.a(this.$).rt(new Ni.a(ih.a.Az,5,function(){Pb[yi.a.hr]=ih.a.WVf;Pb[Ok.a.yUc]=vc;Ra.$.Uk.hz("SocialSharingSaveBeforeCommand");Ra.$.Uk.hne(vc.command)}))};Tb.prototype.$0f=function(){var N=this,la=this.$.ya.DocumentHostInfo;la.HostEmbeddedViewUrl||
this.Ywe?this.U3f():this.$.Yf.get(53)&&og.TaskExtensions.Ba(this.jK.value,function(Ra){N.GOj(Ra.result)||D.a.ntw(la.FileEmbedCommandUrl,N.$)},this.la,3)};Tb.prototype.GOj=function(N){return N.isEnabled()&&(this.Xwe||(this.Xwe=N.Tl(Je.a.Wwe,this.THi)))?N.Jj(Je.a.RAh,null):!1};Tb.prototype.U3f=function(){if(Mf.a.xp)D.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var N=new $a(this.$);N.initialize();N.kf()}};Tb.prototype.deleteForm=function(){var N=this.$,la=new Fb(N,1244,1245,1237,function(Ra,Pb,
vc){var ad=N.na.va.hc(),Fd=N.na.va;ad=Fd.Na(9,ad);ad.surveyId=null;return ce.i(Fd,"DeleteSurvey",ad,Ra,Pb,vc,null,0)});la.initialize();la.kf()};Tb.prototype.shareForm=function(){var N=this,la=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Zg.get(26)){var Ra=new Cc(this.$);Ra.initialize();Ra.kf()}else og.TaskExtensions.Ba(this.jK.value,function(Pb){var vc={};Ye.a(Pb.result,Je.a.shareForm,(vc[lf.a.OHj]=N.$.workbookContext.SurveyTitle,vc),N.$.ea.Zg.get(10))||D.a.ntw(la.ShareFormCommandUrl,N.$)},
this.la,3)};Tb.prototype.U2i=function(){var N=this.$;N.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var la=new Sys.StringBuilder(N.ya.SurveyRedirectUrl);sg.a.fh(la,"startupDialog","FormEdit");var Ra=Ja.a(this.$),Pb=Ra.rd.activityState;Pb[Cj.a.V2]=la.toString();Pb[Cj.a.sM]=Cj.a.syd;this.$.Uk.hz("SocialSharingEnvironmentChange");li.a(N).rt(new Ni.a(ih.a.Az,5,function(){var vc=Hg.a.gd(3,2,1289,1290,1291,554412057,"FossEnvironmentUnsupported");Ra.rd.Lt([vc]);Pb[yi.a.hr]=
ih.a.Lcg}))};Tb.prototype.z3a=function(N){return(this.$.ea.isEditMode||(void 0===N?!1:N))&&this.$.ea.Zg.get(25)&&al.a()};Tb.prototype.$Yh=function(N){var la=void 0===la?null:la;var Ra=hg.g(this.$).ha;var Pb=this.$.xa.qa?zk.d(this.$.xa.qa):null;if(!Pb)return Kd.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",Fk[N]),null;14===N?la=this.yYh(Ra):12===N?(la=Ra.Iia,la=Ng.a.contains(la,"!",!0)?la.split("!")[1]:la):13===N&&
(Ra=Ra.ta.selectedRanges,Ra[0]&&(Ra=hg.g(this.$).Rb.Qj(Ra[0])))&&(la=Ra.jj);if(!la)return Kd.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",Fk[N]),null;Ra={};Ra[lf.a.kLb]="copy";Ra[lf.a.O1f]=this.sPh(N,la,Pb);Kd.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",Fk[N],la,
Pb);return Ra};Tb.prototype.yYh=function(N){if(N.Oa.J5&&(N=N.Oa.oc.floatingObject)&&0===N.type){var la=N.id.split(".");if(1<la.length)return la[1];Kd.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",N.id)}return null};Tb.prototype.sPh=function(N,la,Ra){N=btoa(N+"_"+la+"_"+Ra);N=N.replace(RegExp("\\+","g"),"-");N=N.replace(RegExp("\\/","g"),"_");return N=N.replace(RegExp("\\=+$","g"),"")};Tb.prototype.b5f=function(N,la){var Ra=
this;return og.TaskExtensions.Ba(this.jK.value,function(Pb){Ye.a(Pb.result,Je.a.sharing,la,Ra.$.ea.Zg.get(5))?Kd.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",la?la[lf.a.kLb]:""):wh.HelperMethods.rf(N.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};Tb.prototype.QQd=function(N,la){if(!cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;
var Ra=this.$Yh(N);if(Ra)return this.b5f(la,Ra);Kd.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",Fk[N]);return null};Ck.Object.defineProperties(Tb.prototype,{QDc:{configurable:!0,enumerable:!0,get:function(){return da.b(this.$.kg)}},qNd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.wjh||this.$.yR)}}});Tb.WDi=[103];Tb.izh=[107,104,105,106];Tb.jzh=[104,105];Tb.HWg=[new il.a(ih.a.AAe,
554412057,0,0,1292),new il.a(ih.a.idle,554412057,0,1)];Object(Td.a)(Tb,"SocialSharingCommandHandler",S.a,[424]);var ik=Ff.a;Am(Sa,ik);Sa.prototype.Nd=function(){var N=this,la=new Gf.a(function(){return zh.GetServiceTaskFactory.create(N.$.da,137,N.la,N.ub)});og.TaskExtensions.Ba(zh.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),function(Ra){N.Dd([new Tb(N.$,Ra.result,la)])},this.la,3)};Sa.ka=function(N){Ff.a.he(114,new Sa(N))};Object(Td.a)(Sa,"SocialSharingCommandHandlerFactory",Ff.a,
[]);Object(Td.a)(xb,"MacroRecorderRangeCustomSortedPayload",null,[447]);var Wk=b(1160),Ah=b(1161),Pk=b(1005),Qk=b(959),bl=b(213);Ob.prototype.show=function(){var N=new fh.StandardDialog;N.jc=11;N.Bc(1,Nc.a.instance.fa(2076));N.Bc(2,Nc.a.instance.fa(2077));N.S4f(Nc.a.instance.fa(2075),Nc.a.instance.Wa(645),this.Dw)};Ob.prototype.jOa=function(N){Kd.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",N)};Object(Td.a)(Ob,"ExpandSortSelectionDialog",null,[]);ec.isValid=function(N){return Array.contains(ec.tzh,
N.Position)?!0:(Kd.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",N.Position),!1)};ec.tzh=[0,.5,1];Object(Td.a)(ec,"FillGradientStopExtension",null,[]);Object(Td.a)(Ya,"GradientLine",null,[]);rb.isValid=function(N){if(!(N.Degree.toString()in rb.rzh))return Kd.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",N.Degree),!1;if(!N.GradientStops)return Kd.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),
!1;if(N.GradientStops.length<rb.pBi||N.GradientStops.length>rb.Yzi)return Kd.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",N.GradientStops.length),!1;N=Cl(N.GradientStops);for(var la=N.next();!la.done;la=N.next())if(!ec.isValid(la.value))return!1;return!0};rb.pBi=2;rb.Yzi=3;var X={};rb.rzh=(X["0"]=new Ya(0,0,1,0),X["180"]=new Ya(1,0,0,0),X["90"]=new Ya(0,0,0,1),X["270"]=new Ya(0,1,0,0),X["45"]=new Ya(0,0,1,1),X["225"]=new Ya(1,1,0,0),X["135"]=
new Ya(1,0,0,1),X["315"]=new Ya(0,1,1,0),X);Object(Td.a)(rb,"FillGradientExtension",null,[]);var Ba=xk.a;Am(ib,Ba);ib.prototype.WO=function(N,la){if(1===N){var Ra=vd.v(this.aDb,this.$);hg.g(this.$).Eg(Ra,null,null,null,0,uk.a.bEj)}Ra={};Ra=(Ra.DialogButton=N,Ra.Location="dialog",Ra);qg.b(this.$).Vd(Zc.a.dEj,Ra,null,!0);Ba.prototype.WO.call(this,N,la)};ib.prototype.Fr=function(){Ba.prototype.Fr.call(this);var N=this.aEj();this.jc=1;this.Bc(1,Nc.a.instance.fa(2187));this.Ak(Nc.a.instance.fa(2188),Pf.a.fg(N),
1,this.XO)};ib.prototype.aEj=function(){return String.format(Nc.a.instance.Ab(166),this.aDb.toString())};ib.prototype.tdd=function(){var N=this.error.Description.split("_");return new Nj.Range(Number.parseInvariant(N[1])+1,Number.parseInvariant(N[2])+1,Number.parseInvariant(N[3])+1,Number.parseInvariant(N[4])+1,!0,!1)};Ck.Object.defineProperties(ib.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(Td.a)(ib,"SortMergedCellsErrorDialog",xk.a,[]);
var fb=b(637),Vb=b(705),xc=Pk.a;Am(eb,xc);eb.prototype.dispose=function(){this.Egc||(this.Egc=!0,this.Z1b(),this.d7=null,cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Hcb.dispose(),this.Hcb=null));xc.prototype.dispose.call(this)};eb.prototype.qHh=function(N){var la=this;return function(Ra){if(mj.b(Ra,-901005882))Ja.a(la.$).rd.nE(-901005882),la.MGd();else if(mj.b(Ra,-569193796))Ja.a(la.$).rd.nE(-569193796),la.hide(),new ib(la.$,Ra.Errors[0]);else if(mj.a(Ra))Kd.ULS.sendTraceTag(529105665,
0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),la.hide();else{Ra=Ra.Result;la.$.Dj(Ra.SortRange);var Pb=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");Ra&&pb(Ra)&&nc(Ra)&&Pa(Ra,Pb)?N(Ra):la.c7b(eb.Hrb())}}};eb.prototype.aIh=function(N,la){var Ra=this;return function(Pb,vc){if(Ra.Egc)Kd.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");
else if(!Pb||mj.a(Pb))Kd.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Hg.a.Xc(Pb.Errors)),Ra.$.ea.Hp(Pb.Errors),Ra.hide();else{Pb=Pb.Result;var ad=N.RangeType,Fd=N.HeaderRowSize,ve=N.SortTopToBottom;Pb&&Ub(Pb,N.ConditionType)&&yd(Pb,ad,Fd,ve)?(Pb.ColumnInfo.ColumnOffset=vc,void 0!==Pb.HeaderColumnInfo&&null!==Pb.HeaderColumnInfo&&(Pb.HeaderColumnInfo.ColumnOffset=vc),la(Pb,N.ConditionType,N.SortTopToBottom)):(Kd.ULS.sendTraceTag(529105633,
0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Ra.c7b(eb.Hrb()))}}};eb.prototype.gyj=function(N){return!!this.namedSheetViewPublic&&(0===N||3===N)};eb.prototype.s7g=function(N){var la={};la.SelectedRange=this.selectedRange;la.ActiveCell=this.upc;la.SortInfoMode=N;la.ExpandSortSelection=this.LUg;la.ExpandSortSelectionSupported=!0;return la};eb.prototype.Fta=function(N){var la={};la[ag.a.ay]=this.Cc;la.fromAutoFilter=N.FromAutoFilter;
la.gridRTL=hg.g(this.$).rtl;la.activeCell=N.ActiveCell;la.selectedRange=N.SelectedRange;la.invokeGetSortInfo=this.Nei;la.invokeGetSortConditionColorsOrIcons=this.Mei;la.highlightSortRange=this.h8h;la.getColorName=this.getColorName;return la};eb.prototype.bpa=function(N,la){N=vd.D(N);this.ha.ta.ud.equals(N)||this.ha.updateSelection(N,vd.C(la),0,void 0,void 0,void 0,!0)};eb.prototype.MGd=function(){var N=this;(new Ob(function(la){var Ra={};Ra.ActiveCell=N.upc;Ra.SelectedRange=N.selectedRange;Ra.ExpandSelection=
la;Ra.FromAutoFilter=!1;la={};N.$.Zd(-207540907,Ha.a.Vb,8,(la.SortCommandData=Ra,la))})).show()};eb.prototype.Z1b=function(){if(void 0!==this.d7&&null!==this.d7)for(var N=Cl(this.d7),la=N.next();!la.done;la=N.next())this.$.na.va.qfb(la.value.Qt)};eb.PLf=function(N,la){var Ra={};N.Zd(1659552324,Ha.a.Vb,8,(Ra.CustomSortCommandData=la,Ra))};eb.Hrb=function(){return Hg.a.gd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Ck.Object.defineProperties(eb.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return hg.g(this.$).ha}}});Object(Td.a)(eb,"CustomSortDialog",Pk.a,[]);var bd=b(1249);lc.prototype.getSelection=function(){return this.selection};Object(Td.a)(lc,"MacroRecorderRangeAutoFilterClearedPayload",null,[447]);Object(Td.a)(pc,"MacroRecorderRangeFilterReappliedPayload",null,[447]);var $c=b(981),Pc=b(982),Hc=b(145),Jd=b(37);Wa.prototype.$c=function(N,la){return!this.lrd(N,la)};Wa.prototype.executeCommand=
function(N,la,Ra){var Pb=null;N=la.command;switch(N){case -864298118:Pb=this.Ghh(la,Ra);break;case -1010737776:Pb=this.C7c(!0,la,Ra);break;case 2123420468:Pb=this.C7c(!1,la,Ra);break;case -1089513346:Ra=this.zZe(Ra);if(!this.Gic([vd.D(Ra.SortOptions.SelectedRange)]))return og.TaskExtensions.Dl();Pb=this.TJe(la,Ra);break;case -207540907:case -1677817820:Pb=this.gridView.Rb.fla(this.gridView.ha.ta.activeCell)?this.V2i():this.S2i(la,Ra);break;case 1659552324:Pb=this.TJe(la,this.zZe(Ra));break;case 368460465:Pb=
this.Whh(la);break;case 529856798:Pb=this.Bhh(la);break;case 644342024:Pb=this.Rhh(la)}return Pb||vh.a(N)};Wa.prototype.Kc=function(N,la){if(N=1===N)switch(la.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;default:N=!1}return N};Wa.prototype.jd=function(){return!1};Wa.prototype.ha=function(){return this.$&&this.gridView?this.gridView.ha:null};Wa.prototype.MOf=function(N){N?
this.gridView.Nt(this.onContentReady):this.gridView.gx(this.onContentReady);this.qdf=N};Wa.prototype.mzj=function(N){return!!this.sortOptions&&Ng.a.equals(this.Pkf,N.Iia,!0)};Wa.prototype.lrd=function(N,la){var Ra=hg.g(this.$).ha.ta.selectedRanges;return(new Ek.a(this.$.xa)).Om(N,la,Ra,this.gridView)};Wa.prototype.C7c=function(N,la,Ra){var Pb={OperationType:0};Pb.IsAscending=N;Pb.HasHeader=!0;Pb.GuessHeader=!0;Pb.SortTopToBottom=!0;Pb.ExpandSortSelectionSupported=!0;Ra&&void 0!==Ra[Wa.$Sa]&&null!==
Ra[Wa.$Sa]?(Ra=Ra[Wa.$Sa],Pb.ActiveCell=Ra.ActiveCell,Pb.SelectedRange=Ra.SelectedRange,Pb.ExpandSortSelection=Ra.ExpandSelection):(Pb.ActiveCell=vd.o(this.ha().ta.activeCell,this.$),Pb.SelectedRange=vd.v(this.ha().ta.ud,this.$),Pb.ExpandSortSelection=null);return this.Gic([vd.D(Pb.SelectedRange)])?this.gridView.Rb.fla(vd.D(Pb.SelectedRange))?this.Ohh(N):this.kcf(Pb,la):og.TaskExtensions.Dl()};Wa.prototype.Ghh=function(N,la){var Ra=null,Pb=this.ha();Pb&&(this.mzj(Pb)?this.Gic(Pb.ta.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Ra=this.kcf(this.sortOptions,N)):Ra=this.C7c(!0,N,la));return Ra};Wa.prototype.Gic=function(N){return cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.Dq(N,!0,1):this.$.AXc(N,!0,1):!0};Wa.prototype.Ohh=function(N){this.LVh(N);return nh.Task.Ra(!0)};Wa.prototype.vRg=
function(N){if(cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var la=this.gridView.Rb.Qj(this.ha().ta.ud,!1);if(la){var Ra=la.name;la=la.usedRange;la=this.ha().ta.activeCell.left-la.left;return new Ah.a(Ra,la,N.IsAscending)}}return new Wk.a(N)};Wa.prototype.kcf=function(N,la){function Ra(){return Pb.vRg(N)}var Pb=this;this.gridView.rg.iH(!1);return this.T8c(function(vc,ad,Fd){return Db(Pb.$.na.va,N,th.b(vc,Pb.qTi),ad,Fd,N)},function(vc){return new Jb.a(141,
0,vc,void 0,Ra)},la,this.fyj(N))};Wa.prototype.fyj=function(N){if(!this.namedSheetViewPublic)return!1;var la=this.ha().ta.ud,Ra=vd.v(this.ha().ta.ud,this.$),Pb=this.gridView.Rb.txa(la,!0),vc=this.ha().ta.dca()&&this.gridView.Rb.Yqd(Ra),ad=this.gridView.Rb.fmi(Ra);N=cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?(la.N_||la.uW)&&!la.isSingle&&(null==N.ExpandSortSelection?!1:N.ExpandSortSelection)&&this.gridView.Rb.Yqd(Ra):!la.N_&&!la.uW||la.isSingle||null!=
N.ExpandSortSelection?N.ExpandSortSelection&&this.gridView.Rb.Yqd(Ra):!1;return Pb||vc||ad||N};Wa.prototype.V2i=function(){return this.$.Zd(-1556797033,Ha.a.Vb,8,null)};Wa.prototype.S2i=function(N,la){N=8===N.Xe&&la&&void 0!==la[Wa.$Sa]&&null!==la[Wa.$Sa]?la[Wa.$Sa]:19===N.Xe&&la&&void 0!==la[Ha.a.Ag]&&null!==la[Ha.a.Ag]?sk.a.oi(la[Ha.a.Ag]):this.t6g();if(!this.Gic([vd.D(N.SelectedRange)]))return og.TaskExtensions.Dl();hg.g(this.$).rg.iH(!1);var Ra=null;(la=la.TopCellAddress)&&(Ra=vd.o(la,this.$));
new eb(this.$,N,this.namedSheetViewPublic,Ra);return nh.Task.Ra(!0)};Wa.prototype.zZe=function(N){return N[Wa.Abh]};Wa.prototype.TJe=function(N,la){function Ra(Me){return new Jb.a(187,0,Me,void 0,Pb)}function Pb(){return new xb(la.SortOptions)}function vc(Me,fg,gh){return Db(ve.$.na.va,la.SortOptions,th.b(Me,Fd),th.a(fg,ad),gh,ve.sortOptions)}function ad(){la.ShouldRestoreSelection&&ve.bpa(la.SelectedRange,la.OriginalActiveCell);Kd.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",
N.Xe)}function Fd(Me){cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&ve.j8e(Me)?ve.X6e(Me.Errors[0]):(la.ShouldRestoreSelection&&ve.bpa(la.SelectedRange,la.OriginalActiveCell),Kd.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",N.Xe),ve.eNj(la))}var ve=this;return cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.T8c(vc,Ra,null,la.ShouldPromptNamedSheetViewTeachingDialog):
kc.a(this.$.userOperationManager,vc,Ra,null)};Wa.prototype.bpa=function(N,la){N=vd.D(N);hg.g(this.$).ha.ta.ud.equals(N)||hg.g(this.$).ha.updateSelection(N,vd.C(la),0,void 0,void 0,void 0,!0)};Wa.prototype.t6g=function(){var N={};N.ActiveCell=vd.o(this.ha().ta.activeCell,this.$);N.SelectedRange=vd.v(this.ha().ta.ud,this.$);N.FromAutoFilter=!1;N.ExpandSelection=null;return N};Wa.prototype.Whh=function(N){function la(){return new bd.a(Pb)}var Ra=this,Pb=this.Bva();if(!Pb)return nh.Task.Ra(!1);var vc=
this.$.na.va.hc();return cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,function(ad,Fd,ve){return ce.kb(Ra.$.na.va,Pb,$c.a.Xva(Hc.a.h_a,Pc.a.toggleAutoFilter,ad),Fd,ve,null,vc)},function(ad){return new Jb.a(516,0,ad,64,la)},N):kc.a(this.$.userOperationManager,function(ad,Fd,ve){return ce.kb(Ra.$.na.va,Pb,$c.a.Xva(Hc.a.h_a,Pc.a.toggleAutoFilter,ad),Fd,ve,null,vc)},function(ad){return new Ii.a(516,0,ad,void 0,la)},N)};Wa.prototype.Bhh=function(N){function la(){return new lc(Pb)}var Ra=this,Pb=
this.Bva();if(!Pb)return nh.Task.Ra(!1);var vc=this.gridView.Rb.Qj(this.ha().ta.ud,!0);vc&&Kd.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",vc.type.toString());var ad=this.$.na.va.hc();vc=cf.EwaSettings.qc()?function(Fd){return new Jb.a(517,0,Fd,64,la)}:function(Fd){return new Ii.a(517,0,Fd,void 0,la)};return this.T8c(function(Fd,ve,Me){var fg=Ra.$.na.va;Fd=$c.a.Xva(Hc.a.Gsa,Pc.a.clearAutoFilter,Fd);var gh=fg.Na(41,void 0===ad?null:ad);gh.selectedRange=Pb;return ce.i(fg,
"ClearAutoFilter",gh,Fd,ve,Me,null,0)},vc,N)};Wa.prototype.T8c=function(N,la,Ra,Pb){var vc=this;return this.namedSheetViewPublic&&(void 0===Pb||Pb)?this.namedSheetViewPublic.jBa().continueWith(function(ad){ad.result&&kc.a(vc.$.userOperationManager,N,la,Ra)}):kc.a(this.$.userOperationManager,N,la,Ra)};Wa.prototype.Rhh=function(N){function la(){return new pc(Pb)}var Ra=this,Pb=this.Bva();if(!Pb)return nh.Task.Ra(!1);var vc=this.$.na.va.hc();return cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,
function(ad,Fd,ve){return Yb(Ra.$.na.va,Pb,$c.a.Xva(Hc.a.Gsa,Pc.a.oMf,ad),Fd,ve,null,vc)},function(ad){return new Jb.a(518,0,ad,64,la)},N):kc.a(this.$.userOperationManager,function(ad,Fd,ve){return Yb(Ra.$.na.va,Pb,$c.a.Xva(Hc.a.Gsa,Pc.a.oMf,ad),Fd,ve,null,vc)},function(ad){return new Ii.a(518,0,ad,void 0,la)},N)};Wa.prototype.j8e=function(N){return mj.b(N,-569193796)};Wa.prototype.X6e=function(N){Ja.a(this.$).rd.nE(-569193796);new ib(this.$,N)};Wa.prototype.MGd=function(N){var la=this;(new Ob(function(Ra){var Pb=
{};Pb.ActiveCell=N.ActiveCell;Pb.SelectedRange=N.SelectedRange;Pb.ExpandSelection=Ra;Ra={};la.$.Zd(N.IsAscending?-1010737776:2123420468,Ha.a.Vb,8,(Ra[Wa.$Sa]=Pb,Ra))})).show()};Wa.prototype.pCj=function(){var N=this.ha();N.updateSelection(this.Yyc,N.ta.activeCell,0,void 0,void 0,void 0,!0);this.MOf(!0)};Wa.prototype.Bva=function(){var N=this.ha();if(!N)return Kd.ULS.shipAssertTag(537151573,0,!!N,"SelectionManger is null"),null;this.gridView.rg.iH(!1);return vd.v(N.ta.ud,this.$)};Wa.prototype.DKb=
function(){this.Gc&&this.Gc.Yo&&(this.$f=this.Gc.Yo,this.Db=this.Gc.lbc())};Wa.prototype.LVh=function(N){var la=this;if(this.$.isEditMode&&(this.Gc=this.gridView.Rb.lp(this.gridView.ha.ta.activeCell))){this.activeCell=vd.o(this.gridView.ha.ta.activeCell,this.$);if(this.Gc&&this.Gc.Yo){var Ra=this.Gc.Yo.CurrentCol;if(this.Gc.Yo.CurrentRow===this.activeCell.FirstRow&&Ra===this.activeCell.FirstColumn){this.DKb();this.applyPivotSort(N);return}}this.$.na.va.hc();Ra=new Jb.a(228,0,function(Pb,vc,ad){return ce.C(la.$.na.va,
la.activeCell,th.b(Pb,la.QMi),th.a(vc,la.PMi),ad,N)},16);this.$.userOperationManager.ic(Ra,null)}};Wa.prototype.applyPivotSort=function(N){var la=this;if(this.Gc&&this.Db&&this.activeCell&&this.$f){var Ra=8===this.$f.CellArea,Pb=1===this.$f.CellArea||2===this.$f.CellArea;(Ra||Pb)&&8!==this.$f.CellType&&4!==this.$f.CellType&&(Ra?kc.a(this.$.userOperationManager,function(vc,ad,Fd){return ce.e(la.$.na.va,la.activeCell,N?1:2,la.Db.Caption,vc,ad,Fd,null)},function(vc){return new Jb.a(1015,0,vc,void 0,
null)},null):(Ra=1===this.$f.CellArea?1:2,this.$.ma(705)?D.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Gc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Gc.isOlap?"":this.Db.Caption,Ra,N):D.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Gc.externalSourceIndex,this.Db.Index.toString(),N)))}};Wa.prototype.eNj=function(N){N.SortOptions.SortConditions.some(function(la){return 0===la.SortConditionType})&&(N.TopCellAddress?
N=vd.C(N.TopCellAddress):(N=N.OriginalActiveCell,N=new Nj.Range(N.FirstRow+1,N.FirstColumn+1,N.FirstRow+1,N.FirstColumn+1,!0,!1)),this.QL(N))};Wa.prototype.QL=function(N){Jd.a.$ba(this.$)&&og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(la){la.result.Oea(N);Kd.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};Wa.prototype.QXd=function(N){cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,476,475,0),function(la){la.result.QXd(N,0);Kd.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)};Wa.Abh="CustomSortCommandData";Wa.$Sa="SortCommandData";Object(Td.a)(Wa,"SortCommandHandler",null,[424]);var Qd=Ff.a;Am(Fa,Qd);Fa.prototype.Nd=function(){var N=this;og.TaskExtensions.Ba(zh.GetServiceTaskFactory.Ua(this.$.da,309,310,this.ub),function(la){N.Dd([new Wa(N.$,
la.result)])},this.$.la,3)};Fa.ka=function(N){Ff.a.he(160,new Fa(N))};Object(Td.a)(Fa,"SortCommandHandlerFactory",Ff.a,[]);sa.prototype.S$g=function(N,la){new ib(N,la)};Object(Td.a)(sa,"SortUtil",null,[915]);var Be=oh.a;Am(Oa,Be);Oa.prototype.create=function(){var N=this.$.da.Aa(446);N||(N=new sa(this.$),this.$.da.Ga(446,N));this.Eb(N)};Oa.ka=function(N){N.da.Ga(447,new Oa(N))};Object(Td.a)(Oa,"SortUtilFactory",oh.a,[]);wb.prototype.executeCommand=function(N,la,Ra){return 2!==this.Ei.Be(Zf.a.tryOfficeThroughTellMe,
2,Ra)?nh.Task.Ra(!0):vh.a(la.command)};wb.prototype.Kc=function(N,la){return 215809929===la.command};wb.prototype.jd=function(){return!1};wb.prototype.$c=function(){return!1};Object(Td.a)(wb,"TryOfficeThroughTellMeCommandHandler",null,[424]);var mf=Ff.a;Am(ob,mf);ob.prototype.Nd=function(){this.Dd([new wb(be.AFrameworkApplication.Ib)])};ob.ka=function(N){Ff.a.he(207,new ob(N))};Object(Td.a)(ob,"TryOfficeThroughTellMeCommandHandlerFactory",Ff.a,[]);var xf=b(169);gb.aN=function(){return Ag.a.hp(gb.yk,
xf.a.Wa(433))};gb.yk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(Td.a)(gb,"NamedSheetViewTeachingDialogHtml",null,[]);var lg=ag.a;Am(Na,lg);Na.prototype.jh=function(){this.jc=4;this.stopwatch=this.$.Ob.Hc("UserAction",
this.Cc);var N=Nc.a.instance.fa(1871);this.gg=gb.aN();this.fp=new Qh.a;this.initializeAndShow(N,this.eDi,{});return this.fp.task};Na.prototype.Kv=function(N){lg.prototype.Kv.call(this,N);this.Bc(1,Nc.a.instance.fa(1873));this.Bc(2,Nc.a.instance.Wa(446))};Na.prototype.o1i=function(){this.$.ea.kmc=!1};Na.prototype.jwi=function(N){var la={};la.a=this.$.ya.UserSessionId;la.b="NamedSheetViewTeachingDialogClose";la.c=N;la.e=!0;this.stopwatch&&(this.stopwatch.stop(),la.d=this.stopwatch.zc);Bj.b().Pe(53,
la,!0)};Ck.Object.defineProperties(Na.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(Td.a)(Na,"NamedSheetViewTeachingDialog",ag.a,[]);var ng=b(162);ra.prototype.jBa=function(){if(this.Hyj()){if(cf.EwaSettings.ma(589)){this.$.xa.qa.Yd.hSd=!0;var N=new Qh.a;this.$.Ka.$b(new cg.a(-2050946363,Ha.a.Vb,2,0,null)).continueWith(function(la){N.setResult(!gc.a(la)&&la.result)});return N.task}return(new Na(this.$)).jh()}return nh.Task.Ra(!0)};
ra.prototype.Hyj=function(){var N=this.$.xa.qa;return this.$.ea.K9a&&this.$.ea.kmc&&!N.Yd.ty&&this.$.ea.RM&&!ng.e(this.$)};Object(Td.a)(ra,"NamedSheetViewPublic",null,[914]);var Gh=oh.a;Am(ta,Gh);ta.prototype.create=function(){this.Eb(this.$.da.Aa(309)||new ra(this.$))};ta.ka=function(N){N.da.Ga(310,new ta(N))};Object(Td.a)(ta,"NamedSheetViewPublicFactory",oh.a,[]);var Kh=b(1379),Ih=b(1066),fj=b(627);Object(Td.a)(ac,"NamedSheetViewTeachingCalloutContent",null,[]);Ck.Object.defineProperties(kb.prototype,
{r9f:{configurable:!0,enumerable:!0,get:function(){return this.jje}},b3i:{configurable:!0,enumerable:!0,get:function(){return this.r9f<this.t9f.count?this.t9f.oa(this.jje++):null}}});Object(Td.a)(kb,"NamedSheetViewTeachingCalloutList",null,[]);var Oi=b(1250);db.prototype.pai=function(N){var la=this;this.s9f=N;var Ra=Object(eh.a)(new oa.a,{});db.Rii(N)?(Ra.add(new ac(Nc.a.instance.Wa(435),Nc.a.instance.Wa(436),Nc.a.instance.fa(1901),function(){la.iI(2,"Continue");la.XJ(!0)},Nc.a.instance.fa(1902),
function(){la.XJ();la.iI(1,"ExitGuide")},Oi.a())),1===N&&Ra.add(new ac(Nc.a.instance.fa(1903),Nc.a.instance.Wa(438),Nc.a.instance.fa(1901),function(){la.iI(2,"FirstEnterTempViewContinueSecond");la.XJ(!0)},Nc.a.instance.fa(1902),function(){la.XJ();la.iI(1,"FirstEnterTempViewExitGuideSecond")},Oi.a())),Ra.add(new ac(Nc.a.instance.Wa(439),Nc.a.instance.Wa(440),Nc.a.instance.fa(1901),function(){la.iI(2,"FirstEnterExitCalloutContinue");la.XJ(!0)},Nc.a.instance.fa(1902),function(){la.XJ();la.iI(1,"FirstEnterExitCalloutGuide")},
db.n1e())),Ra.add(new ac(Nc.a.instance.fa(1904),Nc.a.instance.Wa(437),Nc.a.instance.fa(1905),function(){la.B4f();la.XJ();la.iI(1,"LearnMore")},Nc.a.instance.fa(1906),function(){la.XJ();la.iI(1,"Done")},db.m1e()))):2===N?Ra.add(new ac(Nc.a.instance.fa(1903),Nc.a.instance.Wa(438),Nc.a.instance.fa(1900),function(){la.XJ();la.iI(1,"EnterTempViewAfterPersistedView")},null,null,Oi.a())):3===N&&(Ra.add(new ac(Nc.a.instance.Wa(435),Nc.a.instance.fa(1912),Nc.a.instance.fa(1901),function(){la.iI(2,"AutoOptInExitCalloutContinue");
la.XJ(!0)},Nc.a.instance.fa(1902),function(){la.XJ();la.iI(1,"AutoOptInExitGuide")},db.n1e())),Ra.add(new ac(Nc.a.instance.fa(1903),Nc.a.instance.Wa(438),Nc.a.instance.fa(1901),function(){la.iI(2,"Continue");la.XJ(!0)},Nc.a.instance.fa(1902),function(){la.XJ();la.iI(1,"ExitGuide")},Oi.a())),Ra.add(new ac(Nc.a.instance.fa(1904),Nc.a.instance.Wa(437),Nc.a.instance.fa(1905),function(){la.B4f();la.XJ();la.iI(1,"LearnMore")},Nc.a.instance.fa(1906),function(){la.XJ();la.iI(1,"Done")},db.m1e())));this.eWd=
new kb(Ra)};db.prototype.B4f=function(){var N=new cg.a(-859308420,Ha.a.Vb,this.$.fd,9,null),la={};la=(la[Ha.a.Ag]="HelpID=SheetViews",la.InputMethod=Ha.a.Vb,la[Ha.a.ld]=ja.a.fW,la.ShouldCanvasTakeFocus=!0,la);this.$.Ka.$b(N,la)};db.prototype.show=function(N){this.pai(N);this.$db()};db.prototype.msj=function(N){this.M_b=N};db.prototype.$db=function(){var N=this,la=this.eWd.b3i;if(la){var Ra=Object(eh.a)(new Kh.a,{label:la.A1i,onExecute:la.primaryButtonAction}),Pb=null;la.AXf&&(Pb=Object(eh.a)(new Kh.a,
{label:la.AXf,onExecute:la.secondaryButtonAction}));la=Object(eh.a)(new Ih.a,{target:la.targetObject,content:la.body,title:la.title,showCloseIcon:!0,primaryButtonProps:Ra,secondaryButtonProps:Pb,useTeachingStyles:!0});la=this.M_b.callout(la);Ra=Object(eh.a)(new fj.a,{onShow:function(){N.iI(0)}});this.pAc=this.M_b.addNotification(la,Ra);this.yXc||(this.$.Krd=!0)}};db.prototype.dismiss=function(){this.XJ();this.iI(1,"DismissedByOthers")};db.prototype.XJ=function(N){N=void 0===N?!1:N;this.pAc&&(this.yXc||
(this.$.Krd=!1),this.M_b.removeNotification(this.pAc),this.pAc=null);N&&this.$db()};db.prototype.iI=function(N,la){var Ra={};Ra.a=this.$.ya.UserSessionId;Ra.b=this.s9f;Ra.c=this.eWd.r9f;Ra.d=N;Ra.e=void 0===la?null:la;0===N?this.stopwatch=this.$.Ob.Hc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Ra.f=this.stopwatch.zc,this.stopwatch=null),2===N&&(this.stopwatch=this.$.Ob.Hc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Bj.b().Pe(52,Ra,!0)};db.m1e=
function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};db.n1e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};db.Rii=function(N){return 0===N||1===N};Object(Td.a)(db,"NamedSheetViewTeachingCallout",null,[913]);var gi=oh.a;Am(sb,gi);sb.prototype.create=function(){var N=this.$.da.Aa(322);N||(N=new db(this.$),cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ga(322,N));this.Eb(N)};sb.ka=function(N){N.da.Ga(323,
new sb(N))};Object(Td.a)(sb,"NamedSheetViewTeachingCalloutFactory",oh.a,[]);var oj=b(96),$i=b(182),Rj=b(1251),pj=b(57),mh=b(1141),ni=fh.StandardDialog;Am(Ta,ni);Ta.prototype.NQ=function(){this.jc=5;this.width=40;var N=document.createElement("span");N.id=this.pi("DirectPrintHeaderContent");var la=document.createElement("span");la.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(la,"DirectPrintHeader");this.QP=document.createElement("iframe");this.QP.name="pdfObjectFrame";
this.QP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.QP.onload=Object(af.a)(this,this.N1i,"printablePdfLoaded");if(this.DWb&&0<this.DWb.count){var Ra=Ug.a.Jgd(this.qVb,this.DWb),Pb=Ug.a.HJd(this.qVb,this.DWb);this.em=document.createElement("form");this.em.id="printPreviewPostForm";this.em.method="POST";this.em.target=this.QP.name;this.em.action=Pb;Ra=Cl(Ra);for(Pb=Ra.next();!Pb.done;Pb=Ra.next()){Pb=Pb.value;var vc=document.createElement("input");vc.type="hidden";vc.name=Pb.key;vc.value=Pb.value;
this.em.appendChild(vc)}}else this.QP.setAttribute("src",this.qVb);Sys.UI.DomElement.addCssClass(this.QP,$i.a.sde);this.tqg?(Sys.UI.DomElement.addCssClass(this.QP,"DirectPrintPdfObjectHidden"),la.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,tg.a.dh(this.QP,tg.a.qC,tg.a.yj)):(Sys.UI.DomElement.addCssClass(this.QP,"DirectPrintPdfObject"),this.fn.push(this.QP));N.appendChild(la);N.appendChild(document.createElement("br"));N.appendChild(this.QP);this.em&&N.appendChild(this.em);N.appendChild(document.createElement("br"));
N.appendChild(this.i2g(this.em?"#":this.qVb));this.umb.start();this.bDb(CommonUIStrings.l_AppTitle,null,null,null,null,N);this.IX(this.pi("DirectPrintHeaderContent"));this.em&&this.em.submit();this.h7g();Kd.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};Ta.prototype.i2g=function(N){var la=document.createElement("span"),Ra=document.createElement("span");Ra.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;la.appendChild(Ra);be.AFrameworkApplication.ga&&(2===be.AFrameworkApplication.sa.Pa.Sj&&
be.AFrameworkApplication.ga.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===be.AFrameworkApplication.sa.Pa.Sj&&be.AFrameworkApplication.ga.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(N=document.createElement("span"),2===be.AFrameworkApplication.sa.Pa.Sj?N.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===be.AFrameworkApplication.sa.Pa.Sj&&(N.innerText=CommonUIStrings.l_InternalError_Directive,Kd.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.rqa=N,la.appendChild(document.createElement("br")),la.appendChild(N)):(Ra=document.createElement("a"),Ra.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Ra.href=N,Ra.target="_blank",Ra.id="PrintPDFLink",Ra.className="AllowBrowserClick",this.rqa=Ra,la.appendChild(document.createElement("br")),la.appendChild(Ra),this.em&&Ch.a.addHandler(Ra,"click",Object(af.a)(this,this.Yoc,"onSubmit")),this.MP.pa(pg.a.click,this.rqa,Object(af.a)(this,this.tKe,"downloadPDFLinkClicked"),null));this.fn.push(this.rqa);
return la};Ta.prototype.Yoc=function(N){this.em&&(this.em.target="_blank",this.em.submit());N.preventDefault()};Ta.prototype.h7g=function(){if(0<this.fn.length){var N=new Rj.a(this.fn),la=oj.FocusManager.instance().iR();la&&(this.rqa.focus(),la.gf=N,la.a0=!0)}};Ta.prototype.tKe=function(){Kd.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};Ta.prototype.Uud=function(){Kd.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};
Ta.prototype.N1i=function(){Kd.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.umb&&this.umb.stop()};Ta.prototype.dispose=function(){this.rqa&&(this.MP.za(pg.a.click,this.rqa,Object(af.a)(this,this.tKe,"downloadPDFLinkClicked")),this.rqa=null);pj.a.P0(this.QP);this.QP=null;ni.prototype.dispose.call(this)};Object(Td.a)(Ta,"DirectPrintDialog",fh.StandardDialog,[942]);wa.prototype.FOh=function(N,la,Ra){return new Ta(this.MP,N,la,void 0===Ra?null:Ra)};Object(Td.a)(wa,"DirectPrintDialogFactory",
null,[908]);Am(qa,Wb);qa.prototype.Nmf=function(){Kd.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};qa.prototype.Pmf=function(){be.AFrameworkApplication.$m.qyb(9540);Kd.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};qa.prototype.Uud=function(){Kd.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Ck.Object.defineProperties(qa.prototype,{p$e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},OWd:{configurable:!0,enumerable:!0,
get:function(){return qa.sUa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},DOa:{configurable:!0,enumerable:!0,get:function(){return qa.sUa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},yWc:{configurable:!0,enumerable:!0,get:function(){var N=[];Array.add(N,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Wb.Pxb){var la=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==be.AFrameworkApplication.sa.Pa.JGe&&(la=be.AFrameworkApplication.sa.Pa.JGe);Array.add(N,la)}return qa.sUa?
N:null}},hkc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},gkc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},i5c:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.GIe?"UIFontDialogTextLarge":null}}});Ck.Object.defineProperties(qa,{sUa:{configurable:!0,enumerable:!0,get:function(){return!!be.AFrameworkApplication.sa&&
be.AFrameworkApplication.sa.Pa.wv&&be.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Mf.a.bD||Mf.a.xf||Mf.a.Hf||Mf.a.jNa)&&!be.AFrameworkApplication.isUnifiedHostMode&&be.AFrameworkApplication.ga.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(Td.a)(qa,"PrintDialogWithLinkToPdf",Wb,[]);Aa.d7c=",";Object(Td.a)(Aa,"DirectPrintBrsSettings",null,[]);Object(Td.a)(va,"DirectPrintProbeResults",null,[]);xa.prototype.start=function(){};xa.prototype.K3i=
function(){var N=Array(this.JC.tTa.length);if(void 0!==this.Pkb&&null!==this.Pkb)for(var la=0;la<this.JC.tTa.length;la++)N[la]=this.JC.tTa[la]in this.Pkb&&this.xrg(this.Pkb[this.JC.tTa[la]]);return N};xa.prototype.L3i=function(){for(var N=Array(this.JC.uTa.length),la=!(void 0===this.xOc||null===this.xOc),Ra=0;Ra<this.JC.uTa.length;Ra++){var Pb=this.JC.uTa[Ra];N[Ra]=la&&Pb in this.xOc?!0:this.dsg(Pb)}return N};xa.prototype.j_h=function(){for(var N=this.K3i(),la=Array(N.length),Ra=0;Ra<N.length;Ra++)la[Ra]=
N[Ra]?this.Vzh(this.Pkb[this.JC.tTa[Ra]]):null;return la};xa.prototype.Vzh=function(N){if(void 0===N||null===N)return null;N=N.enabledPlugin;return void 0===N||null===N?null:N.name};xa.prototype.yWh=function(){for(var N=this.j_h(),la=this.L3i(),Ra={},Pb={},vc=0;vc<this.JC.tTa.length;vc++)Ra[this.JC.tTa[vc]]=N[vc];for(N=0;N<this.JC.uTa.length;N++)Pb[this.JC.uTa[N]]=la[N];return new va(Ra,Pb)};xa.prototype.wzj=function(){return this.lsg||!this.JC.isEnabled||be.AFrameworkApplication.isUnifiedHostMode?
!1:this.xHj()};xa.prototype.byc=function(){if(null!=this.XXb)return this.XXb;var N=xa.Tdf(this.JC);return this.XXb=this.JC.Udf&&N||this.Pgi()};xa.prototype.Pgi=function(){return Mf.a.rp&&this.JC.Qgi&&Mf.a.pze>=this.JC.fYg?!0:!1};xa.prototype.xHj=function(){if(!this.esg(this.JC))return!1;var N=O.a.pid(this.OPc.value.s8f);N=Cl(N);for(var la=N.next();!la.done;la=N.next())if(la=la.value,void 0!==la&&null!==la)return!0;N=O.a.pid(this.OPc.value.uTa);N=Cl(N);for(la=N.next();!la.done;la=N.next())if(la.value)return!0;
return!1};xa.prototype.t6h=function(){var N=O.a.pid(this.OPc.value.s8f);N=Cl(N);for(var la=N.next();!la.done;la=N.next())if(d.a.contains(this.JC.H9h,la.value))return!0;return!1};xa.prototype.Q4f=function(N){var la=void 0===la?!1:la;var Ra=void 0===Ra?null:Ra;be.AFrameworkApplication.sa&&be.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")?this.obe(N,Ra):this.wzj()?this.Hgh(N,this.t6h()&&!la,Ra):this.obe(N,Ra)};xa.prototype.Hgh=function(N,la,Ra){Ra=void 0===Ra?null:Ra;var Pb=
this.txg.Hc("UserAction","OpenDirectPrintDialog");this.WVa.FOh(N,la,Ra).NQ();Pb.stop()};xa.mif=function(N){try{return new ActiveXObject(N),!0}catch(la){Kd.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",N)}return!1};xa.Vdf=function(N){return void 0===N||null===N?!1:!(void 0===N.enabledPlugin||null===N.enabledPlugin)};xa.create=function(N){var la=new Aa(be.AFrameworkApplication.ga.appSettings),Ra=null;try{Ra=window.navigator.mimeTypes}catch(fg){Kd.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}var Pb=null;try{Pb=window.navigator.plugins}catch(fg){Kd.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var vc=xa.Vdf,ad=xa.mif;N=N.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var Fd=be.AFrameworkApplication.sa.MD,ve=xa.nif,Me=!!be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Pa.wv&&!be.AFrameworkApplication.ga.ra("PrintDialogFallbackLinkEnabled");return new xa(la,Ra,Pb,vc,ad,N,Fd,ve,function(fg,
gh){return new qa(fg,!1,gh,!0,Me)},be.AFrameworkApplication.GMa)};xa.nif=function(N){return Mf.a.rp||Mf.a.xf&&N.fki||N.Udf&&xa.Tdf(N)?!0:!1};xa.Tdf=function(N){var la=Mf.a.ktb;if(la){var Ra=la.split(".");if(2===Ra.length)return la=parseInt(Ra[0]),Ra=parseInt(Ra[1]),la>N.Cxd||la===N.Cxd&&Ra>=N.jrf}return!1};Ck.Object.defineProperties(xa.prototype,{JC:{configurable:!0,enumerable:!0,get:function(){return this.kog}}});Object(Td.a)(xa,"DirectPrintManager",null,[907]);ka.prototype.fi=function(N){var la=
this;this.tb=N;N.register(wa,"Common.App.DirectPrint.DirectPrintDialogFactory").Ic().Oc(function(){return new wa(be.AFrameworkApplication.sa.UX)});N.register(907,"Common.App.DirectPrint.IDirectPrintManager").Ic().Oc(function(){return xa.create(la.tb)})};ka.prototype.init=function(){this.p6d=this.tb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.p6d.start()};ka.prototype.dispose=function(){};Ck.Object.defineProperties(ka.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});
Object(Td.a)(ka,"PackageManager",null,[4,5]);var Ji=b(636),Xi=Ak.a;Am(ha,Xi);ha.prototype.setFocus=function(){this.Bw.checked?ze.DOMElementExtensions.setFocus(this.Bw):ze.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Ck.Object.defineProperties(ha.prototype,{Td:{configurable:!0,enumerable:!0,get:function(){return this.DRb}}});ha.Q5b="printCurrentSelection";Object(Td.a)(ha,"BasePrintDialog",Ak.a,[]);var Lj=b(236);Am(U,ha);U.prototype.initialize=function(){Kd.ULS.sendTraceTag(537154316,
0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.obi();this.XYa(1185);this.addButton(1);ha.prototype.initialize.call(this)};U.prototype.Sha=function(){var N=this;return function(la,Ra,Pb){var vc=N.$.na.va,ad=N.Vm;la=N.Jja(la);Ra=N.dba(Ra);var Fd=N.Td,ve=vc.Na(1,null);ve.printOptions=ad;return ce.i(vc,"ValidatePrint",ve,la,Ra,Pb,Fd,0)}};U.prototype.commit=function(){this.H0g();return!0};U.prototype.Dy=function(N,la,Ra){var Pb,vc=N.Result;if(vc&&la){var ad=0,Fd=0;(null===
(Pb=vc.SelectedRanges)||void 0===Pb?0:Pb.Ranges)&&0<vc.SelectedRanges.Ranges.length&&vc.SelectedRanges.Ranges[0]&&(ad=Math.min(U.a2f(vc.SelectedRanges.Ranges[0]),65535));vc.UsedRange&&(Fd=Math.min(U.a2f(vd.j(vd.D(vc.UsedRange))),65535));Lj.h(la,ad);Lj.i(la,Fd)}this.Vm=vc;ha.prototype.Dy.call(this,N,la,Ra)};U.prototype.setFocus=function(){this.Btb.checked?ze.DOMElementExtensions.setFocus(this.Btb):ha.prototype.setFocus.call(this)};U.prototype.obi=function(){this.Qb.innerHTML=U.D0i(this.$.ea.isNamedObjectViewMode);
this.Bw=ze.DOMElementExtensions.getElementById(this.Qb,ha.Q5b);this.Btb=ze.DOMElementExtensions.getElementById(this.Qb,"printEntireItem");0!==this.Vm.Type&&this.Vm.UseSelection?(this.Bw.checked=!0,this.Btb.disabled=!this.Vm.SheetName):(this.Btb.checked=!0,this.Bw.disabled=0===this.Vm.Type||!hg.g(this.$).ha.ta.Lg)};U.prototype.H0g=function(){Kd.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var N=new Sys.StringBuilder;this.kIh(N);var la=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",
Mf.a.Hf?0:1);wh.HelperMethods.rf(N.toString(),"",la,"PrintDialog.PrintViewUrl")||Kd.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};U.prototype.kIh=function(N){var la=this.$.ya;N.append(this.$.hea+la.LayoutsRelativeUri+"/xlprintview.aspx?");sg.a.fh(N,ja.a.g3i,this.Vm.SessionId);sg.a.fh(N,ja.a.i3i,this.Bw.checked?"1":"0");if(0===this.Vm.Type)sg.a.fh(N,ja.a.d3i,this.Vm.ObjectId);else{if(!this.Vm.UsedRangeTooBig){var Ra=vd.D(this.Vm.UsedRange);
(Ra=vd.x(Ra,this.Vm.SheetName))&&sg.a.fh(N,ja.a.j3i,Ra)}1===this.Vm.Type?sg.a.fh(N,ja.a.e3i,this.Vm.ObjectId):(Ra=vd.B(this.Vm.SelectedRanges.Ranges[0]),Ra=vd.x(Ra,this.Vm.SheetName),sg.a.fh(N,ja.a.f3i,Ra))}bk.a.HZa(N,la);sg.a.fh(N,ja.a.h3i,this.Vm.Title)};U.D0i=function(N){return String.format("<div class='"+ek.a.wo+"'>{0}</div>\r\n\t<div class='"+ek.a.I9c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",
Nc.a.instance.fa(1186),ha.Q5b,Nc.a.instance.fa(1189),"printEntireItem",N?Nc.a.instance.fa(1188):Nc.a.instance.fa(1187))};U.a2f=function(N){return(N.LastColumn-N.FirstColumn+1)*(N.LastRow-N.FirstRow+1)};Ck.Object.defineProperties(U.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(Td.a)(U,"HtmlPrintDialog",ha,[]);var Bi=b(617),Lh=b(65),Th=b(1253),Yi=b(978),gj=b(306),Ki=b(1079),oi=b(936);L.prototype.getSheetName=function(){return this.sheetName};L.prototype.getPrintSettings=
function(){return this.printSettings};Object(Td.a)(L,"MacroRecorderSheetPrintSettingsSavedPayload",null,[447]);Am(H,ha);H.prototype.initialize=function(){this.b8&&cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&H.R7g(this.Qb);this.Ne?this.nCe(1E3,null):(this.fl(),this.XYa(1E3));ha.prototype.initialize.call(this)};H.prototype.dispose=function(){this.fPj();ha.prototype.dispose.call(this)};H.prototype.close=function(N){Kd.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.B0,0===N?"with":"without");this.Rkj();if(this.ys){var la=this.HNh();!this.UTd&&!this.Haa.checked&&this.$.isEditMode&&this.lkd(la)&&this.Ikj(la)}ha.prototype.close.call(this,N)};H.prototype.Sha=function(){var N=this;return function(la,Ra,Pb){return fa(N.$.na.va,N.$.xa.qa.name,N.locale,N.Jja(la),N.dba(Ra),Pb,null)}};H.prototype.Dy=function(N,la,Ra){this.ys=N.Result;this.NJb=this.ys.ScalingWidth;this.MJb=this.ys.ScalingHeight;this.Obd();this.Xai();ha.prototype.Dy.call(this,N,la,Ra)};H.prototype.fl=
function(){Kd.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.pbi();ha.prototype.fl.call(this)};H.prototype.commit=function(){this.G0g();return!0};H.prototype.setFocus=function(){this.Ne?tj.a.vBc(this.oda):this.oda.checked?ze.DOMElementExtensions.setFocus(this.oda):ha.prototype.setFocus.call(this)};H.prototype.Fci=function(){switch(this.jO.Xv){case 1:this.oda.checked=!0;break;case 0:this.Bw.disabled?this.oda.checked=!0:this.Bw.checked=
!0;break;case 2:this.Haa.checked=!0;break;default:Kd.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.jO.Xv),this.jO.Xv=1,this.oda.checked=!0}};H.prototype.Rkj=function(){this.jO.Xv=this.h_c();this.b8&&(this.jO.ignorePrintArea=this.$5a.checked)};H.prototype.Obd=function(){if(100!==this.ys.ScalingPercent||this.ys.FitToPage&&(1<this.ys.ScalingWidth||1<this.ys.ScalingHeight))this.UTd=!0,this.ys.ScalingWidth=H.A6c,this.ys.ScalingHeight=H.z6c,this.ys.ScalingPercent=
H.s6b,this.ys.FitToPage=H.t6c;this.ys.PaperSize.toString()in this.WDd||(this.UTd=!0,this.ys.PaperSize=this.ys.PaperSize===H.cOg?34:H.wsb)};H.prototype.Xai=function(){this.Nza=this.ys.IsLandscape?2:1;this.A0=this.ys.FitToPage?1===this.ys.ScalingWidth&&1===this.ys.ScalingHeight?1:this.ys.ScalingWidth||1!==this.ys.ScalingHeight?2:3:0;this.Vma=this.ys.PaperSize;this.C8c(this.Haa.checked?!0:!1);this.sPd(this.Haa.checked?!0:!1)};H.prototype.Cbi=function(){this.Yec.disabled=this.Bw.checked;this.VGb=this.$5a.checked=
this.jO.ignorePrintArea};H.prototype.v$g=function(N){this.FAa=document.createElement("select");this.FAa.style.width=224+Lh.a.hf;this.FAa.style.height=32+Lh.a.hf;this.FAa.setAttribute(ja.a.wE,"scalingElementId");this.EAa=new oi.a(this.FAa,!0);for(var la=0,Ra=H.scalingOptions.length;la<Ra;++la){var Pb=Nc.a.instance.fa(H.qlj[la]);this.EAa.tM(Pb,H.scalingOptions[la].toString(),!1)}N.appendChild(this.FAa)};H.prototype.xFe=function(N){this.vza=document.createElement("select");this.vza.style.width=224+Lh.a.hf;
this.vza.style.height=32+Lh.a.hf;this.vza.setAttribute(ja.a.wE,"paperSizeElementId");this.uza=new oi.a(this.vza,!0);for(var la=0,Ra=H.paperSizeOptions.length;la<Ra;++la){var Pb=Nc.a.instance.fa(H.mXi[la]);this.uza.tM(Pb,H.paperSizeOptions[la].toString(),!1)}N.appendChild(this.vza)};H.prototype.HNh=function(){var N={};N.IsLandscape=2===this.Nza;N.PaperSize=this.Vma;N.ScalingWidth=this.NJb;N.ScalingHeight=this.MJb;N.ScalingPercent=100;N.FitToPage=0===this.A0?!1:!0;return N};H.prototype.dIa=function(){var N=
new Sys.StringBuilder;N.append(Ki.a(this.$,"Pdf",!0));this.Nia.byc()&&sg.a.fh(N,Oe.a.ofg,"1");sg.a.fh(N,Oe.a.ZGd,""+this.j7);sg.a.fh(N,Oe.a.dLf,this.$.xa.qa.name);0===this.j7&&(sg.a.fh(N,Oe.a.cLf,this.selectedRange),sg.a.fh(N,Oe.a.XKf,this.activeCell));sg.a.fh(N,Oe.a.YKf,""+this.Nza);sg.a.fh(N,Oe.a.ZKf,""+this.Vma);sg.a.fh(N,Oe.a.bLf,""+this.A0);sg.a.fh(N,Oe.a.aLf,"1");sg.a.fh(N,Oe.a.WKf,this.VGb?"1":"0");sg.a.fh(N,Oe.a.$Kf,"1");Kd.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",
N.toString());return N.toString()};H.prototype.Qyb=function(){var N=this,la=null;Kd.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.ic(new Jb.a(223,0,function(Ra,Pb,vc){Ra=new gj.a(Ra,null,Pb,vc,null,!0,!1,"GetFileCopyFileHandler","");Ra.correlationID=Ti.a.create().toString();la=Ra;be.AFrameworkApplication.Jd.j$(N.dIa(),1,null,null,H.bbd,!1,2,N.lBd,N.kBd,la,void 0,void 0,void 0,12E4);return nh.Task.Ra(!0)},
16),null)};H.prototype.pbi=function(){Kd.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.C0i(this.Qb);this.C8c(!0);this.sPd(!0);this.Bw=ze.DOMElementExtensions.getElementById(this.Qb,ha.Q5b);this.oda=ze.DOMElementExtensions.getElementById(this.Qb,"printActiveSheet");this.Haa=ze.DOMElementExtensions.getElementById(this.Qb,"printEntireWorkbook");this.b8&&(this.Yec=ze.DOMElementExtensions.getElementById(this.Qb,"ignorePrintAreaCheckboxButtonId"),
this.$5a=new Yi.a(this.Yec));this.Cxc()&&(this.Bw.disabled=!0,this.Vm.SheetName=this.sheetName);this.Fci();this.b8&&this.Cbi();this.t9i()};H.prototype.Cxc=function(){return!!this.Vm.ObjectId||!hg.g(this.$).ha.ta.Lg};H.prototype.t9i=function(){Bi.a.instance.pa(pg.a.change,this.oda,this.X9a);Bi.a.instance.pa(pg.a.change,this.Haa,this.X9a);Bi.a.instance.pa(pg.a.change,this.Bw,this.X9a);Bi.a.instance.pa(pg.a.change,this.Nxa,this.inc);Bi.a.instance.pa(pg.a.change,this.vab,this.inc);Bi.a.instance.pa(pg.a.change,
this.vza,this.Mvf);Bi.a.instance.pa(pg.a.change,this.FAa,this.Nvf);this.b8&&this.$5a.Qnb(this.Lvf)};H.prototype.fPj=function(){Bi.a.instance.za(pg.a.change,this.oda,this.X9a);Bi.a.instance.za(pg.a.change,this.Haa,this.X9a);Bi.a.instance.za(pg.a.change,this.Bw,this.X9a);Bi.a.instance.za(pg.a.change,this.Nxa,this.inc);Bi.a.instance.za(pg.a.change,this.vab,this.inc);Bi.a.instance.za(pg.a.change,this.vza,this.Mvf);Bi.a.instance.za(pg.a.change,this.FAa,this.Nvf);this.b8&&this.$5a.Gda(this.Lvf)};H.prototype.C0i=
function(N){N.classList.add(Th.a.D1i);if(!this.Ne){document.getElementById("ewaDialogTitle").classList.add(Th.a.printDialogTitle);var la=document.getElementById("ewaDialogCloseButtonLink");la.style.top=32+Lh.a.hf;this.rtl?la.style.left=32+Lh.a.hf:la.style.right=32+Lh.a.hf}la=H.vz(Th.a.E1i);N.appendChild(la);var Ra=H.vz(Th.a.Mab,1193);Ra.style.marginBottom=12+Lh.a.hf;Ra.id="whatToPrintTitleElementId";la.appendChild(Ra);Ra=H.vz(Th.a.Lab);la.appendChild(Ra);H.Srb(Ra,this.rtl,"printActiveSheet",1197,
"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");la.appendChild(document.createElement("BR"));Ra=H.vz(Th.a.Lab);la.appendChild(Ra);H.Srb(Ra,this.rtl,"printEntireWorkbook",1190,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");la.appendChild(document.createElement("BR"));Ra=H.vz(Th.a.Lab);la.appendChild(Ra);H.Srb(Ra,this.rtl,ha.Q5b,
1189,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.b8?(Ra=H.vz(Th.a.Mab,1222),Ra.style.marginTop=24+Lh.a.hf,Ra.id="printAreaElementId",la.appendChild(Ra),cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Ra.style.marginBottom=12+Lh.a.hf,Ra=H.vz(ek.a.J9c),Ra.id="ignorePrintAreaCheckboxWarpperId",ze.DOMElementExtensions.setVisible(Ra,!0),la.appendChild(Ra),la=this.getElementById("ignorePrintAreaCheckboxButtonId"),
ze.DOMElementExtensions.setVisible(la,!0),Ra.appendChild(la),la=this.getElementById("ignorePrintAreaCheckboxLabelId"),ze.DOMElementExtensions.setVisible(la,!0),Ra.appendChild(la)):(Ra=H.vz(Th.a.Lab),la.appendChild(Ra),H.H5g(Ra,this.rtl))):(Ra=H.vz(Th.a.Mab,1195),Ra.style.marginTop=24+Lh.a.hf,Ra.id="paperSizeElementId",la.appendChild(Ra),Ra=H.vz(Th.a.iGd),this.xFe(Ra),la.appendChild(Ra));la=H.vz(Th.a.F1i);N.appendChild(la);N=H.vz(Th.a.Mab,1194);N.style.marginBottom=12+Lh.a.hf;N.id="orientationTitleElementId";
la.appendChild(N);N=H.vz(Th.a.Lab);la.appendChild(N);H.Srb(N,this.rtl,"portraitRadioButtonId",1200,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");la.appendChild(document.createElement("BR"));N=H.vz(Th.a.Lab);la.appendChild(N);H.Srb(N,this.rtl,"landscapeRadioButtonId",1199,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.b8&&(N=H.vz(Th.a.Mab,1195),N.style.marginTop=12+
Lh.a.hf,N.id="paperSizeElementId",la.appendChild(N),N=H.vz(Th.a.iGd),this.xFe(N),la.appendChild(N));N=H.vz(Th.a.Mab,1196);N.style.marginTop=(this.b8?10:74)+Lh.a.hf;N.id="scalingElementId";la.appendChild(N);N=H.vz(Th.a.iGd);this.v$g(N);la.appendChild(N);this.Ne||document.getElementById("buttonarea").classList.add(Th.a.C1i);this.Nxa=ze.DOMElementExtensions.getElementById(this.Qb,"landscapeRadioButtonId");this.vab=ze.DOMElementExtensions.getElementById(this.Qb,"portraitRadioButtonId")};H.prototype.G0g=
function(){var N=this;Kd.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.j7=this.h_c();2!==this.j7&&(this.Nza=this.Iwe(),this.uza&&(this.Vma=H.paperSizeOptions[this.uza.selectedIndex]),this.EAa&&(this.A0=H.scalingOptions[this.EAa.selectedIndex]));if(this.$.$wa&&cf.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var la=this.$.na.va.hc();this.$.userOperationManager.ic(new Jb.a(133,0,function(Ra,
Pb,vc){var ad={};ad.WhatToPrint=N.j7;ad.UseNamedAction=N.Nia.byc();ad.SelectedSheetName=N.$.xa.qa.name;ad.ActiveCell=N.activeCell;ad.SelectedRanges=[N.selectedRange];ad.IsPdfDocumentRequired=!1;ad.Orientation=N.Nza;ad.PaperSize=N.Vma;ad.Scaling=N.A0;ad.RichValuesEnabled=!0;N.b8&&(ad.IgnorePrintArea=N.VGb);return aa(N.$.na.va,ad,th.b(N.rEb,Ra),Pb,vc,la)},16),null)}else this.Qyb()};H.prototype.C8c=function(N){this.vab.disabled=N;this.Nxa.disabled=N;this.uza.ao.disabled=N;this.EAa.ao.disabled=N};H.prototype.sPd=
function(N){N?(this.Nxa.checked=!1,this.vab.checked=!1,this.uza.selectedIndex=-1,this.EAa.selectedIndex=-1):(2===this.Nza?this.Nxa.checked=!0:this.vab.checked=!0,this.uza.selectedIndex=this.WDd[this.Vma.toString()],this.EAa.selectedIndex=this.A0)};H.prototype.Ikj=function(N){var la=this;Kd.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Ra=this.$.xa.qa.name,Pb=this.$.na.va.hc();this.$.userOperationManager.ic(new Jb.a(226,
0,function(vc,ad,Fd){return na(la.$.na.va,Ra,N,vc,ad,Fd,Pb)},void 0,function(){return new L(Ra,N)}),null)};H.prototype.lkd=function(N){return this.ys.IsLandscape!==N.IsLandscape||this.ys.PaperSize!==N.PaperSize||this.ys.FitToPage!==N.FitToPage||this.ys.ScalingHeight!==N.ScalingHeight||this.ys.ScalingWidth!==N.ScalingWidth?!0:!1};H.prototype.Iwe=function(){return this.Nxa&&this.Nxa.checked?2:1};H.prototype.h_c=function(){return this.Bw.checked?0:this.oda.checked?1:this.Haa.checked?2:1};H.vz=function(N,
la){N=void 0===N?null:N;la=void 0===la?0:la;var Ra=document.createElement("div");N&&(Ra.className=N);0!==la&&(Ra.innerHTML=Nc.a.instance.fa(la));return Ra};H.R7g=function(N){var la=document.createElement("input");la.setAttribute("type","checkbox");la.className=ek.a.RNe;la.id="ignorePrintAreaCheckboxButtonId";la.setAttribute("name","ignorePrintAreaCbName");la.style.height=16+Lh.a.hf;la.style.width=16+Lh.a.hf;ze.DOMElementExtensions.setVisible(la,!1);var Ra=Nc.a.instance.fa(1222),Pb=Nc.a.instance.fa(1223);
la.setAttribute(ja.a.Pt,Ra+Lh.a.space+Pb);N.appendChild(la);la=document.createElement("label");la.setAttribute("for","ignorePrintAreaCheckboxButtonId");la.id="ignorePrintAreaCheckboxLabelId";la.innerHTML=Pb;la.setAttribute(ja.a.bQ,"true");la.style.position="relative";la.style.marginLeft=15+Lh.a.hf;ze.DOMElementExtensions.setVisible(la,!1);N.appendChild(la)};H.H5g=function(N,la){var Ra=document.createElement("input");Ra.setAttribute("type","checkbox");Ra.id="ignorePrintAreaCheckboxButtonId";Ra.setAttribute("name",
"ignorePrintAreaCbName");Ra.setAttribute(ja.a.wE,"printAreaElementId"+Lh.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Ra.style.height=16+Lh.a.hf;Ra.style.width=16+Lh.a.hf;la?Ra.style.marginRight=0+Lh.a.hf:Ra.style.marginLeft=0+Lh.a.hf;N.appendChild(Ra);la=document.createElement("label");la.setAttribute("for","ignorePrintAreaCheckboxButtonId");la.setAttribute(ja.a.bQ,"true");la.style.position="relative";la.style.marginLeft=15+Lh.a.hf;N.appendChild(la);N=H.vz(Th.a.LJf,1223);N.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";
la.appendChild(N)};H.Srb=function(N,la,Ra,Pb,vc,ad,Fd,ve){var Me=document.createElement("input");Me.setAttribute("type","radio");Me.id=Ra;Me.setAttribute("name",vc);Me.setAttribute(ja.a.wE,ve+Lh.a.space+Fd);Me.style.height=16+Lh.a.hf;Me.style.width=16+Lh.a.hf;la?Me.style.marginRight=0+Lh.a.hf:Me.style.marginLeft=0+Lh.a.hf;N.appendChild(Me);la=document.createElement("label");la.setAttribute("for",Ra);la.style.position="relative";N.appendChild(la);N=tf.createClusteredImage(32,32,ad,Th.a.M1i,!0,Nc.a.instance.fa(Pb));
Pb=H.vz(Th.a.LJf,Pb);Pb.id=Fd;Pb.setAttribute(ja.a.bQ,"true");Fd=H.vz(Th.a.L1i);Fd.appendChild(Pb);la.appendChild(Fd);la.appendChild(N)};Ck.Object.defineProperties(H.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});H.A6c=1;H.z6c=0;H.s6b=100;H.wsb=9;H.t6c=!0;H.cOg=13;H.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];H.mXi=[1202,1203,1210,1204,1205,1206,1207,1208,1201,1211,1212,1213,1214,1215,1216,1217];H.scalingOptions=[0,1,2,3];H.qlj=[1218,1219,1220,
1221];H.bbd=["Content-Type"];Object(Td.a)(H,"PdfPrintDialog",ha,[]);Ck.Object.defineProperties(I.prototype,{Xv:{configurable:!0,enumerable:!0,get:function(){return this.j7},set:function(N){0<=N&&2>=N?this.j7=N:(Kd.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.j7=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.j9d},set:function(N){N||!N?this.j9d=N:Kd.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});
Object(Td.a)(I,"PdfPrintDialogBrowserSessionState",null,[]);var fk=b(1430);Object(Td.a)(ca,"MacroRecorderPrintAreaSetPayload",null,[447]);Object(Td.a)(Z,"MacroRecorderPageBreakInsertedPayload",null,[447]);Object(Td.a)(ea,"MacroRecorderPageBreakRemovedPayload",null,[447]);Q.prototype.getSheetName=function(){return this.sheetName};Object(Td.a)(Q,"MacroRecorderPageBreaksAllResetPayload",null,[447]);R.prototype.getSheetName=function(){return this.sheetName};Object(Td.a)(R,"MacroRecorderPrintAreaClearedPayload",
null,[447]);var Dh=b(168),jk=b(294);Object(Td.a)(T,"PageBreaksInformation",null,[]);Object(Td.a)(M,"RowColBreak",null,[]);Object(Td.a)(A,"SharedRange",null,[]);var ak=b(170);C.prototype.executeCommand=function(N,la,Ra,Pb,vc,ad,Fd){vc=void 0===vc?null:vc;ad=void 0===ad?null:ad;Fd=void 0===Fd?null:Fd;this.PXd();this.ribbonCommandInfo=la;this.aFj(la.command);N=th.b(vc,this.VMj);Kd.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",la.command);switch(la.command){case 78661008:return this.n7e(la,
N,ad,Fd,!1);case 275604654:return this.n7e(la,N,ad,Fd,!0);case -13332329:return this.o6e(la,N,ad,Fd);case -837651977:return this.p4h(la,N,ad,Fd);case -1778266776:return this.i5h(la,N,ad,Fd);case 845325699:return this.i7e(la,N,ad,Fd)}return vh.a(la.command)};C.prototype.Kc=function(N,la){switch(la.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===N;case 845325699:case -13332329:return!0}return!1};C.prototype.w0f=function(N,la,Ra){var Pb=hg.g(this.$),vc=Pb.Ea,ad=vd.r(Pb.ha.ta.selectedRanges,
this.$);if((vc=vc.kF())&&vc.length){vc=Cl(vc);for(var Fd=vc.next();!Fd.done;Fd=vc.next()){Fd=Fd.value;var ve=Fd.Ff;if(ve){for(var Me=vd.j(Fd.uf),fg=[],gh=Cl(ad.Ranges),Wh=gh.next();!Wh.done;Wh=gh.next()){var Ci=Wh.value;Ci.FirstRow>Me.LastRow+1||Ci.LastRow<Me.FirstRow||Ci.FirstColumn>Me.LastColumn+1||Ci.LastColumn<Me.FirstColumn||(Wh=this.nWh(Me,Ci,ve),Ci=this.mWh(Me,Ci,ve),fg.push(Object(eh.a)(new A,{FirstRow:Wh.FirstRow,FirstColumn:Ci.FirstColumn,LastRow:Wh.LastRow,LastColumn:Ci.LastColumn})))}0<
fg.length&&!Ra?ve.setPrintArea(fg):0<fg.length&&Ra?ve.addToPrintArea(fg):!Ra&&ve.hasPrintArea()&&ve.clearPrintArea();!ve.isDirty()&&ve.hasPageLayout()&&ve.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Fd.ae,4)}}this.VNb(Pb,N,la)}};C.prototype.bZg=function(N,la){var Ra=hg.g(this.$),Pb=hg.g(this.$).Ea.kF();if(Pb&&Pb.length){Pb=Cl(Pb);for(var vc=Pb.next();!vc.done;vc=Pb.next()){vc=vc.value;var ad=vc.Ff;ad&&(ad.clearPrintArea(),!ad.isDirty()&&ad.hasPageLayout()&&ad.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+
vc.ae,4))}this.VNb(Ra,N,la)}};C.prototype.mdi=function(N,la){var Ra=hg.g(this.$),Pb=Ra.Ea,vc=vd.o(Ra.ha.ta.activeCell,this.$);if(vc){var ad=Pb.kF();if(ad&&ad.length){Pb=null;for(var Fd=Cl(ad),ve=Fd.next();!ve.done;ve=Fd.next()){ve=ve.value;var Me=ve.Ff;if(Me){var fg=vd.j(ve.uf);if(!(vc.FirstRow>fg.LastRow||vc.FirstRow<fg.FirstRow||vc.FirstColumn>fg.LastColumn||vc.FirstColumn<fg.FirstColumn)&&(Pb=this.d9g(Me,fg,vc),Me.insertPageBreak(Pb),!Me.isDirty()&&Me.hasPageLayout()&&Me.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+
ve.ae,4),Pb))break}}if(!Pb)for(ad=Cl(ad),ve=ad.next();!ve.done;ve=ad.next())if(Pb=ve.value,Fd=Pb.Ff)Pb=vd.j(Pb.uf),Pb=this.wFe(Fd,Pb,vc),Fd.insertPageBreak(Pb);this.VNb(Ra,N,la)}}};C.prototype.Jaj=function(N,la){var Ra=hg.g(this.$),Pb=Ra.Ea,vc=vd.o(Ra.ha.ta.activeCell,this.$);if(vc&&(Pb=Pb.kF())&&Pb.length){Pb=Cl(Pb);for(var ad=Pb.next();!ad.done;ad=Pb.next()){ad=ad.value;var Fd=ad.Ff;if(Fd){var ve=vd.j(ad.uf);(ve=this.wFe(Fd,ve,vc))&&Fd.removePageBreak(ve);!Fd.isDirty()&&Fd.hasPageLayout()&&Fd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
ad.ae,4)}}this.VNb(Ra,N,la)}};C.prototype.Ggj=function(N,la){var Ra=hg.g(this.$),Pb=Ra.Ea.kF();if(Pb&&Pb.length){Pb=Cl(Pb);for(var vc=Pb.next();!vc.done;vc=Pb.next()){vc=vc.value;var ad=vc.Ff;ad&&(ad.resetAllPageBreak(),!ad.isDirty()&&ad.hasPageLayout()&&ad.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+vc.ae,4))}this.VNb(Ra,N,la)}};C.prototype.n7e=function(N,la,Ra,Pb,vc){if(!vc){var ad=this.$.Hb.getItemByName("PRINT_AREA");if(ad&&(Kd.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
ad.type),2===ad.type))return this.Tei(),nh.Task.Ra(!0)}ad=hg.g(this.$).ha.ta;var Fd=vd.r(ad.selectedRanges,this.$);if(1===Fd.Ranges.length&&!vc){if(ad.dca())return this.x5h(N,Fd,la,Ra,Pb,vc),nh.Task.Ra(!0);if(vd.R(Fd.Ranges[0]))return this.$.xa.qa.hasPrintArea?this.o6e(N,la,Ra,Pb):nh.Task.Ra(!0)}this.w0f(N.command,Pb,vc);return this.jcf(N,la,Ra,Fd,vc)};C.prototype.o6e=function(N,la,Ra,Pb){this.bZg(N.command,Pb);return this.Fei(N,la,Ra)};C.prototype.p4h=function(N,la,Ra,Pb){this.mdi(N.command,Pb);
return this.Qei(N,la,Ra)};C.prototype.i5h=function(N,la,Ra,Pb){var vc=vd.r(hg.g(this.$).ha.ta.selectedRanges,this.$);if(vd.R(vc.Ranges[0]))return this.i7e(N,la,Ra,Pb);this.Jaj(N.command,Pb);return this.Uei(N,la,Ra)};C.prototype.i7e=function(N,la,Ra,Pb){this.Ggj(N.command,Pb);return this.Xei(N,la,Ra)};C.prototype.jcf=function(N,la,Ra,Pb,vc){function ad(){return new ca(Pb,vc)}function Fd(Me,fg,gh){Me=th.b(Me,la);fg=th.a(fg,Ra);var Wh=ve.Na(1,null);Wh.selectedRanges=Pb;Wh.addToPrintArea=vc;return ce.i(ve,
"SetPrintArea",Wh,Me,fg,gh,null,0)}var ve=this.$.na.va;return cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,Fd,function(Me){return new Jb.a(241,0,Me,64,ad)},N):kc.a(this.$.userOperationManager,Fd,function(Me){return new Ii.a(241,0,Me,void 0,ad)},N)};C.prototype.Fei=function(N,la,Ra){function Pb(){return new R(ad)}function vc(ve,Me,fg){ve=th.b(ve,la);Me=th.a(Me,Ra);var gh=Fd.Na(1,null);gh.sheetName=ad;return ce.i(Fd,"ClearPrintArea",gh,ve,Me,fg,null,0)}var ad=this.$.xa.qa.name,Fd=this.$.na.va;
return cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,vc,function(ve){return new Jb.a(243,0,ve,64,Pb)},N):kc.a(this.$.userOperationManager,vc,function(ve){return new Ii.a(243,0,ve,void 0,Pb)},N)};C.prototype.Qei=function(N,la,Ra){function Pb(){return new Z(ve)}function vc(Me,fg,gh){var Wh=ad.$.na.va;Me=th.b(Me,la);fg=th.a(fg,Ra);var Ci=Wh.Na(9,null);Ci.sheetCell=ve;return ce.i(Wh,"InsertPageBreak",Ci,Me,fg,gh,null,0)}var ad=this,Fd=hg.g(this.$),ve=vd.o(Fd.ha.ta.activeCell,this.$);return cf.EwaSettings.qc()?
kc.a(this.$.userOperationManager,vc,function(Me){return new Jb.a(244,0,Me,64,Pb)},N):kc.a(this.$.userOperationManager,vc,function(Me){return new Ii.a(244,0,Me,void 0,Pb)},N)};C.prototype.Uei=function(N,la,Ra){function Pb(){return new ea(ve)}function vc(Me,fg,gh){var Wh=ad.$.na.va;Me=th.b(Me,la);fg=th.a(fg,Ra);var Ci=Wh.Na(9,null);Ci.sheetCell=ve;return ce.i(Wh,"RemovePageBreak",Ci,Me,fg,gh,null,0)}var ad=this,Fd=hg.g(this.$),ve=vd.o(Fd.ha.ta.activeCell,this.$);return cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,
vc,function(Me){return new Jb.a(245,0,Me,64,Pb)},N):kc.a(this.$.userOperationManager,vc,function(Me){return new Ii.a(245,0,Me,void 0,Pb)},N)};C.prototype.Xei=function(N,la,Ra){function Pb(){return new Q(Fd)}function vc(ve,Me,fg){var gh=ad.$.na.va;ve=th.b(ve,la);Me=th.a(Me,Ra);var Wh=gh.Na(9,null);Wh.sheetName=Fd;return ce.i(gh,"ResetAllPageBreaks",Wh,ve,Me,fg,null,0)}var ad=this,Fd=this.$.xa.qa.name;return cf.EwaSettings.qc()?kc.a(this.$.userOperationManager,vc,function(ve){return new Jb.a(246,0,
ve,64,Pb)},N):kc.a(this.$.userOperationManager,vc,function(ve){return new Ii.a(246,0,ve,void 0,Pb)},N)};C.prototype.nWh=function(N,la,Ra){if(!N||!la||!Ra)return null;var Pb=new A;Pb.FirstRow=la.FirstRow===N.LastRow+1?Ra.getRowIndex(N.LastRow+1)+1:la.FirstRow<N.FirstRow?0:Ra.getRowIndex(la.FirstRow+1);Pb.LastRow=la.FirstRow===N.LastRow+1||la.LastRow>N.LastRow?Ra.getRowIndex(N.LastRow+1)+1:Ra.getRowIndex(la.LastRow+1);return Pb};C.prototype.mWh=function(N,la,Ra){if(!N||!la||!Ra)return null;var Pb=new A;
Pb.FirstColumn=la.FirstColumn===N.LastColumn+1?Ra.getColumnIndex(N.LastColumn+1)+1:la.FirstColumn<N.FirstColumn?0:Ra.getColumnIndex(la.FirstColumn+1);Pb.LastColumn=la.FirstColumn===N.LastColumn+1||la.LastColumn>N.LastColumn?Ra.getColumnIndex(N.LastColumn+1)+1:Ra.getColumnIndex(la.LastColumn+1);return Pb};C.prototype.d9g=function(N,la,Ra){if(!la||!Ra||!N)return null;var Pb=N.getPrintArea();if(!Pb||!Pb.length)return null;var vc=N.getRowIndex(Ra.FirstRow+1),ad=N.getColumnIndex(Ra.FirstColumn+1),Fd=null,
ve=null;Pb=Cl(Pb);for(var Me=Pb.next();!Me.done;Me=Pb.next())if(Me=Me.value,vc>=Me.FirstRow&&vc<=Me.LastRow&&ad>=Me.FirstColumn&&ad<=Me.LastColumn){if(Ra.FirstRow===Me.FirstRow&&Ra.FirstColumn===Me.FirstColumn)return new T;vc>Me.FirstRow&&(Fd=Object(eh.a)(new M,{Index:vc-1,Min:Me.FirstColumn-1,Max:Math.min(Me.LastColumn,N.getColumnIndex(la.LastColumn+1))}));ad>Me.FirstColumn&&(ve=Object(eh.a)(new M,{Index:ad-1,Min:Me.FirstRow-1,Max:Math.min(Me.LastRow,N.getRowIndex(la.LastRow+1))}));break}return Fd||
ve?Object(eh.a)(new T,{Row:Fd?[Fd]:null,Col:ve?[ve]:null}):null};C.prototype.r$g=function(N,la,Ra){if(!la||!Ra||!N)return null;var Pb=null;Ra.FirstRow>la.FirstRow&&Ra.FirstRow<=la.LastRow?Pb=Object(eh.a)(new M,{Index:N.getRowIndex(Ra.FirstRow+1)-1,Min:-1,Max:-1}):Ra.FirstRow===la.LastRow+1&&(Pb=Object(eh.a)(new M,{Index:N.getRowIndex(la.LastRow+1),Min:-1,Max:-1}));return Pb};C.prototype.N5g=function(N,la,Ra){if(!la||!Ra||!N)return null;var Pb=null;Ra.FirstColumn>la.FirstColumn&&Ra.FirstColumn<=la.LastColumn?
Pb=Object(eh.a)(new M,{Index:N.getColumnIndex(Ra.FirstColumn+1)-1,Min:-1,Max:-1}):Ra.FirstColumn===la.LastColumn+1&&(Pb=Object(eh.a)(new M,{Index:N.getColumnIndex(la.LastColumn+1),Min:-1,Max:-1}));return Pb};C.prototype.wFe=function(N,la,Ra){if(!Ra||!N||!la)return null;var Pb=this.r$g(N,la,Ra);N=this.N5g(N,la,Ra);return Pb||N?Object(eh.a)(new T,{Row:Pb?[Pb]:null,Col:N?[N]:null}):null};C.prototype.Tei=function(){var N=new fh.StandardDialog;N.jc=0;N.Bc(1,Nc.a.instance.fa(4));N.Ak(Nc.a.instance.fa(568),
Nc.a.instance.fa(569),1,null)};C.prototype.aFj=function(N){if(this.dwa.xb(N)&&(wh.HelperMethods.I_&&(this.MFb=this.$.Ob.Hc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.lLa.xb(N)&&this.lLa.remove(N),this.lLa.add(N,Ti.a.create().toString()),hg.g(this.$).Ki)){var la=Bj.b()?Bj.b().ti(N):"";hg.g(this.$).Ki.e8(this.dwa.oa(N),this.lLa.oa(N),la)}};C.prototype.jXg=function(N){if(this.MFb&&N){var la=this.MFb.zc;this.MFb.stop();this.MFb=null;switch(N){case "SetPrintArea":this.wqb(la,1700,N);break;
case "ClearPrintArea":this.wqb(la,1500,N);break;case "InsertPageBreak":this.wqb(la,1500,N);break;case "RemovePageBreak":this.wqb(la,1600,N);break;case "ResetAllPageBreaks":this.wqb(la,1700,N)}}};C.prototype.wqb=function(N,la,Ra){N>la&&(la=Object(eh.a)(new jk.a,{extendedProperties:new Map}),la.extendedProperties.set("OperationName",Ra),la.extendedProperties.set("OperationExecutionTime",N.toString()),$g.Health.instance.recordQosError(Dh.a.MDj,[Hc.a.HDj],!1,!0,!0,!1,la))};C.prototype.x5h=function(N,
la,Ra,Pb,vc,ad){var Fd=this,ve=new fh.StandardDialog,Me=new fk.a(Nc.a.instance.fa(566),Nc.a.instance.fa(567),Nc.a.instance.fa(6),Nc.a.instance.fa(5));ve.jc=1;ve.Bc(1,Me.confirmButton);ve.Bc(0,Me.cancelButton);ve.Ak(Me.title,Me.body,3,function(fg){1===fg&&(Fd.w0f(N.command,vc,ad),Fd.jcf(N,Ra,Pb,la,ad))})};C.prototype.VNb=function(N,la,Ra){Ra();this.lLa.xb(la)&&N.Ki.o1(this.lLa.oa(la),Rk.BasicTelemetryCalculator.wR)};C.prototype.PXd=function(){this.Rqd&&this.$.Zd(-1753588160,-1,0,null)};Object(Td.a)(C,
"PrintAreaBreakManager",null,[983]);var jl=b(409);v.prototype.equals=function(N){return N?this.orientation===N.orientation&&this.Zca===N.Zca&&this.Y0===N.Y0&&this.margin===N.margin&&this.sheetPrintOptions===N.sheetPrintOptions&&this.g2a===N.g2a&&this.NoColor===N.NoColor:!1};v.xDe=function(N,la){N&&la&&(la.Xv=N.Xv,la.orientation=N.orientation,la.Zca=N.Zca,la.Y0=N.Y0,la.margin=N.margin,la.ignorePrintArea=N.ignorePrintArea,la.sheetPrintOptions=N.sheetPrintOptions,la.g2a=N.g2a,la.NoColor=N.NoColor)};
Object(Td.a)(v,"PrintSettingsContainer",null,[]);var Gk=b(158),xj=b(357),hj=b(1022),gk=b(989),Vi=b(736);Object(Td.a)(B,"PrintSettingMarginOption",null,[]);Object(Td.a)(u,"PrintSettingMarginValue",null,[]);Object(Td.a)(t,"PrintSettingOption",null,[]);x.prototype.dispose=function(){};x.prototype.Awb=function(N){if(!N)return null;var la=new u;la.left=N.Left;la.right=N.Right;la.top=N.Top;la.bottom=N.Bottom;la.header=N.Header;la.footer=N.Footer;return la};x.prototype.I4c=function(N){Kd.ULS.shipAssertTag(537154186,
0,6===N.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var la={};la.Top=N[0];la.Bottom=N[1];la.Left=N[2];la.Right=N[3];la.Header=N[4];la.Footer=N[5];return la};x.prototype.$bi=function(){this.Ake=[Object(eh.a)(new t,{printSettingOptionKey:1,printSettingOptionText:this.Zm.fa(1197)}),Object(eh.a)(new t,{printSettingOptionKey:2,printSettingOptionText:this.Zm.fa(1190)}),Object(eh.a)(new t,{printSettingOptionKey:0,printSettingOptionText:this.Zm.fa(1189)})];
this.Xde=[Object(eh.a)(new t,{printSettingOptionKey:1,printSettingOptionText:this.Zm.fa(1200)}),Object(eh.a)(new t,{printSettingOptionKey:2,printSettingOptionText:this.Zm.fa(1199)})];this.nee=[Object(eh.a)(new t,{printSettingOptionKey:1,printSettingOptionText:this.Zm.fa(1202)}),Object(eh.a)(new t,{printSettingOptionKey:5,printSettingOptionText:this.Zm.fa(1203)}),Object(eh.a)(new t,{printSettingOptionKey:6,printSettingOptionText:this.Zm.fa(1210)}),Object(eh.a)(new t,{printSettingOptionKey:7,printSettingOptionText:this.Zm.fa(1204)}),
Object(eh.a)(new t,{printSettingOptionKey:8,printSettingOptionText:this.Zm.fa(1205)}),Object(eh.a)(new t,{printSettingOptionKey:9,printSettingOptionText:this.Zm.fa(1206)}),Object(eh.a)(new t,{printSettingOptionKey:11,printSettingOptionText:this.Zm.fa(1207)}),Object(eh.a)(new t,{printSettingOptionKey:12,printSettingOptionText:this.Zm.fa(1208)}),Object(eh.a)(new t,{printSettingOptionKey:13,printSettingOptionText:this.Zm.fa(1209)}),Object(eh.a)(new t,{printSettingOptionKey:3,printSettingOptionText:this.Zm.fa(1201)})];
this.Tge=[Object(eh.a)(new t,{printSettingOptionKey:0,printSettingOptionText:this.Zm.fa(1218)}),Object(eh.a)(new t,{printSettingOptionKey:1,printSettingOptionText:this.Zm.fa(1219)}),Object(eh.a)(new t,{printSettingOptionKey:2,printSettingOptionText:this.Zm.fa(1220)}),Object(eh.a)(new t,{printSettingOptionKey:3,printSettingOptionText:this.Zm.fa(1221)})];this.$be=[Object(eh.a)(new B,{printSettingOption:Object(eh.a)(new t,{printSettingOptionKey:0,printSettingOptionText:this.Zm.fa(1224)}),marginValue:this.Awb(this.normal)}),
Object(eh.a)(new B,{printSettingOption:Object(eh.a)(new t,{printSettingOptionKey:1,printSettingOptionText:this.Zm.fa(1225)}),marginValue:this.Awb(this.wide)}),Object(eh.a)(new B,{printSettingOption:Object(eh.a)(new t,{printSettingOptionKey:2,printSettingOptionText:this.Zm.fa(1226)}),marginValue:this.Awb(this.narrow)}),Object(eh.a)(new B,{printSettingOption:Object(eh.a)(new t,{printSettingOptionKey:3,printSettingOptionText:this.Zm.fa(1227)}),marginValue:this.Awb(this.i7)})]};x.prototype.Sbi=function(){this.normal=
this.I4c(this.wEi);this.narrow=this.I4c(this.jDi);this.wide=this.I4c(this.QXj)};Ck.Object.defineProperties(x.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Ake}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.Xde}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.nee}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.Tge}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.$be}}});
x.tdh=1;x.gdh=1;x.wsb=9;x.ldh=2;x.edh=0;x.Ych=!1;x.Uch=!1;x.DIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(Td.a)(x,"PrintSettingsManagerBase",null,[2]);var Sj=b(125);r.prototype.getSheetName=function(){return this.sheetName};Object(Td.a)(r,"MacroRecorderSheetPrintOptionsSavedPayload",null,[447]);Am(y,x);y.prototype.Kei=function(N){var la=this;this.Lei(function(Ra){N&&(Ra=la.sWh(Ra),N(Ra))})};y.prototype.sNd=function(N,la){if(N){var Ra=new I(N.Xv,N.ignorePrintArea);
this.Hkj(Ra);!la||this.R5f?Kd.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",la?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(la=this.uWh(N.Y0),la.IsLandscape=2===N.orientation,la.PaperSize=N.Zca,this.isUniversalPrintEnabled&&(la.NoColor=N.NoColor),la.PageMargin=this.Tgd(N.margin),la.SheetPrintOptions=x.DIa,la.SheetPrintOptions.PrintGrid=N.sheetPrintOptions.PrintGrid,la.SheetPrintOptions.HorizontalCenter=
N.sheetPrintOptions.HorizontalCenter,la.SheetPrintOptions.VerticalCenter=N.sheetPrintOptions.VerticalCenter,la.SheetPrintOptions.PrintHeaders=N.sheetPrintOptions.PrintHeaders,this.Gkj(la))}else Kd.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};y.prototype.Tgd=function(N){var la={};0===N?la=this.normal:1===N?la=this.wide:2===N?la=this.narrow:3===N&&(la=this.i7);return la};y.prototype.afi=function(N){var la=this;if(N){Kd.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Ra=function(){return new r(la.$.xa.qa.name,N)},Pb=this.$.na.va,vc=this.$.na.va.hc(),ad=function(Fd,ve,Me){var fg=la.$.xa.qa.name;Fd=th.b(la.rCd,Fd);ve=th.a(la.DCd,ve);var gh=Pb.Na(1,null);gh.sheetName=fg;gh.printOptions=N;return ce.i(Pb,"SetPrintOptions",gh,Fd,ve,Me,vc,0)};Ra=cf.EwaSettings.qc()?new Jb.a(598,0,ad,64,Ra):new Ii.a(598,0,ad,void 0,Ra);this.$.userOperationManager.ic(Ra,null)}else Kd.ULS.sendTraceTag(537154198,
0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};y.prototype.dispose=function(){this.Od||(this.Od=!0,this.$.userOperationManager.Cr(this.PF),this.TY())};y.prototype.Hkj=function(N){this.jO.Xv=N.Xv;this.jO.ignorePrintArea=N.ignorePrintArea};y.prototype.Lei=function(N){function la(ve,Me,fg){return fa(vc.$.na.va,vc.sheetName,vc.locale,th.b(ve,Pb),th.a(Me,Ra),fg,ad)}function Ra(ve){ve=bk.a.pg(ve.data);Kd.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",
Hg.a.Xc(ve));N(null)}function Pb(ve){mj.a(ve)?Kd.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Hg.a.Xc(ve.Errors)):(Kd.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),N(ve.Result))}var vc=this,ad=this.$.na.va.hc();var Fd=cf.EwaSettings.qc()?new Jb.a(247,0,la,80):new Ii.a(247,0,la,16);Fd=this.$.userOperationManager.ic(Fd,null);this.Bv.add(Fd)};y.prototype.Gkj=
function(N){var la=this;Kd.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Ra=this.$.na.va.hc();this.$.userOperationManager.ic(new Jb.a(226,0,function(Pb,vc,ad){return na(la.$.na.va,la.sheetName,N,th.b(Pb,la.$Ri),th.a(vc,la.ZRi),ad,Ra)},void 0,function(){return new L(la.sheetName,N)}),null)};y.prototype.Wli=function(N){return this.Adf(N)||!this.Bgf(N.PaperSize)};y.prototype.Obd=function(N){this.Adf(N)&&(Kd.ULS.sendTraceTag(537154192,
0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),N.ScalingWidth=y.A6c,N.ScalingHeight=y.z6c,N.ScalingPercent=y.s6b,N.FitToPage=y.t6c);this.Bgf(N.PaperSize)||(Kd.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",N.PaperSize.toString()),N.PaperSize=y.wsb);return N};y.prototype.qWh=function(N){if(N.FitToPage){if(1===N.ScalingWidth&&1===N.ScalingHeight)return 1;
if(!N.ScalingWidth&&1===N.ScalingHeight)return 3}else return 0;return 2};y.prototype.pWh=function(N){return this.Bqd(N,this.normal)?0:this.Bqd(N,this.wide)?1:this.Bqd(N,this.narrow)?2:3};y.prototype.Bqd=function(N,la){return N.Left===la.Left&&N.Right===la.Right&&N.Top===la.Top&&N.Bottom===la.Bottom&&N.Header===la.Header&&N.Footer===la.Footer};y.prototype.uWh=function(N){var la={};la.ScalingPercent=y.s6b;la.FitToPage=0!==N;2===N?(la.ScalingWidth=1,la.ScalingHeight=0):3===N?(la.ScalingWidth=0,la.ScalingHeight=
1):1===N&&(la.ScalingWidth=1,la.ScalingHeight=1);return la};y.prototype.Bgf=function(N){return this.lXi.contains(N.toString())};y.prototype.Adf=function(N){return 100!==N.ScalingPercent||N.FitToPage&&(1<N.ScalingWidth||1<N.ScalingHeight)};y.prototype.E3g=function(){for(var N=new Vi.a(Ga.a.Pk()),la=0;la<this.paperSizeOptions.length;la++)N.add(this.paperSizeOptions[la].printSettingOptionKey.toString());return N};y.prototype.sWh=function(N){var la=null;if(N){var Ra=this.jO.Xv,Pb=this.jO.ignorePrintArea;
this.Wli(N)&&(this.R5f=!0,N=this.Obd(N));la=new v;la.Xv=Ra;la.ignorePrintArea=Pb;la.orientation=N.IsLandscape?2:1;la.Zca=N.PaperSize;la.Y0=this.qWh(N);la.sheetPrintOptions=x.DIa;la.sheetPrintOptions.PrintGrid=N.SheetPrintOptions.PrintGrid;la.g2a=N.Draft;this.isUniversalPrintEnabled&&(la.NoColor=N.NoColor);la.sheetPrintOptions.HorizontalCenter=N.SheetPrintOptions.HorizontalCenter;la.sheetPrintOptions.VerticalCenter=N.SheetPrintOptions.VerticalCenter;la.sheetPrintOptions.PrintHeaders=N.SheetPrintOptions.PrintHeaders;
la.margin=this.pWh(N.PageMargin);cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&Kd.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",la.margin);3===la.margin&&(this.i7={},this.i7.Left=N.PageMargin.Left,this.i7.Right=N.PageMargin.Right,this.i7.Top=N.PageMargin.Top,this.i7.Bottom=N.PageMargin.Bottom,this.i7.Header=N.PageMargin.Header,this.i7.Footer=N.PageMargin.Footer)}return la};y.prototype.TY=function(){if(this.Bv){for(var N=Cl(this.Bv),la=N.next();!la.done;la=
N.next())la=la.value,this.$&&this.$.userOperationManager&&(la.operation&&Kd.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",Sj.a(la.operation.operationName)),this.$.userOperationManager.JIa(la)),this.Bv.remove(la);this.Bv=null}};y.A6c=1;y.z6c=0;y.s6b=100;y.wsb=9;y.t6c=!0;Object(Td.a)(y,"PrintSettingsManager",x,[]);Object(Td.a)(h,"PrintSettingsTaskPaneCallbacks",null,[]);Object(Td.a)(w,"SelectedPrintSettings",null,[]);Object(Td.a)(n,
"PrintOperationCallbacks",null,[]);Object(Td.a)(m,"PrintPreviewPaneCallbacks",null,[]);var lk=b(1252);Object(Td.a)(f,"UniversalPrintAppSettings",null,[]);var Pi=b(393);e.prototype.iHg=function(N){this.Qa.addHandler("ppocek",N)};e.prototype.tdj=function(N){this.Qa.removeHandler("ppocek",N)};e.prototype.NBj=function(N,la){this.chj();this.$.userOperationManager.Wu(this.PF);this.Vm=N;this.Qa.raiseEvent("ppocek");this.Vm.SelectedRanges&&this.Vm.SelectedRanges.Ranges&&0<this.Vm.SelectedRanges.Ranges.length&&
this.Vm.SelectedRanges.Ranges[0]&&(this.selectedRange=vd.B(this.Vm.SelectedRanges.Ranges[0]).toString());Kd.ULS.shipAssertTag(537154268,0,!this.Cv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Cv=new y(this,this.$,la,this.$.xa.qa.name,Nc.a.instance,this.isUniversalPrintEnabled);Kd.ULS.shipAssertTag(537154267,0,!this.ug,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.ug=new gk.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);
this.ug.Zgh();this.ug.PBj();this.ug.AGg(this.cBf)};e.prototype.FTh=function(){this.Cv.i7&&4<=this.Cv.marginDetailedOptions.length&&(this.Cv.marginDetailedOptions[3].marginValue=this.Cv.Awb(this.Cv.i7));return this.Cv.marginDetailedOptions};e.prototype.Cxc=function(){return!!this.Vm&&!!this.Vm.ObjectId||!hg.g(this.$).ha.ta.Lg};e.prototype.vWh=function(){var N=Object(eh.a)(new w,{selectedWhatToPrint:x.tdh,selectedOrientation:x.gdh,selectedPaperSize:x.wsb,selectedScaling:x.ldh,selectedMargin:x.edh,selectedIgnorePrintArea:x.Ych,
selectedPrintGridlines:x.DIa.PrintGrid,selectedDraft:x.Uch,selectedHorizontalCenter:x.DIa.HorizontalCenter,selectedVerticalCenter:x.DIa.VerticalCenter,selectedRowAndColumnHeadings:x.DIa.PrintHeaders});this.SH?(N.selectedWhatToPrint=this.SH.Xv,N.selectedOrientation=this.SH.orientation,N.selectedPaperSize=this.SH.Zca,N.selectedScaling=this.SH.Y0,N.selectedMargin=this.SH.margin,N.selectedIgnorePrintArea=this.SH.ignorePrintArea,N.selectedPrintGridlines=this.SH.sheetPrintOptions.PrintGrid,N.selectedDraft=
this.SH.g2a,this.isUniversalPrintEnabled&&(N.selectedColor=this.SH.NoColor?0:1),N.selectedHorizontalCenter=this.SH.sheetPrintOptions.HorizontalCenter,N.selectedVerticalCenter=this.SH.sheetPrintOptions.VerticalCenter,N.selectedRowAndColumnHeadings=this.SH.sheetPrintOptions.PrintHeaders):Kd.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return N};e.prototype.v2e=function(){var N=this;return Object(eh.a)(new m,{onBackToSheet:function(){N.nma()}})};
e.prototype.rWh=function(){var N=this;return Object(eh.a)(new lk.a,{backActionButtonText:Nc.a.instance.fa(1177),printPreviewPaneCallbacks:this.v2e(),logger:new jl.a,disableTellMeControl:!0,printOperationCallbacks:Object(eh.a)(new n,{onClosePreviewer:function(){N.nma()},getGraphServiceAuthorizationToken:this.Dac(),onLocalPrint:function(){N.QBf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(eh.a)(new f,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.igi()?
"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.tWh=function(){var N=this;return Object(eh.a)(new h,{onSettingChange:function(la){N.PQi(la)},onPrint:function(){N.QBf()}})};e.prototype.PQi=function(N){this.B0++;N?(this.ug&&this.ug.FCj(),this.xk.Xv=N.selectedWhatToPrint,this.xk.Y0=N.selectedScaling,this.xk.orientation=N.selectedOrientation,this.xk.Zca=N.selectedPaperSize,this.xk.margin=N.selectedMargin,this.isUniversalPrintEnabled&&
(this.xk.NoColor=!N.selectedColor),this.xk.ignorePrintArea=N.selectedIgnorePrintArea,this.zsj(N.selectedPageStart,N.selectedPageEnd),this.Cv&&this.D6h(this.xk,N)?(this.xk.sheetPrintOptions=x.DIa,this.xk.sheetPrintOptions.PrintGrid=N.selectedPrintGridlines,this.xk.sheetPrintOptions.HorizontalCenter=N.selectedHorizontalCenter,this.xk.sheetPrintOptions.VerticalCenter=N.selectedVerticalCenter,this.xk.sheetPrintOptions.PrintHeaders=N.selectedRowAndColumnHeadings,this.Cv.afi(this.xk.sheetPrintOptions)):
this.Qyb()):Kd.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.nma=function(){this.H6a&&(this.YMb=!0);Kd.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.B0);this.PBf();this.xze()};e.prototype.QBf=function(){Kd.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",
this.B0);cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&Kd.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.xk.margin,this.SH.margin);if(this.useMSPdfViewer)this.HJf();else if(this.n7a)try{this.ug.printPdf(),this.I1c()}catch(N){Kd.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.HJf()}else this.Nia.Q4f(this.dIa(!0)),this.I1c()};
e.prototype.HJf=function(){var N=this.dIa(!0);this.I1c();wh.HelperMethods.rf(N,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};e.prototype.dispose=function(){di.a.Ha(this.Qa)};e.prototype.Qyb=function(){var N=this;if(this.$.$wa)this.Hei();else{this.TY();this.HUf();var la=null;this.sbi();Kd.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Ra=function(Pb,vc,ad){Pb=new gj.a(Pb,null,vc,ad,null,!0,!1,"GetFileCopyFileHandler",
"");Pb.correlationID=Ti.a.create().toString();la=Pb;N.nca=N.J3.j$(N.dIa(N.n7a?!1:!0,N.agi?"Base64":"Pdf"),1,null,null,e.bbd,!1,2,N.lBd,N.kBd,la,void 0,void 0,void 0,12E4);Pb.requestId=N.nca;Kd.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",N.nca);return nh.Task.Ra(!0)};this.INa=cf.EwaSettings.qc()?this.$.userOperationManager.ic(new Jb.a(223,0,Ra,80),null):this.$.userOperationManager.ic(new Ii.a(223,0,Ra,16),null)}};e.prototype.I1c=
function(){this.PBf();this.xze()};e.prototype.rCd=function(N){Hg.a.lr(N.Errors)?this.ug.showErrorMessageForPrintOptions(Nc.a.instance.fa(1228)):(Kd.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Qyb(),this.ug&&this.ug.hideErrorMessageForPrintOptions())};e.prototype.DCd=function(N){this.ug&&this.ug.showErrorMessageForPrintOptions(Nc.a.instance.fa(1228));N=bk.a.pg(N.data);Kd.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",
Hg.a.Xc(N))};e.prototype.Hei=function(){function N(Pb,vc,ad){var Fd={};Fd.WhatToPrint=la.xk.Xv;Fd.UseNamedAction=la.Nia.byc();Fd.SelectedSheetName=la.$.xa.qa.name;Fd.ActiveCell=la.activeCell;Fd.SelectedRanges=[la.selectedRange];Fd.IsPdfDocumentRequired=!1;Fd.Orientation=la.xk.orientation;Fd.PaperSize=la.xk.Zca;Fd.Scaling=la.xk.Y0;Fd.RichValuesEnabled=!0;Fd.IgnorePrintArea=la.xk.ignorePrintArea;Fd.Preview=!0;la.isUniversalPrintEnabled&&(Fd.NoColor=la.xk.NoColor);la.t2f()&&(Fd.PaginationStartPage=la.sza,
Fd.PaginationEndPage=la.Ima,Fd.OutputTotalPdfPageCount=!0);var ve=la.Cv.Tgd(la.xk.margin);ve&&(Fd.PageMargin={},Fd.PageMargin.Top=ve.Top,Fd.PageMargin.Bottom=ve.Bottom,Fd.PageMargin.Left=ve.Left,Fd.PageMargin.Right=ve.Right,Fd.PageMargin.Header=ve.Header,Fd.PageMargin.Footer=ve.Footer);la.p8a=aa(la.$.na.va,Fd,th.b(la.DJi,Pb),th.a(la.CJi,vc),ad,Ra);return la.p8a}var la=this;Kd.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");
this.TY();var Ra=this.$.na.va.hc();cf.EwaSettings.qc()?this.INa=this.$.userOperationManager.ic(new Jb.a(133,0,N,80),null):this.INa=this.$.userOperationManager.ic(new Ii.a(133,0,N,16),null)};e.prototype.xze=function(){this.$.userOperationManager.Cr(this.PF);this.TY();this.HUf();Kd.ULS.shipAssertTag(537154261,0,!!this.ug,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.ug&&(this.ug.Wcj(this.cBf),this.ug.hhh(),this.ug=null);this.Vm=null;this.Cv&&(this.Cv.dispose(),
this.Cv=null);this.G3a=this.ZFb=null;this.bMc=!1;this.Qa&&this.Qa.raiseEvent("ppocek")};e.prototype.xxj=function(){return this.$.isEditMode&&!!this.SH&&!!this.xk&&2!==this.xk.Xv&&this.lkd()};e.prototype.sNd=function(){Kd.ULS.shipAssertTag(537154260,0,!!this.Cv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Cv&&this.Cv.sNd(this.xk,this.xxj())};e.prototype.dIa=function(N,la){la=void 0===la?"Pdf":la;var Ra=new Sys.StringBuilder;Ra.append(Ki.a(this.$,la,!0));sg.a.fh(Ra,
Oe.a.ZGd,""+this.xk.Xv);N&&this.Nia.byc()&&sg.a.fh(Ra,Oe.a.ofg,"1");sg.a.fh(Ra,Oe.a.dLf,this.$.xa.qa.name);0===this.xk.Xv&&(sg.a.fh(Ra,Oe.a.cLf,this.selectedRange),sg.a.fh(Ra,Oe.a.XKf,this.activeCell));sg.a.fh(Ra,Oe.a.YKf,""+this.xk.orientation);sg.a.fh(Ra,Oe.a.ZKf,""+this.xk.Zca);sg.a.fh(Ra,Oe.a.bLf,""+this.xk.Y0);sg.a.fh(Ra,Oe.a.aLf,"1");sg.a.fh(Ra,Oe.a.WKf,this.xk.ignorePrintArea?"1":"0");sg.a.fh(Ra,Oe.a.$Kf,"1");this.NKg(Ra);this.isUniversalPrintEnabled&&sg.a.fh(Ra,Oe.a.E3i,this.xk.NoColor?"1":
"0");this.MKg(Ra);Ng.a.equals(la,"Pdf",!0)&&(Ra.append("&#toolbar=0"),Ra.append("&zoom=100"));N=Ra.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");Kd.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",N);return N};e.prototype.zsj=function(N,la){N||la?(this.hzb=!0,this.sza=N,this.Ima=la):this.UTf()};e.prototype.NKg=function(N){this.t2f()&&(sg.a.fh(N,Oe.a.G3i,""+this.sza),sg.a.fh(N,Oe.a.F3i,""+this.Ima),sg.a.fh(N,Oe.a.H3i,"1"),Kd.ULS.sendTraceTag(537154258,
0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.sza,this.Ima))};e.prototype.t2f=function(){return null!=this.sza&&0<this.sza&&null!=this.Ima&&0<this.Ima};e.prototype.MKg=function(N){if(this.Cv&&this.xk){var la=this.Cv.Tgd(this.xk.margin);la&&sg.a.fh(N,Oe.a.D3i,""+la.Top+" "+la.Bottom+" "+la.Left+" "+la.Right+" "+la.Header+" "+la.Footer)}};e.prototype.rEb=function(N,la,Ra,Pb){this.ug&&(Kd.ULS.shipAssertTag(537154255,0,!!this.$.xa.qa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.qa&&(this.n7a?(Pb||(Pb=this.dIa(!1)),this.ug.Tti(Pb)):this.HBj()))};e.prototype.lkd=function(){return!this.SH.equals(this.xk)};e.prototype.PBf=function(){!this.YMb&&0<this.B0&&(this.Sqd?this.sNd():Kd.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));Kd.ULS.shipAssertTag(537154250,0,!!this.ug,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.ug&&this.ug.O7h();this.PXd()};
e.prototype.ui=function(){Kd.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.ug){var N=this.BAa(Nc.a.instance.fa(1));this.joa(N,1)}else N=Hg.a.gd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),cf.EwaSettings.Kz()?new xj.a(this.$,N):(new Gk.ErrorDialog(this.$,N)).kf()};e.prototype.OBj=function(N){N?(0===N.Xv&&this.Cxc()&&(Kd.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Vm.ObjectId?"floatingObject":"discontinuousRange"),N.Xv=1),v.xDe(N,this.SH),v.xDe(N,this.xk),Kd.ULS.shipAssertTag(537154248,0,!!this.ug,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.ug&&(this.Sqd=!0,this.ug.QBj(),this.Qyb())):(Kd.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.ui())};e.prototype.D0c=function(N,la,Ra){N>la&&(la=Object(eh.a)(new jk.a,{extendedProperties:new Map}),la.extendedProperties.set("WtpSelectedValue",
Ra),la.extendedProperties.set("FullyRenderedPdfLoadTime",N.toString()),$g.Health.instance.recordQosError(Dh.a.KDj,[Hc.a.Z5f],!1,!0,!0,!1,la))};e.prototype.TY=function(){this.INa&&(0<this.nca||this.p8a)&&(Kd.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.nca),this.$.userOperationManager.JIa(this.INa),this.p8a?bk.a.Fu(this.p8a.Qt):this.J3.Fu(this.nca),this.XLd())};e.prototype.XLd=function(){this.p8a=this.INa=null};e.prototype.sbi=
function(){this.kLd&&this.xk&&(this.G3a=this.$.Ob.Hc("UserAction",(1===this.xk.Xv?"ActiveSheet":0===this.xk.Xv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};e.prototype.UTf=function(){this.hzb=!1;this.sza=1;this.Ima=this.lGd};e.prototype.BAa=function(N){if(N)return N.replace("&#39;","'");Kd.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return N};e.prototype.HBj=function(){Kd.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");
if(this.gAb)if(this.Ohc)Kd.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var N=this.BAa(Nc.a.instance.fa(1182));this.joa(N,2)}else N=this.BAa(Nc.a.instance.fa(1183)),this.joa(N,3)};e.prototype.joa=function(N,la,Ra){this.ug.cA(N,la,void 0===Ra?null:Ra)};e.prototype.Dbi=function(){this.Ohc=this.fze();this.gAb=this.GXg();this.n7a=this.HXg();Kd.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",
this.Ohc,this.gAb,this.n7a)};e.prototype.chj=function(){this.m8a=null;this.XLd();this.UTf();this.ZFb=this.$.Ob.Hc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.qa.activeCell.toString();this.B0=0;this.Sqd=this.H6a=this.YMb=!1;this.bMc=!0};e.prototype.zzj=function(){var N=this.Boi()||this.Iif()&&cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;Kd.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",N);return N};e.prototype.fze=
function(){return!Mf.a.vB};e.prototype.oXg=function(){var N=15;Mf.a.$H&&Mf.a.ktb&&(N=parseFloat(Mf.a.ktb));return this.fze()&&14<N&&this.gAb};e.prototype.GXg=function(){return this.Iif()&&!cf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.Boi=function(){return Mf.a.bD||be.AFrameworkApplication.isUnifiedHostMode};e.prototype.HXg=function(){return this.Ohc&&this.gAb};e.prototype.Iif=function(){return!this.$.Yf.get(111)};e.prototype.HUf=function(){this.m8a&&
(URL.revokeObjectURL(this.m8a),this.m8a=null)};e.prototype.C5g=function(N){var la=N.data.me;N=this.$.Ob.Hc("UserAction","PrintPreviewBlobFileCreation");var Ra=window.self.atob(la);la=new Uint8Array(la.length);for(var Pb=0;Pb<Ra.length;Pb++)la[Pb]=Ra.charCodeAt(Pb)&255;Ra=new Blob([la],{type:"application/pdf"});this.m8a=URL.createObjectURL(Ra);Kd.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",N.zc,Ra.size);
N.stop();return this.m8a+"#toolbar=0&zoom=100"};e.prototype.H7i=function(N){if(this.kLd&&Hg.a.qh(N,e.zYi)){var la=Object(eh.a)(new jk.a,{extendedProperties:new Map});la.extendedProperties.set("ErrorMessageIdName",N[0].MessageIdName);$g.Health.instance.recordQosError(Dh.a.FJf,[Hc.a.GJf],!1,!0,!0,!1,la)}};e.prototype.D6h=function(N,la){return N.sheetPrintOptions.PrintGrid!==la.selectedPrintGridlines||N.sheetPrintOptions.HorizontalCenter!==la.selectedHorizontalCenter||N.sheetPrintOptions.VerticalCenter!==
la.selectedVerticalCenter||N.sheetPrintOptions.PrintHeaders!==la.selectedRowAndColumnHeadings};e.prototype.PXd=function(){this.Rqd&&this.$.Zd(-1753588160,-1,0,null)};e.prototype.igi=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){return this.Pzd.jT("Print",this.graphServiceEndpoint).then(function(N){return N?(N.IsSuccess||Kd.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",
N.ErrorCode,N.ErrorMessage),N):Object(eh.a)(new hj.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(N){var la=new hj.a;Object.getType(N)===Object.getType(la)?la=N:(la.ErrorMessage=N.toString(),la.ErrorCode="exception");return Promise.resolve(la)})};e.prototype.Dac=function(){var N=this;return function(){var la=Promise.resolve("");try{if(N.Pzd&&N.Pzd.Twa())return N.getToken().then(function(Ra){return Ra.IsSuccess?Promise.resolve(Ra.Token):la},function(){return la})}catch(Ra){Kd.ULS.sendTraceTag(537154211,
0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Ra)}return la}};e.prototype.onNotifyPrintJobStatus=function(N,la){N=Pi.a.gz.notificationBar.laa(N,!1);"pending"==la&&(N.displayTimeoutSeconds=3);if(cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(la){case "failure":N.image=1;break;case "success":N.image=3;break;default:N.image=0}else N.image=0;Pi.a.gz.notificationBar.oE(N)};Ck.Object.defineProperties(e.prototype,{Vli:{configurable:!0,
enumerable:!0,get:function(){return this.bMc}}});e.zYi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];e.bbd=["Content-Type","Total-Pdf-PageCount"];Object(Td.a)(e,"PrintPreviewManager",null,[981,2,982]);c.prototype.$c=function(){return!1};c.prototype.executeCommand=function(N,la,Ra,Pb){var vc=la.command;return 1588554917===vc?(la.qzb=!0,Wi.a(this.$)&&this.$.da.Aa(423).tyc(!1),this.Phh(la)?
nh.Task.Ra(!0):vh.a(vc)):this.DJf.executeCommand(N,la,Ra,Pb,this.uQi,this.tQi,this.OMj)};c.prototype.Kc=function(N,la){return 1588554917===la.command?(Kd.ULS.shipAssertTag(537154305,0,this.$.Vka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.DJf.Kc(N,la)};c.prototype.jd=function(){return!1};c.prototype.Phh=function(N){return this.$.ea.sc?this.Qhh(N):!1};c.prototype.Qhh=function(N){Kd.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");
var la=this.$.Ob.Hc("UserAction","DoPrintHtml"),Ra=this.$,Pb=this.ea.isNamedObjectViewMode?Ra.Hb.qa.sheetName:Ra.xa.qa.name,vc=this.ea.isNamedObjectViewMode,ad=!vc;Ra=this.oWh(Ra,Pb,ad);var Fd=!0;!cf.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.$wa&&(Fd=!1);ad?Fd?Ji.a(this.$)?Kd.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.yD.NBj(Ra,this.jO),Kd.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):
((new H(this.$,Nc.a.instance.fa(1191),3,Ra,N,this.Nia,Pb,this.jO)).kf(),Kd.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",la.zc)):((new U(this.$,Nc.a.instance.fa(1191),3,Ra,N)).kf(),Kd.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",la.zc,vc));la.stop();this.yjd();return!0};c.prototype.oWh=function(N,la,Ra){var Pb={};Pb.SessionId=this.ea.sessionId;Pb.UsedRangeTooBig=
!1;var vc=hg.g(N),ad=vc.ha,Fd=ad.Ue;if(zk.e(N.qa))Pb.Type=0,Pb.ObjectId=N.qa.name,Pb.UseSelection=!1;else if(zk.g(N.qa))Pb.Type=1,Pb.ObjectId=N.qa.VLa,Pb.UseSelection=!0;else if(2===Fd||4===Fd||64===Fd)vc=ad.Oa.oc.floatingObject,Pb.Type=1,Pb.SheetName=la,Pb.ObjectId=vc.id,Pb.UseSelection=!0;else if(Ra&&Fd&470)Pb.ObjectId=ad.Oa.oc.floatingObject.id,Pb.SheetName=la;else if(zk.i(N.qa)){Pb.Type=2;Pb.SheetName=la;if(ad.ta.Lg)if(Ra=ad.ta.ud,Pb.SelectedRanges=vd.q(Ra,N),20<Ra.mQ)Pb.UseSelection=!0;else{la=
0;vc=vc.wk("PrintCommandHandler.DoPrintHtml",Ra);try{for(vc.$$rst();vc.$$mn()&&2>la;)vc.$$cu().text&&la++;Pb.UseSelection=2<=la}finally{vc&&vc.dispose()}}else Pb.UseSelection=!1,Pb.SelectedRanges=vd.q(ad.ta.activeRange,N);this.ea.isNamedObjectViewMode&&(Pb.UsedRange=vd.v(N.qa.usedRange,N))}Pb.Title=N.workbookContext.WorkbookFileName;return Pb};c.prototype.yjd=function(){hg.g(this.$);if(!this.D2f){this.ERc=!0;var N=this.$.Ob.Hc("UserAction","HandlePageLayoutRendering");this.dNj();Kd.ULS.sendTraceTag(537154274,
0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",N.zc);N.stop()}};c.prototype.dNj=function(){for(var N=hg.g(this.$).Ea,la=N.kF(),Ra=!1,Pb=0,vc=0;vc<la.length;vc++){var ad=la[vc],Fd=ad.Ff;Fd&&Fd.hasPageLayout()&&(Ra=!0,Fd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+ad.ae,4),Pb++)}Ra&&(Kd.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",
la.length,Pb),N.wzd())};Ck.Object.defineProperties(c.prototype,{D2f:{configurable:!0,enumerable:!0,get:function(){return this.ERc}}});Object(Td.a)(c,"PrintCommandHandler",null,[424,975]);var Tj=Ff.a;Am(a,Tj);a.prototype.Nd=function(){var N=this,la=be.AFrameworkApplication.ga.appSettings,Ra=this.$.ya.DirectPrintSetting;la.DirectPrintIsEnabled=Ra.DirectPrintIsEnabled.toString();la.DirectPrintProbeIsEnabled=Ra.DirectPrintProbeIsEnabled.toString();la.DirectPrintEnabledForInternetExplorer=Ra.DirectPrintEnabledForInternetExplorer.toString();
la.DirectPrintSupportedMimeTypes=Ra.DirectPrintSupportedMimeTypes;la.DirectPrintSupportedPlugins=Ra.DirectPrintSupportedPlugins;la.DirectPrintImmersivePreviewPlugins=Ra.DirectPrintImmersivePreviewPlugins;la.DirectPrintMinimalSupportedEdgeVersion=Ra.DirectPrintMinimalSupportedEdgeVersion;la.DirectPrintEnabledForEdge=Ra.DirectPrintEnabledForEdge.toString();la=new Aa(la);var Pb=null;Ra=null;try{Ra=window.navigator.mimeTypes}catch(Fd){Kd.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var vc=
null;try{vc=window.navigator.plugins}catch(Fd){Kd.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Pb=new xa(la,Ra,vc,xa.Vdf,xa.mif,new wa(be.AFrameworkApplication.sa.UX),be.AFrameworkApplication.sa.MD,xa.nif,function(Fd,ve){return new qa(Fd,!1,ve)},!1);if(cf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Yf.get(116)){var ad=zh.GetServiceTaskFactory.Ua(this.$.da,349,350,this.ub);og.TaskExtensions.Ba(ad,function(){var Fd=new c(N.$,Pb,
ad.result);N.Dd([Fd])},this.$.la)}else this.Dd([new c(this.$,Pb,null)])};a.ka=function(N){Ff.a.he(73,new a(N))};Object(Td.a)(a,"PrintCommandHandlerFactory",Ff.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Uf.a.Li(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");Cd.main();Type.registerNamespace("Common.App.NewAndOpen.UX");kg.a.instance.hj(new Fe);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Pe.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");le.main();Type.registerNamespace("Common.App.SaveToSharePoint");Gg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ic.main();Type.registerNamespace("Common.App.SaveACopy");
sf.main();Type.registerNamespace("Common.App.SharedFilePicker");we.main();Type.registerNamespace("Common.App.WildFire");Hd.main();Zg.a.Fa(oe.ka);Zg.a.Fa(Id.ka);Zg.a.Fa(tc.ka);Uf.a.Li(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
Zg.a.Fa(qb.ka);Uf.a.Li(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){Zg.a.Fa(function(N){Ce.ka(N)})})();(function(){Zg.a.Fa(function(N){N.da.Ga(165,new Md(N))})})();Zg.a.Fa(jc.ka);(function(){Zg.a.Fa(function(N){N.da.Ga(57,new ne(N));N.da.Ga(60,new Lf(N));N.da.Ga(63,new qf(N))})})();Zg.a.Fa(qc.ka);Zg.a.Fa(Tc.ka);Zg.a.Fa(Sc.ka);Uf.a.Li(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){Zg.a.Fa(function(N){Wd.ka(N);oc.ka(N)})})();Uf.a.Li('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Uf.a.Li(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){Zg.a.Fa(function(N){nd.ka(N);Jc.ka(N)})})();Zg.a.Fa(Fc.ka);Zg.a.Fa(zb.ka);(function(){Zg.a.Fa(function(N){Ib.ka(N);Cb.ka(N)})})();Zg.a.Fa(ba.ka);Zg.a.Fa(Sa.ka);(function(){Zg.a.Fa(function(N){Fa.ka(N);Oa.ka(N)})})();Zg.a.Fa(ob.ka);(function(){Zg.a.Fa(function(N){ta.ka(N);sb.ka(N)})})();Type.registerNamespace("Common.App.DirectPrint");kg.a.instance.hj(new ka);Zg.a.Fa(a.ka)},917:function(z,
E,b){function a(Z,ca){var I=ea.call(this,document.createElement("div"))||this;I.Tx=null;I.xT=null;I.S8=null;I.pca=null;I.c3b=null;I.ale=null;I.Aqe=null;I.Clf=null;I.K5a=!1;I.qv=!1;I.n_=!1;I.lwa=!1;I.MIi=function(H){I.iD(H)};I.SIi=function(H){13===H.keyCode&&I.iD(H)};I.dAd=function(H){I.Fo(H.yb);return!0};I.kAd=function(H){I.m0(H.yb);return!0};I.Ync=function(H){I.yma(H.yb?H.yb:0);return!0};I.NIi=function(H){I.iD(H.Ca);return!0};I.Vjg=function(H){H=void 0===H?null:H;I.Fo(H.inputMethod?H.inputMethod:
0);return!0};I.Wjg=function(H){H=void 0===H?null:H;I.m0(H.inputMethod?H.inputMethod:0);return!0};I.Y1=Z;I.PC=ca;I.xYc=ca.aHa.toString();I.title=ca.title;I.message=ca.message;I.set_visibilityMode(1);return I}b.d(E,"a",function(){return a});z=b(0);var c=b(7),e=b(14),f=b(90),m=b(228),n=b(13),w=b(109),h=b(203),y=b(86);E=b(242);var r=b(1240),x=b(19),t=b(5),u=b(335),B=b(54),v=b(12),C=b(72),A=b(15),M=b(21),T=b(87),R=b(1104),Q=b(1),ea=E.a;Am(a,ea);a.prototype.dispose=function(){f.a.yc([this.c3b,this.xT,this.S8]);
this.qv&&this.xT&&(m.a.instance.za(n.a.click,this.xT.domElement,this.dAd),w.KeyInputManager.instance.Uv(this.domElement,this.ale));this.n_&&this.S8&&(m.a.instance.za(n.a.click,this.S8.domElement,this.kAd),w.KeyInputManager.instance.Uv(this.domElement,this.Aqe));this.lwa&&this.pca&&(m.a.instance.za(n.a.click,this.pca,this.Ync),w.KeyInputManager.instance.Uv(this.domElement,this.Clf));this.pca=this.Tx=this.Y1=this.S8=this.xT=null;ea.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.cRj=
function(){this.uFe(!0)};a.prototype.S3c=function(){this.uFe(!1)};a.prototype.P9g=function(){var Z=this;this.message=T.a.fg(this.message);this.title=T.a.fg(this.title);h.UISurfaces.igd().then(function(ca){ca.initializeMessageBarInStore();var I=Object(c.a)(new R.a,{messageTitle:Z.title,message:Z.message,isMultiline:!1,messageBarType:Z.PC.VSg,closeable:!Z.K5a,dismissButtonAriaLabel:A.a.instance.fa(10),onDismiss:Z.NIi});if(Z.lwa){var H={};I.linkProps=(H.type="AppLinkProps",H.text=Z.linkText,H.onExecute=
Z.Ync,H)}Z.qv&&(H={},I.firstActionButtonProps=(H.type="AppButtonProps",H.label=Z.actionButton,H.onExecute=Z.Vjg,H));Z.n_&&(H={},I.secondActionButtonProps=(H.type="AppButtonProps",H.label=Z.EGa,H.onExecute=Z.Wjg,H));ca.createNewMessageBar(Z.domElement,I);return null},function(ca){e.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized",ca);return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.vFe=function(Z){var ca="<div class='"+
r.a.mnh+"' id='{0}'><div class='"+r.a.knh+"'><a class='"+r.a.snh+"' title='{1}'><span class='"+x.a.a3b+" "+r.a.onh+"' id='{2}'>";this.Qk.length&&(ca+="<img class='{3}' src='{4}'/>");ca+="</span></a><span class='"+r.a.rnh+"' id='{5}'>{6}</span><span class='"+r.a.qnh+"' id='message'>{7}</span><a id='link' href='#' class='"+r.a.pnh+"'>{8}</a><span class='"+r.a.CNe+"'><button type='button' id='action' class='"+r.a.BNe+"'>{9}</button></span><span class='"+r.a.CNe+"'><button type='button' id='altAction' class='"+
r.a.BNe+"'>{10}</button></span></div><a class='"+r.a.nnh+"' tabindex='0' role='button'><span id='close' class='"+x.a.Wr+"'><img class='"+x.a.u$c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";Z||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var I=this.businessBar.$.Lb;Z=I+"ewaBusinessBarEntryBody"+this.xYc;var H=I+"ewaBusinessBarEntryTitle"+this.xYc;I=I+"ewaBusinessBarEntryIcon"+this.xYc;this.domElement.className=r.a.lnh;this.domElement.innerHTML=
String.format(ca,Z,this.alt,I,this.Qk,B.a.Se(0),H,this.title,this.message,this.linkText,this.actionButton,this.EGa,B.a.Se(13),A.a.instance.fa(786));v.DOMElementExtensions.Bu(this.domElement,t.a.zsa,H,Z);this.pca=$get("link",this.domElement);v.DOMElementExtensions.setVisible(this.pca,this.lwa);this.lwa&&(m.a.instance.pa(n.a.click,this.pca,this.Ync),this.Clf=w.KeyInputManager.instance.zs(this.pca,this.Ync,y.a.ei,y.a.L1));this.xT=new u.a(v.DOMElementExtensions.getElementById(this.domElement,"action"));
this.xT.isVisible=this.qv;this.S8=new u.a(v.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.S8.isVisible=this.n_;this.qv&&(m.a.instance.pa(n.a.click,this.xT.domElement,this.dAd),this.ale=w.KeyInputManager.instance.zs(this.xT.domElement,this.dAd,y.a.ei,y.a.L1),this.n_&&(m.a.instance.pa(n.a.click,this.S8.domElement,this.kAd),this.Aqe=w.KeyInputManager.instance.zs(this.xT.domElement,this.kAd,y.a.ei,y.a.L1)));this.Tx=$get("close",this.domElement);this.c3b=this.de.Wd(this.Tx);this.c3b.ka("click",
this.MIi);this.c3b.ka("keydown",this.SIi);v.DOMElementExtensions.setVisible(this.Tx,!this.K5a)};a.prototype.uFe=function(Z){63==this.PC.aHa?this.vFe(Z):Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.P9g():this.vFe(Z)};a.prototype.Fo=function(){e.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.PC.hash,this.PC.m9c);M.g(this.businessBar.$).Kp(!0)};a.prototype.m0=function(){e.ULS.sendTraceTag(537170257,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.PC.hash);M.g(this.businessBar.$).Kp(!0)};a.prototype.yma=function(){e.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.PC.hash);M.g(this.businessBar.$).Kp(!0)};a.prototype.iD=function(Z){e.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.PC.hash,this.PC.m9c);this.set_visible(!1);this.businessBar.removeEntry(this.WSg);C.g(Z)};Ck.Object.defineProperties(a.prototype,
{WSg:{configurable:!0,enumerable:!0,get:function(){return this.PC.aHa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.Y1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.PC?this.PC.actionButton:""}},EGa:{configurable:!0,enumerable:!0,get:function(){return this.PC?this.PC.EGa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.PC?this.PC.link:""}},Qk:{configurable:!0,enumerable:!0,get:function(){return this.PC?this.PC.Qk:""}},alt:{configurable:!0,
enumerable:!0,get:function(){return this.PC?this.PC.alt:""}}});Object(z.a)(a,"BusinessBarEntry",E.a,[])},989:function(z,E,b){function a(U,fa,aa,na){var ha=L.call(this)||this;ha.VF=null;ha.zD=null;ha.aX=null;ha.ax=null;ha.WGb=null;ha.dL=null;ha.pkc=null;ha.iCb=null;ha.hCb=!1;ha.gxa=!0;ha.aqc=null;ha.ewaAccessibilityManager=null;ha.kGd=null;ha.jGd=null;ha.nGd=null;ha.Rod=!1;ha.Dzf=function(){r.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",
ha.hCb);ha.hCb&&(ha.X7h(),ha.dL.style.visibility="visible",ha.pkc?ha.pkc.stop():r.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ha.raiseEvent(a.MDb,new h(1)),ha.zPd(),ha.hCb=!1)};ha.$=U;ha.yD=fa;ha.C9g();ha.useMSPdfViewer=aa;ha.isUniversalPrintEnabled=na;return ha}function c(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function e(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=
this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function f(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function m(U){this.ug=U}function n(U){this.ug=U}function w(U){this.ug=U}function h(U){var fa=R.call(this)||this;fa.I1i=
U;return fa}b.r(E);z=b(0);var y=b(7),r=b(14),x=b(4);b(24);var t=b(409),u=b(38),B=b(51),v=b(12),C=b(128),A=b(1),M=b(15),T=b(21),R=Sys.EventArgs;Am(h,R);Object(z.a)(h,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var Q=b(272),ea=b(254);w.prototype.ai=function(){Q.a(this.ug.$).eN(this.ve)||Q.a(this.ug.$).ai(this)};w.prototype.y8=function(){Q.a(this.ug.$).eN(this.ve)&&Q.a(this.ug.$).Xz(this)};w.prototype.sh=function(U){return v.DOMElementExtensions.Gf(this.uc,U)};w.prototype.Ej=function(){this.ug.$.frame.Qe.ek(this.ug.$.frame.Qe.ZE)};
w.prototype.Rj=function(){};w.prototype.Wf=function(U,fa){return fa?!1:(this.ug.enterPrintPreviewHeaderFocusTrapZone(),!0)};Ck.Object.defineProperties(w.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return ea.a.IJf}},uc:{configurable:!0,enumerable:!0,get:function(){var U=b(989).PrintPreviewPane;return document.getElementById(U.G1i)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(z.a)(w,"PrintPreviewHeaderKeyboardAccessibleSection",null,[438]);n.prototype.ai=
function(){Q.a(this.ug.$).eN(this.ve)||Q.a(this.ug.$).ai(this)};n.prototype.y8=function(){Q.a(this.ug.$).eN(this.ve)&&Q.a(this.ug.$).Xz(this)};n.prototype.sh=function(U){return v.DOMElementExtensions.Gf(this.uc,U)};n.prototype.Ej=function(){this.ug.$.frame.Qe.ek(this.ug.$.frame.Qe.ZE)};n.prototype.Rj=function(){};n.prototype.Wf=function(U,fa){return fa?!1:(this.ug.useMSPdfViewer?(U=document.getElementById(b(989).PrintPreviewPane.iEd))&&v.DOMElementExtensions.setFocus(U,!0):v.DOMElementExtensions.setFocus(this.ug.dL),
!0)};Ck.Object.defineProperties(n.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return ea.a.JJf}},uc:{configurable:!0,enumerable:!0,get:function(){var U=b(989).PrintPreviewPane;return this.ug.useMSPdfViewer?document.getElementById(b(989).PrintPreviewPane.iEd):document.getElementById(U.fHf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(z.a)(n,"PrintPreviewKeyboardAccessibleSection",null,[438]);m.prototype.ai=function(){Q.a(this.ug.$).eN(this.ve)||
Q.a(this.ug.$).ai(this)};m.prototype.y8=function(){Q.a(this.ug.$).eN(this.ve)&&Q.a(this.ug.$).Xz(this)};m.prototype.sh=function(U){return v.DOMElementExtensions.Gf(this.uc,U)};m.prototype.Ej=function(){this.ug.$.frame.Qe.ek(this.ug.$.frame.Qe.ZE)};m.prototype.Rj=function(){};m.prototype.Wf=function(U,fa){return fa?!1:(this.ug.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Ck.Object.defineProperties(m.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return ea.a.MJf}},uc:{configurable:!0,
enumerable:!0,get:function(){var U=b(989).PrintPreviewPane;return document.getElementById(U.mGd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(z.a)(m,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[438]);Object(z.a)(f,"MSPdfViewerFileUrl",null,[]);Object(z.a)(e,"PrintSettingsTaskPaneProps",null,[]);Object(z.a)(c,"ViewerPaneProps",null,[]);var Z=b(1252),ca=b(396),I=b(5),H=b(1253);b.d(E,"PrintPreviewPane",function(){return a});var L=u.a;Am(a,L);a.prototype.AGg=
function(U){this.addHandler(a.MDb,U)};a.prototype.Wcj=function(U){this.removeHandler(a.MDb,U)};a.prototype.PBj=function(){this.x9g()};a.prototype.QBj=function(){var U=this.$.Ob.Hc("UserAction","createSettingsPaneStopwatch"),fa=document.getElementById(a.mGd);this.D9g();var aa=this.E9g();this.zD.createPrintSettingsTaskPane(fa,aa);U.stop();this.hCb=!1;if(this.isUniversalPrintEnabled&&this.ax){U="A4";switch(aa.selectedPrintSettingsValues.selectedPaperSize){case 8:U="A3";break;case 9:U="A4";break;case 11:U=
"A5";break;case 12:U="JIS B4";break;case 13:U="JIS B5";break;case 5:U="North America Legal";break;case 1:U="North America Letter";break;case 6:U="North America Invoice";break;case 7:U="North America Executive";break;case 3:U="North America Ledger"}this.VF.setDocumentSettings({mediaSize:U,orientation:2===aa.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===aa.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.SId()};a.prototype.setPageRangeSettings=
function(U,fa,aa,na,ha){this.zD&&(this.zD.setPageRangeSettings(U,fa,aa,na,ha),this.k0f(String.format(M.a.instance.Ab(196),na,ha,U)))};a.prototype.O7h=function(){this.ax&&(this.ax.style.display="none")};a.prototype.hhh=function(){this.dispose();this.KYd();this.bPj();this.VF&&this.VF.closePrintPreviewPane();this.aX=this.zD=this.VF=this.ax=null};a.prototype.Tti=function(U){r.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.iCb=this.$.Ob.Hc("UserAction",
"pdfLoadTimeStopwatchForMsPdfViewer"))||r.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.aX.renderPdf(U)):this.dL&&((this.pkc=this.$.Ob.Hc("UserAction","loadPdfStopwatch"))||r.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.hCb=!0,this.dL.src&&this.dL.src===U?this.Dzf(null):this.dL.src=U);if(this.isUniversalPrintEnabled&&this.ax){var fa=ca.b(this.$.workbookContext);this.VF.setFileUrl(U,
fa)}};a.prototype.onPdfLoad=function(){this.iCb?(r.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.iCb.zc,this.gxa),this.iCb.stop()):r.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.MDb,new h(1));this.hideWaitCursor();this.zPd()};a.prototype.printPdf=function(){v.DOMElementExtensions.setFocus(this.dL);this.dL.contentWindow.print()};a.prototype.FCj=function(){this.showSpinner();
this.showWaitCursor();this.k0f("")};a.prototype.X7h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.cA=function(U,fa,aa){this.ax&&this.aX&&(this.Rod=!1,this.aX.showErrorDetails(fa,U,void 0===aa?null:aa),this.yD.H6a=!0,this.dL&&(this.dL.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.Eli(fa)&&(this.Rod=!0,this.xQi()))};a.prototype.hidePreviewError=function(){this.yD.H6a=!1;this.aX.hidePreviewError();this.enablePrintButton()};a.prototype.Zgh=function(){(this.WGb=document.getElementById(a.KJf))&&
this.WGb.parentNode&&this.WGb.parentNode.removeChild(this.WGb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.zD&&this.zD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(U){this.zD&&this.zD.showErrorMessageForPrintOptions(U)};a.prototype.showSpinner=function(){this.yD.H6a||A.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Rod?this.hidePreviewError():this.dL&&(this.dL.style.visibility="hidden");this.aX&&
this.aX.showSpinner()};a.prototype.hideSpinner=function(){this.aX&&this.aX.hideSpinner()};a.prototype.enablePrintButton=function(){this.zD&&this.zD.enablePrintButton();this.isUniversalPrintEnabled&&this.ax&&this.VF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.zD&&this.zD.disablePrintButton();this.isUniversalPrintEnabled&&this.ax&&this.VF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.zD&&this.zD.showWaitCursor();this.isUniversalPrintEnabled&&
this.ax&&this.VF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.zD&&this.zD.hideWaitCursor();this.isUniversalPrintEnabled&&this.ax&&this.VF.updatePrintButtonEnableDisableState(!0)};a.prototype.A9g=function(){if(this.ax)r.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.ax=document.createElement("div"),this.ax.id=a.KJf,this.ax.classList.add(a.J1i),this.$.kr.insertBefore(this.ax,
this.$.kr.firstChild),x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Pa.Ug){var U=document.getElementById(I.a.HGa);U&&(this.ax.style.top=U.clientHeight+"px",this.ax.style.height="calc(100% - "+U.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.VF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.VF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.q_i=function(){var U=this;this.$.da.$a(15,
function(fa){U.ewaAccessibilityManager=fa;U.ewaAccessibilityManager.mode=3})};a.prototype.C9g=function(){this.nGd=new m(this);this.kGd=new n(this);this.jGd=new w(this)};a.prototype.SId=function(){this.nGd.ai();this.kGd.ai();this.jGd.ai();this.q_i()};a.prototype.KYd=function(){this.nGd.y8();this.kGd.y8();this.jGd.y8();T.g(this.$).g1();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.rO=function(){this.aqc=C.a.instance.Wd(this.dL);this.aqc.ka("load",this.Dzf)};a.prototype.bPj=
function(){this.aqc&&this.dL&&this.aqc.detach("load")};a.prototype.zPd=function(){this.isUniversalPrintEnabled?this.l_f(a.H1i,a.aEi):this.l_f(a.mGd,a.EJf)};a.prototype.l_f=function(U,fa){this.gxa&&(U=document.getElementById(U))&&(fa=v.DOMElementExtensions.getElementById(U,fa))&&(this.gxa=!1,fa.focus())};a.prototype.xQi=function(){this.yD.H6a=!1;this.enablePrintButton();this.zPd()};a.prototype.x9g=function(){var U=this;if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var fa=
B.GetServiceTaskFactory.Ua(this.$.da,283,284,0).result.Jn;fa.loadScript("excel-print-preview-sprite").then(function(){fa.loadScript("printPreviewer").then(function(){fa.loadScript("excelPrintPreviewer").then(function(){U.CFe()})},function(){r.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){r.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else B.GetServiceTaskFactory.Ua(this.$.da,
283,284,0).result.Jn.loadScript("excelPrintPreviewer").then(function(){U.CFe()})};a.prototype.CFe=function(){var U=this,fa=this.$.Ob.Hc("UserAction","createEmptyPreviewerStopwatch");this.A9g();this.B9g();this.isUniversalPrintEnabled?this.VF.createEmptyPrintPreviewPaneAsync(this.ax,this.BFe()).then(function(){fa.stop();U.mCe();U.VF.updatePrintButtonEnableDisableState(!1)}):(this.VF.createEmptyPrintPreviewPane(this.ax,this.BFe()),fa.stop(),this.mCe())};a.prototype.mCe=function(){var U=this.$.Ob.Hc("UserAction",
"createPdfPreviewPaneStopwatch"),fa=document.getElementById(a.iEd);this.useMSPdfViewer&&(fa.tabIndex=0);this.k9g();this.j9g(fa);U.stop();this.raiseEvent(a.MDb,new h(0))};a.prototype.B9g=function(){this.VF||(this.VF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.VF||r.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.D9g=function(){this.zD||(this.zD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.zD||r.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.k9g=function(){this.aX||(this.aX=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.aX||r.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.j9g=function(U){this.aX.createPrintPreviewPane(U,this.Nah());this.useMSPdfViewer||
(this.dL=v.DOMElementExtensions.getElementById(this.ax,a.fHf),this.dL.title=M.a.instance.fa(1179),this.rO())};a.prototype.E9g=function(){var U="en-US";var fa=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?U=this.$.ya.DataCultureTag:r.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(y.a)(new e,{whatToPrintOptions:this.yD.Cv.whatToPrintOptions,orientationOptions:this.yD.Cv.orientationOptions,
paperSizeOptions:this.yD.Cv.paperSizeOptions,scalingOptions:this.yD.Cv.scalingOptions,marginDetailedOptions:this.yD.FTh(),selectedPrintSettingsValues:this.yD.vWh(),printSettingsTaskPaneCallbacks:this.yD.tWh(),logger:new t.a,shouldDisableCurrentSelection:this.yD.Cxc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:fa,dataCultureTag:U,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.BFe=function(){return this.isUniversalPrintEnabled?this.yD.rWh():Object(y.a)(new Z.a,{backActionButtonText:M.a.instance.fa(1177),
printPreviewPaneCallbacks:this.yD.v2e(),logger:new t.a,disableTellMeControl:!0})};a.prototype.Nah=function(){var U=this;return this.useMSPdfViewer?Object(y.a)(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.x8g(),onPdfLoad:function(){U.onPdfLoad()}}):Object(y.a)(new c,{useMSPdfViewer:!1})};a.prototype.x8g=function(){return Object(y.a)(new f,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};
a.prototype.k0f=function(U){this.ax&&this.VF.setAdditionalHeaderText(U)};a.Eli=function(U){return 3===U||2===U};a.KJf="PrintPreviewerContainer";a.mGd="printSettingsTaskPaneId";a.iEd="previewId";a.fHf="printpreviewiframe";a.G1i="printPreviewHeaderId";a.EJf="printButton";a.H1i="printPreviewPaneId";a.aEi="printButtonId";a.J1i=H.a.ax;a.MDb="pppnosu";Object(z.a)(a,"PrintPreviewPane",u.a,[987])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/b8defc0cf8e46c83c63b65dec7acb1ef/EwaDS.kmhv.js.map