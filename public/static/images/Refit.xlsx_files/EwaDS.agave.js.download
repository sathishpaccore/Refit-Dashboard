/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1018:function(z,E,b){function a(e,f,m){this.IQb=e;this.Ukg=f;this.Vkg=m}function c(){this.title=this.id=this.tabs=null}z=b(0);Object(z.a)(c,"AddInDataTransferObject",null,[]);b.d(E,"a",function(){return a});a.evb=function(e){return(e=e.UW)?Object.assign(new c,{tabs:e.Qr.toArray(),id:e.ZBg,title:e.$Bg}):null};Ck.Object.defineProperties(a.prototype,{Qr:{configurable:!0,enumerable:!0,get:function(){return this.IQb}},ZBg:{configurable:!0,
enumerable:!0,get:function(){return this.Ukg}},$Bg:{configurable:!0,enumerable:!0,get:function(){return this.Vkg}}});Object(z.a)(a,"OneLineRibbonExtensibility",null,[])},1054:function(z,E,b){function a(Q,ea,Z){Z=void 0===Z?null:Z;this.nFc=new r.a;var ca=new h.a;ea&&ca.add(ea.yyi);Z&&ca.addRange(Z);this.zm=Q;this.yyg=ca}function c(Q,ea,Z,ca){this.eU=new h.a;this.JG=new h.a;this.Ppa=null;this.Hlb=new h.a;this.$ae=Promise.resolve(null);this.aie=!1;this.eWb=ea;this.Eng=Q;this.Die=Z;this.Zkg=ca}function e(){var Q=
f.call(this)||this;Q.errorCode=0;return Q}function f(){this.lRb=new h.a;this.u$=this.t$=!1;this.Koa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Epe=null}function m(){this.token=null;this.expiresOn=0;this.Hha=this.authChallenge=null}function n(){this.accessToken=null}function w(){this.startTime=0;this.callback=null}b.r(E);z=b(0);var h=b(201),y=b(14),r=b(98);Object(z.a)(w,"SSOCallbackInfo",null,[]);Object(z.a)(n,"AccessTokenInformation",null,[85]);var x=b(1184);Object(z.a)(m,"CachedTokenInfo",
null,[]);Ck.Object.defineProperties(f.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.lRb}}});Object(z.a)(f,"SSORequestInfo",null,[]);Am(e,f);Object(z.a)(e,"SSOFailedRequestInfo",f,[]);var t=b(4);c.prototype.uyj=function(Q){if(this.Ppa&&this.Ppa.authChallenge===Q.authChallenge){if(Date.now()/1E3+c.Wzi>this.Ppa.expiresOn)return this.Ppa=null,!1;Q=new x.a;Q.token=this.Ppa.token;Q.expiresOn=this.Ppa.expiresOn;Q.Hha=this.Ppa.Hha;Q.LTa=!0;Q.Qwb=0;this.hxb(Q);return!0}return!1};
c.prototype.Ywj=function(Q){for(var ea=0;ea<this.JG.count;ea++)if(this.JG.oa(ea).authChallenge===Q.authChallenge&&this.JG.oa(ea).Koa===Q.Koa){var Z=void 0;(Z=this.JG.oa(ea)).retryCount=Z.retryCount+1;Q.retryCount=this.JG.oa(ea).retryCount;if(this.JG.oa(ea).retryCount<c.sAi||!this.JG.oa(ea).t$&&Q.t$||!this.JG.oa(ea).u$&&Q.u$){if(!this.JG.oa(ea).t$&&Q.t$||!this.JG.oa(ea).u$&&Q.u$)Q.retryCount=0;this.JG.removeAt(ea);break}Q=new x.a;Q.errorCode=this.JG.oa(ea).errorCode;this.hxb(Q);return!0}return!1};
c.prototype.PDg=function(Q,ea){for(var Z=0;Z<this.JG.count;Z++)if(this.JG.oa(Z).Koa===Q.Koa&&this.JG.oa(Z).authChallenge===Q.authChallenge)return;this.JG.add(Object.assign(new e,{t$:Q.t$,u$:Q.u$,authChallenge:Q.authChallenge,Koa:Q.Koa,errorCode:ea,retryCount:Q.retryCount}))};c.prototype.zdd=function(Q,ea,Z,ca,I,H){var L=this,U=b(1054).AppsForOfficeSingleSignOnManager;""===Z&&(Z=null);if(this.aie)U.o6(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var fa=null,aa=Cl(this.eU),
na=aa.next();!na.done;na=aa.next())if(na=na.value,na.t$===Q&&na.u$===ea&&na.authChallenge===Z&&na.Koa===I){fa=na;break}fa||(fa=Object.assign(new f,{t$:Q,u$:ea,authChallenge:Z,Epe:ca,Koa:I,retryCount:0,startTime:U.Iw()}),this.eU.add(fa));fa.retryCount=0;fa.callbacks.add(H);this.$ae=this.$ae.then(function(){var ha=b(1054).AppsForOfficeSingleSignOnManager;if(0<L.eU.count){var ka=L.eU.oa(0);if(L.uyj(ka)||L.Ywj(ka))return null;for(var xa=0;xa<L.Hlb.count;)L.Hlb.oa(xa)+c.LJj<ha.Iw()?L.Hlb.removeAt(xa):
xa++;if(L.Hlb.count>=c.nAi||L.eU.count>=c.Tzi)return ka=new x.a,ka.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,L.hxb(ka),null;var va=null;t.AFrameworkApplication.sa&&(ha=t.AFrameworkApplication.sa.MD)&&(va=ha.Hc("ComponentAttach",L.Eng+c.uxg));return ka.Koa.Vzg(L.resource,ka.t$,ka.u$,ka.authChallenge,L.Zkg,ka.Epe).then(function(Aa){va&&va.stop();L.hxb(Aa)},function(){va&&va.stop();var Aa=new x.a;Aa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;L.hxb(Aa)})}return null})}};
c.prototype.hxb=function(Q){var ea=b(1054).AppsForOfficeSingleSignOnManager;try{if(this.eU.count){var Z=this.eU.oa(0);this.eU.removeAt(0);var ca=null;Q.errorCode||(ca=new n,ca.accessToken=Q.token);Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.PDg(Z,Q.errorCode);
var I={};null!=Q.Qwb&&(I.getTokenSilentTime=Q.Qwb.toString());null!=Q.Yhd&&(I.getTokenPopupTime=Q.Yhd.toString());null!=Q.Kfd&&(I.getIDTokenTime=Q.Kfd.toString());null!=Q.LTa&&(I.tokenCached=Q.LTa.toString());Q.gWd&&(I.detailedError=Q.gWd);Q.Hha&&(I.authLibrary=Q.Hha);Z.retryCount&&(I.retryCount=Z.retryCount);for(var H=Cl(Z.callbacks),L=H.next();!L.done;L=H.next())ea.o6(L.value,Q.errorCode,ca,I);null!=Q.LTa&&Q.LTa||this.Hlb.add(Z.startTime);if(!Q.errorCode)for(null!=Q.expiresOn&&(this.Ppa=Object.assign(new m,
{token:Q.token,expiresOn:Q.expiresOn,authChallenge:Z.authChallenge,Hha:Q.Hha})),this.JG.clear(),H=0;H<this.eU.count;)if(this.eU.oa(H).authChallenge===Z.authChallenge){var U=Cl(this.eU.oa(H).callbacks);for(L=U.next();!L.done;L=U.next())ea.o6(L.value,Q.errorCode,ca,I);this.eU.removeAt(H)}else H++}}catch(fa){y.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",fa.message)}};c.prototype.shutdown=function(){this.aie=!0;this.eU.clear()};Ck.Object.defineProperties(c.prototype,
{resource:{configurable:!0,enumerable:!0,get:function(){return this.eWb}}});c.LJj=6E4;c.nAi=6;c.Tzi=6;c.sAi=3;c.Wzi=300;c.uxg="GetAccessToken";Object(z.a)(c,"SSOCallbackManager",null,[]);var u=b(929),B=b(941),v=b(123),C=b(80),A=b(24),M=b(29),T=b(152),R=b(355);b.d(E,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Add=function(Q,ea,Z,ca,I,H,L,U,fa,aa){aa=Object.assign(new w,{startTime:a.Iw(),callback:aa});try{var na=!!Z&&""!==Z,ha=aa.startTime,ka=this.getOsfControl(Q),xa=ka.getStoreType()||
"",va=ka.getOwnerAddinStoreType()||"",Aa=ka.getSolutionId()||"",qa=ka.getVersion()||"";xa=xa.toLowerCase();va=va.toLowerCase();Aa=Aa.toLowerCase();var wa=C.a.Jfd(ea)||"",Ta=C.a.Jfd(ka.getIframeUrl())||"",sb=wa.toLowerCase()===Ta.toLowerCase();wa=xa;"inmemory"===xa&&(wa=va);var db=t.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,wa,ka.getAssetId(),null,null,ka.getStoreId()):Telemetry.PrivacyRules.GetAssetId(wa,
ka.getStoreId(),Aa);ka={};var kb=(ka.callInstanceId=ha.toString(),ka.controlAssetId=db,ka.controlVersion=qa,ka.storeType=xa,ka.ownerStoreType=va,ka.allowConsentPrompt=ca.toString(),ka.forMSGraphAccess=I.toString(),ka.allowSignInPrompt=H.toString(),ka.hasAddinAuthChallenge=na.toString(),ka.securityOriginEqualsSourceLocation=sb.toString(),ka.singleSignOnEnabled=L.toString(),ka.accountTypeFilter=U||"",ka);y.ULS.sendTraceTag(51401115,344,50,"{0}",kb);T.a.sendTelemetryEvent(Object.assign(new R.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",
dataFields:v.a.al(kb)}));ha=!0;var ac=t.AFrameworkApplication.ga.Va("HostAuthType");switch(U){case "aad":ha="aad"===ac;break;case "msa":ha="msa"===ac;break;default:ha=!U||"noFilter"===U}if(ha){U=null;if(L)for(var ta=Cl(this.yyg),ra=ta.next();!ra.done;ra=ta.next()){var Na=ra.value;if(Na.oii(Aa)){U=Na;break}}U?this.isSSOAddin(Q)?(L=!0,"omex"===wa&&(L=!1),"spapp"===wa||"spcatalog"===wa?(y.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.o6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):I&&!L?(y.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.o6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(I&&"exchange"===wa&&(ca=!1),this.zdd(Q,ea,Z,wa,ca,H,fa,U,aa))):(y.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.o6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.o6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else a.o6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(gb){this.zkc(),y.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",gb.message),a.o6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(Q,ea,Z,ca){this.Add(Q,Z[u.a.uWc]||null,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||
!1,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,ea,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,ca)};a.prototype.zdd=function(Q,ea,Z,ca,I,H,L,U,fa){this.nFc.xb(Q)?ca=this.nFc.oa(Q):(ca=new c(Q,this.getWebApplicationResource(Q).split(",")[0],ca,this.getDefaultDisplayName(Q)),this.nFc.add(Q,
ca));var aa=ca.resource;Q=a.JXh(aa,this.getWebApplicationId(Q));var na=OfficeExt.WACUtils.getHostSecure(ea);Q&&na?Q.toLowerCase()===na.toLowerCase()?ca.zdd(I,H,Z,L,U,fa):(a.kOa('SSO Resource "'+aa+'" cannot be used from "'+ea+'" origin due to domain mismatch.'),y.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.o6(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(Q||y.ULS.sendTraceTag(594118746,344,
10,"Invalid resource URL for SSO."),na||y.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.o6(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.zkc=function(){var Q={};y.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(Q.UserAgent=window.navigator.userAgent,Q))};a.prototype.getOsfControl=function(Q){return this.zm.getOsfControl(Q)};a.prototype.isSSOAddin=function(Q){return this.getOsfControl(Q).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=
function(Q){return this.getOsfControl(Q).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(Q){return this.getOsfControl(Q).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(Q){return this.getOsfControl(Q).getManifest().getDefaultDisplayName()};a.rZh=function(){try{var Q={};A.a.nla&&B.a.Wxb&&(Q.UiHostSupportsAuthTokenAddinList=a.ZUe);Q.UiHostSupportsAuthToken=B.a.Wxb;return Q}catch(ea){y.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",
ea.message)}return null};a.getInstance=function(Q,ea,Z){a.Ma||(a.Ma=new a(Q,void 0===Z?null:Z));return a.Ma};a.kOa=function(Q){window.console.warn&&window.console.warn(Q)};a.JXh=function(Q,ea){if(!Q)return"";ea||(ea="");var Z=Q.toLowerCase(),ca=ea.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(ca)||(a.kOa('SSO App Id "'+ea+'" is not a valid format. It will be rejected from store submission.'),y.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));
Z.endsWith(ca)||(a.kOa('SSO Resource "'+Q+'" does not end with App Id "'+ea+'". It will be rejected from store submission.'),y.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!Z.startsWith("https://")&&!Z.startsWith("api://"))return a.kOa('SSO Resource "'+Q+'" must be https:// or api:// protocol.'),y.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ea=0;ea<Q.length;ea++){ca=Q.charAt(ea);var I=M.a.charCodeAt(Q,ea);if(33>I||126<I||"&"===
ca||"?"===ca||"#"===ca||"%"===ca||"\\"===ca)return a.kOa('SSO Resource "'+Q+'" contains an invalid character "'+ca+'".'),y.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+ca+"' in resource URI."),""}if(0<=Q.indexOf("::"))return a.kOa('SSO Resource "'+Q+'" contains an invalid string "::".'),y.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<Q.length)return a.kOa('SSO Resource "'+Q+'" is '+Q.length+" characters and exceeds the max length of 120 characters."),y.ULS.sendTraceTag(590962912,
344,10,"Length of resource: "+Q.length+"."),"";Z.startsWith("api://")&&(Z="https://"+Z.substring(6,Z.length));return 8===Z.length?"":OfficeExt.WACUtils.getHostSecure(Z)||""};a.o6=function(Q,ea,Z,ca){var I=Q.startTime,H=0;0<I&&(H=a.Iw()-I);var L={};I=(L.callInstanceId=I.toString(),L.callDuration=H.toString(),L.errorCode=ea.toString(),L);if(ca)for(var U in ca)I[U]=ca[U];y.ULS.sendTraceTag(51401116,344,50,"{0}",I);T.a.sendTelemetryEvent(Object.assign(new R.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",
dataFields:v.a.al(I)}));Q.callback(ea,Z)};a.Iw=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(Q){}return Date.now()};a.ZUe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Ma=null;Object(z.a)(a,"AppsForOfficeSingleSignOnManager",null,[48])},1068:function(z,E,b){function a(){var e={};this.U$c=(e.tabhome="Ribbon.Home",e.tabinsert="Ribbon.Insert",
e.tabdata="Ribbon.Data",e.tabreview="Ribbon.Review",e.tabview="Ribbon.View",e);e={};this.S$c=(e.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.fa(1598),c.a.instance.fa(1602)],e.tabformulas=["Ribbon.Formulas",c.a.instance.fa(1599),c.a.instance.fa(1603)],e.tabdeveloper=["Ribbon.Developer",c.a.instance.fa(1600),c.a.instance.fa(1604)],e.tabaddins=["Ribbon.AddIns",c.a.instance.fa(1601),c.a.instance.fa(1605)],e);this.Fyh="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");
this.U2a=null}b.d(E,"a",function(){return a});z=b(0);var c=b(15);a.prototype.MTh=function(){if(this.U2a)return this.U2a;this.U2a={};for(var e=Cl(Object.keys(this.U$c)),f=e.next();!f.done;f=e.next())f=f.value,this.U2a[f]=this.U$c[f];e=Cl(Object.keys(this.S$c));for(f=e.next();!f.done;f=e.next())f=f.value,this.U2a[f]=this.S$c[f][0];return this.U2a};Ck.Object.defineProperties(a.prototype,{yia:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},sK:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},
formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},Xzc:{configurable:!0,enumerable:!0,get:function(){return this.U$c}},S$a:{configurable:!0,enumerable:!0,get:function(){return this.Fyh}},JBi:{configurable:!0,enumerable:!0,get:function(){return this.S$c}}});Object(z.a)(a,"AddinCommandsStringProvider",null,[824])},1078:function(z,E,b){function a(){this.$La=0;this.Wha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Aec=!1;this.x$e=this.Oia=
null}b.d(E,"a",function(){return a});z=b(0);Object(z.a)(a,"AddInCommandsNotificationParameters",null,[])},1138:function(z,E,b){function a(){}function c(){}function e(H,L,U,fa,aa,na){H=f.call(this,H,L,U,fa,aa,void 0===na?null:na)||this;H.TUb=null;return H}function f(H,L,U,fa,aa,na){H=m.call(this,H,U,aa.UX,void 0===na?null:na)||this;H.yce=0;H.P1=H.RTh(fa);H.tYa=L;H.ef=aa;H.MKj=7;H.ql=H.tYa.ownerDocument.createElement("div");H.ql.className="ModalCalloutControlOverlay";H.ql.tabIndex=0;H.tYa.insertBefore(H.ql,
H.tYa.firstChild);return H}function m(H,L,U,fa){var aa=x.call(this,document.createElement("div"))||this;aa.ira=null;aa.Mpa=null;aa.KG=null;aa.FG=null;aa.rx=null;aa.DT=null;aa.HT=null;aa.wqa=!1;aa.ujb=!1;aa.Tp=null;aa.content=null;aa.P1=0;aa.lue=null;aa.JU=0;aa.RDf=null;aa.bje=H;aa.oee=L;aa.MP=U;aa.yHa=fa;aa.yg=L.ownerDocument;aa.Kjb=!1;aa.rv=!1;aa.qkd=!1;return aa}z=b(0);var n=b(14),w=b(82),h=b(156),y=b(13),r=b(91),x=Sys.UI.Control;Am(m,x);m.prototype.show=function(){this.Kjb||(this.I6g(),this.ro(),
this.oee.appendChild(this.WW),this.WW.style.display="Block",this.Vtj(),this.Kjb=!0,this.RDf&&this.RDf())};m.prototype.dismiss=function(){this.Kjb&&(this.O1a(),this.oee.removeChild(this.WW),this.Kjb=!1,this.yHa&&this.yHa())};m.prototype.dispose=function(){this.dismiss();this.DT=this.rx=this.FG=this.Mpa=this.KG=this.ira=null;Sys.Component.prototype.dispose.call(this)};m.prototype.pi=function(H){return this.get_element().id+H};m.prototype.I6g=function(){this.KG=this.yg.createElement("div");this.KG.id=
this.pi("WACCalloutHeader");this.KG.className="WACCalloutHeader";this.rv&&this.lme();this.qkd&&this.Bne();this.FG=this.yg.createElement("div");this.FG.id=this.pi("WACCalloutContent");this.FG.className="WACCalloutContent";this.FG.style.width=190<this.P1?this.P1-26+"px":"164px";this.FG.appendChild(this.content);this.WW.appendChild(this.S0b);this.WW.appendChild(this.KG);this.WW.appendChild(this.FG)};m.prototype.lme=function(){this.rx=this.yg.createElement("a");this.rx.className="WACCalloutCloseAnchor";
this.rx.id=this.pi("WACCalloutCloseAnchor");this.rx.href="#";this.KG.appendChild(this.rx);var H=h.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.rx.appendChild(H)};m.prototype.Bne=function(){this.DT=this.yg.createElement("div");this.DT.className="WACCalloutTitle UIFontBold";this.DT.style.width=190<this.P1?this.P1-30+"px":"160px";this.DT.id=this.pi("WACCalloutTitle");this.DT.innerText=this.title;this.KG.contains(this.rx)?this.KG.insertBefore(this.DT,
this.rx):this.KG.appendChild(this.DT)};m.prototype.Vtj=function(){var H=this.bje;if(1===this.JU){var L=this.lue.y+16;var U=-16}else 2===this.JU||3===this.JU||0===this.JU?(L=H.y+H.height+15,U=-15):(L=H.y-this.WW.clientHeight-15-2,U=this.WW.clientHeight-1);this.WW.style.top=L+"px";this.S0b.style.top=U+"px";1===this.JU?(H=this.lue.x-16,this.WW.style.left="50%",this.WW.style.marginLeft=-this.P1/2+"px",L=Sys.UI.DomElement.getBounds(this.WW),this.S0b.style.left=H-L.x+"px"):(L=H.x+this.bje.width/2,2===this.JU||
5===this.JU?(H=20,L-=36):0===this.JU||4===this.JU?(H=this.P1/2-16,L-=this.P1/2):(H=this.P1-20-32,L=L-this.P1+36),this.WW.style.left=L+"px",this.S0b.style.left=H+"px")};m.prototype.ro=function(){this.rv&&!this.HT&&(this.HT=Object(w.a)(this,this.Y$,"closeHandler"),this.MP.pa(y.a.click,this.rx,this.HT,null))};m.prototype.O1a=function(){this.rv&&this.HT&&(this.MP.za(y.a.click,this.rx,this.HT),this.HT=null)};m.prototype.Y$=function(){this.dismiss();return!0};Ck.Object.defineProperties(m.prototype,{WW:{configurable:!0,
enumerable:!0,get:function(){this.ira||(this.ira=this.yg.createElement("div"),this.ira.id=this.pi("WACCalloutOuter"),this.ira.className="WACCalloutOuter",this.ira.setAttribute(r.a.Rd,r.a.PZa),this.ira.style.width=this.P1+"px");return this.ira}},S0b:{configurable:!0,enumerable:!0,get:function(){if(!this.Mpa){this.Mpa=this.yg.createElement("div");this.Mpa.id=this.pi("WACCalloutBeakContainer");this.Mpa.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";if(5===this.JU||6===this.JU||
4===this.JU)H="CalloutBeakBottomFilled_32x16x32";H=h.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.Mpa.appendChild(H)}return this.Mpa},set:function(H){this.Mpa=H}},DMa:{configurable:!0,enumerable:!0,get:function(){return this.Kjb}},title:{configurable:!0,enumerable:!0,get:function(){return this.Tp},set:function(H){this.Tp!==H&&(this.Tp=H,this.DT&&(this.DT.innerText=this.Tp))}},rv:{configurable:!0,enumerable:!0,get:function(){return this.wqa},set:function(H){this.wqa!==H&&(this.wqa=H,this.KG&&
(this.KG.contains(this.rx)&&!this.wqa?this.KG.removeChild(this.rx):!this.KG.contains(this.rx)&&this.wqa&&this.lme()))}},qkd:{configurable:!0,enumerable:!0,get:function(){return this.ujb},set:function(H){this.ujb!==H&&(this.ujb=H,this.KG&&(this.KG.contains(this.DT)&&!this.ujb?this.KG.removeChild(this.DT):!this.KG.contains(this.DT)&&this.ujb&&this.Bne()))}}});Object(z.a)(m,"Callout",Sys.UI.Control,[206]);Am(f,m);f.prototype.show=function(){this.DMa||(this.ef.Kqc(),this.ef.fQ(!1),this.ql.style.zIndex=
String(this.ef.T2),m.prototype.show.call(this),this.Ek(),this.yce=window.setTimeout(Object(w.a)(this,this.dismiss,"dismiss"),1E3*this.MKj))};f.prototype.dismiss=function(){this.DMa&&(this.ef.TM(!1),this.wm(),this.tYa&&this.tYa.contains(this.ql)&&this.tYa.removeChild(this.ql),m.prototype.dismiss.call(this),window.clearTimeout(this.yce))};f.prototype.Ek=function(){this.ef.jsa(Object(w.a)(this,this.dismiss,"dismiss"));this.ef.Uy.pa(y.a.click,this.ql,Object(w.a)(this,this.vd,"onClick"))};f.prototype.wm=
function(){this.ef.Tbb(Object(w.a)(this,this.dismiss,"dismiss"));this.ef.Uy.za(y.a.click,this.ql,Object(w.a)(this,this.vd,"onClick"))};f.prototype.vd=function(){this.dismiss();return!0};f.prototype.RTh=function(H){var L=0;switch(H){case 0:L=190;break;case 1:L=250;break;case 2:L=300;break;case 3:L=360}return L};Object(z.a)(f,"ModalCallout",m,[]);var t=b(627),u=b(203);Am(e,f);e.prototype.show=function(){var H=this;if(!this.DMa){var L=Object.assign(new t.a,{onShow:function(){f.prototype.show.call(H)}});
u.UISurfaces.ZV().then(function(U){var fa=U.externalNotification();H.TUb=U.addNotification(fa,L);return null},function(U){n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",U);return null})}};e.prototype.dismiss=function(){var H=this;this.DMa&&this.TUb&&(u.UISurfaces.ZV().then(function(L){L.removeNotification(H.TUb);return H.TUb=null},function(L){n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null}),f.prototype.dismiss.call(this))};
Object(z.a)(e,"ReactManagedModalCallout",f,[]);var B=b(4);c.t8g=function(H,L,U,fa){var aa=void 0===aa?null:aa;return B.AFrameworkApplication.sa.Pa.PR?new e(H,L,U,fa,B.AFrameworkApplication.sa,aa):new f(H,L,U,fa,B.AFrameworkApplication.sa,aa)};Object(z.a)(c,"ModalCalloutControlFactory",null,[]);var v=b(52),C=b(1066),A=b(642),M=b(1067),T=b(133),R=b(57),Q=b(39),ea=b(85),Z=b(942),ca=b(1018),I=b(905);b.d(E,"a",function(){return a});a.M3c=function(H,L,U,fa,aa,na){a.rJ&&a.rJ.DMa&&a.rJ.dismiss();a.rJ=c.t8g(L,
H,H,aa);a.rJ.content=U;I.b(fa)||(a.rJ.title=fa,a.rJ.qkd=!0);H=new Sys.UI.Bounds(0,0,R.a.Z4a(),R.a.Ycc());a.rJ.JU=a.DLh(H,L,a.rJ.P1,na);a.rJ.show();a.o0b&&a.o0b.sendNotification(U.innerText,!0)};a.O3c=function(H,L,U,fa){fa=void 0===fa?null:fa;u.UISurfaces.ZV().then(function(aa){var na=null;a.Elb&&(aa.removeNotification(a.Elb),a.Elb=null);var ha=aa.callout(Object.assign(new C.a,{target:H,title:L,content:U,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new M.a,
{onDismiss:function(){aa.removeNotification(na)},directionalHint:null!=fa?fa:null})})),ka=Object.assign(new t.a,{expirationOptions:Object.assign(new A.a,{displayTimeoutSeconds:7,onExpire:function(){aa.removeNotification(a.Elb)}})});na=a.Elb=aa.addNotification(ha,ka);return null},function(aa){n.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",aa);return null})};a.xSd=function(H,L){L=void 0===L?null:L;a.rJ&&a.rJ.DMa&&a.rJ.dismiss();var U=new T.StandardDialog;U.NSa=!1;U.jc=
0;U.cA(v.a.Ori,CommonUIStrings.l_DialogError,I.b(H)?a.HZe():H,L)};a.zSd=function(H){a.rJ&&a.rJ.DMa&&a.rJ.dismiss();n.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",H.errorCode));var L=I.b(H.description)?a.HZe():H.description,U=new T.StandardDialog,fa=null;H.Wha?(U.jc=1,U.Bc(1,H.buttonText),U.iea(1)):U.jc=0;fa=function(aa){1===aa?H.Wha():H.Oia&&H.Oia()};U.NSa=!1;0===H.$La?U.cA(H.errorCode,H.title?H.title:CommonUIStrings.l_DialogError,L,fa):1===H.$La?
U.OX(H.title?H.title:CommonUIStrings.l_DialogWarning,L,fa):U.hBa(H.title?H.title:CommonUIStrings.l_DialogInfo,L,fa)};a.DLh=function(H,L,U,fa){var aa=0===fa?0:4,na=H.x+H.width-L.x-L.width;L.x-H.x+L.width/2<=U/2?aa=0===fa?2:5:na+L.width/2<=U/2&&(aa=0===fa?3:6);return aa};a.Xzj=function(H,L,U,fa,aa,na){na=void 0===na?!1:na;var ha=B.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1),ka=B.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",
!1);if(a.i_d)(L=ca.a.evb(fa))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(L,function(Aa){Aa&&(ha&&ka&&na||a.O3c(Aa,aa,U,5))});else if(H)if(fa&&fa.tabs.count){fa=fa.tabs.oa(0);var xa=fa.vTa[Z.a.id],va=fa.pK.oa(0).ewa[Z.a.id];H.gOd(xa)&&(H=fa.isOfficeTab?H.tRh(xa,va):H.p_h(xa))&&(H.x+H.width/2>R.a.Z4a()&&(H=new Sys.UI.Bounds(R.a.Z4a(),H.y+H.height,0,0)),ha&&ka&&na||a.M3c(L,H,a.Nve(U),aa,2,0))}else n.ULS.sendTraceTag(17326355,220,
50,"There is no tab or group added to ribbon !");else n.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.Yzj=function(H,L,U,fa,aa){aa=void 0===aa?!1:aa;a.Xzj(H,L,fa.startedNode?fa.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,U),fa,fa.startedNode?fa.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,U),aa)};a.Wzj=function(H,L,U,fa){if(a.i_d)H=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,
String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,U,fa,CommonUIStrings.l_InsertionDialogRefresh)),a.O3c(L,H,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{L=Q.a.Rn(L);var aa=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),na=document.createElement("span");na.innerText=aa[0];var ha=document.createElement("span");ha.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,U,fa,CommonUIStrings.l_InsertionDialogRefresh);ha.className="UIFontBold";
U=document.createElement("span");U.innerText=aa[1];fa=document.createElement("div");Sys.UI.DomElement.addCssClass(fa,"ModalCalloutControl");fa.appendChild(na);fa.appendChild(ha);fa.appendChild(U);a.M3c(H,L,fa,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.nBj=function(H,L){var U=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,fa=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.i_d?a.O3c(L,U,fa):(L=Q.a.Rn(L),a.M3c(H,L,a.Nve(fa),U,3,1))};a.Nve=function(H){var L=document.createElement("div");
Sys.UI.DomElement.addCssClass(L,"ModalCalloutControl");L.innerText=H;return L};a.HZe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Ck.Object.defineProperties(a,{o0b:{configurable:!0,enumerable:!0,get:function(){return a.wfa||(a.wfa=ea.a.instance.Lh("Common.Utils.IAriaNotifier"))}},i_d:{configurable:!0,enumerable:!0,get:function(){return B.AFrameworkApplication.sa.Pa.Oi&&B.AFrameworkApplication.sa.Pa.PR}}});a.rJ=null;a.Elb=null;a.wfa=null;Object(z.a)(a,
"AddInCommandsNotificationFactory",null,[])},1148:function(z,E,b){function a(u,B,v,C,A){this.Ns=u;this.kJ=v;this.g2=C;this.ee=A;this.bib=this.kJ.Gi;this.az=this.bib.getOsfControl(B);this.Xsg=this.az.getManifest()}function c(u,B,v,C){this._id=u;this.Ns=B;this.g2=v;this.ee=C}function e(u,B,v,C){this.sA=!1;this._id=u;this.Ns=B;this.g2=v;this.ee=C}b.r(E);z=b(0);var f=b(14),m=b(1476),n=b(152),w=b(123),h=b(929),y=b(944),r=b(355);e.prototype.setEnabled=function(){};e.prototype._OnAccess=function(){};e.prototype.getTypeName=
function(){return"Microsoft.DynamicRibbon.RibbonButton"};e.prototype.invokePropertyGet=function(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};e.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};e.prototype.invokePropertySet=function(u,B){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};e.prototype.invokePropertySetAsync=function(u,B){this.invokePropertySet(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};e.prototype.invokeMethod=function(u,B){switch(u){case 5:return this.Hqj(B);case 1:return this.QCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};e.prototype.invokeMethodAsync=function(u,B){u=this.invokeMethod(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};
e.prototype.Hqj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null};e.prototype.QCa=function(){this._OnAccess();return null};Ck.Object.defineProperties(e.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.sA},set:function(u){var B=b(1148).DynamicRibbon,v=this.ee.OwnerAddinStoreType,C=this.ee.PrimaryMarketplace.MarketplaceRef,A={};A=(A.addinAssetId=Telemetry.PrivacyRules.GetAssetId(v,C,this.Ns),A.ownerAddinAssetId=
Telemetry.PrivacyRules.GetAssetId(v,C,this.ee.OwnerAddinAssetId),A.ownerAddinStoreType=v,A.ribbonControlType="Button",A.toggle=u,A);n.a.sendTelemetryEvent(Object.assign(new r.a,{name:B.qAc+"ControlUpdate",dataFields:w.a.al(A)}));this.sA=u;u={};v=(u.DynamicAddinCommandsMethodDispatchId=1,u.SolutionId=this.Ns,u.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(v,C,this.Ns),u.SourceControlId=this.id,u.MethodData=this.sA,u);this.g2.qK(-1014260128,v)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},
label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(z.a)(e,"RibbonButton",null,[]);c.prototype.setVisibility=function(u){var B=b(1148).DynamicRibbon,v=this.ee.OwnerAddinStoreType,C=this.ee.PrimaryMarketplace.MarketplaceRef,A={};A=(A.addinAssetId=Telemetry.PrivacyRules.GetAssetId(v,C,this.Ns),A.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(v,C,this.ee.OwnerAddinAssetId),A.ownerAddinStoreType=v,A.ribbonControlType="Tab",A.toggle=u,A);n.a.sendTelemetryEvent(Object.assign(new r.a,
{name:B.qAc+"ControlUpdate",dataFields:w.a.al(A)}));B={};u=(B.DynamicAddinCommandsMethodDispatchId=2,B.SolutionId=this.Ns,B.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(v,C,this.Ns),B.StoreType=v,B.SourceControlId=this.id,B.MethodData=u,B);this.g2.qK(-1014260128,u)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=function(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};c.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};c.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertySetAsync=function(u,B){this.invokePropertySet(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(u,B){switch(u){case 3:return this.xuj(B);case 1:return this.QCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};c.prototype.invokeMethodAsync=function(u,B){u=this.invokeMethod(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};c.prototype.xuj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);return null};c.prototype.QCa=function(){this._OnAccess();return null};Ck.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(z.a)(c,"RibbonTab",null,[]);var x=b(1185),t=b(169);
b.d(E,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(u){try{var B={},v=(B.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ee.OwnerAddinStoreType,this.ee.PrimaryMarketplace.MarketplaceRef,this.Ns),B.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ee.OwnerAddinStoreType,this.ee.PrimaryMarketplace.MarketplaceRef,this.ee.OwnerAddinAssetId),B.ownerAddinStoreType=this.ee.OwnerAddinStoreType,B.ribbonControlType="Ribbon",B);n.a.sendTelemetryEvent(Object.assign(new r.a,
{name:a.qAc+"ExecuteRequestCreate",dataFields:w.a.al(v)}));var C=t.a.oi(u);u={};B={};B[h.a.cJa]=this.az;B[h.a.dJa]=C;B[h.a.a8c]=this.ee;u[h.a.itb]=3;u[h.a.w4]=this.Ns;u[h.a.W7b]=Telemetry.PrivacyRules.GetAssetId(this.ee.OwnerAddinStoreType,this.ee.PrimaryMarketplace.MarketplaceRef,this.Ns);u[h.a.v4]=B;this.g2.qK(-1014260128,u);var A=a.tac("ExecuteRequestCreate",!0,"");f.ULS.sendTraceTag(538572826,0,50,A)}catch(M){C=a.tac("ExecuteRequestCreate",!1,M.toString()),f.ULS.sendTraceTag(538572825,0,50,C)}return null};
a.prototype.executeRequestUpdate=function(u){try{var B=null,v=null;B=this.ee.OwnerAddinStoreType;v=this.ee.PrimaryMarketplace.MarketplaceRef;var C={},A=(C.addinAssetId=Telemetry.PrivacyRules.GetAssetId(B,v,this.Ns),C.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(B,v,this.ee.OwnerAddinAssetId),C.ownerAddinStoreType=this.ee.OwnerAddinStoreType,C.ribbonControlType="Ribbon",C);n.a.sendTelemetryEvent(Object.assign(new r.a,{name:a.qAc+"ExecuteRequestUpdate",dataFields:w.a.al(A)}));var M=t.a.oi(u);
u={};C={};C[h.a.cJa]=this.az;C[h.a.dJa]=M;C[h.a.a8c]=this.ee;u[h.a.itb]=3;u[h.a.w4]=this.Ns;u[h.a.W7b]=Telemetry.PrivacyRules.GetAssetId(B,v,this.Ns);u[h.a.v4]=C;this.g2.qK(-1014260128,u);var T=a.tac("ExecuteRequestUpdate",!0,"");f.ULS.sendTraceTag(538572824,0,50,T)}catch(R){B=a.tac("ExecuteRequestUpdate",!1,R.toString()),f.ULS.sendTraceTag(538572823,0,50,B)}return null};a.prototype.getButton=function(u){var B=null;if(!this.Rdf())return this.YDe();if(u&&0<u.length){if(!this.gze(u))return this.qEe(u);
B=new e(u,this.Ns,this.g2,this.ee)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)};a.prototype.getTab=function(u){var B=null;if(!this.Rdf())return this.YDe();if(this.az.getOwnerAddinControlRecreated())return this.I7g();if(u&&0<u.length){if(!this.gze(u))return this.qEe(u);B=new c(u,this.Ns,this.g2,this.ee)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};
a.prototype.invokePropertyGet=function(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokePropertySetAsync=function(u,B){this.invokePropertySet(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
a.prototype.invokeMethod=function(u){switch(u){case 1:return this.QCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokeMethodAsync=function(u,B){switch(u){case 7:return this.azh(B);case 6:return this.bzh(B);case 3:return this.jLh(B);case 5:return this.o_h(B)}u=this.invokeMethod(u,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.azh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestCreate(u)};
a.prototype.bzh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)};a.prototype.jLh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)};a.prototype.o_h=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getTab(u)};a.prototype.QCa=function(){this._OnAccess();return null};a.prototype.qEe=function(u){return x.a(y.a.m3g,t.a.fa(1731)+
u)};a.prototype.YDe=function(){return x.a(y.a.Iij,t.a.fa(1727))};a.prototype.I7g=function(){return x.a(y.a.hostRestartNeeded,t.a.fa(1732))};a.prototype.Rdf=function(){var u=this.az.getSharedRuntimeId();u=!!u&&0<u.length;f.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u};a.prototype.gze=function(u){var B=this.Xsg.getRibbonExtensionControlMap();return u in B||this.uXg(u)};a.prototype.uXg=function(u){var B=this.NCh();if(B){B=Cl(B.VKe.tabs);
for(var v=B.next();!v.done;v=B.next()){v=v.value;if(v.id===u)return!0;v=Cl(v.groups);for(var C=v.next();!C.done;C=v.next()){C=Cl(C.value.controls);for(var A=C.next();!A.done;A=C.next()){A=A.value;if(A.id===u)return!0;if("Menu"===A.type){A=Cl(A.items);for(var M=A.next();!M.done;M=A.next())if(M.value.id===u)return!0}}}}}return!1};a.prototype.NCh=function(){return m.a.getInstance().O4(this.ee.PrimaryMarketplace.MarketplaceType,this.ee.PrimaryMarketplace.SolutionId,1)};a.tac=function(u,B,v){var C={};
C.methodName="DynamicRibbon."+u;C.result=B?"Succeeded":"Failed";C.message=v;return t.a.Lc(C)};Ck.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.qAc="Office.Online.Extensibility.Ribbon.";Object(z.a)(a,"DynamicRibbon",null,[])},1163:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.E9b="extId";a.bCe="ComponentType";a.LHa="ComponentId";a.old="HostProps";a.pza="OptionalProps";Object(z.a)(a,"ActionPropertyNames",null,[])},
1182:function(z,E,b){function a(c,e){var f=!1;c&&(c=e.osfControl,(e=c.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(f=!0));return f}b.d(E,"a",function(){return a})},1184:function(z,E,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.Hha=this.LTa=this.Kfd=this.Yhd=this.Qwb=this.gWd=null}b.d(E,"a",function(){return a});z=b(0);Object(z.a)(a,"AppsForOfficeOauthResult",null,[])},1185:function(z,E,b){function a(c,e){return OfficeExtension.WacRuntime.Utility.createPromise(function(f,
m){m(OfficeExtension.WacRuntime.Utility.createRichApiException(c,e))})}b.d(E,"a",function(){return a})},1299:function(z,E,b){function a(ra,Na,gb){this.jxa=!1;this.sF={};this.$=ra;this.wj=Na;this.mnd().wna();this.indexedDB=gb;this.indexedDB.Mg()&&(this.jxa=!0,this.indexedDB.initialize(a.lmd,a.mmd))}function c(ra,Na){this.wRc=ra;this._message=Na}function e(){}function f(){}function m(ra){switch(ra){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function n(ra,
Na){t(b(1299).CustomFunctionsInstaller.M0e("CustomFunctionsRuntimeLogging"),function(gb){if(gb.result&&window.console)switch(gb=m(ra.severity)+" "+ra.message+Na,ra.severity){case 2:window.console.log&&window.console.log(gb);break;case 0:window.console.info&&window.console.info(gb);break;case 1:window.console.error&&window.console.error(gb)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function w(ra,Na,gb,ob,wb){gb=ra.CWCT(function(){Na(ra)},
gb,3,ob);gb.continueWith(function(){R.ULS.sendTraceTag(537163459,0,10,wb)},4);return gb}function h(ra,Na,gb){return w(ra,Na,ka.a.none,xa.a.current,gb)}function y(ra,Na,gb,ob,wb){gb=ra.CWRCT(function(){return Na(ra)},gb,3,ob);gb.continueWith(function(){R.ULS.sendTraceTag(537163460,0,10,wb)},4);return fa.TaskExtensions.RBc(gb)}function r(ra,Na,gb){return y(ra,Na,ka.a.none,xa.a.current,gb)}function x(ra,Na,gb,ob,wb){gb=ra.CWRCT(function(){return Na(ra)},gb,3,ob);gb.continueWith(function(){R.ULS.sendTraceTag(537163461,
0,10,wb)},4);return gb}function t(ra,Na,gb){return x(ra,Na,ka.a.none,xa.a.current,gb)}function u(ra,Na,gb,ob,wb){gb=ra.CWRCT(function(){return Na(ra)},gb,3,ob);gb.continueWith(function(){R.ULS.sendTraceTag(537163462,0,10,wb)},4);return fa.TaskExtensions.RBc(gb)}function B(ra,Na,gb){return u(ra,Na,ka.a.none,xa.a.current,gb)}function v(ra,Na,gb,ob,wb){gb=ra.CWCT(function(){Na(ra)},gb,3,ob);gb.continueWith(function(){R.ULS.sendTraceTag(537163463,0,10,wb)},4);return gb}function C(ra,Na,gb){return v(ra,
Na,ka.a.none,xa.a.current,gb)}function A(){}function M(ra){ra=ra.split("|");this.Ns=ra[1];this.ZRc=ra[2];this.bVd=ra[3]}b.r(E);z=b(0);var T=b(7),R=b(14),Q=b(4),ea=b(161),Z=b(201),ca=b(83),I=b(561),H=b(175),L=b(84),U=b(51),fa=b(36),aa=b(230),na=b(119),ha=b(592);Ck.Object.defineProperties(M.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ns}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.ZRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,
get:function(){return this.bVd===OSF.StoreTypeEnum.Registry.toString()}}});Object(z.a)(M,"AddinStoreInfo",null,[]);Object(z.a)(A,"CustomFunctionRegistrationInfos",null,[]);var ka=b(211),xa=b(61),va=b(1182);Object(z.a)(f,"InstallationInfo",null,[]);Object(z.a)(e,"UninstallationInfo",null,[]);var Aa=b(28),qa=b(95),wa=b(35),Ta=b(30),sb=b(1),db=b(22),kb=b(292),ac=b(993),ta=b(55);Ck.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.wRc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(z.a)(c,"CustomFunctionLog",null,[]);b.d(E,"CustomFunctionsInstaller",function(){return a});a.prototype.ubf=function(ra,Na,gb,ob){var wb=this;if(ob.invariantNamespace)for(var Oa=0;Oa<ob.invariantNamespace.length;++Oa){var sa=ob.invariantNamespace.charAt(Oa);if("."!==sa&&"_"!==sa&&"a">sa&&"z"<sa&&"A">sa&&"Z"<sa&&"0">sa&&"9"<sa)throw R.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
sa,Oa),Error.create("InvariantNamespace validation failed");}return B(this.MTg(gb,ob.manifest),function(){return B(wb.OHd(ra),function(Fa){var Wa=Fa.result;return(null===Wa||void 0===Wa?0:Wa.isDynamicMetadata)?wb.NId(ra,Na,Wa,!1,!1,!1):B(wb.FYj(ra,Na,ob),function(Db){var pc;Wa=(pc=new f,pc.addinId=gb,pc.locale=ob.locale,pc.addinInvariantNamespace=ob.invariantNamespace,pc.addinNamespace=ob.namespace,pc.addinTitle=ob.title,pc.isXllCompatible=ob.isXllCompatible,pc.metadataContent=JSON.stringify(JSON.parse(Db.result)),
pc);return wb.NId(ra,Na,Wa,!1,a.bAh(ob.osfControl.getStoreType()),va.a(wb.$,ob))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.wbf=function(ra,Na,gb,ob){var wb=this;if(!a.rsd(gb))throw R.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
Error.create("Invalid Metadata JSON");return B(this.OHd(ra),function(Oa){Oa=Oa.result;if(!Oa&&(Oa=wa.a.Nc(wb.kW,ra),!Oa))throw R.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Na,null))),Error.create("Customfunctions dynamic registration failed");Oa.metadataContent=JSON.stringify(JSON.parse(gb));Oa.isDynamicMetadata=!0;
return wb.NId(ra,Na,Oa,!0,!0,ob)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};a.prototype.Ybg=function(ra,Na){var gb=this;this.wj.$ia();var ob=Object(T.a)(new e,{solutionId:ra}),wb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Na,null));return B(this.wJd(ra),function(){return B(gb.DJd(ra),function(){return gb.HYd(gb.wj,ra,
Na,ob)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},wb)};a.prototype.FYj=function(ra,Na,gb){var ob=new ea.a;OSF.OUtil.xhrGet(gb.metadataUrl,function(wb){wb?ob.setResult(wb):ob.setException(Error.create("Invalid manifest"))},function(wb){R.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Na,null),wb);ob.setException(Error.create("Failed to download manifest"))});
return ob.task};a.prototype.mnd=function(){var ra=this;return B(this.Orc(),function(Na){var gb=Na.result;if(!gb.length)return ta.Task.Ra(!0);R.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Na=new Z.a;for(var ob=[],wb={},Oa=0;Oa<gb.length;wb={mQb:wb.mQb},Oa++)wb.mQb=Object(ca.a)(String,gb[Oa]),Na.add(t(ra.OHd(wb.mQb),function(sa){return function(Fa){if(Fa=Fa.result){var Wa=wa.a.Nc(ra.sF,Fa.addinId);Wa&&Wa===Fa.metadataContent||
(ra.sF[Fa.addinId]=Fa.metadataContent,ra.kW[sa.mQb]=Fa,ob.push(Fa))}return!0}}(wb),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return r(ta.Task.WAE(Na),function(){if(ob.length){var sa,Fa=(sa=new A,sa.registrationInfos=ob,sa);return ra.R0b(ra.wj,gb,Fa)}R.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ta.Task.Ra(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.xbf=function(){var ra=this,Na=new ea.a;new Z.a;var gb=[],ob=[];Object.keys(this.kW).forEach(function(wb){wb=Object(ca.a)(String,wb);var Oa=wa.a.Nc(ra.kW,wb);gb.push(Oa);ob.push(wb)});if(!ob.length)return Na.setResult(!0),Na.task;Na=Object(T.a)(new A,{registrationInfos:gb});return this.R0b(this.wj,ob,Na)};a.prototype.Orc=function(){return t(this.cgd(ha.a.sZa),function(ra){ra=ra.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ra||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ra||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.Ghg=function(ra){return this.SPd(ha.a.sZa,Sys.Serialization.JavaScriptSerializer.serialize(ra))};a.prototype.OHd=function(ra){return B(this.cgd(ha.a.y4a(ra)),function(Na){Na=Na.result||"";return 0<Na.length?ta.Task.Ra(Sys.Serialization.JavaScriptSerializer.deserialize(Na,!0)):ta.Task.Ra(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.yYj=function(ra,Na){var gb=this;return B(this.AMe(ra),function(){return B(gb.SPd(ha.a.y4a(ra),Sys.Serialization.JavaScriptSerializer.serialize(Na)),function(){return a.TPd(ha.a.$jd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.wJd=function(ra){var Na=this;return B(this.GPf(ra),function(){return B(Na.ZPf(ha.a.y4a(ra)),
function(){return B(Na.Orc(),function(gb){return gb.result.length?ta.Task.Ra(!0):a.TPd(ha.a.$jd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.XMf=function(ra){return this.cgd(ha.a.x4a(ra))};
a.prototype.Dhg=function(ra,Na){var gb=this;return B(this.AMe(ra),function(){return gb.SPd(ha.a.x4a(ra),Na)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.DJd=function(ra){var Na=this;return B(this.GPf(ra),function(){return Na.ZPf(ha.a.x4a(ra))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.AMe=function(ra){var Na=this;return B(this.Orc(),function(gb){gb=gb.result;
var ob=ra.toLowerCase();if(Array.contains(gb,ob))return ta.Task.Ra(!0);gb.push(ob);return Na.Ghg(gb)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.GPf=function(ra){var Na=this;return B(this.Orc(),function(gb){gb=gb.result;var ob=ra.toLowerCase();return Array.contains(gb,ob)?(gb.splice(Array.indexOf(gb,ob),1),Na.Ghg(gb)):ta.Task.Ra(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.MTg=function(ra,Na){if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ra=new OSF.AddinIdInfo(ra),ra.needToRestoreManifest()?this.Dhg(ra.getSolutionId(),Na):ta.Task.Ra(!0);ra=new M(ra);return ra.needToRestoreManifest?this.Dhg(ra.solutionId,Na):ta.Task.Ra(!0)};a.prototype.jij=function(ra){var Na=this;if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var gb=new OSF.AddinIdInfo(ra);return gb.needToRestoreManifest()?
t(this.XMf(gb.getSolutionId()),function(wb){(wb=wb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(gb.getSolutionId(),gb.getSolutionVersion(),wb,Na.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ta.Task.Ra(!0)}var ob=new M(ra);return ob.needToRestoreManifest?t(this.XMf(ob.solutionId),function(wb){(wb=wb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ob.solutionId,ob.solutionVersion,wb,Na.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ta.Task.Ra(!0)};a.prototype.ZPf=function(ra){return this.jxa?this.indexedDB.I6c(ra):a.Aaj(ra)};a.prototype.SPd=function(ra,Na){return this.jxa?this.indexedDB.Kcb(new ac.a(ra,Na)):a.TPd(ra,Na)};a.prototype.cgd=function(ra){return this.jxa?this.indexedDB.r4a(ra):a.M0e(ra)};a.prototype.NId=function(ra,Na,gb,ob,wb,Oa){var sa=this,Fa=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Na,null));return fa.TaskExtensions.RBc(t(this.OId(this.wj,ra,Na,gb,!1,ob,Oa),function(){return wb?sa.yYj(ra,gb):ta.Task.Ra(!0)},Fa))};a.prototype.OId=function(ra,Na,gb,ob,wb,Oa,sa){var Fa=this;if(!Oa&&(Oa=wa.a.Nc(this.sF,ob.addinId))&&Oa===ob.metadataContent)return ta.Task.Ra(!0);this.sF[ob.addinId]=ob.metadataContent;this.kW[Na]=ob;sa||ra.WHb(Na);ra.$ia();return B(this.d9i(Na,gb,ob),function(){return Fa.BGd(ob.addinId,wb)},"Failed to register functions for customfunction addin")};
a.prototype.d9i=function(ra,Na,gb){var ob=this,wb=new ea.a,Oa=this.Kpb(gb);return this.hja(function(sa){sb.EwaSettings.ma(257)&&n(a.nsb,ra);(sa=sa.Result)&&204===sa.ResponseStatusCode?wb.setResult(!0):(delete ob.sF[gb.addinId],delete ob.kW[ra],C(ob.wJd(ra),function(){C(ob.DJd(ra),function(){ob.Y3f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ra,sa?sa.ResponseStatusCode.toString():
"Unknown")),wb.setResult(!1))},function(sa){sa=na.a.pg(sa.data);R.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Na,null),Ta.a.Xc(sa));sb.EwaSettings.ma(257)&&n(a.msb,ra);delete ob.sF[gb.addinId];delete ob.kW[ra];wb.setResult(!1)},Oa,wb,!0)};a.prototype.R0b=function(ra,Na,gb){var ob=this,wb=new ea.a,Oa=Aa.a.Ta.oe.m;Na.forEach(function(Fa){Fa=
Object(ca.a)(String,Fa);ra.Mye(Fa)});ra.$ia();var sa=this.xZc(gb);return this.hja(function(Fa){sb.EwaSettings.ma(257)&&n(a.nsb,Sys.Serialization.JavaScriptSerializer.serialize(Na));Fa=Fa.Result;var Wa=!0,Db=Sys.Serialization.JavaScriptSerializer.deserialize(Fa.ResponseBody.toString());Db=Array.isArray(Db.value)?Db.value:null;for(var pc=new Z.a,lc={mfa:0};lc.mfa<Db.length;lc={mfa:lc.mfa},lc.mfa++)if(!Db[lc.mfa]){Wa=!1;var eb=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
Fa.ResponseStatusCode);pc.add(B(ob.wJd(Na[lc.mfa]),function(ib){return function(){delete ob.sF[gb.registrationInfos[ib.mfa].addinId];delete ob.kW[Na[ib.mfa]];return ob.DJd(Na[ib.mfa])}}(lc),eb))}h(ta.Task.WAE(pc),function(){C(ob.BGd("",!1),function(){R.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",Aa.a.Ta.oe.m-Oa);Wa?wb.setResult(Wa):h(ob.Y3f(),function(){wb.setResult(Wa)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(Fa){Fa=na.a.pg(Fa.data);R.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Ta.a.Xc(Fa));sb.EwaSettings.ma(257)&&n(a.msb,Sys.Serialization.JavaScriptSerializer.serialize(Na));
for(Fa=0;Fa<gb.registrationInfos.length;Fa++)delete ob.sF[gb.registrationInfos[Fa].addinId],delete ob.kW[Na[Fa]];wb.setResult(!1)},sa,wb,!0)};a.prototype.HYd=function(ra,Na,gb,ob){var wb=this;return B(this.UPj(ra,Na,gb,ob),function(){return wb.BGd(ob.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.UPj=function(ra,Na,gb,ob){var wb=new ea.a;ra.WHb(Na);(ra=wa.a.Nc(this.kW,Na))&&delete this.sF[ra.addinId];delete this.kW[Na];ob=this.IZc(ob);return this.hja(function(){sb.EwaSettings.ma(257)&&
n(a.G5c,Na);wb.setResult(!0)},function(Oa){Oa=na.a.pg(Oa.data);R.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(Na,gb,null),Ta.a.Xc(Oa));sb.EwaSettings.ma(257)&&n(a.F5c,Na);wb.setResult(!1)},ob,wb,!1)};a.prototype.hja=function(ra,Na,gb,ob,wb){function Oa(){function lc(cc,Pa,nc){sb.EwaSettings.ma(257)&&n(wb?a.E5c:a.H5c,eb.RequestBody);return L.i(Fa.va,
"ExecuteRichApiRequest",gb,kb.b(cc,ra),kb.a(Pa,Na),nc,null,0)}if(sa.RHa()||0<Fa.va.I4||0<Fa.Kk.I4)return!1;Wa&&sa.Cr(Wa);Db&&Fa.Dr(Db);pc&&Fa.Yz(pc);var eb=gb.request,ib=0;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?eb.RequestFlags&1&&256!==(eb.RequestFlags&256)||(ib=16):ib=eb.RequestFlags&1?0:16;sb.EwaSettings.qc()?sa.Zt(new H.a(507,0,lc,ib|64)):sa.Zt(new I.a(507,0,lc,ib));return!0}var sa=this.$.userOperationManager,Fa=this.$.na,Wa=null,Db=null,pc=null;
Oa()||(Wa=function(){Oa()},Db=function(){Oa()},pc=function(){Oa()},sa.Wu(Wa),Fa.Bq(Db),Fa.iz(pc));return ob.task};a.prototype.Kpb=function(ra){var Na={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Na.RequestBody=JSON.stringify(ra);Na.RequestFlags=1;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Na.RequestFlags|=256);ra=this.$.na.va.Na(1);ra.request=Na;return ra};a.prototype.xZc=function(ra){var Na={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};Na.RequestBody=JSON.stringify(ra);Na.RequestFlags=1;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Na.RequestFlags|=256);ra=this.$.na.va.Na(1);ra.request=Na;return ra};a.prototype.IZc=function(ra){var Na={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Na.RequestBody=JSON.stringify(ra);Na.RequestFlags=1;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Na.RequestFlags|=
256);ra=this.$.na.va.Na(1);ra.request=Na;return ra};a.prototype.BGd=function(ra,Na){var gb=this,ob=U.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return u(ob,function(){ob.result.JLd();return ra&&Na?gb.jij(ra):ta.Task.Ra(!0)},this.$.la,aa.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.Y3f=function(){var ra=new qa.a(1949669462,0,this.$.fd,0,null);return this.$.Ka.$b(ra)};a.M0e=function(ra){try{return ta.Task.Ra(localStorage.getItem(ra))}catch(Na){return R.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",Na.message||"Unknown"),ta.Task.Ra(null)}};a.TPd=function(ra,Na){try{return localStorage.setItem(ra,Na),ta.Task.Ra(!0)}catch(gb){return R.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",gb.message||"Unknown"),ta.Task.Ra(!1)}};a.Aaj=function(ra){try{return localStorage.removeItem(ra),ta.Task.Ra(!0)}catch(Na){return R.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",Na.message||"Unknown"),ta.Task.Ra(!1)}};a.bAh=function(ra){return db.a.equals(ra,"registry",!0)||db.a.equals(ra,"uploadfiledevcatalog",!0)||Q.AFrameworkApplication.userNameUnknown||Q.AFrameworkApplication.limitedEdit};a.rsd=function(ra){if(!ra)return!1;try{JSON.parse(ra)}catch(Na){return!1}return!0};Ck.Object.defineProperties(a.prototype,{kW:{configurable:!0,enumerable:!0,get:function(){return this.wj.kW}}});
a.lmd="CustomFunctionCache";a.mmd="CustomFunction";a.E5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.nsb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.msb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.H5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.G5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.F5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(z.a)(a,
"CustomFunctionsInstaller",null,[797])},1301:function(z,E,b){function a(aa){this.sF={};this.$=aa;this.mnd().wna()}function c(aa,na){this.wRc=aa;this._message=na}function e(){}function f(){}function m(aa){switch(aa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function n(aa,na){if(b(1301).CustomFunctionsLegacyInstaller.mwb("CustomFunctionsRuntimeLogging")&&window.console)switch(na=m(aa.severity)+" "+aa.message+na,aa.severity){case 2:window.console.log&&window.console.log(na);
break;case 0:window.console.info&&window.console.info(na);break;case 1:window.console.error&&window.console.error(na)}}function w(){}function h(aa){aa=aa.split("|");this.Ns=aa[1];this.ZRc=aa[2];this.bVd=aa[3]}b.r(E);z=b(0);var y=b(7),r=b(14),x=b(1138),t=b(161),u=b(83),B=b(561),v=b(175),C=b(84),A=b(51),M=b(36),T=b(119),R=b(592),Q=b(1182);Ck.Object.defineProperties(h.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ns}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.ZRc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.bVd===OSF.StoreTypeEnum.Registry.toString()}}});Object(z.a)(h,"AddinStoreInfo",null,[]);Object(z.a)(w,"CustomFunctionRegistrationInfos",null,[]);Object(z.a)(f,"InstallationInfo",null,[]);Object(z.a)(e,"UninstallationInfo",null,[]);var ea=b(157),Z=b(35),ca=b(30),I=b(1),H=b(15),L=b(292),U=b(1078),fa=b(55);Ck.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.wRc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(z.a)(c,"CustomFunctionLog",null,[]);b.d(E,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.ubf=function(aa,na,ha,ka){var xa=this,va=new t.a;if(ka.invariantNamespace)for(na=0;na<ka.invariantNamespace.length;++na){var Aa=ka.invariantNamespace.charAt(na);if("."!==Aa&&"_"!==Aa&&"a">Aa&&"z"<Aa&&"A">Aa&&"Z"<Aa&&"0">Aa&&"9"<Aa)return r.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
Aa,na),va.setResult(!1),va.task}a.cacheManifest(ha,ka.manifest);var qa=a.PHd(aa);(null===qa||void 0===qa?0:qa.isDynamicMetadata)?this.MId(aa,qa,va,!1,!1):OSF.OUtil.xhrGet(ka.metadataUrl,function(wa){qa=Object(y.a)(new f,{addinId:ha,locale:ka.locale,addinInvariantNamespace:ka.invariantNamespace,addinNamespace:ka.namespace,addinTitle:ka.title,isXllCompatible:ka.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(wa))});xa.MId(aa,qa,va,!1,Q.a(xa.$,ka))},function(wa){r.ULS.sendTraceTag(537163528,
0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",aa,wa);va.setResult(!1)});return va.task};a.prototype.wbf=function(aa,na,ha,ka){na=new t.a;if(!a.rsd(ha))return r.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),na.setResult(!1),na.task;var xa=a.PHd(aa);if(!xa)return r.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
na.setResult(!1),na.task;xa.metadataContent=JSON.stringify(JSON.parse(ha));xa.isDynamicMetadata=!0;this.MId(aa,xa,na,!0,ka);return na.task};a.prototype.Ybg=function(aa){var na=this,ha=new t.a,ka=A.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);M.TaskExtensions.Ba(ka,function(){var xa=ka.result;xa.$ia();var va=Object(y.a)(new e,{solutionId:aa});a.xJd(aa);a.EJd(aa);M.TaskExtensions.Ba(na.HYd(xa,aa,va),function(Aa){ea.b(Aa)?ha.setResult(Aa.result):(Aa.ig?r.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
aa):Aa.Oh&&r.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",aa),ha.setResult(!1))},na.$.la,0)},this.$.la,3);return ha.task};a.prototype.mnd=function(){var aa=this,na=new t.a,ha=a.THd();0<ha.length&&r.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ka=[];ha.forEach(function(va){va=Object(u.a)(String,va);if(va=a.PHd(va)){var Aa=
Z.a.Nc(aa.sF,va.addinId);Aa&&Aa===va.metadataContent||(aa.sF[va.addinId]=va.metadataContent,ka.push(va))}});if(!ka.length)return na.setResult(!0),r.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),na.task;var xa=A.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);M.TaskExtensions.Ba(xa,function(){var va=xa.result,Aa=Object(y.a)(new w,{registrationInfos:ka});M.TaskExtensions.Ba(aa.R0b(va,ha,Aa),function(qa){ea.b(qa)?
na.setResult(qa.result):(qa.ig?r.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):qa.Oh&&r.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),na.setResult(!1))},aa.$.la,0)},this.$.la,3);return na.task};a.prototype.iij=function(aa){aa=new h(aa);if(aa.needToRestoreManifest){var na=a.D6i(aa.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(aa.solutionId,
aa.solutionVersion,na,this.$.ya.UICultureTag)}};a.prototype.MId=function(aa,na,ha,ka,xa){var va=this,Aa=A.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);M.TaskExtensions.Ba(Aa,function(){M.TaskExtensions.Ba(va.OId(Aa.result,aa,na,!1,ka,xa),function(qa){ea.b(qa)?((qa=qa.result)&&a.zYj(aa,na),ha.setResult(qa)):(qa.ig?r.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",aa):qa.Oh&&r.ULS.sendTraceTag(537163487,
0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",aa),ha.setResult(!1))},va.$.la,0)},this.$.la,3)};a.prototype.OId=function(aa,na,ha,ka,xa,va){var Aa=this;if(!xa&&(xa=Z.a.Nc(this.sF,ha.addinId))&&xa===ha.metadataContent)return fa.Task.Ra(!0);this.sF[ha.addinId]=ha.metadataContent;var qa=new t.a;va||aa.WHb(na);aa.$ia();aa=this.Kpb(ha);return this.hja(function(wa){I.EwaSettings.ma(257)&&n(a.nsb,na);var Ta=wa.Result;204===Ta.ResponseStatusCode?
M.TaskExtensions.Ba(Aa.AGd(qa,ha.addinId,ka),function(sb){sb.ig?na?r.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",na):r.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ha.addinId):sb.Oh&&(na?r.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
na):r.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ha.addinId));qa.setResult(!1)},Aa.$.la,4):(wa=function(){delete Aa.sF[ha.addinId];a.xJd(na);a.EJd(na);r.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",na,Ta.ResponseStatusCode);qa.setResult(!1)},wa=Object(y.a)(new U.a,{$La:OSF.InfoType.Error,
title:ha.addinTitle,description:String.format(H.a.instance.Ab(153),H.a.instance.fa(1850)),buttonText:H.a.instance.fa(4),Wha:wa,Aec:!1,Oia:wa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),x.a.zSd(wa))},function(wa){wa=T.a.pg(wa.data);r.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",na,ca.a.Xc(wa));I.EwaSettings.ma(257)&&n(a.msb,na);delete Aa.sF[ha.addinId];qa.setResult(!1)},
aa,qa,!0)};a.prototype.R0b=function(aa,na,ha){var ka=this,xa=new t.a;na.forEach(function(Aa){Aa=Object(u.a)(String,Aa);aa.Mye(Aa)});aa.$ia();var va=this.xZc(ha);return this.hja(function(Aa){I.EwaSettings.ma(257)&&n(a.nsb,Sys.Serialization.JavaScriptSerializer.serialize(na));Aa=Aa.Result;var qa=!0,wa=Sys.Serialization.JavaScriptSerializer.deserialize(Aa.ResponseBody.toString());wa=Array.isArray(wa.value)?wa.value:null;for(var Ta=0;Ta<wa.length;Ta++)wa[Ta]||(qa=!1,delete ka.sF[ha.registrationInfos[Ta].addinId],
a.xJd(na[Ta]),a.EJd(na[Ta]),r.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",na[Ta],Aa.ResponseStatusCode));M.TaskExtensions.Ba(ka.AGd(xa,"",!1),function(sb){sb.ig?r.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):sb.Oh&&r.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
xa.setResult(!1)},ka.$.la,4);xa.setResult(qa)},function(Aa){Aa=T.a.pg(Aa.data);r.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(na),ca.a.Xc(Aa));I.EwaSettings.ma(257)&&n(a.msb,Sys.Serialization.JavaScriptSerializer.serialize(na));Aa=Cl(ha.registrationInfos);for(var qa=Aa.next();!qa.done;qa=Aa.next())delete ka.sF[qa.value.addinId];
xa.setResult(!1)},va,xa,!0)};a.prototype.HYd=function(aa,na,ha){var ka=this,xa=new t.a;aa.WHb(na);aa=this.IZc(ha);return this.hja(function(){I.EwaSettings.ma(257)&&n(a.G5c,na);M.TaskExtensions.Ba(ka.AGd(xa,ha.solutionId,!1),function(va){va.ig?na&&r.ULS.sendTraceTag(537163473,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",na):va.Oh&&na&&r.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",
na);xa.setResult(!1)},ka.$.la,4)},function(va){va=T.a.pg(va.data);r.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",na,ca.a.Xc(va));I.EwaSettings.ma(257)&&n(a.F5c,na);xa.setResult(!1)},aa,xa,!1)};a.prototype.hja=function(aa,na,ha,ka,xa){function va(){function db(ta,ra,Na){I.EwaSettings.ma(257)&&n(xa?a.E5c:a.H5c,kb.RequestBody);return C.i(qa.va,"ExecuteRichApiRequest",ha,L.b(ta,aa),
L.a(ra,na),Na,null,0)}if(Aa.RHa()||0<qa.va.I4||0<qa.Kk.I4)return!1;wa&&Aa.Cr(wa);Ta&&qa.Dr(Ta);sb&&qa.Yz(sb);var kb=ha.request,ac=kb.RequestFlags&1?0:16;I.EwaSettings.qc()?Aa.Zt(new v.a(507,0,db,ac|64)):Aa.Zt(new B.a(507,0,db,ac));return!0}var Aa=this.$.userOperationManager,qa=this.$.na,wa=null,Ta=null,sb=null;va()||(wa=function(){va()},Ta=function(){va()},sb=function(){va()},Aa.Wu(wa),qa.Bq(Ta),qa.iz(sb));return ka.task};a.prototype.Kpb=function(aa){var na={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};na.RequestBody=JSON.stringify(aa);na.RequestFlags=1;aa=this.$.na.va.Na(1);aa.request=na;return aa};a.prototype.xZc=function(aa){var na={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};na.RequestBody=JSON.stringify(aa);na.RequestFlags=1;aa=this.$.na.va.Na(1);aa.request=na;return aa};a.prototype.IZc=function(aa){var na={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};na.RequestBody=JSON.stringify(aa);na.RequestFlags=
1;aa=this.$.na.va.Na(1);aa.request=na;return aa};a.prototype.AGd=function(aa,na,ha){var ka=this,xa=A.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);M.TaskExtensions.Ba(xa,function(){xa.result.JLd();na&&ha&&ka.iij(na);aa.setResult(!0)},this.$.la,3);return xa};a.prototype.xbf=function(){return fa.Task.Ra(!0)};a.THd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.mwb(R.a.sZa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.mwb(R.a.sZa)||"[]"):
null)||[]};a.Hhg=function(aa){a.UPd(R.a.sZa,Sys.Serialization.JavaScriptSerializer.serialize(aa))};a.PHd=function(aa){aa=a.mwb(R.a.y4a(aa))||"";return 0<aa.length?Sys.Serialization.JavaScriptSerializer.deserialize(aa,!0):null};a.zYj=function(aa,na){a.zMe(aa);a.UPd(R.a.y4a(aa),Sys.Serialization.JavaScriptSerializer.serialize(na))};a.xJd=function(aa){a.FPf(aa);a.$Pf(R.a.y4a(aa))};a.D6i=function(aa){return a.mwb(R.a.x4a(aa))};a.AYj=function(aa,na){a.zMe(aa);a.UPd(R.a.x4a(aa),na)};a.EJd=function(aa){a.FPf(aa);
a.$Pf(R.a.x4a(aa))};a.zMe=function(aa){var na=a.THd();aa=aa.toLowerCase();Array.contains(na,aa)||(na.push(aa),a.Hhg(na))};a.FPf=function(aa){var na=a.THd();aa=aa.toLowerCase();Array.contains(na,aa)&&(na.splice(Array.indexOf(na,aa),1),a.Hhg(na))};a.cacheManifest=function(aa,na){aa=new h(aa);aa.needToRestoreManifest&&a.AYj(aa.solutionId,na)};a.mwb=function(aa){try{return localStorage.getItem(aa)}catch(na){return r.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",
na.message||"Unknown"),null}};a.UPd=function(aa,na){try{localStorage.setItem(aa,na)}catch(ha){r.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ha.message||"Unknown")}};a.$Pf=function(aa){try{localStorage.removeItem(aa)}catch(na){r.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",na.message||"Unknown")}};a.rsd=
function(aa){if(!aa)return!1;try{JSON.parse(aa)}catch(na){return!1}return!0};a.E5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.nsb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.msb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.H5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.G5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.F5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(z.a)(a,"CustomFunctionsLegacyInstaller",null,[797])},1310:function(z,E,b){function a(Q,ea,Z,ca,I){this.$=Q;this.Ke=ea;this.ownerAddinInfo=Z;this.Td=void 0===I?null:I;this.lRa=(void 0===ca?null:ca)||T.Task.Ra(!0);return this}function c(Q){var ea=M.call(this)||this;ea.xDa="AddInCommandsDialog";ea.Oe=ea.xDa;ea.jc=5;ea.dialogWidth=695;ea.dialogHeight=438;ea.z2g="100%";ea.w2g="408px";ea.x2g="15px";ea.y2g="0";ea.Mtg=Q;return ea}function e(Q,ea,Z,ca,I,H){var L=Q.Na(9);L.sharedInfo=ea;return r.i(Q,
"InsertAgaveTaskpane",L,Z,ca,I,H,0)}function f(){}z=b(0);var m=b(211),n=b(14);Object(z.a)(f,"AddinCommandsHost",null,[]);var w=b(1363),h=b(1428),y=b(1068),r=b(84),x=b(561),t=b(387),u=b(175),B=b(36),v=b(1),C=b(292),A=b(149),M=A.a;Am(c,M);c.prototype.uD=function(){M.prototype.uD.call(this);this.Pp.style.width=this.z2g;this.Pp.style.height=this.w2g;this.Pp.style.marginTop=this.x2g;this.Pp.style.padding=this.y2g};c.prototype.UO=function(){M.prototype.UO.call(this);this.Nb.style.width=String.format("{0}px",
this.dialogWidth);this.Nb.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){M.prototype.dispose.call(this);this.Mtg()};Ck.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.Pp}}});Object(z.a)(c,"AddInCommandsDialog",A.a,[]);var T=b(55),R=b(61);A=b(98);b.d(E,"a",function(){return a});Am(a,f);a.prototype.r2g=function(){var Q=this.lRa;this.lRa=T.Task.Ra(!0);return Q};a.prototype.disposeHost=function(Q){this.Ke.OQa(Q)};
a.prototype.setOwnerAddinEToken=function(Q){this.ownerAddinInfo.eToken=Q};a.prototype.showTaskpane=function(Q,ea,Z){var ca=this;n.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var I=null,H=!1,L=(new w.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new y.a,!0)).OGe(Q.solutionId.substr(this.ownerAddinInfo.solutionId.length));I=ea.getSharedRuntimeForTaskpane("Workbook",L);H=!!I&&1===I.LifeTime;this.Ke.Pye(H?this.ownerAddinInfo.solutionId:Q.solutionId,H?I:null,null)||
(this.Inf(H,!0),this.lRa=this.knd(Q,I,function(U,fa){U?(H&&(U.PrimaryMarketplace.SolutionId=ca.ownerAddinInfo.solutionId,U.SharedRuntime=I),U.WebExtensionOsfControlType=3,ca.Ke.g1a(U),Z(U.InstanceId,fa),ca.Inf(H,!1),v.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&n.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(n.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),Z(null,fa))}))};a.prototype.getSettings=
function(Q,ea){var Z=this.Ke.Waa(Q.solutionId);Z?ea(this.Ke.YZ(Z).OsfPropertyBag):this.lRa=this.knd(Q,null,function(ca){ca?ea(ca.OsfPropertyBag):n.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(Q,ea,Z){function ca(fa,aa,na){return e(L,U,C.b(fa,I),aa,na,null)}function I(fa){var aa=fa.Result,na=aa?aa.AgaveData:null;na?(H.Ke.JFe(na,function(){var ha=new c(function(){H.disposeHost(na.InstanceId)});ha.initializeAndShow("",null,null);return ha.containerDiv}),
Z(na.InstanceId,0)):(n.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),Z(null,fa.Errors?fa.Errors[0].ErrorCause:5001))}var H=this;n.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var L=this.$.na.va,U=a.Xrb(Q,this.ownerAddinInfo);v.EwaSettings.qc()?this.lRa=t.a(this.$.userOperationManager,ca,function(fa){return new u.a(500,0,fa,64)},this.Td):this.lRa=t.a(this.$.userOperationManager,ca,function(fa){return new x.a(500,0,fa)},this.Td)};a.prototype.createUILessSandbox=
function(Q,ea,Z){var ca=this;n.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var I=ea.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),H=!!I&&1===I.LifeTime;(ea=this.Ke.RCh(H?this.ownerAddinInfo.solutionId:Q.solutionId,H?I:null))?Z(ea,0):this.lRa=this.knd(Q,I,function(L,U){L?(H?(L.PrimaryMarketplace.SolutionId=ca.ownerAddinInfo.solutionId,L.SharedRuntime=I,L.TaskpaneVisible=!1,L.WebExtensionOsfControlType=3,ca.Ke.g1a(L)):(L.WebExtensionOsfControlType=4,ca.Ke.JFe(L,function(){a.vfb.ia(L.InstanceId,
new h.a);return a.vfb.oa(L.InstanceId).R1a})),Z(L.InstanceId,U)):(n.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),Z(null,U))})};a.prototype.knd=function(Q,ea,Z){function ca(ka,xa,va){return e(U,fa,C.b(ka,I),xa,va,null)}function I(ka){var xa=ka.Result;(L=xa?xa.AgaveData:null)||Z(null,ka.Errors?ka.Errors[0].ErrorCause:5001)}var H=this,L=null,U=this.$.na.va,fa=a.Xrb(Q,this.ownerAddinInfo);ea&&(n.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),fa.SharedRuntimeId=
ea.Resid);var aa=500,na=0;void 0===fa.IsToBePersisted||null===fa.IsToBePersisted||fa.IsToBePersisted||(aa=538,ca=function(ka,xa,va){n.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(H.ownerAddinInfo.solutionId,H.ownerAddinInfo.storeType,H.ownerAddinInfo.assetId,null,null,H.ownerAddinInfo.storeId));ka=C.b(ka,I);var Aa=U.Na(9,null);Aa.sharedInfo=fa;return r.i(U,"ShowAgaveTaskpane",Aa,
ka,xa,va,null,0)},na=16);if(v.EwaSettings.qc()){na|=64;var ha=t.a(this.$.userOperationManager,ca,function(ka){return new u.a(aa,0,ka,na)},this.Td)}else ha=t.a(this.$.userOperationManager,ca,function(ka){return new x.a(aa,0,ka,na)},this.Td);return B.TaskExtensions.ts(ha,function(){return L?H.Dud(U,L.InstanceId,function(ka,xa){if(ka){ea||(L.PrimaryMarketplace.MarketplaceType=Q.storeType);L.OwnerAddinSolutionId=H.ownerAddinInfo.solutionId;L.OwnerAddinStoreType=H.ownerAddinInfo.storeType;L.OsfPropertyBag=
[];for(xa=0;xa<ka.Settings.length;xa++){var va=[];va[0]=ka.Settings[xa].Name;va[1]=ka.Settings[xa].Value;L.OsfPropertyBag[xa]=va}Z(L,0)}else Z(null,xa.Errors?xa.Errors[0].ErrorCause:5001)}):T.Task.Ra(!1)},m.a.none,3,R.a.current)};a.prototype.Dud=function(Q,ea,Z){function ca(H,L,U){H=C.b(H,I);var fa=Q.Na(1);fa.controlId=ea;return r.i(Q,"DdaLoadSettings",fa,H,L,U,null,0)}function I(H){Z(H.Result,H)}return v.EwaSettings.qc()?t.a(this.$.userOperationManager,ca,function(H){return new u.a(501,0,H,80)},
this.Td):t.a(this.$.userOperationManager,ca,function(H){return new x.a(501,0,H,16)},this.Td)};a.prototype.Inf=function(Q,ea){var Z;Q&&(null===(Z=window.performance)||void 0===Z?0:Z.memory)&&n.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ea,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(Q){a.vfb.xb(Q)&&
a.vfb.oa(Q).initializeAndShowWithTitle()};a.hideUILessDialog=function(Q){a.vfb.xb(Q)&&a.vfb.oa(Q).hide()};a.Xrb=function(Q,ea){var Z={};Z.SolutionId=Q.solutionId;Z.Version=Q.version;Z.StoreType=ea.storeType;Z.StoreId=Q.storeId;Z.AssetId=Q.solutionId;Z.AssetStoreId="omex";Z.TargetType=1;Z.Width=350;Z.OwnerAddinSolutionId=ea.solutionId;Z.OwnerAddinStoreType=ea.storeType;Z.SharedRuntimeId=null;Z.Preload=!1;return Z};a.vfb=new A.a;Object(z.a)(a,"WACExcelAddinCommandsHost",f,[])},1349:function(z,E,b){function a(c,
e,f,m){this._id=c;this.vxg=e;this.Die=f;this.oVa=m}b.d(E,"a",function(){return a});z=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.vxg};a.prototype.getStoreType=function(){return this.Die};Object(z.a)(a,"ExtensionIdentity",null,[156])},1350:function(z,E,b){function a(c,e,f){this.Cbe=f}b.d(E,"a",function(){return a});z=b(0);Object(z.a)(a,"HostProperties",null,[])},1351:function(z,E,b){function a(){this.ri={};this.pr={}}b.d(E,"a",function(){return a});
z=b(0);Object(z.a)(a,"ExtensionLaunchProperties",null,[])},1352:function(z,E,b){function a(){this.La=w.AFrameworkApplication.Ib}b.d(E,"a",function(){return a});z=b(0);var c=b(1349),e=b(1351),f=b(1163),m=b(1354),n=b(1350),w=b(4),h=b(634),y=b(27);a.prototype.RNa=function(r,x,t,u,B){this.csi(r,x,t,u,B)};a.prototype.csi=function(r,x,t,u,B){var v=b(1353).ExtensionComponentInstance,C={};C[f.a.E9b]=r;C[f.a.bCe]=x;C[f.a.LHa]=t;C[f.a.old]=u;C[f.a.pza]=B;u=8;w.AFrameworkApplication.qni(r.getId())&&(u=x===m.a.action?
this.La.Be(y.a.oSe,2,C):this.La.Be(y.a.f4f,2,C));32===u?(u=h.a.create().toString(),B.ri.InstanceToken&&(u=B.ri.InstanceToken),r=new v(r,x,t,u),a.gw[u]=r):r=new v(r,x,t,null);r.ipj(C)};a.prototype.bsi=function(r){var x=r.ExtId,t=r.ComponentType,u=r.ComponentId,B=r.HostProps;r=r.OptionalProps;x=new c.a(x.Id,x.StoreId,x.StoreType,x.AppVersion);B=new n.a(B.HostType,B.FormFactor,B.Locale);var v=new e.a;v.ri=r.OptionalProperties;v.pr=r.DevProperties;a.instance.RNa(x,t,u,B,v)};a.prototype.getInstance=function(r){return a.gw[r]};
a.prototype.waj=function(r){delete a.gw[r]};Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.QIc||(a.QIc=new a);return a.QIc}}});a.QIc=null;a.gw={};Object(z.a)(a,"ExtensionLifeCycleManager",null,[136])},1353:function(z,E,b){function a(m,n,w,h){this.oVa=this.AG=null;this._id=m;this.nng=w;this.erg=h;this.La=e.AFrameworkApplication.Ib?e.AFrameworkApplication.Ib:null}b.r(E);b.d(E,"ExtensionComponentInstance",function(){return a});z=b(0);var c=b(1352),e=b(4),f=b(27);
a.prototype.ted=function(){return this.nng};a.prototype.ipj=function(m){this.AG=m};a.prototype.stop=function(){var m=this.La.Be(f.a.XZg,2,this.AG);c.a.instance.waj(this.erg);return 32===m};a.prototype.quc=function(){this.La.Be(f.a.qUf,2,this.AG)};Ck.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.oVa}}});Object(z.a)(a,"ExtensionComponentInstance",null,[154])},1354:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.taskpane=
"Taskpane";a.action="Action";Object(z.a)(a,"ComponentTypeNames",null,[])},1355:function(z,E,b){(function(a){function c(R,Q,ea){var Z=T.call(this)||this;Z.I$e=w.a.getTypeName();Z.Td=null;Z.YU=null;Z.gyb=null;Z.imageWidth=0;Z.imageHeight=0;Z.tableData=null;Z.errorMessage=null;Z.XLa=null;Z.vld=0;Z.aUc=!1;Z.XGe=function(ca){if(ca){var I={};if(function(){var na=A.d(Z.Lch(ca.data));I=na.ev;return na}().returnValue){var H=Object(n.a)(Object,I);if("."===H.DataFromPictureWildcard)if(H.SessionId!==Z.XLa)f.ULS.sendTraceTag(523805139,
0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),H.CmdType){case "ACK":Z.aUc=!0;Z.n9f.stop();f.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");Z.Qnj();0<Z.errorMessage.length?Z.cYf():0<
Z.tableData.length&&Z.tYf();break;case "insert_html":var L=Z.$.na.va,U={},fa=C.g(Z.$).ha.ta.ud.clone();U.PasteId=m.a.create().toString();U.DestinationRanges=r.s(r.v(fa,Z.$));fa=H.Parameters.split("|",3);f.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:{0}|{1}|{2}.",fa[0],fa[1],fa[2]);fa=H.Parameters.indexOf("|");fa=H.Parameters.indexOf("|",fa+1);fa=H.Parameters.indexOf("|",fa+1);U.SourceHtml=H.Parameters.substring(fa+1);U.CopyOperationId=null;
var aa=L.Na(1,L.hc());aa.pasteHtmlParameters=U;x.a(Z.$.userOperationManager,function(na,ha,ka){return u.i(L,"pasteHtmlContent",aa,na,ha,ka,null,64)},function(na){return new t.a(204,0,na,1)},null);Z.vld++;f.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:{0}",Z.vld.toString())}}}};Z.D9h=function(ca,I){if(ca=I.pC)if(!I.parentPath||1>=I.parentPath.length||I.parentPath[1]!==Z.XLa)f.ULS.sendTraceTag(523805124,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");I=ca.errorCode;switch(I){case null:case -1:Z.errorMessage=v.a.instance.fa(2214);break;case 1:Z.errorMessage=v.a.instance.fa(2215);break;case 2:Z.errorMessage=v.a.instance.fa(2216)}0<Z.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:{0}.",
I?I.toString():"null");Z.Oqe.stop();Z.tableData=ca.html;Z.aUc&&(0<Z.errorMessage.length?Z.cYf():0<Z.tableData.length&&Z.tYf())}else f.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};Z.$=R;Z.augmentationLoopManager=Q;Z.uploaderCreator=ea;Z.initialize();return Z}b.d(E,"a",function(){return c});var e=b(0),f=b(14),m=b(177),n=b(83),w=b(1360),h=b(38),y=b(244),r=b(45),x=b(387),t=b(175),u=b(84),B=b(95),v=b(15),C=b(21),A=b(41),M=b(1361),
T=h.a;Am(c,T);c.prototype.dispose=function(){window.removeEventListener("message",this.XGe,!1);T.prototype.dispose.call(this)};c.prototype.CTi=function(R,Q){var ea=this;f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");var Z=new Image;Z.onload=function(){var ca=document.createElement("canvas");ca.width=Z.width;ca.height=Z.height;var I=ca.getContext("2d");try{I.drawImage(Z,0,0,Z.width,Z.height)}catch(U){f.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",
U.message);return}try{var H=ca.toDataURL("image/jpeg")}catch(U){f.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",U.message);return}ca=H.split(",");if(2>ca.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{ca=ca[1];try{var L=window.self.atob(ca)}catch(U){f.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",
U.message);return}28E5<L.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),Q.CAj()):(ea.Ujj(ea.Td,ea.YU,ca,Z.width,Z.height),URL.revokeObjectURL(Z.src),Z=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};Z.src=R};c.prototype.L0i=function(R,Q,ea,Z){this.Td=R;this.YU=Z;this.uploaderCreator.gbi(this.$,Q,ea,Z,this)};c.prototype.Ujj=function(R,Q,ea,Z,ca){this.XLa=m.a.create().toString();
this.vld=0;this.gyb=ea;this.imageWidth=Z;this.imageHeight=ca;this.errorMessage=this.tableData="";this.aUc=!1;this.n9f=this.$.Ob.$g("LoadResource","DataFromPictureTaskpaneLaunch");this.n9f.start();this.eWi(R,Q);this.Oqe=this.$.Ob.$g("LoadResource","DataFromPictureAnnotation");this.Oqe.start();this.OUj()};c.prototype.OUj=function(){if(this.gyb.length){var R=window.self.atob(this.gyb);for(var Q=new Uint8Array(R.length),ea=0;ea<R.length;ea++)Q[ea]=R.charCodeAt(ea);this.augmentationLoopManager.NUj(Q,this.XLa,
this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.eWi=function(R,Q){Q.SessionID=this.XLa;Q.DataFromPictureAssetId="FA000000050";Q.LoadDataFromPictureTaskpane=!0;R=new B.a(-859308420,R.method,R.mode,R.Xe,R.tabName);this.$.Ka.$b(R,Q)};c.prototype.E8c=function(R){try{var Q=a.from(R,"utf16le").toString("base64");return M.a.YHa(this.XLa,Q)}catch(ea){return f.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message.",ea.message),""}};c.prototype.Lch=function(R){try{var Q=M.a.YHa(this.XLa,R);return a.from(Q,"base64").toString("utf16le")}catch(ea){return f.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message.",ea.message),""}};c.prototype.Qnj=function(){if(this.gyb.length){var R=y.a(this.$).Waa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.imageData=this.E8c(this.gyb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(R,
"onCustomMessage",Q,function(ea){ea&&f.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.tYf=function(){if(this.tableData.length){var R=y.a(this.$).Waa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.tableHtml=this.E8c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(R,
"onCustomMessage",Q,function(ea){ea&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.cYf=function(){if(this.errorMessage.length){var R=y.a(this.$).Waa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.errorMessage=this.E8c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(R,
"onCustomMessage",Q,function(ea){ea&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};c.prototype.initialize=function(){window.addEventListener("message",this.XGe,!1);this.augmentationLoopManager.activateAnnotation(this.I$e);this.augmentationLoopManager.CJ(this.I$e,
this.D9h)};Object(e.a)(c,"DataFromPictureManager",h.a,[823])}).call(this,b(1356).sig)},1356:function(z,E,b){(function(a){function c(){try{var ca=new Uint8Array(1);ca.__proto__={__proto__:Uint8Array.prototype,qcd:function(){return 42}};return 42===ca.qcd()&&"function"===typeof ca.subarray&&0===ca.subarray(1,1).byteLength}catch(I){return!1}}function e(ca,I){if((f.uP?2147483647:1073741823)<I)throw new RangeError("Invalid typed array length");f.uP?(ca=new Uint8Array(I),ca.__proto__=f.prototype):(null===
ca&&(ca=new f(I)),ca.length=I);return ca}function f(ca,I,H){if(!(f.uP||this instanceof f))return new f(ca,I,H);if("number"===typeof ca){if("string"===typeof I)throw Error("If encoding is specified then the first argument must be a string");return w(this,ca)}return m(this,ca,I,H)}function m(ca,I,H,L){if("number"===typeof I)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&I instanceof ArrayBuffer){I.byteLength;if(0>H||I.byteLength<H)throw new RangeError("'offset' is out of bounds");
if(I.byteLength<H+(L||0))throw new RangeError("'length' is out of bounds");I=void 0===H&&void 0===L?new Uint8Array(I):void 0===L?new Uint8Array(I,H):new Uint8Array(I,H,L);f.uP?(ca=I,ca.__proto__=f.prototype):ca=h(ca,I);I=ca}else if("string"===typeof I){L=ca;ca=H;if("string"!==typeof ca||""===ca)ca="utf8";if(!f.Wdf(ca))throw new TypeError('"encoding" must be a valid string encoding');H=x(I,ca)|0;L=e(L,H);I=L.write(I,ca);I!==H&&(L=L.slice(0,I));I=L}else I=y(ca,I);return I}function n(ca){if("number"!==
typeof ca)throw new TypeError('"size" argument must be a number');if(0>ca)throw new RangeError('"size" argument must not be negative');}function w(ca,I){n(I);ca=e(ca,0>I?0:r(I)|0);if(!f.uP)for(var H=0;H<I;++H)ca[H]=0;return ca}function h(ca,I){var H=0>I.length?0:r(I.length)|0;ca=e(ca,H);for(var L=0;L<H;L+=1)ca[L]=I[L]&255;return ca}function y(ca,I){if(f.isBuffer(I)){var H=r(I.length)|0;ca=e(ca,H);if(0===ca.length)return ca;I.copy(ca,0,0,H);return ca}if(I){if("undefined"!==typeof ArrayBuffer&&I.buffer instanceof
ArrayBuffer||"length"in I)return(H="number"!==typeof I.length)||(H=I.length,H=H!==H),H?e(ca,0):h(ca,I);if("Buffer"===I.type&&Q(I.data))return h(ca,I.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function r(ca){if(ca>=(f.uP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.uP?2147483647:1073741823).toString(16)+" bytes");return ca|0}function x(ca,I){if(f.isBuffer(ca))return ca.length;
if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(ca)||ca instanceof ArrayBuffer))return ca.byteLength;"string"!==typeof ca&&(ca=""+ca);var H=ca.length;if(0===H)return 0;for(var L=!1;;)switch(I){case "ascii":case "latin1":case "binary":return H;case "utf8":case "utf-8":case void 0:return C(ca).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*H;case "hex":return H>>>1;case "base64":return M(ca).length;default:if(L)return C(ca).length;
I=(""+I).toLowerCase();L=!0}}function t(ca,I,H){var L=!1;if(void 0===I||0>I)I=0;if(I>this.length)return"";if(void 0===H||H>this.length)H=this.length;if(0>=H)return"";H>>>=0;I>>>=0;if(H<=I)return"";for(ca||(ca="utf8");;)switch(ca){case "hex":ca=I;I=H;H=this.length;if(!ca||0>ca)ca=0;if(!I||0>I||I>H)I=H;L="";for(H=ca;H<I;++H)ca=L,L=this[H],L=16>L?"0"+L.toString(16):L.toString(16),L=ca+L;return L;case "utf8":case "utf-8":return v(this,I,H);case "ascii":ca="";for(H=Math.min(this.length,H);I<H;++I)ca+=
String.fromCharCode(this[I]&127);return ca;case "latin1":case "binary":ca="";for(H=Math.min(this.length,H);I<H;++I)ca+=String.fromCharCode(this[I]);return ca;case "base64":return 0===I&&H===this.length?R.uWe(this):R.uWe(this.slice(I,H));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":I=this.slice(I,H);H="";for(ca=0;ca<I.length;ca+=2)H+=String.fromCharCode(I[ca]+256*I[ca+1]);return H;default:if(L)throw new TypeError("Unknown encoding: "+ca);ca=(ca+"").toLowerCase();L=!0}}function u(ca,I,H,
L,U){if(0===ca.length)return-1;"string"===typeof H?(L=H,H=0):2147483647<H?H=2147483647:-2147483648>H&&(H=-2147483648);H=+H;isNaN(H)&&(H=U?0:ca.length-1);0>H&&(H=ca.length+H);if(H>=ca.length){if(U)return-1;H=ca.length-1}else if(0>H)if(U)H=0;else return-1;"string"===typeof I&&(I=f.from(I,L));if(f.isBuffer(I))return 0===I.length?-1:B(ca,I,H,L,U);if("number"===typeof I)return I&=255,f.uP&&"function"===typeof Uint8Array.prototype.indexOf?U?Uint8Array.prototype.indexOf.call(ca,I,H):Uint8Array.prototype.lastIndexOf.call(ca,
I,H):B(ca,[I],H,L,U);throw new TypeError("val must be string, number or Buffer");}function B(ca,I,H,L,U){function fa(ka,xa){return 1===aa?ka[xa]:ka.Q6i(xa*aa)}var aa=1,na=ca.length,ha=I.length;if(void 0!==L&&(L=String(L).toLowerCase(),"ucs2"===L||"ucs-2"===L||"utf16le"===L||"utf-16le"===L)){if(2>ca.length||2>I.length)return-1;aa=2;na/=2;ha/=2;H/=2}if(U)for(L=-1;H<na;H++)if(fa(ca,H)===fa(I,-1===L?0:H-L)){if(-1===L&&(L=H),H-L+1===ha)return L*aa}else-1!==L&&(H-=H-L),L=-1;else for(H+ha>na&&(H=na-ha);0<=
H;H--){na=!0;for(L=0;L<ha;L++)if(fa(ca,H+L)!==fa(I,L)){na=!1;break}if(na)return H}return-1}function v(ca,I,H){H=Math.min(ca.length,H);for(var L=[];I<H;){var U=ca[I],fa=null,aa=239<U?4:223<U?3:191<U?2:1;if(I+aa<=H)switch(aa){case 1:128>U&&(fa=U);break;case 2:var na=ca[I+1];128===(na&192)&&(U=(U&31)<<6|na&63,127<U&&(fa=U));break;case 3:na=ca[I+1];var ha=ca[I+2];128===(na&192)&&128===(ha&192)&&(U=(U&15)<<12|(na&63)<<6|ha&63,2047<U&&(55296>U||57343<U)&&(fa=U));break;case 4:na=ca[I+1];ha=ca[I+2];var ka=
ca[I+3];128===(na&192)&&128===(ha&192)&&128===(ka&192)&&(U=(U&15)<<18|(na&63)<<12|(ha&63)<<6|ka&63,65535<U&&1114112>U&&(fa=U))}null===fa?(fa=65533,aa=1):65535<fa&&(fa-=65536,L.push(fa>>>10&1023|55296),fa=56320|fa&1023);L.push(fa);I+=aa}ca=L.length;if(ca<=ea)L=String.fromCharCode.apply(String,L);else{H="";for(I=0;I<ca;)H+=String.fromCharCode.apply(String,L.slice(I,I+=ea));L=H}return L}function C(ca,I){I=I||Infinity;for(var H,L=ca.length,U=null,fa=[],aa=0;aa<L;++aa){H=ca.charCodeAt(aa);if(55295<H&&
57344>H){if(!U){if(56319<H){-1<(I-=3)&&fa.push(239,191,189);continue}else if(aa+1===L){-1<(I-=3)&&fa.push(239,191,189);continue}U=H;continue}if(56320>H){-1<(I-=3)&&fa.push(239,191,189);U=H;continue}H=(U-55296<<10|H-56320)+65536}else U&&-1<(I-=3)&&fa.push(239,191,189);U=null;if(128>H){if(0>--I)break;fa.push(H)}else if(2048>H){if(0>(I-=2))break;fa.push(H>>6|192,H&63|128)}else if(65536>H){if(0>(I-=3))break;fa.push(H>>12|224,H>>6&63|128,H&63|128)}else if(1114112>H){if(0>(I-=4))break;fa.push(H>>18|240,
H>>12&63|128,H>>6&63|128,H&63|128)}else throw Error("Invalid code point");}return fa}function A(ca){for(var I=[],H=0;H<ca.length;++H)I.push(ca.charCodeAt(H)&255);return I}function M(ca){var I=R,H=I.XKj;ca=(ca.trim?ca.trim():ca.replace(/^\s+|\s+$/g,"")).replace(Z,"");if(2>ca.length)ca="";else for(;0!==ca.length%4;)ca+="=";return H.call(I,ca)}function T(ca,I,H,L){for(var U=0;U<L&&!(U+H>=I.length||U>=ca.length);++U)I[U+H]=ca[U];return U}var R=b(1357);b(1358);var Q=b(1359);E.sig=f;E.FZj=function(ca){+ca!=
ca&&(ca=0);return f.mqe(+ca)};E.lZj=50;f.uP=void 0!==a.uP?a.uP:c();E.a0j=f.uP?2147483647:1073741823;f.from=function(ca,I,H){return m(null,ca,I,H)};f.uP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.mqe=function(ca){n(ca);return e(null,ca)};f.zJg=function(ca){return w(null,ca)};f.isBuffer=function(ca){return!(null==ca||!ca.prg)};f.compare=
function(ca,I){if(!f.isBuffer(ca)||!f.isBuffer(I))throw new TypeError("Arguments must be Buffers");if(ca===I)return 0;for(var H=ca.length,L=I.length,U=0,fa=Math.min(H,L);U<fa;++U)if(ca[U]!==I[U]){H=ca[U];L=I[U];break}return H<L?-1:L<H?1:0};f.Wdf=function(ca){switch(String(ca).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(ca,I){if(!Q(ca))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===ca.length)return f.mqe(0);var H;if(void 0===I)for(H=I=0;H<ca.length;++H)I+=ca[H].length;I=f.zJg(I);var L=0;for(H=0;H<ca.length;++H){var U=ca[H];if(!f.isBuffer(U))throw new TypeError('"list" argument must be an Array of Buffers');U.copy(I,L);L+=U.length}return I};f.byteLength=x;f.prototype.prg=!0;f.prototype.toString=function(){var ca=this.length|0;return 0===ca?"":0===arguments.length?v(this,0,ca):t.apply(this,arguments)};f.prototype.equals=function(ca){if(!f.isBuffer(ca))throw new TypeError("Argument must be a Buffer");
return this===ca?!0:0===f.compare(this,ca)};f.prototype.compare=function(ca,I,H,L,U){if(!f.isBuffer(ca))throw new TypeError("Argument must be a Buffer");void 0===I&&(I=0);void 0===H&&(H=ca?ca.length:0);void 0===L&&(L=0);void 0===U&&(U=this.length);if(0>I||H>ca.length||0>L||U>this.length)throw new RangeError("out of range index");if(L>=U&&I>=H)return 0;if(L>=U)return-1;if(I>=H)return 1;I>>>=0;H>>>=0;L>>>=0;U>>>=0;if(this===ca)return 0;var fa=U-L,aa=H-I,na=Math.min(fa,aa);L=this.slice(L,U);ca=ca.slice(I,
H);for(I=0;I<na;++I)if(L[I]!==ca[I]){fa=L[I];aa=ca[I];break}return fa<aa?-1:aa<fa?1:0};f.prototype.includes=function(ca,I,H){return-1!==this.indexOf(ca,I,H)};f.prototype.indexOf=function(ca,I,H){return u(this,ca,I,H,!0)};f.prototype.lastIndexOf=function(ca,I,H){return u(this,ca,I,H,!1)};f.prototype.write=function(ca,I,H,L){if(void 0===I)L="utf8",H=this.length,I=0;else if(void 0===H&&"string"===typeof I)L=I,H=this.length,I=0;else if(isFinite(I))I|=0,isFinite(H)?(H|=0,void 0===L&&(L="utf8")):(L=H,H=
void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var U=this.length-I;if(void 0===H||H>U)H=U;if(0<ca.length&&(0>H||0>I)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");for(U=!1;;)switch(L){case "hex":I=Number(I)||0;L=this.length-I;H?(H=Number(H),H>L&&(H=L)):H=L;L=ca.length;if(0!==L%2)throw new TypeError("Invalid hex string");H>L/2&&(H=L/2);for(L=0;L<H;++L){U=parseInt(ca.substr(2*L,2),16);if(isNaN(U))break;
this[I+L]=U}return L;case "utf8":case "utf-8":return T(C(ca,this.length-I),this,I,H);case "ascii":return T(A(ca),this,I,H);case "latin1":case "binary":return T(A(ca),this,I,H);case "base64":return T(M(ca),this,I,H);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":L=ca;U=this.length-I;for(var fa=[],aa=0;aa<L.length&&!(0>(U-=2));++aa){var na=L.charCodeAt(aa);ca=na>>8;na%=256;fa.push(na);fa.push(ca)}return T(fa,this,I,H);default:if(U)throw new TypeError("Unknown encoding: "+L);L=(""+L).toLowerCase();
U=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.JZj||this,0)}};var ea=4096;f.prototype.slice=function(ca,I){var H=this.length;ca=~~ca;I=void 0===I?H:~~I;0>ca?(ca+=H,0>ca&&(ca=0)):ca>H&&(ca=H);0>I?(I+=H,0>I&&(I=0)):I>H&&(I=H);I<ca&&(I=ca);if(f.uP)I=this.subarray(ca,I),I.__proto__=f.prototype;else{H=I-ca;I=new f(H,void 0);for(var L=0;L<H;++L)I[L]=this[L+ca]}return I};f.prototype.Q6i=function(ca){if(0!==ca%1||0>ca)throw new RangeError("offset is not uint");
if(ca+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[ca]<<8|this[ca+1]};f.prototype.copy=function(ca,I,H,L){H||(H=0);L||0===L||(L=this.length);I>=ca.length&&(I=ca.length);I||(I=0);0<L&&L<H&&(L=H);if(L===H||0===ca.length||0===this.length)return 0;if(0>I)throw new RangeError("targetStart out of bounds");if(0>H||H>=this.length)throw new RangeError("sourceStart out of bounds");if(0>L)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length);
ca.length-I<L-H&&(L=ca.length-I+H);var U=L-H;if(this===ca&&H<I&&I<L)for(L=U-1;0<=L;--L)ca[L+I]=this[L+H];else if(1E3>U||!f.uP)for(L=0;L<U;++L)ca[L+I]=this[L+H];else Uint8Array.prototype.set.call(ca,this.subarray(H,H+U),I);return U};f.prototype.fill=function(ca,I,H,L){if("string"===typeof ca){"string"===typeof I?(L=I,I=0,H=this.length):"string"===typeof H&&(L=H,H=this.length);if(1===ca.length){var U=ca.charCodeAt(0);256>U&&(ca=U)}if(void 0!==L&&"string"!==typeof L)throw new TypeError("encoding must be a string");
if("string"===typeof L&&!f.Wdf(L))throw new TypeError("Unknown encoding: "+L);}else"number"===typeof ca&&(ca&=255);if(0>I||this.length<I||this.length<H)throw new RangeError("Out of range index");if(H<=I)return this;I>>>=0;H=void 0===H?this.length:H>>>0;ca||(ca=0);if("number"===typeof ca)for(L=I;L<H;++L)this[L]=ca;else for(ca=f.isBuffer(ca)?ca:C((new f(ca,L)).toString()),U=ca.length,L=0;L<H-I;++L)this[L+I]=ca[L%U];return this};var Z=/[^+\/0-9A-Za-z-_]/g}).call(this,b(742))},1357:function(z,E){function b(f){var m=
f.length;if(0<m%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=m);return[f,f===m?0:4-f%4]}E.byteLength=function(f){f=b(f);var m=f[1];return 3*(f[0]+m)/4-m};E.XKj=function(f){var m=b(f);var n=m[0];m=m[1];var w=new e(3*(n+m)/4-m),h=0,y=0<m?n-4:n,r;for(r=0;r<y;r+=4)n=c[f.charCodeAt(r)]<<18|c[f.charCodeAt(r+1)]<<12|c[f.charCodeAt(r+2)]<<6|c[f.charCodeAt(r+3)],w[h++]=n>>16&255,w[h++]=n>>8&255,w[h++]=n&255;2===m&&(n=c[f.charCodeAt(r)]<<2|c[f.charCodeAt(r+1)]>>
4,w[h++]=n&255);1===m&&(n=c[f.charCodeAt(r)]<<10|c[f.charCodeAt(r+1)]<<4|c[f.charCodeAt(r+2)]>>2,w[h++]=n>>8&255,w[h++]=n&255);return w};E.uWe=function(f){for(var m=f.length,n=m%3,w=[],h=0,y=m-n;h<y;h+=16383){for(var r=w,x=r.push,t,u=f,B=h+16383>y?y:h+16383,v=[],C=h;C<B;C+=3)t=(u[C]<<16&16711680)+(u[C+1]<<8&65280)+(u[C+2]&255),v.push(a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[t&63]);t=v.join("");x.call(r,t)}1===n?(f=f[m-1],w.push(a[f>>2]+a[f<<4&63]+"==")):2===n&&(f=(f[m-2]<<8)+f[m-1],w.push(a[f>>10]+a[f>>
4&63]+a[f<<2&63]+"="));return w.join("")};var a=[],c=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(z=0;64>z;++z)a[z]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[z],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(z)]=z;c[45]=62;c[95]=63},1358:function(z,E){E.read=function(b,a,c,e,f){var m=8*f-e-1;var n=(1<<m)-1,w=n>>1,h=-7;f=c?f-1:0;var y=c?-1:1,r=b[a+f];f+=y;c=r&(1<<-h)-1;r>>=-h;for(h+=m;0<h;c=256*c+b[a+f],f+=y,h-=8);m=c&(1<<-h)-1;
c>>=-h;for(h+=e;0<h;m=256*m+b[a+f],f+=y,h-=8);if(0===c)c=1-w;else{if(c===n)return m?NaN:Infinity*(r?-1:1);m+=Math.pow(2,e);c-=w}return(r?-1:1)*m*Math.pow(2,c-e)};E.write=function(b,a,c,e,f,m){var n,w=8*m-f-1,h=(1<<w)-1,y=h>>1,r=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;m=e?0:m-1;var x=e?1:-1,t=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,e=h):(e=Math.floor(Math.log(a)/Math.LN2),1>a*(n=Math.pow(2,-e))&&(e--,n*=2),a=1<=e+y?a+r/n:a+r*Math.pow(2,1-y),2<=a*n&&(e++,n/=2),e+
y>=h?(a=0,e=h):1<=e+y?(a=(a*n-1)*Math.pow(2,f),e+=y):(a=a*Math.pow(2,y-1)*Math.pow(2,f),e=0));for(;8<=f;b[c+m]=a&255,m+=x,a/=256,f-=8);e=e<<f|a;for(w+=f;0<w;b[c+m]=e&255,m+=x,e/=256,w-=8);b[c+m-x]|=128*t}},1359:function(z){var E={}.toString;z.exports=Array.isArray||function(b){return"[object Array]"==E.call(b)}},1360:function(z,E,b){function a(){var f=e.call(this)||this;f.errorCode=null;f.errorDescription=null;f.html=null;f.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.ye()});return f}b.d(E,"a",
function(){return a});z=b(0);E=b(931);var c=b(908),e=E.a;Am(a,e);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};a.ye=function(){return["AugLoop_Core_Annotation"]};Object(z.a)(a,"DetectedHtmlTableAnnotation",E.a,[])},1361:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.YHa=function(c,e){if(!(c&&e&&c.length&&e.length)||256<c.length)return"";var f=Array(256),m=Array(256),n,w=0,h=0,y="";for(n=0;256>n;n++)f[n]=n;for(n=0;256>n;n++){var r=c.charCodeAt(n%
c.length);if(256<=r)return"";w=(w+f[n]+r)%256;r=f[n];f[n]=f[w];f[w]=r}for(n=0;256>n;n++)m[n]=f[256-n-1];for(c=w=n=0;c<e.length;c++){n=(n+1)%256;w=(w+f[n])%256;r=f[n];f[n]=f[w];f[w]=r;r=e.charCodeAt(c);if(256<=r)return"";var x=r^f[(f[n]+f[w])%256];h=(h+m[n])%256;r=m[n];m[n]=m[h];m[h]=r;y+=String.fromCharCode(x^f[(m[n]+m[h])%256])}return y};Object(z.a)(a,"RC4A",null,[])},1363:function(z,E,b){function a(f,m,n,w){this.zSc=this.blb=this.BSc=null;this.MEa=f;e.AFrameworkApplication.ga.ra("AddInCommandsMissingTabIsEnabled")?
(this.BSc=n.MTh(),this.blb=n.S$a,this.zSc=n.JBi):(this.BSc=n.Xzc,this.zSc=this.blb=null);this.SFc=this.Ns=m;this.Dwg=w}b.d(E,"a",function(){return a});z=b(0);var c=b(14),e=b(4);a.prototype.Ava=function(f){f=this.OOa+this.solutionId+f;return this.XRd?(f in a.n_b||(a.n_b[f]="AddinControl"+a.nIg++),a.n_b[f]):f};a.prototype.OGe=function(f){if(this.XRd){var m=a.n_b,n;for(n in m){var w=n;if(f===m[n])return w.substr(this.OOa.length+this.solutionId.length)}}return f};a.prototype.Lhd=function(f){f=this.OOa+
this.solutionId+f;return this.XRd?(f in a.wWc||(a.wWc[f]="AddinTab"+a.xIg++),a.wWc[f]):f};a.prototype.WUh=function(f){return f.toLowerCase()in this.Xzc?(c.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",f.toLowerCase()),this.OOa+this.Xzc[f.toLowerCase()]):null};a.prototype.iVh=function(){if(!this.S$a)return null;for(var f=[],m=Cl(this.S$a),n=m.next();!n.done;n=m.next())f.push(this.OOa+n.value);return f};a.prototype.LSh=function(f){f=this.bYe(f);return null===f?null:f[1]};a.prototype.ISh=function(f){f=
this.bYe(f);return null===f?null:f[2]};a.prototype.bYe=function(f){return this.OVd&&f.toLowerCase()in this.OVd?(c.ULS.sendTraceTag(21017039,220,50,"Get attributes for Tab id: {0}.",f.toLowerCase()),this.OVd[f.toLowerCase()]):null};Ck.Object.defineProperties(a.prototype,{OOa:{configurable:!0,enumerable:!0,get:function(){return this.MEa}},Xzc:{configurable:!0,enumerable:!0,get:function(){return this.BSc}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ns}},assetId:{configurable:!0,
enumerable:!0,get:function(){return this.SFc}},S$a:{configurable:!0,enumerable:!0,get:function(){return this.blb}},OVd:{configurable:!0,enumerable:!0,get:function(){return this.zSc}},XRd:{configurable:!0,enumerable:!0,get:function(){return this.Dwg}}});a.n_b={};a.wWc={};a.xIg=0;a.nIg=0;Object(z.a)(a,"DefaultRibbonNamingProvider",null,[224])},1405:function(z,E,b){function a(t){var u=this;this.gB=null;this.Z$f={};this.aag={};this.Ebd={};this.jzd={};this.Hjd=function(B,v){B=u.$.Ob.Hc("Task","DdaEventDispatch.HandleServerEvent");
v=v.zYf;for(var C=0;C<v.length;C++)switch(v[C].EventType){case 2:var A=v[C],M={};M.Name=A.Name;M.BindingType=A.BindingType;M.ColCount=A.ColCount;M.RowCount=A.RowCount;u.hwa(A.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,M,null);break;case 4:u.hwa(v[C].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(A=v[C],A.InstanceId){M=Array(A.Entries.length);for(var T=0;T<A.Entries.length;T++)M[T]=a.zcc(A.Entries[T],A.IsRemoteOverride);0<A.Entries.length&&1===
A.Entries[0].Category?u.h2i(A.InstanceId,M):A.InstanceId&&u.hwa(A.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,M)}else{u.Ebd={};u.jzd={};for(M=0;M<A.Entries.length;M++)u.yJe(A.Entries[M],A.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",u.Ebd,u.jzd,u.Z$f,u.aag)}}B.stop()};this.fKb=function(B,v){u.hwa(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,v)};this.$=t;this.awc=this.Hjd}b.r(E);z=b(0);var c=b(14),e=b(83),f;(function(t){t[t.none=0]="none";t[t.testEvent=1]="testEvent";t[t.test1Event=2]="test1Event";t[t.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";t[t.worksheetActivatedEvent=11]="worksheetActivatedEvent";t[t.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";t[t.worksheetAddedEvent=13]="worksheetAddedEvent";t[t.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";t[t.worksheetDeletedEvent=15]="worksheetDeletedEvent";
t[t.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";t[t.worksheetFilteredEvent=17]="worksheetFilteredEvent";t[t.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";t[t.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";t[t.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";t[t.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";t[t.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";t[t.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";
t[t.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";t[t.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";t[t.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";t[t.worksheetMovedEvent=27]="worksheetMovedEvent";t[t.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";t[t.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";t[t.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";
t[t.chartAddedEvent=50]="chartAddedEvent";t[t.chartActivatedEvent=51]="chartActivatedEvent";t[t.chartDeactivatedEvent=52]="chartDeactivatedEvent";t[t.chartDeletedEvent=53]="chartDeletedEvent";t[t.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";t[t.tableDataChangedEvent=101]="tableDataChangedEvent";t[t.tableAddedEvent=102]="tableAddedEvent";t[t.tableDeletedEvent=103]="tableDeletedEvent";t[t.tableFilteredEvent=104]="tableFilteredEvent";t[t.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";
t[t.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";t[t.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";t[t.commentAddedEvent=250]="commentAddedEvent";t[t.commentDeletedEvent=251]="commentDeletedEvent";t[t.commentChangedEvent=252]="commentChangedEvent";t[t.invocationMessage=1E3]="invocationMessage";t[t.cancellationMessage=1001]="cancellationMessage";t[t.metadataMessage=1002]="metadataMessage";t[t.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";
t[t.visualChangeEvent=2001]="visualChangeEvent";t[t.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";t[t.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";t[t.shapeActivatedEvent=2101]="shapeActivatedEvent";t[t.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";t[t.shapeAddedEvent=2103]="shapeAddedEvent";t[t.shapeDeletedEvent=2104]="shapeDeletedEvent";t[t.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";t[t.wacOperationEvent=2201]="wacOperationEvent";
t[t.recordingStateChangedEvent=2202]="recordingStateChangedEvent";t[t.workbookActivatedEvent=2203]="workbookActivatedEvent";t[t.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";t[t.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";t[t.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";t[t.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";t[t.linkedDataTypeLinkedDataTypeAddedEvent=
2502]="linkedDataTypeLinkedDataTypeAddedEvent";t[t.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";t[t.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";t[t.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";t[t.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";t[t.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";t[t.lineageActivityLoadCompletedEvent=
2802]="lineageActivityLoadCompletedEvent";t[t.pivotTableAddedEvent=2900]="pivotTableAddedEvent";t[t.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";t[t.namedItemAddedEvent=3E3]="namedItemAddedEvent";t[t.namedItemDeletedEvent=3001]="namedItemDeletedEvent";t[t.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";t[t.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";t[t.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(f||
(f={}));Object(z.b)("MessageType",f);var m=b(975),n=b(244),w=b(946),h=b(56),y=b(36),r=b(157),x=b(1);b.d(E,"DdaEventDispatch",function(){return a});a.prototype.PZb=function(t){t&&(this.$ia(),this.gB.push(t))};a.prototype.otc=function(t){this.gB&&(Array.remove(this.gB,t),this.gB.length||(this.$.wantServerEvents=!1,this.$.Odj(this.awc),this.gB=null))};a.prototype.h2i=function(t,u){var B=this,v=Object(e.a)(w.DdaFacade,n.a(this.$));y.TaskExtensions.Ba(v.fVh(t),function(C){if(r.b(C)){var A=C.result;C=v.pn(A);
if(A)if(C.zqd)B.hwa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(C.D5c)for(A=0;A<u.length;A++)C.D5c.push(u[A]);else C.D5c=u}else C.ig?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):C.Oh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.C2i=function(t,u){var B=Object(e.a)(w.DdaFacade,n.a(this.$)),
v=B.rJh(t);v?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(v,u,this.fKb):B.L4g(t,u)};a.prototype.yJe=function(t,u){var B=!1,v=parseInt(t.Type,10),C=t.Target,A=Object(e.a)(w.DdaFacade,n.a(this.$));if((C=A.ij.lVh(v,C))&&0<Object.keys(C).length){B=!0;for(var M in C)if(C=M,A.ij.g0b(C)){var T=Array(1);T[0]=a.zcc(t,u);if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var R=T[0][3];if(void 0!==R&&null!==R&&(R=Object(e.a)(Object,h.a.oi(R)))&&void 0!==
R.triggerControlId&&null!==R.triggerControlId&&void 0!==R.triggerSource&&null!==R.triggerSource){var Q=!1;u?(R.triggerSource="Unknown",Q=!0):A.Dhh(R.triggerControlId,C)&&(R.triggerSource="ThisLocalAddin",Q=!0);Q&&(T[0][3]=h.a.Lc(R))}}this.hwa(C,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,T)}}B?(this.ifc(f[v],this.Ebd),this.ifc(f[v],this.Z$f)):(this.ifc(f[v],this.jzd),this.ifc(f[v],this.aag))};a.prototype.$ia=function(){this.gB||(this.gB=[],this.$.ipe(this.awc),this.$.wantServerEvents=!0)};
a.prototype.ifc=function(t,u){t in u||(u[t]=0);u[t]+=1};a.prototype.WM=function(t,u,B){var v={};v.Target=u;v.Category=65536;v.Type=t;v.Message=B;v.Id=-1;this.yJe(v,!1)};a.prototype.fDh=function(t,u){var B={Target:"",Category:2,Type:1E3};B.Message=u;B.Id=0;u=Array(1);u[0]=a.zcc(B,!1);this.C2i(t,u)};a.prototype.v$b=function(t,u,B,v){var C={};C.Target=B;C.Category=65536;C.Type=u;C.Message=v;C.Id=-1;u=Array(1);u[0]=a.zcc(C,!1);this.hwa(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.eDh=
function(t,u){this.hwa(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.hwa=function(t,u,B,v){if(this.gB){var C=Object(e.a)(w.DdaFacade,n.a(this.$));if(!C||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||C.ij.g0b(t))for(t=new m.a(u,t,B,v),u=0,B=this.gB.length;u<B;u++)(v=this.gB[u])&&v(t)}};a.zcc=function(t,u){var B=Array(6);B[0]=t.Category;B[1]=t.Type;B[2]=t.Target;B[3]=t.Message;B[4]=t.Id;B[5]=u;return B};Object(z.a)(a,
"DdaEventDispatch",null,[])},1428:function(z,E,b){function a(){var f=e.call(this,void 0,void 0,void 0,!0)||this;f.xDa="AddinCommandsUILessDialog";f.$Sc="WACDialogTitleText";f.LVa="0";f.ADa=380;f.Aib=190;f.Oe=f.xDa;f.jc=5;f.vng=String.format("{0}px",f.ADa);f.KVa=String.format("{0}px",f.Aib);f.rv=!1;f.M7e=!1;f.uD();return f}b.d(E,"a",function(){return a});z=b(0);E=b(149);var c=b(91),e=E.a;Am(a,e);a.prototype.uD=function(){e.prototype.uD.call(this);this.Pp.style.width=this.vng;this.Pp.style.height=this.KVa;
this.Pp.style.padding=this.LVa};a.prototype.Kv=function(f){this.UO();document.getElementById(this.pi(this.$Sc)).innerText=f};a.prototype.UO=function(){e.prototype.UO.call(this);this.Nb.style.width=String.format("{0}px",this.ADa);this.Nb.style.height=String.format("{0}px",this.Aib);this.Nb.removeAttribute(c.a.Rd);this.Nb.removeAttribute(c.a.wE)};a.prototype.hide=function(){this.Sxb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,
null)};Ck.Object.defineProperties(a.prototype,{R1a:{configurable:!0,enumerable:!0,get:function(){return this.Pp}}});Object(z.a)(a,"AddinCommandsUILessDialog",E.a,[229])},1434:function(z,E,b){function a(F){return dl.call(this,F)||this}function c(F,ia,Qa){this.rangePicker=null;this.$=F;this.Ke=ia;this.De=new L(F.ea);this.jA=new R(F,this.De);this.Asf=Qa;this.N9b=new Map}function e(F,ia,Qa,Ab,Ec){this.DTc=null;this.VQb=F;this.yA=ia;this.kJ=Qa;this.wb=Ab;this.ozg=Ec}function f(){}function m(){this.Jra=
null}function n(F){if(!F)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Cwd=F}function w(F,ia,Qa){return function(Ab){return function(Ec,Mc){mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.create(ia.da,279,ia.la,1),function(zd){zd=zd.result;var Ld=!1,ye=Qa.Gi.getOsfControl(F),Te=null;ye&&(Te=ye.getStoreType(),(ye=ye.getManifest())&&ye.getSharedRuntimeForCustomFunctions("Workbook")&&(Ld=!0));mi.TaskExtensions.Ba(zd.wbf(F,Te,
Ab,Ld),function(rf){pl.b(rf)?rf.result?Ec(null):Mc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.invalidArgument,Cf.a.instance.fa(1729))):Mc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,Cf.a.instance.fa(1725)))},ia.la,3)},ia.la,3)}}}function h(F,ia){this.wP=ui.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.yA=F;this.kJ=ia;this.Ytg=this.kJ.Gi.getOsfControl(this.yA)}function y(F,ia,Qa,Ab){this.V3d="";this.LSb=0;
this.wP=F;this._id=ia;this.yA=Qa;this.kJ=Ab}function r(F,ia,Qa){this.irg=F;this.jrg=ia;this.jvg=Qa}function x(){this.Eie=this.Rce=this.sA=!1}function t(F,ia,Qa,Ab){this.Ns=F;this.g2=Qa;this.az=Ab.Gi.getOsfControl(ia)}function u(F,ia){this.kJ=ia;this.yA=F}function B(F){this.yA=F}function v(F){this.WIa={};this.eAi=F}function C(F,ia){var Qa=this;Qa.$hf=function(Ab,Ec){Ab=C.B3g(Ab,Ec);if(!kl.a(Qa.$,Ab))return!0;Ab=Qa.$.shortcutKeyManager.J3e(Ab);return!!Ab&&0<Ab.length};Qa.addinId=F;Qa.$=ia;return Qa}
function A(){}function M(){}function T(F,ia,Qa,Ab){this.WAh=F;this.fileSize=ia;this.kDj=Ab}function R(F,ia){var Qa=this;this.uI=function(Ab,Ec){Qa.VQ.nKa(ad.a.internalError,Ec)};this.$=F;this.VQ=ia}function Q(F,ia,Qa,Ab){Qa=cl.call(this,576,0,Qa,Ab)||this;Qa.PMd=new Z("576",F,ia);return Qa}function ea(F,ia,Qa,Ab,Ec,Mc,zd,Ld){ia=Xk.call(this,10,0,ia,Ld)||this;ia.Amb=Qa;ia.Vib=Ab;ia.g4=Ec;ia.EFa=Mc;ia.request=zd;ia.PMd=new Z("10",F,zd);return ia}function Z(F,ia,Qa){this.parentName=F;this.$=ia;this.request=
Qa}function ca(F,ia){this.source=F;this.eventId=ia}function I(F,ia,Qa,Ab,Ec,Mc){var zd=F.Na(1);zd.request=ia;return ej.i(F,"ExecuteRichApiRequest",zd,Qa,Ab,Ec,Mc,0)}function H(F,ia,Qa){this.$=F;this.VQ=ia;this.jA=Qa}function L(F){this.ea=F}function U(F,ia,Qa,Ab){F=Hj.call(this,F,"Select Data")||this;F.upb=null;F.gHe=ia;F.g6c=Qa;F.callback=Ab;return F}function fa(F){this.wb=F}function aa(F){F.add("InternalTest","PreviewExecutionMethod",na)}function na(F,ia){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+
typeof F+", objectId="+F+", value="+ia);return null}function ha(F,ia){this.Ysg=F;this.vtg=ia}function ka(F){var ia=F.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Qa=ia.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Qa.addParameter("shortcuts","String[]",1,null,0);ia.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Qa=ia.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);
Qa.addParameter("shortcuts","Object",1,null,0);ia=F.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Qa=ia.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Qa.addParameter("pickerCustomizationJsonString","String",1,null,0);ia=F.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Qa=ia.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",
0);Qa.addParameter("base64File","String",1,null,0);ia=F.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Qa=ia.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Qa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ia=F.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}",
"{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ia.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Qa=ia.addMethod("Register",1,"Void",0,0,"Register",0);Qa.addParameter("metadata","String",1,null,0);Qa.addParameter("javascript","String",1,null,0);ia=F.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ia.addProperty("Enabled",1,"Boolean",1,!1,null,0);ia.addProperty("NativeRuntime",3,"Boolean",1,!1,null,
0);ia.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);ia=F.addEnumType("Microsoft.Authentication.IdentityType");ia.addEnumField("OrganizationAccount",0);ia.addEnumField("MicrosoftAccount",1);ia=F.addEnumType("Microsoft.Authentication.AuthorityType");ia.addEnumField("External",0);ia.addEnumField("Msa",1);ia.addEnumField("Aad",2);ia=F.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);ia.addProperty("DisplayName",
4,"String",1,!1,null,0);ia.addProperty("Email",3,"String",1,!1,null,0);ia.addProperty("FederationProvider",2,"String",1,!1,null,0);ia.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ia=F.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ia.addProperty("AppId",4,"String",1,!1,null,0);ia.addProperty("Authority",2,"String",1,!1,null,0);ia.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",
1,!1,null,0);ia.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);ia.addProperty("TenantId",6,"String",1,!1,null,0);ia.addProperty("Upn",1,"String",1,!1,null,0);ia=F.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ia.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Qa=ia.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",
4);Qa.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);ia.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ia.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);ia=F.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ia.addProperty("AuthChallenge",3,"String",1,!1,null,0);ia.addProperty("CorrelationId",
7,"String",1,!1,null,0);ia.addProperty("Policy",4,"String",1,!1,null,0);ia.addProperty("Resource",2,"String",1,!1,null,0);ia.addProperty("Scope",5,"String",1,!1,null,0);ia.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ia=F.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ia.addProperty("AccessToken",2,"String",1,!1,null,0);ia.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,
null,0);ia=F.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ia.addProperty("Id",1,"String",1,!0,null,0);ia.addProperty("Value",2,"Object",1,!1,null,0);ia=F.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Qa=ia.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Qa.addParameter("id","String",1,null,0);Qa=ia.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",
3,1,"ItemOrNullObject",0);Qa.addParameter("id","String",1,null,0);ia=F.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Qa=ia.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Qa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ia=F.addEnumType("Microsoft.AppRuntime.AppRuntimeState");
ia.addEnumField("Inactive",0);ia.addEnumField("Background",1);ia.addEnumField("Visible",2);ia=F.addEnumType("Microsoft.AppRuntime.Visibility");ia.addEnumField("Hidden",1);ia.addEnumField("Visible",2);ia=F.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ia.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Qa=ia.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",
0);Qa.addParameter("jsonCreate","String",1,null,0);Qa=ia.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Qa.addParameter("jsonUpdate","String",1,null,0);Qa=ia.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Qa.addParameter("id","String",1,null,0);Qa=ia.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Qa.addParameter("id","String",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=F.addType("Microsoft.DynamicRibbon.RibbonTab",
"{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ia.addProperty("Id",2,"String",1,!0,null,0);Qa=ia.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Qa.addParameter("visibility","Boolean",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=F.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ia.addProperty("Enabled",3,"Boolean",1,!1,null,0);ia.addProperty("Id",2,"String",1,!0,null,0);ia.addProperty("Label",4,"String",1,!0,null,0);
Qa=ia.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Qa.addParameter("enabled","Boolean",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=F.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ia.addMethod("GetCount",3,"Int32",1,1,"Count",0);Qa=ia.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Qa.addParameter("key","String",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",
!0);ia=F.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ia.addEnumField("Unknown",0);ia.addEnumField("Basic",1);ia.addEnumField("Premium",2);ia=F.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Qa=ia.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Qa.addParameter("feature","String",1,null,0);Qa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",
1,null,0);Qa=ia.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Qa.addParameter("feature","String",1,null,0);Qa=ia.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Qa.addParameter("feature","String",1,null,0);Qa.addParameter("fallbackValue","Boolean",1,null,0);ia.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Qa=ia.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Qa.addParameter("experienceId",
"String",1,null,0);Qa=ia.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Qa.addParameter("feature","String",1,null,0);ia=F.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ia.addProperty("Id",5,"String",1,!0,null,0);ia.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ia.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ia=F.addType("Microsoft.InternalService.AddinInternalService",
"{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ia.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ia=F.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ia.addMethod("Disable",3,"Void",0,1,"Disable",0);ia.addMethod("Enable",2,"Void",0,1,"Enable",0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function xa(F,
ia,Qa,Ab){this.menuItemId=F;this.nG=ia;this.OGj=Qa;this.gBh=Ab}function va(F){this.yyi=F}function Aa(F){this.jya=F;this.Dog=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function qa(){}function wa(){}function Ta(){}function sb(F,ia){this.bib=ia;this.yA=F}function db(){this.g3d=null;this.Uge=this.eWb=this.ZD="";this.eie=!0;this.options=null}function kb(F,ia){this.yQb=F;this.Bjb=ia}function ac(){}function ta(){this.y7d=this.S6d=this.Jfa=null;
this.Bjb=0}function ra(F){var ia=lk.call(this)||this;ia.$=F;ia.Tb();return ia}function Na(){this.initialized=!1;this.agaveCommandManager=this.Ke=this.G0a=null;this.aV={}}function gb(F){var ia=Vi.call(this)||this;ia.$=F;ia.Tb();return ia}function ob(F,ia,Qa){this.vlg=null;this.xlg=0;this.vb=F;this.Wg=ia;this.B4d=Qa}function wb(){}function Oa(F,ia,Qa,Ab,Ec){var Mc=gk.call(this)||this;Mc.oSa={};Mc.Kbd={};Mc.Iwa=null;Mc.Gza=null;Mc.B5h=function(zd,Ld,ye,Te,rf){if(2!==ye)return 32;zd=rf[hj.a.E9b];ye=rf[hj.a.LHa];
rf=rf[hj.a.pza];Ld=new Wi.a;Ld.ydi=rf.ri.InstanceToken;Ld.ml=rf.ri[ld.ml];Ld.fT=rf.ri[ld.fT];ld.taskPaneWidth in rf.ri&&(Ld.taskPaneWidth=rf.ri[ld.taskPaneWidth]);Ld.sourceLocationOverrideResourceId=rf.ri[ld.sourceLocationOverrideResourceId];Ld.qI=rf.pr;Ld.onTaskPaneClose=rf.ri[ld.onTaskPaneClose];Ld.LHa=ye;ye=new Vb.a(-859308420,0,2,0,"");Te=zd.getStoreType()===OSF.StoreType.Sdx;var dg=new jc;dg.xba=rf.ri.HeaderCssClass||ze.a.P2a;dg.ENb=rf.ri.TitleCssClass;Mc.l1(ye,zd.getId(),Ld,Te,dg);return 32};
Mc.m5h=function(zd,Ld,ye,Te,rf){if(2!==ye)return 32;zd=rf[hj.a.E9b].getId();rf=rf[hj.a.pza].ri[ld.sourceLocationOverrideResourceId];return zd?(Mc.Ke.Gi.refreshOsfControl(zd,rf),32):8};Mc.S_i=function(zd){zd=zd.Result;if(zd=null===zd?null:zd.SolutionId)Mc.Ke.sme(zd),Ik.a(Mc.$).Dna(3,zd)};Mc.uIf=function(zd,Ld){var ye,Te=(zd=zd.Result)?zd.AgaveData:null;if(Te){Xa.ULS.shipAssertTag(537170434,0,Te.TaskpaneWidth===Oa.pdh,"Taskpane width is {0}, assetId is {1}.",Te.TaskpaneWidth,Telemetry.PrivacyRules.GetPrivacyCompliantId(Te.PrimaryMarketplace.SolutionId,
Te.PrimaryMarketplace.MarketplaceType,null===(ye=null===Te||void 0===Te?void 0:Te.AssetMarketplace)||void 0===ye?void 0:ye.SolutionId,null,null,Te.PrimaryMarketplace.MarketplaceRef));if(ye=Mc.Kbd[Te.PrimaryMarketplace.SolutionId])ye.oAc&&(Te.TaskpaneTitle=ye.oAc),ye.mAc&&(Te.TaskpaneIconId=ye.mAc),ye.cWd&&(Te.TaskpaneButtonTooltip=ye.cWd),0<ye.Eu&&(Te.TaskpaneWidth=ye.Eu);Ld&&(Te.FocusOnIframeWhenLoaded=Ld.focusOnIframeWhenLoaded,Ld.width&&(Te.TaskpaneWidth=Ld.width),Te.TaskpaneIconCssClass=Ld.Qk,
Te.TaskpaneHeaderCssClass=Ld.xba,Te.TaskpaneTitleCssClass=Ld.ENb,Te.IsFirstPartyOptOutAppContextOptmization=Ld.isFirstPartyOptOutAppContextOptmization);Mc.oSa[Te.PrimaryMarketplace.SolutionId]&&(Te.OsfPropertyBag=Mc.rxd(Te.OsfPropertyBag,Te.PrimaryMarketplace.SolutionId));jk.a(Te)||(Te.WebExtensionOsfControlType=1);Te&&(Mc.Ke.sme(zd.SolutionId),Mc.Ke.g1a(Te))}else Xa.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};Mc.pAh=function(zd){zd&&
(Mc.Jad.Kjf(zd),Mc.Rxe())};Mc.wIf=function(zd){zd=zd.toDataURL("image/jpeg");var Ld=Mc.Ke.Waa(Oa.V8e+"."+Oa.C5e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ld,"onScreenshot",{screenshot:zd},function(){})};Mc.P3h=function(zd,Ld,ye,Te,rf){if(2!==ye)return 32;if(Bi.a.Gh(rf)||rf[hj.a.bCe]!==Oj.a.action)return 8;Ld=rf[hj.a.pza];return Ld?(zd=(zd=Mc.kVh(rf))?Mc.Ke.Waa(zd):null)?(rf=Mc.Ke.I4g(rf[hj.a.LHa],Ld.ri[ld.bUc]),cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&
(ye=Mc.Ke.YZ(zd),ye.TaskpaneTitle!==Ld.ri[ld.ml]&&(ye.TaskpaneTitle=Ld.ri[ld.ml],ye.TaskpaneIconCssClass=Ld.ri.IconCssClass,ye.TaskpaneIconUrl=Ld.ri.TaskPaneIconUrl,ye.TaskpaneIconId=Ld.ri.TaskPaneIconId,cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Ld=Mc.Ke.Gi,Ld.changeIframeTitle(zd,ye.TaskpaneTitle),ye=Ld.getOsfControl(zd),Ld.raiseOsfControlStatusChange(ye)):(Ld=Mc.Ke.Gi.getOsfControl(zd),Mc.Ke.Gi.raiseOsfControlStatusChange(Ld)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(zd,
rf,Mc.fKb),32):8:8};Mc.fKb=function(zd,Ld){Mc.Ke.aDh(zd,Ld)};Mc.$=F;Mc.viewBlockContainerHelpers=Qa;Mc.Ke=ia;Mc.Jad=Ab;Mc.Ei=Ec;Mc.Ei.fc(X.a.f4f,Lj.a.frame,Mc.B5h);Mc.Ei.fc(X.a.qUf,Lj.a.frame,Mc.m5h);Mc.Ei.fc(X.a.oSe,Lj.a.frame,Mc.P3h);return Mc}function sa(){var F=xj.call(this)||this;F.KVa="calc(100% - 46px)";F.IRb="15px";F.LVa="0";F.pog="WACDialogPanel";F.ADa=695;F.qog=462;F.Aib="80%";F.emg=350;F.y3d="100%";F.jc=5;F.Oe="AppsForOfficeInsertionDialog";F.DIc=!!ke.AFrameworkApplication.ga&&ke.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");
return F}function Fa(){var F=Wa.call(this)||this;F.isTable=!1;F.isPivotTable=!1;F.hasTableHeaders=!1;F.tableName=null;F.userSelectedPivotTable=!1;return F}function Wa(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function Db(){this.cWd=this.oAc=null;this.Eu=0;this.mAc=null}function pc(){var F=this;this.Ke=null;this.Vab=function(ia,Qa,Ab,Ec,Mc){if(2===Ab){ia=Mc?Mc:{};
Qa=ia.callback;if(!Qa)return 16;F.Ke.qda(Qa,ia.refresh?ia.refresh:!1)}return 32};this.H9i=function(ia,Qa,Ab,Ec,Mc){2===Ab&&(ia=Mc?Mc.callback:null)&&F.Ke.aFg(ia);return 32}}function lc(F,ia){this.O9=ia}function eb(F){return Ji.call(this,F)||this}function ib(F){var ia=ni.call(this)||this;ia.$=F;ia.isFirstLaunch=!1;return ia}function cc(F){Xa.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.fpf=ke.AFrameworkApplication.ga.ra("IsTellMeUpSellEnterpriseEnabled");this.Rxi=ke.AFrameworkApplication.ga.Va("SmartLookupApprovedOriginPattern");
this.$8a=ke.AFrameworkApplication.ga.Va("SmartLookupShredderServiceEndpoint");this.wyi=Vk.a.bN(ke.AFrameworkApplication.ga.Va("AppCatalogUrl")||"");this.Z8a=new pb;this.Z8a.EnableAllTabV2=!0;this.Z8a.EnableIntentService=!0;this.Z8a.EnableInDocumentSearch=ke.AFrameworkApplication.ga.ra("SmartLookupEnableInDocumentSearch");this.Z8a.EnableLocalSearch=ke.AFrameworkApplication.ga.ra("SmartLookupEnableLocalSearch");this.Z8a.IntentServiceEndpoint=Pa.LYh();this.qyi=new nc(F,this.$8a)}function Pa(){}function nc(F,
ia,Qa){this.vLj=9E5;this.yLj=3E5;this.gwd=null;this.zof="";this.dwd=0;this.dHe=Date.now;this.jya=F;this.$8a=ia;(void 0===Qa||Qa)&&this.Pdd()}function pb(){}function rb(){}function Ya(){}function ec(){}function yd(){}function Ub(F,ia,Qa,Ab,Ec,Mc){this.$=F;this.agaveCommandManager=Mc}function Ob(F){var ia=pj.call(this)||this;ia.ddaFacade=null;ia.rNf=null;ia.$=F;F.da.Ga(106,ia);ia.Tb();return ia}function Yb(){}function xb(){}function Sa(F){this.KFa=F}function Tb(F,ia,Qa){this.iframe=F;this.onSuccess=
ia;this.onError=Qa;$addHandler(window,"message",Object(od.a)(this,this.j7e,"handleResponse"))}function Cc(F,ia){return Vf.a.Cud(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},ke.AFrameworkApplication.ga.Cd("MaxRetriesForLoadingScript",0),F,ia)}function Fb(F){var ia=Oi.call(this)||this;ia.$=F;ia.Tb();return ia}function hc(F,ia){var Qa=this;this.uQa=this.vQa=null;this.Bag=function(Ab,Ec){var Mc=null,zd=null,Ld=null;Ec?(Object(dj.a)(516,Ec)?(Mc=Ec.zGa,Ld=Ec.instanceId):
Object(dj.a)(429,Ec)&&(Mc=Ec.get_element(),Ld=Ec.instanceId),Mc)?(zd=Object(Oh.a)(794,Ab),zd)?Qa.sNf(Ld,Mc,zd)||Ld in Qa.uQa||(Qa.vQa[Ld]=0,Qa.uQa[Ld]=Ih.a.instance.GC(function(){10<=Qa.vQa[Ld]||Qa.sNf(Ld,Mc,zd)?(delete Qa.vQa[Ld],Qa.uQa[Ld].dispose(),delete Qa.uQa[Ld]):Qa.vQa[Ld]+=1},500,fj.a.fJg,!0,!1)):Xa.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Xa.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):
Xa.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=F;this.$=ia;this.fYc=!1;this.$.da.Ga(224,this)}function cd(F){var ia=Gh.call(this)||this;ia.$=F;ia.Tb();return ia}function mb(F){var ia=xf.call(this,F)||this;ia.handler=null;ia.iAg=function(){Xa.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",ia.$.isEditMode,!!(ia.$.Pd&16384));var Qa=new Dk.a;ia.$.da.$a(53,function(rf){Xa.ULS.sendTraceTag(38410435,
0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Qa.setResult(rf)});var Ab=Qa.task,Ec=new Ne,Mc=Uk.a.getInstance(),zd=new $f(ia.$,Mc),Ld=nj.GetServiceTaskFactory.create(ia.$.da,203,ia.la,ia.ub),ye=ia.H8i(Ec),Te=nj.GetServiceTaskFactory.Ua(ia.$.da,349,350,ia.ub);return mi.TaskExtensions.Ba(mi.TaskExtensions.xe([Ab,Ld,ye,Te],ia.la),function(){Xa.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.create(ia.$.da,106,ia.la,ia.ub),function(rf){ia.handler=new $a(ia.$,rf.result,Ec,new rd,Mc,zd,ui.a.instance.Lh("Common.IExternalUICommandDefinitionMapping"));Xa.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");ia.Dd([ia.handler]);ia.$.da.Ga(198,ia.handler)},ia.la,3)},ia.la,3)};ia.zch=function(){void 0!==ia.handler&&null!==ia.handler?(ia.$.Ka.Fbb(ia.handler),ia.$.da.oV(198),ia.handler=null):Xa.ULS.sendTraceTag(42341715,
0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");ia.$.da.oV(204);mf.a(Be.a,21,ia.$.da,198)};return ia}function $a(F,ia,Qa,Ab,Ec,Mc,zd){var Ld=this;zd=void 0===zd?null:zd;this.disposed=!1;this.vHi=function(ye,Te){if(Te)if(Te)if(ye=Te.hi){Te=Te.Ko;var rf=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(ye.solutionId in rf)Te=rf[ye.solutionId];else if(Te=Ld.iNh(Te),void 0===Te||null===Te){Xa.ULS.sendTraceTag(528098434,
220,15,"addinCommandControlId is NullOrUndefined");return}rf=new Vb.a(X.a.c3,0,0,2,null);var dg={};Ld.executeCommand(0,rf,(dg.SourceControlId=Te,dg),null);ye.isAutoLaunched=!0}else Xa.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Xa.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else Xa.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.NOi=function(ye,Te){ye=null;Te&&(ye=Te);(null===ye||void 0===ye?0:ye.Ko)&&Ld.ftj(ye.Ko);Ld.$.Bf();cg.EwaSettings.ma(88)&&
ye&&ye.hi&&Ld.MNg(ye.hi)};this.$=F;Xa.ULS.shipAssertTag(537170659,0,!(void 0===ia||null===ia),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",Hc.a.W3());this.Ke=ia;this.NCe=Qa;this.j_b=Ab;this.tha=Ec;this.job=Mc;this.Uo=new xc.a;this.sha=new Jf;this.uad=zd;hl.a.Vxb=hl.a.kSe;this.q6c=new sg.a;this.X1a=new sg.a}function K(F){var ia=this;this.pGa=this.sGa=this.hi=this.Ko=null;this.RPf=0;this.MOi=function(){if(ia.hi&&ia.pGa){var Qa=new Vb.a(X.a.c3,0,0,2,null),
Ab={};ia.addinUICommandHandler.executeCommand(0,Qa,(Ab.SourceControlId=ia.pGa,Ab),null);Xa.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.Zzj=function(Qa,Ab){Qa=null;if(Ab)if(Qa=Ab,ia.hi=Qa.hi,ia.Ko=Qa.Ko,ia.Ko&&ia.Ko.UW&&ia.Ko.UW.Qr&&(ia.sGa=ia.Ko.UW.Qr.oa(0)),ia.sGa&&ia.sGa.id)if(ia.sGa.isOfficeTab)if(Ab=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),ia.hi.assetId in Ab?ia.pGa=Ab[ia.hi.assetId]:(Xa.ULS.sendTraceTag(537170695,220,
15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(ia.hi.storeType,ia.hi.storeId,ia.hi.assetId)),ia.pGa=ia.wJh(ia.Ko)),ia.pGa)if(Jk.a.contains(ia.sGa.id,bi.a.kX,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Pk.a.evb(ia.Ko),function(){ia.h5f(ia.Wgd(ia.pGa))});else{if(Ab=ia.$.Ka)Ab.rpe(ia.oEf),Xa.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Xa.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),
Ab={},Ab=(Ab.AppTeachingUICalloutAction="NoEnabledButtonFound",Ab["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ia.hi.storeType,ia.hi.storeId,ia.hi.assetId),Ab.AppTeachingUICalloutGoal="NewAdminDeployment",Ab["SDX.AppInstallOrigin"]="Organization",Ab),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(Ab)})),ia.qya();else ia.j5f(ia.Wgd(ia.sGa.id),0);else Xa.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
Ab={},Ab=(Ab.AppTeachingUICalloutAction="NoTabFound",Ab["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ia.hi.storeType,ia.hi.storeId,ia.hi.assetId),Ab.AppTeachingUICalloutGoal="NewAdminDeployment",Ab["SDX.AppInstallOrigin"]="Organization",Ab),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(Ab)})),ia.qya();else ia.qya()};this.oEf=function(){if(Jk.a.contains(ia.sGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Qa=ia.$.Ka;Qa&&
Qa.IRf(ia.oEf);ia.h5f(ia.Wgd(ia.pGa))}};this.$=F.$;this.addinUICommandHandler=F;this.appName=ke.AFrameworkApplication.ga.Va("WebAppShortName")||"Excel";this.rIg=ke.AFrameworkApplication.ga.Cd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}function ba(F,ia){this.MEa=F;this.pfa=new Fc;this.zfa=new Gc(ia)}function ua(F,ia,Qa,Ab,Ec,Mc){F=ub.call(this,F,ia)||this;F.h9=null;F.Cfa=null;F.Ffa=null;F.zfa=Qa;F.lqg=Ab;F.SFc=Ec;F.Fpa=Mc;return F}function La(F){this.Rge=null;if(Zi.c(F))throw Xa.ULS.sendTraceTag(9041813,
220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.cwg=F}function ub(F,ia){this.Vie=new sg.a;this.sx=this.$v=null;this.Okb=F;this.pfa=ia}function Va(F){this.Sge=this.q8d=this.Rie=null;this.isOfficeTab=!1;this.c6e=this.KWf=null;this._id=F;this.vTa[Ah.a.id]=this._id}function tb(F){this.l5d=this.p8d=this.Gmb=null;if(Zi.c(F))throw Xa.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),
Error.create("GroupDefinition id should not be null or undefined");this._id=F;this.ewa[Ah.a.id]=this._id}function Cb(F,ia,Qa,Ab,Ec,Mc){this.IQb=new sg.a;this.h9=this.sx=this.$v=null;this.Okb=F;this.pfa=ia;this.zfa=Qa;this.Ns=Ab;this.Fpa=Ec;this.m7d=Mc}function nb(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Ib(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=
null}function hb(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function zb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function Gc(F){this.mDa=F}function Fc(){}function Ed(F,ia){this.Gmb=new Jc(F,ia)}function Jc(F,ia){this.eyg=F;this.Fng=ia}function Ca(F){this.MEa=F}function bb(F,ia,Qa){this.jJ=this.TVa=null;this.Okb=F;this.zfa=ia;this.pfa=Qa;this.dtg=new sg.a}function dc(F){this.g9=null;
if(Zi.c(F))throw Xa.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=F}function Ac(F){this.$Nc=null;if(Zi.c(F))throw Xa.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=F;this.eS[Ah.a.id]=this._id}function nd(F,ia){this.lga=this.k5d=null;if(Zi.c(F)||Zi.c(ia))throw Xa.ULS.sendTraceTag(9175312,
220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.m5d=ia;this._id=F;this.eB[Ah.a.id]=this._id}function qd(F,ia,Qa,Ab,Ec,Mc,zd,Ld){Ld=void 0===Ld?null:Ld;this.Za=new vk.a;this.iVa=F;this.j5d=ia;this.zm=Qa;this.NXb=Ab;this.Bga=Ec;this.Wkg=Mc;this.Fpa=zd;this.Cde=Ld;this.jEa=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.MWa=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",
!1);this.vrg=ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}function Gb(F,ia,Qa,Ab,Ec,Mc,zd){this.lTa=new zk.a;this.rs=F;this.Gi=ia;this.Uo=Qa;this.ribbonManager=Ab;this.contextMenuManager=Ec;this.BD=Mc;this.sha=zd;this.YO=ke.AFrameworkApplication.sa.MD}function Oc(F,ia,Qa){this.D2d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=F;this.eventBuilder=ia;this.contextMenuBuilder=
Qa}function he(F){this.Iog=F.entitlement}function Wd(F,ia,Qa,Ab,Ec){ia=void 0===ia?null:ia;Qa=void 0===Qa?null:Qa;Ab=void 0===Ab?null:Ab;Ec=void 0===Ec?0:Ec;if(Zi.c(F)&&Zi.c(ia))throw Xa.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.QY=F;this.Qtg=ia;this.nxg=Qa;this.blb=Ab;this.Lpg=Ec}function rc(F){this.xde=
null;if(Zi.c(F))throw Xa.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.flg=F}function gd(){}function kd(){}function Qc(F){this.Dae=null;this.z9d=F}function de(F,ia,Qa){this.Gpa=null;this.Za=F;this.CTb=ia;this.fhb=Qa}function Xe(F,ia,Qa,Ab,Ec,Mc,zd){this.rs=F;this.hi=ia;this.U0=Qa;this.qWe=Ab;this.LFh=Ec;this.displayName=Mc;this.fkf=zd}function ge(){var F=Wk.call(this)||this;F.hi=null;F.Ko=null;return F}
function fc(){new dd(ik.a.instance)}function dd(F){this.xEa=F}function oc(){this.Ver=1}function Zb(){}function Sc(F){this.Xtg=F}function sd(F,ia,Qa){this.Qa=new vk.a;this.context=new Le;this.yzc=this.QXc=this.dUd=this.lsa=this.Yda=this.Gpa=null;this.contextActivationMgr=F;this.oIg=ia;this.k_b=Qa;this.appName=ke.AFrameworkApplication.ga.Va("WebAppShortName")}function fd(F){var ia=Bk.call(this)||this;ia.solutionId=F.solutionId;ia.assetId=F.assetId;ia.storeType=F.storeType;ia.storeId=F.storeId;ia.assetStoreId=
F.assetStoreId;ia.targetType=F.targetType;ia.width=F.width;ia.height=F.height;ia.displayName=F.displayName;ia.version=F.version;return ia}function qc(){this.addinId=null;this.targetType=0;this.storeId=this.assetId=this.solutionId=null}function vb(F,ia,Qa,Ab){this.oJb=ke.AFrameworkApplication.ga.Va("RoamingServiceHandlerWebServiceBase");this.appName=F;this.qjb=ia;this.mjb=Qa;this.ulb=void 0===Ab?null:Ab}function Pd(F){var ia=il.call(this)||this;ia.properties=F;return ia}function Tc(){this.IA=this.rq=
null;this._count=0}function Ve(F,ia,Qa){this.next=Qa;this.previous=ia;this.data=F}function kf(F){this.Mr=null;this.vA=F}function of(F){var ia=-1;switch(F.toLowerCase()){case "omex":ia=0;break;case "spcatalog":ia=1;break;case "spapp":ia=2;break;case "filesystem":ia=3;break;case "exchange":ia=4;break;case "registry":ia=6;break;case "inmemory":ia=7;break;case "uploadfiledevcatalog":ia=8;break;case "hardcodedpreinstall":ia=9;break;case "excatalog":ia=10;break;case "wopicatalog":ia=16}return ia}function vf(F){var ia=
null;switch(F){case 0:ia="omex";break;case 1:ia="spcatalog";break;case 2:ia="spapp";break;case 3:ia="filesystem";break;case 4:ia="exchange";break;case 6:ia="registry";break;case 7:ia="inmemory";break;case 8:ia="uploadfiledevcatalog";break;case 9:ia="hardcodedpreinstall";break;case 10:ia="excatalog";break;case 16:ia="wopicatalog"}return ia}function ne(F){var ia={};ia.solutionId=F.solutionId;ia.version=F.version;ia.storeType=F.storeType;ia.storeId=F.storeId;ia.assetId=F.assetId;ia.assetStoreId=F.storeType;
ia.targetType=F.targetType;ia.requireConsent=F.requireConsent||!1;ia.isAddinCommands=!0;ia.addinCommandsActionType=0;ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(ia.id=F.solutionId,ia.appVersion=F.version,ia.currentStoreType=F.storeType);return ia}function Ad(){return Vk.a.b5(window.location.href.toLowerCase(),"wdtpl")}function Xd(){var F=Vk.a.b5(window.location.href.toLowerCase(),"wdomexsrctype");return!!F&&"4"===F}function ee(){}
function Le(){this.rs=this.D0=0;this.sWc=null;this.krc=this.$Ac=0;this.a4b=this.Eja=this.o$=null}function Jf(){this.qZa=null}function $f(F,ia){var Qa=ml.call(this)||this;Qa.statusBarManager=null;Qa.agaveCommandManager=null;Qa.Pze=function(){Qa.BD&&Qa.BD.wze()};Qa.f6e=function(){Qa.raiseEvent("LAC")};Qa.qd=function(Ab,Ec){!Ab.sc&&ek.b(Ec)&&Qa.statusBarManager&&(Qa.statusBarManager.ZF(Qa),Qa.statusBarManager=null)};Qa.BD=ia;Qa.$=F;Qa.jGj=F.Lb+"OfficeAddinLabel-Medium14";Qa.$.da.$a(29,function(Ab){Qa.statusBarManager=
Ab;Ab.EJ(Qa)});Qa.$.ea.gk(Qa.qd);Qa.BD.pEg(Qa.f6e);Qa.$.da.$a(206,function(Ab){Qa.agaveCommandManager=Ab;Ab.UFg(Qa.Pze)});return Qa}function Dc(){}function Sd(){this.Ci=null;this.visible=!1}function te(F,ia){this.Sa=F;this.P2g=ia}function rd(){this.j3d=this.ZEc=null}function Ue(F){this.ige=new ef(F)}function ef(F){this.V9=F;this.oWb=this.V9.ribbonBuilder}function pe(){var F=tj.call(this)||this;F.$md=null;F.Fmd=null;F.ribbon=null;return F}function Ne(){this.Amg=new sg.a}function gg(){}function ie(F){return sk.call(this,
F)||this}function Re(F,ia,Qa){this.qsb=null;this.$=F;ia?(Xa.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.qsb=new rl.a(F,ia,Qa)):Xa.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}function Ig(F){var ia=el.call(this)||this;ia.$=F;ia.Tb();return ia}function Lf(F,ia){var Qa=qf.call(this)||this;Qa.$=F;Qa.d2a=new DOMParser;Qa.cache=
new Gj.a;Qa.indexedDB=ia;ia.Mg()&&Qa.indexedDB.initialize("Scripts","OfficeScriptingCache");Qa.uxb=!1;Qa.nq=new Ef([],function(Ab){qf.jEj(Ab)});Qa.Tj=new Ef([],function(Ab){qf.fUd(Ab)});Qa.NB=new Ef([],function(Ab){qf.fUd(Ab)});Qa.tt=new Ef([],function(){});return Qa}function qf(){this.tt=null;this.uxb=this.vHb=this.mX=this.kbb=this.SHd=this.ZMf=this.QHd=this.lbb=this.$dc=!1;this.NB=this.Tj=this.nq=null}function vg(F,ia,Qa,Ab){var Ec=this;this.I7a=!1;this.S9a=function(){Ec.Y2f()?(Ec.CIf(),Ii.g(Ec.$).Ea.TJd(Ec.S9a)):
Ec.I7a&&Ii.g(Ec.$).Ea.TJd(Ec.S9a)};this.wJi=function(Mc,zd){Object.getType(zd)===String&&zd.toString().endsWith(If.a.Bwb(Ec.$))&&(Ec.I7a=!1)};this.$=F;this.Hsa=ia;this.Xu=Qa;this.businessBarManager=Ab;this.wvj()}function jc(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.ENb=this.xba=this.Qk=null;this.isFirstPartyOptOutAppContextOptmization=!1}function zc(F,ia,Qa,Ab,Ec,Mc,zd,Ld,ye){var Te=this;this.UA=null;this.cache=new Gj.a;this.jxa=!1;this.yGa={};this.$=F;this.DQc=Qa;this.indexedDB=Ab;this.kpb=
Ec;this.Xu=Mc;this.Hsa=zd;this.pf=Ld;this.Kx=ye;this.QNg=new Xf(this,F);this.Xqg=ai.a.Ta.Wb;this.x7f="";Ab.Mg()&&(this.jxa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));F=!0;if(Og.a.pve){this.cache.Mg()&&!If.a.EIa&&(ia=this.pf.xLh(If.a.Kac(this.$)),ia.isSuccess&&(F=Qi.getElapsedSeconds(ia.timeStamp,ai.a.Ta.Wb),this.Xu.xy=new Se(!0,!0),this.UA=new Se(ia.value,!0),F=this.UA.value?604800<F:86400<F,this.wxb=this.GSa(!0)));this.BJh();if("undefined"!==typeof makerstorage&&this.$if)if(this.x7f=
pa(this.$),$b(this.$))qb(this.$,"localstorageToken"),this.Xu.xy=new Se(!0,!0),this.UA=new Se(!0,!0),this.wxb=this.GSa(!0);else if((ia=If.a.U0e())&&makerstorage.setStorageEnvironmentOverride(ia),F||If.a.EIa)try{this.$.qdb("automateTab",!0),this.wxb=If.a.EIa?this.Xu.L0c().then(function(){return Te.GSa(!1)}).catch(function(){return Te.GSa(!1)}):this.Xu.L0c().then(function(){return Te.Hsa.Wbc()}).then(function(rf){return Te.b6h(rf)}).then(function(){return Te.GSa(!1)}).catch(function(){return Te.GSa(!1)})}catch(rf){Xa.ULS.sendTraceTag(537170314,
0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",rf.message),this.wxb=Promise.resolve(!1),this.$.qdb("automateTab",!1)}cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.wxb?this.wxb.then(function(rf){return Te.cLd(rf)}):this.cLd(!1)}else Xa.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.cLd(!1)}function Md(F,
ia,Qa,Ab,Ec,Mc){this.actionName=F;this.shapeId=ia;this.scriptLink=Qa;this.clickId=Ab;this.bca=Ec;this.buttonText=Mc}function Ce(F,ia,Qa,Ab){this.old=F;this.xzh=ia;this.pza=Qa;this.LHa=Ab}function ae(F){return ii.a.Ld(F)?ze.a.iPe:ze.a.hPe}function ud(F){return ii.a.Ld(F)?F.isChromeRtl?ze.a.zsh:ze.a.ysh:ze.a.P2a}function Rb(F){F=F.na.va.Na(1);F.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",
RequestHeaders:null,RequestBody:"",RequestFlags:256};return F}function Ie(F,ia,Qa,Ab,Ec){function Mc(){function dg(Jg,dh,bj){return ej.i(Ld.va,"ExecuteRichApiRequest",Ab,Gi.b(Jg,ia),Gi.a(dh,Qa),bj,null,0)}if(zd.RHa()||0<Ld.va.I4||0<Ld.Kk.I4)return!1;ye&&zd.Cr(ye);Te&&Ld.Dr(Te);rf&&Ld.Yz(rf);cg.EwaSettings.qc()?zd.Zt(new yk.a(507,0,dg,80)):zd.Zt(new Hk.a(507,0,dg,16));return!0}var zd=F.userOperationManager,Ld=F.na,ye=null,Te=null,rf=null;Mc()||(ye=function(){Mc()},Te=function(){Mc()},rf=function(){Mc()},
zd.Wu(ye),Ld.Bq(Te),Ld.iz(rf));return Ec.task}function pa(F){if($b(F))return cg.EwaSettings.getBooleanFeatureGate(If.a.OCb,!1)?"makerservicelocal":"localstorage";F=If.a.U0e();return If.a.NZh(F)}function qb(F,ia){$b(F)&&(cg.EwaSettings.getBooleanFeatureGate(If.a.OCb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(F.ya.UserSessionId);makerstorage.setUserAccessInfo(new tc(ia,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,
"1")}function Sb(F,ia){ia.WacTaskPaneInfra=ii.a.Ld(F);ia.TaskpanelessRFB=cg.EwaSettings.getBooleanFeatureGate(If.a.p9f,!1);ia.OfficeScriptsAutomateTask=If.a.iuf;ia.DeferAdminCheck=If.a.EIa}function $b(F){return"TestHost"===F.ya.DocumentHostInfo.HostTier}function tc(F,ia){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=F;this.currentUserMlapiToken=ia}function ld(){}function Vc(){this.xy=null;return this}function Se(F,ia,Qa,Ab,Ec){this.value=F;this.isSuccess=ia;this.timeStamp=
void 0===Qa?null:Qa;this.errorCode=void 0===Ab?"":Ab;this.errorMessage=void 0===Ec?"":Ec}function Ge(){this.xy=null}function Af(F,ia){this.TF=null;this.$=F;this.pf=ia;return this}function jf(F){this.jaa=Sh.b(F)||{};this.shareId=this.shareId||null}function Ef(F,ia){this.scripts=F;this.f6f=ia}function Xf(F,ia){this.automateCommandManager=F;this.$=ia}function ug(){this.TF=null}function Wb(F,ia,Qa){var Ab,Ec;this.$=F;this.oAuthManager=ia;this.Xu=Qa;this.fpb=new Kc;cg.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?
this.jYc=null!==(Ec=null===(Ab=this.oAuthManager)||void 0===Ab?void 0:Ab.Twa())&&void 0!==Ec?Ec:!1:this.jYc=this.oAuthManager&&null==this.oAuthManager.Twa()?!1:this.oAuthManager.Twa()}function Kc(){this.token=null;this.timeStamp=0}function Id(F){return xk.call(this,F)||this}function Bd(F,ia){this.automateCommandManager=F;this.$=ia}function oe(F){var ia=Fj.call(this)||this;ia.$=F;ia.Tb();return ia}function Hd(F){this.Gb=null;this.$=F}function we(){return Wc.call(this)||this}function df(){return Wc.call(this)||
this}function sf(){return Wc.call(this)||this}function wf(){return Wc.call(this)||this}function $e(){return Wc.call(this)||this}function pf(){return Wc.call(this)||this}function bg(){return Wc.call(this)||this}function Zd(){return Wc.call(this)||this}function Ma(){return Wc.call(this)||this}function Hb(){return Wc.call(this)||this}function ic(){return Wc.call(this)||this}function Lc(){return Wc.call(this)||this}function td(){return Wc.call(this)||this}function pd(){return Wc.call(this)||this}function Qe(){return Wc.call(this)||
this}function ff(){return Wc.call(this)||this}function hf(){return Wc.call(this)||this}function yg(){return Wc.call(this)||this}function bf(){return Wc.call(this)||this}function Cg(){return Wc.call(this)||this}function Gg(){return Wc.call(this)||this}function xg(){return Wc.call(this)||this}function wc(){return Wc.call(this)||this}function jd(){return Wc.call(this)||this}function xd(){return Wc.call(this)||this}function me(){return Wc.call(this)||this}function Ae(){return Wc.call(this)||this}function Ze(){return Wc.call(this)||
this}function Bf(){return Wc.call(this)||this}function Qf(){return Wc.call(this)||this}function Vg(){return Wc.call(this)||this}function Rf(){return Wc.call(this)||this}function De(){return Wc.call(this)||this}function Lg(){return Wc.call(this)||this}function $d(){return Wc.call(this)||this}function le(){return Wc.call(this)||this}function lh(){return Wc.call(this)||this}function Kf(){return Wc.call(this)||this}function Ph(){return Wc.call(this)||this}function Da(){return Wc.call(this)||this}function Mb(){return Wc.call(this)||
this}function Bc(){return Wc.call(this)||this}function wd(){return Wc.call(this)||this}function Nd(){return Wc.call(this)||this}function Pe(){return Wc.call(this)||this}function He(){return Wc.call(this)||this}function ue(){return Wc.call(this)||this}function Ia(){return Wc.call(this)||this}function cb(){return Wc.call(this)||this}function Xb(){return Wc.call(this)||this}function yc(){return Wc.call(this)||this}function Xc(){return Wc.call(this)||this}function Od(){return Wc.call(this)||this}function Ud(){return Wc.call(this)||
this}function Fe(){return Wc.call(this)||this}function gf(){return Wc.call(this)||this}function uf(){return Wc.call(this)||this}function Ee(){return kg.call(this,195,16)||this}function mc(){return kg.call(this,194,8)||this}function Uc(){return Wc.call(this)||this}function Vd(){return kg.call(this,198,2)||this}function Sf(){return kg.call(this,197,1)||this}function Cd(){return kg.call(this,196,32)||this}function Uf(){return Wc.call(this)||this}function Td(){return kg.call(this,193,4)||this}function kg(F,
ia){var Qa=Wc.call(this)||this;Qa.Qfa=F;Qa.x_d=ia;return Qa}function Gf(){return Wc.call(this)||this}function Kd(){return Wc.call(this)||this}function af(){return Wc.call(this)||this}function Wg(){return Wc.call(this)||this}function Hf(){return Wc.call(this)||this}function Pg(){return Wc.call(this)||this}function be(){return oa.call(this,11,16)||this}function $g(){return oa.call(this,10,128)||this}function wg(){return Wc.call(this)||this}function We(){return Wc.call(this)||this}function eg(){return Wc.call(this)||
this}function lf(){return Wc.call(this)||this}function Je(){return Wc.call(this)||this}function Di(){return Wc.call(this)||this}function kj(){return Wc.call(this)||this}function ig(){return Wc.call(this)||this}function Zf(){return Wc.call(this)||this}function Ei(){return oa.call(this,9,2)||this}function ph(){return oa.call(this,8,1)||this}function ji(){return oa.call(this,7,8)||this}function xh(){return oa.call(this,6,32)||this}function zg(){return Wc.call(this)||this}function wi(){return Wc.call(this)||
this}function Bh(){return Wc.call(this)||this}function Jh(){return Wc.call(this)||this}function nh(){return Wc.call(this)||this}function fh(){return Wc.call(this)||this}function rj(){return Wc.call(this)||this}function Qh(){return Wc.call(this)||this}function bh(){return Wc.call(this)||this}function Xh(){return Wc.call(this)||this}function ci(){return Wc.call(this)||this}function Fg(){return Wc.call(this)||this}function ki(){return Wc.call(this)||this}function Ag(){return Wc.call(this)||this}function Ch(){return oa.call(this,
4,64)||this}function Yg(){return Wc.call(this)||this}function hh(){return Wc.call(this)||this}function Ug(){return Wc.call(this)||this}function yh(){return Wc.call(this)||this}function pi(){return Wc.call(this)||this}function pg(){return Wc.call(this)||this}function qi(){return Wc.call(this)||this}function tg(){}function Zh(){return Wc.call(this)||this}function Ga(){return oa.call(this,3,4)||this}function oa(F,ia){var Qa=Wc.call(this)||this;Qa.Qfa=F;Qa.x_d=ia;return Qa}function Bb(){return Wc.call(this)||
this}function Rd(){return Wc.call(this)||this}function je(){return Wc.call(this)||this}function yf(){return Wc.call(this)||this}function Of(){return P.call(this,185,18)||this}function Mf(){return Wc.call(this)||this}function ah(){return P.call(this,181,14)||this}function Xg(){return P.call(this,169,2)||this}function Eh(){return P.call(this,168,1)||this}function rh(){return Wc.call(this)||this}function Fh(){return P.call(this,182,15)||this}function Rh(){return Wc.call(this)||this}function se(){return Wc.call(this)||
this}function kh(){return P.call(this,180,13)||this}function jg(){return P.call(this,186,19)||this}function oh(){return P.call(this,175,8)||this}function Mi(){return P.call(this,176,9)||this}function Nh(){return P.call(this,187,20)||this}function Zg(){return P.call(this,174,7)||this}function Df(){return P.call(this,179,12)||this}function Ff(){return P.call(this,178,11)||this}function zh(){return P.call(this,177,10)||this}function og(){return Wc.call(this)||this}function vh(){return P.call(this,170,
3)||this}function ij(){return P.call(this,172,5)||this}function k(){return P.call(this,173,6)||this}function G(){return P.call(this,183,16)||this}function d(){return P.call(this,184,17)||this}function S(){return P.call(this,171,4)||this}function P(F,ia){var Qa=Wc.call(this)||this;Qa.Qfa=F;Qa.opType=ia;return Qa}function ja(){return Wc.call(this)||this}function D(){return Wc.call(this)||this}function da(){return Wc.call(this)||this}function Ha(){return Wc.call(this)||this}function jb(){return Wc.call(this)||
this}function kc(){return Wc.call(this)||this}function Jb(){return Wc.call(this)||this}function md(){return Wc.call(this)||this}function ce(){return Wc.call(this)||this}function qe(){return Wc.call(this)||this}function Ye(){return Wc.call(this)||this}function ma(){return Wc.call(this)||this}function ab(){return Wc.call(this)||this}function bc(){return Wc.call(this)||this}function Rc(){return Wc.call(this)||this}function Nc(){return Wc.call(this)||this}function id(){return Wc.call(this)||this}function xe(){return Wc.call(this)||
this}function cf(){return Wc.call(this)||this}function ag(){return Wc.call(this)||this}function tf(){return Wc.call(this)||this}function rg(){return yi.call(this)||this}function ch(){return Wc.call(this)||this}function Hg(){return Wc.call(this)||this}function ri(){return Wc.call(this)||this}function wh(){return Wc.call(this)||this}function th(){return Wc.call(this)||this}function hg(){return Wc.call(this)||this}function li(){return Wc.call(this)||this}function Ni(){return Wc.call(this)||this}function Si(){return Wc.call(this)||
this}function sj(){return Yc.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Bj(){return Yc.call(this,79,[0,1,2,-102])||this}function ih(){return Yc.call(this,75,[-101])||this}function xi(){return Yc.call(this,81,[100,101,102,103,104,105,106])||this}function uj(){return Wc.call(this)||this}function Cj(){return Yc.call(this,85,[328,329,330,331,332,333,334,335])||
this}function Vh(){return yi.call(this)||this}function yj(F,ia,Qa){this.response=this.request=this.eventId=this.source=null;F&&(this.source=F.source,this.eventId=F.eventId,this.request=ia,this.response=Qa)}function yi(){return Wc.call(this)||this}function Aj(){return Yc.call(this,83,[500,501,502])||this}function W(){return Yc.call(this,76,[-100])||this}function Ja(){return Yc.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Eb(){return Yc.call(this,80,[-104,-103,300,301,
302,303,304,305,306,307,308,309,310,311])||this}function gc(){return Yc.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Yc(F,ia){var Qa=Wc.call(this)||this;Qa.Qfa=F;Qa.NVj=ia;return Qa}function vd(){return Wc.call(this)||this}function fe(){return Wc.call(this)||this}function re(){return Wc.call(this)||this}function Oe(){return Wc.call(this)||this}function Wc(){this.XIc=this.YIc=this.XOc=this.wTc=null}function Pf(F,ia,Qa){var Ab=this;this.t$b=null;this.Cyi=function(Ec,
Mc){Ab.Z2f()&&Ab.Bbd(Mc)};this.Lpf=ia;this.Kpf=Qa;this.$=F;this.$.Yba&&this.$.KGg(this.Cyi);F.da.Ga(297,this)}function nf(){}function Qg(){}function Ng(){this.phb=null}function ti(){this.tb=null}function qh(F){this._initialized=!1;this.U$a={};this.xzc={};this.YO=ke.AFrameworkApplication.sa.MD;this.nld=F}function fi(F,ia,Qa){this.expiration=this.authority=this.accessToken=null;this.accessToken=F;this.authority=ia;this.expiration=Qa}function $h(){this.authority=this.email=this.displayName=null;this.authority=
this.email=this.displayName=""}function Fi(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function di(){}function V(F,ia){this.requestCallback=this.requestParameters=null;this.requestParameters=F;this.requestCallback=ia}function ya(){}b.r(E);var lb=b(556),Kb=b(1159),Lb=b(0),Xa=b(14),od=b(82),Yd;(function(F){F[F.generalException=
0]="generalException";F[F.invalidArgument=1]="invalidArgument";F[F.notAllowed=2]="notAllowed";F[F.apiNotAvailable=3]="apiNotAvailable";F[F.unresolvedPendingRequest=4]="unresolvedPendingRequest";F[F.timeout=5]="timeout";F[F.adalTimeout=6]="adalTimeout";F[F.userNotSignedIn=7]="userNotSignedIn";F[F.userAborted=8]="userAborted";F[F.silentSignInFailed=9]="silentSignInFailed";F[F.invalidResourceUrl=10]="invalidResourceUrl";F[F.invalidGrant=11]="invalidGrant";F[F.connectionLost=12]="connectionLost";F[F.clientError=
13]="clientError";F[F.serverError=14]="serverError"})(Yd||(Yd={}));Object(Lb.b)("ErrorCodes",Yd);ya.yFf="OneDriveWOPI";Object(Lb.a)(ya,"HostApplicationType",null,[]);Object(Lb.a)(V,"OutstandingRequest",null,[]);di.rEi="AADSTS50058";di.invalidResourceUrl="AADSTS50001";di.mEi="AADSTS65001";di.CEi="AADSTS70011";di.userAborted="13002";di.G_i="Popup Window is null";di.F_i="Popup Window closed";di.adalTimeout="Token renewal operation failed due to timeout";di.zLj="tokenRevoked";Object(Lb.a)(di,"WopiHostErrorType",
null,[]);var ke=b(4),Yf=b(941),Tf=b(634),Kg=b(41);Fi.oKh=function(F){switch(F){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(Lb.a)(Fi,"WopiAuthContext",null,[306]);Object(Lb.a)($h,"WopiIdentityInfo",null,[305]);Object(Lb.a)(fi,"WopiIdentityToken",null,[304]);var Og=b(24),Hh=b(152),si=b(390),Vj=b(167),mg=b(77),Ti=b(355);qh.prototype.B2a=function(F){this._initialized||(F.mo(Vj.a.qIf),F.Tl(Vj.a.qIf,Object(od.a)(this,this.jRi,"onReceivedAccessToken")),
this._initialized=!0)};qh.prototype.getAccessToken=function(F,ia,Qa){var Ab=this;Qa=void 0===Qa?null:Qa;this.jOa(F,ia);return new Promise(function(Ec,Mc){if(Ab.Tnd(ia))if(ia in Ab.U$a)Mc("unresolvedPendingRequest");else{var zd=window.setTimeout(function(){var ye={};Xa.ULS.sendTraceTag(37856032,344,10,Kg.c((ye.error="Request timeout.",ye.callerId=ia,ye)));Mc("timeout")},12E4);Ab.Add(F,ia,Qa,function(ye,Te){window.clearTimeout(zd);ye?Ec(ye):(ye={},Xa.ULS.sendTraceTag(37856033,369,15,Kg.c((ye.error=
Yd[Te],ye))),Mc(Te))})}else{var Ld={};Xa.ULS.sendTraceTag(37856034,344,10,Kg.c((Ld.error="Caller is not allowed.",Ld)));Mc("notAllowed")}})};qh.prototype.getPrimaryIdentityInfo=function(F){var ia=this;return new Promise(function(Qa,Ab){if(ia.Tnd(F))ia.lWh(function(Mc,zd){Mc?Qa(Mc):(Mc={},Xa.ULS.sendTraceTag(37856064,369,10,Kg.c((Mc.error=zd.toString(),Mc))),Ab(zd))});else{var Ec={};Xa.ULS.sendTraceTag(37856065,344,10,Kg.c((Ec.error="Caller is not allowed.",Ec)));Ab("notAllowed")}})};qh.prototype.getAuthContext=
function(F){var ia=this;return new Promise(function(Qa,Ab){var Ec=ia.getAuthContextSync(F);Ec?Qa(Ec):Ab("notAllowed")})};qh.prototype.getAuthContextSync=function(F){if(this.Tnd(F)){var ia=new Fi;ia.upn=ke.AFrameworkApplication.ga.Va("UserPrincipalName");ia.userId=ke.AFrameworkApplication.ga.Va("LoggableUserId");ia.authority=ke.AFrameworkApplication.ga.Va("HostAuthAuthority");ia.tenantId=ke.AFrameworkApplication.ga.Va("TenantId");ia.isAnonymous=ke.AFrameworkApplication.ga.ra("IsAnonymousUser");ia.supportsAuthToken=
this.B8h(F);F=ke.AFrameworkApplication.ga.Va("HostAuthType");ia.authorityType="aad"===F.toLowerCase()?2:"msa"===F.toLowerCase()?1:0;return ia}ia={};Xa.ULS.sendTraceTag(40751647,344,10,Kg.c((ia.error="Caller is not allowed.",ia)));return null};qh.prototype.B8h=function(F){var ia=Yf.a.Wxb;return Og.a.nla?ia&&Yf.a.u9f?Array.contains(Yf.a.u9f,F.toLowerCase()):!1:ia};qh.prototype.Add=function(F,ia,Qa,Ab){var Ec=this,Mc=[];Array.add(Mc,Object.assign(new mg.a,{name:"CallerId",string:ia}));Array.add(Mc,Object.assign(new mg.a,
{name:si.a.pUd,string:F.correlationId}));Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Mc}));Mc=Tf.a.create().toString();var zd="getAccessToken_"+Mc,Ld=this.YO.Hc("ComponentAttach",zd);this.xzc[zd]=Ld;var ye={};ye[si.a.qUd]=Mc;ye[si.a.UEj]=F.resource;ye[si.a.VEj]=F.scope;ye[si.a.w6f]=ke.AFrameworkApplication.ga.Va("HostAuthType");ye[si.a.YEj]=ke.AFrameworkApplication.ga.Va("UserPrincipalName");ye[si.a.WEj]=F.silentLogin;
ye[si.a.REj]=F.options;ye[si.a.pUd]=F.correlationId;ye[si.a.SEj]=ia;Qa&&(ye[si.a.addinName]=Qa.AddinName,ye[si.a.QEj]=Qa.AddinTrustId);this.nld.execute(function(Te){Ec.B2a(Te);Te.Jj(Vj.a.getAuthToken,ye)});this.U$a[Mc]=new V(F,Ab)};qh.prototype.lWh=function(F){var ia=ke.AFrameworkApplication.ga.Va("UserName"),Qa=ke.AFrameworkApplication.ga.Va("UserPrincipalName"),Ab=ke.AFrameworkApplication.ga.Va("LoggableUserIdSpace"),Ec=new $h;Ec.email=Qa;Ec.displayName=ia;switch(Ab){case "OrgIdPuid":Ec.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Ec.authority="MicrosoftAccount";break;default:Ec.authority=Ab}F(Ec,null)};qh.prototype.jRi=function(F){var ia=null;try{var Qa=F.Values[si.a.qUd],Ab=F.Values[si.a.PEj],Ec=F.Values[si.a.w6f],Mc=F.Values[si.a.XEj],zd=null,Ld=null,ye=this.U$a[Qa];if("undefined"!==typeof ye&&ye){var Te=[];Array.add(Te,Object.assign(new mg.a,{name:si.a.pUd,string:ye.requestParameters.correlationId}));Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:Te}));ia=ye.requestCallback;delete this.U$a[Qa];"undefined"!==typeof Ab&&Ab&&Ab.length?Ld=new fi(Ab,Ec,Mc):zd=Yd[this.szi(F)];Qa="getAccessToken_"+Qa;Qa in this.xzc&&(this.xzc[Qa].stop(),delete this.xzc[Qa]);ia(Ld,zd)}else zd={},Xa.ULS.sendTraceTag(37856066,344,10,Kg.c((zd.error="No matching outstanding request for request ID.",zd.requestId=Qa,zd)))}catch(rf){F=F.Values[si.a.qUd],F in this.U$a&&delete this.U$a[F],this.zkc(),F={},Xa.ULS.sendTraceTag(37856067,344,10,Kg.c((F.error=rf.message,
F.stack=rf.stack,F))),ia&&ia(null,"generalException")}};qh.prototype.Tnd=function(F){var ia=ke.AFrameworkApplication.b2h();F=F.toLowerCase();ia=Cl(ia);for(var Qa=ia.next();!Qa.done;Qa=ia.next())if(F===Qa.value.toLowerCase())return!0;ia=Yf.a.cXc;for(var Ab in ia)if(F===ia[Ab].toLowerCase())return!0;return!1};qh.prototype.szi=function(F){F=F.Values[si.a.TEj];this.zkc();var ia={};Xa.ULS.sendTraceTag(39068821,344,15,Kg.c((ia.error=F,ia)));return F?-1<F.indexOf(di.rEi)?9:-1<F.indexOf(di.G_i)||-1<F.indexOf(di.F_i)?
12:-1<F.indexOf(di.invalidResourceUrl)?10:-1<F.indexOf(di.userAborted)?8:-1<F.indexOf(di.CEi)||-1<F.indexOf(di.mEi)||F===di.zLj?11:-1<F.indexOf(di.adalTimeout)?6:0:13};qh.prototype.jOa=function(F,ia){F=this.W7i(F.resource);var Qa={};Xa.ULS.sendTraceTag(39921882,344,50,Kg.c((Qa.callerId=ia,Qa.resource=F,Qa)))};qh.prototype.zkc=function(){var F={};Xa.ULS.sendTraceTag(39068822,344,50,Kg.c((F.userAgent=window.navigator.userAgent,F)))};qh.prototype.W7i=function(F){return(F?F:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")};Object(Lb.a)(qh,"WopiIdentityManager",null,[289]);var Bg=b(255);ti.prototype.fi=function(F){this.tb=F;F.register(qh,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Ic().Oc(function(){return new qh(F.lc("Postmessage.IHostPostmessenger"))})};ti.prototype.init=function(){ke.AFrameworkApplication.ga&&ke.AFrameworkApplication.ga.tv(Object(od.a)(this,this.FB,"onFullAppSettingsReady"))};ti.prototype.FB=function(){try{this.tb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(F){Xa.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+F)}};ti.prototype.dispose=function(){};ti.main=function(){Bg.a.instance.hj(new ti)};Ck.Object.defineProperties(ti.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object(Lb.a)(ti,"WopiIdentityPackage",null,[4,5]);var Zj=b(11),zi=b(226),sg=b(201),bk=b(647);Ng.prototype.Yfi=function(F){return this.pOg.contains(F.operation)};Ng.prototype.iPj=function(F){for(var ia=[],Qa=Cl(F.payload.batchedOperations),
Ab=Qa.next();!Ab.done;Ab=Qa.next())ia.push(new bk.a(F.operation,Ab.value));return ia};Ck.Object.defineProperties(Ng.prototype,{pOg:{configurable:!0,enumerable:!0,get:function(){this.phb||(this.phb=new sg.a,this.phb.add(12),this.phb.add(11));return this.phb}}});Object(Lb.a)(Ng,"MacroRecorderBatchedEventList",null,[]);var lj=b(56),pk=b(125),wk=b(736);Qg.prototype.equals=function(F,ia){return F===ia};Qg.prototype.getHashCode=function(F){return F};Qg.prototype.Rja=function(F){return F};Object(Lb.a)(Qg,
"UserOperationNameComparer",null,[22,23]);nf.$1h=function(){nf.Tc||(nf.Tc=new wk.a(new Qg),nf.Tc.add(507),nf.Tc.add(10),nf.Tc.add(576),nf.Tc.add(563),nf.Tc.add(564),nf.Tc.add(565),nf.Tc.add(566),nf.Tc.add(567),nf.Tc.add(568),nf.Tc.add(569),nf.Tc.add(570),nf.Tc.add(571),nf.Tc.add(572),nf.Tc.add(573),nf.Tc.add(574),nf.Tc.add(575),nf.Tc.add(501),nf.Tc.add(520),nf.Tc.add(1),nf.Tc.add(1002),nf.Tc.add(129),nf.Tc.add(198),nf.Tc.add(500),nf.Tc.add(519),nf.Tc.add(538),nf.Tc.add(1E3),nf.Tc.add(1003),nf.Tc.add(144),
nf.Tc.add(502),nf.Tc.add(505),nf.Tc.add(179),nf.Tc.add(205),nf.Tc.add(134),nf.Tc.add(230),nf.Tc.add(103),nf.Tc.add(110),nf.Tc.add(112),nf.Tc.add(113),nf.Tc.add(124),nf.Tc.add(133),nf.Tc.add(154),nf.Tc.add(162),nf.Tc.add(168),nf.Tc.add(172),nf.Tc.add(201),nf.Tc.add(222),nf.Tc.add(227),nf.Tc.add(513),nf.Tc.add(534),nf.Tc.add(539),nf.Tc.add(545),nf.Tc.add(600),nf.Tc.add(547),nf.Tc.add(555),nf.Tc.add(558),nf.Tc.add(562),nf.Tc.add(585),nf.Tc.add(1001),nf.Tc.add(1005),nf.Tc.add(1008),nf.Tc.add(1010),nf.Tc.add(1011),
nf.Tc.add(1012),nf.Tc.add(1018),nf.Tc.add(252),nf.Tc.add(253),nf.Tc.add(258),nf.Tc.add(101),nf.Tc.add(102),nf.Tc.add(108),nf.Tc.add(118),nf.Tc.add(257),nf.Tc.add(119),nf.Tc.add(120),nf.Tc.add(123),nf.Tc.add(126),nf.Tc.add(127),nf.Tc.add(130),nf.Tc.add(140),nf.Tc.add(159),nf.Tc.add(160),nf.Tc.add(165),nf.Tc.add(166),nf.Tc.add(167),nf.Tc.add(169),nf.Tc.add(189),nf.Tc.add(223),nf.Tc.add(214),nf.Tc.add(228),nf.Tc.add(233),nf.Tc.add(247),nf.Tc.add(504),nf.Tc.add(511),nf.Tc.add(512),nf.Tc.add(525),nf.Tc.add(533),
nf.Tc.add(537),nf.Tc.add(542),nf.Tc.add(544),nf.Tc.add(548),nf.Tc.add(550),nf.Tc.add(551),nf.Tc.add(552),nf.Tc.add(554),nf.Tc.add(577),nf.Tc.add(584),nf.Tc.add(586),nf.Tc.add(587),nf.Tc.add(588),nf.Tc.add(592),nf.Tc.add(1009),nf.Tc.add(1016),nf.Tc.add(1017));return nf.Tc};nf.Tc=null;Object(Lb.a)(nf,"MacroRecorderUnrecognizedEventList",null,[]);Pf.prototype.init=function(F){this.$.Yba&&(F?this.t$b=F:Xa.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};
Pf.prototype.Bbd=function(F){if(this.Z2f())try{if(this.Kpf.Yfi(F))for(var ia=this.Kpf.iPj(F),Qa=Cl(ia),Ab=Qa.next();!Ab.done;Ab=Qa.next())this.SUe(Ab.value);else this.SUe(F)}catch(Ec){F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",pk.a(F.operation),Ec.stack),Xa.ULS.sendTraceTag(537155423,0,10,F)}};Pf.prototype.SUe=function(F){var ia=this.Lpf.S0e(F,!0);ia?(this.t$b(ia.eventId,lj.a.Lc(F.payload)),F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",
ia.eventId),Xa.ULS.sendTraceTag(537155422,0,50,F)):(ia=this.Lpf.S0e(F,!1))?(F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",ia.eventId),Xa.ULS.sendTraceTag(537155421,0,50,F)):nf.$1h().contains(F.operation)||(this.t$b(0,lj.a.Lc(F.operation)),F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",pk.a(F.operation)),Xa.ULS.sendTraceTag(537155420,0,50,F))};Pf.prototype.Z2f=function(){return this.$.dla&&this.t$b&&
this.$.Uba?!0:!1};Object(Lb.a)(Pf,"MacroRecorderEventHandler",null,[878]);var cg=b(1);Wc.prototype.sg=function(){};Wc.prototype.Gwa=function(){};Wc.prototype.Bd=function(F){this.jDc.add(F)};Wc.prototype.Ub=function(F){this.operations.contains(F)||this.operations.add(F)};Wc.prototype.Fnb=function(){this.featureGates.add(683)};Wc.prototype.Cme=function(F){this.nTe.add(F)};Ck.Object.defineProperties(Wc.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.XOc||(this.XOc=new sg.a,this.kc());
return this.XOc}},jDc:{configurable:!0,enumerable:!0,get:function(){this.wTc||(this.wTc=new sg.a,this.sg());return this.wTc}},nTe:{configurable:!0,enumerable:!0,get:function(){this.XIc||(this.XIc=new sg.a);return this.XIc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.YIc||(this.YIc=new sg.a,this.Gwa());return this.YIc}}});Object(Lb.a)(Wc,"MacroRecorderEventBase",null,[]);Am(Oe,Wc);Oe.prototype.kc=function(){this.Ub(100)};Ck.Object.defineProperties(Oe.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 130}}});Object(Lb.a)(Oe,"AccessibilityCheckRunEvent",Wc,[]);Am(re,Wc);re.prototype.kc=function(){this.Ub(241)};re.prototype.sg=function(){this.Bd(function(F){return F.addToPrintArea})};Ck.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(Lb.a)(re,"AddedToPrintAreaEvent",Wc,[]);Am(fe,Wc);fe.prototype.kc=function(){this.Ub(516)};Ck.Object.defineProperties(fe.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 65}}});Object(Lb.a)(fe,"AutoFilterToggledEvent",Wc,[]);Am(vd,Wc);vd.prototype.kc=function(){this.Ub(502)};vd.prototype.sg=function(){this.Bd(function(F){return!(F.Q4a().FirstColumn===F.Q4a().LastColumn&&F.Q4a().FirstRow===F.Q4a().LastRow)})};Ck.Object.defineProperties(vd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(Lb.a)(vd,"AutoSumEvent",Wc,[]);Am(Yc,Wc);Yc.prototype.kc=function(){this.Ub(529);this.Ub(594)};Yc.prototype.sg=function(){var F=
this;this.Bd(function(ia){return Array.contains(F.NVj,ia.zgd())})};Ck.Object.defineProperties(Yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Qfa}}});Object(Lb.a)(Yc,"ChartPropertyAppliedEventBase",Wc,[]);Am(gc,Yc);Object(Lb.a)(gc,"ChartAxisChangedEvent",Yc,[]);Am(Eb,Yc);Object(Lb.a)(Eb,"ChartAxisTitleChangedEvent",Yc,[]);Am(Ja,Yc);Object(Lb.a)(Ja,"ChartDataLabelsChangedEvent",Yc,[]);Am(W,Yc);Object(Lb.a)(W,"ChartDataSelectedEvent",Yc,[]);Am(Aj,Yc);Object(Lb.a)(Aj,
"ChartDataTableChangedEvent",Yc,[]);var Wj=b(615),dj=b(438),Oh=b(83);Am(yi,Wc);Object(Lb.a)(yi,"RichApiRequestExecutedEventBase",Wc,[]);Ck.Object.defineProperties(yj.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(Lb.a)(yj,"MacroRecorderRichApiRequestExecutedPayload",null,[447]);Am(Vh,yi);Vh.prototype.xF=function(F){Vh.y7||(Vh.y7=new wk.a(Wj.a.Pk()),Vh.y7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Vh.y7.add("fa000000014"));return!!F&&Vh.y7.contains(F.toLowerCase())};Vh.prototype.kc=function(){this.Ub(507);this.Ub(10);this.Ub(576)};Vh.prototype.sg=function(){var F=this;this.Bd(function(ia){return Object(dj.a)(yj,ia)&&(ia=Object(Oh.a)(yj,ia),ia.isValid&&F.xF(ia.source))?(Xa.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",ia.eventId),!0):!1})};Ck.Object.defineProperties(Vh.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 117}}});Vh.y7=null;Object(Lb.a)(Vh,"ChartFormatRichApiRequestExecutedEvent",yi,[]);Am(Cj,Yc);Object(Lb.a)(Cj,"ChartGridlinesChangedEvent",Yc,[]);Am(uj,Wc);uj.prototype.kc=function(){this.Ub(528)};Ck.Object.defineProperties(uj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(Lb.a)(uj,"ChartInsertedEvent",Wc,[]);Am(xi,Yc);Object(Lb.a)(xi,"ChartLegendChangedEvent",Yc,[]);Am(ih,Yc);Object(Lb.a)(ih,"ChartRowColumnSwitchedEvent",Yc,[]);Am(Bj,Yc);
Object(Lb.a)(Bj,"ChartTitleChangedEvent",Yc,[]);Am(sj,Yc);Object(Lb.a)(sj,"ChartTypeChangedEvent",Yc,[]);Am(Si,Wc);Si.prototype.kc=function(){this.Ub(521)};Ck.Object.defineProperties(Si.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(Lb.a)(Si,"ConnectorFloatingObjectResizedEvent",Wc,[]);Am(Ni,Wc);Ni.prototype.kc=function(){this.Ub(109)};Ck.Object.defineProperties(Ni.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(Lb.a)(Ni,
"EntitySelectedEvent",Wc,[]);Am(li,Wc);li.prototype.kc=function(){this.Ub(149);this.Ub(147)};Ck.Object.defineProperties(li.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(Lb.a)(li,"FindCellEvent",Wc,[]);Am(hg,Wc);hg.prototype.kc=function(){this.Ub(122)};Ck.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(Lb.a)(hg,"FloatingObjectAltTextAppliedEvent",Wc,[]);Am(th,Wc);th.prototype.kc=function(){this.Ub(522)};
Ck.Object.defineProperties(th.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(Lb.a)(th,"FloatingObjectDeletedEvent",Wc,[]);Am(wh,Wc);wh.prototype.kc=function(){this.Ub(524)};Ck.Object.defineProperties(wh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(Lb.a)(wh,"FloatingObjectMovedAndResizedEvent",Wc,[]);Am(ri,Wc);ri.prototype.kc=function(){this.Ub(523)};Ck.Object.defineProperties(ri.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 95}}});Object(Lb.a)(ri,"FloatingObjectRotatedEvent",Wc,[]);Am(Hg,Wc);Hg.prototype.kc=function(){this.Ub(543)};Ck.Object.defineProperties(Hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(Lb.a)(Hg,"GroupDetailsShownOrHiddenEvent",Wc,[]);Am(ch,Wc);ch.prototype.kc=function(){this.Ub(125)};Ck.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(Lb.a)(ch,"HyperlinksRemovedFromRangeEvent",
Wc,[]);Am(rg,yi);rg.prototype.xF=function(F){rg.y7||(rg.y7=new wk.a(Wj.a.Pk()),rg.y7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),rg.y7.add("fa000000005"));return!!F&&rg.y7.contains(F.toLowerCase())};rg.prototype.kc=function(){this.Ub(507);this.Ub(10);this.Ub(576)};rg.prototype.sg=function(){var F=this;this.Bd(function(ia){return Object(dj.a)(yj,ia)?(ia=Object(Oh.a)(yj,ia),ia.isValid&&F.xF(ia.source)):!1})};Ck.Object.defineProperties(rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});
rg.y7=null;Object(Lb.a)(rg,"IdeasRichApiRequestExecutedEvent",yi,[]);Am(tf,Wc);tf.prototype.kc=function(){this.Ub(115)};Ck.Object.defineProperties(tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(Lb.a)(tf,"LinkedEntityConvertedEvent",Wc,[]);Am(ag,Wc);ag.prototype.kc=function(){this.Ub(114)};Ck.Object.defineProperties(ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(Lb.a)(ag,"LinkedEntityDisambiguationPaneToggledEvent",
Wc,[]);Am(cf,Wc);cf.prototype.kc=function(){this.Ub(119)};Ck.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(Lb.a)(cf,"MovedToEdgeEvent",Wc,[]);Am(xe,Wc);xe.prototype.kc=function(){this.Ub(191)};xe.prototype.Gwa=function(){this.Fnb()};Ck.Object.defineProperties(xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(Lb.a)(xe,"NamedSheetViewCreatedEvent",Wc,[]);Am(id,Wc);id.prototype.kc=function(){this.Ub(200)};
id.prototype.Gwa=function(){this.Fnb()};Ck.Object.defineProperties(id.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(Lb.a)(id,"NamedSheetViewDeletedEvent",Wc,[]);Am(Nc,Wc);Nc.prototype.kc=function(){this.Ub(192)};Nc.prototype.Gwa=function(){this.Fnb()};Ck.Object.defineProperties(Nc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(Lb.a)(Nc,"NamedSheetViewExitedEvent",Wc,[]);Am(Rc,Wc);Rc.prototype.kc=function(){this.Ub(199)};
Rc.prototype.Gwa=function(){this.Fnb()};Ck.Object.defineProperties(Rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(Lb.a)(Rc,"NamedSheetViewRenamedEvent",Wc,[]);Am(bc,Wc);bc.prototype.kc=function(){this.Ub(195)};bc.prototype.Gwa=function(){this.Fnb()};Ck.Object.defineProperties(bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(Lb.a)(bc,"NamedSheetViewSwitchedEvent",Wc,[]);Am(ab,Wc);ab.prototype.kc=function(){this.Ub(174)};
Ck.Object.defineProperties(ab.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(Lb.a)(ab,"OutlineLevelSetEvent",Wc,[]);Am(ma,Wc);ma.prototype.kc=function(){this.Ub(244)};Ck.Object.defineProperties(ma.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(Lb.a)(ma,"PageBreakInsertedEvent",Wc,[]);Am(Ye,Wc);Ye.prototype.kc=function(){this.Ub(245)};Ck.Object.defineProperties(Ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});
Object(Lb.a)(Ye,"PageBreakRemovedEvent",Wc,[]);Am(qe,Wc);qe.prototype.kc=function(){this.Ub(246)};Ck.Object.defineProperties(qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(Lb.a)(qe,"PageBreaksAllResetEvent",Wc,[]);Am(ce,Wc);ce.prototype.kc=function(){this.Ub(503)};ce.prototype.sg=function(){this.Bd(function(F){return!!F.pasteParameters.ClientEstimationFloatingObjectId&&2===F.pasteParameters.CopyPasteTargetType&&!F.isFromCurrentSession})};Ck.Object.defineProperties(ce.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(Lb.a)(ce,"PasteArtOtherWorkbookEvent",Wc,[]);Am(md,Wc);md.prototype.kc=function(){this.Ub(503)};md.prototype.sg=function(){this.Bd(function(F){return!!F.pasteParameters.ClientEstimationFloatingObjectId&&2===F.pasteParameters.CopyPasteTargetType&&F.isFromCurrentSession})};Ck.Object.defineProperties(md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(Lb.a)(md,"PasteArtSameWorkbookEvent",
Wc,[]);Am(Jb,Wc);Jb.prototype.kc=function(){this.Ub(204)};Ck.Object.defineProperties(Jb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(Lb.a)(Jb,"PasteHtmlEvent",Wc,[]);Am(kc,Wc);kc.prototype.kc=function(){this.Ub(506)};Ck.Object.defineProperties(kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(Lb.a)(kc,"PasteRangeEvent",Wc,[]);Am(jb,Wc);jb.prototype.kc=function(){this.Ub(503)};jb.prototype.sg=function(){this.Bd(function(F){return 1===
F.pasteParameters.CopyPasteTargetType})};Ck.Object.defineProperties(jb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(Lb.a)(jb,"PasteShadowWorkbookRangeEvent",Wc,[]);Am(Ha,Wc);Ha.prototype.kc=function(){this.Ub(180)};Ck.Object.defineProperties(Ha.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(Lb.a)(Ha,"PasteStringEvent",Wc,[]);Am(da,Wc);da.prototype.kc=function(){this.Ub(220)};Ck.Object.defineProperties(da.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 134}}});Object(Lb.a)(da,"PendingMergeEvent",Wc,[]);Am(D,Wc);D.prototype.kc=function(){this.Ub(510)};Ck.Object.defineProperties(D.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(Lb.a)(D,"PictureInsertedEvent",Wc,[]);Am(ja,Wc);ja.prototype.kc=function(){this.Ub(161)};Ck.Object.defineProperties(ja.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(Lb.a)(ja,"PivotDrillToggledEvent",Wc,[]);Am(P,
Wc);P.prototype.kc=function(){this.Ub(225)};P.prototype.sg=function(){var F=this;this.Bd(function(ia){return ia.opType===F.opType})};Ck.Object.defineProperties(P.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Qfa}}});Object(Lb.a)(P,"PivotTableSettingsChangedEventBase",Wc,[]);Am(S,P);Object(Lb.a)(S,"PivotTableAllItemLabelsRepeatedEvent",P,[]);Am(d,P);Object(Lb.a)(d,"PivotTableAltTextDescriptionChangedEvent",P,[]);Am(G,P);Object(Lb.a)(G,"PivotTableAltTextTitleChangedEvent",
P,[]);Am(k,P);Object(Lb.a)(k,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",P,[]);Am(ij,P);Object(Lb.a)(ij,"PivotTableBlankLineAfterEachItemToggledEvent",P,[]);Am(vh,P);Object(Lb.a)(vh,"PivotTableColumnGrandTotalShownEvent",P,[]);Am(og,Wc);og.prototype.kc=function(){this.Ub(132)};Ck.Object.defineProperties(og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(Lb.a)(og,"PivotTableCreatedEvent",Wc,[]);Am(zh,P);Object(Lb.a)(zh,"PivotTableDisplayErrorStringToggledEvent",
P,[]);Am(Ff,P);Object(Lb.a)(Ff,"PivotTableDisplayNullStringToggledEvent",P,[]);Am(Df,P);Object(Lb.a)(Df,"PivotTableErrorStringChangedEvent",P,[]);Am(Zg,P);Object(Lb.a)(Zg,"PivotTableExpandCollapseButtonsShownEvent",P,[]);Am(Nh,P);Object(Lb.a)(Nh,"PivotTableIndentChangedEvent",P,[]);Am(Mi,P);Object(Lb.a)(Mi,"PivotTableItemsWithNoDataOnColumnsShownEvent",P,[]);Am(oh,P);Object(Lb.a)(oh,"PivotTableItemsWithNoDataOnRowsShownEvent",P,[]);Am(jg,P);Object(Lb.a)(jg,"PivotTableLayoutTypeSetEvent",P,[]);Am(kh,
P);Object(Lb.a)(kh,"PivotTableNullStringChangedEvent",P,[]);Am(se,Wc);se.prototype.kc=function(){this.Ub(219)};Ck.Object.defineProperties(se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(Lb.a)(se,"PivotTablePivotLocationChangedEvent",Wc,[]);Am(Rh,Wc);Rh.prototype.kc=function(){this.Ub(145)};Ck.Object.defineProperties(Rh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(Lb.a)(Rh,"PivotTablePivotedEvent",Wc,[]);Am(Fh,P);Object(Lb.a)(Fh,
"PivotTableRefreshDataOnLoadToggledEvent",P,[]);Am(rh,Wc);rh.prototype.kc=function(){this.Ub(50)};rh.prototype.sg=function(){this.Bd(function(F){return!!F.pivotTableId&&!!F.pivotTableName})};Ck.Object.defineProperties(rh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(Lb.a)(rh,"PivotTableRefreshedEvent",Wc,[]);Am(Eh,P);Object(Lb.a)(Eh,"PivotTableRenamedEvent",P,[]);Am(Xg,P);Object(Lb.a)(Xg,"PivotTableRowGrandTotalShownEvent",P,[]);Am(ah,P);Object(Lb.a)(ah,"PivotTableSaveSourceDataWithFileToggledEvent",
P,[]);var Mg=b(702);Am(Mf,Wc);Mf.prototype.kc=function(){this.Ub(131)};Mf.prototype.sg=function(){this.Bd(function(F){F=Object(Oh.a)(Mg.a,F);return!!F&&!!F.DKa()&&!!F.hierarchyName})};Ck.Object.defineProperties(Mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(Lb.a)(Mf,"PivotTableSortedEvent",Wc,[]);Am(Of,P);Object(Lb.a)(Of,"PivotTableSubTotalsVisibilitySettingSetEvent",P,[]);Am(yf,Wc);yf.prototype.kc=function(){this.Ub(560)};Ck.Object.defineProperties(yf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(Lb.a)(yf,"PivotValueFieldSettingAppliedEvent",Wc,[]);Am(je,Wc);je.prototype.kc=function(){this.Ub(243)};Ck.Object.defineProperties(je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(Lb.a)(je,"PrintAreaClearedEvent",Wc,[]);Am(Rd,Wc);Rd.prototype.kc=function(){this.Ub(241)};Rd.prototype.sg=function(){this.Bd(function(F){return!F.addToPrintArea})};Ck.Object.defineProperties(Rd.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(Lb.a)(Rd,"PrintAreaSetEvent",Wc,[]);Am(Bb,Wc);Bb.prototype.kc=function(){this.Ub(517)};Ck.Object.defineProperties(Bb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(Lb.a)(Bb,"RangeAutoFilterClearedEvent",Wc,[]);Am(oa,Wc);oa.prototype.kc=function(){this.Ub(11)};oa.prototype.sg=function(){var F=this;this.Bd(function(ia){return 16===ia.e_().ValidMembers});this.Bd(function(ia){return ia.e_().Font.ValidMembers===
F.x_d})};Ck.Object.defineProperties(oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Qfa}}});Object(Lb.a)(oa,"RangeFontFormattedEventBase",Wc,[]);Am(Ga,oa);Object(Lb.a)(Ga,"RangeBoldedEvent",oa,[]);Am(Zh,Wc);Zh.prototype.kc=function(){this.Ub(11)};Zh.prototype.sg=function(){this.Bd(function(F){return 128===F.e_().ValidMembers})};Ck.Object.defineProperties(Zh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(Lb.a)(Zh,"RangeBorderedEvent",
Wc,[]);tg.P$a="Table";tg.spc="Sheet";Object(Lb.a)(tg,"MacroRecorderEventConstants",null,[]);Am(qi,Wc);qi.prototype.kc=function(){this.Ub(208)};qi.prototype.sg=function(){this.Bd(function(F){return F.getParameters().FilterType===tg.spc})};Ck.Object.defineProperties(qi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(Lb.a)(qi,"RangeCheckedItemsFilteredEvent",Wc,[]);Am(pg,Wc);pg.prototype.kc=function(){this.Ub(106);this.Ub(105)};Ck.Object.defineProperties(pg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(Lb.a)(pg,"RangeConditionalFormattingChangedEvent",Wc,[]);Am(pi,Wc);pi.prototype.kc=function(){this.Ub(221)};Ck.Object.defineProperties(pi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(Lb.a)(pi,"RangeConditionalFormattingRuleDeletedEvent",Wc,[]);Am(yh,Wc);yh.prototype.kc=function(){this.Ub(508)};yh.prototype.sg=function(){this.Bd(function(F){return 3===F.du()||1===F.du()||4===F.du()})};
Ck.Object.defineProperties(yh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(Lb.a)(yh,"RangeContentClearedEvent",Wc,[]);Am(Ug,Wc);Ug.prototype.kc=function(){this.Ub(104)};Ck.Object.defineProperties(Ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(Lb.a)(Ug,"RangeCopiedCutCellsInsertedEvent",Wc,[]);Am(hh,Wc);hh.prototype.kc=function(){this.Ub(209)};hh.prototype.sg=function(){this.Bd(function(F){return F.getParameters().FilterType===
tg.spc})};Ck.Object.defineProperties(hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(Lb.a)(hh,"RangeCustomFilteredEvent",Wc,[]);Am(Yg,Wc);Yg.prototype.kc=function(){this.Ub(121)};Ck.Object.defineProperties(Yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(Lb.a)(Yg,"RangeDataValidationChangedEvent",Wc,[]);Am(Ch,oa);Object(Lb.a)(Ch,"RangeDoubleUnderlinedEvent",oa,[]);Am(Ag,Wc);Ag.prototype.kc=function(){this.Ub(190)};
Ck.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(Lb.a)(Ag,"RangeDuplicatesRemovedEvent",Wc,[]);Am(ki,Wc);ki.prototype.kc=function(){this.Ub(527);this.Ub(12)};Ck.Object.defineProperties(ki.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(Lb.a)(ki,"RangeEditedEvent",Wc,[]);Am(Fg,Wc);Fg.prototype.kc=function(){cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Ub(255):this.Ub(232)};Fg.prototype.sg=function(){this.Bd(function(F){return 4===F.actionType})};Ck.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(Lb.a)(Fg,"RangeExternalLinksBrokeAllLinksEvent",Wc,[]);Am(ci,Wc);ci.prototype.kc=function(){cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Ub(255):this.Ub(232)};ci.prototype.sg=function(){this.Bd(function(F){return 3===F.actionType})};
Ck.Object.defineProperties(ci.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(Lb.a)(ci,"RangeExternalLinksBrokeLinkEvent",Wc,[]);Am(Xh,Wc);Xh.prototype.kc=function(){cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Ub(256):this.Ub(249)};Xh.prototype.Gwa=function(){this.Cme("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Ck.Object.defineProperties(Xh.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 205}}});Object(Lb.a)(Xh,"RangeExternalLinksChangeSourceEvent",Wc,[]);Am(bh,Wc);bh.prototype.kc=function(){this.Ub(553)};bh.prototype.sg=function(){this.Bd(function(F){return 1===F.actionType})};Ck.Object.defineProperties(bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(Lb.a)(bh,"RangeExternalLinksRefreshedAllEvent",Wc,[]);Am(Qh,Wc);Qh.prototype.kc=function(){this.Ub(553)};Qh.prototype.sg=function(){this.Bd(function(F){return 0===F.actionType})};
Ck.Object.defineProperties(Qh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(Lb.a)(Qh,"RangeExternalLinksRefreshedEvent",Wc,[]);Am(rj,Wc);rj.prototype.kc=function(){this.Ub(224)};Ck.Object.defineProperties(rj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(Lb.a)(rj,"RangeExternalLinksSetAutoRefreshEvent",Wc,[]);Am(fh,Wc);fh.prototype.kc=function(){this.Ub(11)};fh.prototype.sg=function(){this.Bd(function(F){return 64===F.e_().ValidMembers})};
Ck.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(Lb.a)(fh,"RangeFillColoredEvent",Wc,[]);Am(nh,Wc);nh.prototype.kc=function(){this.Ub(155)};Ck.Object.defineProperties(nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(Lb.a)(nh,"RangeFilledEvent",Wc,[]);Am(Jh,Wc);Jh.prototype.kc=function(){this.Ub(176)};Jh.prototype.sg=function(){this.Bd(function(F){return F.QV().AutoFilterType===tg.spc&&!!F.QV().CriteriaType})};
Ck.Object.defineProperties(Jh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(Lb.a)(Jh,"RangeFilterAppliedEvent",Wc,[]);Am(Bh,Wc);Bh.prototype.kc=function(){this.Ub(176)};Bh.prototype.sg=function(){this.Bd(function(F){return F.QV().AutoFilterType===tg.spc&&!F.QV().CriteriaType})};Ck.Object.defineProperties(Bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(Lb.a)(Bh,"RangeFilterClearedEvent",Wc,[]);Am(wi,Wc);wi.prototype.kc=
function(){this.Ub(518)};Ck.Object.defineProperties(wi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(Lb.a)(wi,"RangeFilterReappliedEvent",Wc,[]);Am(zg,Wc);zg.prototype.kc=function(){this.Ub(150)};Ck.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(Lb.a)(zg,"RangeFlashFilledEvent",Wc,[]);Am(xh,oa);Object(Lb.a)(xh,"RangeFontColoredEvent",oa,[]);Am(ji,oa);Object(Lb.a)(ji,"RangeFontItalicizedEvent",
oa,[]);Am(ph,oa);Object(Lb.a)(ph,"RangeFontNamedEvent",oa,[]);Am(Ei,oa);Object(Lb.a)(Ei,"RangeFontSizedEvent",oa,[]);Am(Zf,Wc);Zf.prototype.kc=function(){this.Ub(215)};Ck.Object.defineProperties(Zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(Lb.a)(Zf,"RangeFormattedAsTableEvent",Wc,[]);Am(ig,Wc);ig.prototype.kc=function(){this.Ub(188)};Ck.Object.defineProperties(ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(Lb.a)(ig,
"RangeGroupedOrUngroupedEvent",Wc,[]);Am(kj,Wc);kj.prototype.kc=function(){this.Ub(11)};kj.prototype.sg=function(){this.Bd(function(F){return 2===F.e_().ValidMembers})};Ck.Object.defineProperties(kj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(Lb.a)(kj,"RangeHorizontallyAlignedEvent",Wc,[]);Am(Di,Wc);Di.prototype.kc=function(){this.Ub(526)};Ck.Object.defineProperties(Di.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(Lb.a)(Di,
"RangeHyperlinkAppliedEvent",Wc,[]);Am(Je,Wc);Je.prototype.kc=function(){this.Ub(11)};Je.prototype.sg=function(){this.Bd(function(F){return 256===F.e_().ValidMembers})};Ck.Object.defineProperties(Je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(Lb.a)(Je,"RangeIndentChangedEvent",Wc,[]);Am(lf,Wc);lf.prototype.kc=function(){this.Ub(156)};lf.prototype.sg=function(){this.Bd(function(F){return 2===F.du()||5===F.du()||6===F.du()||7===F.du()})};Ck.Object.defineProperties(lf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(Lb.a)(lf,"RangeMergedEvent",Wc,[]);Am(eg,Wc);eg.prototype.kc=function(){this.Ub(216)};Ck.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(Lb.a)(eg,"RangeNamedCellStyleAppliedEvent",Wc,[]);Am(We,Wc);We.prototype.kc=function(){this.Ub(11)};We.prototype.sg=function(){this.Bd(function(F){return 32===F.e_().ValidMembers})};Ck.Object.defineProperties(We.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(Lb.a)(We,"RangeNumberFormattedEvent",Wc,[]);var vj=b(1160);Am(wg,Wc);wg.prototype.kc=function(){this.Ub(141)};wg.prototype.sg=function(){this.Bd(function(F){return Object(dj.a)(vj.a,F)})};Ck.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(Lb.a)(wg,"RangeSortedEvent",Wc,[]);Am($g,oa);Object(Lb.a)($g,"RangeStrikedThroughEvent",oa,[]);Am(be,oa);Object(Lb.a)(be,
"RangeUnderlinedEvent",oa,[]);Am(Pg,Wc);Pg.prototype.kc=function(){this.Ub(11)};Pg.prototype.sg=function(){this.Bd(function(F){return 1===F.e_().ValidMembers})};Ck.Object.defineProperties(Pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(Lb.a)(Pg,"RangeVerticallyAlignedEvent",Wc,[]);Am(Hf,Wc);Hf.prototype.kc=function(){this.Ub(11)};Hf.prototype.sg=function(){this.Bd(function(F){return 8===F.e_().ValidMembers})};Ck.Object.defineProperties(Hf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 62}}});Object(Lb.a)(Hf,"RangeWrapTextToggledEvent",Wc,[]);Am(Wg,Wc);Wg.prototype.kc=function(){this.Ub(51)};Ck.Object.defineProperties(Wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(Lb.a)(Wg,"RefreshedAllEvent",Wc,[]);Am(af,Wc);af.prototype.kc=function(){this.Ub(148)};Ck.Object.defineProperties(af.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(Lb.a)(af,"ReplaceAllEvent",Wc,[]);Am(Kd,
Wc);Kd.prototype.kc=function(){this.Ub(532)};Kd.prototype.sg=function(){this.Bd(function(F){return 95!==F.getShapeType()&&96!==F.getShapeType()&&97!==F.getShapeType()&&98!==F.getShapeType()&&100!==F.getShapeType()&&102!==F.getShapeType()&&103!==F.getShapeType()})};Ck.Object.defineProperties(Kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(Lb.a)(Kd,"ShapeInsertedEvent",Wc,[]);Am(Gf,Wc);Gf.prototype.kc=function(){this.Ub(531)};Ck.Object.defineProperties(Gf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(Lb.a)(Gf,"ShapeStyleSetEvent",Wc,[]);var Hi=b(1021);Am(kg,Wc);kg.prototype.kc=function(){this.Ub(581)};kg.prototype.sg=function(){var F=this;this.Bd(function(ia){return Object(dj.a)(Hi.a,ia)&&4===ia.getShapeTextFormat().ValidMembers});this.Bd(function(ia){return Object(dj.a)(Hi.a,ia)&&ia.getShapeTextFormat().Font.ValidMembers===F.x_d})};Ck.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Qfa}}});
Object(Lb.a)(kg,"ShapeTextFontFormattedEventBase",Wc,[]);Am(Td,kg);Object(Lb.a)(Td,"ShapeTextBoldedEvent",kg,[]);var Pj=b(1162);Am(Uf,Wc);Uf.prototype.kc=function(){this.Ub(581)};Uf.prototype.sg=function(){this.Bd(function(F){return Object(dj.a)(Pj.a,F)})};Ck.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(Lb.a)(Uf,"ShapeTextChangedEvent",Wc,[]);Am(Cd,kg);Object(Lb.a)(Cd,"ShapeTextFontColorChangedEvent",kg,[]);Am(Sf,kg);Object(Lb.a)(Sf,
"ShapeTextFontNameChangedEvent",kg,[]);Am(Vd,kg);Object(Lb.a)(Vd,"ShapeTextFontSizeChangedEvent",kg,[]);Am(Uc,Wc);Uc.prototype.kc=function(){this.Ub(581)};Uc.prototype.sg=function(){this.Bd(function(F){return Object(dj.a)(Hi.a,F)&&2===F.getShapeTextFormat().ValidMembers})};Ck.Object.defineProperties(Uc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(Lb.a)(Uc,"ShapeTextHorizontallyAlignedEvent",Wc,[]);Am(mc,kg);Object(Lb.a)(mc,"ShapeTextItalicizedEvent",kg,[]);
Am(Ee,kg);Object(Lb.a)(Ee,"ShapeTextUnderlinedEvent",kg,[]);Am(uf,Wc);uf.prototype.kc=function(){this.Ub(581)};uf.prototype.sg=function(){this.Bd(function(F){return Object(dj.a)(Hi.a,F)&&1===F.getShapeTextFormat().ValidMembers})};Ck.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(Lb.a)(uf,"ShapeTextVerticallyAlignedEvent",Wc,[]);Am(gf,Wc);gf.prototype.kc=function(){this.Ub(138)};Ck.Object.defineProperties(gf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 13}}});Object(Lb.a)(gf,"SheetAddedEvent",Wc,[]);var Xj=b(9);Am(Fe,Wc);Fe.prototype.kc=function(){this.Ub(237)};Fe.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){F=F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>F.DeltaColumn&&!F.DeltaRow&&(!!F.InsertDeleteRange.FirstRow||F.InsertDeleteRange.LastRow!==
Xj.a.zy)||!F.DeltaColumn&&0>F.DeltaRow&&(!!F.InsertDeleteRange.FirstColumn||F.InsertDeleteRange.LastColumn!==Xj.a.yv)})};Ck.Object.defineProperties(Fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(Lb.a)(Fe,"SheetCellsDeletedEvent",Wc,[]);Am(Ud,Wc);Ud.prototype.kc=function(){this.Ub(237)};Ud.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});
this.Bd(function(F){F=F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<F.DeltaColumn&&!F.DeltaRow&&(!!F.InsertDeleteRange.FirstRow||F.InsertDeleteRange.LastRow!==Xj.a.zy)||!F.DeltaColumn&&0<F.DeltaRow&&(!!F.InsertDeleteRange.FirstColumn||F.InsertDeleteRange.LastColumn!==Xj.a.yv)})};Ck.Object.defineProperties(Ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(Lb.a)(Ud,"SheetCellsInsertedEvent",Wc,[]);Am(Od,Wc);Od.prototype.kc=function(){this.Ub(237)};
Od.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Xj.a.zy})};Ck.Object.defineProperties(Od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(Lb.a)(Od,"SheetColumnDeletedEvent",Wc,[]);Am(Xc,Wc);Xc.prototype.kc=function(){this.Ub(237)};Xc.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Xj.a.zy})};Ck.Object.defineProperties(Xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(Lb.a)(Xc,"SheetColumnInsertedEvent",Wc,[]);Am(yc,Wc);yc.prototype.kc=function(){this.Ub(137)};Ck.Object.defineProperties(yc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(Lb.a)(yc,"SheetDeletedEvent",Wc,[]);Am(Xb,Wc);Xb.prototype.kc=function(){this.Ub(185)};Ck.Object.defineProperties(Xb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(Lb.a)(Xb,"SheetDirectionChangedEvent",Wc,[]);Am(cb,Wc);cb.prototype.kc=function(){this.Ub(139)};Ck.Object.defineProperties(cb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(Lb.a)(cb,"SheetDuplicatedEvent",Wc,
[]);Am(Ia,Wc);Ia.prototype.kc=function(){this.Ub(207)};Ck.Object.defineProperties(Ia.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(Lb.a)(Ia,"SheetNameEditedEvent",Wc,[]);Am(ue,Wc);ue.prototype.kc=function(){this.Ub(151)};Ck.Object.defineProperties(ue.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(Lb.a)(ue,"SheetPaneFrozenEvent",Wc,[]);Am(He,Wc);He.prototype.kc=function(){this.Ub(226)};Ck.Object.defineProperties(He.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(Lb.a)(He,"SheetPrintSettingsSavedEvent",Wc,[]);var kk=b(1063);Am(Pe,Wc);Pe.prototype.kc=function(){this.Ub(507)};Pe.prototype.Gwa=function(){this.Cme("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Pe.prototype.sg=function(){this.Bd(function(F){return Object.getType(F)===kk.a})};Ck.Object.defineProperties(Pe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Lb.a)(Pe,"SheetProtectionPausedResumedEvent",
Wc,[]);Am(Nd,Wc);Nd.prototype.kc=function(){this.Ub(557)};Ck.Object.defineProperties(Nd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(Lb.a)(Nd,"SheetReorderedEvent",Wc,[]);Am(wd,Wc);wd.prototype.kc=function(){this.Ub(237)};wd.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.Bd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Xj.a.yv})};Ck.Object.defineProperties(wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(Lb.a)(wd,"SheetRowDeletedEvent",Wc,
[]);Am(Bc,Wc);Bc.prototype.kc=function(){this.Ub(237)};Bc.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.Bd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Xj.a.yv})};Ck.Object.defineProperties(Bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(Lb.a)(Bc,"SheetRowInsertedEvent",Wc,[]);Am(Mb,Wc);Mb.prototype.kc=function(){this.Ub(135)};Ck.Object.defineProperties(Mb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(Lb.a)(Mb,"SheetRowsColumnsAutoFitEvent",Wc,[]);
Am(Da,Wc);Da.prototype.kc=function(){this.Ub(136)};Ck.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(Lb.a)(Da,"SheetRowsColumnsResizedEvent",Wc,[]);Am(Ph,Wc);Ph.prototype.kc=function(){this.Ub(183)};Ck.Object.defineProperties(Ph.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(Lb.a)(Ph,"SheetShowGridlinesToggledEvent",Wc,[]);Am(Kf,Wc);Kf.prototype.kc=function(){this.Ub(184)};Ck.Object.defineProperties(Kf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(Lb.a)(Kf,"SheetShowHeadingsToggledEvent",Wc,[]);Am(lh,Wc);lh.prototype.kc=function(){this.Ub(213)};Ck.Object.defineProperties(lh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(Lb.a)(lh,"SheetSpellCheckedEvent",Wc,[]);Am(le,Wc);le.prototype.kc=function(){this.Ub(515)};Ck.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(Lb.a)(le,
"SheetTabColoredEvent",Wc,[]);Am($d,Wc);$d.prototype.kc=function(){this.Ub(157)};Ck.Object.defineProperties($d.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(Lb.a)($d,"SheetVisibilityChangedEvent",Wc,[]);Am(Lg,Wc);Lg.prototype.kc=function(){this.Ub(239)};Ck.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(Lb.a)(Lg,"SheetsVisibilityChangedEvent",Wc,[]);Am(De,Wc);De.prototype.kc=function(){this.Ub(203)};
Ck.Object.defineProperties(De.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(Lb.a)(De,"SlicerInsertedEvent",Wc,[]);Am(Rf,Wc);Rf.prototype.kc=function(){this.Ub(173)};Rf.prototype.sg=function(){this.Bd(function(F){return!F.clearFilter})};Ck.Object.defineProperties(Rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(Lb.a)(Rf,"SlicerSelectionAppliedEvent",Wc,[]);Am(Vg,Wc);Vg.prototype.kc=function(){this.Ub(173)};Vg.prototype.sg=
function(){this.Bd(function(F){return F.clearFilter})};Ck.Object.defineProperties(Vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(Lb.a)(Vg,"SlicerSelectionClearedEvent",Wc,[]);Am(Qf,Wc);Qf.prototype.kc=function(){this.Ub(208)};Qf.prototype.sg=function(){this.Bd(function(F){return F.getParameters().FilterType===tg.P$a})};Ck.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(Lb.a)(Qf,"TableCheckedItemsFilteredEvent",
Wc,[]);Am(Bf,Wc);Bf.prototype.kc=function(){this.Ub(237)};Bf.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ck.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(Lb.a)(Bf,"TableColumnDeletedEvent",Wc,[]);Am(Ze,Wc);Ze.prototype.kc=function(){this.Ub(237)};Ze.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ck.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(Lb.a)(Ze,"TableColumnInsertedEvent",Wc,[]);var Dj=b(1161);Am(Ae,Wc);Ae.prototype.kc=function(){this.Ub(141)};Ae.prototype.sg=function(){this.Bd(function(F){return Object(dj.a)(Dj.a,F)})};Ck.Object.defineProperties(Ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(Lb.a)(Ae,"TableColumnSortedEvent",Wc,[]);Am(me,Wc);me.prototype.kc=function(){this.Ub(193)};
Ck.Object.defineProperties(me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(Lb.a)(me,"TableConvertedToRangeEvent",Wc,[]);Am(xd,Wc);xd.prototype.kc=function(){this.Ub(206)};Ck.Object.defineProperties(xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(Lb.a)(xd,"TableCreatedEvent",Wc,[]);Am(jd,Wc);jd.prototype.kc=function(){this.Ub(209)};jd.prototype.sg=function(){this.Bd(function(F){return F.getParameters().FilterType===
tg.P$a})};Ck.Object.defineProperties(jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(Lb.a)(jd,"TableCustomFilteredEvent",Wc,[]);Am(wc,Wc);wc.prototype.kc=function(){this.Ub(187)};wc.prototype.sg=function(){this.Bd(function(F){return 1===F.options.OperationType})};Ck.Object.defineProperties(wc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(Lb.a)(wc,"TableCustomSortedEvent",Wc,[]);Am(xg,Wc);xg.prototype.kc=function(){this.Ub(176)};
xg.prototype.sg=function(){this.Bd(function(F){return F.QV().AutoFilterType===tg.P$a});this.Bd(function(F){return 0===F.QV().CriteriaType})};Ck.Object.defineProperties(xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(Lb.a)(xg,"TableFilterClearedEvent",Wc,[]);Am(Gg,Wc);Gg.prototype.kc=function(){this.Ub(176)};Gg.prototype.sg=function(){this.Bd(function(F){return F.QV().AutoFilterType===tg.P$a});this.Bd(function(F){var ia=new sg.a;ia.add(1);ia.add(2);ia.add(8);
ia.add(9);ia.add(10);ia.add(11);ia.add(12);ia.add(13);ia.add(14);ia.add(15);ia.add(16);ia.add(17);ia.add(18);ia.add(19);ia.add(20);ia.add(21);ia.add(22);ia.add(23);ia.add(24);ia.add(25);ia.add(26);ia.add(27);ia.add(28);ia.add(29);ia.add(30);ia.add(31);ia.add(32);ia.add(33);ia.add(34);ia.add(35);ia.add(36);ia.add(37);ia.add(38);ia.add(39);return ia.contains(F.QV().CriteriaType)})};Ck.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(Lb.a)(Gg,
"TableItemFilteredEvent",Wc,[]);Am(Cg,Wc);Cg.prototype.kc=function(){this.Ub(217)};Ck.Object.defineProperties(Cg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(Lb.a)(Cg,"TableRenamedEvent",Wc,[]);Am(bf,Wc);bf.prototype.kc=function(){this.Ub(211)};Ck.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(Lb.a)(bf,"TableResizedEvent",Wc,[]);Am(yg,Wc);yg.prototype.kc=function(){this.Ub(514)};Ck.Object.defineProperties(yg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(Lb.a)(yg,"TableRowColumnRearrangedEvent",Wc,[]);Am(hf,Wc);hf.prototype.kc=function(){this.Ub(237)};hf.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ck.Object.defineProperties(hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(Lb.a)(hf,"TableRowDeletedEvent",Wc,[]);Am(ff,Wc);ff.prototype.kc=function(){this.Ub(237)};ff.prototype.sg=function(){this.Bd(function(F){return!!F.insertDeleteMultiRangeParameters});this.Bd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(F){return 0<
F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ck.Object.defineProperties(ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(Lb.a)(ff,"TableRowInsertedEvent",Wc,[]);Am(Qe,Wc);Qe.prototype.kc=function(){this.Ub(177)};Qe.prototype.sg=function(){this.Bd(function(F){return F.QV().AutoFilterType===tg.P$a})};Ck.Object.defineProperties(Qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(Lb.a)(Qe,"TableSortedEvent",
Wc,[]);Am(pd,Wc);pd.prototype.kc=function(){this.Ub(212)};Ck.Object.defineProperties(pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(Lb.a)(pd,"TableStyleAppliedEvent",Wc,[]);Am(td,Wc);td.prototype.kc=function(){this.Ub(196)};Ck.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(Lb.a)(td,"TableStyleOptionToggledEvent",Wc,[]);Am(Lc,Wc);Lc.prototype.kc=function(){this.Ub(210)};Lc.prototype.sg=function(){this.Bd(function(F){return F.getParameters().FilterType===
tg.P$a})};Ck.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(Lb.a)(Lc,"TableTop10FilteredEvent",Wc,[]);Am(ic,Wc);ic.prototype.kc=function(){this.Ub(238)};Ck.Object.defineProperties(ic.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(Lb.a)(ic,"TextToColumnsEvent",Wc,[]);Am(Hb,Wc);Hb.prototype.kc=function(){this.Ub(559)};Ck.Object.defineProperties(Hb.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(Lb.a)(Hb,"ValuesSortedEvent",Wc,[]);Am(Ma,Wc);Ma.prototype.kc=function(){this.Ub(197)};Ck.Object.defineProperties(Ma.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(Lb.a)(Ma,"WorkbookCalculationModeSetEvent",Wc,[]);Am(Zd,Wc);Zd.prototype.kc=function(){this.Ub(181)};Zd.prototype.sg=function(){this.Bd(function(F){return!!F.parentCommentId})};Ck.Object.defineProperties(Zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(Lb.a)(Zd,"WorkbookCommentRepliedEvent",Wc,[]);Am(bg,Wc);bg.prototype.kc=function(){this.Ub(181)};bg.prototype.sg=function(){this.Bd(function(F){return!F.parentCommentId})};Ck.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(Lb.a)(bg,"WorkbookCommentedEvent",Wc,[]);Am(pf,Wc);pf.prototype.kc=function(){this.Ub(128)};Ck.Object.defineProperties(pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(Lb.a)(pf,
"WorkbookRecalculatedEvent",Wc,[]);Am($e,Wc);$e.prototype.kc=function(){this.Ub(171)};Ck.Object.defineProperties($e.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(Lb.a)($e,"WorkbookRedoEvent",Wc,[]);Am(wf,Wc);wf.prototype.kc=function(){this.Ub(170)};Ck.Object.defineProperties(wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(Lb.a)(wf,"WorkbookUndoEvent",Wc,[]);Am(sf,Wc);sf.prototype.kc=function(){this.Ub(507);this.Ub(576);
this.Ub(10)};sf.prototype.sg=function(){this.Bd(function(F){if(Object(dj.a)(yj,F)&&(F=Object(Oh.a)(yj,F),void 0!==F.source&&null!==F.source&&void 0!==F.eventId&&null!==F.eventId))return Xa.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",F.source,F.eventId),!0;Xa.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Ck.Object.defineProperties(sf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(Lb.a)(sf,"DefaultRichApiRequestExecutedEvent",Wc,[]);Am(df,Wc);df.prototype.kc=function(){this.Ub(1022)};Ck.Object.defineProperties(df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(Lb.a)(df,"TablelAltTextEditedEvent",Wc,[]);Am(we,Wc);we.prototype.kc=function(){this.Ub(263)};Ck.Object.defineProperties(we.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(Lb.a)(we,"FloatingObjectZOrderChangedEvent",
Wc,[]);Hd.prototype.S0e=function(F,ia){var Qa=this.T0e(F,this.macroRecorderEvents,ia);Qa||(Qa=this.T0e(F,Hd.V1h(),ia),!Qa&&this.Kff(F,Hd.KHe,ia)&&(Qa=Hd.KHe));return Qa};Hd.prototype.T0e=function(F,ia,Qa){var Ab=new sg.a;ia=Cl(ia);for(var Ec=ia.next();!Ec.done;Ec=ia.next())Ec=Ec.value,this.Kff(F,Ec,Qa)&&Ab.add(Ec);return 1===Ab.count?Ab.oa(0):1<Ab.count?Hd.DKh(Ab):null};Hd.prototype.Kff=function(F,ia,Qa){var Ab=Hd.kWi(F,ia);return Qa?Ab&&Hd.oWj(F,ia):Ab};Hd.prototype.daj=function(){for(var F=new sg.a,
ia=Cl(this.Gb),Qa=ia.next();!Qa.done;Qa=ia.next()){Qa=Qa.value;for(var Ab=!1,Ec=Cl(Qa.featureGates),Mc=Ec.next();!Mc.done;Mc=Ec.next())if(!cg.EwaSettings.ma(Mc.value)){F.add(Qa);Ab=!0;break}if(!Ab)for(Ab=Cl(Qa.nTe),Ec=Ab.next();!Ec.done;Ec=Ab.next())if(!cg.EwaSettings.getBooleanFeatureGate(Ec.value,!1)){F.add(Qa);break}}F=Cl(F);for(ia=F.next();!ia.done;ia=F.next())this.Gb.remove(ia.value)};Hd.V1h=function(){Hd.MCb||(Hd.MCb=new sg.a,Hd.MCb.add(new Vh),Hd.MCb.add(new rg));return Hd.MCb};Hd.kWi=function(F,
ia){return ia.operations.contains(F.operation)};Hd.oWj=function(F,ia){var Qa=ia.jDc;if(!Qa.count)return!0;ia=!0;Qa=Cl(Qa);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,!Ab(F.payload)){ia=!1;break}return ia};Hd.DKh=function(F){var ia=F.oa(0);F=Cl(F);for(var Qa=F.next();!Qa.done;Qa=F.next())Qa=Qa.value,Qa.jDc.count>ia.jDc.count&&(ia=Qa);return ia};Ck.Object.defineProperties(Hd.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Gb||(this.Gb=new sg.a,this.Gb.add(new ki),
this.Gb.add(new Zh),this.Gb.add(new Ga),this.Gb.add(new Ch),this.Gb.add(new fh),this.Gb.add(new xh),this.Gb.add(new ji),this.Gb.add(new ph),this.Gb.add(new Ei),this.Gb.add(new $g),this.Gb.add(new be),this.Gb.add(new We),this.Gb.add(new gf),this.Gb.add(new yc),this.Gb.add(new Ia),this.Gb.add(new xd),this.Gb.add(new Bf),this.Gb.add(new Ze),this.Gb.add(new hf),this.Gb.add(new ff),this.Gb.add(new Xc),this.Gb.add(new Od),this.Gb.add(new Bc),this.Gb.add(new wd),this.Gb.add(new wc),this.Gb.add(new Qe),this.Gb.add(new Qf),
this.Gb.add(new xg),this.Gb.add(new yh),this.Gb.add(new jd),this.Gb.add(new Lc),this.Gb.add(new Gg),this.Gb.add(new bg),this.Gb.add(new Zd),this.Gb.add(new kc),this.Gb.add(new Da),this.Gb.add(new Fe),this.Gb.add(new Ud),this.Gb.add(new Mb),this.Gb.add(new Ug),this.Gb.add(new wi),this.Gb.add(new Di),this.Gb.add(new Ha),this.Gb.add(new yg),this.Gb.add(new $e),this.Gb.add(new wf),this.Gb.add(new af),this.Gb.add(new li),this.Gb.add(new md),this.Gb.add(new lf),this.Gb.add(new cb),this.Gb.add(new Ma),this.Gb.add(new pf),
this.Gb.add(new Bb),this.Gb.add(new Bh),this.Gb.add(new nh),this.Gb.add(new kj),this.Gb.add(new Pg),this.Gb.add(new Hf),this.Gb.add(new Je),this.Gb.add(new Nd),this.Gb.add(new fe),this.Gb.add(new uj),this.Gb.add(new Kf),this.Gb.add(new Ph),this.Gb.add(new Ag),this.Gb.add(new $d),this.Gb.add(new le),this.Gb.add(new bf),this.Gb.add(new Zf),this.Gb.add(new ih),this.Gb.add(new W),this.Gb.add(new Qh),this.Gb.add(new sj),this.Gb.add(new Bj),this.Gb.add(new Eb),this.Gb.add(new xi),this.Gb.add(new Ja),this.Gb.add(new Aj),
this.Gb.add(new gc),this.Gb.add(new Cj),this.Gb.add(new zg),this.Gb.add(new pd),this.Gb.add(new td),this.Gb.add(new lh),this.Gb.add(new ue),this.Gb.add(new Kd),this.Gb.add(new Gf),this.Gb.add(new th),this.Gb.add(new wh),this.Gb.add(new ri),this.Gb.add(new hg),this.Gb.add(new ig),this.Gb.add(new og),this.Gb.add(new ab),this.Gb.add(new Hg),this.Gb.add(new Cg),this.Gb.add(new Rh),this.Gb.add(new Wg),this.Gb.add(new rh),this.Gb.add(new me),this.Gb.add(new Yg),this.Gb.add(new eg),this.Gb.add(new wg),this.Gb.add(new pg),
this.Gb.add(new Jb),this.Gb.add(new jb),this.Gb.add(new ce),this.Gb.add(new qi),this.Gb.add(new hh),this.Gb.add(new Jh),this.Gb.add(new vd),this.Gb.add(new D),this.Gb.add(new ci),this.Gb.add(new He),this.Gb.add(new Ae),this.Gb.add(new pi),this.Gb.add(new Lg),this.Gb.add(new cf),this.Gb.add(new Hb),this.Gb.add(new Ni),this.Gb.add(new Oe),this.Gb.add(new Si),this.Gb.add(new Nc),this.Gb.add(new da),this.Gb.add(new xe),this.Gb.add(new tf),this.Gb.add(new Xb),this.Gb.add(new ag),this.Gb.add(new se),this.Gb.add(new ja),
this.Gb.add(new ch),this.Gb.add(new Mf),this.Gb.add(new ma),this.Gb.add(new Ye),this.Gb.add(new qe),this.Gb.add(new Rd),this.Gb.add(new re),this.Gb.add(new je),this.Gb.add(new Rc),this.Gb.add(new bh),this.Gb.add(new Fg),this.Gb.add(new rj),this.Gb.add(new id),this.Gb.add(new bc),this.Gb.add(new Eh),this.Gb.add(new Xg),this.Gb.add(new vh),this.Gb.add(new S),this.Gb.add(new ij),this.Gb.add(new k),this.Gb.add(new Zg),this.Gb.add(new oh),this.Gb.add(new Mi),this.Gb.add(new zh),this.Gb.add(new Ff),this.Gb.add(new Df),
this.Gb.add(new kh),this.Gb.add(new ah),this.Gb.add(new Fh),this.Gb.add(new G),this.Gb.add(new d),this.Gb.add(new Of),this.Gb.add(new jg),this.Gb.add(new Nh),this.Gb.add(new De),this.Gb.add(new Rf),this.Gb.add(new Vg),this.Gb.add(new Uf),this.Gb.add(new Td),this.Gb.add(new mc),this.Gb.add(new Ee),this.Gb.add(new Cd),this.Gb.add(new Sf),this.Gb.add(new Vd),this.Gb.add(new Uc),this.Gb.add(new uf),this.Gb.add(new Xh),this.Gb.add(new yf),this.Gb.add(new ic),this.Gb.add(new Pe),this.Gb.add(new df),this.Gb.add(new we),
cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.daj());return this.Gb}}});Hd.MCb=null;Hd.KHe=new sf;Object(Lb.a)(Hd,"MacroRecorderEventList",null,[]);var Fj=zi.a;Am(oe,Fj);oe.prototype.create=function(){this.Eb(this.$.da.Aa(297)||new Pf(this.$,new Hd(this.$),new Ng))};oe.ka=function(F){F.da.Ga(298,new oe(F))};Object(Lb.a)(oe,"MacroRecorderEventHandlerFactory",zi.a,[]);var Qj=b(904),mj=b(79),mi=b(36);Bd.prototype.$c=function(){return!1};Bd.prototype.executeCommand=
function(F,ia,Qa){F=mi.TaskExtensions.Dl();ia=ia.command;switch(ia){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.Zd(2045014907,-1,0,null),this.automateCommandManager.usi(ia,1904816141===ia?Qa[mj.a.ld].toString():null)}return F};Bd.prototype.Kc=function(F,ia){F=!1;switch(ia.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:F=this.$.Yba}return F};Bd.prototype.jd=function(F,ia,Qa){return"PopulateAutomateGalleryMenu"===
ia&&this.$.Yba?(this.automateCommandManager.jd(ia,Qa),!0):!1};Object(Lb.a)(Bd,"AutomateCommandHandler",null,[424]);var qk=b(489),xk=Qj.a;Am(Id,xk);Id.prototype.Nd=function(){var F=this;qk.a(this.$,374,375,this.ub,function(){var ia=F.$.da.Aa(352);ia?F.Dd([new Bd(ia,F.$)]):Xa.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};Id.ka=function(F){F.da.Ga(308,new Id(F))};Object(Lb.a)(Id,"AutomateCommandHandlerFactory",Qj.a,[]);var Wf=
b(7);Object(Lb.a)(Kc,"AuthContext",null,[]);var If=b(564),Ui=b(131),Qi=b(111),ai=b(28),O=b(1022),Ea=b(187);Wb.prototype.getAuthContext=function(){return this.fpb};Wb.prototype.Wbc=function(){function F(Mc,zd){return(new Promise(function(Ld){window.setTimeout(function(){Ld(Mc)},zd)})).then(function(Ld){Ab.push(Object(Wf.a)(new mg.a,{name:"Error"+Ec,string:Ld.ErrorMessage}));Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode"+Ec,string:Ld.ErrorCode}));Ec++;return ia.Zag()})}var ia=this,Qa=ai.a.Ta.Wb,Ab=
[];if(this.oAuthManager)Ab.push(Object(Wf.a)(new mg.a,{name:"IsAuthSupported",bool:this.jYc}));else return this.M9b(Ab,Qa,"need_OAuthManager","No OAuthManager");if(!this.Xu.xy||!this.Xu.xy.value)return this.M9b(Ab,Qa,"need_license","No License");if(ke.AFrameworkApplication.ga.ra("IsAnonymousUser"))return this.M9b(Ab,Qa,"need_user","Anonymous User");if(33E5>Date.now()-this.fpb.timeStamp)return Ab.push(Object(Wf.a)(new mg.a,{name:"UsedCachedToken",bool:!0})),Ea.a(Ui.a.Wzd,!0,0,Ab),Promise.resolve(Object(Wf.a)(new O.a,
{IsSuccess:!0,Token:this.fpb.token}));Ab.push(Object(Wf.a)(new mg.a,{name:"UsedCachedToken",bool:!1}));var Ec=1;return this.Zag().catch(function(Mc){return F(Mc,200)}).catch(function(Mc){return F(Mc,400)}).then(function(Mc){Mc.IsSuccess?(ia.fpb.token=Mc.Token,ia.fpb.timeStamp=Date.now()):(Ab.push(Object(Wf.a)(new mg.a,{name:"Error"+Ec,string:Mc.ErrorMessage})),Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode"+Ec,string:Mc.ErrorCode})));Ab.push(Object(Wf.a)(new mg.a,{name:"Attempts",int64:Ec}));Ab.push(Object(Wf.a)(new mg.a,
{name:"Error",string:Mc.ErrorMessage}));Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:Mc.ErrorCode}));Ea.a(Ui.a.Wzd,Mc.IsSuccess,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);return Promise.resolve(Mc)}).catch(function(Mc){Ab.push(Object(Wf.a)(new mg.a,{name:"Error"+Ec,string:Mc.ErrorMessage}));Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode"+Ec,string:Mc.ErrorCode}));Ab.push(Object(Wf.a)(new mg.a,{name:"Attempts",int64:Ec}));return ia.M9b(Ab,Qa,Mc.ErrorCode,Mc.ErrorMessage)})};Wb.prototype.M9b=
function(F,ia,Qa,Ab){F.push(Object(Wf.a)(new mg.a,{name:"Error",string:Ab}));F.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:Qa}));Ea.a(Ui.a.Wzd,!1,Qi.getElapsedMilliseconds(ia,ai.a.Ta.Wb),F);return Promise.resolve(Object(Wf.a)(new O.a,{IsSuccess:!1,ErrorMessage:Ab,ErrorCode:Qa}))};Wb.prototype.Zag=function(){var F=this,ia=If.a.W_h(),Qa=0;ia=this.oAuthManager.jT("Maker",ia).then(function(Ab){if(Ab)return!Ab.IsSuccess&&F.syj(Ab)?Promise.reject(Ab):Promise.resolve(Ab);Ab=Object(Wf.a)(new O.a,
{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Ab)}).catch(function(Ab){var Ec=new O.a;Object.getType(Ab)===Object.getType(Ec)?Ec=Ab:(Ec.ErrorMessage=Ab.toString(),Ec.ErrorCode="exception");return Promise.reject(Ec)});return Promise.race([ia,new Promise(function(Ab,Ec){Qa=window.setTimeout(function(){Ec(Object(Wf.a)(new O.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(Ab){window.clearTimeout(Qa);
return Ab})};Wb.prototype.syj=function(F){return"interaction_required"===F.ErrorCode||"InitFailed"===F.ErrorCode||"invalid_resource"===F.ErrorCode||"login_required"===F.ErrorCode&&F.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(Lb.a)(Wb,"AutomateCommandAuth",null,[852]);var Nb=b(1023);Object(Lb.a)(ug,"AutomateCommandGalleryBase",null,[]);var sc=b(392),Zc=b(29),Ic=b(621),Gd=b(1427),ze=b(19),Vf=b(54),Cf=b(15),qg=b(322),Sg=b(652);Xf.prototype.rIh=function(F){var ia=this.automateCommandManager.Sa.Zp().sC(),
Qa=Xf.dV(F,Cf.a.instance.fa(2089));this.vVc(Qa,If.a.$Ti,this.automateCommandManager.Tj,If.a.BFi,Cf.a.instance.fa(2085),this.automateCommandManager.Sa);ia.MenuSectionList.push(Qa);Qa=Xf.dV(F,Cf.a.instance.fa(2090));this.vVc(Qa,If.a.PCi,If.a.x6?this.automateCommandManager.tt.JUe(this.automateCommandManager.Tj):this.automateCommandManager.nq.JUe(this.automateCommandManager.Tj),If.a.Dtf,Cf.a.instance.fa(2086),this.automateCommandManager.Sa);ia.MenuSectionList.push(Qa);Qa=Xf.dV(F,Cf.a.instance.fa(2091));
this.vVc(Qa,If.a.mkj,this.automateCommandManager.NB,If.a.Dtf,"",this.automateCommandManager.Sa);ia.MenuSectionList.push(Qa);Qa=Object(Wf.a)(new sc.a,{Id:If.a.hqe,ExternalId:If.a.hqe,Command:"1606046412",LabelText:Cf.a.instance.fa(2082),Alt:Cf.a.instance.fa(2083),Image16by16:Vf.a.Se(16),Image16by16Class:ze.a.FPe,Visible:!0});F=Xf.dV(F,null);F.ControlsId="myScriptsSection.Controls";F.ControlList.push(Qa);ia.MenuSectionList.push(F);return ia};Xf.prototype.vVc=function(F,ia,Qa,Ab,Ec,Mc){if(Qa&&0<Qa.length){ia=
Mc.fB(ia,1,"Size150by20").m1b();Ec={};Mc={};Mc.root=Xf.Jta(320,30);Mc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Mc.label={margin:"0px 3px"};Ec.galleryButtonInExpanded=Mc;ia.GalleryStyle=Ec;for(Ec=0;Ec<Qa.length&&Ec<Ab;Ec++)Mc=Qa.nR(Ec),ia.GalleryItems.push(Xf.j4c(Mc.id,Mc,!1));F.ControlList.push(ia)}else Qa=Object(Wf.a)(new Sg.a,{Id:ia,ExternalId:ia,LabelText:Ec}),F.ControlsId=Qa.Id+".Controls",F.ControlList.push(Qa)};
Xf.pHh=function(F){if(F){var ia=String.format(If.a.Tci,F.isShared?If.a.xag:If.a.cXf,Vf.a.Se(16));F=String.format(If.a.Uci,Zc.a.Sf(F.name));return String.format(If.a.Sci,ia,F)}return""};Xf.dV=function(F,ia){return Object(Wf.a)(new Ic.a,{Id:F,Title:ia,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};Xf.j4c=function(F,ia,Qa){var Ab=Qa?If.a.XMj:If.a.WMj,Ec=Qa?If.a.Flj:If.a.Elj,Mc=Qa?If.a.xag:If.a.YMj,zd=Qa?If.a.cXf:If.a.Glj;return ia?Xf.OEe(ia.shareId||
ia.id,ia.name,Qa,ia.isShared?Ab:Ec,F,F,ia.isShared?Mc:zd):Xf.OEe("","",Qa,"",F,F)};Xf.OEe=function(F,ia,Qa,Ab,Ec,Mc,zd){Ec=void 0===Ec?null:Ec;Mc=void 0===Mc?null:Mc;zd=void 0===zd?null:zd;var Ld=void 0===Ld?null:Ld;var ye={},Te={};Qa?(ye.root=Xf.Jta(32,32),Te.root=Xf.Jta(32,32)):(ye.root=Xf.Jta(20,20),Te.root=Xf.Jta(20,20));return Object(Wf.a)(new Gd.a,{Id:F,ExternalId:Ec||F,MenuItemId:Mc||F,Command:"1904816141",Icon:Ab,Image:Vf.a.Se(16),ImageClass:zd,LabelText:ia,FullIconStyle:ye,PreviewIconStyle:Te,
Alt:Ld||ia})};Xf.Jta=function(F,ia){var Qa={};Qa.width=F;Qa["min-width"]=F;Qa.height=ia;return Qa};Object(Lb.a)(Xf,"AutomateCommandRenderer",null,[]);Ef.prototype.YKa=function(F){for(var ia=0;ia<this.scripts.length;ia++)if(this.scripts[ia].id===F||this.scripts[ia].shareId===F)return ia;return-1};Ef.prototype.sort=function(){this.f6f(this.scripts)};Ef.prototype.Vu=function(F){return-1===this.YKa(F.id)?(this.scripts.push(F),!0):!1};Ef.prototype.uVc=function(F){return-1===this.YKa(F.id)?(this.scripts=
[F].concat(this.scripts),!0):!1};Ef.prototype.uCi=function(F){F=this.YKa(F.id);if(-1!==F){for(var ia=this.scripts[F].u0a();0<F;)this.scripts[F]=this.scripts[F-1],F--;this.scripts[0]=ia}};Ef.prototype.Rfb=function(F){var ia=this.YKa(F.id);if(-1!==ia){var Qa=this.scripts[ia].shareId;this.scripts[ia]=F;this.scripts[ia].shareId=Qa}};Ef.prototype.bgf=function(F){var ia=this.YKa(F.id);return-1!==ia?F.name===this.scripts[ia].name:!1};Ef.prototype.K1a=function(F){F=this.YKa(F);return-1!==F?(this.scripts.splice(F,
1),!0):!1};Ef.prototype.clear=function(){this.scripts=[]};Ef.prototype.getScripts=function(){return this.scripts};Ef.prototype.GH=function(F){F=this.YKa(F);return-1!==F?this.scripts[F]:null};Ef.prototype.nR=function(F){return 0<=F&&this.length>F?this.scripts[F]:null};Ef.prototype.JUe=function(F){for(var ia=new Ef([],this.f6f),Qa=0;Qa<this.scripts.length;Qa++){var Ab=this.scripts[Qa];F.GH(Ab.id)||ia.Vu(Ab)}return ia};Ef.prototype.Veb=function(){for(var F=[],ia=Cl(this.scripts),Qa=ia.next();!Qa.done;Qa=
ia.next())F.push(Qa.value.PWd());return F};Ck.Object.defineProperties(Ef.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(Lb.a)(Ef,"ScriptCollection",null,[]);var Sh=b(197);jf.prototype.u0a=function(){return new jf(this.jaa)};jf.prototype.PWd=function(){return this.jaa};Ck.Object.defineProperties(jf.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.jaa.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.jaa.shareId},
set:function(F){this.jaa.shareId=F||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.jaa.name}},cHe:{configurable:!0,enumerable:!0,get:function(){return this.jaa.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.jaa.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.jaa.description}},tdf:{configurable:!0,enumerable:!0,get:function(){return this.jaa.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&
0<this.shareId.length}}});Object(Lb.a)(jf,"ScriptCore",null,[]);var ii=b(37);Am(Af,ug);Af.prototype.mhd=function(F){switch(F){case "1":case "2":case "3":return this.TF.nR(parseInt(F,10)-1);default:return this.pf.tt.GH(F)||this.pf.nq.GH(F)||this.pf.Tj.GH(F)||this.pf.NB.GH(F)}};Af.prototype.zfd=function(F,ia,Qa){var Ab=null;if(this.pf.z5a)switch(F){case "1":case "2":case "3":Ab=this.TF.nR(parseInt(F,10)-1);break;case "4":case "5":case "6":Ab=If.a.vea?this.TF.nR(parseInt(F,10)-1):this.TF.GH(F);break;
default:Ab=this.TF.GH(F)}ii.a.isReactRibbonEnabled()?ia[Nb.a.GalleryButtonProps]=Xf.j4c(F,Ab,2===Qa&&!If.a.vea):ia[Nb.a.InnerHTML]=Xf.pHh(Ab);ia[Nb.a.Alt]=Ab?Ab.name:""};Af.prototype.qO=function(F){this.TF=this.aId();this.$.Bf();var ia=[];ia.push(Object(Wf.a)(new mg.a,{name:"Operation",string:F}));ia.push(Object(Wf.a)(new mg.a,{name:"HasReadRecentCachedScripts",bool:this.pf.$dc}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadScriptsDone",bool:this.pf.mkd}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadSamplesScriptsDone",
bool:this.pf.vHb}));ia.push(Object(Wf.a)(new mg.a,{name:"SamplesScriptCount",int64:this.pf.NB.length}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadRecentScriptsDone",bool:this.pf.lbb}));ia.push(Object(Wf.a)(new mg.a,{name:"RecentScriptCount",int64:this.pf.tt.length}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadWorkbookScriptsDone",bool:this.pf.mX}));ia.push(Object(Wf.a)(new mg.a,{name:"WorkbookScriptCount",int64:this.pf.Tj.length}));Ea.a(Ui.a.huf,!0,0,ia)};Af.prototype.Gjd=function(F){var ia=!1,Qa="",
Ab=new jf(F.scriptMetadata),Ec={Operation:"HandleRefreshRibbonGallery"};Ec.RefreshOperation=F.operationName;switch(F.operationName){case If.a.zOf:F=this.Fjd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.xOf:F=this.Djd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.wOf:F=this.Cjd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.yOf:F=this.Ejd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.m8i:F=this.e5h(Ab),Qa=F.message,ia=F.returnValue}(Ec.GalleryUpdated=ia)?(Xa.ULS.sendTraceTag(537170322,
0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",Qa),this.qO("RefreshGallery")):Xa.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Qa);Ec.Message=Qa;Xa.ULS.sendTraceTag(537170320,0,50,Kg.c(Ec))};Af.prototype.aId=function(){for(var F=new Ef([],function(){}),ia=this.pf.Tj?this.pf.Tj.length:0,Qa=this.pf.tt?this.pf.tt.length:0,Ab=this.pf.NB?this.pf.NB.length:0,Ec=0,Mc=If.a.vea?6:If.a.pJf,
zd=0;zd<Mc;zd++)if(zd<ia)F.Vu(this.pf.Tj.nR(zd));else if(zd-ia+Ec<Qa){var Ld=this.pf.tt.nR(zd-ia+Ec);this.pf.Tj.GH(Ld.id)?(Ec++,zd--):F.Vu(Ld)}else zd-ia-Qa+Ec<Ab&&F.Vu(this.pf.NB.nR(zd-ia+Ec-Qa));return F};Af.prototype.Fjd=function(F){if(this.pf.tt.uVc(F))var ia="";else{ia="";var Qa=F.u0a();this.pf.Tj.Rfb(Qa);this.pf.Tj.sort();this.pf.tt.Rfb(F)}return{returnValue:!0,message:ia}};Af.prototype.Djd=function(F){this.pf.Tj.K1a(F.id);return this.pf.tt.K1a(F.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Deleting a script but script could not be found in recent script collection."}};Af.prototype.Cjd=function(F){var ia=F.u0a();ia.shareId=null;this.pf.tt.uVc(ia);return this.pf.Tj.Vu(F)?(this.pf.Tj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};Af.prototype.Ejd=function(F){return this.pf.Tj.K1a(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};
Af.prototype.e5h=function(F){var ia=F.u0a(),Qa=!1;this.pf.Tj.bgf(ia)&&(this.pf.Tj.Rfb(ia),this.pf.Tj.sort(),Qa=!0);this.pf.tt.uVc(F)?Qa=!0:this.pf.tt.bgf(F)&&(this.pf.tt.Rfb(F),this.pf.tt.uCi(F),Qa=!0);return{returnValue:Qa,message:""}};Object(Lb.a)(Af,"AutomateCommandGallery",ug,[]);var ui=b(85);Object(Lb.a)(Ge,"AutomateCommandLicensingBase",null,[]);Object(Lb.a)(Se,"BoolResultWrapper",null,[]);Am(Vc,Ge);Vc.prototype.L0c=function(){var F=this,ia=ai.a.Ta.Wb,Qa=[];return new Promise(function(Ab){ui.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ec){Ec.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Mc){Qa.push(Object(Wf.a)(new mg.a,{name:"IsLicensed",bool:Mc}));Ea.a(Ui.a.duf,!0,Qi.getElapsedMilliseconds(ia,ai.a.Ta.Wb),Qa);F.xy=new Se(Mc,!0);Ab(Mc)}).catch(function(Mc){Qa.push(Object(Wf.a)(new mg.a,{name:"IsLicensed",bool:!1}));Qa.push(Object(Wf.a)(new mg.a,{name:"Error",string:Mc.toString()}));Qa.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:"exception"}));Ea.a(Ui.a.duf,!1,Qi.getElapsedMilliseconds(ia,ai.a.Ta.Wb),Qa);F.xy=new Se(!1,!1,void 0,"exception",Mc.toString());
Ab(!1)})})})};Object(Lb.a)(Vc,"AutomateCommandLicensing",Ge,[]);var eh=b(1352),Kj=b(1350),ck=b(1349),dk=b(1351);ld.taskPaneWidth="TaskPaneWidth";ld.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";ld.ml="TaskPaneTitle";ld.Qk="IconCssClass";ld.ZVd="TaskPaneIconUrl";ld.fT="TaskPaneIconId";ld.qI="NonPersistedSettings";ld.onTaskPaneClose="OnTaskPaneClose";ld.bUc="ActionArgs";Object(Lb.a)(ld,"PropertyNames",null,[]);var Ij=b(177),Gj=b(324),bi=b(5);Object(Lb.a)(tc,"UserInfo",null,[]);
var Hk=b(561),yk=b(175),ej=b(84),Gi=b(292);Object(Lb.a)(Ce,"LaunchSDXParams",null,[]);Object(Lb.a)(Md,"RunfromButtonParameters",null,[]);var Nj=b(165),Ek=b(993),sh=b(49),Jj=b(46),Lk=b(176);zc.prototype.GSa=function(F){var ia=ke.AFrameworkApplication.ga.ra("IsO365CommercialHost"),Qa="",Ab="",Ec=!1;var Mc=!(this.Xu.xy&&this.Xu.xy.isSuccess&&this.Xu.xy.value&&(!this.UA||!this.UA.isSuccess));this.Xu.xy&&!this.Xu.xy.isSuccess?(Ab=this.Xu.xy.errorCode,Qa=this.Xu.xy.errorMessage):this.UA&&!this.UA.isSuccess&&
(Ab=this.UA.errorCode,Qa=this.UA.errorMessage);var zd=[];zd.push(Object(Wf.a)(new mg.a,{name:"IsScriptingEnabled",bool:this.bca}));zd.push(Object(Wf.a)(new mg.a,{name:"IsValidHost",bool:ia}));zd.push(Object(Wf.a)(new mg.a,{name:"IsUserLicensed",bool:this.Xu.xy?this.Xu.xy.value:!1}));If.a.EIa||zd.push(Object(Wf.a)(new mg.a,{name:"IsAdminSwitchOn",bool:this.UA?this.UA.value:!1}));zd.push(Object(Wf.a)(new mg.a,{name:"ShowTab",bool:this.bca}));If.a.EIa||zd.push(Object(Wf.a)(new mg.a,{name:"ServiceChecked",
bool:!F}));this.bca&&ii.a.uxa(this.$)&&(F=Nj.a(this.$),(null===F||void 0===F?0:F.Wm)?(zd.push(Object(Wf.a)(new mg.a,{name:"RibbonType",string:"React"})),F.Wm.eCj(bi.a.rHb),F.Wm.gQd(["AutomateAutomateTask"],!If.a.iuf),cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Ec=!0)):(Ab="ribbon_manager_error",Qa="The RibbonManager or RibbonUser is null"));zd.push(Object(Wf.a)(new mg.a,
{name:"Error",string:Qa}));zd.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:Ab}));Ea.a(Ui.a.rGi,Mc,Qi.getElapsedMilliseconds(this.initTime,ai.a.Ta.Wb),zd);this.$.qdb("automateTab",!1);return Promise.resolve(Ec)};zc.prototype.jd=function(F,ia){if(!ia)return!1;ia.MenuItems=this.QNg.rIh(ia.MenuId);return!0};zc.prototype.TZi=function(){var F=this;this.jxa&&(If.a.x6?this.pf.$Mf(this.Kx).continueWith(function(ia){ia.result&&F.Kx.qO(If.a.zQa)}):this.pf.M6i(this.Kx));$b(this.$)?this.g3e(Object(Wf.a)(new O.a,
{IsSuccess:!0,Token:"FakeToken"})):this.Hsa.Wbc().then(function(ia){F.g3e(ia)})};zc.prototype.zfd=function(F,ia,Qa){if(If.a.x6)this.Kx.zfd(F,ia,Qa);else{var Ab=null;if(this.pf.z5a)switch(F){case "1":case "2":case "3":Ab=this.Kx.TF.nR(parseInt(F,10)-1);break;case "4":case "5":case "6":Ab=If.a.vea?this.Kx.TF.nR(parseInt(F,10)-1):this.Kx.TF.GH(F);break;default:Ab=this.Kx.TF.GH(F)}ia[Nb.a.GalleryButtonProps]=Xf.j4c(F,Ab,2===Qa&&!If.a.vea);ia[Nb.a.Alt]=Ab?Ab.name:""}};zc.prototype.Gjd=function(F){if(If.a.x6)this.Kx.Gjd(F);
else{var ia=!1,Qa="",Ab=new jf(F.scriptMetadata),Ec={Operation:"HandleRefreshRibbonGallery"};Ec.RefreshOperation=F.operationName;switch(F.operationName){case If.a.zOf:F=this.Fjd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.xOf:F=this.Djd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.wOf:F=this.Cjd(Ab);Qa=F.message;ia=F.returnValue;break;case If.a.yOf:F=this.Ejd(Ab),Qa=F.message,ia=F.returnValue}(Ec.GalleryUpdated=ia)?(Xa.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",
Qa),this.qO("RefreshGallery")):Xa.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Qa);Ec.Message=Qa;Xa.ULS.sendTraceTag(537170311,0,50,Kg.c(Ec))}};zc.prototype.y5h=function(F,ia,Qa,Ab){if(cg.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.Dq(null,!1,1023))F=new Md(If.a.EVf,F,ia,Qa,this.bca,Ab),this.kpb.gxb(F)};zc.prototype.p7e=function(F,ia,Qa){F=new Md(If.a.TWj,F,ia,Qa,this.bca);
this.kpb.gxb(F)};zc.prototype.n3h=function(F){this.kpb.bjd(If.a.rCj,F)};zc.prototype.m3h=function(F){this.kpb.bjd(If.a.s2g,F)};zc.prototype.o3h=function(F){this.kpb.bjd(If.a.xGj,F)};zc.prototype.usi=function(F,ia){var Qa=sh.b().ti(F),Ab=[];Ab.push(Object(Wf.a)(new mg.a,{name:"SessionId",string:this.$.ya.UserSessionId}));Ab.push(Object(Wf.a)(new mg.a,{name:"MenuItemId",string:ia}));Ab.push(Object(Wf.a)(new mg.a,{name:"WorkbookScriptCount",int64:this.Tj.length}));Ab.push(Object(Wf.a)(new mg.a,{name:"PublishedScriptCount",
int64:this.nq.length}));Ab.push(Object(Wf.a)(new mg.a,{name:"RecentScriptCount",int64:this.tt.length}));Ab.push(Object(Wf.a)(new mg.a,{name:"Command",string:Qa}));ia=ia?this.mhd(ia):null;if(Qa=this.WSh(F,Qa,ia))Ab.push(Object(Wf.a)(new mg.a,{name:If.a.W$,string:Qa.pza.pr[If.a.W$]})),eh.a.instance.RNa(Qa.xzh,"Taskpane",Qa.LHa,Qa.old,Qa.pza),1904816141===F&&(Ab.push(Object(Wf.a)(new mg.a,{name:"ScriptId",string:ia.id})),Ab.push(Object(Wf.a)(new mg.a,{name:"ShareId",string:ia.shareId})),Ab.push(Object(Wf.a)(new mg.a,
{name:"IsPreviewGallery",bool:!!this.Kx.TF.GH(ia.id)})),Ab.push(Object(Wf.a)(new mg.a,{name:"IsOwner",bool:ia.tdf||!!this.nq.GH(ia.id)})),this.$.Bf());Ea.a(Ui.a.oGi,void 0,void 0,Ab)};zc.prototype.WSh=function(F,ia,Qa){var Ab=null,Ec=If.a.Eu,Mc=new Kj.a(If.a.M9e,If.a.YVe,If.a.locale),zd=new ck.a(If.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,If.a.QNd),Ld=new dk.a;Ld.pr.AdminPolicyForFeedback=Kg.c(this.yGa);Ld.pr.DocumentHostInfo=lj.a.Lc(this.$.ya.DocumentHostInfo);Ld.pr.CodeEditorUrl=If.a.Nvb(this.$);
Ld.pr.MakerTestService=cg.EwaSettings.getBooleanFeatureGate(If.a.OCb,!1);Ld.pr[If.a.WUf]=If.a.U3a(this.$);Ld.pr.StorageModePreference=this.x7f||"";Ld.pr.Source="Ribbon";Ld.pr.IsTeams=Og.a.nla;Ld.pr[If.a.o9f]=lj.a.Lc(Ec);Ld.pr[If.a.Fue]=this.$.cuf?"true":"false";Ld.pr[If.a.W$]=Ij.a.create().toString();var ye=ud(this.$),Te=ae(this.$);Ld.ri.HeaderCssClass=ye;Ld.ri.TitleCssClass=Te;Ld.pr[If.a.I8e]=ye;Ld.pr[If.a.t$f]=Te;ye={};ye.ribbonCommand=ia;ye[If.a.v7f]=this.Hsa.getAuthContext();ye[If.a.Sab]=this.pf.ZMf?
this.nq.Veb():null;ye[If.a.EPb]=this.pf.SHd?this.Tj.Veb():null;If.a.x6&&(ye[If.a.zQa]=this.pf.QHd?this.tt.Veb():null);Ld.pr[If.a.Tbf]=lj.a.Lc(ye);ia={};Sb(this.$,ia);Ld.pr[If.a.mVe]=lj.a.Lc(ia);switch(F){case -45542983:Ld.pr.Script="";Ld.pr.Destination="Editor";Ld.pr.IsOwner=!0;Ld.ri[ld.ml]=Cf.a.instance.fa(2078);Ld.ri[ld.taskPaneWidth]=Ec;Ld.ri[ld.sourceLocationOverrideResourceId]=If.a.Nvb(this.$);Ab=If.a.Q1c;break;case -1342227603:Ld.ri[ld.ml]=Cf.a.instance.fa(2080);Ld.ri[ld.taskPaneWidth]=Ec;Ld.ri[ld.sourceLocationOverrideResourceId]=
If.a.s2e(this.$);break;case 971811139:case 1606046412:Ld.pr.Script="";Ld.pr.Destination="BackStage";Ld.pr.IsOwner=!0;Ld.ri[ld.ml]=Cf.a.instance.fa(2078);Ld.ri[ld.taskPaneWidth]=Ec;Ld.ri[ld.sourceLocationOverrideResourceId]=If.a.Nvb(this.$);Ab=If.a.Q1c;break;case 1845457202:Ld.ri[ld.ml]=Cf.a.instance.fa(2079);Ld.ri[ld.taskPaneWidth]=Ec;Ld.ri[ld.sourceLocationOverrideResourceId]=If.a.I2e(this.$);Ab=If.a.Klj;break;case 1904816141:if(Qa)Ld.pr.Script=lj.a.Lc(Qa.PWd()),Ld.pr.Destination="Details",Ld.pr.IsOwner=
Qa.tdf||!!this.nq.GH(Qa.id),Ld.ri[ld.ml]=Cf.a.instance.fa(2078),Ld.ri[ld.taskPaneWidth]=Ec,Ld.ri[ld.sourceLocationOverrideResourceId]=If.a.Nvb(this.$),Ab=If.a.Q1c;else return null;break;default:return null}return new Ce(Mc,zd,Ld,Ab)};zc.prototype.BJh=function(){var F=this;ui.a.instance.lc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(ia){F.yGa.FeedbackEnabled=!0;F.yGa.ScreenshotEnabled=!0;F.yGa.EmailEnabled=!0;ia.eK("Enabled").then(function(Qa){F.yGa.FeedbackEnabled=
Qa},function(){});ia.eK("IncludeScreenshot").then(function(Qa){F.yGa.ScreenshotEnabled=Qa},function(){});ia.eK("IncludeEmail").then(function(Qa){F.yGa.EmailEnabled=Qa},function(){})})};zc.prototype.b6h=function(F){var ia=this,Qa=ai.a.Ta.Wb,Ab=[];if(!F||!F.IsSuccess){var Ec=F?F.ErrorCode:"need_token";F=F?F.ErrorMessage:"No Access Token";Ab.push(Object(Wf.a)(new mg.a,{name:"ServiceChecked",bool:!1}));Ab.push(Object(Wf.a)(new mg.a,{name:"Error",string:F}));Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",
string:Ec}));Ea.a(Ui.a.Uzd,!1,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);this.UA=new Se(!1,!1,void 0,Ec,F);return Promise.resolve(!1)}Ab.push(Object(Wf.a)(new mg.a,{name:"ServiceChecked",bool:!0}));qb(this.$,F.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Mc){ia.UA=new Se(Mc.OfficeScriptingEnabled,!0);ia.pf.ITg(If.a.Kac(ia.$),Mc.OfficeScriptingEnabled);Ab.push(Object(Wf.a)(new mg.a,{name:"IsEnabled",bool:ia.UA.value}));Ea.a(Ui.a.Uzd,!0,Qi.getElapsedMilliseconds(Qa,
ai.a.Ta.Wb),Ab);return Promise.resolve(ia.UA.value)}).catch(function(Mc){Object.getType(Mc)===makerstorage.StorageServiceError?(Ab.push(Object(Wf.a)(new mg.a,{name:"Error",string:Mc.message})),Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Mc.errorCode.toString(),Mc.status.toString())}))):(Ab.push(Object(Wf.a)(new mg.a,{name:"Error",string:Mc.toString()})),Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:"exception"})));Ea.a(Ui.a.Uzd,!1,Qi.getElapsedMilliseconds(Qa,
ai.a.Ta.Wb),Ab);ia.UA=new Se(!1,!1,void 0,"exception",Mc.toString());return Promise.resolve(!1)})};zc.prototype.g3e=function(F){var ia=this;this.pf.kYh(this.Kx);If.a.x6?this.pf.eXh(F,this.Kx,this.cache):this.EWh(F);this.pf.L6i(function(Qa){ia.pf.YYh(Qa,F,ia.Kx)},this.Kx)};zc.prototype.EWh=function(F){var ia=this,Qa=ai.a.Ta.Wb,Ab=[];if(F&&F.IsSuccess){qb(this.$,F.Token);var Ec=Tf.a.create().toString();Ab.push(Object(Wf.a)(new mg.a,{name:"CorrelationId",string:Ec}));makerstorage.getScripts(Ec).then(function(Mc){Ab.push(Object(Wf.a)(new mg.a,
{name:"HasReadCachedScripts",bool:ia.pf.uxb}));ia.nq.clear();Mc=Cl(Mc);for(var zd=Mc.next();!zd.done;zd=Mc.next())ia.nq.Vu(new jf(zd.value));ia.nq.sort();ia.pf.ZMf=!0;ia.pf.kbb=!0;ia.jxa&&(Mc=lj.a.Lc(ia.nq.Veb()),ia.indexedDB.Kcb(new Ek.a(If.a.Sab,Mc)));Ab.push(Object(Wf.a)(new mg.a,{name:"ScriptCount",int64:ia.nq.length}));Ea.a(Ui.a.ZDb,!0,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);ia.qO(If.a.Sab)}).catch(function(Mc){Object.getType(Mc)===makerstorage.StorageServiceError?(Ab.push(Object(Wf.a)(new mg.a,
{name:"Error",string:Mc.message})),Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Mc.errorCode.toString(),Mc.status.toString())})),17===Mc.errorCode&&ia.cache.yJd(If.a.Kac(ia.$))):(Ab.push(Object(Wf.a)(new mg.a,{name:"Error",string:Mc.toString()})),Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:"exception"})));Ea.a(Ui.a.ZDb,!1,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);ia.pf.kbb=!0;ia.qO(If.a.Sab)})}else Ec=F?F.ErrorCode:"need_token",F=F?F.ErrorMessage:
"No Access Token",Ab.push(Object(Wf.a)(new mg.a,{name:"ServiceChecked",bool:!1})),Ab.push(Object(Wf.a)(new mg.a,{name:"Error",string:F})),Ab.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:Ec})),Ea.a(Ui.a.ZDb,!1,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab),this.pf.kbb=!0,this.qO(If.a.Sab)};zc.prototype.mhd=function(F){if(If.a.x6)return this.Kx.mhd(F);switch(F){case "1":case "2":case "3":return this.Kx.TF.nR(parseInt(F,10)-1);default:return!If.a.vea||"4"!==F&&"5"!==F&&"6"!==F?this.nq.GH(F)||this.Tj.GH(F)||
this.NB.GH(F):this.Kx.TF.nR(parseInt(F,10)-1)}};zc.prototype.Fjd=function(F){if(this.nq.Vu(F)){this.nq.sort();var ia=""}else{ia="";var Qa=F.u0a();this.Tj.Rfb(Qa);this.Tj.sort();this.nq.Rfb(F);this.nq.sort()}return{returnValue:!0,message:ia}};zc.prototype.Djd=function(F){this.Tj.K1a(F.id);return this.nq.K1a(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};zc.prototype.Cjd=function(F){var ia=F.u0a();ia.shareId=null;
this.nq.Vu(ia)&&this.nq.sort();return this.Tj.Vu(F)?(this.Tj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};zc.prototype.Ejd=function(F){return this.Tj.K1a(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};zc.prototype.qO=function(F){if(If.a.x6)this.Kx.qO(F);else{this.aId();this.$.Bf();var ia=[];ia.push(Object(Wf.a)(new mg.a,{name:"Operation",string:F}));
ia.push(Object(Wf.a)(new mg.a,{name:"HasReadCachedScripts",bool:this.pf.uxb}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadScriptsDone",bool:this.pf.mkd}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadSamplesScriptsDone",bool:this.pf.vHb}));ia.push(Object(Wf.a)(new mg.a,{name:"SamplesScriptCount",int64:this.NB.length}));ia.push(Object(Wf.a)(new mg.a,{name:"ReadPublishedScriptsDone",bool:this.pf.kbb}));ia.push(Object(Wf.a)(new mg.a,{name:"PublishedScriptCount",int64:this.nq.length}));ia.push(Object(Wf.a)(new mg.a,
{name:"ReadWorkbookScriptsDone",bool:this.pf.mX}));ia.push(Object(Wf.a)(new mg.a,{name:"WorkbookScriptCount",int64:this.Tj.length}));Ea.a(Ui.a.huf,!0,0,ia)}};zc.prototype.aId=function(){this.Kx.TF=new Ef([],function(){});for(var F=this.Tj?this.Tj.length:0,ia=this.nq?this.nq.length:0,Qa=this.NB?this.NB.length:0,Ab=0,Ec=If.a.vea?6:If.a.pJf,Mc=0;Mc<Ec;Mc++)if(Mc<F)this.Kx.TF.Vu(this.Tj.nR(Mc));else if(Mc-F+Ab<ia){var zd=this.nq.nR(Mc-F+Ab);this.Tj.GH(zd.id)?(Ab++,Mc--):this.Kx.TF.Vu(zd)}else Mc-F-ia+
Ab<Qa&&this.Kx.TF.Vu(this.NB.nR(Mc-F+Ab-ia))};zc.prototype.cLd=function(F){cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(F?(Jj.PageLoadTrackingInfo.instance.C7(bi.a.xO,["automateTab"]),Jj.PageLoadTrackingInfo.instance.tX(bi.a.xO,["automateTab"]),Jj.PageLoadTrackingInfo.instance.DS(bi.a.xO,["automateTab"])):(Jj.PageLoadTrackingInfo.instance.Nda(bi.a.xO,["automateTab"]),
cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Lk.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(bi.a.rHb))))};Ck.Object.defineProperties(zc.prototype,{nq:{configurable:!0,enumerable:!0,get:function(){return this.pf.nq}},Tj:{configurable:!0,enumerable:!0,get:function(){return this.pf.Tj}},NB:{configurable:!0,enumerable:!0,get:function(){return this.pf.NB}},tt:{configurable:!0,enumerable:!0,get:function(){return this.pf.tt}},Sa:{configurable:!0,
enumerable:!0,get:function(){return this.DQc}},z5a:{configurable:!0,enumerable:!0,get:function(){return this.pf.z5a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Xqg}},bca:{configurable:!0,enumerable:!0,get:function(){var F=!!this.Xu.xy&&this.Xu.xy.isSuccess&&this.Xu.xy.value,ia=!!this.UA&&!this.UA.isSuccess,Qa=!!this.UA&&this.Xu.xy.isSuccess&&this.UA.value;ia=If.a.EIa||Qa||ia&&!Og.a.ila(11);return this.$if&&F&&ia}},$if:{configurable:!0,enumerable:!0,get:function(){var F="TestHost"===
this.$.ya.DocumentHostInfo.HostTier,ia=ke.AFrameworkApplication.ga.Va("UserPrincipalName");ia=!ke.AFrameworkApplication.ga.ra("IsAnonymousUser")&&!!ia&&!ia.includes("ext#")&&!ia.includes("guest#");return!Og.a.bla&&(F||this.Hsa.jYc&&ia)}}});Object(Lb.a)(zc,"AutomateCommandManager",null,[802]);var Wi=b(1402),Oj=b(1354),hk=b(244);jc.key="InsertAgaveClientSideParametersKey";Object(Lb.a)(jc,"InsertAgaveClientSideParameters",null,[]);var nj=b(51),Ik=b(104),Ii=b(21),Rk=b(1164);vg.prototype.gxb=function(F){if(F.bca){var ia=
[];ia.push(Object(Wf.a)(new mg.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.I7a}));ia.push(Object(Wf.a)(new mg.a,{name:"actionName",string:F.actionName}));ia.push(Object(Wf.a)(new mg.a,{name:If.a.W$,string:F.clickId.toString()}));this.I7a?this.YXf(F):this.V3h(F);Ea.a(Ui.a.pGi,void 0,void 0,ia)}};vg.prototype.bjd=function(F,ia){var Qa={};Qa[If.a.W$]=ia;this.COd(F,Qa)};vg.prototype.wvj=function(){this.Y2f()?this.CIf():Ii.g(this.$).Ea.Sne(this.S9a)};vg.prototype.Y2f=function(){if(this.I7a||
$b(this.$))return!1;var F=Ik.a(this.$);return Ii.g(this.$).Ea.E_b&&F.Ofi()};vg.prototype.CIf=function(){var F=this;this.Xu.xy?this.Xu.xy.value&&this.Hsa.Wbc():this.Xu.L0c().then(function(ia){ia&&F.Hsa.Wbc()});Ea.a(Ui.a.kGi)};vg.prototype.Snj=function(){var F=Ij.a.create().toString(),ia={};Sb(this.$,ia);var Qa={};Qa[If.a.v7f]=this.Hsa.getAuthContext();var Ab={};Ab[If.a.mVe]=lj.a.Lc(ia);Ab[If.a.Tbf]=lj.a.Lc(Qa);Ab[If.a.Zhh]=lj.a.Lc(this.$.ya.DocumentHostInfo);Ab[If.a.EGj]=pa(this.$);Ab[If.a.o9f]=lj.a.Lc(If.a.Eu);
Ab[If.a.Fue]=this.$.cuf?"true":"false";Ab[If.a.WUf]=If.a.U3a(this.$);Ab[If.a.I8e]=ud(this.$);Ab[If.a.t$f]=ae(this.$);Ab[If.a.W$]=F;ia=[];ia.push(Object(Wf.a)(new mg.a,{name:If.a.W$,string:F}));Ea.a(Ui.a.nGi,void 0,void 0,ia);this.COd(If.a.Dai,Ab)};vg.prototype.V3h=function(F){var ia=this;this.Tzj(F);$b(this.$)&&qb(this.$,"localstorage");mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.Ua(this.$.da,374,375,1),function(Qa){ia.Zti(Qa.result).continueWith(function(){ia.Rnj(F)});ia.I7a=!0},this.$.la,3)};
vg.prototype.Zti=function(F){var ia={};ia.SolutionId=If.a.solutionId;ia.Version=If.a.QNd;ia.StoreType=OSF.StoreType.Sdx;ia.StoreId=OSF.StoreType.Sdx;ia.AssetId=If.a.solutionId;ia.AssetStoreId=OSF.StoreType.Sdx;ia.TargetType=1;ia.SharedRuntimeId=If.a.Bwb(this.$);ia.SourceLocationOverrideResourceId=If.a.Bwb(this.$);ia.IsToBePersisted=!1;var Qa=new Wi.a;Qa.ml=Cf.a.instance.fa(2099);Qa.taskPaneWidth=If.a.Eu;var Ab=new jc;Ab.ENb=ae(this.$);Ab.xba=ud(this.$);return F.ANd(ia,Qa,void 0,void 0,Ab)};vg.prototype.Rnj=
function(F){this.Snj();hk.a(this.$)&&hk.a(this.$).eoe(this.wJi);this.YXf(F)};vg.prototype.YXf=function(F){var ia={};ia[If.a.Yjj]=F.shapeId;ia[If.a.Xjj]=F.scriptLink;ia[If.a.W$]=F.clickId.toString();ia[If.a.Wjj]=F.buttonText;this.COd(F.actionName,ia)};vg.prototype.COd=function(F,ia){var Qa=new ck.a(If.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,If.a.QNd),Ab=new Kj.a(If.a.M9e,If.a.YVe,this.$.ya.UICultureTag),Ec=new dk.a;Ec.ri[ld.ml]=Cf.a.instance.fa(2099);Ec.ri[ld.sourceLocationOverrideResourceId]=
If.a.Bwb(this.$);Ec.ri[ld.bUc]=ia;Ec.ri[ld.taskPaneWidth]=If.a.Eu;eh.a.instance.RNa(Qa,Oj.a.action,F,Ab,Ec)};vg.prototype.Tzj=function(F){cg.EwaSettings.getBooleanFeatureGate(If.a.p9f,!1)&&F.actionName===If.a.EVf&&(F=new Rk.a(F.scriptLink,"initializing",F.clickId.toString(),F.buttonText),this.businessBarManager.Yme(63,F))};Object(Lb.a)(vg,"AutomateCommandRunFromButton",null,[801]);var Dk=b(161),Jk=b(22);qf.jEj=function(F){F.sort(function(ia,Qa){return Qa.cHe-ia.cHe})};qf.fUd=function(F){F.sort(function(ia,
Qa){return Jk.a.compare(ia.name,Qa.name,!0)})};qf.MZh=function(F){var ia;var Qa=ia=null;if(F){var Ab=F.indexOf(":");if(-1!==Ab)return ia=F.substr(0,Ab),Qa=F.substr(Ab+1),{returnValue:!0,w7f:ia,shareId:Qa}}return{returnValue:!1,w7f:ia,shareId:Qa}};qf.JYh=function(F,ia){var Qa={};Qa[If.a.zhg]=encodeURIComponent(F.workbookContext.WorkbookFileName);Qa[If.a.gXf]=ia.Veb();return Kg.c(Qa)};qf.cNf=function(F,ia){return mi.TaskExtensions.wia(ia.r4a(If.a.EPb),function(Qa){Qa=Qa.result;if(""!==Qa){Qa=Kg.b(Qa);
var Ab=Qa[If.a.gXf];if(Qa[If.a.zhg]===encodeURIComponent(F.workbookContext.WorkbookFileName)){Qa=new Ef([],function(Mc){qf.fUd(Mc)});Ab=Cl(Ab);for(var Ec=Ab.next();!Ec.done;Ec=Ab.next())Qa.Vu(new jf(Ec.value));Qa.sort();return Qa}}},F.la,3)};Ck.Object.defineProperties(qf.prototype,{z5a:{configurable:!0,enumerable:!0,get:function(){var F=If.a.x6?this.$dc:this.uxb;return this.vHb||F||this.mkd}},mkd:{configurable:!0,enumerable:!0,get:function(){return(If.a.x6?this.lbb:this.kbb)&&this.mX&&this.vHb}}});
Object(Lb.a)(qf,"AutomateCommandStorageBase",null,[]);var Sk=b(119),zk=b(98);Am(Lf,qf);Lf.prototype.ITg=function(F,ia){if(this.cache.Mg()){var Qa={};Qa.TimeStamp=ai.a.Ta.Wb;Qa.IsEnabled=ia;this.cache.NPd(F,lj.a.Lc(Qa))}};Lf.prototype.xLh=function(F){var ia=!1,Qa=!1,Ab=null;this.cache.Mg()&&(F=Kg.b(this.cache.iwb(F)))&&(Qa=F.IsEnabled,Ab=new Date(F.TimeStamp),ia=!0);return new Se(Qa,ia,Ab)};Lf.prototype.$Mf=function(F){var ia=this,Qa=ai.a.Ta.Wb,Ab=[];return mi.TaskExtensions.wia(this.indexedDB.r4a(If.a.zQa),
function(Ec){var Mc=!ia.lbb||!ia.tt.length;Ec=Ec.result;Ab.push(Object(Wf.a)(new mg.a,{name:"ExistingScriptCount",int64:ia.tt.length}));if(""!==Ec&&(Ec=Kg.b(Ec),Ab.push(Object(Wf.a)(new mg.a,{name:"CachedScriptCount",int64:Ec.length})),Mc)){for(var zd=Cl(Ec),Ld=zd.next();!Ld.done;Ld=zd.next())ia.tt.Vu(new jf(Ld.value));ia.$dc=!0;ia.QHd=0<Ec.length;Ea.a(Ui.a.fuf,Mc,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);ia.yId(F);return!0}Ea.a(Ui.a.fuf,Mc,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);return!1},
this.$.la,3)};Lf.prototype.M6i=function(F){cg.EwaSettings.getBooleanFeatureGate(If.a.wYc,!1)&&this.S6i(F);If.a.x6?this.$Mf(F):this.K6i(F)};Lf.prototype.eXh=function(F,ia,Qa){var Ab=this,Ec=ai.a.Ta.Wb,Mc=[];if(F&&F.IsSuccess){qb(this.$,F.Token);var zd=Tf.a.create().toString();Mc.push(Object(Wf.a)(new mg.a,{name:"CorrelationId",string:zd}));makerstorage.getRecentScripts(zd).then(function(Ld){Mc.push(Object(Wf.a)(new mg.a,{name:"HasReadCachedScripts",bool:Ab.$dc}));Ab.tt.clear();Ld=Cl(Ld);for(var ye=
Ld.next();!ye.done;ye=Ld.next())Ab.tt.Vu(new jf(ye.value));Ab.QHd=!0;Ab.lbb=!0;Ab.indexedDB.Mg()&&(Ld=lj.a.Lc(Ab.tt.Veb()),Ab.indexedDB.Kcb(new Ek.a(If.a.zQa,Ld)));Mc.push(Object(Wf.a)(new mg.a,{name:"ScriptCount",int64:Ab.tt.length}));Ea.a(Ui.a.ZDb,!0,Qi.getElapsedMilliseconds(Ec,ai.a.Ta.Wb),Mc);ia.qO(If.a.zQa)}).catch(function(Ld){Object.getType(Ld)===makerstorage.StorageServiceError?(Mc.push(Object(Wf.a)(new mg.a,{name:"Error",string:Ld.message})),Mc.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",
string:String.format("makerstorage_{0}_{1}",Ld.errorCode.toString(),Ld.status.toString())})),17===Ld.errorCode&&Qa.yJd(If.a.Kac(Ab.$))):(Mc.push(Object(Wf.a)(new mg.a,{name:"Error",string:Ld.toString()})),Mc.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:"exception"})));Ea.a(Ui.a.lGi,!1,Qi.getElapsedMilliseconds(Ec,ai.a.Ta.Wb),Mc);Ab.lbb=!0;ia.qO(If.a.zQa)})}else zd=F?F.ErrorCode:"need_token",F=F?F.ErrorMessage:"No Access Token",Mc.push(Object(Wf.a)(new mg.a,{name:"ServiceChecked",bool:!1})),
Mc.push(Object(Wf.a)(new mg.a,{name:"Error",string:F})),Mc.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:zd})),Ea.a(Ui.a.ZDb,!1,Qi.getElapsedMilliseconds(Ec,ai.a.Ta.Wb),Mc),this.lbb=!0,ia.qO(If.a.zQa)};Lf.prototype.L6i=function(F,ia){var Qa=this,Ab=new Dk.a,Ec=Rb(this.$);Ie(this.$,function(Mc){if((Mc=Mc.Result)&&200===Mc.ResponseStatusCode)Mc=Mc.ResponseBody.join(""),Mc=JSON.parse(Mc),F(Qa.VXi(Mc.value)),Ab.setResult(!0);else{Mc=Mc?"RichApi_"+Mc.ResponseStatusCode:"RichApiError";var zd=[];zd.push(Object(Wf.a)(new mg.a,
{name:"Error",string:"Failed to read shared script ids from document"}));zd.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:Mc}));Qa.mX=!0;Qa.i0a(ia,ai.a.Ta.Wb,0,zd);Ab.setResult(!1)}},function(Mc){Mc=Sk.a.pg(Mc.data);Xa.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var zd=[];zd.push(Object(Wf.a)(new mg.a,{name:"Error",string:"Failure using rich api: "+Mc}));zd.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:"RichApiFailure"}));Qa.mX=!0;
Qa.i0a(ia,ai.a.Ta.Wb,0,zd);Ab.setResult(!1)},Ec,Ab)};Lf.prototype.YYh=function(F,ia,Qa){var Ab=this,Ec=ai.a.Ta.Wb,Mc=0,zd=0;this.mX=Mc===F.count;var Ld=[];Ld.push(Object(Wf.a)(new mg.a,{name:"ScriptIds",int64:F.count}));if(F.count)if(ia&&ia.IsSuccess){qb(this.$,ia.Token);var ye={};ia=Cl(F);for(var Te=ia.next();!Te.done;ye={Bgb:ye.Bgb},Te=ia.next())Te=Te.value,ye.Bgb=Tf.a.create().toString(),makerstorage.getSharedScript(Te.value,ye.Bgb).then(function(rf){return function(dg){var Jg=[];Jg.push(Object(Wf.a)(new mg.a,
{name:"BodySize",int64:dg.body.length}));Jg.push(Object(Wf.a)(new mg.a,{name:"CorrelationId",string:rf.Bgb}));Ea.a(Ui.a.guf,!0,Qi.getElapsedMilliseconds(Ec,ai.a.Ta.Wb),Jg);Mc++;dg=new jf(dg);dg.shareId=F.oa(dg.id);Ab.Tj.Vu(dg);Ab.mX=Mc===F.count;Ab.SHd=!0;Ab.i0a(Qa,Ec,zd,Ld)}}(ye)).catch(function(rf){return function(dg){var Jg=[];Object.getType(dg)===makerstorage.StorageServiceError?(Ld.push(Object(Wf.a)(new mg.a,{name:"Error",string:dg.message})),Ld.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",
dg.errorCode.toString(),dg.status.toString())}))):(Jg.push(Object(Wf.a)(new mg.a,{name:"Error",string:dg.toString()})),Jg.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:"exception"})));Jg.push(Object(Wf.a)(new mg.a,{name:"CorrelationId",string:rf.Bgb}));Ea.a(Ui.a.guf,!1,Qi.getElapsedMilliseconds(Ec,ai.a.Ta.Wb),Jg);Mc++;zd++;Ab.mX=Mc===F.count;Ab.i0a(Qa,Ec,zd,Ld)}}(ye)).finally(function(){if(cg.EwaSettings.getBooleanFeatureGate(If.a.wYc,!1)&&Ab.indexedDB.Mg()&&Ab.mX){var rf=qf.JYh(Ab.$,Ab.Tj);
Ab.indexedDB.Kcb(new Ek.a(If.a.EPb,rf))}})}else ye=ia?ia.ErrorCode:"need_token",ia=ia?ia.ErrorMessage:"No Access Token",Ld.push(Object(Wf.a)(new mg.a,{name:"Error",string:ia})),Ld.push(Object(Wf.a)(new mg.a,{name:"ErrorCode",string:ye})),this.mX=!0,this.i0a(Qa,Ec,zd,Ld);else this.mX=this.SHd=!0,this.i0a(Qa,Ec,zd,Ld),cg.EwaSettings.getBooleanFeatureGate(If.a.wYc,!1)&&mi.TaskExtensions.wia(qf.cNf(this.$,this.indexedDB),function(rf){rf.result&&(Ab.indexedDB.I6c(If.a.EPb),Ab.Tj.clear(),Qa.qO("CachedScripts"))},
this.$.la,3)};Lf.prototype.kYh=function(F){var ia={id:"samples-6"};ia.name=Cf.a.instance.fa(2095);this.NB.Vu(new jf(ia));ia.id="samples-8";ia.name=Cf.a.instance.fa(2096);this.NB.Vu(new jf(ia));ia.id="samples-2";ia.name=Cf.a.instance.fa(2092);this.NB.Vu(new jf(ia));ia.id="samples-4";ia.name=Cf.a.instance.fa(2093);this.NB.Vu(new jf(ia));ia.id="samples-5";ia.name=Cf.a.instance.fa(2094);this.NB.Vu(new jf(ia));If.a.vea&&(ia.id="samples-9",ia.name=Cf.a.instance.fa(2097),this.NB.Vu(new jf(ia)));this.vHb=
!0;F.qO("SampleScripts")};Lf.prototype.VXi=function(F){var ia=new zk.a;if(F=this.d2a.parseFromString(F,"text/xml").querySelector('[id="script-ids-node-id"]')){F=F.getElementsByTagName("scriptId");for(var Qa={},Ab=0;Ab<F.length;Qa={rQb:Qa.rQb,oQb:Qa.oQb,jQb:Qa.jQb},Ab++)Qa.rQb=F[Ab].getAttribute("id"),Qa.rQb&&(Qa.oQb=void 0,Qa.jQb=void 0,function(Ec){return function(){var Mc=qf.MZh(Ec.rQb);Ec.oQb=Mc.w7f;Ec.jQb=Mc.shareId;return Mc}}(Qa)().returnValue&&ia.ia(Qa.oQb,Qa.jQb))}return ia};Lf.prototype.S6i=
function(F){var ia=this,Qa=ai.a.Ta.Wb,Ab=[];mi.TaskExtensions.wia(qf.cNf(this.$,this.indexedDB),function(Ec){var Mc=Ec.result;Ab.push(Object(Wf.a)(new mg.a,{name:"ExistingScriptCount",int64:ia.Tj.length}));if(Mc){Ab.push(Object(Wf.a)(new mg.a,{name:"CachedScriptCount",int64:Mc.length}));if(Ec=!ia.mX||0===ia.Tj.length){Mc=Cl(Mc.getScripts());for(var zd=Mc.next();!zd.done;zd=Mc.next())ia.Tj.Vu(zd.value);ia.Tj.sort();Ea.a(Ui.a.Vzd,Ec,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);ia.yId(F);return!0}Ea.a(Ui.a.Vzd,
Ec,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab)}else Ea.a(Ui.a.Vzd,!1,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);return!1},this.$.la,3)};Lf.prototype.K6i=function(F){var ia=this,Qa=ai.a.Ta.Wb,Ab=[];mi.TaskExtensions.wia(this.indexedDB.r4a(If.a.Sab),function(Ec){var Mc=!ia.kbb||!ia.nq.length;Ec=Ec.result;Ab.push(Object(Wf.a)(new mg.a,{name:"ExistingScriptCount",int64:ia.nq.length}));if(""!==Ec&&(Ec=Kg.b(Ec),Ab.push(Object(Wf.a)(new mg.a,{name:"CachedScriptCount",int64:Ec.length})),Mc)){Ec=Cl(Ec);
for(var zd=Ec.next();!zd.done;zd=Ec.next())ia.nq.Vu(new jf(zd.value));ia.nq.sort();Ea.a(Ui.a.euf,Mc,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);ia.yId(F);return!0}Ea.a(Ui.a.euf,Mc,Qi.getElapsedMilliseconds(Qa,ai.a.Ta.Wb),Ab);return!1},this.$.la,3)};Lf.prototype.i0a=function(F,ia,Qa,Ab){this.mX&&(Ab.push(Object(Wf.a)(new mg.a,{name:"ScriptCount",int64:this.Tj.length})),Ab.push(Object(Wf.a)(new mg.a,{name:"ScriptErrorCount",int64:Qa})),Ea.a(Ui.a.mGi,!Qa,Qi.getElapsedMilliseconds(ia,ai.a.Ta.Wb),Ab),
this.Tj.sort(),F.qO(If.a.EPb))};Lf.prototype.yId=function(F){this.uxb=!0;F.qO("CachedScripts")};Object(Lb.a)(Lf,"AutomateCommandStorage",qf,[]);var el=zi.a;Am(Ig,el);Ig.prototype.create=function(){var F=this,ia=nj.GetServiceTaskFactory.Ua(this.$.da,349,350,this.ub),Qa=Vf.a.loadScript(109,4,this.ub,void 0,void 0,351),Ab=nj.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.ub),Ec=nj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.ub),Mc=nj.GetServiceTaskFactory.Ua(this.$.da,5,4,this.ub);
mi.TaskExtensions.Ba(mi.TaskExtensions.xe([ia,Qa,Ab,Ec,Mc],this.la,3),function(){var zd=ia.result,Ld=Ec.result,ye=Mc.result,Te=new Vc,rf=new Wb(F.$,zd,Te),dg=new Lf(F.$,Ld),Jg=new Af(F.$,dg);ye=new vg(F.$,rf,Te,ye);F.Eb(F.$.da.Aa(352)||new zc(F.$,zd,Ab.result,Ld,ye,Te,rf,dg,Jg))},this.la,3)};Ig.ka=function(F){F&&F.da.Ga(351,new Ig(F))};Object(Lb.a)(Ig,"AutomateCommandManagerFactory",zi.a,[]);var Tk=b(103),rl=b(1355),$k=b(186),rk=b(55);Re.prototype.$c=function(){return!1};Re.prototype.executeCommand=
function(F,ia,Qa){F=!1;switch(ia.command){case 73979048:this.qsb&&this.qsb.L0i(ia,Tk.a.instance,ke.AFrameworkApplication.ga,Qa),F=!0}return F?rk.Task.Ra(!0):$k.a(ia.command)};Re.prototype.Kc=function(F,ia){return 73979048===ia.command&&cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};Re.prototype.jd=function(){return!1};Re.prototype.dispose=function(){this.qsb&&this.qsb.dispose()};Object(Lb.a)(Re,"DataFromPictureCommandHandler",null,[424,2]);var sk=Qj.a;Am(ie,
sk);ie.prototype.Nd=function(){var F=this,ia=nj.GetServiceTaskFactory.Ua(this.$.da,328,327,1),Qa=nj.GetServiceTaskFactory.Ua(this.$.da,484,485,1);mi.TaskExtensions.Ba(mi.TaskExtensions.xe([ia,Qa],this.$.la),function(){F.Dd([new Re(F.$,ia.result,Qa.result)])},this.$.la,3)};ie.ka=function(F){Qj.a.he(452,new ie(F))};Object(Lb.a)(ie,"DataFromPictureCommandHandlerFactory",Qj.a,[]);var Eg=b(929),tk=b(91),Zi=b(905);gg.ND=function(F,ia,Qa){Qa?gg.Wc(F,ia):gg.Al(F,ia)};gg.Wc=function(F,ia){if(!Zi.c(F)){var Qa=
F.className;if(Zi.c(Qa)||-1===Qa.indexOf(ia))ia=Qa.trim()+" "+ia,ia=ia.trim(),F.className=ia}};gg.Al=function(F,ia){if(!(Zi.c(F)||Zi.c(ia)||Zi.c(F.className))){var Qa=F.className;Qa!==Qa.replace(ia,"")&&(F.className=Qa.replace(ia,""))}};gg.Q7=function(F,ia,Qa,Ab){Qa=void 0===Qa?!1:Qa;Ab=void 0===Ab?!1:Ab;Zi.c(F)||Qa||(gg.ND(F,"cui-disabled",!ia),ia=ia?tk.a.Xo:tk.a.yj,tk.a.dh(F,tk.a.Dha,ia),Ab&&tk.a.dh(F,tk.a.JXc,ia))};Object(Lb.a)(gg,"Helper",null,[]);Ne.prototype.UUh=function(F){Xa.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",F);for(var ia=new sg.a,Qa=Cl(this.D1b),Ab=Qa.next();!Ab.done;Ab=Qa.next()){Ab=Cl(Ab.value.WDb);for(var Ec=Ab.next();!Ec.done;Ec=Ab.next())Ec=Ec.value,Ec.id===F&&ia.add(Ec)}return ia};Ne.prototype.pme=function(F){this.D1b.add(F)};Ne.prototype.$$i=function(F){for(var ia=Cl(this.D1b),Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa=Qa.value,Qa.dqe===F.dqe){this.D1b.remove(Qa);break}};Ne.Wfh=function(F,ia,Qa){Qa=void 0===Qa?null:Qa;F=Ne.eNh(F);0<F.length&&(Ne.Dwc(F,!1),Qa&&Qa(ia,
F))};Ne.eNh=function(F){var ia=[];if(F&&F.WDb&&0<F.WDb.count){F=Cl(F.WDb);for(var Qa=F.next();!Qa.done;Qa=F.next())if(Qa=Qa.value,Qa.controls&&0<Qa.controls.count){Qa=Cl(Qa.controls);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,Ab.menuItems&&0<Ab.menuItems.count){Ab=Cl(Ab.menuItems);for(var Ec=Ab.next();!Ec.done;Ec=Ab.next())Array.add(ia,Ec.value.id)}}}return ia};Ne.Dwc=function(F,ia){if(F.length){F=Cl(F);for(var Qa=F.next();!Qa.done;Qa=F.next())Qa=document.querySelector('[id^="'+Qa.value+
'"]'),gg.Q7(Qa,ia)}};Ck.Object.defineProperties(Ne.prototype,{D1b:{configurable:!0,enumerable:!0,get:function(){return this.Amg}}});Object(Lb.a)(Ne,"ContextMenuExtensibilityCache",null,[233,234]);var Uk=b(1476),Mk=b(1078),fl=b(966),jj=b(937),gl=b(974),tj=gl.a;Am(pe,tj);pe.prototype.clone=function(){var F=new pe;F.$md=this.$md;F.Fmd=this.Fmd;F.ribbon=this.ribbon;return F};Object(Lb.a)(pe,"RibbonBuildContext",gl.a,[]);ef.prototype.lha=function(F,ia,Qa){ia=void 0===ia?null:ia;Qa=void 0===Qa?null:Qa;
var Ab=fl.Builder.s4b(F);if(Zi.c(Ab))Qa&&Qa(!1);else if(F=new pe,F.Fmd=this.V9.homeTab.id,F.$md=this.V9.homeTab,F.ribbon=this.V9,Ab=new jj.a(Ab),Ab=jj.a.XV(Ab.node,jj.a.W1d),Zi.c(Ab))Qa&&Qa(!1);else{Ab=jj.a.Mm(Ab);for(var Ec=0;Ec<Ab.length;Ec++){var Mc=Ab[Ec],zd=(new jj.a(Mc)).attributes[jj.a.id];if(this.V9.eba(zd))this.oWb.g_j(zd,Mc,F);else{var Ld=-1;ia&&(Ld=this.BCh(zd,ia));-1!==Ld?this.oWb.GDg(Mc,F,Ld):this.oWb.GDg(Mc,F)}}Qa&&Qa(!0)}};ef.prototype.BCh=function(F,ia){F=Array.indexOf(ia,F);if(-1===
F)return-1;--F;for(var Qa=-1;0<=F;){Qa=this.bSh(ia[F]);if(-1!==Qa)break;F--}return Qa+1};ef.prototype.bSh=function(F){for(var ia=0,Qa=!1,Ab=Cl(this.V9.children),Ec=Ab.next();!Ec.done;Ec=Ab.next()){Ec=Ec.value;if(Ec.id===F){Qa=!0;break}Ec.visible&&ia++}return Qa?ia:-1};ef.prototype.Hbb=function(F){F=fl.Builder.s4b(F);if(!Zi.c(F)&&(F=new jj.a(F),F=jj.a.XV(F.node,jj.a.W1d),!Zi.c(F))){F=jj.a.Mm(F);for(var ia=0;ia<F.length;ia++){var Qa=F[ia],Ab=(new jj.a(Qa)).attributes[jj.a.id];Qa=jj.a.XV(Qa,jj.a.Vgb);
Qa=jj.a.Mm(Qa);for(var Ec=0;Ec<Qa.length;Ec++){var Mc=jj.a.B1e(Qa[Ec],jj.a.id);Zi.c(Mc)||this.oWb.O0j(Ab,Mc)}}}};Object(Lb.a)(ef,"RibbonExtensibilityBuilder",null,[]);var Kk=b(906);Ue.prototype.lha=function(F,ia){ia=void 0===ia?null:ia;var Qa=F.vXe();this.ige.lha(Qa,F.S$a,ia)};Ue.prototype.Hbb=function(F){F=F.vXe();this.ige.Hbb(F)};Ue.egh=function(F,ia,Qa){Qa=void 0===Qa?null:Qa;F=Ue.PXh(F);0<F.length&&(Ue.Dwc(F,!1),Qa&&Qa(ia,F))};Ue.PXh=function(F){var ia=[];if(F){var Qa=F.UW;if(!Qa){if(F.tabs&&
0<F.tabs.count)for(F=Cl(F.tabs),Qa=F.next();!Qa.done;Qa=F.next())if(Qa=Qa.value,0<Qa.pK.count){var Ab=Cl(Qa.pK);for(Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,0<Qa.xia.count){var Ec=Cl(Qa.xia);for(Qa=Ec.next();!Qa.done;Qa=Ec.next())Array.add(ia,Qa.value.id)}}}else if(Qa.Qr&&0<Qa.Qr.count)for(F=Cl(Qa.Qr),Qa=F.next();!Qa.done;Qa=F.next())if(Qa=Qa.value,Qa.groups&&0<Qa.groups.length)for(Ab=Cl(Qa.groups),Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,Qa.controls&&0<Qa.controls.length)for(Ec=
Cl(Qa.controls),Qa=Ec.next();!Qa.done;Qa=Ec.next())Array.add(ia,Qa.value.id)}return ia};Ue.Dwc=function(F,ia){if(F.length){F=Cl(F);for(var Qa=F.next();!Qa.done;Qa=F.next())Qa=document.querySelector('[id^="'+Qa.value+'"]'),Kk.a.Q7(Qa,ia)}};Object(Lb.a)(Ue,"RibbonExtensibilityManager",null,[240]);var uk=b(1138);rd.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(F,ia){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(F,ia)};rd.prototype.$id=function(F,ia,
Qa,Ab,Ec,Mc,zd){Mc=void 0===Mc?null:Mc;zd=void 0===zd?null:zd;Xa.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",F);if((F=ia.O4(Ec.ownerAddinInfo.storeType,Ec.ownerAddinInfo.solutionId))&&F.HB&&!F.HB.getIsUpgrading())if(ia=null,0<F.HB.getNotificationParams().length&&(ia=this.Dve(F.HB.getNotificationParams()[0]),ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&ia&&2147758681===ia.errorCode&&(F.isUpgraded=!0),ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",
!1)&&ia&&2147758681===ia.errorCode&&Xa.ULS.sendTraceTag(529278163,220,50,"Upgrade")),2!==F.HB.getStatus()&&(1!==F.HB.getStatus()||ia&&2147758681===ia.errorCode))ia&&this.H3f(F,ia,zd);else try{Qa.setOwnerAddinEToken(F.HB.getEToken()),Ec.action(Qa,Ab.Xca),Mc&&Mc()}catch(Ld){Xa.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",ke.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ld.stack:Ld.message)),uk.a.xSd(CommonUIStrings.l_InternalError+
" "+CommonUIStrings.l_InternalError_Directive)}};rd.prototype.H3f=function(F,ia,Qa){var Ab=this;Qa=void 0===Qa?null:Qa;var Ec=F.HB;if(1===Ec.getNotificationParams().length||ia.Aec){var Mc=ia.Wha,zd=ia.Oia;ia.Wha=function(){Ec.removeFirstNotification();if(0<Ec.getNotificationParams().length){var Ld=Ab.Dve(Ec.getNotificationParams()[0]);Ab.H3f(F,Ld)}2147758681===ia.errorCode&&(Ue.egh(F.Ko,Ec,Object(od.a)(Ab,Ab.zaf,"initUpgradeStateDetectTask")),Ne.Wfh(F.rrb,Ec,Object(od.a)(Ab,Ab.zaf,"initUpgradeStateDetectTask")));
Mc&&Mc()};ia.Oia=function(){zd&&zd();Qa&&Qa()};uk.a.zSd(ia)}};rd.prototype.zaf=function(F,ia){var Qa=null;Qa=function(){F.getIsUpgrading()?window.setTimeout(Qa,1E3):F.getUpgradingFailed()?Ue.Dwc(ia,!0):ke.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Qa,1E3)};rd.prototype.Dve=function(F){var ia=new Mk.a;ia.$La=F.infoType;ia.id=F.id;ia.title=F.title;ia.description=F.description;ia.buttonText=F.buttonTxt;ia.Wha=F.buttonCallback;ia.Aec=F.highPriority;ia.Oia=F.dismissCallback;ia.errorCode=
F.errorCode;ia.x$e=F.iframeNotificationUrl;return ia};Ck.Object.defineProperties(rd.prototype,{ble:{configurable:!0,enumerable:!0,get:function(){return this.ZEc||(this.ZEc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(F){this.ZEc=F}},NNg:{configurable:!0,enumerable:!0,get:function(){return this.j3d||(this.j3d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(Lb.a)(rd,"AddinCommandsActionHandler",null,[225]);te.prototype.RHh=function(F){if(void 0!==
F&&null!==F&&F===bi.a.OCe)F="ContextMenuCell";else return null;var ia=this.Sa.Pc();this.iHh(ia,F);return ia};te.prototype.iHh=function(F,ia){ia=this.P2g.UUh(ia);ia=Cl(ia);for(var Qa=ia.next();!Qa.done;Qa=ia.next()){Qa=Cl(Qa.value.controls);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next())this.WGh(F,Ab.value)}};te.prototype.WGh=function(F,ia){var Qa=ia.eB[jj.a.id],Ab=ia.eB[jj.a.MCa],Ec=ia.eB[jj.a.PCa],Mc="Image16by16",zd=ia.eB[jj.a.aVa];Zi.c(Ec)&&(Mc="None");0<ia.menuItems.count?(Qa=this.Sa.zw(Qa,Qa,Ab,
798637440),Qa.IKb(Mc,Ec,null),this.PHh(Qa.menu,ia),F.buttons.push(Qa)):F.buttons.push(this.Sa.aIa(Qa,Ab,zd,Ec,Mc,null,!1))};te.prototype.PHh=function(F,ia){var Qa,Ab=this.Sa.Pc();ia=Cl(ia.menuItems);for(Qa=ia.next();!Qa.done;Qa=ia.next()){var Ec=Qa.value;Qa=Ec.eS[jj.a.id];var Mc=Ec.eS[jj.a.MCa],zd=Ec.eS[jj.a.PCa],Ld="Image16by16";Ec=Ec.eS[jj.a.aVa];Zi.c(zd)&&(Ld="None");Qa=this.Sa.aIa(Qa,Mc,Ec,zd,Ld,null,!1);Ab.buttons.push(Qa)}F.Dc.push(Ab)};Object(Lb.a)(te,"AddInCommandsContextMenuExtensibilityHandler",
null,[805]);var Fk=b(1065);Object(Lb.a)(Sd,"AddinStatusCommandValues",null,[]);Dc.u3i=function(F){var ia=new Sd;ia.Ci=F.rZa;ia.visible=ia.Ci?!0:!1;return ia};Dc.ryc=function(F,ia,Qa,Ab,Ec){var Mc=document.getElementById(Qa);Mc?Dc.iBj(F,ia,Mc,Ab,Ec):Xa.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Qa))};Dc.iBj=function(F,ia,Qa,Ab,Ec){Qa?F.rZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?uk.a.Wzj(ia,Qa,Ab,Ec):F.rZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
uk.a.nBj(ia,Qa):Xa.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(Lb.a)(Dc,"AddinCommandsStatusHandler",null,[]);var Ak=b(38),ek=b(229),ml=Ak.a;Am($f,ml);$f.prototype.Aq=function(F){this.addHandler("LAC",F)};$f.prototype.Xq=function(F){this.removeHandler("LAC",F)};$f.prototype.fs=function(F,ia){var Qa=this;if("QueryAddinLabel"!==F)return!1;ia[Fk.a.LabelText]!==this.BD.rZa&&(F=Dc.u3i(this.BD),ia[Fk.a.LabelText]=F.Ci,ia[Fk.a.Visible]=F.visible,
window.setTimeout(function(){Qa.ryc()},0));return!0};$f.prototype.xn=function(){return!0};$f.prototype.ryc=function(){this.$&&Dc.ryc(this.BD,this.$.domElement,this.jGj,Cf.a.instance.fa(334),Cf.a.instance.fa(335))};$f.prototype.dispose=function(){this.$.ea.Fk(this.qd);this.BD.ebj(this.f6e);this.agaveCommandManager&&(this.agaveCommandManager.ucj(this.Pze),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.ZF(this),this.statusBarManager=null);this.BD=this.$=null;ml.prototype.dispose.call(this)};
Object(Lb.a)($f,"AddinCommandsStatusBarManager",Ak.a,[543,373]);var hl=b(1362),wj=b(123),Nk=b(140);Jf.prototype.setErrorMessageForAddin=function(F,ia){this.qZa||(this.qZa={});this.qZa[F]=ia};Jf.prototype.APh=function(F){return this.qZa&&F in this.qZa?this.qZa[F]:null};Object(Lb.a)(Jf,"AddinCommandsErrorManager",null,[]);var Ai=b(345),vk=b(97);Object(Lb.a)(Le,"AddinCommandsListLoaderContext",null,[]);var Ok=b(1024);Object(Lb.a)(ee,"AppsForOfficeEntitlementQueryInfo",null,[]);var Vk=b(80),al=b(892);
kf.prototype.get_current=function(){if(!this.Mr)throw Error.argumentOutOfRange();return this.Mr.data};kf.prototype.moveNext=function(){if(!this.Mr)return this.Mr=this.vA,!!this.vA;if(!this.Mr.next)return!1;this.Mr=this.Mr.next;return!0};kf.prototype.Ylc=function(){if(!this.Mr)return this.Mr=this.vA,!!this.vA;if(!this.Mr.previous)return!1;this.Mr=this.Mr.previous;return!0};kf.prototype.reset=function(){this.Mr=this.vA};Object(Lb.a)(kf,"ListEnumerator",null,[0]);Object(Lb.a)(Ve,"ListNode",null,[]);
Tc.prototype.add=function(F){this.rq?this.IA=this.IA.next=new Ve(F,this.IA,null):this.rq=this.IA=new Ve(F,null,null);this._count=this.count+1};Tc.prototype.insert=function(F,ia){if(F>this.count||0>F)throw Error.argumentOutOfRange("pos");if(F===this.count)this.add(ia);else{for(var Qa=this.rq;0!==F--;)Qa=Qa.next;F=new Ve(ia,Qa.previous,Qa);F.previous?F.previous.next=F:this.rq=F;F.next?F.next.previous=F:this.IA=F;this._count=this.count+1}};Tc.prototype.remove=function(F){for(var ia=this.rq;ia&&ia.data!==
F;)ia=ia.next;if(!ia)return!1;ia.previous?ia.previous.next=ia.next:this.rq=ia.next;ia.next?ia.next.previous=ia.previous:this.IA=ia.previous;this._count=this.count-1;return!0};Tc.prototype.clear=function(){var F=this.rq;for(this.IA=this.rq=null;F;){var ia=F.next;F.previous=null;F.next=null;F=ia}this._count=0};Tc.prototype.indexOf=function(F){for(var ia=this.rq,Qa=0;ia&&ia.data!==F;)ia=ia.next,Qa++;return ia?Qa:-1};Tc.prototype.oa=function(F){return this.at(F).data};Tc.prototype.getEnumerator=function(){return new kf(this.rq)};
Tc.prototype[Symbol.iterator]=function(){return Object(al.a)(this.getEnumerator())};Tc.prototype.xbc=function(F){F=this.at(F);return new kf(F)};Tc.prototype.toArray=function(){for(var F=Array(this.count),ia=0,Qa=Cl(this),Ab=Qa.next();!Ab.done;Ab=Qa.next())F[ia]=Ab.value,ia++;return F};Tc.prototype.at=function(F){for(var ia=this.rq,Qa=0;Qa!==F;){if(!ia)throw Error.argumentOutOfRange("pos");ia=ia.next;Qa++}return ia};Ck.Object.defineProperties(Tc.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}}});
Object(Lb.a)(Tc,"List",null,[1]);var il=Sys.EventArgs;Am(Pd,il);Object(Lb.a)(Pd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);vb.prototype.$$c=function(F){var ia=new Sys.StringBuilder(this.oJb);ia.append("RoamingServiceHandler.ashx?action=");ia.append("getAddinTeachingCalloutSettings");ia.append("&");ia.append(this.Vgd(F));ia.append("&");ia.append(ke.AFrameworkApplication.oj);ke.AFrameworkApplication.Jd.hm(ia.toString(),1,null,null,!0,2,Object(od.a)(this,this.WKa,"getRequestSuccessCallback"),
Object(od.a)(this,this.cka,"getRequestFailureCallback"),null)};vb.prototype.aub=function(F){var ia=new Sys.StringBuilder(this.oJb);ia.append("RoamingServiceHandler.ashx?action=");ia.append("saveAddinTeachingCalloutSettings");ia.append("&");ia.append(ke.AFrameworkApplication.oj);ia=ia.toString();F=Kg.c(F);ke.AFrameworkApplication.Jd.hm(ia,2,F,null,!0,4,null,Object(od.a)(this,this.g7,"postRequestFailureCallback"),null)};vb.prototype.WKa=function(F){var ia=!1,Qa=null;try{if(0<F.data.me.length){var Ab=
Object(Oh.a)(Object,Kg.a(F.data.me)),Ec=Ab?Ab[this.appName]:null;Ec&&(Qa=Object(Oh.a)(Object,Kg.a(Ec.toString())))}ia=!0}catch(Mc){this.cka(null)}ia&&this.qjb&&this.qjb(Qa)};vb.prototype.cka=function(F){this.mjb&&this.mjb(F?F.data:null)};vb.prototype.g7=function(F){this.ulb&&this.ulb(F?F.data:null)};vb.prototype.Vgd=function(F){for(var ia=new Sys.StringBuilder("requestedsettings="),Qa=0;Qa<F.count;Qa++)ia.append(F.oa(Qa)),Qa<F.count-1&&ia.append(";");return ia.toString()};Object(Lb.a)(vb,"AddinTeachingUIRoamingRequestHandler",
null,[]);Object(Lb.a)(qc,"MiniAddinInfo",null,[]);var Bk=Sys.EventArgs;Am(fd,Bk);Object(Lb.a)(fd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);sd.prototype.nEg=function(F){this.Qa.addHandler(Eg.a.l_b,F)};sd.prototype.LHg=function(F){this.Qa.addHandler(Eg.a.DSd,F)};sd.prototype.EOj=function(F){var ia=this;null!==F&&(this.context.D0=F[Eg.a.l3],this.context.rs=F[Eg.a.xM],this.context.$Ac=this.context.krc=0,F=Eg.a.qGa in F?F[Eg.a.qGa]:0,-1!==this.context.D0&&0!==this.context.rs&&(this.context.o$=
new Tc,this.context.Eja=new Tc,this.context.a4b=new Tc,this.context.sWc=this.oIg.createAddinDataProvider(vf(this.context.D0),this.contextActivationMgr),this.context.sWc?this.context.sWc.getEntitlementsAsync(this.contextActivationMgr.Xca,!0,F,function(Qa){ia.aPi(Qa)}):Xa.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.D0)))};sd.prototype.aPi=function(F){var ia=this;if(F&&0<F.length){this.context.$Ac=F.length;for(var Qa=0;Qa<F.length;Qa++){var Ab=F[Qa];if(!Ab||
1!==Ab.targetType&&-1!==Ab.targetType)this.hAd();else{var Ec={};Ec.marketplaceId=Ab.solutionId;Ec.marketplaceVersion=Ab.version;Ec.storeType=Ab.storeType;Ec.storeId=Ab.storeId;Ec.targetData=Ab;this.contextActivationMgr.isAddinCommandsAsync(Ec,function(Mc,zd,Ld){Mc?(zd&&ia.context.o$.add(Ld.targetData),10===ia.context.D0&&(Mc=Ld.targetData,zd=Mc.targetType,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",!1)&&!Zi.c(Ld.targetTypeForExp)&&
(zd=Ld.targetTypeForExp,Mc.targetType=zd),ke.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&ia.context.Eja.add(Mc),ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===zd&&ia.context.a4b.add(Mc))):ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(Ld=Ld.targetData,Xa.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Ld.solutionId,Ld.storeType,Ld.assetId,null,null,Ld.storeId),Ld.storeType)):Xa.ULS.sendTraceTag(523367500,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(Ld.targetData.storeType,Ld.targetData.storeId,Ld.targetData.assetId),Ld.targetData.storeType);ia.hAd()})}}}else this.hAd()};sd.prototype.hAd=function(){var F;(F=this.context).krc=F.krc+1;this.context.krc>=this.context.$Ac&&(this.k_b.OYf(this.context.D0,!1),0<this.context.$Ac&&
10===this.context.D0&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(F=!1,ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&Xd()&&(F=this.ovi()),ke.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&this.Dui(),ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!F?this.xJh(this.context.o$):this.hZb(this.context.o$)):
this.hZb(this.context.o$))};sd.prototype.hZb=function(F){var ia=new sg.a;if(F){F=Cl(this.context.o$);for(var Qa=F.next();!Qa.done;Qa=F.next())ia.add(ne(Qa.value))}this.context.o$&&1>this.context.o$.count&&Ok.a.$Nb(Eg.a.m_b,"false",this.context.D0);F={};ia=(F.ack2=ia,F);ia[Eg.a.l3]=this.context.D0;ia[Eg.a.xM]=this.context.rs;this.Qa.raiseEvent(Eg.a.l_b,new Pd(ia),this)};sd.prototype.Icb=function(F){if(this.appName){var ia={},Qa={};Qa.LastTeachingUIShowTime=(new Date).toUTCString();Qa.AddinHasShown=
F;ia[this.appName]=Kg.c(Qa);this.Gpa&&(this.Gpa.aub(ia),Xa.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Xa.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};sd.prototype.xJh=function(F){if(this.lsa=F)F=new sg.a,F.add(this.appName),this.Gpa=new vb(this.appName,Object(od.a)(this,this.WKa,"getRequestSuccessCallback"),Object(od.a)(this,this.cka,"getRequestFailureCallback"),
Object(od.a)(this,this.g7,"postRequestFailureCallback")),this.Gpa.$$c(F);else{F=new sg.a;var ia={};F=(ia.ack2=F,ia);F[Eg.a.l3]=this.context.D0;F[Eg.a.xM]=this.context.rs;this.Qa.raiseEvent(Eg.a.l_b,new Pd(F),this)}};sd.prototype.WKa=function(F){F?this.Uyj(F)?(Xa.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.Yda="AddinHasShown"in F&&F.AddinHasShown?F.AddinHasShown.toString():null,this.cCe()):(Xa.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.hZb(this.lsa)):
(Xa.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Yda=null,this.cCe())};sd.prototype.cka=function(F){Xa.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",F?F.httpStatus:-1);this.hZb(this.lsa)};sd.prototype.g7=function(F){Xa.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.httpStatus:-1)};sd.prototype.cCe=function(){if(ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var F=
this.Reh();if(0===F.targetType){sd.ZSa?F.solutionId?(this.dUd=F.solutionId,this.yzc=F.storeId,this.QKf()):this.Pud("NoSolutionId"):F.assetId?(this.QXc=F.assetId,this.yzc=F.storeId,this.QKf()):this.Pud("NoAssetId");if(F.addinId){var ia=this.Yda?this.Yda+","+F.addinId:F.addinId;ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=ia:this.Icb(ia)}this.dVc(null)}else this.dVc(F.addinId);Xa.ULS.sendTraceTag(528023563,306,50,
"Show teaching callout for: {0}",F.addinId)}else F=this.Qeh(),this.dVc(F),Xa.ULS.sendTraceTag(538248464,306,50,"Show teaching callout for taskpane addin: {0}",F)};sd.prototype.QKf=function(){var F=this,ia=new ee;ia.callbackFunc=function(Qa){if(Qa.errorCode)F.Pud("FailToGetAppDetails");else if(Qa.value){var Ab=Cl(Qa.value);for(Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,sd.ZSa){var Ec=Qa[1];if(Ec===F.dUd){Ab={solutionId:Ec};Ab.assetId=Qa[5];Ab.storeType=Qa[6];ke.AFrameworkApplication.ga.isChangeGateEnabled("StoreIdFixEnabled")?
Ab.storeId=F.yzc:Ab.storeId=Qa[11];Ab.assetStoreId=Qa[6];Ab.targetType=Qa[3];Ab.width=Qa[7];Ab.height=Qa[8];Ab.displayName=Qa[0];Ab.version=Qa[4];Qa=new fd(Ab);F.Qa.raiseEvent(Eg.a.DSd,Qa);break}}else if(Ec=Qa[1],Ec===F.QXc){Ab={solutionId:Ec,assetId:Ec};Ab.storeType=Qa[6];ke.AFrameworkApplication.ga.isChangeGateEnabled("StoreIdFixEnabled")?Ab.storeId=F.yzc:Ab.storeId=Qa[11];Ab.assetStoreId=Qa[6];Ab.targetType=Qa[3];Ab.width=Qa[7];Ab.height=Qa[8];Ab.displayName=Qa[0];Ab.version=Qa[4];Qa=new fd(Ab);
F.Qa.raiseEvent(Eg.a.DSd,Qa);break}}};ia.storeType=OSF.StoreTypeEnum.PrivateCatalog;ia.fromInsertDialog=!1;ia.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(ia)};sd.prototype.Uyj=function(F){if("LastTeachingUIShowTime"in F){if(F=+new Date-+new Date(F.LastTeachingUIShowTime.toString()),F<ke.AFrameworkApplication.ga.lR("AddinShowTeachingUIIntervalInMS",864E5))return Xa.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",F),!1}else Xa.ULS.sendTraceTag(527523846,
306,50,"userSetting has no date key");return!0};sd.prototype.Qeh=function(){for(var F=new Ai.a("",0),ia=new Ai.a("",0),Qa=0,Ab=0,Ec=0,Mc=Cl(this.lsa),zd=Mc.next();!zd.done;zd=Mc.next())if(zd=zd.value,!("excatalog"!==zd.storeType||Zi.c(zd.installTimeInMS)||!zd.installTimeInMS||zd.installTimeInMS<=ke.AFrameworkApplication.ga.lR("DateTimeInMSForNewAddin",16409664E5))){var Ld=sd.Ldd(zd);if(this.Yda){var ye=this.Yda.split(",");if(0<ye.length&&Array.contains(ye,Ld)){Ec++;Xa.ULS.sendTraceTag(538817694,306,
50,"This addin has shown teaching UI before");continue}}Ld.startsWith("private_")?(F.value<zd.installTimeInMS&&(F=new Ai.a(Ld,zd.installTimeInMS)),Ab++):(ia.value<zd.installTimeInMS&&(ia=new Ai.a(Ld,zd.installTimeInMS)),Qa++)}Xa.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Ab,Qa,Ec);return 0<ia.value?ia.key:0<F.value?F.key:null};sd.prototype.Reh=function(){var F=new Ai.a(new qc,0),ia=new Ai.a(new qc,0),Qa=0,Ab=0,
Ec=0,Mc=new Tc;if(0<this.context.o$.count)for(var zd=Cl(this.context.o$),Ld=zd.next();!Ld.done;Ld=zd.next())Mc.add(Ld.value);if(0<this.context.a4b.count)for(zd=Cl(this.context.a4b),Ld=zd.next();!Ld.done;Ld=zd.next())Mc.add(Ld.value);Mc=Cl(Mc);for(Ld=Mc.next();!Ld.done;Ld=Mc.next())if(Ld=Ld.value,!("excatalog"!==Ld.storeType||Zi.c(Ld.installTimeInMS)||!Ld.installTimeInMS||Ld.installTimeInMS<=ke.AFrameworkApplication.ga.lR("DateTimeInMSForNewAddin",16409664E5))){zd=sd.Ldd(Ld);if(this.Yda){var ye=this.Yda.split(",");
if(0<ye.length&&Array.contains(ye,zd)){Ec++;Xa.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}zd.startsWith("private_")?(F.value<Ld.installTimeInMS&&(F=sd.ZSa?new Ai.a(Object.assign(new qc,{addinId:zd,targetType:Ld.targetType,storeId:Ld.storeId,solutionId:Ld.solutionId}),Ld.installTimeInMS):new Ai.a(Object.assign(new qc,{addinId:zd,targetType:Ld.targetType,storeId:Ld.storeId,assetId:Ld.assetId}),Ld.installTimeInMS)),Ab++):(ia.value<Ld.installTimeInMS&&(ia=sd.ZSa?
new Ai.a(Object.assign(new qc,{addinId:zd,targetType:Ld.targetType,storeId:Ld.storeId,solutionId:Ld.solutionId}),Ld.installTimeInMS):new Ai.a(Object.assign(new qc,{addinId:zd,targetType:Ld.targetType,storeId:Ld.storeId,assetId:Ld.assetId}),Ld.installTimeInMS)),Qa++)}Xa.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Ab,Qa,Ec);return 0<ia.value?ia.key:0<F.value?F.key:Object.assign(new qc,{addinId:null,targetType:-1,solutionId:null,
storeId:null,assetId:null})};sd.prototype.dVc=function(F){for(var ia=new sg.a,Qa=Cl(this.lsa),Ab=Qa.next();!Ab.done;Ab=Qa.next()){var Ec=Ab.value;Ab=ne(Ec);F&&(Ec=sd.Ldd(Ec),F===Ec&&(Ab.showCallout=!0,Ec=this.Yda?this.Yda+","+F:F,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=F:this.Icb(Ec)));ia.add(Ab)}this.lsa&&1>this.lsa.count&&Ok.a.$Nb(Eg.a.m_b,"false",this.context.D0);F={};ia=(F.ack2=ia,F);ia[Eg.a.l3]=this.context.D0;
ia[Eg.a.xM]=this.context.rs;this.Qa.raiseEvent(Eg.a.l_b,new Pd(ia),this)};sd.prototype.ovi=function(){var F=!1;if(this.context.Eja&&1>this.context.Eja.count)return F;var ia=Ad();if(!ia)return F;for(var Qa=Cl(this.context.Eja),Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,Ab.storeId&&Ab.storeId.toLowerCase()===ia.toLowerCase()||Ab.assetId&&Ab.assetId.toLowerCase()===ia.toLowerCase()){F=sd.K4a(Ab);var Ec={};Ab=(Ec.SDX_Id=F,Ec.SDX_TargetType=Zi.c(Ab.targetType)?"":Ab.targetType.toString(),Ec);Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:wj.a.al(Ab)}));F=!0}return F};sd.prototype.Dui=function(){if(!(this.context.Eja&&1>this.context.Eja.count))if(this.k_b.Aki()){var F=this.k_b.iWh();F?(F=this.rZe(this.context.Eja,F),Xa.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(F=this.rZe(this.context.Eja,null),Xa.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.k_b.Qsj(F)}else Xa.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};
sd.prototype.rZe=function(F,ia){var Qa={},Ab=!1;F=Cl(F);for(var Ec=F.next();!Ec.done;Ec=F.next()){Ec=Ec.value;var Mc=sd.K4a(Ec);Mc&&(!ia||Mc in ia||(this.dya(Ec,Mc),Xa.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Mc.toLowerCase()?Ab||(Ab=!0,Qa[Mc]=null):Qa[Mc]=null)}return Qa};sd.prototype.dya=function(F,ia){var Qa=F.installTimeInMS?(new Date(F.installTimeInMS)).toISOString():"",Ab={};Qa=(Ab["SDX.Id"]=ia,Ab["SDX.AppInstallOrigin"]="Organization",Ab["SDX.TargetType"]=
Zi.c(F.targetType)?"":F.targetType.toString(),Ab["SDX.AdminDeploymentTime"]=Qa,Ab);Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.al(Qa)}));1===F.targetType&&(F={},ia=(F["SDX.Id"]=ia,F["SDX.AppInstallOrigin"]="Organization",F["SDX.CommandPlacement"]="Ribbon",F),Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:wj.a.al(ia)})))};sd.prototype.Pud=function(F){var ia={};F=(ia.AppTeachingUICalloutAction=
F,ia["SDX.Id"]=sd.ZSa?this.dUd:this.QXc,ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}))};sd.K4a=function(F){return sd.ZSa?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId):Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.assetId)};sd.Ldd=function(F){if(sd.ZSa){var ia=
F.solutionId;var Qa=Telemetry.PrivacyRules.IsPrivateAddin(F.storeType,F.assetId,null,null,F.storeId)}else ia=F.assetId,Qa=Telemetry.PrivacyRules.IsPrivateAddin(F.storeType,F.storeId,F.assetId);return Qa?"private_"+F.installTimeInMS:ia};Ck.Object.defineProperties(sd,{ZSa:{configurable:!0,enumerable:!0,get:function(){return ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")}}});Object(Lb.a)(sd,"AddInCommandsListLoader",null,[]);Sc.prototype.insertOsfControl=
function(F){return this.Xca.insertOsfControl(F)};Sc.prototype.getManifestInvaildErrorString=function(){return this.Xca.getManifestInvaildErrorString()};Sc.prototype.isAddinCommandsAsync=function(F,ia){this.Xca.isAddinCommandsAsync(F,ia)};Sc.prototype.ownerAddinControlRecreated=function(F,ia){this.Xca.ownerAddinControlRecreated(F,ia)};Sc.prototype.queryEntitlementDetails=function(F){this.Xca.queryEntitlementDetails(F)};Ck.Object.defineProperties(Sc.prototype,{Xca:{configurable:!0,enumerable:!0,get:function(){return this.Xtg}}});
Object(Lb.a)(Sc,"ContextActivationMgrWrapper",null,[223]);Zb.prototype.createAddinDataProvider=function(F,ia){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(F,ia.Xca)};Ck.Object.defineProperties(Zb,{instance:{configurable:!0,enumerable:!0,get:function(){Zb.Ma||(Zb.Ma=new Zb);return Zb.Ma}}});Zb.Ma=null;Object(Lb.a)(Zb,"OSFAddinDataProviderFactory",null,[127]);Object(Lb.a)(oc,"CacheItem",null,[]);dd.prototype.xl=function(F){if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFRemoveUnusedCode",
!1))Xa.ULS.sendTraceTag(523375833,220,10,"GetCacheItem is deprecated");else{Xa.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var ia=this.xEa.getItem(F);if(ia){var Qa=new oc;try{Qa=Sys.Serialization.JavaScriptSerializer.deserialize(ia,!0)}catch(Ab){return this.xEa.removeItem(F),null}return Qa.Data?Qa.Data:Qa.data}}return null};dd.prototype.LQa=function(F){ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFRemoveUnusedCode",!1)?Xa.ULS.sendTraceTag(523375835,220,
10,"RemoveCacheItem is deprecated"):(Xa.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem"),this.xEa.removeItem(F))};Object(Lb.a)(dd,"AppsDataCacheManager",null,[241]);var ik=b(1025);fc.prototype.OYf=function(F,ia){F=Eg.a.u_e()+F;ik.a.instance.setItem(F,ia.toString())};fc.prototype.iWh=function(){var F=Eg.a.w2e();Xa.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",F);F=ik.a.instance.getItem(F);return Kg.a(F)};fc.prototype.Qsj=function(F){var ia=Eg.a.w2e();Xa.ULS.sendTraceTag(527523851,306,50,
"get cache key:{0}",ia);ik.a.instance.setItem(ia,Kg.c(F))};fc.prototype.Aki=function(){return!!ik.a.instance.localStorage};Ck.Object.defineProperties(fc,{instance:{configurable:!0,enumerable:!0,get:function(){fc.Ma||(fc.Ma=new fc);return fc.Ma}}});fc.Ma=null;Object(Lb.a)(fc,"AddInCommandsCacheManager",null,[228]);var Wk=Sys.EventArgs;Am(ge,Wk);Object(Lb.a)(ge,"InsertionParamEventArgs",Sys.EventArgs,[]);Object(Lb.a)(Xe,"PostLaunchAddinCommandsParameters",null,[]);de.prototype.EBg=function(){window.addEventListener?
(window.addEventListener("LaunchAddinTaskpane",Object(od.a)(this,this.OOi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(od.a)(this,this.fKi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(od.a)(this,this.JIi,"onCloseButtonClickedEventHandler"),!0),ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(od.a)(this,
this.Avf,"onCampaignLaunchedHandler"),!0)):Xa.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};de.prototype.OOi=function(){var F=this,ia={};ia=(ia.AppTeachingUICalloutAction="ClickOnLaunch",ia["SDX.Id"]=de.K4a(this.CTb),ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);ke.AFrameworkApplication.ga.isChangeGateEnabled("TeachingUIExtraLogForLaunch")&&this.fhb&&this.fhb.tabs&&!this.fhb.tabs[0].isOfficeTab&&(ia["SDX.FeatureFlags"]=
"NonOfficeTab");Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(ia)}));this.fhb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.fhb,function(){var Qa=new ge;Qa.hi=F.CTb;F.Za.raiseEvent(Eg.a.$kf,Qa)}):Xa.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};de.prototype.JIi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnClose",F["SDX.Id"]=de.K4a(this.CTb),
F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}))};de.prototype.fKi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnDismiss",F["SDX.Id"]=de.K4a(this.CTb),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:wj.a.al(F)}))};de.prototype.Avf=function(F){if(F&&(F=F.detail)&&F.id&&this.rgi(F.id)){var ia=(F.action||"").toLowerCase();if(F.success&&"opened"===ia){Xa.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");var Qa=window.g_roamingAddinList;Qa&&this.Icb(Qa);window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(od.a)(this,this.Avf,"onCampaignLaunchedHandler"),!0)}else try{Qa=JSON.stringify(F),Xa.ULS.sendTraceTag(523321995,
220,15,"Campaign launch failure. Event:"+Qa)}catch(Ab){Qa="id : "+F.id+" telemetryEventName: "+F.telemetryEventName,Xa.ULS.sendTraceTag(523321996,306,50,"Error serializing campaign event. "+Qa+" Error: "+(Ab?Ab.toString():""))}}};de.prototype.rgi=function(F){return-1!==F.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==F.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==F.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")};de.prototype.Icb=function(F){var ia=ke.AFrameworkApplication.ga.Va("WebAppShortName");
if(ia){var Qa={},Ab={};Ab.LastTeachingUIShowTime=(new Date).toUTCString();Ab.AddinHasShown=F;Qa[ia]=Kg.c(Ab);this.Gpa=new vb(ia,null,null,Object(od.a)(this,this.g7,"postRequestFailureCallback")),this.Gpa.aub(Qa),Xa.ULS.sendTraceTag(523535564,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else Xa.ULS.sendTraceTag(523535565,306,10,"Fail to save roaming service since AppName is null")};de.prototype.g7=function(F){Xa.ULS.sendTraceTag(523535566,
306,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.httpStatus:-1)};de.K4a=function(F){return ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.storeType,F.assetId,null,null,F.storeId):Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.assetId)};Object(Lb.a)(de,"PrivateCatalogTeachingCalloutHandler",null,[]);Qc.prototype.lha=function(F,ia){this.z9d.lha(F,
void 0===ia?null:ia);this.Dae=F};Qc.prototype.Hbb=function(F){this.z9d.Hbb(F)};Ck.Object.defineProperties(Qc.prototype,{Oxa:{configurable:!0,enumerable:!0,get:function(){return this.Dae}}});Object(Lb.a)(Qc,"RibbonExtensibilityManagerWithChangeDetection",null,[240]);var Ah=b(942),Pk=b(1018);kd.prototype.lha=function(F,ia){ia=void 0===ia?null:ia;if(F=Pk.a.evb(F)){appChrome.addInApi.dispatchActionsToInstallAddIn(F,ia);ia=Cl(F.tabs);for(var Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(F,
function(){});break}}};kd.prototype.Hbb=function(F){(F=Pk.a.evb(F))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(F)};Object(Lb.a)(kd,"OneLineRibbonExtensibilityManager",null,[240]);var Qk=b(1077);gd.d0e=function(F){var ia=new sg.a;if(gd.RBe)for(var Qa=Cl(gd.RBe),Ab=Qa.next();!Ab.done;Ab=Qa.next())ia.add(Ab.value);Ab=null;switch(F){case "Workbook":Ab=gd.kYj;break;case "Document":Ab=gd.Yhh;break;case "Presentation":Ab=gd.i1i}if(Ab)for(F=Cl(Ab),Ab=F.next();!Ab.done;Ab=F.next())ia.add(Ab.value);return ia};
gd.RBe=["PrimaryCommandSurface","ContextMenu"];gd.kYj=null;gd.Yhh=null;gd.i1i=null;Object(Lb.a)(gd,"ExtensionPointType",null,[]);Ck.Object.defineProperties(rc.prototype,{WDb:{configurable:!0,enumerable:!0,get:function(){return this.xde||(this.xde=new sg.a)}},dqe:{configurable:!0,enumerable:!0,get:function(){return this.flg}}});Object(Lb.a)(rc,"ContextMenuExtensibility",null,[227]);Wd.prototype.vXe=function(){for(var F=new Sys.StringBuilder,ia=Cl(this.QY),Qa=ia.next();!Qa.done;Qa=ia.next())F.append(Qa.value.r8());
return this.fDg(F.toString())};Wd.prototype.fDg=function(F){var ia=new Sys.StringBuilder;ia.append("<Ribbon><Tabs>");ia.append(F);ia.append("</Tabs></Ribbon>");return ia.toString()};Ck.Object.defineProperties(Wd.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.QY}},UW:{configurable:!0,enumerable:!0,get:function(){return this.Qtg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.nxg}},S$a:{configurable:!0,enumerable:!0,get:function(){return this.blb}},
NIh:{configurable:!0,enumerable:!0,get:function(){return this.Lpg}}});Object(Lb.a)(Wd,"RibbonExtensibility",null,[285]);he.prototype.createActionContext=function(F,ia){F={};F.ownerAddinInfo=this.entitlement;F.action=ia;return F};Ck.Object.defineProperties(he.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Iog}}});Object(Lb.a)(he,"AddInCommandsContextProvider",null,[]);Oc.prototype.g6g=function(F){return new he(F)};Oc.prototype.createActionBuilder=function(F,ia){return OfficeExt.DefaultControlActionBinder.createActionBuilder(F,
ia.entitlement,ia.manifest)};Oc.prototype.startApplyAddin=function(F){this.D2d=F;var ia=this.g6g(F);this.actionBuilder=this.createActionBuilder(ia,F)};Oc.prototype.endApplyAddin=function(){};Oc.prototype.N3a=function(F,ia,Qa){Qa=void 0===Qa?0:Qa;return this.ribbonBuilder.Yzc&&0<this.ribbonBuilder.Yzc.count||this.ribbonBuilder.Qr&&0<this.ribbonBuilder.Qr.count?new Wd(this.ribbonBuilder.Yzc,this.bIh(F,ia),this.Bpe.startedNode,this.ribbonBuilder.B6.iVh(),Qa):null};Oc.prototype.VWe=function(){var F=void 0===
F?null:F;if(this.contextMenuBuilder.Flc&&0<this.contextMenuBuilder.Flc.count){F||(F=this.Bpe.entitlement.solutionId);F=new rc(F);for(var ia=Cl(this.contextMenuBuilder.Flc),Qa=ia.next();!Qa.done;Qa=ia.next())F.WDb.add(Qa.value);return F}return null};Oc.prototype.bIh=function(F,ia){return this.ribbonBuilder.Qr&&0<this.ribbonBuilder.Qr.count?new Pk.a(this.ribbonBuilder.Qr,F,ia):null};Ck.Object.defineProperties(Oc.prototype,{Bpe:{configurable:!0,enumerable:!0,get:function(){return this.D2d}}});Object(Lb.a)(Oc,
"AddinCommandsBuilder",null,[]);Gb.prototype.QNa=function(F,ia,Qa,Ab,Ec,Mc,zd){function Ld(Jg,dh,bj,uh){Ec(Jg,dh,bj,uh);Jg=Qk.a[ye.rs]+dh.assetId;bj=ye.lTa.Nc(Jg);dh=bj.value;bj.returnValue&&(dh.stop(),ye.lTa.remove(Jg))}var ye=this;if(0!==this.rs&&F)for(Xa.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",F.count),4===this.rs&&(Xa.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Ab)),this.vYg(F,Ab),Mc()),F=Cl(F),Ab=F.next();!Ab.done;Ab=F.next())if(Ab=
Ab.value,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(Ab.solutionId=Ab.solutionId||Ab.assetId,Ab.storeType=Ab.storeType||Ab.currentStoreType,Ab.version=Ab.version||Ab.appVersion),Xa.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(Ab.solutionId,
Ab.ownerAddinStoreType||Ab.storeType,Ab.assetId,null,null,Ab.storeId):Telemetry.PrivacyRules.GetAssetId(Ab.storeType,Ab.storeId,Ab.solutionId))),this.ggg(Ab))if(zd&&Ab.requireConsent)zd(Ab,function(Jg){try{if(ye.YO){var dh=Qk.a[ye.rs]+Jg.solutionId,bj=ye.YO.Hc("ComponentAttach",dh);ye.lTa.ia(dh,bj)}var uh=ye.BD.O4(Jg.storeType,Jg.solutionId);6!==ye.rs&&(uh&&(ye.J2b(uh),uh.HB.purge(!1)),ye.Gi.insertOsfControl(ye.JGb(Jg,ia,Qa,Ld)),uh&&ye.Gi.ownerAddinControlRecreated(Jg.solutionId,Jg.storeType))}catch(hi){Xa.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",ye.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(Jg.solutionId,Jg.ownerAddinStoreType||Jg.storeType,Jg.assetId,null,null,Jg.storeId):Telemetry.PrivacyRules.GetAssetId(Jg.storeType,Jg.storeId,Jg.solutionId),Jg.version,Jg.storeType,Jg.storeId,hi.message)),
Ld(!1,Jg,null,null)}});else try{if(this.YO){var Te=Qk.a[this.rs]+Ab.solutionId,rf=this.YO.Hc("ComponentAttach",Te);this.lTa.ia(Te,rf)}var dg=this.BD.O4(Ab.storeType,Ab.solutionId);6!==this.rs&&(dg&&(this.J2b(dg),dg.HB.purge(!1)),this.Gi.insertOsfControl(this.JGb(Ab,ia,Qa,Ld)),dg&&this.Gi.ownerAddinControlRecreated(Ab.solutionId,Ab.storeType))}catch(Jg){Xa.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(Ab.solutionId,Ab.ownerAddinStoreType||Ab.storeType,Ab.assetId,null,null,Ab.storeId):Telemetry.PrivacyRules.GetAssetId(Ab.storeType,Ab.storeId,Ab.solutionId),Ab.version,Ab.storeType,Ab.storeId,Jg.message)),Ld(!1,Ab,null,null)}else Ld(!1,Ab,null,null)};Gb.prototype.Zri=function(F,ia,Qa,Ab,Ec,Mc){function zd(dg,Jg,dh,bj){Mc(dg,Jg,dh,bj);dg=
Qk.a[Ld.rs]+Jg.solutionId;dh=Ld.lTa.Nc(dg);Jg=dh.value;dh.returnValue&&(Jg.stop(),Ld.lTa.remove(dg))}var Ld=this;if(6===this.rs&&F)if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(F.solutionId=F.solutionId||F.assetId,F.storeType=F.storeType||F.currentStoreType,F.version=F.version||F.appVersion),Xa.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",
!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId):Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId))),this.ggg(F))try{if(this.YO){var ye=Qk.a[this.rs]+F.solutionId,Te=this.YO.Hc("ComponentAttach",ye);this.lTa.ia(ye,Te)}var rf=this.BD.O4(F.storeType,F.solutionId);rf||zd(!1,F,null,null);ke.AFrameworkApplication.sa&&ke.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.tXe(F,ia,Ab,Ec,Qa,function(dg){zd(dg,
F,Qa,rf.displayName)}):(this.tXe(F,ia,Ab,Ec,Qa),zd(!0,F,Qa,rf.displayName))}catch(dg){Xa.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId):
Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId,dg.message)),zd(!1,F,null,null)}else zd(!1,F,null,null)};Gb.prototype.QGi=function(F,ia,Qa,Ab,Ec,Mc){if(Mc)if(Mc._isAddinCommandsManifest(this.Uo.sK))try{ke.AFrameworkApplication.sa&&ke.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.sXe(F,ia,Qa,Ec,Mc,function(zd){Ab(zd,F,Mc,Mc.getDefaultDisplayName())}):(this.sXe(F,ia,Qa,Ec,Mc),Ab(!0,F,Mc,Mc.getDefaultDisplayName()))}catch(zd){Xa.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId):Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId,zd.message)),
Ab(!1,F,Mc,Mc.getDefaultDisplayName())}else Xa.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId):Telemetry.PrivacyRules.GetAssetId(F.storeType,
F.storeId,F.solutionId),F.version,F.storeType,F.storeId)),Ab(!1,F,null,null);else Xa.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Uo.sK,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,F.ownerAddinStoreType||F.storeType,F.assetId,null,null,F.storeId):Telemetry.PrivacyRules.GetAssetId(F.storeType,
F.storeId,F.solutionId),F.version,F.storeType,F.storeId)),Ab(!1,F,null,null)};Gb.prototype.JGb=function(F,ia,Qa,Ab){var Ec=this,Mc={},zd=document.createElement("div");zd.setAttribute("visible","false");Mc.div=zd;ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?(Mc.id=F.solutionId,Mc.solutionId=F.solutionId,Mc.version=F.version,Mc.storeType=F.storeType):(Mc.id=F.solutionId||F.id,Mc.solutionId=F.solutionId||F.id,Mc.version=F.version||
F.appVersion,Mc.storeType=F.storeType||F.currentStoreType);Mc.storeId=F.storeId;Mc.assetId=F.assetId;Mc.assetStoreId=F.assetStoreId;Mc.isvirtualOsfControl=!0;Mc.virtualOsfControlActivationCallback=function(Ld,ye){var Te;if(Te=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?Ec.BD.O4(F.storeType,F.solutionId):Ec.BD.O4(F.storeType||F.currentStoreType,F.solutionId||F.id))Te.isUpgraded&&(F.isUpgraded=!0),Ec.J2b(Te);Ec.QGi(F,ia,Qa,Ab,Ld,
ye)};Mc.reason=3===this.rs?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(Mc.marketplaceID=F.id,Mc.marketplaceVersion=F.appVersion,Mc.store=F.storeId);return Mc};Gb.prototype.sXe=function(F,ia,Qa,Ab,Ec,Mc){Mc=void 0===Mc?null:Mc;var zd={};zd.solutionId=Ab.getSolutionId();zd.version=Ab.getVersion();zd.storeType=
Ab.getStoreType();zd.storeId=Ab.getStoreId();zd.assetId=Ab.getSolutionId();zd.assetStoreId=Ab.getAssetStoreId();zd.targetType=Ab.getOsfControlType();ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(zd.appVersion=Ab.getMarketplaceVersion());var Ld=null,ye=null;if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ld=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Uo.sK,
this.Uo.formFactor)).parseExtensions(zd,Ec,this.sha),ye=gd.d0e(this.Uo.sK);else try{Ld=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Uo.sK,this.Uo.formFactor)).parseExtensions(zd,Ec,this.sha),ye=gd.d0e(this.Uo.sK)}catch(J){throw Xa.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+J.message),J;}if(ye&&0<ye.count){if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Te=
ia(F);var rf=Qa(F);Qa=!!ke.AFrameworkApplication.ga&&ke.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");Te=new Oc(Te,null,rf);ye=Cl(ye);for(rf=ye.next();!rf.done;rf=ye.next())Te.commandSurface=rf.value,Ld.apply(Te,this.sha,Qa)}else try{var dg=ia(F),Jg=Qa(F),dh=!!ke.AFrameworkApplication.ga&&ke.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");Te=new Oc(dg,null,Jg);var bj=Cl(ye);for(rf=bj.next();!rf.done;rf=bj.next())Te.commandSurface=rf.value,Ld.apply(Te,
this.sha,dh)}catch(J){throw Xa.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+J.message),J;}if(OSF.OUtil.checkFlight(14))try{var uh=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?Te.N3a(F.solutionId,Ec.getDefaultDisplayName()):Te.N3a(F.solutionId||F.id,Ec.getDefaultDisplayName());var hi=Te.VWe();uh&&this.ribbonManager.lha(uh,Mc);hi&&this.contextMenuManager.pme(hi);this.BD.Sme(Ab,uh,hi,
Ec.getDefaultDisplayName());Xa.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Ec.getDefaultDisplayName())}catch(J){throw OfficeExt.DevConsole.log(J),Xa.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+J.message),J;}else try{var vi=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?Te.N3a(F.solutionId,Ec.getDefaultDisplayName()):Te.N3a(F.solutionId||F.id,Ec.getDefaultDisplayName());var l=Te.VWe();
vi&&this.ribbonManager.lha(vi);l&&this.contextMenuManager.pme(l);this.BD.Sme(Ab,vi,l,Ec.getDefaultDisplayName());Xa.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Ec.getDefaultDisplayName())}catch(J){throw Xa.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+J.message),J;}}};Gb.prototype.tXe=function(F,ia,Qa,Ab,Ec,Mc){Mc=void 0===Mc?null:Mc;var zd={};ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",
!1)?(zd.solutionId=F.solutionId,zd.version=F.version,zd.storeType=F.storeType,zd.storeId=F.assetStoreId,zd.assetId=F.assetId,zd.assetStoreId=F.assetStoreId,zd.targetType=F.targetType):(zd.solutionId=F.solutionId||F.assetId,zd.version=F.version||F.appVersion,zd.storeType=F.storeType||F.currentStoreType,zd.storeId=F.assetStoreId,zd.assetId=F.assetId,zd.assetStoreId=F.assetStoreId,zd.targetType=F.targetType,zd.appVersion=F.appVersion);var Ld=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Uo.sK,
this.Uo.formFactor);try{var ye=ia.getManifest(),Te=Ld.parse(zd,ye,Ec,this.sha,ia.getSharedRuntimeId()),rf=Qa(F),dg=Ab(F),Jg=new Oc(rf,null,dg);Jg.commandSurface="PrimaryCommandSurface";Te.apply(Jg,this.sha,!0);if(Jg.ribbonBuilder.Qr&&0<Jg.ribbonBuilder.Qr.count){var dh=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?Jg.N3a(F.solutionId,ia.getManifest().getDefaultDisplayName(),1):Jg.N3a(F.solutionId||F.id,ia.getManifest().getDefaultDisplayName(),
1);ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.lha(dh,Mc):dh&&this.ribbonManager.lha(dh,Mc);this.BD.uCg(ia,dh,Ec,ia.getManifest().getDefaultDisplayName());Xa.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ia.getManifest().getDefaultDisplayName())}}catch(bj){Xa.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ia.getManifest().getDefaultDisplayName(),
bj.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(bj)}};Gb.prototype.J2b=function(F){F.Ko&&this.ribbonManager.Hbb(F.Ko);F.rrb&&this.contextMenuManager.$$i(F.rrb);this.BD.I$i(F.HB.getStoreType(),F.HB.getSolutionId())};Gb.prototype.vYg=function(F,ia){ia=vf(ia);for(var Qa=Cl(this.BD.m6a),Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,Ab.HB.getStoreType()===ia){for(var Ec=!0,Mc=Cl(F),zd=Mc.next();!zd.done;zd=Mc.next())if(zd=zd.value,ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",
!1)){if(zd&&Ab.qrd(zd.storeType,zd.solutionId)){Ec=!1;break}}else if(zd&&Ab.qrd(zd.storeType||zd.currentStoreType,zd.solutionId||zd.id)){Ec=!1;break}Ec&&(this.J2b(Ab),Ab.HB.purge(!1))}};Gb.prototype.ggg=function(F){ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(F.solutionId!==F.assetId&&Xa.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId"),F.id!==F.assetId&&Xa.ULS.sendTraceTag(540379093,220,50,
"VerifyInsertAgaveParameter Id != AssetId"));return!!F&&!!F.solutionId&&!!F.version&&!!F.storeType&&!!F.storeId};Object(Lb.a)(Gb,"AddInCommandsIntegration",null,[]);var bl=b(947);qd.prototype.oEg=function(F){this.Za.addHandler(Eg.a.Ape,F)};qd.prototype.iGg=function(F){this.Za.addHandler(Eg.a.$kf,F)};qd.prototype.KHg=function(F){this.Za.addHandler(Eg.a.O3f,F)};qd.prototype.wEg=function(F){this.Za.addHandler(Eg.a.sYc,F)};qd.prototype.QNa=function(F,ia,Qa){var Ab=this,Ec=Qa[Eg.a.pZa],Mc=void 0===Qa[Eg.a.xM]?
0:Qa[Eg.a.xM];if(Ec&&0!==Mc)if(0>=Ec.count&&4!==Mc)this.Bqc(new Xe(Mc,null,null,F,ia,null,!0));else{var zd=Ec.count,Ld=new Qc(new Ue(F));Qa=void 0===Qa[Eg.a.l3]?-1:Qa[Eg.a.l3];(new Gb(Mc,this.zm,this.iVa,Ld,this.j5d,this.Bga,this.Fpa)).QNa(Ec,function(ye){return Ab.NXb.XRg(ye.solutionId,Ab.Fpa,Ab.iVa)},function(ye){return Ab.NXb.tve(ye.solutionId)},Qa,function(ye,Te,rf,dg){zd--;rf=new Xe(Mc,Te,Ld,F,ia,dg,0>=zd);ye&&Te?Ab.Bqc(rf):(Ab.MWa&&(3===Mc||Te&&Te.isUpgraded)&&(ye="",Te&&(ye=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",
!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(Te.solutionId,Te.ownerAddinStoreType||Te.storeType,Te.assetId,null,null,Te.storeId):Telemetry.PrivacyRules.GetAssetId(Te.storeType,Te.storeId,Te.solutionId)),Te={},Te=(Te.SDX_AppInstallOrigin="User",Te.SDX_IsAutoLaunchEnabled=Ab.jEa,Te.SDX_AppInstallErrorCode="onAddinCompleted.fail",Te.SDX_Id=ye,Te),Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.al(Te)}))),Ab.Aqc(rf))},function(){Ab.Dmc();
0>=Ec.count&&4===Mc&&Ab.Bga.Ewc()},this.Cde)}else this.MWa&&(Qa={},Qa=(Qa.SDX_AppInstallOrigin="User",Qa.SDX_IsAutoLaunchEnabled=this.jEa,Qa.SDX_AppInstallErrorCode="LaunchAddinCommands.fail",Qa.SDX_Id="",Qa),Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.al(Qa)}))),Xa.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.iVa.sK)),this.Aqc(new Xe(Mc,null,null,F,ia,null,!0))};qd.prototype.qsi=
function(F,ia,Qa){var Ab=this,Ec=Qa[Eg.a.pZa],Mc=void 0===Qa[Eg.a.xM]?0:Qa[Eg.a.xM];if(Ec&&0!==Mc)if(0>=Ec.count&&4!==Mc)this.Bqc(new Xe(Mc,null,null,null,ia,null,!0));else{var zd=Ec.count,Ld=new Qc(new kd),ye=void 0===Qa[Eg.a.l3]?-1:Qa[Eg.a.l3],Te=new Gb(Mc,this.zm,this.iVa,Ld,this.j5d,this.Bga,this.Fpa),rf=function(uh){return Ab.NXb.IRg(uh.solutionId,Ab.Fpa,Ab.iVa,F)},dg=function(uh){return Ab.NXb.tve(uh.solutionId)},Jg=function(uh,hi,vi){zd--;vi=new Xe(Mc,hi,Ld,null,ia,vi,0>=zd);uh&&hi?Ab.Bqc(vi):
(Ab.MWa&&(3===Mc||hi&&hi.isUpgraded)&&(uh="",hi&&(uh=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(hi.solutionId,hi.ownerAddinStoreType||hi.storeType,hi.assetId,null,null,hi.storeId):Telemetry.PrivacyRules.GetAssetId(hi.storeType,hi.storeId,hi.solutionId)),hi={},hi=(hi.SDX_AppInstallOrigin="User",hi.SDX_IsAutoLaunchEnabled=Ab.jEa,hi.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",hi.SDX_Id=
uh,hi),Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.al(hi)}))),Ab.Aqc(vi));zd||ke.AFrameworkApplication.sa.updateCommandUI()},dh=function(uh,hi,vi,l){Jg(uh,hi,l)},bj=function(){Ab.Dmc();0>=Ec.count&&4===Mc&&Ab.Bga.Ewc()};6===Mc?(ye=Qa[Eg.a.cJa],Qa=Qa[Eg.a.dJa],Te.Zri(Ec.oa(0),ye,Qa,rf,dg,function(uh,hi,vi,l){Jg(uh,hi,l)})):Te.QNa(Ec,rf,dg,ye,dh,bj,this.Cde)}else this.MWa&&(Te={},Te=(Te.SDX_AppInstallOrigin="User",Te.SDX_IsAutoLaunchEnabled=
this.jEa,Te.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",Te.SDX_Id="",Te),Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.al(Te)}))),Xa.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.iVa.sK)),this.Aqc(new Xe(Mc,null,null,null,ia,null,!0))};qd.prototype.Aqc=function(F){this.Dmc(F);this.F4f(!1,F)};qd.prototype.Bqc=function(F){var ia=F.hi,Qa=null;null!==ia&&
(Qa=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?ia.storeType:ia.storeType||ia.currentStoreType,Qa=Qa.toLowerCase());if(this.MWa&&F&&"omex"===Qa&&(3===F.rs||ia.isUpgraded)){var Ab={};Ab=(Ab.SDX_AppInstallOrigin="User",Ab.SDX_IsAutoLaunchEnabled=this.jEa,Ab.SDX_AppInstallErrorCode="0",Ab.SDX_Id=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.solutionId,
ia.ownerAddinStoreType||ia.storeType,ia.assetId,null,null,ia.storeId):Telemetry.PrivacyRules.GetAssetId(Qa,ia.storeId,ia.solutionId),Ab);Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:wj.a.al(Ab)}))}this.Dmc(F);this.jEa&&"omex"===Qa&&F.U0&&(3===F.rs||ia.isUpgraded)&&(Ab=new ge,Ab.hi=ia,Ab.Ko=F.U0.Oxa,this.Za.raiseEvent(Eg.a.sYc,Ab));if(this.vrg){Ab=Xd();var Ec=Ad();Ab&&ia&&"excatalog"===ia.storeType&&F.U0&&5===F.rs&&Ec&&(ia.storeId&&ia.storeId.toLowerCase()===
Ec.toLowerCase()||ia.assetId&&ia.assetId.toLowerCase()===Ec.toLowerCase())&&(Ab=new ge,Ab.hi=ia,Ab.Ko=F.U0.Oxa,this.Za.raiseEvent(Eg.a.sYc,Ab),Xa.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ia&&(fc.instance.OYf(of(Qa),!0),"uploadfiledevcatalog"===Qa&&(Ab=this.Wkg.createAddinDataProvider(Qa,this.zm))&&(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?Ab.localCacheAddinCommands(this.zm.Xca,ia.solutionId,
ia.version,ia.storeId):Ab.localCacheAddinCommands(this.zm.Xca,ia.solutionId||ia.id,ia.version||ia.appVersion,ia.storeId)),this.hlj(F.U0.Oxa,Qa,F.rs,F.qWe),Ok.a.$Nb(Eg.a.m_b,"true",of(Qa)));this.F4f(!0,F)};qd.prototype.F4f=function(F,ia){if(F)if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ia.U0&&5===ia.rs&&ia.U0.Oxa&&void 0!==ia.hi.showCallout&&null!==ia.hi.showCallout&&ia.hi.showCallout)(new de(this.Za,ia.hi,Pk.a.evb(ia.U0.Oxa))).EBg(),
F=new ge,F.Ko=ia.U0.Oxa,F.hi=ia.hi,this.Za.raiseEvent(Eg.a.O3f,F);else if(3!==ia.rs)ia.fkf&&this.Bga.Ewc();else{if(ia.U0&&ia.U0.Oxa&&(F=Object(Oh.a)(bl.Ribbon,ia.qWe),"hardcodedpreinstall"!==ia.hi.storeType)){var Qa=!1;this.jEa&&(Qa=ia.hi.isAutoLaunched);uk.a.Yzj(F,ia.LFh,ia.displayName,ia.U0.Oxa,Qa)}}else 3===ia.rs?ia.hi&&"uploadfiledevcatalog"===ia.hi.storeType.toLowerCase()?(ia=this.Fpa.APh(ia.hi.solutionId),uk.a.xSd(ia?ia:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.Bga.UZf():ia.fkf&&this.Bga.Ewc()};qd.prototype.Dmc=function(F){var ia=(F=void 0===F?null:F)?F.hi:null,Qa=new ge;if(Qa.hi=ia){var Ab=6===F.rs?1:0;(Ab=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)?this.Bga.O4(ia.storeType,ia.solutionId,Ab):this.Bga.O4(ia.storeType||ia.currentStoreType,ia.solutionId||ia.id,Ab))&&Ab.Ko&&(Qa.Ko=Ab.Ko,this.MWa&&3===F.rs&&"hardcodedpreinstall"!==ia.storeType)&&(F="",Ab.Ko.UW&&Ab.Ko.UW.Qr&&(Ab=Ab.Ko.UW.Qr.oa(0))&&
(F=Ab.id),Ab={},ia=(Ab.SDX_CommandPlacement=F,Ab.SDX_PinningAction="Pinning",Ab.SDX_PinningActionErrorCode="0",Ab.SDX_Id=ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.solutionId,ia.ownerAddinStoreType||ia.storeType,ia.assetId,null,null,ia.storeId):Telemetry.PrivacyRules.GetAssetId(ia.storeType,ia.storeId,ia.solutionId),Ab),Hh.a.sendTelemetryEvent(Object.assign(new Ti.a,{name:"Office.Extensibility.Host.AppPinning",
dataFields:wj.a.al(ia)})))}this.Za.raiseEvent(Eg.a.Ape,Qa)};qd.prototype.hlj=function(F,ia,Qa,Ab){Ab=Object(Oh.a)(bl.Ribbon,Ab);F&&Ab&&(F=F.tabs.oa(0).vTa[Ah.a.id],3===Qa&&"hardcodedpreinstall"!==ia&&Ab.gOd(F),Ab.uni(F)&&Ab.glj())};Object(Lb.a)(qd,"LaunchAddinCommandsHandler",null,[230]);b(630);b(623);nd.prototype.r8=function(){return qg.k(this.m5d,this.SAi(),this.eB)};nd.prototype.SAi=function(){var F=null;if(this.lga){F=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');
for(var ia=Cl(this.lga),Qa=ia.next();!Qa.done;Qa=ia.next())F.append(Qa.value.r8());F.append("</Controls></MenuSection></Menu>")}return F?F.toString():""};Ck.Object.defineProperties(nd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},eB:{configurable:!0,enumerable:!0,get:function(){return this.k5d||(this.k5d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.m5d||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.lga||
(this.lga=new sg.a)}}});Object(Lb.a)(nd,"ControlDefinition",null,[231]);Ac.prototype.r8=function(){return qg.k(Ah.a.button,null,this.$Nc)};Ck.Object.defineProperties(Ac.prototype,{eS:{configurable:!0,enumerable:!0,get:function(){return this.$Nc||(this.$Nc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(Lb.a)(Ac,"MenuItemDefinition",null,[260]);dc.prototype.r8=function(){var F=null;if(this.g9){F=new Sys.StringBuilder;for(var ia=Cl(this.g9),Qa=ia.next();!Qa.done;Qa=
ia.next())F.append(Qa.value.r8())}return F?F.toString():""};Ck.Object.defineProperties(dc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.g9||(this.g9=new sg.a)}}});Object(Lb.a)(dc,"OfficeMenuDefinition",null,[232]);var X=b(27);bb.prototype.addButton=function(F){Xa.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",F.actionType);this.jJ=new nd(this.jQ(F.id),Ah.a.button);this.jJ.eB[Ah.a.Ygb]=
F.label;this.jJ.eB[Ah.a.MCa]=F.label;this.jJ.eB[Ah.a.PCa]=F.icon["16"];this.Jsa(this.jJ.eB[Ah.a.id],F.action);this.Y2(this.jJ.eB);this.TVa.controls.add(this.jJ);this.jJ=null};bb.prototype.startBuildMenu=function(F){if(Zi.c(this.TVa))this.TVa=new dc(F.id);else{var ia=this.jQ(F.id);this.jJ=new nd(ia,Ah.a.b_);this.Rha(this.jJ.eB,F);this.jJ.eB[Ah.a.PCa]=F.icon["16"];this.jJ.eB[Ah.a.aVa]=X.a.alwaysEnabled}};bb.prototype.addMenuItem=function(F){Xa.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",
F.actionType);var ia=new Ac(this.jQ(F.id));this.Rha(ia.eS,F);F.icon&&(ia.eS[Ah.a.PCa]=F.icon["16"]);this.Jsa(ia.eS[Ah.a.id],F.action);this.Y2(ia.eS);this.jJ.menuItems.add(ia)};bb.prototype.endBuildMenu=function(){Zi.c(this.jJ)?(this.Flc.add(this.TVa),this.TVa=null):(this.TVa.controls.add(this.jJ),this.jJ=null)};bb.prototype.Jsa=function(F,ia){this.enb.bindAction(F,ia)};bb.prototype.Y2=function(F){this.EHa.Y2(F)};bb.prototype.jQ=function(F){return this.B6.Ava(F)};bb.prototype.Rha=function(F,ia){F[Ah.a.Ygb]=
ia.label;F[Ah.a.MCa]=ia.label};Ck.Object.defineProperties(bb.prototype,{B6:{configurable:!0,enumerable:!0,get:function(){return this.Okb}},EHa:{configurable:!0,enumerable:!0,get:function(){return this.zfa}},enb:{configurable:!0,enumerable:!0,get:function(){return this.pfa}},Flc:{configurable:!0,enumerable:!0,get:function(){return this.dtg}}});Object(Lb.a)(bb,"ContextMenuExtensibilityCreator",null,[246,238]);Ca.prototype.Ava=function(F){return this.OOa+F};Ck.Object.defineProperties(Ca.prototype,{OOa:{configurable:!0,
enumerable:!0,get:function(){return this.MEa}}});Object(Lb.a)(Ca,"DefaultContextMenuNamingProvider",null,[245]);Jc.prototype.lNh=function(F){return this.n3g+F};Ck.Object.defineProperties(Jc.prototype,{bJj:{configurable:!0,enumerable:!0,get:function(){return this.eyg}},n3g:{configurable:!0,enumerable:!0,get:function(){return this.Fng}}});Object(Lb.a)(Jc,"DefaultRibbonGroupTemplate",null,[264]);Ck.Object.defineProperties(Ed.prototype,{Neb:{configurable:!0,enumerable:!0,get:function(){return this.Gmb}}});
Object(Lb.a)(Ed,"DefaultRibbonGroupTemplateResolver",null,[244]);var Ba=b(1363);Fc.prototype.bindAction=function(F,ia){OfficeExt.DefaultControlActionBinder.bindAction(F,ia)};Object(Lb.a)(Fc,"DefaultUIControlActionBinder",null,[242]);Gc.prototype.Y2=function(F){F[Ah.a.aVa]=this.command};Ck.Object.defineProperties(Gc.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.mDa}}});Object(Lb.a)(Gc,"DefaultUIControlCommandBinder",null,[239]);var fb=b(32);Object(Lb.a)(zb,"AddInControl",
null,[]);Object(Lb.a)(hb,"AddInGroup",null,[]);Object(Lb.a)(Ib,"AddInMenuItem",null,[]);Object(Lb.a)(nb,"AddInTab",null,[]);Cb.prototype.startBuildTab=function(F){var ia=F.isOfficeTab?F.id:this.B6.Lhd(F.id),Qa=F.isOfficeTab?null:F.label;this.$v=Object.assign(new nb,{id:ia,title:Qa,isOfficeTab:F.isOfficeTab,visible:F.visible,groups:[],tabType:F.tabType,insertBefore:F.insertBefore,insertAfter:F.insertAfter,autoFocus:F.autoFocus})};Cb.prototype.startBuildGroup=function(F){var ia=this.jQ(F.id);this.sx=
Object.assign(new hb,{id:ia,mlrId:F.mlrId,title:F.label,controls:[],groupType:0})};Cb.prototype.addNativeGroup=function(F){this.sx=Object.assign(new hb,{id:F.id,mlrId:F.mlrId,title:F.label,controls:[],groupType:1});this.$v.groups.push(this.sx)};Cb.prototype.addButton=function(F){var ia=this.jQ(F.id);ia&&(this.Jsa(ia,F.action),Xa.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",F.actionType),F=Object.assign(new zb,{id:ia,title:F.label,iconLocation:this.Lfd(F),enabled:F.enabled,
controlType:0,attributes:this.Rha()}),this.m7d.dme(new fb.a(ia,this.EHa.command.toString())),this.sx.controls.push(F))};Cb.prototype.addNativeControl=function(F){F.id&&(Xa.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",F.actionType),F=Object.assign(new zb,{id:F.id,title:"",iconLocation:"",enabled:F.enabled,controlType:2,attributes:this.Rha()}),this.sx.controls.push(F))};Cb.prototype.startBuildMenu=function(F){var ia=this.jQ(F.id);ia&&(this.h9=Object.assign(new zb,
{id:ia,title:F.label,iconLocation:this.Lfd(F),controlType:1,attributes:{},menuItems:[]}))};Cb.prototype.addMenuItem=function(F){var ia=this.jQ(F.id);ia&&(this.Jsa(ia,F.action),Xa.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",F.actionType),F=Object.assign(new Ib,{id:ia,title:F.label,iconLocation:this.Lfd(F),enabled:F.enabled,attributes:this.Rha()}),this.m7d.dme(new fb.a(ia,this.EHa.command.toString())),this.h9.menuItems.push(F))};Cb.prototype.endBuildMenu=function(){Zi.c(this.h9.id)||
this.sx.controls.push(this.h9);this.h9=null};Cb.prototype.endBuildGroup=function(){Zi.c(this.sx.id)||this.$v.groups.push(this.sx);this.sx=null};Cb.prototype.endBuildTab=function(){Zi.c(this.$v.id)||this.IQb.add(this.$v);this.$v=null};Cb.prototype.Rha=function(){var F={};this.Y2(F);return F};Cb.prototype.Lfd=function(F){return F.icon["80"]?F.icon["80"]:F.icon["32"]};Cb.prototype.Y2=function(F){this.EHa.Y2(F)};Cb.prototype.jQ=function(F){return this.B6.Ava(F)};Cb.prototype.Jsa=function(F,ia){this.enb.bindAction(F,
ia)};Ck.Object.defineProperties(Cb.prototype,{B6:{configurable:!0,enumerable:!0,get:function(){return this.Okb}},Qr:{configurable:!0,enumerable:!0,get:function(){return this.IQb}},Yzc:{configurable:!0,enumerable:!0,get:function(){return null}},enb:{configurable:!0,enumerable:!0,get:function(){return this.pfa}},EHa:{configurable:!0,enumerable:!0,get:function(){return this.zfa}}});Object(Lb.a)(Cb,"OneLineRibbonExtensibilityCreator",null,[237,238]);tb.prototype.r8=function(){for(var F=new sg.a,ia=Cl(this.xia),
Qa=ia.next();!Qa.done;Qa=ia.next())F.add(Qa.value.r8());F=qg.e.apply(null,[Ah.a.bVa,null].concat(F.toArray()));return qg.e(Ah.a.GROUP,this.ewa,F)};Ck.Object.defineProperties(tb.prototype,{Neb:{configurable:!0,enumerable:!0,get:function(){return this.Gmb},set:function(F){this.Gmb=F;this.ewa[Ah.a.X1d]=this.Gmb}},ewa:{configurable:!0,enumerable:!0,get:function(){return this.p8d||(this.p8d={})}},xia:{configurable:!0,enumerable:!0,get:function(){return this.l5d||(this.l5d=new sg.a)}}});Object(Lb.a)(tb,
"GroupDefinition",null,[]);Va.prototype.r8=function(){for(var F=new sg.a,ia=new sg.a,Qa=Cl(this.xNd),Ab=Qa.next();!Ab.done;Ab=Qa.next())F.add(Ab.value.r8());Qa=Cl(this.pK);for(Ab=Qa.next();!Ab.done;Ab=Qa.next())ia.add(Ab.value.r8());ia=this.Pve(Ah.a.Vgb,this.c6e,ia.toArray());F=this.Pve(Ah.a.LEc,this.KWf,F.toArray());return qg.e(Ah.a.V1d,this.vTa,F,ia)};Va.prototype.Pve=function(F,ia,Qa){var Ab={};Ab[Ah.a.id]=ia;return qg.e.apply(null,[F,Ab].concat(Qa))};Ck.Object.defineProperties(Va.prototype,{yBa:{configurable:!0,
enumerable:!0,get:function(){return this._id}},vTa:{configurable:!0,enumerable:!0,get:function(){return this.Rie||(this.Rie={})}},pK:{configurable:!0,enumerable:!0,get:function(){return this.q8d||(this.q8d=new sg.a)}},xNd:{configurable:!0,enumerable:!0,get:function(){return this.Sge||(this.Sge=new sg.a)}}});Object(Lb.a)(Va,"TabDefinition",null,[]);ub.prototype.startBuildTab=function(F){F=F.isOfficeTab?this.B6.WUh(F.id):this.B6.Lhd(F.id);this.$v=new Va(F)};ub.prototype.startBuildGroup=function(F){F=
this.jQ(F.id);this.sx=new tb(F)};ub.prototype.addButton=function(F){var ia=this.jQ(F.id);this.Jsa(ia,F.action)};ub.prototype.startBuildMenu=function(){};ub.prototype.addMenuItem=function(F){var ia=this.jQ(F.id);this.Jsa(ia,F.action)};ub.prototype.endBuildMenu=function(){};ub.prototype.endBuildGroup=function(){this.$v.pK.add(this.sx);this.sx=null};ub.prototype.endBuildTab=function(){Zi.c(this.$v.yBa)||this.Vie.add(this.$v);this.$v=null};ub.prototype.Jsa=function(F,ia){this.enb.bindAction(F,ia)};ub.prototype.jQ=
function(F){return this.B6.Ava(F)};Ck.Object.defineProperties(ub.prototype,{Qr:{configurable:!0,enumerable:!0,get:function(){return null}},B6:{configurable:!0,enumerable:!0,get:function(){return this.Okb}},enb:{configurable:!0,enumerable:!0,get:function(){return this.pfa}},Yzc:{configurable:!0,enumerable:!0,get:function(){return this.Vie}}});Object(Lb.a)(ub,"RibbonExtensibilityCreatorBase",null,[237,238]);La.prototype.r8=function(){return qg.k(this.cwg,null,this.X0)};Ck.Object.defineProperties(La.prototype,
{X0:{configurable:!0,enumerable:!0,get:function(){return this.Rge||(this.Rge={})}}});Object(Lb.a)(La,"ScalingDefinition",null,[]);Am(ua,ub);ua.prototype.startBuildTab=function(F){ub.prototype.startBuildTab.call(this,F);this.$v.isOfficeTab=F.isOfficeTab;if(!this.$v.isOfficeTab)this.$v.vTa[Ah.a.ofa]=this.o8b(F.label);else if(this.$v.yBa){var ia=this.B6.LSh(F.id);ia&&(this.$v.vTa[Ah.a.ofa]=ia);(F=this.B6.ISh(F.id))&&(this.$v.vTa[Ah.a.O1d]=F)}F=this.$v.yBa;this.$v.KWf=F+"."+Ah.a.LEc;this.$v.c6e=F+"."+
Ah.a.Vgb};ua.prototype.startBuildGroup=function(F){ub.prototype.startBuildGroup.call(this,F);this.sx.ewa[Ah.a.ofa]=this.o8b(F.label)};ua.prototype.addButton=function(F){ub.prototype.addButton.call(this,F);Xa.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",F.actionType);var ia=this.MU(F,Ah.a.button);this.Y2(ia.eB);ia.eB[Ah.a.OCa]=F.enabled;this.sx.xia.add(ia)};ua.prototype.startBuildMenu=function(F){this.h9=this.MU(F,Ah.a.b_)};ua.prototype.addMenuItem=function(F){ub.prototype.addMenuItem.call(this,
F);Xa.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",F.actionType);var ia=this.jQ(F.id);ia=new Ac(ia);this.Rha(ia.eS,F);this.Y2(ia.eS);ia.eS[Ah.a.OCa]=F.enabled;this.h9.menuItems.add(ia)};ua.prototype.endBuildMenu=function(){this.sx.xia.add(this.h9);this.h9=null};ua.prototype.endBuildGroup=function(){this.$Rg();this.$v.xNd.add(this.Cfa);this.Ffa&&(this.$v.xNd.add(this.Ffa),this.Ffa=null);this.Cfa=null;ub.prototype.endBuildGroup.call(this)};ua.prototype.Y2=function(F){this.EHa.Y2(F)};
ua.prototype.MU=function(F,ia){var Qa=this.jQ(F.id);ia=new nd(Qa,ia);this.Rha(ia.eB,F);return ia};ua.prototype.Rha=function(F,ia){F[Ah.a.Ygb]=this.o8b(ia.label);F[Ah.a.MCa]=this.o8b(ia.label);F[Ah.a.PCa]=ia.icon["16"];F[Ah.a.K1d]=ia.icon["32"]};ua.prototype.$Rg=function(){var F=this.a3h.Neb;this.sx.Neb=F.bJj;var ia=this.sx.xia.count;Xa.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",ia);var Qa=this.sx.ewa[Ah.a.id];this.Cfa=new La(Ah.a.IEc);this.Cfa.X0[Ah.a.id]=Qa+".Scaling."+Ah.a.IEc;this.Cfa.X0[Ah.a.FEc]=
this.sx.ewa[Ah.a.id];2<ia&&(this.Ffa=new La(Ah.a.KEc),this.Ffa.X0[Ah.a.id]=Qa+".Scaling."+Ah.a.KEc,this.Ffa.X0[Ah.a.FEc]=this.sx.ewa[Ah.a.id]);this.vtj(ia,F)};ua.prototype.vtj=function(F,ia){var Qa=1;switch(F){case 1:case 2:this.Cfa.X0[Ah.a.tpa]=Ah.a.LARGE;break;case 3:this.Cfa.X0[Ah.a.tpa]=Ah.a.LARGE;this.Ffa.X0[Ah.a.tpa]=Ah.a.uQb;break;case 4:this.Cfa.X0[Ah.a.tpa]=Ah.a.uQb+"TwoRow";this.Ffa.X0[Ah.a.tpa]=Ah.a.SMALL+"TwoRow";break;case 5:case 6:this.Cfa.X0[Ah.a.tpa]=Ah.a.uQb;this.Ffa.X0[Ah.a.tpa]=
Ah.a.SMALL;break;default:throw Xa.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",F),this.Fpa.setErrorMessageForAddin(this.SFc,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",F));}for(var Ab=Cl(this.sx.xia),Ec=Ab.next();!Ec.done;Ec=Ab.next())Ec.value.eB[Ah.a.Y1d]=ia.lNh(Qa),Qa+=3!==F?1:2};ua.prototype.o8b=function(F){return F?(F=Zc.a.replaceAll(F,"&","&amp;"),F=Zc.a.replaceAll(F,
"'","&apos;"),F=Zc.a.replaceAll(F,'"',"&quot;"),F=Zc.a.replaceAll(F,">","&gt;"),F=Zc.a.replaceAll(F,"<","&lt;")):null};Ck.Object.defineProperties(ua.prototype,{a3h:{configurable:!0,enumerable:!0,get:function(){return this.lqg}},EHa:{configurable:!0,enumerable:!0,get:function(){return this.zfa}}});Object(Lb.a)(ua,"RibbonExtensibilityCreator",ub,[]);ba.prototype.tve=function(F){F=new Ca(F);return new bb(F,this.zfa,this.pfa)};ba.prototype.XRg=function(F,ia,Qa){Qa=new Ba.a(this.MEa,F,Qa,!0);var Ab=new Ed(this.MEa+
"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new ua(Qa,this.pfa,this.zfa,Ab,F,ia)};ba.prototype.IRg=function(F,ia,Qa,Ab){Qa=new Ba.a(this.MEa,F,Qa,!0);return new Cb(Qa,this.pfa,this.zfa,F,ia,Ab)};Object(Lb.a)(ba,"UIExtensibilityFactory",null,[222]);var Vb=b(95),xc=b(1068);K.prototype.c$i=function(F){this.$o=F;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(od.a)(this,this.POi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",
Object(od.a)(this,this.gKi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(od.a)(this,this.KIi,"onCloseButtonClicked_ContentAddin"),!0))};K.prototype.Wgd=function(F){return"[id="+F+"]"};K.prototype.j5f=function(F,ia){var Qa=this;ia>this.rIg?(window.clearTimeout(this.RPf),this.i5f("[data-unique-id='pivotOverflowButton']"),Xa.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
F)?this.i5f(F):this.RPf=window.setTimeout(function(){Qa.j5f(F,ia+1)},1E3)};K.prototype.h5f=function(F){var ia=document.querySelector("button[data-unique-id='RightPaddle']");if(ia)F={},F=(F.AppTeachingUICalloutAction="RightPaddlePresent",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:wj.a.al(F)}));else if(ia=document.querySelector("button"+F),!ia||"none"===window.getComputedStyle(ia).display)if(ia=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ia){ia={};ia=(ia.AppTeachingUICalloutAction="NoAnchor",ia["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:wj.a.al(ia)}));Xa.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.qya();return}this.yag(ia,"ShowTeachingUIForAddinButton")};K.prototype.i5f=function(F){F=document.querySelector("button"+F);if(!F&&(F=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!F)){F={};F=(F.AppTeachingUICalloutAction="NoAnchor",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),F.AppTeachingUICalloutGoal=
"NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}));Xa.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.qya();return}this.yag(F,"ShowTeachingUIForAddinTab")};K.prototype.yag=function(F,ia){F.setAttribute("lpp-id","latestAddin");var Qa=ui.a.instance.lc("Common.ISystemInitiatedFeedback");Qa&&F?(Qa.execute(function(Ab){Ab.logActivity(ia,
null)}),F={},F=(F.AppTeachingUICalloutAction="Show",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)})),Xa.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Xa.ULS.sendTraceTag(537170689,220,15,
"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),F={},F=(F.AppTeachingUICalloutAction="NoSifFutureObject",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)})),this.qya())};K.prototype.wJh=function(F){if(!F)return null;F=F.UW;if((null===
F||void 0===F?0:F.Qr)&&0<F.Qr.count){F=Cl(F.Qr);for(var ia=F.next();!ia.done;ia=F.next())if(ia=ia.value,ia.groups&&0<ia.groups.length){ia=Cl(ia.groups);for(var Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa=Qa.value,Qa.controls&&0<Qa.controls.length){Qa=Cl(Qa.controls);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next()){Ab=Ab.value;if(Ab.attributes&&0===Ab.controlType&&Ab.enabled)return Ab.id;if(Ab.menuItems)for(var Ec=Cl(Ab.menuItems),Mc=Ec.next();!Mc.done;Mc=Ec.next())if(Mc=Mc.value,Mc.attributes&&Mc.enabled)return Ab.id}}}}return null};
K.prototype.tCj=function(){var F=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(F&&"none"!==window.getComputedStyle(F).display)Xa.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{F=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==F){F={};F=(F.AppTeachingUICalloutAction="NoAnchor",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.$o.storeType,this.$o.storeId,this.$o.assetId),F.AppTeachingUICalloutGoal=
"NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}));Xa.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.qya();return}Xa.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}var ia=ui.a.instance.lc("Common.ISystemInitiatedFeedback");null==ia||null==F?(F={},F=(F.AppTeachingUICalloutAction=
"NoSifFutureObject",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.$o.storeType,this.$o.storeId,this.$o.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)})),Xa.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.qya()):(ia.execute(function(Qa){Qa.logActivity("ShowTeachingUIForContentAddin",
null)}),F={},F=(F.AppTeachingUICalloutAction="Show",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.$o.storeType,this.$o.storeId,this.$o.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)})),Xa.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};K.prototype.POi=function(){var F=
{};F=(F.AppTeachingUICalloutAction="ClickOnLaunch",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.$o.storeType,this.$o.storeId,this.$o.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}));var ia={};ia[mj.a.Ag]=this.$o;F={};F.solutionId=this.$o.solutionId;F.assetId=this.$o.assetId;F.assetStoreId=this.$o.assetStoreId;F.height=
0!=this.$o.height?this.$o.height:600;F.storeId=this.$o.storeId;F.storeType=this.$o.storeType;F.targetType=this.$o.targetType;F.width=0!=this.$o.width?this.$o.width:600;F.displayName=this.$o.displayName;F.version=this.$o.version;F.isAddinCommands=!1;ia[Eg.a.nsa]=F;var Qa=new Vb.a(-741808261,0,0,2,null);mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.Ua(this.$.da,374,375,1),function(Ab){Ab=Ab.result;null!=Ab&&Ab.insertAgave(ia,Qa)},this.$.la,3)};K.prototype.KIi=function(){var F={};F=(F.AppTeachingUICalloutAction=
"ClickOnClose",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.$o.storeType,this.$o.storeId,this.$o.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}))};K.prototype.gKi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnDismiss",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.$o.storeType,this.$o.storeId,this.$o.assetId),
F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(F)}))};K.prototype.Icb=function(F){var ia={},Qa={};Qa.LastTeachingUIShowTime=(new Date).toUTCString();Qa.AddinHasShown=F;ia[this.appName]=Kg.c(Qa);this.Dpe=new vb(this.appName,null,null,Object(od.a)(this,this.g7,"postRequestFailureCallback")),this.Dpe.aub(ia),Xa.ULS.sendTraceTag(522981592,
306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")};K.prototype.qya=function(){if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var F=window.g_roamingAddinList;F&&this.Icb(F)}};K.prototype.g7=function(F){Xa.ULS.sendTraceTag(522981591,306,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.httpStatus:-1)};Object(Lb.a)(K,"AddinTeachingCalloutHandler",null,
[]);var bd=b(1310),$c=b(393),Pc=b(10),Hc=b(40);$a.prototype.dispose=function(){void 0!==this.job&&null!==this.job&&(this.job.dispose(),this.job=null);this.Ke=this.$=null;this.disposed=!0};$a.prototype.pxj=function(F,ia){switch(F){case X.a.c3:F=this.bxj(ia);break;default:F=!1}return F};$a.prototype.$c=function(){return!1};$a.prototype.executeCommand=function(F,ia,Qa){var Ab=this;F=mi.TaskExtensions.Dl();ia=ia.command;switch(ia){case 843847158:break;case -2025863019:uk.a.xSd(Qa[Eg.a.tWc].toString(),
function(){Ii.g(Ab.$).focus()});break;case -1777565636:bd.a.showUILessDialog(Qa[Eg.a.kob].toString());this.Ke.mAj(Qa[Eg.a.kob].toString());break;case 1592314317:bd.a.hideUILessDialog(Qa[Eg.a.kob].toString());this.Ke.C7h(Qa[Eg.a.kob].toString());break;case X.a.c3:F=this.$id(Qa);break;case X.a.PBb:this.QNa(Qa);break;case X.a.sna:this.sna(Qa);break;case X.a.ySd:this.job.ryc();break;case X.a.refreshAddinCommands:this.Y7i();break;case 1949669462:this.tha.UZf(!0);break;case -1014260128:F=this.executeDynamicAddInCommandsAPI(Qa);
break;default:F=$k.a(ia)}return F};$a.prototype.Kc=function(F,ia){F=!1;switch(ia.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case X.a.sna:case X.a.ySd:case X.a.refreshAddinCommands:case 1949669462:case X.a.PBb:case -1014260128:F=!0;break;case X.a.c3:F=!ke.AFrameworkApplication.protectedFile}return F};$a.prototype.jd=function(){return!1};$a.prototype.iNh=function(F){if(!F)return Xa.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((F=F.UW)&&
F.Qr&&0<F.Qr.count){F=Cl(F.Qr);for(var ia=F.next();!ia.done;ia=F.next()){ia=ia.value;if(ia.groups&&1===ia.groups.length){var Qa=ia.groups[0];if(Qa.controls&&1===Qa.controls.length){var Ab=Qa.controls[0];if(Ab.attributes&&!Ab.controlType&&Ab.enabled)return Ab.id}Qa.controls&&Xa.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ia.groups&&Xa.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};$a.prototype.Y7i=function(){if(this.tha.Gud()){this.tha.wze();var F=this.Tdd();
if(F&&0<F.count){F=Cl(F);for(var ia=F.next();!ia.done;ia=F.next()){var Qa={};ia=(Qa[Eg.a.l3]=ia.value,Qa[Eg.a.xM]=4,Qa[Eg.a.qGa]=(new Date).getTime(),Qa);this.sna(ia)}}}};$a.prototype.sna=function(F){var ia=this;Xa.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",F[Eg.a.xM],F[Eg.a.l3]);this.tha.Bpj();window.setTimeout(function(){if(void 0===ia.Ke||null===ia.Ke)Xa.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",
Hc.a.W3()));else{var Qa=new sd(new Sc(ia.Ke.Gi),Zb.instance,fc.instance);Qa.nEg(function(Ab,Ec){ia.QNa(Ec.properties)});ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Qa.LHg(function(Ab,Ec){null==Ec?(Ab={},Ab=(Ab.AppTeachingUICalloutAction="InvalidEventArgs",Ab.AppTeachingUICalloutGoal="NewAdminDeployment",
Ab["SDX.AppInstallOrigin"]="Organization",Ab),Hh.a.sendTelemetryEvent(Object(Wf.a)(new Ti.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:wj.a.al(Ab)}))):(ia.q9f=new K(ia),ia.q9f.c$i(Ec),Ab=ia.$.Ka,null!=Ab&&(Ab.rpe(Object(od.a)(ia,ia.pbf,"onTabSwitched")),Xa.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Qa.EOj(F)}},0)};$a.prototype.pbf=function(F,ia){"Insert"==ia.tabName&&(F=this.$.Ka,null!=F&&(F.IRf(Object(od.a)(this,this.pbf,"onTabSwitched")),Xa.ULS.sendTraceTag(527286662,
220,50,"Remove insertTabSwitched handler")),this.q9f.tCj())};$a.prototype.QNa=function(F){var ia=this;if(!this.disposed){Xa.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",F[Eg.a.xM]);try{if(cg.EwaSettings.ma(187)){var Qa=F[Eg.a.pZa];if(Qa&&0<Qa.count){for(var Ab=Qa.count,Ec=Ab-1;0<=Ec;Ec--){var Mc=Qa.oa(Ec);OSF.OsfControl.isFirstPartyStoreString(Mc.storeType)||Qa.remove(Qa.oa(Ec))}if(Qa.count<Ab){var zd=nj.GetServiceTaskFactory.Ua(this.$.da,5,4,0);mi.TaskExtensions.Ba(zd,function(){zd.result.eg(35,
null)},this.$.la,3)}if(!Qa.count)return}}if(void 0===this.Ke||null===this.Ke)Xa.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",Hc.a.W3()));else{var Ld=null;Ld=ke.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled")?new qd(this.Uo,this.NCe,new Sc(this.Ke.Gi),new ba(this.$.Lb,X.a.c3),this.tha,Zb.instance,this.sha,function(Te,rf){var dg={};dg.InstanceId=Tf.a.create().toString();dg.PrimaryMarketplace={};dg.PrimaryMarketplace.SolutionId=
Te.solutionId;dg.PrimaryMarketplace.SolutionVersion=Te.version;dg.PrimaryMarketplace.MarketplaceType=Te.storeType;dg.PrimaryMarketplace.MarketplaceRef=Te.storeId;dg.WebExtensionType=1;ia.Ke.zCj(dg,function(){rf(Te)})}):new qd(this.Uo,this.NCe,new Sc(this.Ke.Gi),new ba(this.$.Lb,X.a.c3),this.tha,Zb.instance,this.sha);(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)||ke.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled"))&&
Ld.wEg(this.vHi);Ld.oEg(this.NOi);if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var ye=new K(this);Ld.iGg(ye.MOi);Ld.KHg(ye.Zzj)}this.$.da.Aa(53).Wm&&Nk.a.get_instance().Lk(5,null).continueWith(function(){ia.disposed||Ld.qsi(ia.uad,ia.$.domElement,F)})}}catch(Te){Xa.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",Te.message))}}};$a.prototype.$id=function(F){var ia=mi.TaskExtensions.Dl();
F=F[this.Uo.yia];var Qa=this.j_b.ble(F),Ab=new bd.a(this.$,this.Ke,Qa.ownerAddinInfo,ia);return this.e6e(ia,F,Qa,Ab)};$a.prototype.e6e=function(F,ia,Qa,Ab){var Ec=this;this.j_b.$id(ia,this.tha,Ab,new Sc(this.Ke.Gi),Qa,function(){F=Ab.r2g()},function(){Ii.g(Ec.$).focus()});return F};$a.prototype.MNg=function(F){var ia=this,Qa=mi.TaskExtensions.Dl(),Ab=this.Ke.Waa(F.solutionId);if(Ab){var Ec=this.Ke.YZ(Ab);if(Pc.HelperMethods.Mw(Ec)&&0!==Ec.SharedRuntime.State)return}Ec=this.j_b.NNg;var Mc=F.solutionId in
Ec?Ec[F.solutionId]:null;if(Mc){var zd=this.j_b.ble(Mc),Ld=new bd.a(this.$,this.Ke,zd.ownerAddinInfo,Qa);Ec=function(Te){if(Te){var rf={};Te=Cl(Te);for(var dg=Te.next();!dg.done;dg=Te.next())dg=dg.value,rf[dg[0]]=dg[1];(rf=Eg.a.zpe in rf?rf[Eg.a.zpe]:null)&&"true"===rf.toLowerCase()&&(Xa.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",F.storeType,F.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,null!==zd.ownerAddinInfo?
zd.ownerAddinInfo.storeType:F.storeType,F.assetId,null,null,F.storeId)),ia.e6e(Qa,Mc,zd,Ld))}};Xa.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",F.storeType,F.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(F.solutionId,null!==zd.ownerAddinInfo?zd.ownerAddinInfo.storeType:F.storeType,F.assetId,null,null,F.storeId));if(Ab)Ec(this.Ke.YZ(Ab).OsfPropertyBag);else if(Ab=this.$.ea.workbookContext.WebExtensions){Ab=Cl(Ab);for(var ye=
Ab.next();!ye.done;ye=Ab.next())if(ye=ye.value,(1===ye.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===F.targetType&&ye.PrimaryMarketplace.MarketplaceType.toLowerCase()===F.storeType.toLowerCase()&&ye.PrimaryMarketplace.MarketplaceRef.toLowerCase()===F.storeId.toLowerCase()&&ye.PrimaryMarketplace.SolutionId.toLowerCase()===F.solutionId.toLowerCase()){Ec(ye.OsfPropertyBag);break}}}};$a.prototype.bNb=function(F,ia,Qa){F&&(void 0===Qa||!Qa||ia||this.q6c.contains(F)||
this.q6c.add(F),(Qa=this.X1a.contains(F))&&ia&&this.X1a.remove(F),Qa||ia||this.X1a.add(F))};$a.prototype.ftj=function(F){var ia=F.UW;if(ia){if(ia.Qr)for(F=Cl(ia.Qr),ia=F.next();!ia.done;ia=F.next())if(ia=ia.value,ia.groups){ia=Cl(ia.groups);for(var Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa=Qa.value,Qa.controls){var Ab=Cl(Qa.controls);for(Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,this.bNb(Qa.id,Qa.enabled,!0),1===Qa.controlType&&Qa.menuItems){var Ec=Cl(Qa.menuItems);for(Qa=Ec.next();!Qa.done;Qa=
Ec.next())Qa=Qa.value,this.bNb(Qa.id,Qa.enabled,!0)}}}}else if(F.tabs)for(F=Cl(F.tabs),ia=F.next();!ia.done;ia=F.next())if(ia=ia.value,ia.pK)for(ia=Cl(ia.pK),Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa=Qa.value,Qa.xia)for(Ab=Cl(Qa.xia),Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,this.bNb(Qa.id,jj.a.OCa in Qa.eB?Qa.eB[jj.a.OCa]:!0,!0),Qa.controlType===jj.a.b_&&Qa.menuItems)for(Ec=Cl(Qa.menuItems),Qa=Ec.next();!Qa.done;Qa=Ec.next())Qa=Qa.value,this.bNb(Qa.id,jj.a.OCa in Qa.eS?Qa.eS[jj.a.OCa]:!0,
!0)};$a.prototype.Tdd=function(){var F=new sg.a;cg.EwaSettings.ma(54)&&(this.$.ea.Zg.get(27)&&(F.add(0),F.add(16)),this.$.ea.Zg.get(33)&&F.add(1),F.add(8));return F};$a.prototype.executeDynamicAddInCommandsAPI=function(F){var ia=!0;if(void 0===F||null===F||void 0===F[Eg.a.itb]||null===F[Eg.a.itb])return rk.Task.Ra(!1);switch(F[Eg.a.itb]){case 1:ia=this.BRj(F);break;case 2:ia=this.jtj(F);break;case 4:this.X1a.clear();this.X1a.addRange(this.q6c);break;case 3:ia=this.installContextualTab(F);break;default:ia=
!1}return rk.Task.Ra(ia)};$a.prototype.bxj=function(F){return F&&this.Uo.yia in F?(F=F[this.Uo.yia])?this.X1a.contains(F):!1:!1};$a.prototype.BRj=function(F){var ia=null,Qa=null,Ab=null,Ec=!0;void 0!==F[Eg.a.w4]&&null!==F[Eg.a.w4]&&void 0!==F[this.Uo.yia]&&null!==F[this.Uo.yia]&&void 0!==F[Eg.a.v4]&&null!==F[Eg.a.v4]&&(ia=F[Eg.a.w4],Qa=F[Eg.a.W7b],Ab=F[this.Uo.yia],Ec=F[Eg.a.v4]);if(!ia||!Ab)return Xa.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),
!1;F=(new Ba.a(this.$.Lb,ia,this.Uo,!0)).Ava(Ab);ia={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ia.AssetId=Qa;ia.MaskedTabId=F;ia.IsToEnable=Ec;Xa.ULS.sendTraceTag(537170648,220,50,lj.a.Lc(ia));this.bNb(F,Ec);$c.a.gz.updateCommandUI();return!0};$a.prototype.jtj=function(F){var ia,Qa,Ab=null,Ec=null,Mc=null,zd=null,Ld=!0;void 0!==F[Eg.a.$7c]&&null!==F[Eg.a.$7c]&&void 0!==F[Eg.a.w4]&&null!==F[Eg.a.w4]&&void 0!==F[this.Uo.yia]&&null!==F[this.Uo.yia]&&void 0!==F[Eg.a.v4]&&null!==F[Eg.a.v4]&&
(Ab=F[Eg.a.$7c],Ec=F[Eg.a.w4],Mc=F[Eg.a.W7b],zd=F[this.Uo.yia],Ld=F[Eg.a.v4]);if(!Ab||!Ec||!zd)return Xa.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;F=(new Ba.a(this.$.Lb,Ec,this.Uo,!0)).Lhd(zd);zd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};zd.StoreType=Ab;zd.AssetId=Mc;zd.MaskedTabId=F;zd.IsToShow=Ld;Xa.ULS.sendTraceTag(537170646,220,15,lj.a.Lc(zd));Ec=this.tha.O4(Ab,Ec,1);Ab=!1;if(null===(Qa=null===(ia=null===Ec||void 0===
Ec?void 0:Ec.Ko)||void 0===ia?void 0:ia.UW)||void 0===Qa?0:Qa.Qr)for(ia=Cl(Ec.Ko.UW.Qr),Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa.value.id===F){Ab=!0;break}if(!Ab)return Xa.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;ia=[];Ld?appChrome.selectors.getSelectedTabId()!==F&&ia.push(appChrome.actions.activateRibbonTab(F)):(appChrome.selectors.getSelectedTabId()===F&&ia.push(appChrome.actions.setCurrentTab(bi.a.kX)),ia.push(appChrome.actions.deactivateRibbonTab(F)));
appChrome.api.dispatch(ia);return!0};$a.prototype.installContextualTab=function(F){var ia=null,Qa=null,Ab=null,Ec=null;if(void 0!==F[Eg.a.w4]&&null!==F[Eg.a.w4]&&void 0!==F[Eg.a.v4]&&null!==F[Eg.a.v4]){var Mc=F[Eg.a.v4];ia=F[Eg.a.w4];void 0!==Mc[Eg.a.cJa]&&null!==Mc[Eg.a.cJa]&&void 0!==Mc[Eg.a.dJa]&&null!==Mc[Eg.a.dJa]&&(Qa=Mc[Eg.a.cJa],Ab=Mc[Eg.a.dJa],Ec=Mc[Eg.a.a8c])}if(!(ia&&Ab&&Qa&&Ec))return Xa.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;F=this.tha.O4(Ec.PrimaryMarketplace.MarketplaceType,
Ec.PrimaryMarketplace.SolutionId,1);if(null===F||void 0===F?0:F.Ko)return Xa.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;F={};F.solutionId=Ec.PrimaryMarketplace.SolutionId;F.version=Ec.PrimaryMarketplace.SolutionVersion;F.storeType=Ec.PrimaryMarketplace.MarketplaceType;F.storeId=Ec.PrimaryMarketplace.MarketplaceRef;F.assetId=Ec.PrimaryMarketplace.SolutionId;F.assetStoreId=Ec.PrimaryMarketplace.MarketplaceRef;F.targetType=Ec.WebExtensionOsfControlType;F.width=
Ec.TaskpaneWidth;F.height=0;F.isAddinCommands=!0;Ec=new sg.a;Ec.add(F);F={};F[Eg.a.pZa]=Ec;F[Eg.a.xM]=6;F[Eg.a.cJa]=Qa;F[Eg.a.dJa]=Ab;this.QNa(F);return!0};Object(Lb.a)($a,"AddinUICommandHandler",null,[804,424,2]);var Jd=b(69),Qd=b(695),Be=b(20),mf=b(17),xf=Qj.a;Am(mb,xf);mb.prototype.Nd=function(){var F=this;Xa.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Jd.a(this.$).add(Object(Wf.a)(new Qd.a,{wxc:function(){var ia=F.$.ea.zF&&F.$.ea.sc&&!!(F.$.Pd&16384)&&
F.$.isEditMode;F.$.ea.sc&&Xa.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",ia,F.$.ea.zF,F.$.ea.sc,!!(F.$.Pd&16384),F.$.isEditMode);return ia},wYb:this.iAg,j6b:this.zch,iub:2}))};mb.prototype.H8i=function(F){var ia=this,Qa=nj.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub);return mi.TaskExtensions.Ba(Qa,function(){Xa.ULS.sendTraceTag(38942483,
0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");ia.$.da.Ga(204,new te(Qa.result,F))},this.la,3)};mb.ka=function(F){Qj.a.he(199,new mb(F))};Object(Lb.a)(mb,"AddinUICommandHandlerFactory",Qj.a,[]);var lg=b(1299),ng=b(1301),Gh=zi.a;Am(cd,Gh);cd.prototype.create=function(){var F=this,ia;if(cg.EwaSettings.ma(405)){var Qa=nj.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.ub),Ab=nj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,
this.ub);mi.TaskExtensions.Ba(rk.Task.WAA(Qa,Ab),function(){F.Eb(F.$.da.Aa(278)||new lg.CustomFunctionsInstaller(F.$,Qa.result,Ab.result))},this.$.la,3)}else(ia=this.$.da.Aa(278))||(ia=this.$.da.Ga(278,new ng.CustomFunctionsLegacyInstaller(this.$))),this.Eb(ia)};cd.ka=function(F){F.da.Ga(279,new cd(F))};Object(Lb.a)(cd,"CustomFunctionsInstallerFactory",zi.a,[]);var Kh=b(90),Ih=b(47),fj=b(44);hc.prototype.ka=function(F){this.fYc?Xa.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.fYc=!0,this.uQa={},this.vQa={},F?F.bFg(this.Bag):Xa.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};hc.prototype.detach=function(F){if(F){F.Kbj(this.Bag);F=this.uQa;for(var ia in F)Kh.a.Ha(F[ia]);this.vQa=this.uQa=null;this.fYc=!1}else Xa.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};hc.prototype.sNf=function(F,ia,Qa){if(this.Dfi(Qa,F))return!1;F=ia.querySelector("iframe");
if(!F)return Xa.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;F=F.title;if(!F||!F.length)return Xa.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(F);return!0};hc.prototype.Dfi=function(F,ia){return(F=F.Gi.getOsfControl(ia))?F.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(Lb.a)(hc,"AgaveOnSelectedReadoutHandler",null,[795]);var Oi=
zi.a;Am(Fb,Oi);Fb.prototype.create=function(){var F=this,ia=this.$.da;mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.Ua(ia,211,212,this.ub),function(Qa){Qa=ia.Aa(224)||new hc(Qa.result,F.$);F.Eb(Qa)},this.la,3)};Fb.ka=function(F){F.da.Ga(225,new Fb(F))};Object(Lb.a)(Fb,"AgaveOnSelectedReadoutHandlerFactory",zi.a,[]);var gi=b(946),oj=b(243);Tb.prototype.j7e=function(F){try{if(F&&F.rawEvent&&F.rawEvent.origin&&this.iframe&&this.iframe.id){var ia=this.NGf(F.rawEvent.origin),Qa=this.NGf(document.domain);
if(Wj.a.Pk().equals(Qa,ia))if(F.rawEvent.source&&F.rawEvent.source.frameElement&&F.rawEvent.source.frameElement.id&&Wj.a.Pk().equals(F.rawEvent.source.frameElement.id,this.iframe.id)){ia=null;try{ia=JSON.parse(F.rawEvent.data)}catch(Ab){Xa.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Ab.message)}ia?(ia.statusCode!==oj.a.tP||void 0!==ia.error&&ia.error?(Xa.ULS.sendTraceTag(23707648,344,50,
"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ia.statusCode,ia.error),this.onError()):(Xa.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ia.authorizationCode?ia.authorizationCode:ia.signInUrl)),$removeHandler(window,"message",Object(od.a)(this,this.j7e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):Xa.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):
Xa.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Xa.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Xa.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else Xa.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Xa.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ab){Xa.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ab.message)}};Tb.prototype.NGf=function(F){var ia="";try{F&&(ia=-1<F.indexOf("//")?F.split("/")[2]:F.split("/")[0])&&(ia=ia.split(":")[0],ia=ia.split("?")[0])}catch(Qa){Xa.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Qa.message)}return ia};Tb.ka=function(F,ia,Qa){new Tb(F,ia,Qa)};Object(Lb.a)(Tb,
"ResponseHandler",null,[]);var $i=b(260);Sa.prototype.tryAuthenticate=function(F,ia){this.mab(Sa.Kqg,function(){F()},ia)};Sa.prototype.tryAuthorize=function(F,ia){this.mab(Sa.Qlg,F,ia)};Sa.prototype.getSignInUrl=function(F,ia){this.mab(Sa.cie,F,ia)};Sa.prototype.signOut=function(F,ia){this.mab(Sa.Zwg,F,ia)};Sa.prototype.mab=function(F,ia,Qa){var Ab=new $i.QueryStringBuilder("AuthenticationProxyHandler.aspx");Ab.Yi("responseType",F);ke.AFrameworkApplication.VYa(Ab);Ab=String.format("{0}{1}&{2}",this.KFa,
Ab.toString(),ke.AFrameworkApplication.oj);var Ec=document.createElement("iframe");Ec.setAttribute("id","privateCatalogIframe");Ec.setAttribute("name","privateCatalogIframe");Ec.setAttribute("style","display: none");Wj.a.Pk().equals(F,Sa.cie)||Ec.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Tb.ka(Ec,ia,Qa);Ec.setAttribute("src",Ab);document.body.appendChild(Ec)};Sa.Qlg="authcode";Sa.Kqg="identitytoken";Sa.cie="signinurl";Sa.Zwg="signout";Object(Lb.a)(Sa,
"AuthenticationProxy",null,[]);xb.getUserId="getUserId";xb.getLastStoreUpdate="laststoreupdate";xb.getEntitlement="getEntitlements";xb.getEToken="getEToken";xb.getManifest="getManifest";xb.getAppState="getAppState";xb.getKilledApps="getRemovedAddins";xb.getAppDetails="getAppDetails";xb.removeApps="removeAddin";xb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";xb.getPrivateCatalogAddIns="getAddIns";xb.getPrivateCatalogManifests="getAppManifests";xb.isStoreDisabled="isStoreDisabled";Object(Lb.a)(xb,
"S2SWebRequestActions",null,[]);var Rj=b(638);Yb.prototype.getUserId=function(F,ia){var Qa=new sg.a;Qa.add(new Ai.a("corr",F));this.HX(xb.getUserId,Qa,1,ia)};Yb.prototype.getLastStoreUpdate=function(F,ia,Qa){var Ab=new sg.a;Ab.add(new Ai.a("lc",F));Ab.add(new Ai.a("corr",ia));this.HX(xb.getLastStoreUpdate,Ab,1,Qa)};Yb.prototype.getEntitlement=function(F,ia,Qa,Ab){F=new sg.a;F.add(new Ai.a("av",ia));F.add(new Ai.a("corr",Qa));this.HX(xb.getEntitlement,F,1,Ab)};Yb.prototype.getEToken=function(F,ia,
Qa,Ab,Ec,Mc){var zd=new sg.a;zd.add(new Ai.a("cmu",F));zd.add(new Ai.a("cmf",ia));zd.add(new Ai.a("assetid",Qa));zd.add(new Ai.a("expver",Ab));zd.add(new Ai.a("corr",Ec));this.HX(xb.getEToken,zd,1,Mc)};Yb.prototype.getManifest=function(F,ia,Qa,Ab){var Ec=new sg.a;Ec.add(new Ai.a("cmu",F));Ec.add(new Ai.a("assetid",ia));Ec.add(new Ai.a("corr",Qa));this.HX(xb.getManifest,Ec,1,Ab)};Yb.prototype.getAppState=function(F,ia,Qa){var Ab=new sg.a;Ab.add(new Ai.a("ma",F));Ab.add(new Ai.a("corr",ia));this.HX(xb.getAppState,
Ab,1,Qa)};Yb.prototype.getKilledApps=function(F,ia){var Qa=new sg.a;Qa.add(new Ai.a("corr",F));this.HX(xb.getKilledApps,Qa,1,ia)};Yb.prototype.getAppDetails=function(F,ia,Qa,Ab){var Ec=new sg.a;Ec.add(new Ai.a("cmo",F));Ec.add(new Ai.a("corr",Qa));this.sendWithBody(xb.getAppDetails,Ec,ia,2,Ab,!1)};Yb.prototype.removeApps=function(F,ia,Qa){var Ab=new sg.a;Ab.add(new Ai.a("corr",ia));this.sendWithBody(xb.removeApps,Ab,F,2,Qa,!1)};Yb.prototype.getLastPrivateCatalogUpdate=function(F,ia,Qa,Ab,Ec,Mc){var zd=
new sg.a;zd.add(new Ai.a("catalog","privatecatalog"));zd.add(new Ai.a("clientCode",F));zd.add(new Ai.a("clientVersion",ia));zd.add(new Ai.a("corr",Ec));F=String.format("authorizationCode={0}&refreshToken={1}",Qa?Zc.a.mf(Qa):"",Ab?Zc.a.mf(Ab):"");this.sendWithBody(xb.getLastPrivateCatalogUpdate,zd,F,2,Mc,!0)};Yb.prototype.getPrivateCatalogAddIns=function(F,ia,Qa,Ab,Ec,Mc){var zd=new sg.a;zd.add(new Ai.a("catalog","privatecatalog"));zd.add(new Ai.a("clientCode",F));zd.add(new Ai.a("clientVersion",ia));
zd.add(new Ai.a("corr",Ec));F=String.format("authorizationCode={0}&refreshToken={1}",Qa?Zc.a.mf(Qa):"",Ab?Zc.a.mf(Ab):"");this.sendWithBody(xb.getPrivateCatalogAddIns,zd,F,2,Mc,!0)};Yb.prototype.getPrivateCatalogManifests=function(F,ia,Qa,Ab,Ec){var Mc=new sg.a;Mc.add(new Ai.a("catalog","privatecatalog"));Mc.add(new Ai.a("corr",Ab));F=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Zc.a.mf(F),ia?Zc.a.mf(ia):"",Qa?Zc.a.mf(Qa):"");this.sendWithBody(xb.getPrivateCatalogManifests,
Mc,F,2,Ec,!0)};Yb.prototype.isStoreDisabled=function(F,ia){var Qa=new sg.a;Qa.add(new Ai.a("corr",F));this.HX(xb.isStoreDisabled,Qa,2,ia)};Yb.prototype.HX=function(F,ia,Qa,Ab){this.sendWithBody(F,ia,null,Qa,Ab,!1)};Yb.prototype.sendWithBody=function(F,ia,Qa,Ab,Ec,Mc){var zd=new $i.QueryStringBuilder("AddinServiceHandler.ashx");zd.Yi("action",F);zd.Yi("app",Rj.a[ke.AFrameworkApplication.sa.Pa.Sj]);ia=Cl(ia);for(var Ld=ia.next();!Ld.done;Ld=ia.next())Ld=Ld.value,zd.Yi(Ld.key,Ld.value);zd=String.format("{0}{1}&{2}",
ke.AFrameworkApplication.sa.Pa.LW,zd.toString(),ke.AFrameworkApplication.oj);ke.AFrameworkApplication.Jd.hm(zd,Ab,Qa,null,!1,2,function(ye){var Te=null;ye&&ye.data&&(ye.data.responseHeaders["X-BlockedForMinor"]&&"1"===ye.data.responseHeaders["X-BlockedForMinor"].toString()&&(ye.data.httpStatus=451),Te=ye.data.me);Ec(ye.data.httpStatus,Te)},function(ye){var Te=null;Mc&&ye&&ye.data&&ye.data.me&&(Te=ye.data.me);Ec(ye.data.httpStatus,Te);if(ke.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){Te={message:"AddinServiceHandler request failed"};Te.code=ye.data.httpStatus;Te.action=F;if(ye.data.request||ye.data.request.get_headers())Te["X-UserSessionId"]=ye.data.request.get_headers()["X-UserSessionId"];408===ye.data.httpStatus||503===ye.data.httpStatus?Xa.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Te)):Xa.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Te))}else Xa.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",ye.data.httpStatus)},null,void 0,void 0,void 0,
void 0,"AddinServiceHandler_"+F)};Object(Lb.a)(Yb,"S2SWebRequestManager",null,[]);var pj=zi.a;Am(Ob,pj);Ob.prototype.create=function(){var F=this;Xa.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");ke.AFrameworkApplication.disableWholeAppsForOfficeFeature?Xa.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",ke.AFrameworkApplication.disableWholeAppsForOfficeFeature):cg.EwaSettings.ma(409)?ui.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ia){ia.isFeatureEnabled("mso_officeStore",
!0).then(function(Qa){gi.DdaFacade.j3c=Qa;F.UEe();return null})}):this.UEe()};Ob.prototype.UEe=function(){var F=this,ia=nj.GetServiceTaskFactory.Ua(this.$.da,224,225,this.ub),Qa=Vf.a.Cud(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.ub,106),Ab=Cc(this.la,this.ub);mi.TaskExtensions.Ba(mi.TaskExtensions.xe([ia,Qa,Ab],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Xa.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
Hc.a.W3()):F.cai();Xa.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");F.rNf=ia.result;F.Eb(F.Ke);Xa.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Ob.prototype.cai=function(){cg.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Yb);this.$.Yf.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Yb,new Sa(ke.AFrameworkApplication.ga.appSettings.WebServiceBase),cg.EwaSettings.ma(72),
cg.EwaSettings.ma(436))};Ob.prototype.dispose=function(){Kh.a.Ha(this.ddaFacade);this.$=this.ddaFacade=null;pj.prototype.dispose.call(this)};Ob.ka=function(F){new Ob(F)};Ck.Object.defineProperties(Ob.prototype,{Ke:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new gi.DdaFacade(this.$,this.rNf))}}});Object(Lb.a)(Ob,"DdaFacadeServiceFactory",zi.a,[]);Ub.prototype.jd=function(){return!1};Ub.prototype.$c=function(){return!1};Ub.prototype.Kc=function(F,ia,Qa,Ab){var Ec=
!1;switch(ia.command){case -684355545:Ec=!0;break;case -741808261:Ec=!!Qa;break;case -859308420:Ec=!!Ab&&1===Ab.Qx;break;case 418618014:Ec=1===F&&!!Ab&&1===Ab.Qx;break;case -515602470:ia=cg.EwaSettings.ma(235)&&2===F;Ec=(1===F||ia)&&!!Ab&&1===Ab.Qx;break;case 2086613372:Ec=cg.EwaSettings.ma(235)&&2===F&&!!Ab&&1===Ab.Qx;break;case -1336341324:Ec=cg.EwaSettings.ma(485)&&1===F&&!!Ab&&1===Ab.Qx;break;case 451940422:Ec=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",
!1)&&1===F&&!!Ab&&1===Ab.Qx;break;case -1444574190:case -336193495:Ec=1===F&&!!Ab&&1===Ab.Qx;break;case 1296389134:Ec=1===F&&!!Ab&&1===Ab.Qx;break;case -1473679467:Ec=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===F&&!!Ab&&1===Ab.Qx;break;case 1221897806:Ec=cg.EwaSettings.ma(167)&&2===F;break;case 1172793074:case 1930653487:Ec=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===F;break;case -1753056834:Ec=
cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Ec=!0;break;case 301511274:Ec=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Ec=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Ec=this.$.isEditMode&&this.$.ea.nLb}return Ec};Ub.prototype.executeCommand=function(F,ia,Qa){var Ab=mi.TaskExtensions.Dl(),
Ec=ia.command;switch(ia.command){case -1473679467:qk.a(this.$,488,489,1,function(Mc){Ab=Mc.$ci(Qa.SourceControlId,ia)});break;case 1296389134:this.agaveCommandManager.wFj(Qa.SourceControlId,Qa.LabelText);break;case -684355545:this.agaveCommandManager.C_c();break;case -741808261:Ab=this.agaveCommandManager.insertAgave(Qa,ia);qk.a(this.$,488,489,1,function(Mc){Mc.JAg(Qa)});break;case -1336341324:cg.EwaSettings.ma(485)&&(Ab=this.agaveCommandManager.njd(Qa,F,ia));break;case 1172793074:cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(Ab=this.agaveCommandManager.njd(Qa,F,ia));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:Ab=this.agaveCommandManager.njd(Qa,F,ia);break;default:Ab=$k.a(Ec)}return Ab};Object(Lb.a)(Ub,"AgaveCommandHandler",null,[424]);Object(Lb.a)(yd,"Selection",null,[]);Object(Lb.a)(ec,"SmartLookupApplicationInterface",null,[]);Object(Lb.a)(Ya,
"ApplicationProperties",null,[]);Object(Lb.a)(rb,"EnterpriseUserInfo",null,[]);Object(Lb.a)(pb,"FeatureGates",null,[]);nc.prototype.mZh=function(){var F=void 0===F?!0:F;var ia=this.dHe();if(ia<this.dwd+this.vLj)return ia>this.dwd+this.yLj&&this.Pdd(),this.zof;F&&this.Pdd();return""};nc.prototype.Pdd=function(){var F=this;this.gwd=this.gwd||new Promise(function(ia){F.nZh().then(function(Qa){F.zof=Qa;F.dwd=F.dHe();F.gwd=null;ia(Qa)})})};nc.prototype.nZh=function(){var F=this;return this.$8a&&this.$8a.length?
new Promise(function(ia){F.jya.jT("SmartLookup",F.$8a).then(function(Qa){Qa.IsSuccess?Qa.Token||(ia(""),Xa.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Xa.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Qa.ErrorCode+": "+Qa.ErrorMessage),ia(""));ia(Qa.Token)}).catch(function(Qa){Qa=Kg.c(Qa);Xa.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Qa);ia("")})}):(Xa.ULS.sendTraceTag(51446543,
1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(Lb.a)(nc,"SmartLookupAuthenticationManager",null,[327]);Pa.uPh=function(){switch(Object(Oh.a)(String,ke.AFrameworkApplication.dc.AudienceGroup)||""){case "Dogfood":if(ke.AFrameworkApplication.ga){var F=ke.AFrameworkApplication.ga.Va("UserPrincipalName");F=Zc.a.Wl(F);var ia=ke.AFrameworkApplication.ga.qz("SmartLookupINTEnabledForSKITeam")?ke.AFrameworkApplication.ga.Kw("SmartLookupINTEnabledForSKITeam"):[];return 0<=
Array.indexOf(ia,F)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};Pa.LYh=function(){switch(ke.AFrameworkApplication.ga.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":ke.AFrameworkApplication.ga.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":ke.AFrameworkApplication.ga.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":Pa.uPh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(Lb.a)(Pa,"Utils",null,[]);var mh=b(619);cc.prototype.$Jh=function(){return Promise.resolve(this.aKh())};cc.prototype.aKh=function(){var F=new Ya;F.anid="";F.applicationVersion=ke.AFrameworkApplication.buildVersion;F.appCorrelationId=Ij.a.create().toString();F.themePlatform=cc.nXj;F.lcid=ke.AFrameworkApplication.lcid;F.launchUtcTime=(new Date).toUTCString();F.featureGates=this.Z8a;var ia=mh.a.hK(ke.AFrameworkApplication.lcid);
ia=ia?ia.name:null;F.market=this.kbc(ia);F.uiLanguage=ia;F.sessionId=ke.AFrameworkApplication.userSessionId;F.themeId=0;F.parentalControl=cc.yXi;var Qa=new rb;Qa.CountryCode=this.kbc(ia);Qa.ServiceEndpoint=this.$8a;Qa.IsGoLocal=!1;Qa.IsEnabled=this.fpf;Qa.IsEnterpriseEnabled=this.fpf;Qa.TenantRoot=this.wyi;F.enterpriseUserInfo=Qa;F.accessToken=this.qyi.mZh();return F};cc.prototype.kbc=function(F){F=F.split("-");return F[F.length-1]};Ck.Object.defineProperties(cc.prototype,{approvedOriginPattern:{configurable:!0,
enumerable:!0,get:function(){return this.Rxi}}});cc.nXj="web";cc.yXi="yes";Object(Lb.a)(cc,"SmartLookupManager",null,[296]);var ni=Ak.a;Am(ib,ni);ib.prototype.jd=function(){return!1};ib.prototype.$c=function(){return!1};ib.prototype.Kc=function(F,ia){F=cg.EwaSettings.ma(135);return-983891024===ia.command&&F};ib.prototype.executeCommand=function(F,ia){F=mi.TaskExtensions.Dl();-983891024===ia.command&&this.$ri();return F};ib.prototype.$ri=function(){var F=this,ia=new cc(null),Qa={},Ab=Ii.g(this.$).mc(null).originalText;
Ab=Object(Wf.a)(new yd,{neighborhood:Ab,mentionStart:0,mentionLength:Ab?Ab.length:0});var Ec=Object(Wf.a)(new ec,{selection:Ab,entryPoint:0});ia.$Jh().then(function(zd){zd.applicationName=ib.appName;zd.isFirstLaunch=F.isFirstLaunch;zd.themeId=5;Qa[ib.smartLookupApplicationInterface]=JSON.stringify(Ec);Qa[ib.sKg]=JSON.stringify(zd);F.isFirstLaunch=!1});ia=new Kj.a("ExcelOnline","Web","en-Us");Ab=new ck.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Mc=new dk.a;Mc.ri[ld.ml]=
Cf.a.instance.fa(1770);Mc.ri[ld.taskPaneWidth]=350;Mc.ri[ld.sourceLocationOverrideResourceId]="WAC.PROD.URL";Mc.pr=Qa;eh.a.instance.RNa(Ab,"Taskpane","SmartLookupSDXTaskpane",ia,Mc)};ib.sKg="AppProperties";ib.appName="Excel";ib.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(Lb.a)(ib,"SmartLookupCommandHandler",Ak.a,[424]);var Ji=Qj.a;Am(eb,Ji);eb.prototype.Nd=function(){var F=this;qk.a(this.$,374,375,this.ub,function(ia){F.Dd([new Ub(F.$,null,null,null,null,ia),new ib(F.$)])})};
eb.ka=function(F){Qj.a.he(76,new eb(F))};Object(Lb.a)(eb,"AgaveCommandHandlerFactory",Qj.a,[]);Object(Lb.a)(function(){},"AppInfoDetail",null,[]);b(1149);Object(Lb.a)(function(){},"AppsForOfficeUtils",null,[]);Object(Lb.a)(lc,"AppsDataManager",null,[204]);var Xi=b(1364),Lj=b(106);pc.prototype.initialize=function(F){pc.initialized||(this.Ke=F,this.Og(),pc.initialized=!0)};pc.prototype.Og=function(){ke.AFrameworkApplication.Ib.Ze(X.a.Vab,Lj.a.frame,this.Vab,96);ke.AFrameworkApplication.Ib.fc(X.a.x8i,
Lj.a.frame,this.H9i)};Ck.Object.defineProperties(pc,{instance:{configurable:!0,enumerable:!0,get:function(){pc.Ma||(pc.Ma=new pc);return pc.Ma}}});pc.Ma=null;pc.initialized=!1;Object(Lb.a)(pc,"AgaveCommandActor",null,[]);var Bi=b(112),Lh=b(372),Th=b(368),Yi=b(1323),gj=b(358);Object(Lb.a)(Db,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(Lb.a)(Wa,"IdeasSelectionContext",null,[]);Am(Fa,Wa);Object(Lb.a)(Fa,"IdeasTableSelectionContext",Wa,[]);var Ki=b(63),oi=b(45),fk=b(387),Dh=b(166),jk=b(628),ak=
b(132),jl=b(149),Gk=b(182),xj=jl.a;Am(sa,xj);sa.prototype.uD=function(){xj.prototype.uD.call(this);this.Pp.style.width=this.y3d;this.Pp.style.height=this.KVa;this.Pp.style.marginTop=this.IRb;this.Pp.style.padding=this.LVa};sa.prototype.qQa=function(){this.Pp.style.width=this.y3d;this.Pp.style.height=this.KVa;this.Pp.style.marginTop=this.IRb;this.Pp.style.padding=this.LVa;this.ADa>Gk.a.Z$a?(this.Nb.style.width=String.format("{0}px",Gk.a.Z$a),this.Nb.style.overflowX="scroll",ke.AFrameworkApplication.isRtl?
this.Nb.style.right="0":this.Nb.style.left="0"):(this.Nb.style.width=String.format("{0}px",this.ADa),this.Nb.style.overflowX="hidden");this.Nb.offsetHeight>Gk.a.Y$a||this.qog+50>Gk.a.Y$a?(this.Nb.style.height=String.format("{0}px",Gk.a.Y$a),this.Nb.style.overflowY="scroll",this.Nb.style.top="0",ke.AFrameworkApplication.isRtl?this.Nb.style.right="0":this.Nb.style.left="0",this.DIc||(this.Nb.style.marginTop="-48px"),this.Pp.style.minHeight=String.format("{0}px",this.emg)):(this.Nb.style.overflowY="hidden",
this.Nb.style.top="10%",this.Nb.style.height=this.Aib);this.d0a()};sa.prototype.d0a=function(){if(this.Nb){var F=this.Nb.style.zIndex;this.Nb.style.zIndex="-9999";if(this.ADa>Gk.a.Z$a)ke.AFrameworkApplication.isRtl?this.Nb.style.marginRight="0":this.Nb.style.marginLeft="0";else{var ia=String.format("{0}px",Math.floor(-this.Nb.offsetWidth/2));ke.AFrameworkApplication.isRtl?this.Nb.style.marginRight=ia:this.Nb.style.marginLeft=ia;ke.AFrameworkApplication.isRtl?this.Nb.style.right="50%":this.Nb.style.left=
"50%"}this.Nb.style.zIndex=String(F)}else Xa.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};sa.prototype.UO=function(){xj.prototype.UO.call(this);var F=document.getElementById(this.pi(this.pog));F.style.width=String.format("{0}px",this.ADa);F.style.height=this.Aib};Ck.Object.defineProperties(sa.prototype,{R1a:{configurable:!0,enumerable:!0,get:function(){return this.Pp}}});Object(Lb.a)(sa,"AppsForOfficeInsertionDialog",jl.a,[297]);var hj=b(1163),gk=Ak.a;Am(Oa,gk);Oa.prototype.UFg=
function(F){this.addHandler(Oa.qDd,F)};Oa.prototype.ucj=function(F){this.removeHandler(Oa.qDd,F)};Oa.prototype.dispose=function(){Kh.a.Ha(this.Iwa);this.Iwa=null;gk.prototype.dispose.call(this)};Oa.prototype.C_c=function(){this.Iwa.hide()};Oa.prototype.wFj=function(F,ia){if(F){this.raiseEvent(Oa.qDd);var Qa=F.split("|");this.$vi(F,ia,Qa);this.Iwa=new sa;this.Iwa.initializeAndShow("",null,null);this.Ke.ssi(this.Iwa.R1a,Qa)}};Oa.prototype.njd=function(F,ia,Qa){var Ab=mi.TaskExtensions.Dl();if(-515602470===
Qa.command||-336193495===Qa.command||2086613372===Qa.command||-1444574190===Qa.command||-1336341324===Qa.command||451940422===Qa.command)Ab=this.i4h(F,ia,Qa);418618014===Qa.command&&(ia=new Wi.a,ia.ml=Cf.a.instance.fa(1781),Ab=this.l1(Qa,Oa.n7h,ia,!0));if((Qa.tabName===this.$.Lb+bi.a.NUf||Qa.tabName===bi.a.K0)&&2===Qa.Xe||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),F[mj.a.ld])||F[mj.a.ld]===bi.a.fW)return this.Q6e(F,Qa);if(7===Qa.Xe&&F.SourceControlId===this.$.Lb+
bi.a.kdc)return F.MenuItemId=bi.a.VHd,this.Q6e(F,Qa);1221897806===Qa.command&&(Ab=this.R3f(Qa,"Format"));if(1930653487===Qa.command||1172793074===Qa.command)Ab=this.R3f(Qa,"Data");-1753056834===Qa.command&&(Ab=this.gBj(Qa));932597253===Qa.command&&(Xa.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Ea.c(932597253,!0),ia=new Wi.a,ia.ml=Cf.a.instance.fa(2110),ia.sourceLocationOverrideResourceId=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?Oa.a0i:Oa.c0i,ia.focusOnIframeWhenLoaded=!0,ia.taskPaneWidth=Oa.t$e,Ab={},Ab.LaunchSource=Object(Oh.a)(String,F.SourceControlId),Ab.LaunchMode="Default",ia.qI=Ab,Ab=this.l1(Qa,Oa.b0i,ia,!0));301511274===Qa.command&&(Ab=this.qBj(Qa));515196233===Qa.command&&((ia=this.$.da.Aa(465))&&ia.a9e(),ia=new Wi.a,ia.ml=Cf.a.instance.fa(2179),Ab={},Ab.SourceUILocation=Lh.a[Qa.Xe],ia.qI=Ab,Ab=new jc,Ab.xba=ze.a.P2a,Ab=this.l1(Qa,Oa.lWi,ia,!0,Ab,void 0,ia.ml));1723441034===Qa.command&&(ia=new Wi.a,ia.ml=Cf.a.instance.fa(2191),
ia.focusOnIframeWhenLoaded=!0,ia.taskPaneWidth=Oa.$2i,Ab=new jc,Ab.xba=ze.a.Lqh,Ab=this.l1(Qa,Oa.Z2i,ia,!0,Ab));cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&F.LoadDataFromPictureTaskpane&&(ia={},Ab=new Wi.a,Ab.ml=Cf.a.instance.fa(2217),ia.SessionID=F.SessionID,Ab.qI=ia,Ab.focusOnIframeWhenLoaded=!0,Ab=this.l1(Qa,F.DataFromPictureAssetId,Ab,!0));return Ab};Oa.prototype.insertAgave=function(F,ia){var Qa=this,Ab=mi.TaskExtensions.Dl(),Ec=this.$,Mc=F[Eg.a.nsa];
if("SourceControlId"in F){var zd={};Xa.ULS.sendTraceTag(523819228,220,15,"insertAgave with SourceControlId called.");var Ld=F.SourceControlId.split("|");if(8!==Ld.length||!(Ld[0]&&Ld[1]&&Ld[2]&&!isNaN(parseInt(Ld[2],10))&&Ld[3]&&!isNaN(parseInt(Ld[3],10))&&Ld[4]&&Ld[5]&&!isNaN(parseInt(Ld[5],10))&&Ld[6]&&Ld[7]))return mi.TaskExtensions.h5();Mc={};Mc.version=zd.Version=Ld[0];Mc.assetId=zd.AssetId=Ld[1];Mc.solutionId=zd.SolutionId=Ld[1];Mc.height=zd.Height=parseInt(Ld[2],10);Mc.width=zd.Width=parseInt(Ld[3],
10);Mc.storeId=zd.StoreId=Ld[4];Mc.targetType=zd.TargetType=parseInt(Ld[5],10);Mc.assetStoreId=zd.AssetStoreId=Ld[6];Mc.storeType=zd.StoreType=Ld[7]}else zd=F[mj.a.Ag];Ld=null;jc.key in F&&(Ld=F[jc.key]);this.Iwa&&this.Iwa.hide();if(!zd||!Mc)return Xa.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Ab;this.$.X5&&bi.a.Doa in F&&(zd.EnabledInViewMode=F[bi.a.Doa]);F=this.FMh(ia.command);if(!zd.EnabledInViewMode&&!Ec.Dq(null,!1,F))return Ab;var ye=void 0===zd.IsToBePersisted||
null===zd.IsToBePersisted||zd.IsToBePersisted?0:16;if(1===zd.TargetType)Ab=this.udi(zd,Mc,ia,Ld,ye);else{Mc=Ii.g(Ec);Ab=this.viewBlockContainerHelpers.igb(Mc);var Te=Ec.ea.isNamedObjectViewMode?Ec.qa.sheetName:Ec.qa.name;if(Ab){Mc=Ab.tf;var rf=Mc.uf.top;var dg=Mc.uf.left;var Jg=Ab.cJ.x;var dh=Ab.cJ.y}else rf=dg=1,Ab=this.viewBlockContainerHelpers.gLa(Mc),Jg=Ab.x,dh=Ab.y;var bj=this.$.na.va.hc();Ab=function(uh,hi,vi){var l=Ec.na.va,J=zd,Y=rf,za=dg,Ua=Jg,Qb=dh;uh=Gi.b(uh,Qa.S_i);var uc=l.Na(9,bj);uc.sharedInfo=
J;uc.sheetName=Te;uc.positionRow=Y;uc.positionCol=za;uc.positionOffsetX=Ua;uc.positionOffsetY=Qb;return ej.i(l,"InsertWebExtension",uc,uh,hi,vi,null,0)};cg.EwaSettings.qc()?(ye|=64,Ab=fk.a(this.$.userOperationManager,Ab,function(uh){return new yk.a(534,0,uh,ye)},ia)):Ab=fk.a(this.$.userOperationManager,Ab,function(uh){return new Hk.a(534,0,uh,ye)},ia)}return Ab};Oa.prototype.j2g=function(){var F=ui.a.instance.lc("Common.App.ICustomerFeedbackUiWrapper"),ia=ui.a.instance.lc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");
this.Jad?this.Jad.$jb?this.Rxe():ia.instance.H7c(this.pAh):Xa.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");ia={};ke.AFrameworkApplication.ga.Lme(ia);F=F.instance.getContext(ia);ia={};"telemetryGroup"in F&&(ia=F.telemetryGroup);ia.processSessionId=F.sessionId;ia.officeBuild=F.build;F.telemetryGroup=ia;F.feedbackType=-1;F.userVoiceEnabled=!1;"disableIncludeScreenshot"in F||(F.disableIncludeScreenshot=!1);"screenshot"in F||(F.screenshot=!1);F.disableScreenshotPreview=!1;F.includeScreenshotSelectedDefault=
!0;return F};Oa.prototype.p0i=function(F){if(!this.Gza&&cg.EwaSettings.ma(716)&&cg.EwaSettings.getBooleanFeatureGate(Oa.g9h,!1)){var ia=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";ia=this.xve(ia);var Qa=new jc;Qa.Qk=ze.a.i9b;this.Gza=this.ANd(ia,null,!1,null,Qa);ia={};ak.b(this.$).Vd(Ui.a.q0i,(ia.Location=Lh.a[F.Xe],ia.InputMethod=Th.a[F.method],ia),void 0,!0)}};Oa.prototype.VZf=function(F){var ia=this.$.ea.Zg.get(17);
ui.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Qa){Qa.isFeatureEnabled("mso_sendASmile",ia).then(function(Ab){F.FeedbackEnabled=ia&&Ab;return null})})};Oa.prototype.R3f=function(F,ia){var Qa=Ii.g(this.$),Ab=new Wi.a,Ec={};Ec.ActiveTab=ia;Ec.DatapaneFlighting=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Ec.RangePickerFlighting=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",
!1);Ec.AceFlighting=!0;Ec.ChartNewSDXRecording=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Ec.ThemeColorsFlighting=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Ec.UOMirror=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Ec.FormatTaskPaneAceButtonDark=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);Ec.FormatTaskPaneBetterFeedbackButton=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Ec.FormatTaskPaneBetterScrollbar=cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.VZf(Ec);Ec.startTimeMs=Date.now();Ec.UserSessionId=this.$.ya.UserSessionId;(ia=Qa.ha.Oa.Oo)&&(Ec.SubSelection=ia);Xa.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",
Ec.UserSessionId,void 0===F.Xe||null===F.Xe?"Null":Lh.a[F.Xe],ia||"ChartRoot");Ab.qI=Ec;Ab.ml=Cf.a.instance.fa(963);Ec=new jc;Ec.xba=ze.a.P2a;return this.l1(F,Oa.bXg,Ab,!0,Ec)};Oa.prototype.gBj=function(F){var ia=new Wi.a;ia.qI={};ia.ml=Cf.a.instance.fa(1769);ia.fT=Oa.Glf;var Qa=new jc;Qa.xba=ze.a.P2a;return this.l1(F,Oa.Glf,ia,!0,Qa,void 0,ia.ml)};Oa.prototype.qBj=function(F){var ia=new Wi.a;ia.qI={};ia.ml=Cf.a.instance.fa(2134);var Qa=new jc;Qa.xba=ze.a.Ash;Qa.ENb=ze.a.jPe;return this.l1(F,Oa.ADi,
ia,!0,Qa)};Oa.prototype.Q6e=function(F,ia){var Qa=Oa.V8e,Ab=F[mj.a.ld].toString(),Ec={},Mc=new Wi.a;Mc.ml=Cf.a.instance.fa(9);switch(Ab){case "A0":Ec.query=(F[mj.a.Ag]||"").split("|").slice(2,gj.a.wT).join("|");break;case "A1":Ec.query=F.CommandValueId;break;case "Help":Ec.gwdropdownflightinfo=cg.EwaSettings.ma(240);Ec.query="";break;case bi.a.VHd:cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Mc.ml=Cf.a.instance.fa(1735),Mc.sourceLocationOverrideResourceId=
Oa.C5e,Ec.feedback=this.j2g()):Ec.query=Ab;break;case "HelpArticle":Ec.query=F[mj.a.Ag];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Ec.query=Ab;break;default:return rk.Task.Ra(!0)}Mc.qI=Ec;Ab=new jc;Ab.xba=ze.a.P2a;return this.l1(ia,Qa,Mc,!1,Ab,F[bi.a.Doa]||!1)};Oa.prototype.xve=function(F){var ia={Version:"0.0.0.0"};ia.AssetId=Oa.Bwa;ia.SolutionId=Oa.Bwa;ia.AssetStoreId="";ia.StoreType=OSF.StoreType.Sdx;ia.Height=0;ia.Width=0;ia.StoreId=OSF.StoreType.Sdx;ia.TargetType=OSF.OsfControlTarget.TaskPane;
ia.IsToBePersisted=!1;ia.SourceLocationOverrideResourceId=F;ia.SharedRuntimeId=F;return ia};Oa.prototype.i4h=function(F,ia,Qa){function Ab(){Ld.LaunchMode="Default";cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Mc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Mc.ml=Cf.a.instance.fa(1780);Mc.fT=Oa.VWc;Mc.Qk=ze.a.i9b;zd.Qk=ze.a.i9b}var Ec=this,Mc=new Wi.a,zd=new jc,Ld={};this.Gza&&this.VZf(Ld);
Ld.LaunchSource="";Ld.StartTimeMs=Date.now();Ld.CorrelationId=Ij.a.create().toString();Mc.qI=Ld;Mc.focusOnIframeWhenLoaded=!0;Mc.taskPaneWidth=Oa.t$e;zd.xba=ze.a.xsh;zd.ENb=ze.a.gPe;switch(Qa.command){case -1444574190:var ye,Te;Ld.LaunchMode="RecommendedPivotTables";Ld.SelectionContext="";Ld.LaunchSource="PivotTableHandRaise"===Object(Oh.a)(String,F.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
F.SourceSelection){var rf=F.SourceSelection.split(",")[0];ia=cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var dh=oi.Z(rf,Ec.$.xa);ye=dh.sheetName;Te=dh.lHb;dg=dh.range;return dh}().returnValue&&!Ii.g(this.$).Rb.fla(dg))F=this.$.xa.getItemByName(ye),Ld.SelectionContext=JSON.stringify(Object(Wf.a)(new Wa,{address:Te,addressWithSheet:ye+"!"+dg.qB(!1),sheetId:Ki.d(F),sheetName:ye,isSheetEmpty:!1,columnCount:dg.width,rowCount:dg.height,columnIndex:dg.left+
ia,rowIndex:dg.top+ia,selectionType:"Continuous"}));else if((F=this.$.Hb.getItemByName(Object(Oh.a)(String,F.SourceSelection)))&&Ki.n(F)){var dg=Dh.a(F,!0);var Jg=this.$.xa.getItemByName(F.sheetName);Ld.SelectionContext=JSON.stringify(Object(Wf.a)(new Fa,{tableName:F.name,hasTableHeaders:Dh.d(F),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:dg.qB(!1),addressWithSheet:Jg.name+"!"+dg.qB(!1),sheetId:Ki.d(Jg),sheetName:Jg.name,isSheetEmpty:!1,columnCount:dg.width,rowCount:dg.height,columnIndex:dg.left+
ia,rowIndex:dg.top+ia,selectionType:"Continuous"}))}}cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Mc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Mc.ml=Cf.a.instance.fa(1779);Mc.fT=Oa.rZi;Mc.Qk=ze.a.ARe;zd.Qk=ze.a.ARe;break;case -336193495:Ld.LaunchMode="RecommendedCharts";cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId=
"RecommendCharts.PPE.Bundle":Mc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Mc.ml=Cf.a.instance.fa(1778);Mc.fT=Oa.k7i;Mc.Qk=ze.a.BRe;zd.Qk=ze.a.BRe;break;case -1336341324:if(!cg.EwaSettings.ma(485))return rk.Task.Ra(!1);Ld.LaunchMode="NL";Mc.fT=Oa.VWc;cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Mc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(cg.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:Mc.ml=Cf.a.instance.fa(1783);Ld.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Mc.ml=Cf.a.instance.fa(1784);Ld.NLLaunchModeBrandingCandidatesIndex=2;break;default:Mc.ml=Cf.a.instance.fa(1782),Ld.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!cg.EwaSettings.ma(235))return rk.Task.Ra(!1);Ld.LaunchMode="ChartDesigner";Ld.LaunchSelectionMode=ia.toString();cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":Mc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Mc.ml=Cf.a.instance.fa(1785);Mc.fT=Oa.VWc;break;case 451940422:Ld.LaunchSource="AutoFilter";ia=JSON.parse(F.CommandValueId);Ld.AutoFilterSource=JSON.stringify({autoFilterRange:{sheetName:ia.AutoFilterRange.SheetName,firstColumn:ia.AutoFilterRange.FirstColumn,lastColumn:ia.AutoFilterRange.LastColumn,firstRow:ia.AutoFilterRange.FirstRow,lastRow:ia.AutoFilterRange.LastRow},ipb:ia.AutoFilterType,Z_j:ia.ItemIndex,id:ia.Id});
Ab();break;default:cg.EwaSettings.ma(235)&&(Ld.LaunchSelectionMode=ia.toString()),Ab()}return cg.EwaSettings.ma(716)?(cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Mc.sourceLocationOverrideResourceId="Insights.Https.Bundle",this.Gza?this.Gza.CWR(function(){return Ec.XXf(Ld,Mc)}):this.Bbi(Qa,Mc,zd,Ld)):this.l1(Qa,Oa.Bwa,Mc,!0,zd)};Oa.prototype.Bbi=function(F,ia,Qa,Ab){var Ec=this;this.Gza=this.ANd(this.xve(ia.sourceLocationOverrideResourceId),
ia,!1,F,Qa,!1);return cg.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(Ab.NoActionMsgOnFirstInstance=!0,this.oSa[Oa.Bwa]=Ab,this.Gza):this.Gza.CWR(function(){return Ec.XXf(Ab,ia)})};Oa.prototype.XXf=function(F,ia){var Qa=this.Ke.Waa(this.Ke.M3a(Oa.Bwa,ia.sourceLocationOverrideResourceId));if(Qa){this.oSa[Oa.Bwa]=F;var Ab=this.rxd(this.Ke.YZ(Qa).OsfPropertyBag,Oa.Bwa);this.Ke.YZ(Qa).OsfPropertyBag=Ab}this.RNa(Oa.Bwa,"LaunchIdeasAction",F,ia);return rk.Task.Ra(!0)};
Oa.prototype.l1=function(F,ia,Qa,Ab,Ec,Mc,zd){Qa=void 0===Qa?null:Qa;Ab=void 0===Ab?!1:Ab;Ec=void 0===Ec?null:Ec;Mc=void 0===Mc?!1:Mc;zd=void 0===zd?null:zd;mi.TaskExtensions.Dl();Qa||(Qa=new Wi.a);var Ld={Version:"0.0.0.0"};Ld.AssetId=ia;Ld.SolutionId=ia;Ld.AssetStoreId="";Ld.StoreType=Ab?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ld.Height=0;Ld.Width=0;Ld.StoreId=Ab?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ld.TargetType=OSF.OsfControlTarget.TaskPane;Ld.IsToBePersisted=!1;Ld.SourceLocationOverrideResourceId=
Qa.sourceLocationOverrideResourceId;if(Qa.ml||zd)this.Kbd[ia]=Object(Wf.a)(new Db,{oAc:Qa.ml,cWd:zd,mAc:Qa.fT});cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Qa.qI||(Qa.qI={}),Qa.qI.ShowFeedback=this.$.isFeedbackEnabled,this.oSa[ia]=Qa.qI):Qa.qI&&(this.oSa[ia]=Qa.qI);ia={};ia[mj.a.Ag]=Ld;zd={};zd.solutionId=Ld.SolutionId;zd.version=Ld.Version;zd.storeType=Ld.StoreType;zd.storeId=Ld.StoreId;zd.assetId=Ld.AssetId;zd.assetStoreId=
Ld.AssetStoreId;zd.height=Ld.Height;zd.targetType=Ld.TargetType;zd.width=Ld.Width;zd.isAddinCommands=!Ab;ia[Eg.a.nsa]=zd;Ec||(Ec=new jc);Ec.focusOnIframeWhenLoaded=Qa.focusOnIframeWhenLoaded;Ec.width=Qa.taskPaneWidth;ia[jc.key]=Ec;ia[bi.a.Doa]=Mc;return this.insertAgave(ia,F)};Oa.prototype.udi=function(F,ia,Qa,Ab,Ec){function Mc(rf){Xa.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(rf.solutionId,rf.storeType,rf.assetId,null,
null,rf.storeId),rf.storeType);var dg={},Jg=new sg.a;Jg.add(rf);dg[Eg.a.pZa]=Jg;dg[Eg.a.xM]=3;rf=new Vb.a(X.a.PBb,0,Ld.$.fd,0,null);return Ld.$.Ka.$b(rf,dg)}function zd(rf,dg){var Jg=rf.SolutionId;var dh=OSF.OsfControl.isFirstPartyStoreString(rf.StoreType);dh&&rf.SourceLocationOverrideResourceId&&(Jg=Ld.Ke.M3a(Jg,rf.SourceLocationOverrideResourceId));var bj=Ld.Ke.Pye(Jg,null,rf.SharedRuntimeId);dh&&(cg.EwaSettings.ma(296)&&bj&&(dh=Ld.Ke.Waa(Jg))&&(Jg=null,Jg=Ld.rxd(Ld.Ke.YZ(dh).OsfPropertyBag,rf.SolutionId),
(dh=Ld.Ke.Gi.getOsfControl(dh))&&dh.setSettings(Jg)),rf.SharedRuntimeId&&bj||Ld.Ke.Gi.refreshOsfControl(rf.SolutionId,rf.SourceLocationOverrideResourceId));if(!bj){var uh=Ld.$.na.va.hc(),hi=519;bj=function(vi,l,J){var Y=Ld.$.na.va;vi=Gi.b(vi,Ld.uIf);var za=Y.Na(9,uh);za.sharedInfo=rf;return ej.i(Y,"InsertAgaveTaskpane",za,vi,l,J,Ab,0)};void 0===rf.IsToBePersisted||null===rf.IsToBePersisted||rf.IsToBePersisted||(hi=538,bj=function(vi,l,J){Xa.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",
rf.StoreType,rf.StoreId,Telemetry.PrivacyRules.GetPrivacyCompliantId(rf.SolutionId,rf.StoreType,rf.AssetId,null,null,rf.StoreId));var Y=Ld.$.na.va;vi=Gi.b(vi,Ld.uIf);var za=Y.Na(9,void 0===uh?null:uh);za.sharedInfo=rf;return ej.i(Y,"ShowAgaveTaskpane",za,vi,l,J,Ab,0)});return cg.EwaSettings.qc()?(Ec|=64,fk.a(Ld.$.userOperationManager,bj,function(vi){return new yk.a(hi,0,vi,Ec)},dg)):fk.a(Ld.$.userOperationManager,bj,function(vi){return new Hk.a(hi,0,vi,Ec)},dg)}return mi.TaskExtensions.h5()}var Ld=
this;if(!cg.EwaSettings.ma(54)||F.StoreId===OSF.StoreType.FirstParty)return zd(F,Qa,Ab);if(ia.isAddinCommands)return Mc(ia);var ye=new Dk.a,Te={};Te.marketplaceId=F.SolutionId;Te.marketplaceVersion=F.Version;Te.storeType=F.StoreType;Te.storeId=F.StoreId;Te.targetData=F;cg.EwaSettings.ma(94)&&(Te.clearCache=!0);this.Ke.Gi.isAddinCommandsAsync(Te,function(rf,dg,Jg){ye.setResult(dg);rf||(rf=Jg.targetData,Xa.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",
Telemetry.PrivacyRules.GetPrivacyCompliantId(rf.SolutionId,rf.StoreType,rf.AssetId,null,null,rf.StoreId),rf.StoreType))});return mi.TaskExtensions.ts(ye.task,function(rf){return rf.result?Mc(ia):zd(F,Qa,Ab)},this.$.la)};Oa.prototype.rxd=function(F,ia){if(!this.oSa[ia])return F;var Qa={};if(F){F=Cl(F);for(var Ab=F.next();!Ab.done;Ab=F.next())Ab=Ab.value,Qa[Ab[0]]=Ab[1]}F=this.oSa[ia];Ab=Cl(Object.keys(F));for(ia=Ab.next();!ia.done;ia=Ab.next())ia=ia.value,ia===Oa.rAh&&cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?Qa[ia]=Sys.Serialization.JavaScriptSerializer.serialize(F[ia]):Qa[ia]=Sys.Serialization.JavaScriptSerializer.serialize(F[ia].toString());ia=Object.keys(Qa).length;F=Array(ia);Ab=0;var Ec=Cl(Object.keys(Qa));for(ia=Ec.next();!ia.done;ia=Ec.next())ia=ia.value,F[Ab]=[ia,Qa[ia].toString()],Ab++;return F};Oa.prototype.$vi=function(F,ia,Qa){var Ab=this.$.ya.UserSessionId,Ec=this.$.ya.UICultureTag,Mc=this.$.ya.UICultureTagLcid,zd=this.$.ya.WacHostId,Ld="",ye="";5<=Qa.length&&(Ld=Qa[3],ye=Qa[4]);this.awi(Ld,
ye,F,ia,Ec,Mc,Ab,zd)};Oa.prototype.awi=function(F,ia,Qa,Ab,Ec,Mc,zd,Ld){var ye={};ye.a=zd;ye.b=Qa;ye.c=Ab;ye.d=F;ye.e=ia;ye.f=Ec;ye.g=Mc;ye.h=Ld;sh.b().Pe(36,ye)};Oa.prototype.Rxe=function(){if(Yi.a.Vtf())Xa.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.wIf);return}catch(F){Xa.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(F?F.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.wIf)}catch(F){Xa.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(F?F.toString():null))}}};Oa.prototype.ANd=function(F,ia,Qa,Ab,Ec,Mc){ia=void 0===ia?null:ia;Qa=void 0===Qa?!1:Qa;Ab=void 0===Ab?null:Ab;Ec=void 0===Ec?null:Ec;Mc=void 0===Mc?!0:Mc;var zd=F.SolutionId,Ld=rk.Task.Ra(!1);F&&zd&&F.SharedRuntimeId&&(Ab=Ab||new Vb.a(-859308420,0,2,0,""),zd={},zd.solutionId=F.SolutionId,zd.version=F.Version,zd.storeType=F.StoreType,zd.storeId=F.StoreId,zd.assetId=F.AssetId,
zd.assetStoreId=F.AssetStoreId,zd.height=F.Height,zd.targetType=F.TargetType,zd.width=0,zd.isAddinCommands=!1,zd.sharedRuntimeId=F.SharedRuntimeId,F.Preload=Mc,Ec=Ec?Ec:new jc,Ec.width=0,ia&&(Ec.focusOnIframeWhenLoaded=ia.focusOnIframeWhenLoaded,Mc=new Db,ia.ml&&(Mc.oAc=ia.ml),0<ia.taskPaneWidth&&(Mc.Eu=ia.taskPaneWidth),ia.fT&&(Mc.mAc=ia.fT),this.Kbd[F.SolutionId]=Mc),ia={},ia[mj.a.Ag]=F,ia[Eg.a.nsa]=zd,ia[jc.key]=Ec,ia[bi.a.Doa]=Qa,Ld=this.insertAgave(ia,Ab));return Ld};Oa.prototype.RNa=function(F,
ia,Qa,Ab){Ab=void 0===Ab?null:Ab;if(F&&ia){F=new ck.a(F,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Ec=new Kj.a("ExcelOnline","Web",this.$.ya.UICultureTag),Mc=new dk.a;Mc.ri[ld.bUc]=Qa;Ab&&(Qa=Ab,Qa.sourceLocationOverrideResourceId&&(Mc.ri[ld.sourceLocationOverrideResourceId]=Qa.sourceLocationOverrideResourceId),Qa.ml&&(Mc.ri[ld.ml]=Qa.ml),Qa.Qk&&(Mc.ri.IconCssClass=Qa.Qk),Qa.ZVd&&(Mc.ri.TaskPaneIconUrl=Qa.ZVd),Qa.fT&&(Mc.ri.TaskPaneIconId=Qa.fT));eh.a.instance.RNa(F,Oj.a.action,ia,Ec,Mc)}};
Oa.prototype.kVh=function(F){if(!Bi.a.Gh(F)){var ia=F[hj.a.E9b];if(ia&&(ia=ia.getId(),F=F[hj.a.pza],ia&&F))return this.M3a(ia,F.ri[ld.sourceLocationOverrideResourceId])}return null};Oa.prototype.M3a=function(F,ia){ia=void 0===ia?null:ia;return F&&ia?String.format("{0}.{1}",F,ia):F};Oa.prototype.FMh=function(F){switch(F){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return cg.EwaSettings.ma(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;
case 515196233:return 1023;default:return 1}};Oa.g9h="Microsoft.Office.Excel.IdeasXLOPreload";Oa.qDd="IDS";Oa.V8e="FA000000012";Oa.Bwa="FA000000005";Oa.n7h="HelloWorld";Oa.bXg="FA000000014";Oa.C5e="Help.GiveFeedback.Url";Oa.rAh="feedback";Oa.Glf="FA000000066";Oa.c0i="PowerBi.Url";Oa.a0i="PowerBi.DevUrl";Oa.b0i="FA000000054";Oa.ADi="FA000000064";Oa.lWi="FA000000075";Oa.Z2i="FA000000080";Oa.VWc="AnalyzeDataTaskPane";Oa.k7i="RecommendedChartsTaskPane";Oa.rZi="PivotTableTaskPane";Oa.pdh=350;Oa.t$e=320;
Oa.$2i=320;Object(Lb.a)(Oa,"AgaveCommandManager",Ak.a,[853,854]);Ck.Object.defineProperties(wb,{instance:{configurable:!0,enumerable:!0,get:function(){return wb.Ma}}});wb.Ma=new wb;Object(Lb.a)(wb,"AppsDataManagerFactory",null,[]);Object(Lb.a)(function(F,ia){this.httpStatus=F;this.data=ia},"AppData",null,[]);ob.prototype.Pyb=function(F){this.vlg(this.xlg,F)};ob.prototype.HX=function(F,ia,Qa,Ab){0===F?this.vb&&this.Wg&&ia?this.Wg.hm(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",
this.vb.appSettings.WebServiceBase,ke.AFrameworkApplication.lcid,ia),1,"",null,!0,2,Qa,Ab,null):Xa.ULS.sendTraceTag(6070476,344,10,"The request objects are not available"):(ia={},Xa.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(ia.dataType=F,ia)))};Object(Lb.a)(ob,"AppsDataProvider",null,[298]);var Vi=zi.a;Am(gb,Vi);gb.prototype.create=function(){var F=this,ia=this.$.da,Qa=nj.GetServiceTaskFactory.create(ia,106,this.la,this.ub),Ab=nj.GetServiceTaskFactory.create(ia,
104,this.la,this.ub),Ec=Vf.a.loadScript(36,0,this.ub,void 0,void 0,375);mi.TaskExtensions.Ba(mi.TaskExtensions.xe([Ab,Qa,Ec],this.la),function(){var Mc=new dd(ik.a.instance),zd=new ob(ke.AFrameworkApplication.ga,ke.AFrameworkApplication.Jd,"WAC_Excel");new lc(Mc,zd,"PreinstalledAppsData_Excel");Mc=null;cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Mc=ui.a.instance.lc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);pc.instance.initialize(Qa.result);
Mc=new Oa(F.$,Qa.result,Ab.result,Mc,ke.AFrameworkApplication.Ib);ia.Ga(206,Mc);F.Eb(ia.Aa(374)||ia.Ga(374,Mc))},this.la,3);ui.a.instance.register(Xi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Ic().Oc(function(){return new Xi.a(F.$.xw)})};gb.ka=function(F){F.da.Ga(375,new gb(F))};Object(Lb.a)(gb,"AgaveCommandManagerFactory",zi.a,[]);var Sj=b(624);Na.prototype.initialize=function(F){cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.Zjj(F)};Na.prototype.$ci=function(F,ia){var Qa=mi.TaskExtensions.Dl();if(this.initialized&&F&&0<F.length){var Ab=this.DJh(F);F in this.aV&&(Qa=this.agaveCommandManager.insertAgave(Ab,ia))}return Qa};Na.prototype.JAg=function(F){var ia=this;this.initialized&&(F=F[mj.a.Ag]||{},!F.SolutionId||F.SolutionId in this.aV||this.Ke.qda(function(Qa){ia.qda(Qa)},!0))};Na.prototype.h5h=function(F){var ia=this;this.initialized&&(F=F||"")&&0<F.length&&F in this.aV&&(delete this.aV[F],
this.Ke.qda(function(Qa){ia.qda(Qa)},!0))};Na.prototype.DJh=function(F){return F in this.aV?this.aV[F]:{}};Na.prototype.qda=function(F){var ia=!1;if(F&&!F.errorCode){if(F.value){F=Cl(F.value);for(var Qa=F.next();!Qa.done;Qa=F.next()){Qa=Qa.value;var Ab=Qa[1];Qa[3]==OSF.OsfControlTarget.InContent&&Ab&&0<Ab.length&&!(Ab in this.aV)&&(ia={NoReporting:!1,IsSystemInitiated:!1},ia.description=Qa[2],ia.iconUrl=Qa[9],ia[Eg.a.nsa]={solutionId:Qa[1],version:Qa[4],storeType:Qa[6],storeId:Qa[11],assetId:Qa[5],
assetStoreId:Qa[6],targetType:Qa[3],width:Qa[7],height:Qa[8],displayName:Qa[0],id:Qa[1],appVersion:Qa[4],currentStoreType:Qa[6]},ia[mj.a.Ag]={SolutionId:Qa[1],Version:Qa[4],StoreType:Qa[6],StoreId:Qa[11],AssetId:Qa[5],AssetStoreId:Qa[6],TargetType:Qa[3],Width:Qa[7],Height:Qa[8],Id:Qa[1],AppVersion:Qa[4],CurrentStoreType:Qa[6]},this.aV[Ab]=ia,ia=!0)}}ia&&this.a6g()}};Na.prototype.a6g=function(){var F=[],ia;for(ia in this.aV)F.push({id:ia,controlType:0,title:this.aV[ia][Eg.a.nsa].displayName});if(0<
F.length){for(var Qa in this.aV)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Qa,this.aV[Qa].iconUrl);this.lYg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:Na.buf,isOfficeTab:!0,groups:[{id:Na.ybf,title:Na.zbf,controls:F}]}]});for(var Ab in this.aV)this.G0a.addCommandToMaps(Object(Wf.a)(new fb.a(Ab,"-1473679467"),{legacyControlId:Ab}))}};Na.prototype.lYg=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:Na.buf,isOfficeTab:!0,groups:[{id:Na.ybf,title:Na.zbf,
controls:[]}]}]})};Na.prototype.Zjj=function(F){var ia=this,Qa=nj.GetServiceTaskFactory.Ua(F.da,374,375,1),Ab=nj.GetServiceTaskFactory.create(F.da,106,F.la,1);mi.TaskExtensions.Ba(mi.TaskExtensions.xe([Qa,Ab],F.la),function(){ia.agaveCommandManager=Qa.result;ia.G0a=ui.a.instance.Lh("Common.IExternalUICommandDefinitionMapping")||new Sj.a(F.Lb,F);ke.AFrameworkApplication.Ib.fc(X.a.BPf,Lj.a.frame,function(Ec,Mc,zd,Ld,ye){ia.h5h(ye)});ia.Ke=Ab.result;ia.Ke.qda(function(Ec){ia.qda(Ec)},!0);ia.initialized=
!0},F.la,3)};Na.buf="tabinsert";Na.ybf="installedContentAddins";Na.zbf=Cf.a.instance.fa(2225);Object(Lb.a)(Na,"AgaveCommandRibbon",null,[789]);var lk=zi.a;Am(ra,lk);ra.prototype.create=function(){if(cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){var F=this.$.da,ia=new Na;ia.initialize(this.$);this.Eb(F.Aa(488)||F.Ga(488,ia))}};ra.ka=function(F){F.da.Ga(489,new ra(F))};Object(Lb.a)(ra,"AgaveCommandRibbonFactory",zi.a,[]);var Pi=b(944);
ta.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};ta.prototype.invokePropertyGet=function(F){switch(F){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ta.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};ta.prototype.invokePropertySet=
function(F,ia){switch(F){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};ta.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ta.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ta.prototype.invokeMethodAsync=function(F,ia){F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};ta.o7g=function(F){var ia=new ta;ia.displayName=F.displayName;ia.email=F.email;switch(F.authority){case ya.yFf:ia.identityType=
1;break;default:ia.identityType=0}ia.federationProvider="";return ia};Ck.Object.defineProperties(ta.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.Jfa},set:function(F){this.Jfa=F}},email:{configurable:!0,enumerable:!0,get:function(){return this.S6d},set:function(F){this.S6d=F}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.y7d},set:function(F){this.y7d=F}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Bjb},set:function(F){this.Bjb=
F}}});Object(Lb.a)(ta,"OfficeIdentityInfo",null,[]);ac.ybc=function(F){return F in ac.dNe?ac.dNe[F].toString():F};Ck.Object.defineProperties(ac,{dNe:{configurable:!0,enumerable:!0,get:function(){return ac.Mog}}});ac.map=null;var Tj={};ac.Mog=(Tj.GeneralException=Pi.a.generalException,Tj.AccessDenied=Pi.a.YTc,Tj.ApiNotAvailable=Pi.a.apiNotAvailable,Tj.UserNotSignedIn=Pi.a.userNotSignedIn,Tj.UserAborted=Pi.a.userAborted,Tj.UnsupportedUserIdentity=Pi.a.HQj,Tj.InvalidResourceUrl=Pi.a.invalidResourceUrl,
Tj.InvalidGrant=Pi.a.invalidGrant,Tj.AddinIsAlreadyRequestingToken=Pi.a.qIg,Tj.ResourceNotAllowed=Pi.a.Uhj,Tj.ClientError=Pi.a.clientError,Tj.ServerError=Pi.a.serverError,Tj);Object(Lb.a)(ac,"SingleSignOnErrorCodeMap",null,[]);kb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};kb.prototype.invokePropertyGet=function(F){switch(F){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};kb.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};kb.prototype.invokePropertySet=function(F,ia){switch(F){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};kb.prototype.invokePropertySetAsync=
function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};kb.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};kb.prototype.invokeMethodAsync=function(F,ia){F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Ck.Object.defineProperties(kb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.yQb},set:function(F){this.yQb=
F}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Bjb},set:function(F){this.Bjb=F}}});Object(Lb.a)(kb,"SingleSignOnToken",null,[]);db.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};db.prototype.invokePropertyGet=function(F){switch(F){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};db.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};db.prototype.invokePropertySet=function(F,ia){switch(F){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};db.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
db.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};db.prototype.invokeMethodAsync=function(F,ia){F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Ck.Object.defineProperties(db.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.g3d},set:function(F){this.g3d=F}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.ZD},set:function(F){this.ZD=F}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.eWb},set:function(F){this.eWb=F}},scope:{configurable:!0,enumerable:!0,get:function(){return this.Uge},set:function(F){this.Uge=F}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.eie},set:function(F){this.eie=F}}});Object(Lb.a)(db,"TokenParameters",null,[756]);sb.prototype.getAccessToken=function(F){var ia=this,Qa=this.bib.getOsfControl(this.yA),
Ab=Qa.getManifest(),Ec=Ab.getMarketplaceID();this.jOa(F,Ec);return OfficeExtension.WacRuntime.Utility.createPromise(function(Mc,zd){Qa.isFirstParty()&&ia.bib._enableFirstPartySSO?ia.Tfi(Ab,F)?ui.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(F,Ec).then(function(Ld){Mc(Ld)},function(Ld){zd(Ld)}):zd(Pi.a.YTc):zd(Pi.a.apiNotAvailable)}).then(function(Mc){switch(Mc.authority){case ya.yFf:var zd=1;break;default:zd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new kb(Mc.accessToken,
zd))},function(Mc){ia.logErrorResponse(F,Ec,Mc);return Mc?OfficeExtension.WacRuntime.Utility.createPromise(function(zd,Ld){Ld(OfficeExtension.WacRuntime.Utility.createRichApiException(Mc,ac.ybc(Mc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(zd,Ld){Ld(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,ac.ybc(Pi.a.generalException)))})})};sb.prototype.getAuthContext=function(){return null};sb.prototype.getPrimaryIdentityInfo=function(){var F=this.bib.getOsfControl(this.yA);
F.getManifest();var ia=F.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){ui.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ia).then(function(Ec){Qa(Ec)},function(Ec){Ab(Ec.toString())})}).then(function(Qa){Qa=ta.o7g(Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Qa)},function(Qa){return Qa?OfficeExtension.WacRuntime.Utility.createPromise(function(Ab,Ec){Ec(OfficeExtension.WacRuntime.Utility.createRichApiException(Qa,
ac.ybc(Qa)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Ab,Ec){Ec(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,ac.ybc(Pi.a.generalException)))})})};sb.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};sb.prototype.invokePropertyGet=function(F){switch(F){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};sb.prototype.invokePropertyGetAsync=function(F){F=
this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};sb.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};sb.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};sb.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};sb.prototype.invokeMethodAsync=
function(F,ia){switch(F){case 1:return this.YIh(ia);case 3:return this.mKh();case 2:return this.kWh()}F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};sb.prototype.YIh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,db);return this.getAccessToken(F)};sb.prototype.mKh=function(){return this.getAuthContext()};sb.prototype.kWh=function(){return this.getPrimaryIdentityInfo()};sb.prototype.Tfi=function(F,ia){var Qa=!1,Ab=F.getWebApplicationAuthorizations();
F=null;Ab=Cl(Ab);for(var Ec=Ab.next();!Ec.done;Ec=Ab.next())if(Ec=Ec.value,Ec.getResource().toLowerCase()===ia.resource.toLowerCase()){F=Ec;Qa=!0;break}if(!Qa)return!1;ia=ia.scope.split(" ,+");ia=Cl(ia);for(Qa=ia.next();!Qa.done;Qa=ia.next())if((Qa=Qa.value)&&Qa.length){Ab=!1;Ec=Cl(F.getScopes());for(var Mc=Ec.next();!Mc.done;Mc=Ec.next())Qa.toLowerCase()===Mc.value.toLowerCase()&&(Ab=!0);if(!Ab)return!1}return!0};sb.prototype.jOa=function(F,ia){F=this.Otf(F.resource);var Qa={};Xa.ULS.sendTraceTag(538572831,
369,50,"{0}",(Qa.manifestId=ia,Qa.resource=F,Qa))};sb.prototype.logErrorResponse=function(F,ia,Qa){F=this.Otf(F.resource);var Ab={};Xa.ULS.sendTraceTag(538572830,369,10,"{0}",(Ab.manifestId=ia,Ab.resource=F,Ab.error=Qa,Ab))};sb.prototype.Otf=function(F){return F.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Ck.Object.defineProperties(sb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(Lb.a)(sb,"AuthenticationService",null,
[]);Ta.prototype.create=function(F,ia){return new sb(F,ia)};Object(Lb.a)(Ta,"AuthenticationServiceFactory",null,[]);var N=b(1054),la=b(1184),Ra=b(1151);wa.generalException="generalException";wa.invalidArgument="invalidArgument";wa.notAllowed="notAllowed";wa.apiNotAvailable="apiNotAvailable";wa.unresolvedPendingRequest="unresolvedPendingRequest";wa.timeout="timeout";wa.adalTimeout="adalTimeout";wa.userNotSignedIn="userNotSignedIn";wa.userAborted="userAborted";wa.silentSignInFailed="silentSignInFailed";
wa.invalidResourceUrl="invalidResourceUrl";wa.invalidGrant="invalidGrant";wa.connectionLost="connectionLost";wa.clientError="clientError";wa.serverError="serverError";Object(Lb.a)(wa,"WopiHostErrorCodes",null,[]);Object(Lb.a)(qa,"OAuthCallerMetadata",null,[]);Aa.prototype.Vzg=function(F,ia,Qa,Ab,Ec,Mc){var zd=this;if(!this.jya)return Ab=new la.a,Ab.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Ab);var Ld=new qa;Ld.AddinName=Ec;Ld.AddinTrustId=Mc;var ye=-1;Mc=null;
if(Ab&&this.kff())Mc=this.jya.dbg(Eg.a.CAc,F,Ab,Aa.y2e(Ec),Ld);else{var Te=Date.now();Mc=this.jya.jT(Eg.a.CAc,F,Ld).then(function(rf){ye=Date.now()-Te;var dg=(ia||Qa)&&"login_required"===rf.ErrorCode;return(ia&&("interaction_required"===rf.ErrorCode||"consent_required"===rf.ErrorCode||"invalid_grant"===rf.ErrorCode)||dg)&&zd.kff()?zd.jya.dbg(Eg.a.CAc,F,null,Aa.y2e(Ec),Ld):Promise.resolve(rf)})}return Mc.then(function(rf){var dg=new la.a;rf.IsSuccess?(dg.token=rf.Token,rf.Telemetry&&(dg.LTa=rf.Telemetry.fromCache,
dg.expiresOn=rf.Telemetry.expiresOn)):(dg.errorCode=zd.rzi(rf),dg.gWd=zd.AXi(rf));return dg}).catch(function(){var rf=new la.a;rf.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(rf)}).then(function(rf){rf.Hha="OauthManager";0<=ye&&(rf.Qwb=ye);return rf})};Aa.prototype.oii=function(F){var ia=(ke.AFrameworkApplication.ga.Va(ke.AFrameworkApplication.Qea)||"").toLowerCase();return(Og.a.nla||"teams"===ia&&Yf.a.Wxb)&&!Aa.Shi(F)||!this.jya||!this.jya.Twa()?!1:!0};Aa.prototype.kff=
function(){return this.Dog||1!==Ra.a.Eac()};Aa.prototype.rzi=function(F){switch(F.ErrorCode){case "UserCancelled":case "interaction_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:F=F.ErrorCode===wa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:F.ErrorCode===wa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:F.ErrorCode===wa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:F.ErrorCode===wa.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:F.ErrorCode===wa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return F};Aa.prototype.AXi=function(F){var ia="";(F=RegExp("AADSTS(\\d+)").exec(F.ErrorMessage))&&1<F.length&&(ia=F[1]);return ia};Aa.y2e=function(F){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,F)};Aa.Shi=function(F){if(!F)return!1;F=F.toLowerCase();for(var ia=
Cl(N.AppsForOfficeSingleSignOnManager.ZUe),Qa=ia.next();!Qa.done;Qa=ia.next())if(Qa.value===F)return!0;return!1};Object(Lb.a)(Aa,"AppsforOfficeTokenFromOauthManager",null,[152]);va.Roa=function(){if(ke.AFrameworkApplication.ga.ra("AppForOfficeSSOV2IsEnabled")){var F=null;try{F=ui.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ia){Xa.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ia)}F=new Aa(F);va.Ma=new va(F)}};va.getInstance=function(){va.r9d||(va.Roa(),va.r9d=
!0);return va.Ma};va.Ma=null;va.r9d=!1;Object(Lb.a)(va,"AppsForOfficeOauthManagerFactory",null,[135]);var Pb=b(133);Object(Lb.a)(xa,"NewDocumentParameters",null,[]);var vc=b(169);ha.prototype.createAndOpenWorkbook=function(F){var ia=this;if(F&&F.length>this.Ysg)throw Xa.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",F.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.invalidArgument,vc.a.fa(1729));var Qa=new xa("blank","agave",F?"streamBase64":"streamEmpty",
F),Ab=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ec,Mc){var zd=new Pb.StandardDialog;zd.jc=4;zd.Ak(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Ld){2===Ld||0===Ld?Mc("Cancelled"):(Ab=window.open(""),ia.vtg.create(Ec,Mc,Qa).f1a())})}).then(function(Ec){if(!Ec)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,vc.a.fa(1725));try{Ab.top.location.href=Ec}catch(Mc){Xa.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Og.a.rp,Mc),Xa.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Ab.location.replace(Ec)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Ec){if("Cancelled"===Ec)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.tDd,vc.a.fa(1728));Ab.close();ia.TJj();return null})};
ha.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ha.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ha.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};ha.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ha.prototype.invokePropertySetAsync=function(F,
ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ha.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};ha.prototype.invokeMethodAsync=function(F,ia){switch(F){case 1:return this.a5g(ia)}F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};ha.prototype.a5g=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.createAndOpenWorkbook(F)};
ha.prototype.TJj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,vc.a.fa(1725));};Object(Lb.a)(ha,"WacWorkbook",null,[]);var ad=b(943),Fd=b(951);Ck.Object.defineProperties(fa.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(Lb.a)(fa,"RichApiPreviewExecutionContext",null,[]);var ve=b(25),Me=b(1079),fg=b(212),gh=b(214),Wh=b(116),Ci=b(12),Hj=gh.a;Am(U,Hj);U.prototype.start=function(F,ia){var Qa="<div class='"+Wh.a.soh+
" "+ze.a.lm+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Wh.a.QC+"' /></div>";Qa=String.format(Qa,Zc.a.Sf(this.g6c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Qb.innerHTML=Qa;this.upb=Ci.DOMElementExtensions.getElementById(this.Qb,"bindingText");F=ia?F.i3a(ia,this.g6c.DdaBindingsMethod.BindingId):null;(null===F||void 0===F?0:F.IsValidRef)?(ia=new ve.Range(F.Reference.FirstRow+1,F.Reference.FirstColumn+1,F.Reference.LastRow+
1,F.Reference.LastColumn+1,!1,!1),this.upb.value=F.Reference.SheetName+"!"+ia):(F=Ii.g(this.$).ha,this.upb.value=Ki.f(this.$.qa)||!F.ta.Lg?"":F.Iia);this.initialize();this.kf()};U.prototype.um=function(){this.V0c();this.addButton(0);this.addButton(1);Hj.prototype.um.call(this)};U.prototype.setFocus=function(){Ci.DOMElementExtensions.setFocus(this.upb)};U.prototype.validate=function(){return!0};U.prototype.commit=function(){var F=this.upb.value.trim(),ia=F.indexOf("!");-1!==ia&&(F=this.fZh(F.substring(0,
ia))+F.substr(ia));this.gHe.addBinding(this.g6c,F,0,this.callback);return!0};U.prototype.Vsa=function(){this.gHe.VQ.wf(ad.a.internalError,this.callback);Hj.prototype.Vsa.call(this)};U.prototype.fZh=function(F){F=Jk.a.trimStart(F.trim(),"=");return F.length?F.startsWith("'")&&F.endsWith("'")?F:Pc.HelperMethods.J8b(F):""};Ck.Object.defineProperties(U.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(Lb.a)(U,"DdaBindingPrompt",gh.a,[]);L.prototype.wf=function(F,
ia){if(ia){var Qa={};Qa.Error=F;Qa.Version=this.ea.af;ia(Qa)}};L.prototype.nKa=function(F,ia){this.wf(F,ia)};L.prototype.zH=function(F,ia){this.wf(ad.a.vWe(F.Errors[0].MessageId),ia)};L.prototype.mv=function(F){F&&F(this.AQ())};L.prototype.AQ=function(){var F={Error:0};F.Version=this.ea.af;return F};Object(Lb.a)(L,"DdaErrorGenerator",null,[]);var aj=b(293),mk=b(107);H.prototype.pyd=function(F,ia){function Qa(Ld){var ye=Ab.$.xa.getItemByName(Ld.SheetName);(null===ye||void 0===ye?0:ye.visible)?(Ii.g(Ab.$).Eg(Ld,
null,null,null,3,mk.a.vch,void 0,void 0,void 0,void 0,!0),Ab.VQ.mv(ia)):Ab.VQ.wf(ad.a.FVg,ia)}var Ab=this,Ec=F.DdaGoToByIdMethod.GoToType,Mc=F.DdaGoToByIdMethod.SelectionMode,zd=F.DdaGoToByIdMethod.Id.toString().trim();0===Ec?this.qDi(zd,Mc,F.DdaMethod.ControlId,Qa,ia):1===Ec?this.uDi(zd,Mc,Qa,ia):this.VQ.wf(ad.a.EQj,ia)};H.prototype.qDi=function(F,ia,Qa,Ab,Ec){var Mc=this;this.jA.ddaGetBinding(Qa,F,function(zd){if(!aj.a(zd)&&zd.Result&&zd.Result.Reference){zd=zd.Result;var Ld={};Ld.SheetName=zd.Reference.SheetName;
Ld.FirstRow=zd.Reference.FirstRow;Ld.FirstColumn=zd.Reference.FirstColumn;Ld.LastRow=zd.Reference.LastRow;Ld.LastColumn=zd.Reference.LastColumn;H.HWc(Ld,ia);1!==zd.BindingType?Ab(Ld):Mc.jA.ddaGetBindingData(Qa,F,1,0,2,0,0,-1,-1,function(ye){aj.a(ye)||!ye.Result?Mc.VQ.zH(ye,Ec):(ye=ye.Result,2!==ia&&(Ld.FirstRow-=ye.Headers.length,0>Ld.FirstRow&&(Ld.FirstRow=0)),Ab(Ld))},Ec)}else Mc.VQ.nKa(ad.a.m6f,Ec)},Ec)};H.prototype.uDi=function(F,ia,Qa,Ab){var Ec=this,Mc=oi.z(F);Mc?(Mc=oi.v(Mc,this.$),H.HWc(Mc,
ia),Qa(Mc)):this.$.ea.isNamedObjectViewMode&&this.$.Hb.Aj(F)?this.$.Hb.qa=this.$.Hb.getItemByName(F):(Mc=function(zd){aj.a(zd)||!zd.Result?Ec.$.xa.contains(F)?(zd={},zd.SheetName=F,zd.FirstRow=0,zd.FirstColumn=0,zd.LastRow=0,zd.LastColumn=0,Qa(zd)):Ec.VQ.nKa(ad.a.m6f,Ab):(zd=zd.Result,H.HWc(zd,ia),Qa(zd))},this.$.xa.qa?this.jA.parseRangeForGoto(F,this.$.xa.qa.name,Mc,Ab):this.jA.parseRange(F,Mc,Ab))};H.HWc=function(F,ia){F.LastRow=2===ia?F.FirstRow:F.LastRow;F.LastColumn=2===ia?F.FirstColumn:F.LastColumn};
Object(Lb.a)(H,"DdaNavigator",null,[]);var Mj=b(308),Ej;(function(F){F[F.unsupported=0]="unsupported";F[F.surface=1]="surface";F[F.combo=2]="combo";F[F.column=3]="column";F[F.column3D=4]="column3D";F[F.bar=5]="bar";F[F.bar3D=6]="bar3D";F[F.line=7]="line";F[F.line3D=8]="line3D";F[F.pie=9]="pie";F[F.pie3D=10]="pie3D";F[F.scatter=11]="scatter";F[F.bubble=12]="bubble";F[F.area=13]="area";F[F.area3D=14]="area3D";F[F.doughnut=15]="doughnut";F[F.radar=16]="radar";F[F.stock=17]="stock";F[F.waterfall=18]=
"waterfall";F[F.funnel=19]="funnel";F[F.treemap=20]="treemap";F[F.sunburst=21]="sunburst";F[F.boxWhisker=22]="boxWhisker";F[F.histogram=23]="histogram";F[F.pareto=24]="pareto";F[F.regionMap=25]="regionMap";F[F.noVisibleSeries=26]="noVisibleSeries";F[F.complexDataSource=27]="complexDataSource";F[F.pivotChart=28]="pivotChart"})(Ej||(Ej={}));Object(Lb.b)("ChartCategory",Ej);Object(Lb.a)(ca,"MacroRecorderEventData",null,[]);Z.prototype.zXh=function(F){var ia;if(void 0===F||null===F||void 0===F.RequestBody||
null===F.RequestBody)return null;var Qa=JSON.parse(F.RequestBody);if(void 0!==F.ActiveChartId&&null!==F.ActiveChartId){Qa.ActiveChartId=F.ActiveChartId;var Ab=Ii.g(this.$).ha.Oa.oc;if(null===(ia=null===Ab||void 0===Ab?void 0:Ab.floatingObject)||void 0===ia?0:ia.dd)Qa.ActiveChartType=Ej[Ab.floatingObject.dd.ChartCategory]}void 0!==F.SheetMultiRange&&null!==F.SheetMultiRange&&(Qa.SheetName=F.SheetMultiRange.SheetName);return Qa};Z.prototype.LXh=function(F){if(void 0===F||null===F||void 0===F.Result||
null===F.Result)return null;F=F.Result;return void 0===F.ResponseBody||null===F.ResponseBody||F.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(F.ResponseBody.join(""))};Z.prototype.ymi=function(F){return!!F&&!(void 0===F.eventId||null===F.eventId)&&0<F.eventId.length};Z.prototype.vk=function(F){var ia=this;return function(){if(ia.$.Uba){var Qa=ia.RRg(ia.request);if(ia.ymi(Qa)){var Ab=ia.zXh(ia.request),Ec=ia.LXh(F);if(Ab&&!Bi.a.isEmpty(Ab)&&Ec&&!Bi.a.isEmpty(Ec))return Xa.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new yj(Qa,Ab,Ec);Qa=String.format("requestInfo: {0}; responseInfo: {1}",Ab?"(not null)":"(null)",Ec?"(not null)":"(null)");Xa.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Qa)}}return new yj(null,null,null)}};Z.prototype.RRg=function(F){var ia=this.zmi(F.SolutionId),Qa=Z.gXh(F);if(Qa&&ia)return ia={},Xa.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(ia.recorderEventId=Qa,ia["request.SolutionId"]=F.SolutionId,ia)),new ca(F.SolutionId,Qa);var Ab={};Xa.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(Ab.recorderEventId=Qa,Ab.isRecorderAwareAddin=ia,Ab["request.SolutionId"]=F.SolutionId,Ab));return null};Z.prototype.zmi=function(F){if(!F)return!1;F=F.toLowerCase();return Z.X1h().contains(F)};Z.X1h=function(){Z.aAa||(Z.aAa=new wk.a(Wj.a.Pk()),Z.aAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Z.aAa.add("fa000000005"),
Z.aAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Z.aAa.add("fa000000014"),Z.aAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Z.aAa};Z.gXh=function(F){var ia=null,Qa=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Qa.test(F.RequestBody))ia=Qa.exec(F.RequestBody)[1];else{F=F.RequestHeaders;if(!F)return ia;Qa=Xj.a.hGi.toLowerCase();for(var Ab=0;Ab<F.length;Ab++)if(F[Ab].Name.toLowerCase()===Qa){ia=F[Ab].Value;break}}return ia};Z.aAa=null;Object(Lb.a)(Z,"DdaRichApiRequestRecorder",
null,[]);var nk=b(67),Xk=Mj.a;Am(ea,Xk);ea.prototype.u3=function(F){return Xk.prototype.u3.call(this,F)||this.BUg(F)};ea.prototype.vk=function(){return this.PMd.vk(this.od)};ea.prototype.Web=function(){var F={OperationType:3};F.RichApiRequest=this.request;return F};ea.prototype.BUg=function(F){var ia=this;return function(Qa,Ab,Ec){return I(F,ia.request,Gi.b(Qa,ia.Amb),Gi.a(Ab,ia.Vib),Ec,ia.g4)}};Ck.Object.defineProperties(ea.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return cg.EwaSettings.qc()?
Object(nk.a)(ea.prototype,this,"operationWorkingState"):2}},WCc:{configurable:!0,enumerable:!0,get:function(){return this.EFa}},At:{configurable:!0,enumerable:!0,get:function(){return this.Amb}},Qaa:{configurable:!0,enumerable:!0,get:function(){return this.Vib}}});Object(Lb.a)(ea,"DdaRichApiRequestBatchOperation",Mj.a,[]);var cl=yk.a;Am(Q,cl);Q.prototype.vk=function(){return this.PMd.vk(this.od)};Ck.Object.defineProperties(Q.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return cg.EwaSettings.qc()?
Object(nk.a)(Q.prototype,this,"operationWorkingState"):0}}});Object(Lb.a)(Q,"DdaRichApiRequestOperation",yk.a,[]);R.prototype.ddaAddBinding=function(F,ia,Qa,Ab,Ec,Mc,zd){var Ld=this;this.ZJ(function(ye,Te,rf){var dg=Ld.$.na.va,Jg=Ld.Nja();ye=Gi.b(ye,Mc);Te=Gi.a(Te,Ld.uI);var dh=dg.Na(9);dh.controlId=F;dh.bindingId=ia;dh.bindingType=Qa;dh.currentSheetName=Jg;dh.formula=Ab;dh.options=Ec;return ej.i(dg,"DdaAddBinding",dh,ye,Te,rf,zd,0)},zd,563)};R.prototype.ddaReleaseBinding=function(F,ia,Qa,Ab){var Ec=
this;this.ZJ(function(Mc,zd,Ld){var ye=Ec.$.na.va;Mc=Gi.b(Mc,Qa);zd=Gi.a(zd,Ec.uI);var Te=ye.Na(9);Te.controlId=F;Te.bindingId=ia;return ej.i(ye,"DdaReleaseBinding",Te,Mc,zd,Ld,Ab,0)},Ab,564)};R.prototype.ddaGetBinding=function(F,ia,Qa,Ab){var Ec=this;this.ZJ(function(Mc,zd,Ld){var ye=Ec.$.na.va;Mc=Gi.b(Mc,Qa);zd=Gi.a(zd,Ec.uI);var Te=ye.Na(1);Te.controlId=F;Te.bindingId=ia;return ej.i(ye,"DdaGetBinding",Te,Mc,zd,Ld,Ab,0)},Ab,565,16)};R.prototype.ddaGetAllBindings=function(F,ia,Qa){var Ab=this;this.ZJ(function(Ec,
Mc,zd){var Ld=Ab.$.na.va;Ec=Gi.b(Ec,ia);Mc=Gi.a(Mc,Ab.uI);var ye=Ld.Na(1);ye.controlId=F;return ej.i(Ld,"DdaGetAllBindings",ye,Ec,Mc,zd,Qa,0)},Qa,566,16)};R.prototype.ddaGetBindingData=function(F,ia,Qa,Ab,Ec,Mc,zd,Ld,ye,Te,rf){var dg=this;this.ZJ(function(Jg,dh,bj){var uh=dg.$.na.va,hi=dg.Nja();Jg=Gi.b(Jg,Te);dh=Gi.a(dh,dg.uI);var vi=uh.Na(1);vi.controlId=F;vi.bindingId=ia;vi.coerceType=Qa;vi.valueFormat=Ab;vi.filterType=Ec;vi.startRow=Mc;vi.startCol=zd;vi.rowCount=Ld;vi.colCount=ye;vi.currentSheetName=
hi;return ej.i(uh,"DdaGetBindingData",vi,Jg,dh,bj,rf,0)},rf,567,16)};R.prototype.ddaSetBindingData=function(F,ia,Qa,Ab,Ec,Mc,zd){var Ld=this;this.ZJ(function(ye,Te,rf){var dg=Ld.$.na.va,Jg=Ld.Nja();ye=Gi.b(ye,Mc);Te=Gi.a(Te,Ld.uI);var dh=dg.Na(9);dh.controlId=F;dh.bindingId=ia;dh.startRow=Qa;dh.startCol=Ab;dh.currentSheetName=Jg;dh.bindingData=Ec;return ej.i(dg,"DdaSetBindingData",dh,ye,Te,rf,zd,0)},zd,568)};R.prototype.ddaGetSelectedData=function(F,ia,Qa,Ab,Ec,Mc,zd){var Ld=this;this.ZJ(function(ye,
Te,rf){var dg=Ld.$.na.va,Jg=Ld.Nja();ye=Gi.b(ye,Mc);Te=Gi.a(Te,Ld.uI);var dh=dg.Na(1);dh.controlId=F;dh.coerceType=ia;dh.valueFormat=Qa;dh.filterType=Ab;dh.currentSheetName=Jg;dh.formula=Ec;return ej.i(dg,"DdaGetSelectedData",dh,ye,Te,rf,zd,0)},zd,569,16)};R.prototype.ddaSetSelectedData=function(F,ia,Qa,Ab,Ec){var Mc=this;this.ZJ(function(zd,Ld,ye){var Te=Mc.$.na.va,rf=Mc.Nja();zd=Gi.b(zd,Ab);Ld=Gi.a(Ld,Mc.uI);var dg=Te.Na(9);dg.controlId=F;dg.currentSheetName=rf;dg.formula=ia;dg.bindingData=Qa;return ej.i(Te,
"DdaSetSelectedData",dg,zd,Ld,ye,Ec,0)},Ec,570)};R.prototype.ddaLoadSettings=function(F,ia,Qa){var Ab=this;this.ZJ(function(Ec,Mc,zd){var Ld=Ab.$.na.va;Ec=Gi.b(Ec,ia);Mc=Gi.a(Mc,Ab.uI);var ye=Ld.Na(1);ye.controlId=F;return ej.i(Ld,"DdaLoadSettings",ye,Ec,Mc,zd,Qa,0)},Qa,501,16)};R.prototype.ddaSaveSettings=function(F,ia,Qa,Ab,Ec){var Mc=this;this.ZJ(function(zd,Ld,ye){var Te=Mc.$.na.va;zd=Gi.b(zd,Ab);Ld=Gi.a(Ld,Mc.uI);var rf=Te.Na(9);rf.controlId=F;rf.settings=ia;rf.overwriteIfStale=Qa;return ej.i(Te,
"DdaSaveSettings",rf,zd,Ld,ye,Ec,0)},Ec,571)};R.prototype.ddaAddRowsColumns=function(F,ia,Qa,Ab,Ec,Mc){var zd=this;this.ZJ(function(Ld,ye,Te){var rf=zd.$.na.va,dg=zd.Nja();Ld=Gi.b(Ld,Ec);ye=Gi.a(ye,zd.uI);var Jg=rf.Na(9);Jg.controlId=F;Jg.bindingId=ia;Jg.isRow=Qa;Jg.currentSheetName=dg;Jg.bindingData=Ab;return ej.i(rf,"DdaAddRowsColumns",Jg,Ld,ye,Te,Mc,0)},Mc,572)};R.prototype.ddaDeleteAllDataValues=function(F,ia,Qa,Ab){var Ec=this;this.ZJ(function(Mc,zd,Ld){var ye=Ec.$.na.va,Te=Ec.Nja();Mc=Gi.b(Mc,
Qa);zd=Gi.a(zd,Ec.uI);var rf=ye.Na(9);rf.controlId=F;rf.bindingId=ia;rf.currentSheetName=Te;return ej.i(ye,"DdaDeleteAllDataValues",rf,Mc,zd,Ld,Ab,0)},Ab,573)};R.prototype.ddaClearBindingFormats=function(F,ia,Qa,Ab){var Ec=this;this.ZJ(function(Mc,zd,Ld){var ye=Ec.$.na.va,Te=Ec.Nja();Mc=Gi.b(Mc,Qa);zd=Gi.a(zd,Ec.uI);var rf=ye.Na(9);rf.controlId=F;rf.bindingId=ia;rf.currentSheetName=Te;return ej.i(ye,"DdaClearBindingFormats",rf,Mc,zd,Ld,Ab,0)},Ab,574)};R.prototype.ddaSetBindingFormats=function(F,ia,
Qa,Ab,Ec,Mc){var zd=this;this.ZJ(function(Ld,ye,Te){var rf=zd.$.na.va,dg=zd.Nja();Ld=Gi.b(Ld,Ec);ye=Gi.a(ye,zd.uI);var Jg=rf.Na(9);Jg.controlId=F;Jg.bindingId=ia;Jg.currentSheetName=dg;Jg.bindingData=Qa;Jg.isSetFormats=Ab;return ej.i(rf,"DdaSetBindingFormats",Jg,Ld,ye,Te,Mc,0)},Mc,575)};R.prototype.parseRange=function(F,ia,Qa){var Ab=this;this.ZJ(function(Ec,Mc,zd){var Ld=Ab.$.na.va.hc();return ej.Q(Ab.$.na.va,F,-1,Gi.b(Ec,ia),Gi.a(Mc,Ab.uI),zd,Qa,Ld)},Qa,162,16)};R.prototype.parseRangeForGoto=function(F,
ia,Qa,Ab){var Ec=this;this.ZJ(function(Mc,zd,Ld){var ye=Ec.$.na.va.hc();return ej.R(Ec.$.na.va,F,ia,Gi.b(Mc,Qa),Gi.a(zd,Ec.uI),Ld,Ab,ye)},Ab,562,16)};R.prototype.executeRichApiRequest=function(F,ia,Qa){var Ab=this;cg.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(F.RequestFlags&=8191);if(cg.EwaSettings.ma(259))this.gzh(this.$.na.va.hc(),ia,function(){Ab.VQ.nKa(ad.a.internalError,Qa)},Qa,F);else{var Ec=gi.DdaFacade.ygd(F);!cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.zb.Mz||Ec&16?(cg.EwaSettings.qc()&&(Ec|=64),this.$.userOperationManager.Zt(new Q(this.$,F,function(Mc,zd,Ld){return I(Ab.$.na.va,F,Gi.b(Mc,ia),Gi.a(zd,Ab.uI),Ld,Qa)},Ec))):(this.VQ.nKa(ad.a.TDc,Qa),Xa.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};R.prototype.Nja=function(){return this.$.ea.isNamedObjectViewMode?this.$.qa.sheetName:this.$.activeItemName};R.prototype.ZJ=function(F,ia,Qa,Ab){Ab=void 0===Ab?0:Ab;!cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.zb.Mz||Ab&16?cg.EwaSettings.qc()?this.$.userOperationManager.Zt(new yk.a(Qa,0,F,Ab|64)):this.$.userOperationManager.Zt(new Hk.a(Qa,0,F,Ab)):(this.VQ.nKa(ad.a.TDc,ia),Xa.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};R.prototype.gzh=function(F,ia,Qa,Ab,Ec){var Mc=gi.DdaFacade.ygd(Ec);if(!cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.zb.Mz||Mc&16){var zd=this.$.Ob.Hc("UserAction","Rich Api request");cg.EwaSettings.qc()&&
(Mc|=64);this.$.userOperationManager.ic(new ea(this.$,F,ia,Qa,Ab,zd,Ec,Mc),null)}else this.VQ.nKa(ad.a.TDc,Ab),Xa.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(Lb.a)(R,"DdaWebServiceHelper",null,[]);Object(Lb.a)(T,"DocumentFile",null,[]);M.generalException="GeneralException";M.iKg="ApiNotFound";M.tDd="OperationCancelled";M.invalidArgument="InvalidArgument";Object(Lb.a)(M,"ErrorCodes",null,[]);A.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
A.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};A.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(Lb.a)(A,"WacApiDelegates",null,[]);var kl=b(711);Am(C,A);C.prototype.replaceShortcuts=function(F){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,F,this.$hf)};C.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
C.prototype.checkShortcutsInUse=function(F){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(F,this.$hf)};C.X7g=function(F,ia){var Qa=document.createEvent("KeyboardEvent");if(Og.a.CF)Qa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(F&8),!!(F&32),!!(F&4),!!(F&256));else{var Ab=[];F&4&&Ab.push("Shift");F&8&&Ab.push("Control");F&32&&Ab.push("Alt");Qa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Ab.join(" "),!1,"en-US")}F=new Sys.UI.DomEvent(Qa);F.keyCode=ia;return F};C.B3g=
function(F,ia){if(Og.a.Hf)switch(ia){case 189:ia=173;break;case 187:ia=61;break;case 186:ia=59}return C.X7g(F,ia)};Object(Lb.a)(C,"ExcelWacApiDelegates",A,[]);v.prototype.ABg=function(F,ia){this.Wdc(F)||(this.WIa[F]={});if(this.Rhi(F))return Xa.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",F),ad.a.LAi;this.WIa[F][ia.WAh.toString()]=ia;return ad.a.success};v.prototype.TOh=function(F,ia){var Qa=null;this.Wdc(F)&&(Qa=this.WIa[F][ia.toString()]);Qa||Xa.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",F,ia);return Qa};v.prototype.Wdc=function(F){return F in this.WIa};v.prototype.A$i=function(F,ia){if(this.Wdc(F)){var Qa=this.WIa[F];delete Qa[ia.toString()];1>Object.keys(Qa).length&&delete this.WIa[F];return ia.toString()in Qa?ad.a.internalError:ad.a.success}return ad.a.internalError};v.prototype.Rhi=function(F){return this.Wdc(F)?Object.keys(this.WIa[F]).length>=this.eAi:!1};v.getInstance=function(F){return F.da.Aa(200)||F.da.Ga(200,
new v(v.fAi))};v.dEi=function(){return++v.RTg};v.Lzi=4194304;v.fAi=1;v.RTg=0;Object(Lb.a)(v,"GetFileApiHelper",null,[]);B.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.yA)};B.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};B.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};B.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};B.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};B.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};B.prototype.invokeMethod=function(F){switch(F){case 1:return this.MEi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};B.prototype.invokeMethodAsync=
function(F,ia){F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};B.prototype.MEi=function(){this.notifyActionHandlerReady();return null};Object(Lb.a)(B,"AddinInternalService",null,[]);u.prototype.getAppRuntimeState=function(){return this.kJ.getAppRuntimeState(this.yA)?2:1};u.prototype.setAppRuntimeState=function(F){switch(F){case 2:F=!0;break;case 1:F=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.invalidArgument,
vc.a.fa(1729));}this.kJ.setAppRuntimeState(this.yA,F)};u.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};u.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};u.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};u.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(F,ia){switch(F){case 2:return this.bKh();case 1:return this.spj(ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};u.prototype.invokeMethodAsync=function(F,ia){F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.bKh=function(){return this.getAppRuntimeState()};
u.prototype.spj=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");this.setAppRuntimeState(F);return null};Object(Lb.a)(u,"AppRuntimeService",null,[]);var nl=b(1185);t.prototype.disable=function(){try{if(!vc.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.ZDe();if(!this.yhf())return this.$De();this.g2.LPj(this.Ns)}catch(F){return Xa.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
F.message||"Unknown"),this.XDe()}return null};t.prototype.enable=function(){try{if(!vc.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.ZDe();if(!this.yhf())return this.$De();this.g2.C8i(this.Ns)}catch(F){return Xa.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",F.message||"Unknown"),this.XDe()}return null};t.prototype._OnAccess=function(){};t.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
t.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};t.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
t.prototype.invokeMethod=function(F){switch(F){case 1:return this.QCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokeMethodAsync=function(F,ia){switch(F){case 3:return this.agh();case 2:return this.blh()}F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};t.prototype.agh=function(){return this.disable()};t.prototype.blh=function(){return this.enable()};t.prototype.QCa=function(){this._OnAccess();return null};
t.prototype.ZDe=function(){return nl.a(Pi.a.notImplemented,vc.a.fa(1730))};t.prototype.$De=function(){return nl.a(Pi.a.sharedRuntimeNotAvailable,vc.a.fa(1734))};t.prototype.XDe=function(){return nl.a(Pi.a.generalException,vc.a.fa(1725))};t.prototype.yhf=function(){var F=this.az.getSharedRuntimeId();return!!F&&0<F.length};Object(Lb.a)(t,"BeforeDocumentCloseNotification",null,[]);x.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};x.prototype.invokePropertyGet=
function(F){switch(F){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};x.prototype.invokePropertySet=function(F,ia){switch(F){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};x.prototype.invokeMethodAsync=function(F,ia){F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Ck.Object.defineProperties(x.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.sA},set:function(F){this.sA=F}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Rce},set:function(F){this.Rce=F}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Eie},set:function(F){this.Eie=F}}});Object(Lb.a)(x,
"CustomFunctionEngineStatus",null,[]);r.prototype.register=function(F){return OfficeExtension.WacRuntime.Utility.createPromise(this.jvg(F))};r.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};r.prototype.invokePropertyGet=function(F){switch(F){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};r.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
r.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};r.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};r.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};r.prototype.invokeMethodAsync=function(F,ia){switch(F){case 1:return this.u9i(ia)}F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
r.prototype.u9i=function(F){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"string");return this.register(ia,F)};Ck.Object.defineProperties(r.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var F=new x;F.enabled=this.irg;F.streamingEnabled=this.jrg;F.nativeRuntime=!1;return F}}});Object(Lb.a)(r,"CustomFunctionManager",null,[]);var ol=b(1148);y.prototype._RegisterStateChange=function(){var F=
this;this.LSb||this.wP.execute(function(ia){F.V3d=ia.cna(F._id,function(Qa){F.kJ.dDh(F.yA,F._id,JSON.stringify(Qa))})});this.LSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype._UnregisterStateChange=function(){var F=this;this.LSb--;this.LSb||this.wP.execute(function(ia){ia.rJd(F._id,F.V3d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};y.prototype.invokePropertyGet=
function(F){switch(F){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};y.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};y.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};y.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
y.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};y.prototype.invokeMethodAsync=function(F,ia){switch(F){case 6:return this.Jkg();case 7:return this.Lkg()}F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};y.prototype.Jkg=function(){return this._RegisterStateChange()};y.prototype.Lkg=function(){return this._UnregisterStateChange()};Ck.Object.defineProperties(y.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(Lb.a)(y,"LicenseFeature",null,[]);h.prototype.getFeatureTier=function(F,ia){var Qa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ab){var Ec=1===ia?1:2===ia?2:0;Qa.wP.execute(function(Mc){Mc.getFeatureTier(F,Ec).then(function(zd){Ab(Qa.gTh(zd))},function(){Ab(ia)})})})};h.prototype.getLicenseFeature=function(F){F=new y(this.wP,F,this.yA,this.kJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};h.prototype.isFeatureEnabled=
function(F,ia){var Qa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ab){Qa.wP.execute(function(Ec){Ec.isFeatureEnabled(F,ia).then(function(Mc){Ab(Mc)},function(){Ab(ia)})})})};h.prototype.isFreemiumUpsellEnabled=function(){var F=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ia){F.wP.execute(function(Qa){Qa=Qa.isFreemiumUpsellEnabled();ia(Qa)})})};h.prototype.launchUpsellExperience=function(F){var ia=this;if(this.Ytg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){ia.wP.execute(function(Qa){Qa.launchUpsellExperience(F)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.YTc,"");};h.prototype._TestFireStateChangedEvent=function(){};h.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};h.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};h.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};h.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};h.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};h.prototype.invokeMethod=function(F,ia){switch(F){case 6:return this.Kkg(ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};h.prototype.invokeMethodAsync=function(F,ia){switch(F){case 2:return this.OPh(ia);case 5:return this.fTh(ia);case 1:return this.Iii(ia);case 3:return this.nji();case 4:return this.Asi(ia)}F=this.invokeMethod(F,
ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};h.prototype.OPh=function(F){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"int");return this.getFeatureTier(ia,F)};h.prototype.fTh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getLicenseFeature(F)};h.prototype.Iii=function(F){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,
0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"boolean");return this.isFeatureEnabled(ia,F)};h.prototype.nji=function(){return this.isFreemiumUpsellEnabled()};h.prototype.Asi=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.launchUpsellExperience(F)};h.prototype.Kkg=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");this._TestFireStateChangedEvent(F);return null};h.prototype.gTh=function(F){switch(F){case 1:return 1;
case 2:return 2;default:return 0}};Object(Lb.a)(h,"License",null,[]);var pl=b(157);n.prototype.areShortcutsInUse=function(F){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){ia.Cwd.checkShortcutsInUse(F).then(function(Ec){Qa(Ec)}).catch(function(Ec){Ab(Ec)})})};n.prototype.getShortcuts=function(){var F=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ia,Qa){F.Cwd.getShortcuts().then(function(Ab){ia(Ab)}).catch(function(Ab){Qa(Ab)})})};n.prototype.replaceShortcuts=
function(F){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){ia.Cwd.replaceShortcuts(F).then(function(){Qa(null)}).catch(function(Ec){Ab(Ec)})})};n.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};n.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
n.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokeMethodAsync=function(F,ia){switch(F){case 3:return this.RLg(ia);case 1:return this.jZh();case 2:return this.Zej(ia)}F=
this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};n.prototype.RLg=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"Array<string>");return this.areShortcutsInUse(F)};n.prototype.jZh=function(){return this.getShortcuts()};n.prototype.Zej=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"any");return this.replaceShortcuts(F)};Object(Lb.a)(n,"ActionService",null,[]);var xl=b(566);m.prototype.XYh=function(){this.Jra||
(this.Jra=xl.a.dr(ui.a.instance.lc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Jra};m.prototype.getSharedFilePickerResponse=function(F){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){try{var Ec=ia.XYh();rk.Task.WAA.call(null,Ec).continueWith(function(){var Mc=Ec.result;if(Mc){var zd={};(function(){var Ld=Kg.d(F);zd=Ld.ev;return Ld})().returnValue?Mc.gfd(zd).then(function(Ld){Ld&&0<Ld.length?Qa(Ld):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Ld){Ab(Ld)}):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Mc){Ab(Mc)}})};m.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};m.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};m.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};m.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokePropertySetAsync=function(F,ia){this.invokePropertySet(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};m.prototype.invokeMethodAsync=function(F,ia){switch(F){case 1:return this.WYh(ia)}F=this.invokeMethod(F,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};m.prototype.WYh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getSharedFilePickerResponse(F)};Object(Lb.a)(m,"SharedFilePicker",null,[]);f.prototype.createInstance=function(F,ia){switch(F){case "Microsoft.Office.ActionService":return new n(ia);case "Microsoft.Office.SharedFilePicker":return new m}return null};
Object(Lb.a)(f,"WacApiHost",null,[]);e.prototype.hostName=function(){return"ExcelOnline"};e.prototype.appId=function(){return this.VQb};e.prototype.createInstance=function(F){switch(F){case "Microsoft.Authentication.AuthenticationService":return ui.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.yA,this.kJ.Gi);case "Microsoft.Authentication.TokenParameters":return new db;case "Microsoft.ExcelServices.CustomFunctionManager":F=this.wb.ma(122);
var ia=this.wb.ma(123);return new r(F,ia,w(this.VQb,this.wb,this.kJ));case "Microsoft.AppRuntime.AppRuntimeService":return new u(this.yA,this.kJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return F=hk.a(this.wb),new t(this.VQb,this.yA,F,this.kJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return F=hk.a(this.wb),new ol.DynamicRibbon(this.VQb,this.yA,this.kJ,F,F.pn(this.yA).nl);case "Microsoft.Office.Licensing.License":return new h(this.yA,this.kJ);case "Microsoft.InternalService.AddinInternalService":return new B(this.yA);
default:if(this.DTc||(this.DTc=new f),ia=this.DTc.createInstance(F,this.ozg))return ia}Xa.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",F);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,Pi.a.generalException);};Object(Lb.a)(e,"RichApiHost",null,[]);var ul=b(407),yl=b(117),ql=b(35),sl=b(99),Yk=b(295),ll=b(43),tl=b(258),vl=b(6),zl=b(66),wl=b(204);c.prototype.dispose=function(){this.$=this.N9b=
null};c.prototype.$c=function(){return!1};c.prototype.jd=function(){return!1};c.prototype.executeCommand=function(F,ia,Qa){F=ia.command;switch(F){case 451041795:this.De.wf(Qa[mj.a.Ag],Qa[mj.a.g4]);break;case 974713501:this.y4h(Qa[mj.a.Ag],Qa[mj.a.g4]);break;case 1237877382:this.De.mv(Qa[mj.a.g4]);break;default:return $k.a(F)}return rk.Task.Ra(!0)};c.prototype.Kc=function(F,ia,Qa){if(F=!!Qa)switch(ia.command){case 974713501:case 1237877382:case 451041795:break;default:F=!1}return F};c.prototype.y4h=
function(F,ia){var Qa,Ab=F.DdaMethod;if("undefined"===typeof Ab.DispatchId)this.De.wf(ad.a.internalError,ia);else if(c.Khi(F)||this.$.Pd&1){if(Ab.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new U(this.$,this,F,ia)).start(this.Ke,F.DdaMethod.ControlId):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.wYh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.Jtj(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(F,this.Eed(F.DdaMethod.ControlId),0,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.FKh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Cpj(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.EKh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.z$i(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.GJh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Dud(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(F.DdaAddRowsColumns.IsRow=!0,this.lne(F,ia)):Ab.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(F.DdaAddRowsColumns.IsRow=!1,this.lne(F,ia)):Ab.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Kdh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.AYg(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(F.DdaSetBindingFormats.IsSetFormats=!0,this.dZf(F,ia)):Ab.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(F.DdaSetBindingFormats.IsSetFormats=!1,this.dZf(F,ia)):Ab.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(F,F.DdaBindingsMethod.ItemName,F.DdaBindingsMethod.FailOnCollision?2:1,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.SPh(ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.pyd(F,ia):Ab.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.QOh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.ROh(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.B$i(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(F.DdaMethod.ControlId,F),this.De.mv(ia)):
Ab.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?cg.EwaSettings.ma(24)?this.De.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ia):this.iBi(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?cg.EwaSettings.ma(24)?this.De.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ia):this.eBi(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(F,ia):Ab.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(F,ia):this.De.wf(ad.a.wDd,ia),cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Ab.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){F=this.Ke.YZ(F.DdaMethod.ControlId);ia="";if(F){ia=gi.DdaFacade.getSolutionId(F,this.$);var Ec=F.PrimaryMarketplace.MarketplaceType;Ec===OSF.StoreType.InMemory?F.OwnerAddinSolutionId&&F.AssetMarketplace&&(Ec=F.AssetMarketplace.MarketplaceType):Ec===OSF.StoreType.WopiCatalog&&(Ec=OSF.StoreType.OMEX);
ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia,Ec,null===(Qa=F.AssetMarketplace)||void 0===Qa?void 0:Qa.SolutionId,null,null,F.PrimaryMarketplace.MarketplaceRef)}Xa.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Ab.DispatchId,ia)}}else this.De.wf(ad.a.bKe,ia)};c.prototype.FKh=function(F,ia){var Qa=this;F.DdaGetBindingData.CoerceType=c.l3b(F.DdaGetBindingData.CoerceType);F.DdaGetBindingData.FilterType=c.fUe(F.DdaGetBindingData.FilterType);F.DdaGetBindingData.ValueFormat=c.agg(F.DdaGetBindingData.ValueFormat);
if(this.Zic(F.DdaGetBindingData.CoerceType,ia)){if(F.DdaGetBindingData){var Ab=F.DdaGetBindingData;0===Ab.FilterType&&(Ab.FilterType=2);Ab.StartCol|=0;Ab.StartRow|=0;Ab.ColCount=void 0===Ab.ColCount?-1:Ab.ColCount;Ab.RowCount=void 0===Ab.RowCount?-1:Ab.RowCount}this.jA.ddaGetBindingData(F.DdaMethod.ControlId,F.DdaGetBindingData.BindingId,F.DdaGetBindingData.CoerceType,F.DdaGetBindingData.ValueFormat,F.DdaGetBindingData.FilterType,F.DdaGetBindingData.StartRow,F.DdaGetBindingData.StartCol,F.DdaGetBindingData.RowCount,
F.DdaGetBindingData.ColCount,function(Ec){if(aj.a(Ec)||!Ec.Result)Qa.De.zH(Ec,ia);else{var Mc=Qa.De.AQ();Mc.Data=c.vve(Ec.Result);ia(Mc)}},ia)}};c.prototype.Cpj=function(F,ia){var Qa=this;F.DdaSetBindingData.CoerceType=c.l3b(F.DdaSetBindingData.CoerceType);if(this.Zic(F.DdaSetBindingData.CoerceType,ia)){var Ab=c.yZc(F.DdaSetBindingData.CoerceType,F.DdaSetBindingData.Data);c.dgc(Ab)?this.De.wf(ad.a.NBc,ia):(1===Ab.CoerceType&&(Ab.CellFormat||(Ab.CellFormat=F.DdaSetBindingData.CellFormat),Ab.TableOptions||
(Ab.TableOptions=F.DdaSetBindingData.TableOptions)),F.DdaSetBindingData&&(F.DdaSetBindingData.StartCol|=0,F.DdaSetBindingData.StartRow|=0),this.jA.ddaSetBindingData(F.DdaMethod.ControlId,F.DdaSetBindingData.BindingId,F.DdaSetBindingData.StartRow,F.DdaSetBindingData.StartCol,Ab,function(Ec){aj.a(Ec)?Qa.De.zH(Ec,ia):Qa.De.mv(ia)},ia))}};c.prototype.wYh=function(F,ia){var Qa=this;F.DdaGetBindingData.CoerceType=c.l3b(F.DdaGetBindingData.CoerceType);F.DdaGetBindingData.ValueFormat=c.agg(F.DdaGetBindingData.ValueFormat);
F.DdaGetBindingData.FilterType=c.fUe(F.DdaGetBindingData.FilterType);if(this.Zic(F.DdaGetBindingData.CoerceType,ia)){var Ab=this.Eed(F.DdaMethod.ControlId);Ab?this.jA.ddaGetSelectedData(F.DdaMethod.ControlId,F.DdaGetBindingData.CoerceType,F.DdaGetBindingData.ValueFormat,F.DdaGetBindingData.FilterType,Ab,function(Ec){if(aj.a(Ec))Qa.De.zH(Ec,ia);else{var Mc=Qa.De.AQ();Mc.Data=c.vve(Ec.Result);ia(Mc)}},ia):this.De.wf(ad.a.s3e,ia)}};c.prototype.QOh=function(F,ia){var Qa=this;if(Og.a.Wpd)this.De.wf(ad.a.XPg,
ia);else{var Ab=F[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],Ec=F[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Mc=F.DdaMethod.ControlId,zd=v.getInstance(this.$);if(0>=Ec)Xa.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.De.wf(ad.a.xei,ia);else if(Ec>v.Lzi)Xa.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.De.wf(ad.a.CZe,ia);else{var Ld=null;switch(Ab){case 1:Ld="Compressed";
break;case 0:Ld="Text";break;case 2:Ld="Pdf";break;default:Xa.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",Ab);this.De.wf(ad.a.UTe,ia);return}if("Text"===Ld)Xa.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Ld),this.De.wf(ad.a.UTe,ia);else{cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(F=new Sys.StringBuilder,F.append(Me.a(this.$,Ld)),"Pdf"===Ld&&fg.a.fh(F,Xj.a.ZGd,"WholeWorkbook"),F=
F.toString()):F=Me.a(this.$,Ld);var ye=null,Te=new XMLHttpRequest;Te.onreadystatechange=function(){if(4===Te.readyState)if(200===Te.status){var rf=Te.response;if(rf){ye=new Uint8Array(rf);rf=Qa.De.AQ();for(var dg=ye.length,Jg=v.dEi(),dh={},bj=0,uh=0;uh<dg;uh+=Ec){for(var hi=[],vi=uh+Ec<dg?uh+Ec:dg,l=0,J=uh;J<vi;l++,J++)hi[l]=ye[J];dh[(bj++).toString()]=hi}dh=new T(Jg,dg,Ec,dh);dh=zd.ABg(Mc,dh);dh!==ad.a.success?Qa.De.wf(dh,ia):(rf[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Jg,rf[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=
dg,Xa.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Ld,dg),ia(rf))}else Xa.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Ld),Qa.De.wf(ad.a.internalError,ia)}else 500===Te.status?Qa.De.wf(ad.a.vWe(parseInt(Te.statusText,10)),ia):(Xa.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",Ld),Qa.De.wf(ad.a.KDi,ia))};Te.open("GET",F,!0);Te.responseType=
"arraybuffer";Te.setRequestHeader("If-Modified-Since","0");Te.send(null)}}}};c.prototype.ROh=function(F,ia){var Qa=F[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Ab=F[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];F=F.DdaMethod.ControlId;(Qa=v.getInstance(this.$).TOh(F,Qa))?(Qa=Qa.kDj,0>Ab||Ab>=Object.keys(Qa).length?this.De.wf(ad.a.f$h,ia):(Ab=Qa[Ab.toString()],Qa=this.De.AQ(),Qa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=Ab,Qa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=
Ab.length,ia(Qa))):this.De.wf(ad.a.internalError,ia)};c.prototype.B$i=function(F,ia){var Qa=F[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];F=F.DdaMethod.ControlId;Qa=v.getInstance(this.$).A$i(F,Qa);Qa===ad.a.success?this.De.mv(ia):this.De.wf(Qa,ia)};c.prototype.Jtj=function(F,ia){var Qa=this;F.DdaSetBindingData.CoerceType=c.l3b(F.DdaSetBindingData.CoerceType);if(this.Zic(F.DdaSetBindingData.CoerceType,ia)){var Ab=this.Eed(F.DdaMethod.ControlId);if(Ab){var Ec=c.yZc(F.DdaSetBindingData.CoerceType,
F.DdaSetBindingData.Data),Mc=Ii.g(this.$).ha;1===Ec.CoerceType&&(!Ec.Data&&Mc.ta.L_&&(Ec.Headers||(Ec.Headers=[]),Ec.Headers.length||Ec.Headers.push([]),Ec.Headers[0].length||Array.add(Ec.Headers[0],"")),c.dgc(Ec)||(Ec.CellFormat||(Ec.CellFormat=F.DdaSetBindingData.CellFormat),Ec.TableOptions||(Ec.TableOptions=F.DdaSetBindingData.TableOptions)));if(c.dgc(Ec))this.De.wf(ad.a.NBc,ia);else{var zd=Mc.ta.ud.clone(),Ld=Mc.ta.activeCell.clone();this.jA.ddaSetSelectedData(F.DdaMethod.ControlId,Ab,Ec,function(ye){var Te;
if(aj.a(ye))Qa.De.zH(ye,ia);else{ye=zd.clone();var rf=Ec.Headers?Ec.Headers[0].length:Ec.Data[0].length;1!==Ec.CoerceType||Ec.Data?1===Ec.CoerceType&&(null===(Te=Ec.TableOptions)||void 0===Te?0:Te.length)&&0==Ec.TableOptions[0]?(ye.top+=1,ye.bottom=ye.top+Ec.Data.length-1):ye.bottom=ye.top+Ec.Data.length-(1===Ec.CoerceType?0:1):ye.bottom=ye.top+1;ye.right=ye.left+rf-1;Te=ye.contains(Ld)?Ld:ye.topLeft;Mc.updateSelection(ye,Te,0);Qa.De.mv(ia)}},ia)}}else this.De.wf(ad.a.Oxe,ia)}};c.prototype.addBinding=
function(F,ia,Qa,Ab){var Ec=this;ia?this.jA.ddaAddBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,F.DdaBindingsMethod.BindingType,ia,Qa,function(Mc){if(aj.a(Mc))Ec.De.zH(Mc,Ab);else{var zd=Ec.De.AQ();zd.Bindings=Array(1);zd.Bindings[0]=Ec.Ke.V0b(Mc.Result);Ab(zd)}},Ab):this.De.wf(ad.a.Wmj,Ab)};c.prototype.EKh=function(F,ia){var Qa=this;this.jA.ddaGetBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(Ab){if(aj.a(Ab)||!Ab.Result)Qa.De.zH(Ab,ia);else{var Ec=Qa.De.AQ();Ec.Bindings=
Array(1);Ec.Bindings[0]=Qa.Ke.V0b(Ab.Result);ia(Ec)}},ia)};c.prototype.SPh=function(F){var ia=this.De.AQ(),Qa={};Qa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ia[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Qa;F(ia)};c.prototype.z$i=function(F,ia){var Qa=this;this.jA.ddaReleaseBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(Ab){aj.a(Ab)?Qa.De.zH(Ab,ia):Qa.De.mv(ia)},ia)};c.prototype.GJh=function(F,ia){var Qa=this;this.jA.ddaGetAllBindings(F.DdaMethod.ControlId,
function(Ab){if(aj.a(Ab))Qa.De.zH(Ab,ia);else{var Ec=Qa.De.AQ();if(Ab.Result){Ab=Ab.Result;Ec.Bindings=Array(Ab.length);for(var Mc=0;Mc<Ab.length;Mc++)Ec.Bindings[Mc]=Qa.Ke.V0b(Ab[Mc])}else Ec.Bindings=null;ia(Ec)}},ia)};c.prototype.Dud=function(F,ia){var Qa=this;this.jA.ddaLoadSettings(F.DdaMethod.ControlId,function(Ab){if(aj.a(Ab))Qa.De.zH(Ab,ia);else{var Ec=Qa.De.AQ();Ec.Properties=Ab.Result;ia(Ec)}},ia)};c.prototype.saveSettings=function(F,ia){for(var Qa=this,Ab={Settings:[]},Ec=0;Ec<F.DdaSettingsMethod.Properties.length;Ec++){var Mc=
{};Mc.Name=F.DdaSettingsMethod.Properties[Ec][0];Mc.Value=F.DdaSettingsMethod.Properties[Ec][1];Ab.Settings[Ec]=Mc}this.jA.ddaSaveSettings(F.DdaMethod.ControlId,Ab,F.DdaSettingsMethod.OverwriteIfStale,function(zd){aj.a(zd)?Qa.De.zH(zd,ia):Qa.De.mv(ia)},ia)};c.prototype.lne=function(F,ia){var Qa=this,Ab=c.yZc(1,F.DdaAddRowsColumns.Data);c.dgc(Ab)?this.De.wf(ad.a.NBc,ia):this.jA.ddaAddRowsColumns(F.DdaMethod.ControlId,F.DdaAddRowsColumns.BindingId,F.DdaAddRowsColumns.IsRow,Ab,function(Ec){aj.a(Ec)?
Qa.De.zH(Ec,ia):Qa.De.mv(ia)},ia)};c.prototype.Kdh=function(F,ia){var Qa=this;this.jA.ddaDeleteAllDataValues(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(Ab){aj.a(Ab)?Qa.De.zH(Ab,ia):Qa.De.mv(ia)},ia)};c.prototype.AYg=function(F,ia){var Qa=this;this.jA.ddaClearBindingFormats(F.DdaMethod.ControlId,F.DdaClearBindingFormats.BindingId,function(Ab){aj.a(Ab)?Qa.De.zH(Ab,ia):Qa.De.mv(ia)},ia)};c.prototype.dZf=function(F,ia){var Qa=this,Ab={},Ec=F.DdaSetBindingFormats.IsSetFormats;Ec?Ab.CellFormat=
F.DdaSetBindingFormats.CellFormat:Ab.TableOptions=F.DdaSetBindingFormats.TableOptions;this.jA.ddaSetBindingFormats(F.DdaMethod.ControlId,F.DdaSetBindingFormats.BindingId,Ab,Ec,function(Mc){aj.a(Mc)?Qa.De.zH(Mc,ia):Qa.De.mv(ia)},ia)};c.prototype.executeRichApiRequest=function(F,ia){var Qa=this,Ab,Ec=F.ArrayData,Mc={},zd=Ii.g(this.$).ha;if(Ec){if("WacPartition"===Ec[0]){this.Nyh(F,ia);return}var Ld=Object(Oh.a)(gi.DdaFacade,hk.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Ec[0]){var ye=
Ld.pn(F.DdaMethod.ControlId);ye&&(ye.zqd=!0,ye.nKf())}Mc.HttpMethod=Ec[1];Mc.PathAndQuery=Ec[2];Mc.RequestHeaders=c.V_e(Ec[3]);Mc.RequestBody=Ec[4];Mc.AppPermission=Ec[5];ye=Ec[6];Mc.RequestFlags=ye;var Te=0;if(Ki.i(this.$.qa))switch(zd.Ue){case 1:Te=2;break;case 2:Te=3;break;case 128:Te=4;break;default:Te=1}var rf=null;zd.Oa.IC&&(rf=zd.Oa.IC.jj);Mc.SheetMultiRange=oi.r(zd.ta.selectedRanges,this.$);Mc.ActiveCell=oi.v(zd.ta.activeCell,this.$);Mc.ActiveChartId=rf;Mc.SelectionState=Te;Te=this.Ke.YZ(F.DdaMethod.ControlId);
Mc.InstanceId=Te?Te.InstanceId:"";if(Te&&Te.PrimaryMarketplace){rf=gi.DdaFacade.getSolutionId(Te,this.$);var dg=Te.PrimaryMarketplace.MarketplaceType;if(dg===OSF.StoreType.InMemory){if(!Te.OwnerAddinSolutionId){this.De.wf(ad.a.Lyb,ia);return}if(Te.AssetMarketplace)dg=Te.AssetMarketplace.MarketplaceType;else{this.De.wf(ad.a.Lyb,ia);return}}else dg===OSF.StoreType.WopiCatalog&&(dg=OSF.StoreType.OMEX);var Jg=Telemetry.PrivacyRules.GetPrivacyCompliantId(rf,dg,null===(Ab=Te.AssetMarketplace)||void 0===
Ab?void 0:Ab.SolutionId,null,null,Te.PrimaryMarketplace.MarketplaceRef);Mc.CompliantSolutionId=Jg;Mc.SolutionId=rf;Mc.MarketplaceType=dg;Mc.SolutionVersion=Te.PrimaryMarketplace.SolutionVersion;Mc.StoreLocation=Te.PrimaryMarketplace.MarketplaceRef}else Mc.SolutionId=Mc.MarketplaceType="",Mc.CompliantSolutionId="";Mc.IsEventsEnabled=void 0===Ld||null===Ld||Ld.ij.g0b(Mc.InstanceId);Mc.RequestGuid=Ij.a.create().toString();Ab=Mc.RequestBody.length;if(cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&
Ab>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.De.wf(ad.a.ugj,ia);Xa.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",Ab);return}cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&ye&4096&&(Ab=new fa(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Ab,aa,Ec),Mc.RequestBody=Ec[4])}var dh=c.Z2e(Mc.RequestHeaders);c.oEd++;var bj=ai.a.Ta.Wb;cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
Mc&&Mc.RequestBody&&Xa.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",Mc.RequestBody.length));this.jA.executeRichApiRequest(Mc,function(uh){var hi;Qa.nYf(bj,!0,uh.ServerCorrelationId);var vi=null,l=null,J=uh.ServerCorrelationId;if(null===(hi=null===uh||void 0===uh?void 0:uh.Errors)||void 0===hi?0:hi[0])vi=uh.Errors[0].MessageIdName,l=uh.Errors[0].Description,cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&zl.a(Qa.$).rd.nE(uh.Errors[0].MessageId);
if(aj.a(uh)||!uh.Result)Qa.iOa(J,dh,"Server error",vi,l),Qa.De.zH(uh,ia);else{var Y=null;if(cg.EwaSettings.ma(259))if((hi=uh.Result)&&hi.length){for(var za=0;za<hi.length;za++)if(hi[za].RequestGuid===Mc.RequestGuid){Y=hi[za];break}Y||Qa.De.zH(uh,ia)}else Y=uh.Result;else Y=uh.Result;if(!vi&&Y&&Y.ResponseBody&&Y.ResponseBody[0])if(uh=Y.ResponseBody[0],uh.startsWith('{"Error":')){1<Y.ResponseBody.length&&(uh=uh.substring(0,uh.indexOf("}")+1),uh+="}");try{var Ua=lj.a.oi(uh);Ua.Error&&Qa.iOa(J,dh,"Pipeline error",
Ua.Error.Code,Ua.Error.Message)}catch(zf){Qa.iOa(J,dh,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Qa.iOa(J,dh);else Qa.iOa(J,dh,"Server error",vi,l);var Qb=(Ua=Y.SheetMultiRange)?Ua.SheetName:null;uh=Y.ActiveChartId;var uc=Y.SelectionState;vi=5===uc&&!!Ua||6===uc||7===uc||8===uc;if(cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Qa.$.zb.Mz&&vi)Qa.De.wf(ad.a.TDc,ia),Xa.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",
uc.toString()));else if(5===uc&&Ua){if(Qa.$.xa&&Qb)if(Qa.$.xa.Aj(Qb))Qa.vUc(Qb);else{var ed=null;ed=function(){Qa.$.xa.Aj(Qb)&&(Xa.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Qa.vUc(Qb),Qa.$.xa.vIb(ed))};Qa.$.xa.Znb(ed);if(cg.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Dd=null;Dd=function(){Qa.$.xa.Aj(Qb)&&(Qa.vUc(Qb),Qa.$.xa.jna(Dd))};Qa.$.xa.pha(Dd)}}}else if(6===uc||7===uc||8===uc||9===uc){if(Ua){var hd=oi.g(Ua.Ranges);
if(Qb&&oi.cb(hd,!0))if(cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Qa.$.xa.Aj(Qb)){var Ke=null;Ke=function(){Qa.Aeg(zd,hd,Qb,uc);Qa.$.xa.jna(Ke)};Qa.$.xa.pha(Ke)}else Qa.Aeg(zd,hd,Qb,uc)}7===uc?(uh="38.{"+wl.c(uh)+"}",Ik.a(Qa.$).Dna(0,uh,!0)):8===uc&&Ik.a(Qa.$).Dna(2,uh,!0);9===uc&&(Qa.$.ya.ApiCallToSetPageLayout=!0)}Y.PostProcessActions?Qa.$.Sgf?(J=lj.a.oi(Y.PostProcessActions),Qa.X_i(J).then(function(){Qa.Vcb(Y,ia);Qa.Cbd(F.DdaMethod.ControlId,
Mc);return Promise.resolve(null)},function(zf){Qa.Vcb(Y,ia,zf);return Promise.reject(zf)})):(Qa.iOa(J,dh,"Promise not supported",null,"Promise is not supported on this browser."),Qa.De.wf(ad.a.internalError,ia)):Qa.Vcb(Y,ia)}},function(uh){Qa.nYf(bj,!1,null);Qa.iOa(null,dh,"Web service error");ia(uh)})};c.prototype.Cbd=function(F,ia){var Qa=Object(Oh.a)(gi.DdaFacade,hk.a(this.$));(null===Qa||void 0===Qa?0:Qa.OMd)&&Qa.pn(F)&&c.yxj(ia.RequestHeaders)&&(Xa.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",
F,ia.SolutionId),Qa.OMd.jmh(F))};c.prototype.Nyh=function(F,ia){var Qa=this,Ab=this.Ke.YZ(F.DdaMethod.ControlId),Ec=gi.DdaFacade.getSolutionId(Ab,this.$),Mc=null;Mc=gi.DdaFacade.qva(Ab,this.$);Mc=new C(Mc,this.$);Mc=new e(Ec,F.DdaMethod.ControlId,this.Ke,this.$,Mc);var zd={ResponseHeaders:[]};zd.ResponseBody=Array(1);Ab=c.V_e(F.ArrayData[3]);var Ld=c.Z2e(Ab);Ab=new ha(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.Asf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Mc,ka,Ab,F.ArrayData).then(function(ye){if(!ye)return Qa.vvd(!1,
"The rich api executor call failed",Ld),Xa.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),zd.ResponseStatusCode=500,Qa.Vcb(zd,ia),null;Qa.vvd(!0,"The rich api executor call succeeded",Ld);zd.ResponseStatusCode=ye[0];zd.ResponseBody[0]=ye[2];Qa.Vcb(zd,ia);return null},function(ye){zd.ResponseStatusCode=400;zd.ResponseBody[0]=ye.toString();Qa.vvd(!1,"The rich api executor call failed",Ld);Xa.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",
Ec);Qa.Vcb(zd,ia);return null})};c.prototype.nYf=function(F,ia,Qa){c.oEd--;F=yl.a(ai.a.Ta,F);Xa.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",F,c.oEd,ia?"success":"false",Qa)};c.prototype.Vcb=function(F,ia,Qa){Qa=void 0===Qa?null:Qa;var Ab=Array(3);Ab[0]=F.ResponseStatusCode;Ab[1]=c.QZh(F.ResponseHeaders);var Ec=[],Mc=!1;if(Qa&&F.ResponseBody){var zd=lj.a.oi(F.ResponseBody.join(""));zd.Error||
(Mc={},Mc.Error=Qa,Mc.TraceIds=zd.TraceIds,Mc.ProcessedResults={},Mc.ProcessedResults.Results=zd.Results,Ec[0]=lj.a.Lc(Mc),Mc=!0)}Ab[2]=Mc?Ec:F.ResponseBody;F=this.De.AQ();F.Data=Ab;ia(F)};c.prototype.pyd=function(F,ia){(new H(this.$,this.De,this.jA)).pyd(F,ia)};c.prototype.iBi=function(F,ia){Xa.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Qa=F[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Ab=F[Eg.a.uWc],Ec=F[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];F=this.$.da.Aa(232).S1a.jBi(F.DdaMethod.ControlId,
Qa,Ab,Ec);F===ad.a.success?this.De.mv(ia):(Xa.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.De.wf(F,ia))};c.prototype.eBi=function(F,ia){Xa.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Qa=F[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],Ab=F[Eg.a.uWc],Ec=F[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).S1a.Wnj(F.DdaMethod.ControlId,Qa,Ab,Ec);this.De.mv(ia)};c.prototype.getAccessToken=function(F,ia){function Qa(Mc,zd){var Ld;if(Mc===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Mc=Ab.De.AQ(),Mc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=zd.accessToken,ia(Mc);else{zd=Ab.Ke.YZ(F.DdaMethod.ControlId);var ye=null!==zd.OwnerAddinSolutionId?zd.OwnerAddinSolutionId:zd.PrimaryMarketplace.MarketplaceType,Te={};Xa.ULS.sendTraceTag(537163202,0,10,"{0}.",(Te.errorCode=Mc.toString(),Te.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(gi.DdaFacade.getSolutionId(zd,Ab.$),ye,null===(Ld=zd.AssetMarketplace)||void 0===
Ld?void 0:Ld.SolutionId,null,null,zd.PrimaryMarketplace.MarketplaceRef),Te.storeType=ye,Te));Ab.De.wf(Mc,ia)}}var Ab=this;Xa.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var Ec=!cg.EwaSettings.ma(24);mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(Mc){var zd=Ab.Ke.Gi,Ld=va.getInstance();N.AppsForOfficeSingleSignOnManager.getInstance(zd,Mc.result,Ld).getAccessToken(F.DdaMethod.ControlId,Ec,F,Qa)},this.$.la)};c.prototype.getAuthContext=function(F,
ia){var Qa=this;mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var Ab=Qa.Ke.Gi.getOsfControl(F.DdaMethod.ControlId);if(!cg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Ab.isFirstParty()){Ab=Ab.getManifest();var Ec=Ab.getMarketplaceID(),Mc=Ab.getWebApplicationId(),zd=Ab.getWebApplicationMsaId();ui.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Ec).then(function(Ld){var ye=Qa.De.AQ(),
Te={};Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Mc;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=zd||Mc;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ld.upn;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ld.userId;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ld.authority;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Fi.oKh(Ld.authorityType);Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Ld.isAnonymous;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ld.tenantId;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ld.supportsAuthToken;ye[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Te;ia(ye)},function(Ld){var ye=Qa.De.AQ(),Te={},rf=new Fi;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Mc;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=zd||Mc;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
rf.upn;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=rf.userId;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=rf.authority;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=rf.authorityType;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=rf.isAnonymous;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=rf.tenantId;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Ld;Te[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
rf.supportsAuthToken;ye[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Te;ye.Error=1;ia(ye)})}},this.$.la)};c.prototype.zhi=function(F){var ia=Ii.g(this.$).ha;return 16===ia.Ue&&!!ia.Oa.oc&&!!ia.Oa.oc.floatingObject&&Jk.a.equals(ia.Oa.oc.floatingObject.id,F,!0)};c.prototype.Eed=function(F){var ia=Ii.g(this.$).ha;return ia.ta.Lg?1===ia.Ue||this.zhi(F)?ia.Iia:null:null};c.prototype.Zic=function(F,ia){return 1!==F&&2!==F&&3!==F?(this.De.wf(ad.a.aBe,ia),!1):!0};c.prototype.vvd=function(F,
ia,Qa){var Ab={};Ab.a=this.$.ya.UserSessionId;Ab.b=F;Ab.c=ia;Ab.d=null;Ab.e=Qa;sh.b().Pe(37,Ab)};c.prototype.iOa=function(F,ia,Qa,Ab,Ec){Qa=void 0===Qa?null:Qa;Ab=void 0===Ab?null:Ab;Ec=void 0===Ec?null:Ec;var Mc={};F&&(Mc.ServerCorrelationId=F);void 0!==ia&&null!==ia&&(Mc.Source=ia);Qa&&(Mc.ErrorType=Qa);Ab&&(Mc.MessageId=Ab);Ec&&(Mc.StatusDescription=Ec);cg.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&Ab&&"ExternalDataRefreshFailed"===Ab&&(Mc.StatusDescription="");Xa.ULS.sendTraceTag(50688452,
0,50,lj.a.Lc(Mc))};c.prototype.X_i=function(F){for(var ia=new Promise(function(Ab){Ab(null)}),Qa=0;Qa<F.length;Qa++)ia=this.W_i(ia,F[Qa]);return ia};c.prototype.W_i=function(F,ia){var Qa=this;if(!ia)return Xa.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),F.then(function(){return Promise.reject(c.O3a(M.generalException,Cf.a.instance.fa(1725),null))});switch(ia.actionType){case 1:case 2:F=F.then(function(){var Ab=Object(Oh.a)(gi.DdaFacade,hk.a(Qa.$));if(Ab.pn(ia.controlId))switch(Ab.ij.O3h(ia),
ia.messageType){case 14:case 100:Ab.NMd.E0b(ia);break;case 11:case 12:Ab.ejj.bpb(ia);break;case 51:case 52:Ab.cjj.bpb(ia);break;case 2101:case 2102:Ab.djj.bpb(ia);break;case 2E3:Ab.fjj.E0b(ia);break;case 2201:Qa.$.dla&&Ab.OMd.NMg(ia);break;case 2203:Ab.gjj.OMg(ia);break;case 2700:cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Ab.MMd.E0b(ia)}else Xa.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",ia.controlId);return Promise.resolve(null)});break;
case 3:F=F.then(function(){Qa.C3h(ia);return Promise.resolve(null)});break;case 15:cg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(F=F.then(function(){Qa.b5h(ia);return Promise.resolve(null)}));break;case 4:F=F.then(function(){if(cg.EwaSettings.ma(105)){var Ab=Ii.g(Qa.$).ha.ta.activeCell;Ab.top!==ia.row+1&&Ab.left!==ia.column+1&&(Ab=oi.v(ve.Range.hd(ia.row+1,ia.column+1),Qa.$),Ii.g(Qa.$).Eg(Ab,null,null,null,3,mk.a.tch));qk.a(Qa.$,243,242,0,function(Ec){Ec.Ydb(ia.row+1,ia.column+
1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:F=F.then(function(){Object(Oh.a)(gi.DdaFacade,hk.a(Qa.$)).ij.ZLe(ia.controlId,ia.isEnableEvents);return Promise.resolve(null)});break;case 5:F=F.then(function(){return Qa.Sah(ia)});break;case 6:F=F.then(function(){return Qa.fWi(ia)});break;case 8:F=F.then(function(){cg.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(Oh.a)(gi.DdaFacade,hk.a(Qa.$)).zYg();var Ab=new tl.a(vl.a.Ik,5,null);
ll.a(Qa.$).rt(Ab);return Promise.resolve(null)});break;case 9:F=F.then(function(){return Qa.Fpj(ia)});break;case 10:F=F.then(function(){return Qa.rYj(ia)});break;case 11:F=F.then(function(){return Qa.qYj()});break;case 12:F=F.then(function(){return Qa.nYj()});break;case 13:F=F.then(function(){return Qa.oYj(ia)});break;case 14:F=F.then(function(){return Qa.pYj(ia)});break;case 16:F=F.then(function(){return Promise.resolve(ia)});break;case 17:F=F.then(function(){return Qa.Vlj(ia,Object(Oh.a)(gi.DdaFacade,
hk.a(Qa.$)))});break;case 18:Ii.g(this.$).focus();break;case 19:this.j6e(ia.entryType,!1,ia.options);break;case 20:this.j6e(ia.entryType,!0,ia.options);break;default:F=F.then(function(){return Promise.reject(c.O3a(M.iKg,Cf.a.instance.fa(1726),null))})}return F};c.prototype.b5h=function(F){var ia=Object(Oh.a)(gi.DdaFacade,hk.a(this.$)).pn(F.controlId);if(ia&&!(0===F.operationType^!ia.Xda)){Ii.g(this.$).qic=!0;switch(F.operationType){case 0:var Qa=new Yk.a(document.createElement("input"));Qa.text=F.range;
ia.hci(Ii.g(this.$).rg.o$g(Qa,new ul.a(this.$)));ia.Xda.startEdit(!0);break;case 1:ia.nQf();this.rangePicker=null;break;case 2:ia.Xda.Peg(F.range);break;case 3:ia.Xda.Peg(F.startingRange);ia=F.expandSelection;Qa=F.getNextDataRegionCell;var Ab=0;switch(F.keyboardDirectionValue){case 2:Ab=38;F=ia&&Qa?105288353:ia?-31900117:Qa?542791952:137938150;break;case 3:Ab=40;F=ia&&Qa?-1297307319:ia?-1603798598:Qa?1713663844:-798660877;break;case 0:Ab=37;F=ia&&Qa?-403586027:ia?2039316657:Qa?-2012742350:-1470715894;
break;case 1:Ab=39;F=ia&&Qa?784916030:ia?589730764:Qa?1324884057:-1231471547;break;default:F=1461300262}ia=this.$4b("keydown",Ab,ia,Qa);Ii.g(this.$).qJb(ia,new Vb.a(F,1,0,8,null))}Ii.g(this.$).qic=!1}};c.prototype.$4b=function(F,ia,Qa,Ab){var Ec=document.createEvent("KeyboardEvent");if(Og.a.CF)Ec.initKeyboardEvent(F,!1,!1,window.self,"A",0,Ab,!1,Qa,!1);else{var Mc="";Qa&&(Mc+="Shift");Ab&&(Mc+=0<Mc.length?" Control":"Control");Ec.initKeyboardEvent(F,!1,!1,window.self,"A",0,Mc,!1,"en-US")}F=new Sys.UI.DomEvent(Ec);
F.keyCode=ia;return F};c.prototype.C3h=function(F){switch(F.operationType){case 1:mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(ia){ia.result.JLd()},this.$.la,3);break;case 2:if(F=Object(Oh.a)(gi.DdaFacade,hk.a(this.$)).pn(F.controlId))F.zqd=!0,F.nKf()}};c.prototype.Sah=function(F){var ia=this,Qa=F.fileBase64;return Qa&&Qa.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.O3a(M.invalidArgument,Cf.a.instance.fa(1729),"Application.CreateWorkbook")):
(new Promise(function(Ab,Ec){var Mc=new Pb.StandardDialog;Mc.jc=4;Mc.Ak(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(zd){2!==zd&&0!==zd||Ec(c.O3a(M.tDd,Cf.a.instance.fa(1728),"Application.CreateWorkbook"));zd=new xa("blank","agave",Qa?"streamBase64":"streamEmpty",Qa);ia.Asf.create(Ab,Ec,zd).f1a()})})).then(function(Ab){ia.N9b.set(F.fakeFileId,Ab);return Promise.resolve(null)},function(Ab){return Ab?Promise.reject(Ab):Promise.reject(c.O3a(M.generalException,
Cf.a.instance.fa(1725),"Application.CreateWorkbook"))})};c.prototype.fWi=function(F){var ia=this;return new Promise(function(Qa,Ab){if(ia.N9b.has(F.fakeFileId)){var Ec=ia.N9b.get(F.fakeFileId);Ab=new Pb.StandardDialog;Ab.jc=4;Ab.Ak(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Mc){1===Mc&&Pc.HelperMethods.rf(Ec,void 0,void 0,"DdaMethodHandler.fileUrl");Qa(null)})}else Ab(c.O3a(M.generalException,Cf.a.instance.fa(1725),"Document.Open"))})};c.prototype.Fpj=
function(F){var ia=this;return new Promise(function(Qa){Object(Oh.a)(gi.DdaFacade,hk.a(ia.$)).SUf=F.runtimeCalculationMode;var Ab=ia.$.da.Aa(268);Ab&&Ab.qzd(3===F.runtimeCalculationMode);Qa(null)})};c.prototype.rYj=function(F){ii.a.WAb(this.$)&&this.$.da.Aa(331).Wcb(0,F.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.qYj=function(){ii.a.WAb(this.$)&&this.$.da.Aa(331).Wcb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.nYj=function(){ii.a.WAb(this.$)&&this.$.da.Aa(331).WLe();
return Promise.resolve(null)};c.prototype.oYj=function(F){ii.a.WAb(this.$)&&this.$.da.Aa(331).Wcb(5,F.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.pYj=function(F){if(ii.a.WAb(this.$)){var ia=this.$.da.Aa(331);ia=Cl(ia.Naa);for(var Qa=ia.next();!Qa.done;Qa=ia.next())Qa=Qa.value,Qa.IsActive&&Qa.HostEditUrl&&Qa.UrlStr===F.hostEditUrlStr&&Pc.HelperMethods.rf(Qa.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.Vlj=function(F,ia){var Qa=Fd.a.BX;F=lj.a.oi(F.payload);var Ab=
{};"eventId"in F&&"payload"in F&&(Ab.eventId=F.eventId,Ab.payload=F.payload);ia.WM(2201,Qa,lj.a.Lc(Ab));return Promise.resolve(null)};c.prototype.j6e=function(F,ia,Qa){var Ab=this.$.da.Aa(5);Ab&&(F=this.hLh(F))&&(ia?Ab.removeEntry(F):Ab.Yme(F,Qa))};c.prototype.hLh=function(F){switch(F){case 0:return 63}};c.prototype.vUc=function(F){F=Object(Oh.a)(sl.a,this.$.xa.getItemByName(F));(null===F||void 0===F?0:F.visible)&&F.activate(!0)};c.prototype.Aeg=function(F,ia,Qa,Ab){var Ec=F.ta.sB,Mc=Ec<ia.length&&
ia[Ec].contains(F.ta.activeCell);F=Mc?F.ta.activeCell:ia[0].topLeft;Ec=Mc?Ec:0;Ii.g(this.$).bW(ia,Ec,Qa,null,F,null,null,3,mk.a.uch,void 0,void 0,void 0,6===Ab)};c.V_e=function(F){if(!F||!F.length)return null;for(var ia=Array(F.length/2),Qa=0;Qa<F.length/2;Qa++)ia[Qa]={},ia[Qa].Name=F[2*Qa],ia[Qa].Value=F[2*Qa+1];return ia};c.QZh=function(F){if(!F||!F.length)return null;for(var ia=Array(2*F.length),Qa=0;Qa<F.length;Qa++)ia[2*Qa]=F[Qa].Name,ia[2*Qa+1]=F[Qa].Value;return ia};c.Qbd=function(F){if(!F||
!F.length)return null;for(var ia=Array(F.length),Qa=0,Ab=F.length;Qa<Ab;Qa++){var Ec=F[Qa].length;if(Ec){ia[Qa]=Array(Ec);for(var Mc=0;Mc<Ec;Mc++)ia[Qa][Mc]=null==F[Qa][Mc]?null:F[Qa][Mc].toString()}else return null}return ia};c.l3b=function(F){return"string"===typeof F?ql.a.fo(c.pch,F,0):F};c.fUe=function(F){return"string"===typeof F?ql.a.fo(c.sch,F,0):F};c.agg=function(F){return"string"===typeof F?ql.a.fo(c.wch,F,0):F};c.Khi=function(F){switch(F.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
c.yZc=function(F,ia){var Qa={};Qa.CoerceType=F;1===Qa.CoerceType?(Qa.Data=c.Qbd(ia.Rows),Qa.Headers=c.Qbd(ia.Headers)):Qa.Data=c.Qbd(ia);return Qa};c.vve=function(F){if(1===F.CoerceType){var ia={};return ia.Headers=F.Headers,ia.Rows=F.Data,ia}return F.Data};c.dgc=function(F){return 1===F.CoerceType?!F.Data&&!F.Headers:!F.Data};c.Z2e=function(F){var ia="Unknown";if(!F)return ia;for(var Qa=0;Qa<F.length;Qa++)if(F[Qa].Name.toLowerCase()===Xj.a.hjj){ia=F[Qa].Value;break}return ia};c.yxj=function(F){if(!F)return!1;
for(var ia=Xj.a.iGi.toLowerCase(),Qa=0;Qa<F.length;Qa++)if(F[Qa].Name.toLowerCase()===ia)return!0;return!1};c.O3a=function(F,ia,Qa){var Ab={};Ab.Code=F;Ab.Message=ia;Ab.Location=Qa;Ab.ActionIndex=0;return Ab};Ck.Object.defineProperties(c.prototype,{VQ:{configurable:!0,enumerable:!0,get:function(){return this.De}}});Ck.Object.defineProperties(c,{pch:{configurable:!0,enumerable:!0,get:function(){c.cqa||(c.cqa={},c.cqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.cqa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,c.cqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.cqa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.cqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return c.cqa}},sch:{configurable:!0,enumerable:!0,get:function(){c.oib||(c.oib={},c.oib[Microsoft.Office.WebExtension.FilterType.All]=1,c.oib[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.oib}},wch:{configurable:!0,enumerable:!0,get:function(){c.pib||(c.pib={},c.pib[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,c.pib[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.pib}}});c.cqa=null;c.oib=null;c.pib=null;c.oEd=0;Object(Lb.a)(c,"DdaMethodHandler",null,[424,2]);var dl=Qj.a;Am(a,dl);a.prototype.Nd=function(){var F=this,ia=nj.GetServiceTaskFactory.create(this.$.da,106,this.la,this.ub),Qa=nj.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub),Ab=Cc(this.la,this.ub);mi.TaskExtensions.Ba(mi.TaskExtensions.xe([ia,Qa,Ab],this.la),function(){var Mc=ia.result,zd=ui.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
F.Dd([new c(F.$,Mc,zd)])},this.la,3);var Ec=ui.a.instance;mi.TaskExtensions.Ba(nj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.ub),function(){Ec.register(Ta,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ic().Oc(function(){return new Ta})},this.$.la)};a.ka=function(F){Qj.a.he(82,new a(F))};Object(Lb.a)(a,"DdaCommandHandlerFactory",Qj.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");lb.a.Li("");lb.a.Li(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Kb.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");
ti.main();(function(){Zj.a.Fa(function(F){oe.ka(F)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){Zj.a.Fa(function(F){Id.ka(F);Ig.ka(F)})})();(function(){Zj.a.Fa(function(F){ie.ka(F)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){Zj.a.Fa(function(F){cg.EwaSettings.ma(54)&&mb.ka(F)})})();(function(){Zj.a.Fa(function(F){cg.EwaSettings.ma(122)&&cd.ka(F)})})();Zj.a.Fa(Fb.ka);Zj.a.Fa(Ob.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(function(){Zj.a.Fa(function(F){eb.ka(F);gb.ka(F);ra.ka(F)})})();Zj.a.Fa(a.ka)},1476:function(z,E,b){function a(){this.oFc=null;this.ZJc=0;this.FLc=!1;this.Za=new f.a;this.crg=new e.a}function c(){this.VKe=this.displayName=this.rrb=this.Ko=this.HB=null;this.isUpgraded=!1}z=b(0);var e=b(201),f=b(97);c.prototype.qrd=function(m,n){return this.HB.getStoreType().toLowerCase()===m.toLowerCase()&&this.HB.getSolutionId().toLowerCase()===n.toLowerCase()};Object(z.a)(c,
"AddinCommandsResourceItem",null,[]);b.d(E,"a",function(){return a});a.prototype.pEg=function(m){this.Za.addHandler("AddinCommandsLoadingMessageChanged",m)};a.prototype.ebj=function(m){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",m)};a.prototype.wdb=function(m){m!==this.oFc&&(this.oFc=m,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.Bpj=function(){this.ZJc++;this.rZa||this.wdb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Ewc=function(){this.ZJc--;this.Gud()&&
(this.FLc?this.rZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.wdb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.wdb(null))};a.prototype.UZf=function(m){this.FLc=!0;this.wdb((void 0===m?0:m)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.wze=function(){this.FLc=!1;this.Gud()?this.wdb(null):this.wdb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Gud=function(){return 0>=this.ZJc};a.prototype.O4=function(m,n,w){w=void 0===
w?0:w;for(var h=Cl(this.m6a),y=h.next();!y.done;y=h.next())if(y=y.value,y.qrd(m,n)&&(!y.Ko||y.Ko.NIh===w))return y;return null};a.prototype.Sme=function(m,n,w,h){var y=new c;y.HB=m;y.Ko=n;y.rrb=w;y.displayName=h;this.m6a.add(y)};a.prototype.uCg=function(m,n,w,h){var y=new c;y.HB=m;y.Ko=n;y.rrb=null;y.VKe=w;y.displayName=h;this.m6a.add(y)};a.prototype.I$i=function(m,n){for(var w=0,h=Cl(this.m6a),y=h.next();!y.done;y=h.next())y=y.value,y.HB.getStoreType()===m&&y.HB.getSolutionId()===n?this.m6a.removeAt(w):
w++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};Ck.Object.defineProperties(a.prototype,{rZa:{configurable:!0,enumerable:!0,get:function(){return this.oFc}},m6a:{configurable:!0,enumerable:!0,get:function(){return this.crg}}});a.Ma=null;Object(z.a)(a,"AddinCommandsResourceManager",null,[])},942:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.MCa="Alt";a.aVa="Command";a.OCa="Enabled";a.FEc="GroupId";a.id="Id";a.PCa="Image16by16";a.K1d="Image32by32";a.O1d="Keytip";
a.Ygb="LabelText";a.tpa="Size";a.Y1d="TemplateAlias";a.ofa="Title";a.V1d="Tab";a.LEc="Scaling";a.IEc="MaxSize";a.KEc="Scale";a.GROUP="Group";a.Vgb="Groups";a.bVa="Controls";a.X1d="Template";a.button="Button";a.b_="FlyoutAnchor";a.LARGE="Large";a.uQb="Medium";a.SMALL="Small";Object(z.a)(a,"DataNodeWrapper",null,[])},943:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);var c=b(35);a.vWe=function(e){return c.a.fo(a.gBi,e.toString(),a.internalError)};Ck.Object.defineProperties(a,{gBi:{configurable:!0,
enumerable:!0,get:function(){var e={};return a.pce||(a.pce=(e["-2002156328"]=a.aBe,e["-1954750170"]=a.s3e,e["317650254"]=a.r_g,e["-1005263101"]=a.qei,e["1353664579"]=a.onj,e["159671765"]=a.rei,e["1446690022"]=a.CZe,e["1150069548"]=a.NBc,e["-1409306331"]=a.Oxe,e["338507772"]=a.YGe,e["-457159301"]=a.YWi,e["-1037701970"]=a.Rbh,e["-1893322318"]=a.wei,e["965579896"]=a.Tbh,e["93287890"]=a.Sbh,e["358088857"]=a.nqj,e["-1223650923"]=a.YGe,e["2007306190"]=a.jWg,e["1549955423"]=a.Bue,e["-1275974171"]=a.vei,
e["382101082"]=a.iWi,e["-898776235"]=a.VCi,e["335464256"]=a.KCi,e["1677378049"]=a.uei,e["-261992848"]=a.DPj,e["-980820954"]=a.Bue,e["-931375837"]=a.hWi,e["929186550"]=a.Ijh,e["-982144310"]=a.Y2i,e["-785741187"]=a.oei,e["2125217573"]=a.yei,e["299124955"]=a.pei,e["1669853884"]=a.wjj,e["-1515932330"]=a.s_g,e["314621024"]=a.jFh,e["-300049690"]=a.nWg,e["14766835"]=a.nvj,e["-1251992761"]=a.bKe,e["-2087635043"]=a.invalidOrTimedOutSession,e["2100961153"]=a.invalidOrTimedOutSession,e["-1218744139"]=a.invalidSheetName,
e["-1468309555"]=5006,e["-315732528"]=a.invalidOrTimedOutSession,e["611268539"]=a.invalidOrTimedOutSession,e["1531005923"]=5006,e["1593924569"]=5006,e["299476328"]=a.TFa,e["49173765"]=a.TFa,e["-907155566"]=a.TFa,e["-1201603824"]=a.TFa,e["1541165282"]=a.TFa,e["-1347753427"]=a.TFa,e["134912532"]=a.TFa,e["1780971550"]=a.responsePayloadSizeLimitExceeded,e))}}});a.success=0;a.aBe=1E3;a.s3e=1001;a.r_g=1002;a.qei=1003;a.onj=1004;a.rei=1005;a.CZe=1008;a.UTe=1009;a.invalidSheetName=1014;a.NBc=2E3;a.Oxe=2001;
a.YGe=2002;a.YWi=2003;a.Rbh=2004;a.wei=2005;a.Tbh=2007;a.Sbh=2008;a.nqj=2009;a.jWg=2014;a.Wmj=3E3;a.Bue=3002;a.vei=3004;a.iWi=3005;a.VCi=3006;a.KCi=3007;a.uei=3008;a.DPj=3009;a.hWi=3010;a.nvj=4002;a.wDd=5E3;a.internalError=5001;a.bKe=5002;a.Lyb=5004;a.EQj=5007;a.f$h=5008;a.XPg=5009;a.invalidOrTimedOutSession=5012;a.TDc=5016;a.TFa=5102;a.ugj=5103;a.responsePayloadSizeLimitExceeded=5104;a.FVg=7001;a.m6f=7002;a.Ijh=8E3;a.Y2i=8001;a.oei=8010;a.yei=8011;a.pei=8012;a.wjj=8020;a.s_g=8021;a.jFh=8022;a.nWg=
8023;a.LAi=11E3;a.KDi=11001;a.xei=11002;a.pce=null;Object(z.a)(a,"DdaErrorIds",null,[])},944:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.YTc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.tDd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.HQj="UnsupportedUserIdentity";
a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.qIg="AddinIsAlreadyRequestingToken";a.Uhj="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.m3g="ControlIdNotFound";a.Iij="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(z.a)(a,"ErrorCodes",null,[])},946:function(z,E,b){function a(pa,qb){var Sb=Ie.call(this)||this;Sb.ea=
null;Sb.zm=null;Sb.gi=null;Sb.Jf=[];Sb.jJa=null;Sb.CGe=!1;Sb.DPb=!1;Sb.initialized=!1;Sb.disposed=!1;Sb.xCa=null;Sb.vpc=[];Sb.xGe=[];Sb.OPa=[];Sb.E1a=null;Sb.AEd=new Ub.a(Ob.a.Pk());Sb.i_b=new Yb.a(Ob.a.Pk());Sb.kGb=[];Sb.vHf=[];Sb.t6b=350;Sb.wfa=null;Sb.Lxa=null;Sb.ITc=!1;Sb.nge=null;Sb.kge=null;Sb.oge=null;Sb.mge=null;Sb.qge=null;Sb.Nvg=null;Sb.lge=null;Sb.pge=null;Sb.rge=null;Sb.sge=null;Sb.tge=null;Sb.If=function(){Sb.xCa=Sb.ea.Rm.WebExtensions;for(var $b=Sb.Jf.length-1;0<=$b;--$b){var tc=Sb.Jf[$b],
ld;if(ld=!Sb.XCh(tc.controlId))ld=tc,ld=tb.EwaSettings.ma(122)?!ld.xIa:!0;ld&&(tc.snc(),Array.removeAt(Sb.Jf,$b))}if(Sb.xCa)for($b=0,tc=Sb.xCa.length;$b<tc;$b++){ld=Sb.xCa[$b];var Vc=Sb.pn(ld.WebExtensionId);Vc&&Vc.YBd(ld)}};Sb.poc=function($b){Sb.raiseEvent("csc",$b.getID())};Sb.mBf=function($b,tc,ld){if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&tc===OSF.AgaveHostAction.KeyboardShortcuts){var Vc=Object(xb.a)(Object,ld);tc={};tc.keyCode=Vc.keyCode;tc.type=
"keydown";tc.ctrlKey=Vc.ctrlKey;tc.shiftKey=Vc.shiftKey;tc.altKey=Vc.altKey;tc.metaKey=Vc.metaKey;$b=Sb.pn($b);Vc=$b.Fha;tc.srcElement=Object(Sa.a)(516,Vc)?Vc.zGa:Cb.g(Sb.$).uc;tc=new Sys.UI.DomEvent(tc);$b={focusedAddinId:a.qva($b.nl,Sb.$)};Vc=new nd.a(1461300262,1,Sb.$.fd,6,null);Cb.g(Sb.$).qJb(tc,Vc,$b)}else if(tc===OSF.AgaveHostAction.Select)Sb.g6e(!0);else if(tc===OSF.AgaveHostAction.UnSelect)Sb.g6e(!1);else if(tc===OSF.AgaveHostAction.CancelDialog)Sb.qK(-684355545,null);else if(tc===OSF.AgaveHostAction.InsertAgave)$b=
{},ld&&($b[nc.a.nsa]=ld,$b[ba.a.Ag]=a.Xrb(ld),Sb.qK(-741808261,$b));else if(tc===OSF.AgaveHostAction.InsertDevManifest)$b={},ld&&($b[nc.a.nsa]=ld,$b[ba.a.Ag]=a.Xrb(ld),Sb.qK(-741808261,$b));else if(tc===OSF.AgaveHostAction.InsertDevManifestError)$b=Object(xb.a)(Object,ld),tc={},$b=(tc[nc.a.tWc]=Sb.zm.getDevManifestInvalidUrlErrorString($b.manifestUrl),tc),Sb.qK(-2025863019,$b);else if(tc===OSF.AgaveHostAction.NotifyHostError)$b={},$b=($b[nc.a.tWc]=Sb.zm.getManifestInvaildErrorString(),$b),Sb.qK(-2025863019,
$b);else if(tc===OSF.AgaveHostAction.RefreshAddinCommands)tb.EwaSettings.ma(54)&&Sb.qK(Rb.a.refreshAddinCommands,null);else if(tc===OSF.AgaveHostAction.CtrlF6Exit||tc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Vc=Sb.$.da.Aa(15)){($b=Sb.pn($b).Fha)&&$b.tzc();wb.a.Hf&&document.activeElement.blur();var Se={keyCode:117,type:"keydown",ctrlKey:!0};Se.shiftKey=tc===OSF.AgaveHostAction.CtrlF6ExitShift;Se.srcElement=Object(Sa.a)(516,$b)?$b.zGa:Cb.g(Sb.$).uc;$b=new Sys.UI.DomEvent(Se);Vc.P6($b)}}else if(tc===
OSF.AgaveHostAction.PageIsReady){if(($b=Sb.pn($b).Fha)&&$b.yZa===OSF.OsfControlTarget.TaskPane&&($b=Sb.$.da.Aa(183))&&Sb.Jf)for(tc=Jc.a.Ld(Sb.$),Vc=Cl(Sb.Jf),Se=Vc.next();!Se.done;Se=Vc.next())a.wMa(Se.value.cV)&&(tc?$b.Wf(!0,!1):$b.setFocusOnToolbarFirstElement())}else if(tc===OSF.AgaveHostAction.TabExit){tc=Sb.pn($b);var Ge=tc.Fha;if(Ge)if(Ge.yZa===OSF.OsfControlTarget.InContent)Ge.Ujf();else{if(Ge.yZa===OSF.OsfControlTarget.TaskPane)if(Jc.a.Ld(Sb.$))wb.a.Hf&&document.activeElement.blur(),pb.UISurfaces.Ok().then(function(Ef){var Xf=
Object(Sa.a)(516,Ge)?Ge:null;Xf?Xf.isResizable?Ef.focusResizeHandle():Ef.focusTabbedTaskPaneArea():Ef.focusTabbedTaskPaneArea();return null});else if($b=Sb.$.da.Aa(183))wb.a.Hf&&document.activeElement.blur(),(tc=document.getElementById(Sb.$.Lb+hc.a.Fmc))&&qd.DOMElementExtensions.isVisible(tc)?qd.DOMElementExtensions.setFocus(tc):$b.setFocusOnToolbarFirstElement()}else tc&&4===tc.osfControlType&&Sb.zm.notifyAgave($b,OSF.AgaveHostAction.TabIn)}else if(tc===OSF.AgaveHostAction.TabExitShift)(tc=Sb.pn($b),
Vc=tc.Fha)?Vc.yZa===OSF.OsfControlTarget.InContent?Vc.Vjf():Vc.yZa===OSF.OsfControlTarget.TaskPane&&($b=Object(Sa.a)(516,Vc)?Vc:null)&&(wb.a.Hf&&document.activeElement.blur(),$b.e_f()):tc&&4===tc.osfControlType&&Sb.zm.notifyAgave($b,OSF.AgaveHostAction.TabIn);else if(tc===OSF.AgaveHostAction.EscExit||tc===OSF.AgaveHostAction.ExitNoFocusable||tc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Vc=Sb.pn($b).Fha)Vc.tzc();else{if(tc===OSF.AgaveHostAction.EscExit){tc=null;Vc=Cl(fa.H1h());for(Se=Vc.next();!Se.done;Se=
Vc.next())if(Se=Se.value,Se.value.Oe===$b){Se.value.dialog.hide();tc=Se.key;break}tc&&($b=Sb.pn(tc))&&4!==$b.osfControlType&&Sb.Gi.notifyAgave(tc,OSF.AgaveHostAction.TabIn)}}else if(tc===OSF.AgaveHostAction.InstallCustomFunctions)if(tb.EwaSettings.ma(122)){gg.a(Sb.$).TVe(function(){return!1});var Af=Sb.$.da;Ca.TaskExtensions.Ba(Fc.GetServiceTaskFactory.Ua(Af,278,279,1),function(Ef){Ef=Ef.result;Af.Aa(278)||Af.Ga(278,Ef);var Xf=ld.osfControl.getStoreType();Ef.ubf(ld.osfControl.getSolutionId(),Xf,a.TNh(ld.osfControl),
ld).wna()},Sb.la,3)}else kb.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(tc===OSF.AgaveHostAction.UninstallCustomFunctions)if(tb.EwaSettings.ma(122)){gg.a(Sb.$).TVe(function(){return!1});var jf=Sb.$.da;Ca.TaskExtensions.Ba(Fc.GetServiceTaskFactory.Ua(jf,278,279,1),function(Ef){Ef=Ef.result;jf.Aa(278)||jf.Ga(278,Ef);Ef.Ybg(ld.solutionId,ld.storeType).wna()},Sb.la,3)}else kb.ULS.sendTraceTag(537170574,0,10,
"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else tc===OSF.AgaveHostAction.SendTelemetryEvent?e(ld):tc===OSF.AgaveHostAction.SendCustomerContent?c(ld):tc===OSF.AgaveHostAction.LaunchExtensionComponent?ac.a.instance.bsi(ld):tc===OSF.AgaveHostAction.RefreshRibbonGallery?($b=Sb.$.da.Aa(352))&&$b.Gjd(ld):tc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Sb.Iaj(ld.solutionId),Jc.a.Ld(Sb.$)||($b=Sb.$.da.Aa(183))&&$b.px(),tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&gb.AFrameworkApplication.Ib.Be(Rb.a.BPf,2,ld.assetId)):tc===OSF.AgaveHostAction.GetOriginalControlId&&($b=new ib.a(Sb.$.Lb,ld.ownerAddinSolutionId,new cd.a,!0),ld.originalControlId=$b?$b.OGe(ld.controlId):ld.controlId)};Sb.bVi=function(){Sb.$.qa&&ne.o(Sb.$.qa)&&Sb.$.da.Aa(34).Kmd()};Sb.zd=function(){Sb.Ulf()};Sb.mS=function($b,tc){var ld,Vc;1===tc.uu&&($b=tc.Hg)&&(tc=new m(Ne.toTimestamp($b.enqueueUtcTime),Ne.toTimestamp($b.processUtcTime),Ne.toTimestamp($b.dequeueUtcTime),Ne.getElapsedMilliseconds($b.enqueueUtcTime,
$b.processUtcTime),Ne.getElapsedMilliseconds($b.processUtcTime,$b.dequeueUtcTime),$b.operationCount,(null===(Vc=null===(ld=$b.operation)||void 0===ld?void 0:ld.od)||void 0===Vc?0:Vc.ServerCorrelationId)?$b.operation.od.ServerCorrelationId:null,$b.operation?Enum.toString(Dc.a,$b.operation.operationName):null,jc.a.aD(Ne.getElapsedMilliseconds($b.enqueueUtcTime,ie.a.Ta.Wb))),ld=Sys.Serialization.JavaScriptSerializer.serialize(tc),kb.ULS.sendTraceTag(50872916,0,50,ld))};Sb.qd=function($b,tc){!Sb.ea.sc&&
Le.a(tc)?(Array.forEach(Sb.Jf,Sb.Wwf),Array.clear(Sb.Jf),Sb.DPb=!1):(tc.WH&&(kb.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),Sb.TTf()),Sb.rL(),tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(Sb.DPb=!1))};Sb.Io=function(){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(kb.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Sb.TTf());Sb.rL();
tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Sb.DPb=!1)};Sb.Wwf=function($b){$b.snc();Sb.raiseEvent("cd",$b.controlId)};Sb.wb=pa;Sb.LWc=qb;Sb.initialize();ca.ka(Sb);Sb.SUf=0;(pa=(pa=!(wb.a.xp||wb.a.bla))&&(!tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!wb.a.Hf))&&OfficeExt.ShortcutKeyDispatchManager.init();Sb.drg={};return Sb}function c(pa){Md.a.sendOtelCustomerContent(Object.assign(new Ce.a,{otelEvent:pa}))}
function e(pa){Md.a.sendOtelEvent(Object.assign(new Ce.a,{otelEvent:pa}))}function f(pa,qb,Sb){var $b=ee.call(this,Sb,pa)||this;$b.hashCode=null;$b.awa=null;$b.c4b=!1;$b.Tm=function(tc,ld){ld.nd.hash===$b.hashCode&&$b.awa&&Object(xb.a)(b(946).DdaFacade,$b.$.da.Aa(35)).SAj($b.awa.InstanceId)};$b.zf=function(tc,ld){switch(ld.nd.block.state){case 1:case 3:case 5:$b.Tna(ld)}};$b.Qi=function(){$b.gHb(!0)};$b.Go=function(tc,ld){$b.isVisible&&$b.eUa(ld.UF);$b.clearCache()};$b.He=function(tc,ld){$b.gTa(ld.qa,
!!ld.UF)};$b.$N=function(){$b.$.ea.Ema()};$b.MUa=qb;$b.domElement.classList.add(Tc.a.j9b);$b.domElement.classList.add(Ve.a.lm);Sb.tabIndex=0;$b.gTa($b.$.qa,!1);$b.Fc.ka("mousedown",$b.$N);$b.Fc.ka("contextmenu",function(tc){Xd.g(tc)});$b.$.xa.GJ($b.Go);$b.$.Hb.GJ($b.Go);$b.$.Hb.zg($b.He);$b.$.xa.zg($b.He);$b.Ea.Ss($b.zf);$b.Ea.UG($b.Tm);$b.Ea.Ix($b.Qi);tb.EwaSettings.qc()&&$b.Nt($b.Nya);return $b}function m(pa,qb,Sb,$b,tc,ld,Vc,Se,Ge){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;
this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=pa;this.processUtcTime=qb;this.dequeueUtcTime=Sb;this.inQueueDurationInMS=$b;this.executionDurationInMS=tc;this.operationCount=ld;this.ServerCorrelationId=Vc;this.UserOperationName=Se;this.IsDocumentHidden=Ge}function n(pa,qb,Sb){this.$=pa;this.ij=qb;this.runtimeCalculationMode=Sb}function w(){}function h(pa,qb,Sb){var $b=this;
this.cGf=null;this.Bbd=function(tc,ld){var Vc=kd.a.BX,Se={};Se.eventId=tc;Se.payload=ld;$b.ij.C_(2201,Vc)&&$b.gi.WM(2201,Vc,gd.a.Lc(Se))};this.$=pa;this.ij=qb;this.gi=Sb;this.Kbi()}function y(pa,qb,Sb){var $b=this;this.PHb=0;this.Ahg=!0;this.N$b=0;this.ird=!0;this.$ye=function(){var tc=document.hasFocus();if($b.Ahg!==tc){if(tc){var ld=gd.a.Lc({});$b.gi.WM(2203,kd.a.BX,ld)}$b.Ahg=tc}};this.aze=function(tc){(0<tc.timeRemaining()||tc.didTimeout)&&$b.$ye();window.requestIdleCallback($b.aze)};this.$=pa;
this.ij=qb;this.gi=Sb;window.requestIdleCallback||(this.ird=!1)}function r(pa,qb,Sb){var $b=this;this.OHb=0;this.yab=this.Fab=null;this.iFf=function(){var tc=Cb.g($b.$).ha.Oa.IC;if(tc)if($b.cjf(tc)){var ld=$b.Oja();$b.Dbd(ld);$b.Fab=tc.floatingObject.id;$b.yab=ld}else $b.Fab&&($b.Dbd($b.yab),$b.Fab=null,$b.yab=null);else $b.Fab&&($b.Dbd($b.yab),$b.Fab=null,$b.yab=null)};this.$=pa;this.ij=qb;this.gi=Sb}function x(pa,qb,Sb){var $b=this;this.Z2b=null;this.jsd=!1;this.onPointerDown=function(tc){if(3===
tc.yb){var ld=$b.gridView.Pac(tc.clientPoint).r0a;$b.jsd=!!ld&&$b.gridView.ha.ta.cKe(ld)}else $b.jsd=!1;$b.Z2b=tc.clientPoint;return!1};this.vd=function(tc){if($b.gridView.inRangePicker||$b.gridView.Ni||$b.jsd||tc.shiftKey||tc.ctrlKey||tc.Ca.button!==Sys.UI.MouseButton.leftButton||!$b.Z2b||!tc.clientPoint||tc.clientPoint.x!==$b.Z2b.x||tc.clientPoint.y!==$b.Z2b.y)return!1;var ld=$b.gridView.Pac(tc.clientPoint);tc=ld.r0a;ld=ld.returnValue;var Vc=Object(xb.a)(Xe.a,$b.$.xa.qa);if(ld&&Vc&&0===Vc.MI){if(!$b.gridView.ha.ta.W4.contains(tc))return!1;
tc=new t(Vc,tc,Gb.HelperMethods.JEd(ld.x),Gb.HelperMethods.JEd(ld.y));$b.uVi(tc)}return!1};this.$=pa;this.gridView=Cb.g(pa);this.ij=qb;this.gi=Sb;this.f$i()}function t(pa,qb,Sb,$b){var tc=fd.call(this)||this;tc.sheet=pa;tc.gWg=qb;tc.offsetX=Sb;tc.offsetY=$b;return tc}function u(pa,qb,Sb){var $b=this;this.lPf=this.kPf=this.mPf=this.jPf=0;this.qVi=function(tc,ld){tc=Object(xb.a)(Xe.a,ld.qa);$b.Z7a(tc)&&(ld={},ld.worksheetId=tc.sheetId,ld=gd.a.Lc(ld),$b.tja(11,tc.sheetId,ld))};this.tVi=function(tc,ld){tc=
Object(xb.a)(Xe.a,ld.UF);$b.Z7a(tc)&&(ld={},ld.worksheetId=tc.sheetId,ld=gd.a.Lc(ld),$b.tja(12,tc.sheetId,ld))};this.rVi=function(tc,ld){tc=Object(xb.a)(Xe.a,ld.qa);$b.Z7a(tc)&&(ld={},ld.worksheetId=tc.sheetId,tc=gd.a.Lc(ld),$b.tja(11,null,tc,!0))};this.sVi=function(tc,ld){tc=Object(xb.a)(Xe.a,ld.UF);$b.Z7a(tc)&&(ld={},ld.worksheetId=tc.sheetId,tc=gd.a.Lc(ld),$b.tja(12,null,tc,!0))};this.$=pa;this.ij=qb;this.gi=Sb}function B(pa,qb,Sb){var $b=this;this.HQa=this.GQa=0;this.gHa=this.Zha=null;this.iyf=
function(){var tc=Cb.g($b.$).ha.Oa.IC;if(0<$b.HQa&&$b.Zha&&$b.gHa){var ld={};ld.shapeId=$b.Zha;ld.worksheetId=$b.gHa;ld=gd.a.Lc(ld);$b.fireEvent(2102,$b.Zha,ld)}$b.Fni(tc)?($b.Zha=$b.bOj(tc),$b.gHa=$b.Oja(),$b.Zha&&$b.gHa)?0<$b.GQa&&(tc={},tc.shapeId=$b.Zha,tc.worksheetId=$b.gHa,tc=gd.a.Lc(tc),$b.fireEvent(2101,$b.Zha,tc)):kb.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",$b.Zha,$b.gHa):($b.Zha=null,
$b.gHa=null)};this.$=pa;this.ij=qb;this.gi=Sb}function v(pa,qb,Sb){pa=C.call(this,pa,qb,Sb)||this;pa.qkf=null;pa.pkf=null;return pa}function C(pa,qb,Sb){var $b=dd.call(this)||this;$b.fAa=0;$b.qV=0;$b.kd=function(tc,ld){if($b.enabled&&!($b.nff()||null!==ld&&void 0!==ld&&ld.Eif)&&(tc=Object(xb.a)(Xe.a,$b.$.xa.qa))&&0===tc.MI){var Vc=tc.sheetId,Se=$b.vZe(),Ge=null,Af=null;$b.ij.tif()&&(Ge=$b.grid.Rb.Qj($b.grid.ha.ta.activeCell),Af=Vc in $b.Fjc?$b.Fjc[Vc]:null);$b.Jse(Vc,Se)&&Ca.TaskExtensions.Ba(fc.Task.Ra(!0),
function(){$b.X5h(Vc,Se);$b.J5h(Vc,Se,Ge,Af)},$b.la);$b.XJe(Vc,Se,Ge)}};$b.$=pa;$b.ij=qb;$b.gi=Sb;$b.grid=Cb.g(pa);$b.HNa={};$b.Fjc={};return $b}function A(pa,qb,Sb){var $b=this;this.hPf=this.gPf=0;this.mLb=this.Iab=null;this.gIi=function(){var tc=Cb.g($b.$).ha.Oa.IC;if($b.tod(tc)&&(tc=$b.Sac(tc))){var ld={chartId:tc};ld.worksheetId=$b.Oja();ld=gd.a.Lc(ld);$b.tja(51,tc,ld);$b.tja(51,$b.Oja(),ld)}};this.hIi=function(){if($b.Iab){var tc={};tc.chartId=$b.Iab;tc.worksheetId=$b.mLb;tc=gd.a.Lc(tc);$b.tja(52,
$b.Iab,tc);$b.tja(52,$b.mLb,tc)}tc=Cb.g($b.$).ha.Oa.IC;$b.tod(tc)?($b.Iab=$b.Sac(tc),$b.mLb=$b.Oja()):($b.Iab=null,$b.mLb=null)};this.$=pa;this.ij=qb;this.gi=Sb}function M(){this.tZa={}}function T(pa,qb,Sb,$b){$b=void 0===$b?!1:$b;var tc=rc.call(this)||this;tc.Zcb=0;tc.YE=null;tc.wwa=!1;tc.Yqc=null;tc.qV=0;tc.f3d=null;tc.THc=null;tc.VVa=null;tc.a6b=null;tc.P$d=!1;tc.p0d=null;tc.Xda=null;tc.YOc=null;tc.kd=function(){tc.enabled&&(tc.foj(),tc.Yqc=Gc.d(Cb.g(tc.$).ha.ta.selectedRanges))};tc.r6e=function(ld){ld.controlId===
tc.ee.InstanceId&&Array.forEach(tc.YE,function(Vc){Vc.Izi(ld)&&Vc.O1b(ld)})};tc.Juf=function(ld){if((ld=Object(xb.a)(516,ld))&&!ld.ns())if(!tc.ee||OSF.OsfControl.isFirstPartyStoreString(tc.ee.PrimaryMarketplace.MarketplaceType)||tc.$.Cha){ld.vf=tc.ee;ld.wj=tc.Rg;tc.p0d=ld;tc.Twc(ld.zGa);var Vc=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Jc.a.Ld(tc.$)&&Gb.HelperMethods.Mw(tc.ee)&&tc.ee.Preload&&!tc.ee.TaskpaneVisible;Vc?ld.IBd():tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?
(ld.IBd(),(tc.ee.SharedRuntime&&1===tc.ee.SharedRuntime.LifeTime||tc.ee.SharedRuntimeId)&&!tc.ee.TaskpaneVisible&&ld.jg(!1)):((tc.ee.SharedRuntime&&1===tc.ee.SharedRuntime.LifeTime||tc.ee.SharedRuntimeId)&&!tc.ee.TaskpaneVisible&&ld.jg(!1),ld.IBd());tc.v6a||(Jc.a.Ld(tc.$)?Vc||ld.qS():Ed.a(tc.$).result.CD(ld,!0));tc.$.da.Aa(77).EQf(tc.Juf);tc.Fha=Object(xb.a)(584,ld)}else kb.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};tc.onFloatingObjectControlAdded=function(ld,Vc){3===
Vc.control.floatingObject.type&&Vc.control.floatingObject.nl.InstanceId===tc.O1.WebExtensionId&&(tc.Fha=Object(xb.a)(584,Vc.control),tc.Twc(Vc.control.Qd.firstChild),Oc.a(tc.$).ftc(tc.onFloatingObjectControlAdded))};tc.wb=pa.$;tc.Rg=pa;tc.ee=Sb;tc.ee.InstanceId=Sb.SrcLocationOverrideResourceId?pa.M3a(Sb.InstanceId,Sb.SrcLocationOverrideResourceId):Sb.InstanceId;tc.gi=qb;tc.O1={};tc.O1.WebExtensionId=Sb.InstanceId;tc.bGf="osfControl_"+Sb.InstanceId;tc.f7c="disabled_"+Sb.InstanceId;tc.O1.BindingData=
Sb.BindingData;tc.v6a=tc.Rg.v6a(Sb.InstanceId);tc.Wfc=tc.Rg.Wfc(Sb.InstanceId);tc.bee=Sb.WebExtensionOsfControlType;tc.kJf=$b;return tc}function R(){}function Q(pa,qb,Sb,$b,tc,ld,Vc,Se){pa=Ib.call(this,pa,qb,Sb)||this;pa.startRow=0;pa.startColumn=0;pa.rowCount=0;pa.columnCount=0;pa.startColumn=ld-$b.Reference.FirstColumn;pa.columnCount=Se;ld=Math.max(tc,$b.Reference.FirstRow);tc=Math.min(tc+Vc-1,$b.Reference.LastRow);ld>tc?pa.startRow=pa.rowCount=void 0:(pa.startRow=ld-$b.Reference.FirstRow,pa.rowCount=
tc-ld+1);return pa}function ea(pa){var qb=this;this.YE=null;this.wwa=!1;this.kd=function(){qb.YE.forEach(function(Sb){Sb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Sb.O1b(new La.a(Sb.eventId,"",null))})};this.Rg=pa}function Z(pa,qb){this.gB=null;this.Qfa=pa;this.Qxg=qb}function ca(pa){var qb=this;this.Gi=this.sXc=null;this.xPi=function(Sb,$b){qb.handlers.xb($b.controlId)&&(Sb=new H(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,$b.controlId,null,$b.messageType,$b.messageContent,
$b.messageOrigin,$b.targetOrigin),qb.handlers.oa($b.controlId)(Sb),$b.messageType===OSF.DialogMessageType.DialogClosed&&qb.handlers.remove($b.controlId))};this.wPi=function(Sb,$b){qb.Ilc.xb($b.controlId)&&(Sb=new I(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,$b.controlId,null,$b.messageType,$b.messageContent,$b.messageOrigin,$b.targetOrigin),qb.Ilc.oa($b.controlId)(Sb))};this.handlers=new lc.a;this.Ilc=new lc.a;this.Rg=pa;this.S1a.NGg(this.xPi);this.S1a.MGg(this.wPi)}function I(pa,
qb,Sb,$b,tc,ld,Vc){pa=Va.call(this,pa,qb,Sb)||this;pa.messageType=0;pa.messageContent=null;pa.messageOrigin=null;pa.targetOrigin=null;pa.messageType=$b;pa.messageContent=tc;pa.messageOrigin=ld;pa.targetOrigin=Vc;return pa}function H(pa,qb,Sb,$b,tc,ld,Vc){pa=ub.call(this,pa,qb,Sb)||this;pa.messageType=0;pa.messageContent=null;pa.messageOrigin=null;pa.targetOrigin=null;pa.messageType=$b;pa.messageContent=tc;pa.messageOrigin=ld;pa.targetOrigin=Vc;return pa}function L(pa,qb){var Sb=ua.call(this)||this;
Sb.requests=[];Sb.h2b=!1;Sb.disposed=!1;Sb.Ng=function(){if(!Sb.disposed){Sb.grid.rc.Zn(Sb.Ng);Sb.h2b=!1;var $b=Sb.requests;Sb.requests=[];$b=Cl($b);for(var tc=$b.next();!tc.done;tc=$b.next())tc=tc.value,Sb.ddaFacade.qK(tc.command,tc.properties)}};Sb.ddaFacade=pa;Sb.grid=qb;return Sb}function U(){this.command=0;this.properties=null}function fa(pa){this.Za=new ra.a;this.zm=pa}function aa(pa,qb,Sb,$b,tc){Sb=void 0===Sb?null:Sb;$b=void 0===$b?"":$b;tc=void 0===tc?"":tc;var ld=Fa.call(this)||this;ld.controlId=
pa;ld.messageType=qb;ld.messageContent=Sb;ld.messageOrigin=$b;ld.targetOrigin=tc;return ld}function na(pa,qb,Sb,$b,tc){Sb=void 0===Sb?null:Sb;$b=void 0===$b?"":$b;tc=void 0===tc?"":tc;var ld=sa.call(this)||this;ld.controlId=pa;ld.messageType=qb;ld.messageContent=Sb;ld.messageOrigin=$b;ld.targetOrigin=tc;return ld}function ha(){this.height=this.width=0;this.Oe=this.controlId=this.pageUrl=null;this.zec=this.n7c=!1}function ka(){}function xa(){this.dialog=this.Oe=null}function va(pa,qb,Sb){var $b=Oa.call(this)||
this;$b.a$=null;$b.$Sc="WACDialogTitleText";$b.LVa="0";$b.IRb="15px";$b.ung="0px";$b.KVa="calc(100% - 30px)";$b.tng="100%";$b.Nfe=0;$b.Za=new ra.a;$b.$kg=new qa;$b.jc=5;$b.xDa=Sb;$b.Oe=Sb;$b.oIc=pa;$b.h6d=qb;$b.DIc=!!gb.AFrameworkApplication.ga&&gb.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return $b}function Aa(){}function qa(){}function wa(pa,qb){pa=Ta.call(this,1,pa,qb)||this;pa.dcf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return pa}function Ta(pa,qb,Sb){this._id=
pa;this.Ykg=qb;this.eng=Sb;this.dcf=OfficeExt.CommandInvokeMode.Default}b.r(E);var sb=b(0),db=b(7),kb=b(14),ac=b(1352),ta=b(82),ra=b(97);Ta.prototype.execute=function(pa,qb,Sb){var $b=this;Sb=Sb||{};Sb.commandMode=this.dcf;qb.invokeAppCommand(this.pIg,this.W_g,Sb,function(){pa.IPi($b.id)})};Ck.Object.defineProperties(Ta.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},pIg:{configurable:!0,enumerable:!0,get:function(){return this.Ykg}},W_g:{configurable:!0,enumerable:!0,
get:function(){return this.eng}}});Object(sb.a)(Ta,"AddinNativeActionBase",null,[139]);Am(wa,Ta);Object(sb.a)(wa,"AddinTakeSnapshotAction",Ta,[]);qa.prototype.M4g=function(pa){return new Ta(3,pa,this.uJh().getNativeActionName(3))};qa.prototype.uJh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(sb.a)(qa,"AddinNativeActionManager",null,[119]);var Na=b(149);Aa.prototype.invokeAppCommand=function(pa,qb,Sb,$b){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(pa,
qb,Sb,$b)};Aa.getInstance=function(){Aa.Ma||(Aa.Ma=new Aa);return Aa.Ma};Aa.Ma=null;Object(sb.a)(Aa,"OSFAddinCommandsRuntimeManager",null,[120]);var gb=b(4),ob=b(182),wb=b(24),Oa=Na.a;Am(va,Oa);va.prototype.FGg=function(pa){this.Za.addHandler("OnDialogClosedEventKey",pa)};va.prototype.dsj=function(){this.FEa=null};va.prototype.uD=function(){Oa.prototype.uD.call(this);this.Pp.style.width="100%";this.Pp.style.height=this.bec?this.KVa:this.tng;this.Pp.style.marginTop=this.bec?this.IRb:this.ung;this.Pp.style.padding=
this.LVa};va.prototype.UO=function(){Oa.prototype.UO.call(this);this.Nb.style.width=String.format("{0}px",this.oIc*window.innerWidth/100);this.Nb.style.height=String.format("{0}px",this.h6d*window.innerHeight/100);this.Nb.style.minWidth="0px";this.DIc&&gb.AFrameworkApplication.isRtl&&100===this.oIc&&(this.Nb.style.right="0px",this.Nb.style.marginRight="0px");this.a$=document.getElementById(this.pi(this.$Sc));this.a$.style.position="absolute";this.a$.style.whiteSpace="nowrap";this.a$.style.textOverflow=
"ellipsis";gb.AFrameworkApplication.isRtl?(this.a$.style.right="14px",this.a$.style.left="44px"):(this.a$.style.right="44px",this.a$.style.left="14px")};va.prototype.Kv=function(pa){Oa.prototype.Kv.call(this,pa);this.a$&&this.a$.setAttribute("title",pa)};va.prototype.PLd=function(){this.Nb.style.width=String.format("{0}px",this.oIc*window.innerWidth/100);this.Nb.style.height=String.format("{0}px",this.h6d*window.innerHeight/100);this.Nb.style.overflowY="hidden";this.Nb.style.overflowX="hidden";this.Nb.style.marginTop=
"";this.Nb.style.top="";wb.a.JR&&gb.AFrameworkApplication.isRtl?(this.Nb.style.right="",this.Nb.style.marginRight=""):(this.Nb.style.left="",this.Nb.style.marginLeft="")};va.prototype.hide=function(){var pa=this;this.$kg.M4g(this.xDa).execute(this,Aa.getInstance(),{});this.Nfe=window.setTimeout(function(){pa.Za.raiseEvent("OnDialogClosedEventKey",pa.xDa);ob.a.prototype.hide.call(pa)},500)};va.prototype.IPi=function(pa){3===pa&&(window.clearTimeout(this.Nfe),this.Za.raiseEvent("OnDialogClosedEventKey",
this.xDa),Oa.prototype.hide.call(this))};Ck.Object.defineProperties(va.prototype,{R1a:{configurable:!0,enumerable:!0,get:function(){return this.Pp}}});Object(sb.a)(va,"AppsForOfficeDialog",Na.a,[93,94]);Object(sb.a)(xa,"DialogInfo",null,[]);ka.url="url";ka.height="height";ka.width="width";ka.n7c="displayInIframe";ka.zec="hideTitle";Object(sb.a)(ka,"DialogSettings",null,[]);Object(sb.a)(ha,"DisplayDialogParams",null,[]);var sa=Sys.EventArgs;Am(na,sa);Object(sb.a)(na,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);var Fa=Sys.EventArgs;Am(aa,Fa);Object(sb.a)(aa,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Wa=b(41),Db=b(29),pc=b(177),lc=b(98);fa.prototype.NGg=function(pa){this.Za.addHandler("OnMessageParentEventKey",pa)};fa.prototype.MGg=function(pa){this.Za.addHandler("OnMessageDialogEventKey",pa)};fa.prototype.showDialog=function(pa,qb,Sb,$b){if(fa.Q8.xb(qb))kb.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{var tc=Wa.b(pa),ld=tc[ka.url];if(this.zm.getOsfControl(qb).checkAppDomains(ld)){var Vc=new ha;Vc.width=tc[ka.width];Vc.height=tc[ka.height];Vc.pageUrl=ld;Vc.n7c=tc[ka.n7c];Vc.zec=tc[ka.zec];Vc.controlId=qb;Vc.Oe=pc.a.create().toString();var Se=new xa;Se.Oe=Vc.Oe;var Ge=this.zm.getOsfControl(Vc.controlId).getManifest().getDefaultDisplayName(),Af=this.zm.getOsfControl(Vc.controlId).getStoreType().toLowerCase();pa=null;var jf=gb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);pa=(4===gb.AFrameworkApplication.sa.Pa.Sj&&"hardcodedpreinstall"===Af||jf&&"sdxcatalog"===Af)&&Vc.zec?this.createAndShowAppsForOfficeDialog(Vc.width,Vc.height,Vc.Oe,!0,Ge):this.createAndShowAppsForOfficeDialog(Vc.width,Vc.height,Vc.Oe,!1,Ge);var Ef=this.zm.getOsfControl(Vc.controlId),Xf=Ef.getManifest();jf={};jf.id=Vc.Oe;jf.solutionId=Ef.getSolutionId();jf.version=Ef.getVersion();jf.storeType=Af;jf.storeId=Ef.getStoreId();jf.assetId=Ef.getAssetId();jf.assetStoreId=Ef.getAssetStoreId();jf.ownerAddinSolutionId=
Ef.getOwnerAddinSolutionId();jf.ownerAddinStoreType=Ef.getOwnerAddinStoreType();jf.appDomains=Xf.getAppDomains();jf.dialogUrl=ld;jf.osfControlType=1;gb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFEntitlementPropertyCleanup",!1)||(jf.marketplaceID=Xf.getMarketplaceID(),jf.marketplaceVersion=Xf.getMarketplaceVersion(),jf.store=Ef.getStoreLocator(),jf.ownerAddinAssetId=Ef.getOwnerAddinAssetId());jf.agaveName=Ge;jf.div=pa.R1a;kb.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
gb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetPrivacyCompliantId(jf.solutionId,jf.ownerAddinStoreType||jf.storeType,jf.assetId,null,null,jf.storeId):Telemetry.PrivacyRules.GetAssetId(null!==jf.ownerAddinStoreType?jf.ownerAddinStoreType:jf.storeType,jf.storeId,jf.solutionId),Db.a.sw(Vc.pageUrl));this.zm.insertDialogControl(jf);pa.FGg(Object(ta.a)(this,this.aKi,"onDialogClosed"));Se.dialog=pa;fa.Q8.ia(Vc.controlId,
Se);$b&&$b(jf);Sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else kb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ug){kb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",ug.message),Sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};fa.prototype.jBi=function(pa,qb,Sb,$b){gb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===$b&&($b=Sb);try{var tc=this.Ava(pa);tc&&this.Za.raiseEvent("OnMessageParentEventKey",new aa(tc,OSF.DialogMessageType.DialogMessageReceived,qb,Sb,$b))}catch(ld){return kb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ld.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};fa.prototype.E1c=function(pa,qb){if(fa.Q8.xb(pa))try{var Sb=fa.Q8.oa(pa);Sb.dialog&&Sb.dialog.hide();this.zm.purgeDialogControl(Sb.Oe);
fa.Q8.remove(pa);qb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch($b){kb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",$b.message),qb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else kb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),qb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};fa.prototype.Wnj=function(pa,qb,Sb,$b){gb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===$b&&($b=Sb);if(fa.Q8.xb(pa)&&(pa=fa.Q8.oa(pa),pa.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new na(pa.Oe,OSF.DialogMessageType.DialogParentMessageReceived,qb,Sb,$b))}catch(tc){kb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",tc.message)}};fa.prototype.Ava=function(pa){for(var qb=null,Sb=Cl(fa.Q8),$b=Sb.next();!$b.done;$b=Sb.next())if($b=$b.value,$b.value.Oe===pa){qb=$b.key;break}return qb};fa.prototype.aKi=function(pa,qb){if(pa=
this.Ava(qb))this.zm.purgeDialogControl(qb),fa.Q8.remove(pa),this.Za.raiseEvent("OnMessageParentEventKey",new aa(pa,OSF.DialogMessageType.DialogClosed,null,null,"*"))};fa.prototype.createAndShowAppsForOfficeDialog=function(pa,qb,Sb,$b,tc){pa=new va(pa,qb,Sb);tc=$b?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,tc);$b&&(pa.bec=!1,pa.rv=!1);pa.initializeAndShow(tc,null,null);pa.dsj();return pa};fa.H1h=function(){return fa.Q8};fa.getInstance=function(pa){fa.Ma||(fa.Ma=new fa(pa));
return fa.Ma};fa.Ma=null;fa.Q8=new lc.a;Object(sb.a)(fa,"AppsForOfficeDialogManager",null,[34]);var eb=b(1054),ib=b(1363),cc=b(1428),Pa=b(1138),nc=b(929),pb=b(203),rb=b(1364),Ya=b(118),ec=b(85),yd=b(90),Ub=b(736),Ob=b(615),Yb=b(893),xb=b(83),Sa=b(438),Tb=b(161),Cc=b(201),Fb=b(38),hc=b(5),cd=b(1068),mb=b(1310),$a=b(76);Object(sb.a)(U,"DdaRequestInfo",null,[]);var K=b(943),ba=b(79),ua=$a.a;Am(L,ua);L.prototype.Adh=function(pa,qb){this.disposed||(this.h2b||(this.grid.rc.To(this.Ng),this.h2b=!0),this.requests.push(Object(db.a)(new U,
{command:pa,properties:qb})))};L.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.h2b&&this.grid.rc.Zn(this.Ng);var pa=this.requests;this.requests=null;pa=Cl(pa);for(var qb=pa.next();!qb.done;qb=pa.next())qb=qb.value,(qb=qb.properties?qb.properties[ba.a.g4]:null)&&this.ddaFacade.wf(K.a.Lyb,qb);this.ddaFacade=this.grid=null;ua.prototype.dispose.call(this)}};L.Z_g=function(pa,qb){var Sb=!1;974713501===pa&&(qb=(pa=qb?qb[ba.a.Ag]:null)?pa.DdaMethod:null)&&qb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(Sb=pa.ArrayData,Sb=!!Sb&&64===(Sb[6]&64));return Sb};Object(sb.a)(L,"DdaCellEditDelayRequestHandler",$a.a,[]);var La=b(975),ub=La.a;Am(H,ub);Object(sb.a)(H,"DialogMessageReceivedEventArgs",La.a,[]);var Va=La.a;Am(I,Va);Object(sb.a)(I,"DialogParentMessageReceivedEventArgs",La.a,[]);var tb=b(1),Cb=b(21);ca.prototype.addHandler=function(pa,qb,Sb,$b){var tc=this;if(tb.EwaSettings.ma(24))this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sb);else{kb.ULS.sendTraceTag(537170502,0,
50,"DialogMessageReceivedEventManager.AddHandler called!");var ld=function(Vc){Vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(tc.handlers.ia(pa,qb),tc.Rg.mv(Sb)):(kb.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),tc.Rg.wf(Vc,Sb))};this.handlers.xb(pa)?ld(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(pa,$b,ld)}};ca.prototype.mCg=function(pa,qb,Sb){tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Sb):(kb.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Ilc.ia(pa,qb),this.Rg.mv(Sb))};ca.prototype.removeHandler=function(pa,qb){var Sb=this;tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,qb):this.handlers.xb(pa)?(kb.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.S1a.E1c(pa,function($b){Sb.handlers.remove(pa);$b===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
Sb.Rg.mv(qb):(kb.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),Sb.Rg.wf($b,qb))})):this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,qb)};ca.prototype.Caj=function(pa,qb){tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,qb):(kb.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Ilc.remove(pa),this.Rg.mv(qb))};ca.prototype.showDialog=function(pa,qb,Sb){var $b=
this;try{tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Cb.g(this.Rg.$).isEditing&&Cb.g(this.Rg.$).Kp(!0),this.S1a.showDialog(qb,pa,Sb,function(tc){$b.Rg.DCg($b.LSg(tc))})}catch(tc){kb.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",tc.message),Sb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};ca.prototype.LSg=function(pa){var qb={};qb.InstanceId=pa.id;qb.WebExtensionType=pa.osfControlType===
OSF.OsfControlTarget.InContent?0:1;qb.PrimaryMarketplace={};qb.PrimaryMarketplace.SolutionId=pa.solutionId;qb.PrimaryMarketplace.SolutionVersion=pa.version;qb.PrimaryMarketplace.MarketplaceRef=pa.storeId;qb.PrimaryMarketplace.MarketplaceType=pa.storeType;return qb};ca.ka=function(pa){if(!pa.$.da.Aa(232)){var qb=new ca(pa);pa.$.da.Ga(232,qb)}};Ck.Object.defineProperties(ca.prototype,{S1a:{configurable:!0,enumerable:!0,get:function(){this.sXc||(this.sXc=fa.getInstance(this.contextActivationMgr));return this.sXc}},
contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Gi&&this.Rg&&(this.Gi=this.Rg.Gi);return this.Gi}}});Object(sb.a)(ca,"DialogMessageReceivedEventManager",null,[843]);Z.prototype.PZb=function(pa){pa&&(this.gB||(this.gB=[]),this.gB.push(pa))};Z.prototype.otc=function(pa){this.gB&&Array.remove(this.gB,pa)};Z.prototype.Izi=function(pa){return this.eventId!==pa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?
this.targetId===pa.ddaBinding.Name:!0};Z.prototype.O1b=function(pa){this.gB&&Array.forEach(this.gB,function(qb){qb(pa)})};Z.prototype.fna=function(){this.gB=[]};Ck.Object.defineProperties(Z.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Qfa}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Qxg}},w6h:{configurable:!0,enumerable:!0,get:function(){return 0<this.gB.length}}});Object(sb.a)(Z,"DdaEventRegistration",null,[]);ea.prototype.invokeDdaMethod=function(pa,
qb){var Sb={};Sb[ba.a.Ag]=pa;Sb[ba.a.g4]=qb;this.Rg.qK(974713501,Sb)};ea.prototype.registerDdaEventAsync=function(pa,qb,Sb,$b,tc){ea.uzb(pa)?(ea.Jod(pa)&&this.dld(),this.YE||(this.YE=[]),qb=this.qub(pa,Sb),qb||(qb=new Z(pa,Sb),this.YE.push(qb)),qb.PZb($b),this.Rg.mv(tc)):this.Rg.wf(-1,tc)};ea.prototype.unregisterDdaEventAsync=function(pa,qb,Sb,$b,tc){ea.uzb(pa)?((pa=this.qub(pa,Sb))&&pa.otc($b),this.Rg.mv(tc)):this.Rg.wf(-1,tc)};ea.prototype.dld=function(){this.wwa||(Cb.g(this.Rg.$).ha.sE(this.kd),
this.wwa=!0)};ea.prototype.qub=function(pa,qb){if(!this.YE)return null;for(var Sb=0;Sb<this.YE.length;Sb++){var $b=this.YE[Sb];if($b.eventId===pa&&$b.targetId===qb)return $b}return null};ea.uzb=function(pa){return pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};ea.Jod=function(pa){return pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(sb.a)(ea,"EmbeddingPage",null,[800]);var nb=b(206),Ib=La.a;Am(Q,Ib);Q.prototype.getStartRow=function(){return this.startRow};Q.prototype.getStartColumn=
function(){return this.startColumn};Q.prototype.getRowCount=function(){return this.rowCount};Q.prototype.getColumnCount=function(){return this.columnCount};Object(sb.a)(Q,"DdaBindingSelectionEventArgs",La.a,[]);var hb=b(202),zb=b(25),Gc=b(45),Fc=b(51),Ed=b(439),Jc=b(37),Ca=b(36),bb=b(628),dc=b(110),Ac=b(54),nd=b(95),qd=b(12),Gb=b(10),Oc=b(104);R.auh="ewa-wx-disabled-div";R.$th="ewa-wx-container-div";R.fPe="ewa-ptp-nov2-flex";Object(sb.a)(R,"CssClassNames",null,[]);var he=R.auh,Wd=R.$th,rc=nb.a;Am(T,
rc);T.prototype.hci=function(pa){this.Xda||(this.Xda=pa)};T.prototype.nQf=function(){this.Xda&&(this.Xda.dispose(),this.Xda=null)};T.prototype.vmd=function(){var pa=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.ee.PrimaryMarketplace.MarketplaceType)&&tb.EwaSettings.ma(187)){var qb=Fc.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Ca.TaskExtensions.Ba(qb,function(){qb.result.eg(35,null)},this.la,3);return this}if(1===this.ee.WebExtensionType)Ca.TaskExtensions.Ba(Ed.a(this.$),function(tc){tc.result.Jrb(pa.$.da,
77,6,pa.Juf,1)},this.la,3);else{var Sb=this.mUe(),$b=Oc.a(this.$);Sb||(Sb={Type:3},Sb.Id=this.O1.WebExtensionId,Sb.WebExtensionData=this.ee,Sb.ContentHtml="<div/>",Sb.Version=0,Sb.AbsoluteLeft=0,Sb.AbsoluteTop=0,Sb.AbsoluteRight=0,Sb.AbsoluteBottom=0,Sb.Width=0,Sb.Height=0,Sb.ZOrder=0,Sb.OriginDeltaX=0,Sb.OriginDeltaY=0,Sb=new hb.a(Sb),$b.H4b(Sb,null),Sb=$b.Iq(Sb.Tg()));Sb?(this.Twc(Sb.Qd.firstChild),this.Fha=Object(xb.a)(584,Sb)):$b.FZb(this.onFloatingObjectControlAdded)}return this};T.prototype.saf=
function(pa){this.Twc(pa);return this};T.prototype.snc=function(){this.kJf||this.Rg.Gi.purgeOsfControl(this.controlId,!1);this.Vbg(!0);var pa=this.mUe();pa&&Oc.a(this.$).deleteFloatingObject(pa);this.Rg.ij.laj(this.controlId);this.Rg.ij.ZLe(this.controlId,!0);this.YOc=null};T.prototype.YBd=function(pa){this.O1=pa};T.prototype.invokeDdaMethod=function(pa,qb){if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Sb={};Sb[ba.a.Ag]=pa;Sb[ba.a.g4]=qb;this.Rg.qK(974713501,
Sb)}else this.Rg.wf(K.a.Lyb,qb)};T.prototype.J8i=function(pa,qb,Sb,$b){if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!T.gih(pa)||void 0!==qb&&null!==qb&&void 0!==this.i3a(qb)&&null!==this.i3a(qb))if(kb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",pa,qb),T.Gdf(pa)&&this.l8h(),T.Jod(pa)&&this.dld(),T.Edf(pa))tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$b):this.Rg.$.da.Aa(232).addHandler(this.controlId,
Sb,$b,qb);else if(T.Fdf(pa))tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$b):this.Rg.$.da.Aa(232).mCg(this.controlId,Sb,$b);else{T.Ddf(pa)&&this.t6e(-1777565636,$b);this.YE||(this.YE=[]);var tc=this.qub(pa,qb);tc||(tc=new Z(pa,qb),this.YE.push(tc));tc.fna();tc.PZb(Sb);this.Rg.mv($b);pa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.VVa&&(this.a6b=Sb)}else this.Rg.wf(3002,$b);else this.Rg.wf(-1,$b)};T.prototype.PPj=function(pa,qb,Sb,$b){T.Edf(pa)?
tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$b):this.Rg.$.da.Aa(232).removeHandler(this.controlId,$b):T.Fdf(pa)?tb.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$b):this.Rg.$.da.Aa(232).Caj(this.controlId,$b):(T.Ddf(pa)&&this.t6e(1592314317,$b),qb=this.qub(pa,qb),this.enabled?(qb&&(qb.otc(Sb),qb.w6h||Array.remove(this.YE,qb),this.YE.length?T.Gdf(pa)&&this.Wbg(!1):this.Vbg(!1)),this.Rg.mv($b)):this.Rg.wf(-1,
$b))};T.prototype.ka=function(pa){qd.DOMElementExtensions.getElementById(pa,this.bGf)||pa.appendChild(qd.DOMElementExtensions.Af(this.Gy))};T.prototype.showHide=function(pa){qd.DOMElementExtensions.setVisible(this.Gy,pa)};T.prototype.resize=function(pa,qb){qd.DOMElementExtensions.Jr(this.Gy,pa);qd.DOMElementExtensions.bJ(this.Gy,qb)};T.prototype.XIe=function(pa){if(!this.qV&&!qd.DOMElementExtensions.getElementById(this.Gy,this.f7c)&&this.Gy){var qb=document.createElement("div");qb.id=this.f7c;qb.className=
he;qb.style.backgroundImage="url("+Ac.a.current.np(81)+")";qb.style.opacity=pa?"1":"0";qb.style.backgroundRepeat="no-repeat";qb.style.backgroundPosition="center";this.Gy.insertBefore(qb,this.Gy.firstChild)}this.qV++};T.prototype.Zkh=function(){0<this.qV&&this.qV--;this.qV||(qd.DOMElementExtensions.Af(qd.DOMElementExtensions.getElementById(this.Gy,this.f7c)),this.wwa&&!Gc.Q(this.Yqc,Cb.g(this.$).ha.ta.selectedRanges)&&this.kd(null,null))};T.prototype.i3a=function(pa){if(!this.O1||!this.O1.BindingData)return null;
for(var qb=0;qb<this.O1.BindingData.length;qb++)if(this.O1.BindingData[qb].Name===pa)return this.O1.BindingData[qb];return null};T.prototype.getDefaultIconUrl=function(){var pa=this.W1e();return pa?pa.getDefaultIconUrl():null};T.prototype.getDefaultDisplayName=function(){if(this.ee.TaskpaneTitle)return this.ee.TaskpaneTitle;var pa=this.W1e();return pa?pa.getDefaultDisplayName():null};T.prototype.nKf=function(){if(this.VVa&&this.a6b){var pa=new La.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,
null,this.VVa);this.a6b(pa);this.a6b=this.VVa=null}};T.prototype.jg=function(pa){this.p0d&&this.p0d.jg(pa)};T.prototype.aqj=function(){var pa=this;this.$.ea.isNamedObjectViewMode&&this.Yli()&&(this.$.da.Aa(34).$pj(this.Gy),this.showHide(!1));if(this.Rg.BXj){if(!this.kJf){var qb={};qb.div=this.Gy;qb.id=this.ee.InstanceId;qb.solutionId=this.ee.PrimaryMarketplace.SolutionId;qb.version=this.ee.PrimaryMarketplace.SolutionVersion;qb.storeId=this.ee.PrimaryMarketplace.MarketplaceRef;qb.storeType=this.ee.PrimaryMarketplace.MarketplaceType;
qb.ownerAddinSolutionId=this.ee.OwnerAddinSolutionId;qb.ownerAddinStoreType=this.ee.OwnerAddinStoreType;this.ee.AssetMarketplace&&(qb.assetId=this.ee.AssetMarketplace.SolutionId,qb.assetStoreId=this.ee.AssetMarketplace.MarketplaceRef);qb.settings=this.ee.OsfPropertyBag;tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?qb.reason=this.v6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Wfc?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.ControlActivation:qb.reason=this.v6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;qb.osfControlType=0===this.ee.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;qb.isForUILessAction=4===this.ee.WebExtensionOsfControlType;qb.sourceLocationOverrideResourceId=this.ee.SrcLocationOverrideResourceId;qb.focusOnIframeWhenLoaded=this.ee.FocusOnIframeWhenLoaded;
bb.a(this.ee)&&(qb.featureGates=gb.AFrameworkApplication.ga.qQh(qb.solutionId));qb.hostInfoFlags=0;this.xIa&&(qb.hostInfoFlags|=2);Gb.HelperMethods.Mw(this.ee)&&(qb.hostInfoFlags|=1);this.$.Cha||(kb.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),qb.hostInfoFlags|=4);tb.EwaSettings.ma(644)&&(qb.hostInfoFlags|=8);tb.EwaSettings.ma(54)&&tb.EwaSettings.ma(94)&&!this.THc&&(qb.virtualOsfControlActivationCallback=function(){pa.Rg.bDd(pa.ee)});qb.sharedRuntimeId=this.ee.SharedRuntime?
this.ee.SharedRuntime.Resid:this.ee.SharedRuntimeId;!Gb.HelperMethods.Mw(this.ee)||this.ee.Preload||bb.a(this.ee)||this.Rg.Gi.getOsfControl(b(946).DdaFacade.getSolutionId(this.ee,this.$))||(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Rg.bDd(this.ee):this.Rg.bDd(this.ee));qb.initialDisplayMode=this.ee.TaskpaneVisible?2:1;tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(qb.titleOverride=this.nl.TaskpaneTitle);
this.Rg.Gi.insertOsfControl(qb)}this.qV=0}else this.XIe(!0)};T.prototype.Vbg=function(pa){this.Wbg(pa);this.wPj()};T.prototype.l8h=function(){this.Zcb||this.gi.PZb(this.r6e);this.Zcb++};T.prototype.Wbg=function(pa){0<this.Zcb&&(pa?this.Zcb=0:this.Zcb--,this.Zcb||this.gi.otc(this.r6e))};T.prototype.dld=function(){if(!this.wwa){var pa=Cb.g(this.$).ha;this.Yqc=Gc.d(Cb.g(this.$).ha.ta.selectedRanges);pa.sE(this.kd);this.wwa=!0}};T.prototype.wPj=function(){this.wwa&&(Cb.g(this.$).ha.xI(this.kd),this.wwa=
!1)};T.prototype.Xmj=function(pa){var qb=new zb.Range(pa.Reference.FirstRow+1,pa.Reference.FirstColumn+1,pa.Reference.LastRow+1,pa.Reference.LastColumn+1,!1,!1);1===pa.BindingType&&(pa.HasHeaders&&--qb.top,pa.HasTotals&&(qb.bottom+=1));var Sb=Cb.g(this.$).ha.ta.selectedRanges;pa=qb.Kyb(this.Yqc);Sb=qb.Kyb(Sb);return(qb=qb.Te(Cb.g(this.$).ha.ta.activeRange))&&(dc.e(pa)&&!dc.e(Sb)||!dc.e(pa)&&!dc.e(Sb)&&!Gc.Q(pa,Sb))?qb:null};T.prototype.foj=function(){var pa=this;Array.forEach(this.YE,function(qb){if(qb.eventId!==
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&qb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa.Rg.ij.g0b(pa.controlId))if(qb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)qb.O1b(new La.a(qb.eventId,pa.controlId,null));else if(qb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Sb=pa.i3a(qb.targetId);if((null===Sb||void 0===Sb?0:Sb.IsValidRef)&&(pa.$.ea.isNamedObjectViewMode?pa.$.Hb.qa.sheetName:pa.$.xa.qa.name)===Sb.Reference.SheetName){var $b=
pa.Xmj(Sb);$b&&qb.O1b(new Q(qb.eventId,pa.controlId,pa.Rg.V0b(Sb),Sb,$b.top-1,$b.left-1,$b.height,$b.width))}}})};T.prototype.qub=function(pa,qb){if(!this.YE)return null;for(var Sb=0;Sb<this.YE.length;Sb++){var $b=this.YE[Sb];if($b.eventId===pa&&$b.targetId===qb)return $b}return null};T.prototype.mUe=function(){for(var pa=Oc.a(this.$).dR,qb=pa.length-1;0<=qb;--qb){var Sb=pa[qb];if(3===Sb.floatingObject.type&&Sb.floatingObject.nl.InstanceId===this.O1.WebExtensionId)return Sb}return null};T.prototype.Yli=
function(){for(var pa=0;pa<this.$.Hb.count;pa++)if(this.$.Hb.getItem(pa).VLa===this.O1.WebExtensionId)return!0;return!1};T.prototype.Twc=function(pa){this.YOc=pa;this.Gy.id=this.bGf;this.Gy.className=Wd;this.Gy.dir=this.$.isChromeRtl?"rtl":"ltr";this.aqj()};T.prototype.W1e=function(){if(!this.enabled)return null;var pa=bb.a(this.nl)?"":this.nl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.nl.PrimaryMarketplace.SolutionId,pa)};T.prototype.t6e=function(pa,qb){if(tb.EwaSettings.ma(24))this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
qb);else try{if(kb.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.bee)this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,qb);else{var Sb={};Sb[nc.a.kob]=this.controlId;var $b=new nd.a(pa,0,this.$.isEditMode?2:1,0,null);this.$.Ka.$b($b,Sb);this.Rg.mv(qb)}}catch(tc){kb.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",tc.message),this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
qb)}};T.gih=function(pa){return pa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};T.Gdf=function(pa){return pa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||pa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||pa===OSF.DDA.EventDispId.dispidRichApiMessageEvent};T.Jod=function(pa){return pa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};T.Edf=function(pa){return pa===
OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};T.Fdf=function(pa){return pa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};T.Ddf=function(pa){return pa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Ck.Object.defineProperties(T.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.ee.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.ee.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,
get:function(){return this.ee.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.qV}},Gy:{configurable:!0,enumerable:!0,get:function(){return this.YOc}},cV:{configurable:!0,enumerable:!0,get:function(){return this.ee.SrcLocationOverrideResourceId?this.Rg.M3a(this.ee.PrimaryMarketplace.SolutionId,this.ee.SrcLocationOverrideResourceId):this.ee.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,
enumerable:!0,get:function(){return this.ee.SrcLocationOverrideResourceId}},nl:{configurable:!0,enumerable:!0,get:function(){return this.ee}},Fha:{configurable:!0,enumerable:!0,get:function(){return this.f3d},set:function(pa){this.f3d=pa}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.bee}},xIa:{configurable:!0,enumerable:!0,get:function(){return this.THc},set:function(pa){this.THc=pa}},D5c:{configurable:!0,enumerable:!0,get:function(){return this.VVa},set:function(pa){this.VVa=
pa}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.ee.FocusOnIframeWhenLoaded}},zqd:{configurable:!0,enumerable:!0,get:function(){return this.P$d},set:function(pa){this.P$d=pa}}});Object(sb.a)(T,"OsfControl",nb.a,[842]);M.prototype.add=function(pa){this.tZa[pa]=!0};M.prototype.remove=function(pa){delete this.tZa[pa]};M.prototype.clear=function(){for(var pa=Cl(Object.keys(this.tZa)),qb=pa.next();!qb.done;qb=pa.next())delete this.tZa[qb.value]};M.prototype.H7e=function(){return 0<
Object.keys(this.tZa).length};M.prototype.tJh=function(){return Object.keys(this.tZa)};Object(sb.a)(M,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var gd=b(56);A.prototype.bpb=function(pa){51===pa.messageType?this.gPf=this.NGa(pa.actionType,this.gPf,this.gIi):52===pa.messageType&&(this.hPf=this.NGa(pa.actionType,this.hPf,this.hIi))};A.prototype.NGa=function(pa,qb,Sb){if(1===pa)qb||Cb.g(this.$).ha.Oa.MVc(Sb),qb++,this.Itj();else if(2===pa){if(1>qb)return qb;1===qb&&Cb.g(this.$).ha.Oa.cKd(Sb);
qb--}return qb};A.prototype.tja=function(pa,qb,Sb){qb&&this.ij.C_(pa,qb)&&this.gi.WM(pa,qb,Sb)};A.prototype.Sac=function(pa){return pa&&pa.floatingObject?(pa=pa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===pa.length?pa[0]:null:null};A.prototype.Oja=function(){var pa=this.$.xa.qa;return pa&&0===pa.MI?pa.sheetId:null};A.prototype.Itj=function(){var pa=Cb.g(this.$).ha.Oa.IC;this.tod(pa)&&(this.Iab=this.Sac(pa),this.mLb=this.Oja())};A.prototype.tod=function(pa){return!!pa&&
!!pa.floatingObject&&0===pa.floatingObject.type};Object(sb.a)(A,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var kd=b(951),Qc=b(197),de=b(707),Xe=b(99),ge=b(359),fc=b(55),dd=$a.a;Am(C,dd);C.prototype.E0b=function(pa){Object(xb.a)(ge.a,this.$.xa);1===pa.actionType?(this.fAa||this.grid.ha.sE(this.kd),this.fAa++):2!==pa.actionType||1>this.fAa||(1===this.fAa&&this.grid.ha.xI(this.kd),this.fAa--)};C.prototype.Bwc=function(pa){pa?this.qV++:(0<this.qV&&this.qV--,this.qV||this.kd(null,new de.a(!1)))};
C.prototype.vZe=function(){return this.grid.ha.ta.selectedRanges};C.prototype.Jse=function(pa,qb){return tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!pa&&Qc.e(this.HNa)||pa in this.HNa)&&!Gc.Q(this.HNa[pa],qb):pa in this.HNa&&!Gc.Q(this.HNa[pa],qb)};C.prototype.XJe=function(pa,qb,Sb){this.HNa[pa]=Gc.d(qb);this.Fjc[pa]=Sb};C.prototype.nff=function(){return this.grid.isEditing||this.grid.Ni};C.prototype.OUe=function(pa,qb){this.ij.C_(14,
pa)&&this.gi.WM(14,pa,qb);this.ij.C_(14,kd.a.BX)&&this.gi.WM(14,kd.a.BX,qb)};C.prototype.X5h=function(pa,qb){var Sb={};Sb.worksheetId=pa;Sb.address=this.$gd(qb);qb=gd.a.Lc(Sb);this.OUe(pa,qb)};C.prototype.J5h=function(pa,qb,Sb,$b){if(this.ij.tif()){var tc="",ld="";$b&&(tc=$b.jj);Sb&&(ld=Sb.jj);$b?Sb?(qb=Sb.usedRange.Kyb(qb),tc!==ld&&this.w$b(tc,"",pa),this.w$b(ld,this.$gd(qb),pa)):this.w$b(tc,"",pa):Sb&&(tc=Sb.usedRange.Kyb(qb),this.w$b(ld,this.$gd(tc),pa))}};C.prototype.w$b=function(pa,qb,Sb){if(this.ij.C_(100,
pa)){var $b={};$b.address=qb;$b.worksheetId=Sb;this.gi.WM(100,pa,gd.a.Lc($b))}};C.prototype.$gd=function(pa){return Gc.i(pa,",",this.$,!1)};C.prototype.dispose=function(){0<this.fAa&&this.grid.ha.xI(this.kd);this.Fjc=this.HNa=null;this.fAa=0;this.gi=this.ij=this.$=this.grid=null};Ck.Object.defineProperties(C.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.qV&&0<this.fAa}}});Object(sb.a)(C,"RichApiEventSelectionChangedHandler",$a.a,[]);var oc=b(354);Am(v,C);v.prototype.vZe=
function(){return oc.a.Trb(this.grid.ha.rangePicker.fL)};v.prototype.Jse=function(pa,qb){return this.qkf!==pa||!Gc.Q(this.pkf,qb)};v.prototype.XJe=function(pa,qb){this.qkf=pa;this.pkf=Gc.d(qb)};v.prototype.nff=function(){return!this.grid.isEditing&&!this.grid.Ni};v.prototype.OUe=function(pa,qb){this.ij.C_(2700,kd.a.BX)&&this.gi.WM(2700,kd.a.BX,qb)};Object(sb.a)(v,"RichApiEventPickedRangesChangedHandler",C,[]);B.prototype.bpb=function(pa){var qb=Cb.g(this.$).ha;1===pa.actionType?(this.GQa||this.HQa||
qb.Oa.MVc(this.iyf),2101===pa.messageType?this.GQa++:2102===pa.messageType&&this.HQa++):2===pa.actionType&&(2101===pa.messageType?this.GQa=0<this.GQa?this.GQa-1:0:2102===pa.messageType&&(this.HQa=0<this.HQa?this.HQa-1:0),this.GQa||this.HQa||qb.Oa.cKd(this.iyf))};B.prototype.Fni=function(pa){return!!pa&&!!pa.floatingObject&&(0===pa.floatingObject.type||7===pa.floatingObject.type||1===pa.floatingObject.type||3===pa.floatingObject.type||5===pa.floatingObject.type)};B.prototype.bOj=function(pa){if(!pa||
!pa.floatingObject)return null;pa=pa.floatingObject.id;var qb=pa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));qb=qb&&1===qb.length?qb[0]:null;return qb?qb:(kb.ULS.sendTraceTag(537170457,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",pa),null)};B.prototype.Oja=function(){var pa=this.$.xa.qa;return pa&&0===pa.MI?pa.sheetId:null};B.prototype.fireEvent=function(pa,qb,Sb){qb&&this.ij.C_(pa,qb)&&this.gi.WM(pa,qb,Sb)};Object(sb.a)(B,"RichApiEventShapeActivatedDeactivatedHandler",
null,[]);u.prototype.bpb=function(pa){11===pa.messageType?pa.targetId===kd.a.BX?this.QMg(pa.actionType):this.PMg(pa.actionType):12===pa.messageType&&(pa.targetId===kd.a.BX?this.RMg(pa.actionType):this.SMg(pa.actionType))};u.prototype.PMg=function(pa){this.jPf=this.NGa(pa,this.jPf,this.qVi)};u.prototype.SMg=function(pa){this.mPf=this.NGa(pa,this.mPf,this.tVi)};u.prototype.QMg=function(pa){this.kPf=this.NGa(pa,this.kPf,this.rVi)};u.prototype.RMg=function(pa){this.lPf=this.NGa(pa,this.lPf,this.sVi)};
u.prototype.NGa=function(pa,qb,Sb){1===pa?qb=this.dYc(qb,Sb):2===pa&&(qb=this.R6c(qb,Sb));return qb};u.prototype.dYc=function(pa,qb){pa||this.$.xa.zg(qb);pa++;return pa};u.prototype.R6c=function(pa,qb){if(1>pa)return pa;1===pa&&this.$.xa.Vg(qb);pa--;return pa};u.prototype.Z7a=function(pa){return!!pa&&0===pa.MI};u.prototype.tja=function(pa,qb,Sb,$b){qb=(void 0===$b?0:$b)?kd.a.BX:qb;this.ij.C_(pa,qb)&&this.gi.WM(pa,qb,Sb)};Object(sb.a)(u,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Zb=
b(179),Sc=b(13),sd=b(228),fd=Sys.EventArgs;Am(t,fd);Object(sb.a)(t,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);x.prototype.dispose=function(){this.jQj()};x.prototype.f$i=function(){for(var pa=Cl(this.gridView.An),qb=pa.next();!qb.done;qb=pa.next())qb=qb.value.domElement,Zb.a.instance.pa(Sc.a.pointerDown,qb,this.onPointerDown),sd.a.instance.pa(Sc.a.click,qb,this.vd)};x.prototype.jQj=function(){for(var pa=Cl(this.gridView.An),qb=pa.next();!qb.done;qb=pa.next())qb=qb.value.domElement,Zb.a.instance.za(Sc.a.pointerDown,
qb,this.onPointerDown),sd.a.instance.za(Sc.a.click,qb,this.vd)};x.prototype.uVi=function(pa){var qb=pa.sheet;if(this.Z7a(qb)){var Sb={};Sb.worksheetId=qb.sheetId;Sb.address=pa.gWg.toString();Sb.offsetX=pa.offsetX;Sb.offsetY=pa.offsetY;pa=qb.sheetId;this.ij.C_(21,pa)&&(qb=gd.a.Lc(Sb),this.gi.WM(21,pa,qb));pa=kd.a.BX;this.ij.C_(21,pa)&&(Sb=gd.a.Lc(Sb),this.gi.WM(21,pa,Sb))}};x.prototype.Z7a=function(pa){return!!pa&&0===pa.MI};Object(sb.a)(x,"RichApiEventSingleClickedHandler",null,[]);r.prototype.E0b=
function(pa){2E3===pa.messageType&&(1===pa.actionType?(this.OHb||Cb.g(this.$).ha.Oa.MVc(this.iFf),this.OHb++,this.hqj()):2===pa.actionType&&this.OHb&&(1===this.OHb&&Cb.g(this.$).ha.Oa.cKd(this.iFf),this.OHb--))};r.prototype.Dbd=function(pa){var qb,Sb={};Sb.worksheetId=pa;Sb.revisionLoad=!1;if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(tb.EwaSettings.ma(727)||tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",
!1))){var $b=Cb.g(this.$).ha.Oa.IC;(null===(qb=null===$b||void 0===$b?void 0:$b.floatingObject)||void 0===qb?0:qb.dd)?Sb.selectedVisualId=$b.floatingObject.dd.VisualID:Sb.selectedVisualId=null}qb=gd.a.Lc(Sb);pa&&this.ij.C_(2E3,pa)&&this.gi.WM(2E3,pa,qb)};r.prototype.Oja=function(){var pa=this.$.xa.qa;return pa&&0===pa.MI?pa.sheetId:null};r.prototype.hqj=function(){var pa=Cb.g(this.$).ha.Oa.IC;this.cjf(pa)&&(this.Fab=pa.floatingObject.id,this.yab=this.Oja())};r.prototype.cjf=function(pa){return!!pa&&
pa.Bsd()};Object(sb.a)(r,"RichApiEventVisualSelectionChangedHandler",null,[]);y.prototype.OMg=function(pa){1===pa.actionType?(this.PHb||this.hNg(),this.PHb++):2!==pa.actionType||1>this.PHb||(1===this.PHb&&this.Ieh(),this.PHb--)};y.prototype.hNg=function(){if(this.ij.C_(2203,kd.a.BX))if(this.ird){var pa={};pa.timeout=this.$.ya.CheckFocusTimeout;this.N$b=window.requestIdleCallback(this.aze,pa)}else this.N$b=window.setInterval(this.$ye,this.$.ya.CheckFocusTimeInterval)};y.prototype.Ieh=function(){this.ird?
window.cancelIdleCallback(this.N$b):window.clearInterval(this.N$b)};Object(sb.a)(y,"RichApiEventWorkbookActivatedHandler",null,[]);var qc;(function(pa){pa[pa.none=0]="none";pa[pa.registerEvent=1]="registerEvent";pa[pa.unregisterEvent=2]="unregisterEvent";pa[pa.customFunction=3]="customFunction";pa[pa.showCard=4]="showCard";pa[pa.createWorkbook=5]="createWorkbook";pa[pa.openWorkbook=6]="openWorkbook";pa[pa.enableEvents=7]="enableEvents";pa[pa.closeWorkbook=8]="closeWorkbook";pa[pa.setCalculationMode=
9]="setCalculationMode";pa[pa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";pa[pa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";pa[pa.workbookLinksEnableContent=12]="workbookLinksEnableContent";pa[pa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";pa[pa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";pa[pa.rangePicker=15]="rangePicker";pa[pa.enableRichApiRecording=16]="enableRichApiRecording";pa[pa.recordAction=17]="recordAction";pa[pa.focus=
18]="focus";pa[pa.businessBarShow=19]="businessBarShow";pa[pa.businessBarHide=20]="businessBarHide"})(qc||(qc={}));Object(sb.b)("PostProcessActionType",qc);var vb=b(244);h.prototype.NMg=function(pa){1===pa.actionType?(this.$.Uba=!0,Object(xb.a)(b(946).DdaFacade,vb.a(this.$)).Cbd(!0)):2===pa.actionType&&(this.$.Uba=!1);this.cGf=pa.controlId;kb.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",qc[pa.actionType],
this.cGf,this.$.Uba)};h.prototype.jmh=function(pa){Object(xb.a)(b(946).DdaFacade,vb.a(this.$)).RUe(pa,this.$.Uba)};h.prototype.Kbi=function(){var pa=this;this.$.Yba&&Ca.TaskExtensions.Ba(Fc.GetServiceTaskFactory.Ua(this.$.da,297,298,1),function(qb){(qb=qb.result)&&qb.init(pa.Bbd)},this.$.la,3)};Object(sb.a)(h,"RichApiMacroRecorderEventHandler",null,[]);Object(sb.a)(w,"SessionRecreationInfo",null,[]);n.prototype.DDi=function(){return tb.EwaSettings.ma(260)?this.ij.F6h()||0!==this.runtimeCalculationMode:
!1};n.prototype.WRg=function(){var pa={};pa.eventRegistrationInfos=this.ij.EPh();pa.runtimeCalculationMode=this.runtimeCalculationMode;pa=Object(db.a)(new w,{runtimeState:pa});var qb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};qb.RequestBody=JSON.stringify(pa);qb.RequestFlags=1;return qb};Object(sb.a)(n,"RichApiRuntimeStateHandler",null,[]);Object(sb.a)(m,"UserOperationQueueItemsStatisticsData",null,[]);var Pd=b(342),Tc=b(31),Ve=b(19),kf=b(307),of=b(48),vf=b(656),ne=
b(63),Ad=b(59),Xd=b(72),ee=Pd.a;Am(f,ee);f.prototype.dispose=function(){this.$&&(this.$.xa.lL(this.Go),this.$.Hb.lL(this.Go),this.$.Hb.Vg(this.He),this.$.xa.Vg(this.He));this.MUa&&(this.MUa.Wq(this.zf),this.MUa.wI(this.Tm),this.MUa.Fv(this.Qi));tb.EwaSettings.qc()&&this.gx(this.Nya);this.clearCache();yd.a.Ha(this.MUa);this.MUa=null;qd.DOMElementExtensions.Af(this.domElement);ee.prototype.dispose.call(this)};f.prototype.$pj=function(pa){qd.DOMElementExtensions.Af(qd.DOMElementExtensions.getElementById(this.domElement,
pa.id));this.domElement.appendChild(pa)};f.prototype.Kmd=function(){if(this.awa&&!this.c4b){var pa=Object(xb.a)(b(946).DdaFacade,vb.a(this.$)).pn(this.awa.InstanceId);pa&&(pa.resize(this.awa.Width,this.awa.Height),pa.ka(this.domElement),pa.showHide(!0),this.c4b=!0)}};f.prototype.a8a=function(){return!0};f.prototype.Tna=function(pa){this.awa=pa.nd.block.ze;this.c4b=!1;this.Kmd()};f.prototype.eUa=function(pa){this.$.ea.A_&&pa&&(pa.Lu||(pa.Lu=new kf.a),pa.Lu.Pg=new of.a(this.domElement.scrollLeft,this.domElement.scrollTop),
pa.Lu.DGb=20)};f.prototype.clearCache=function(){this.Ea.LQa(this.hashCode);this.awa=this.hashCode=null;this.c4b=!1};f.prototype.gTa=function(pa,qb){if(this.isVisible=!!pa&&ne.o(pa))this.hashCode=this.Ea.esa(pa,Ad.a.n6b,this.hashCode),this.hxc(qb)};f.OGa=function(pa){if(!pa.da.Aa(34)){var qb=pa.Mf;pa.da.Ga(34,new f(pa,new vf.a(pa,pa.ea,pa.na.Kk,3,0),qb.appendChild(qb.ownerDocument.createElement("div"))))}};Ck.Object.defineProperties(f.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.MUa}}});
Object(sb.a)(f,"WebExtensionView",Pd.a,[830,437,2]);var Le=b(229),Jf=b(561),$f=b(387),Dc=b(466),Sd=b(175),te=b(84),rd=b(119),Ue=b(47),ef=b(44),pe=b(157),Ne=b(111),gg=b(69),ie=b(28),Re=b(30),Ig=b(293),Lf=b(22),qf=b(15),vg=b(292),jc=b(950),zc=b(49),Md=b(152),Ce=b(1183),ae=b(204),ud=b(1078),Rb=b(27);b.d(E,"DdaFacade",function(){return a});var Ie=Fb.a;Am(a,Ie);a.prototype.eoe=function(pa){this.addHandler("cd",pa)};a.prototype.Jbj=function(pa){this.removeHandler("cd",pa)};a.prototype.cFg=function(pa){this.addHandler("csc",
pa)};a.prototype.Lbj=function(pa){this.removeHandler("csc",pa)};a.prototype.$Eg=function(pa){this.addHandler("ca",pa)};a.prototype.Ibj=function(pa){this.removeHandler("ca",pa)};a.prototype.aFg=function(pa){this.addHandler("ci",pa)};a.prototype.bFg=function(pa){this.addHandler("ekros",pa)};a.prototype.Kbj=function(pa){this.removeHandler("ekros",pa)};a.prototype.dEd=function(pa,qb){try{return JSON.parse(pa)[qb].toLowerCase()}catch(Sb){return""}};a.prototype.Bwj=function(pa){var qb=this.dEd(pa,"AudienceGroup"),
Sb=this.dEd(pa,"SessionOrigin");try{var $b=parseInt(this.dEd(pa,"Ring"),10);if("automation"!==qb&&"bluechicken"!==Sb&&-2<=$b)return!0}catch(tc){if("automation"!==qb&&"bluechicken"!==Sb)return!0}return!1};a.prototype.V0b=function(pa){var qb={};qb.Name=pa.Name;qb.BindingType=pa.BindingType;qb.HasHeaders=pa.HasHeaders;pa.IsValidRef&&(qb.ColCount=pa.Reference.LastColumn-pa.Reference.FirstColumn+1,qb.RowCount=pa.Reference.LastRow-pa.Reference.FirstRow+1);return qb};a.prototype.ssi=function(pa,qb){this.zm.launchInsertDialog(pa,
null,this.$Qg(qb))};a.prototype.qda=function(pa,qb){var Sb={};Sb.callbackFunc=pa;Sb.storeType=OSF.StoreTypeEnum.MarketPlace;Sb.fromInsertDialog=!1;Sb.refresh=qb;this.zm.queryEntitlementDetails(Sb)};a.prototype.invokeDdaMethod=function(pa,qb){var Sb=this.pn(pa.DdaMethod.ControlId);Sb?Sb.invokeDdaMethod(pa,qb):this.wf(K.a.internalError,qb)};a.prototype.registerDdaEventAsync=function(pa,qb,Sb,$b,tc){(qb=this.pn(qb))?a.uzb(pa)?qb.J8i(pa,Sb,$b,tc):this.wf(K.a.wDd,tc):this.wf(K.a.internalError,tc)};a.prototype.unregisterDdaEventAsync=
function(pa,qb,Sb,$b,tc){(qb=this.pn(qb))?a.uzb(pa)?qb.PPj(pa,Sb,$b,tc):this.wf(K.a.wDd,tc):this.wf(K.a.internalError,tc)};a.prototype.dispose=function(){this.disposed||(this.$.Ul(this.zd),this.ea.Fk(this.qd),this.ea.AS(this.Io),this.ea.Gv(this.If),this.LWc.detach(this),this.$.userOperationManager.Cr(this.mS),this.vpc=this.Jf=this.gi=this.LWc=this.wb=null,this.jJa&&(this.jJa.dispose(),this.jJa=null),yd.a.Ha(this.NMd),yd.a.Ha(this.MMd),this.E1a&&(this.E1a.dispose(),this.E1a=null),Ie.prototype.dispose.call(this),
this.disposed=!0,kb.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Hed=function(pa){return(pa=this.pn(pa))?pa.getDefaultIconUrl():null};a.prototype.Bwc=function(pa){if(this.CGe!==pa){this.CGe=pa;for(var qb=0,Sb=this.Jf.length;qb<Sb;qb++){var $b=this.Jf[qb];pa?$b.XIe(!1):$b.Zkh()}this.NMd.Bwc(pa);this.MMd.Bwc(pa)}};a.prototype.nOh=function(pa){return(pa=this.pn(pa))?pa.getDefaultDisplayName():null};a.prototype.wf=function(pa,qb,Sb){var $b={};$b[ba.a.Ag]=pa;$b[ba.a.g4]=qb;this.qK(451041795,
$b,void 0===Sb?!0:Sb)};a.prototype.mv=function(pa){var qb={};qb[ba.a.g4]=pa;this.qK(1237877382,qb)};a.prototype.qK=function(pa,qb,Sb){var $b=this;Sb=void 0===Sb?!0:Sb;var tc=new nd.a(pa,0,this.$.fd,0,null),ld=qb?qb[ba.a.g4]:null;this.E1a&&Cb.g(this.$).isEditing&&L.Z_g(pa,qb)?this.E1a.Adh(pa,qb):(pa=this.$.Ka.$b(tc,qb),Sb&&Ca.TaskExtensions.Ba(pa,function(Vc){pe.a(Vc)?$b.wf(K.a.internalError,ld,!1):Vc.result||(Cb.g($b.$).isEditing?$b.wf(K.a.Lyb,ld,!1):$b.wf(K.a.internalError,ld,!1))},this.la,8))};
a.prototype.A2g=function(pa){var qb=this;return!!this.sja(function(Sb){return a.getSolutionId(Sb.nl,qb.$)===a.getSolutionId(pa,qb.$)&&Sb.nl.PrimaryMarketplace.MarketplaceType===pa.PrimaryMarketplace.MarketplaceType&&Sb.nl.PrimaryMarketplace.MarketplaceRef===pa.PrimaryMarketplace.MarketplaceRef&&Sb.nl.PrimaryMarketplace.SolutionVersion===pa.PrimaryMarketplace.SolutionVersion})};a.prototype.pn=function(pa){return this.sja(function(qb){return qb.controlId.startsWith(pa)})};a.prototype.KCh=function(pa){return this.sja(function(qb){return qb.xIa===
pa})};a.prototype.nUe=function(pa){return this.sja(function(qb){return qb.cV===pa&&!!qb.xIa})};a.prototype.GUe=function(pa,qb,Sb,$b){return this.sja(function(tc){return tc.cV===pa&&tc.nl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===qb.toLowerCase()&&tc.nl.PrimaryMarketplace.MarketplaceType.toLowerCase()===Sb.toLowerCase()&&!!tc.nl.SharedRuntime&&!!tc.nl.SharedRuntime.Resid&&!!$b&&!!$b.Resid&&tc.nl.SharedRuntime.Resid.toLowerCase()===$b.Resid.toLowerCase()})};a.prototype.AMg=function(pa,qb){if(pa=
this.pn(pa))pa.ka(qb),pa.showHide(!0)};a.prototype.SAj=function(pa){(pa=this.pn(pa))&&pa.showHide(!1)};a.prototype.g1a=function(pa){var qb;if(1!==pa.WebExtensionType||this.$.Pd&8388608&&pa.TaskpaneVisible||this.$.Pd&8388608&&!pa.TaskpaneVisible&&Gb.HelperMethods.Mw(pa)){var Sb=null;Gb.HelperMethods.Mw(pa)&&(Sb=a.qva(pa,this.$),pa.TaskpaneWidth||(pa.TaskpaneWidth=this.t6b));var $b=(new T(this,this.gi,pa)).vmd();kb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(pa.PrimaryMarketplace.SolutionId,pa.PrimaryMarketplace.MarketplaceType,null===(qb=pa.AssetMarketplace)||void 0===qb?void 0:qb.SolutionId,null,null,pa.PrimaryMarketplace.MarketplaceRef),pa.PrimaryMarketplace.MarketplaceType,Gb.HelperMethods.Mw(pa));Sb&&($b.xIa=Sb);this.Jf.push($b);this.Lxa=null;this.v6a(pa.InstanceId)||(pa=String.format("{0}|{1}|{2}|{3}|{4}",pa.PrimaryMarketplace.SolutionId,pa.PrimaryMarketplace.SolutionVersion,pa.PrimaryMarketplace.MarketplaceRef,
pa.PrimaryMarketplace.MarketplaceType,pa.WebExtensionType),this.raiseEvent("ci",pa))}};a.prototype.zCj=function(pa,qb){function Sb(){$b.OQa(ld.controlId);$b.Gi.purgeOsfControl(ld.controlId,!1);qb()}var $b=this;pa.TaskpaneWidth=this.t6b;pa.TaskpaneVisible=!0;var tc={};tc.SolutionId=pa.PrimaryMarketplace.SolutionId;tc.TargetType=pa.WebExtensionType;tc.Version=pa.PrimaryMarketplace.SolutionVersion;tc.StoreType=pa.PrimaryMarketplace.MarketplaceType;tc.StoreId=pa.PrimaryMarketplace.MarketplaceRef;tc.AssetId=
pa.PrimaryMarketplace.SolutionId;tc.AssetStoreId=pa.PrimaryMarketplace.MarketplaceRef;tc.Width=pa.TaskpaneWidth;var ld=new T(this,this.gi,pa,!0);ld.vmd();this.Jf.push(ld);var Vc=null;Vc=Ue.a.instance.GC(function(){ld.Gy&&(yd.a.Ha(Vc),Vc=null,$b.Gi.insertBlankControlWithErrorUX($b.JGb(ld,tc),Sb))},100,ef.a.rch)};a.prototype.n6g=function(pa){var qb=this;if(pa&&pa.length){var Sb=[];pa.forEach(function($b){if($b.ContainsCustomFunctions){var tc=a.qva($b,qb.$);qb.AEd.contains(tc)||(qb.AEd.add(tc),qb.vHf.push($b));
qb.A2g($b)||Sb.push($b)}});Sb.length&&this.QDe(Sb)}};a.prototype.JFe=function(pa,qb){this.pn(pa.InstanceId)||(qb=qb(),pa=(new T(this,this.gi,pa)).saf(qb),this.Jf.push(pa),this.Lxa=null)};a.prototype.mAj=function(pa){a.y1a.xb(pa)&&a.y1a.oa(pa).initializeAndShowWithTitle()};a.prototype.C7h=function(pa){a.y1a.xb(pa)&&a.y1a.oa(pa).hide()};a.prototype.fVh=function(pa){var qb=this,Sb=null,$b,tc=null;var ld=a.zid(pa,!0);if(!ld)return kb.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),
fc.Task.Ra(null);($b=this.zm.getOsfControl(a.getSolutionId(ld,this.$)))&&(Sb=$b.getManifest())&&(tc=Sb.getSharedRuntimeForCustomFunctions("Workbook"));if(Sb=tc&&1===tc.LifeTime?this.GUe(ld.PrimaryMarketplace.SolutionId,ld.PrimaryMarketplace.MarketplaceRef,ld.PrimaryMarketplace.MarketplaceType,tc):this.KCh(pa))return fc.Task.Ra(Sb.controlId);var Vc=new Tb.a;Gb.HelperMethods.bjc(tc)&&(ld.SharedRuntime=tc);pa=$b?$b.getNotificationParams():[];if(!pa.length)return this.sEe(ld);this.J3f(pa,function(){Ca.TaskExtensions.Ba(Vc.task,
function(){qb.sEe(ld)},qb.la,3)},function(){});return Vc.task};a.prototype.rJh=function(pa){pa=a.zid(pa,!1);if(!pa)return kb.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var qb=null,Sb=this.zm.getOsfControl(a.getSolutionId(pa,this.$));Sb&&(Sb=Sb.getManifest())&&(qb=Sb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Gb.HelperMethods.bjc(qb)&&(pa=this.GUe(pa.PrimaryMarketplace.SolutionId,pa.PrimaryMarketplace.MarketplaceRef,pa.PrimaryMarketplace.MarketplaceType,
qb))?pa.controlId:null};a.prototype.L4g=function(pa,qb){var Sb=this,$b=a.zid(pa,!1);if($b){var tc=null,ld=this.zm.getOsfControl(a.getSolutionId($b,this.$));ld&&(ld=ld.getManifest())&&(tc=ld.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Gb.HelperMethods.bjc(tc)){$b.SharedRuntime=tc;var Vc=$b.PrimaryMarketplace.SolutionId;ld=$b.PrimaryMarketplace.SolutionVersion;var Se=OSF.OsfManifestManager.getCachedManifest(Vc,ld);if(Se)if(this.i_b.xb(pa))tc=this.i_b.oa(pa),Ca.TaskExtensions.Ba(tc,function(jf){(jf=
jf.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(jf,qb,Sb.gi.fKb)},this.la,3);else{var Ge={solutionId:Vc,version:ld};Ge.storeType=$b.PrimaryMarketplace.MarketplaceType;Ge.storeId=$b.PrimaryMarketplace.MarketplaceRef;Ge.assetId=Vc;Ge.assetStoreId=null;Ge.targetType=OSF.OsfControlTarget.TaskPane;var Af=new Tb.a;$b=Ca.TaskExtensions.Dl();$b=new mb.a(this.$,this,Ge,$b);tc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Vc,tc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Se,
tc,ld);$b.createUILessSandbox(Ge,Se,function(jf,Ef){jf&&!Ef?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(jf,qb,Sb.gi.fKb),Af.setResult(jf)):Af.setResult(null);Sb.i_b.remove(pa)});this.i_b.ia(pa,Af.task)}}}else kb.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.Mye=function(pa){(pa=this.nUe(pa))&&(pa.nl.SharedRuntime||this.WHb(pa.controlId))};a.prototype.WHb=function(pa){(pa=this.nUe(pa))&&this.OQa(pa.controlId)};
a.prototype.Dhh=function(pa,qb){if(!this.Jf||!pa||!qb)return!1;if(pa.toLowerCase()===qb.toLowerCase())return!0;for(var Sb=null,$b=null,tc=0,ld=this.Jf.length;tc<ld;tc++){var Vc=this.Jf[tc];if(Vc.ownerAddinSolutionId&&(Vc.controlId===pa&&(Sb=Vc.ownerAddinSolutionId.toLowerCase()),Vc.controlId===qb&&($b=Vc.ownerAddinSolutionId.toLowerCase()),Sb&&$b))break}return Sb&&Sb===$b?!0:!1};a.prototype.DCg=function(pa){this.pn(pa.InstanceId)||(pa=new T(this,this.gi,pa),this.Jf.push(pa),this.Lxa=null)};a.prototype.eQf=
function(pa){if(this.Jf&&0<=pa&&pa<this.Jf.length){var qb=this.Jf[pa],Sb=qb.Gy;Array.removeAt(this.Jf,pa);this.Wwf(qb);qd.DOMElementExtensions.Af(Sb)}};a.prototype.OQa=function(pa){if(this.Jf)for(var qb=0,Sb=this.Jf.length;qb<Sb;qb++)if(this.Jf[qb].controlId===pa){this.eQf(qb);break}};a.prototype.Iaj=function(pa){if(this.Jf){pa=pa.toLowerCase();for(var qb=0,Sb=this.Jf.length;qb<Sb;qb++)if(pa===this.Jf[qb].ownerAddinSolutionId.toLowerCase()){this.eQf(qb);break}}};a.prototype.gNg=function(pa){pa.wn&&
(this.pn(pa.floatingObject.nl.InstanceId)||(this.Wfc(pa.floatingObject.nl.InstanceId)||this.vpc.push(pa.floatingObject.nl.InstanceId),this.g1a(pa.floatingObject.nl)),this.ea.isNamedObjectViewMode&&this.AMg(pa.floatingObject.nl.InstanceId,pa.Qd))};a.prototype.Waa=function(pa){if(this.Jf)for(var qb=0,Sb=this.Jf.length;qb<Sb;qb++)if(1===this.Jf[qb].controlType&&Lf.a.equals(this.Jf[qb].cV,pa,!0))return this.Jf[qb].controlId;return null};a.prototype.jCh=function(pa){var qb=[];if(this.Jf)for(var Sb=0,$b=
this.Jf.length;Sb<$b;Sb++)Lf.a.equals(this.Jf[Sb].cV,pa,!0)&&qb.push(this.Jf[Sb].controlId);return qb};a.prototype.RCh=function(pa,qb){if(!qb||!pa)return null;if(this.Jf)for(var Sb=0,$b=this.Jf.length;Sb<$b;Sb++)if(1===this.Jf[Sb].controlType&&Lf.a.equals(this.Jf[Sb].cV,pa,!0)&&this.Jf[Sb].nl.SharedRuntime&&Lf.a.equals(this.Jf[Sb].nl.SharedRuntime.Resid,qb.Resid,!0))return this.Jf[Sb].controlId;return null};a.prototype.M3a=function(pa,qb){qb=void 0===qb?null:qb;return pa?qb?String.format("{0}.{1}",
pa,qb):pa:""};a.prototype.Pye=function(pa,qb,Sb){if(this.Lxa===pa)return!0;this.Lxa=pa;var $b=null,tc=!1;if(!$b&&this.Jf)for(var ld=0,Vc=this.Jf.length;ld<Vc;ld++)if(1===this.Jf[ld].controlType&&Lf.a.equals(this.Jf[ld].cV,pa,!0)){var Se=!1,Ge=!1;qb?(Se=!0,Ge=!!this.Jf[ld].nl.SharedRuntime&&Lf.a.equals(this.Jf[ld].nl.SharedRuntime.Resid,qb.Resid,!0)):Sb&&(Se=!0,Ge=Lf.a.equals(this.Jf[ld].nl.SharedRuntimeId,Sb,!0));if(!Se||Ge){Ge&&this.Jf[ld].jg(!0);$b=this.Jf[ld].controlId;tc=!0;this.Lxa=null;break}}$b&&
this.raiseEvent("ca",$b);return tc};a.prototype.setAppRuntimeState=function(pa,qb){var Sb;if(pa){var $b=this.pn(pa);if($b&&Gb.HelperMethods.Mw($b.nl))$b.jg(qb),qb&&(this.raiseEvent("ca",pa),(null===(Sb=$b.Gy)||void 0===Sb?0:Sb.firstChild)&&(pa=$b.Gy.firstChild.title)&&0<pa.length&&this.o0b.Ynj(pa));else throw kb.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(qf.a.instance.fa(2192));}else throw kb.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(qf.a.instance.fa(2193));};a.prototype.getAppRuntimeState=function(pa){if(pa)if((pa=this.pn(pa))&&Gb.HelperMethods.Mw(pa.nl))pa=pa.nl.TaskpaneVisible;else throw kb.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(qf.a.instance.fa(2192));else throw kb.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(qf.a.instance.fa(2193));return pa};a.prototype.i3a=function(pa,qb){return(pa=
this.pn(pa))?pa.i3a(qb):null};a.prototype.v6a=function(pa){return this.Rye(this.vpc,pa)};a.prototype.Wfc=function(pa){return this.Rye(this.xGe,pa)};a.prototype.sme=function(pa){this.xGe.push(pa)};a.prototype.YZ=function(pa){return(pa=this.pn(pa))?pa.nl:null};a.prototype.szd=function(pa){this.raiseEvent("ekros",pa,this)};a.prototype.bDd=function(pa){if(pa){var qb=this.pn(pa.InstanceId);qb&&(pa.SharedRuntime||pa.SharedRuntimeId||(this.OQa(qb.controlId),this.Gi.purgeOsfControl(qb.controlId,!1)),qb={},
qb.SolutionId=pa.PrimaryMarketplace.SolutionId,qb.TargetType=pa.WebExtensionType,qb.Version=pa.PrimaryMarketplace.SolutionVersion,qb.StoreType=pa.PrimaryMarketplace.MarketplaceType,qb.StoreId=pa.PrimaryMarketplace.MarketplaceRef,qb.AssetId=pa.PrimaryMarketplace.SolutionId,qb.AssetStoreId=pa.PrimaryMarketplace.MarketplaceRef,qb.Width=pa.TaskpaneWidth,qb.SharedRuntimeId=pa.SharedRuntimeId,this.zag(qb))}};a.prototype.$ia=function(){this.gi.$ia()};a.prototype.WM=function(pa,qb,Sb){this.gi.WM(pa,qb,Sb)};
a.prototype.goj=function(pa,qb){var Sb=Array(2);Sb[0]=qb;Sb[1]=null;this.gi.fDh(pa,JSON.stringify(Sb))};a.prototype.RUe=function(pa,qb){qb=a.Y9g(qb);pa=this.YZ(pa);this.gi.v$b(pa.InstanceId,2202,kd.a.BX,qb)};a.prototype.Cbd=function(pa){for(var qb=0,Sb=this.Jf.length;qb<Sb;qb++)this.RUe(this.Jf[qb].controlId,pa)};a.prototype.bDh=function(pa,qb){qb=a.p5g(qb);this.gi.v$b(pa,65539,"",qb)};a.prototype.dDh=function(pa,qb,Sb){this.gi.v$b(pa,1,qb,Sb)};a.prototype.aDh=function(pa,qb){this.gi.eDh(pa,qb)};
a.prototype.I4g=function(pa,qb){return[[2,1E3,"",JSON.stringify([pa,qb]),0,!1]]};a.prototype.Zfi=function(){return!!this.tna&&this.tna.H7e()};a.prototype.zYg=function(){this.tna&&this.tna.clear()};a.prototype.cDh=function(){if(this.tna&&this.tna.H7e()){var pa=this.tna.tJh();pa=Cl(pa);for(var qb=pa.next();!qb.done;qb=pa.next()){qb=this.jCh(qb.value);qb=Cl(qb);for(var Sb=qb.next();!Sb.done;Sb=qb.next())this.gi.v$b(Sb.value,65540,"","{}")}}};a.prototype.C8i=function(pa){this.tna.add(pa)};a.prototype.LPj=
function(pa){this.tna.remove(pa)};a.prototype.sja=function(pa){if(!this.Jf)return null;for(var qb=Cl(this.Jf),Sb=qb.next();!Sb.done;Sb=qb.next())if(Sb=Sb.value,pa(Sb))return Sb;return null};a.prototype.sEe=function(pa){var qb=this,Sb=new Tb.a,$b=a.qva(pa,this.$);if(Gb.HelperMethods.Mw(pa))kb.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.sHf(pa,function(ld){ld?(pa.InstanceId=ld.InstanceId,pa.WebExtensionOsfControlType=3,pa.TaskpaneVisible=!1,qb.g1a(pa),Sb.setResult(pa.InstanceId)):
(kb.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetPrivacyCompliantId(pa.PrimaryMarketplace.SolutionId,pa.PrimaryMarketplace.MarketplaceType,null,null,null,pa.PrimaryMarketplace.MarketplaceRef)),Sb.setException(Error.create("Null insert data")))});else{a.y1a.ia(pa.InstanceId,new cc.a);var tc=a.y1a.oa(pa.InstanceId).R1a;this.m6g(pa,tc,$b);this.sHf(pa,null);Sb.setResult(pa.InstanceId)}return Sb.task};a.prototype.m6g=function(pa,qb,Sb){this.pn(pa.InstanceId)||
(pa=new T(this,this.gi,pa),pa.xIa=Sb,pa.saf(qb),this.Jf.push(pa),this.Lxa=null)};a.prototype.sHf=function(pa,qb){var Sb=a.qva(pa,this.$);if(!this.AEd.contains(Sb))this.kGb.push(pa),1<=this.kGb.length&&this.tHf(pa,qb);else if(qb){pa=Cl(this.vHf);for(var $b=pa.next();!$b.done;$b=pa.next())if($b=$b.value,a.qva($b,this.$)===Sb){qb($b,0);break}}};a.prototype.tHf=function(pa,qb){function Sb(jf){jf&&!Ig.a(jf)||kb.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Vc.SolutionId,Vc.StoreType,Vc.AssetId,null,null,Vc.StoreId),Re.a.Xc(jf.Errors));tc.kGb.shift();0<tc.kGb.length&&tc.tHf(tc.kGb[0],qb)}function $b(jf){jf=rd.a.pg(jf.data);kb.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",Re.a.Xc(jf))}var tc=this,ld=null,Vc={};Vc.SolutionId=a.getSolutionId(pa,this.$);Vc.TargetType=pa.WebExtensionType;Vc.Version=pa.PrimaryMarketplace.SolutionVersion;
Vc.StoreType=pa.PrimaryMarketplace.MarketplaceType;Vc.StoreId=pa.PrimaryMarketplace.MarketplaceRef;Vc.AssetId=pa.PrimaryMarketplace.SolutionId;Vc.AssetStoreId=pa.PrimaryMarketplace.MarketplaceRef;Vc.Width=pa.TaskpaneWidth;Vc.ContainsCustomFunctions=!0;Gb.HelperMethods.Mw(pa)&&(Vc.SharedRuntimeId=pa.SharedRuntime.Resid);var Se=this.$.na.va;pa=this.$.na.va.hc();var Ge=Se.Na(9,pa);Ge.sharedInfo=Vc;if(qb){var Af=function(jf){var Ef=jf.Result;(ld=Ef?Ef.AgaveData:null)||qb(null,jf.Errors?jf.Errors[0].ErrorCause:
5001);qb(ld,0)};pa=function(jf,Ef,Xf){return te.i(Se,"InsertAgaveTaskpane",Ge,vg.b(jf,Sb,Af),vg.a(Ef,$b),Xf,null,0)}}else pa=function(jf,Ef,Xf){return te.i(Se,"InsertAgaveTaskpane",Ge,vg.b(jf,Sb),vg.a(Ef,$b),Xf,null,0)};tb.EwaSettings.qc()?$f.a(this.$.userOperationManager,pa,function(jf){return new Sd.a(519,0,jf,64)},null):$f.a(this.$.userOperationManager,pa,function(jf){return new Jf.a(519,0,jf)},null)};a.prototype.rxj=function(){return this.$.Yf.get(35)};a.prototype.JJd=function(pa){pa=this.pn(pa);
(null===pa||void 0===pa?0:pa.Xda)&&pa.nQf()};a.prototype.REi=function(pa){var qb=this.sja(function(Sb){return a.wMa(Sb.cV)});qb&&(qb=this.Gi.getOsfControl(qb.controlId))&&qb.notifyAgave(OSF.AgaveHostAction.SendMessage,pa)};a.prototype.Ngi=function(){return!!this.sja(function(pa){return 1===pa.controlType&&a.wMa(pa.cV)})};a.prototype.Mgi=function(){var pa=this.sja(function(qb){return a.wMa(qb.cV)});return pa?pa.Gy?qd.DOMElementExtensions.isVisible(pa.Gy):!1:!1};a.prototype.Yqj=function(){var pa=this.sja(function(qb){return a.wMa(qb.cV)});
pa&&(pa.jg(!0),this.raiseEvent("ca",pa.controlId))};a.prototype.initialize=function(){var pa=b(1405).DdaEventDispatch,qb=void 0===this.$||null===this.$||tb.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||kb.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");qb&&kb.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(f.OGa(this.$),this.ea=this.$.ea,this.gi=new pa(this.$),this.$.tl(this.zd),
this.ea.gk(this.qd),this.ea.vM(this.Io),this.ea.Ot(this.If),this.$.userOperationManager.Wu(this.mS),this.Ulf(),this.dPi(),this.Zai(),this.$.da.Ga(35,this),this.LWc.ka(this),qb&&kb.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.nge=new kd.a,qb&&kb.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.qge=new u(this.$,this.ij,this.gi),this.Nvg=new x(this.$,this.ij,this.gi),this.oge=new C(this.$,this.ij,this.gi),this.mge=
new v(this.$,this.ij,this.gi),this.lge=new A(this.$,this.ij,this.gi),this.pge=new B(this.$,this.ij,this.gi),this.rge=new r(this.$,this.ij,this.gi),this.sge=new y(this.$,this.ij,this.gi),this.$.Yba&&(this.tge=new h(this.$,this.ij,this.gi)),tb.EwaSettings.ma(191)&&(this.E1a=new L(this,Cb.g(this.$))),tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.kge=new M),this.initialized=!0,kb.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.XCh=
function(pa){if(!this.xCa)return null;for(var qb=0,Sb=this.xCa.length;qb<Sb;qb++)if(pa.startsWith(this.xCa[qb].WebExtensionId))return this.xCa[qb];return null};a.prototype.Ulf=function(){var pa,qb=this.ea;if(qb.sc&&!this.DPb){if(qb.workbookContext){if(this.ITc=this.$.ea.Zg.get(22),null===(pa=qb.workbookContext.WebExtensions)||void 0===pa?0:pa.length){pa=qb.workbookContext.WebExtensions;qb=!1;for(var Sb={},$b=pa.length-1;0<=$b;Sb={YPb:Sb.YPb},$b--){if(!this.ea.isNamedObjectViewMode){this.vpc.push(pa[$b].InstanceId);
if(1!==pa[$b].WebExtensionType){Array.removeAt(pa,$b);continue}if(Gb.HelperMethods.Mw(pa[$b])&&0!==pa[$b].SharedRuntime.State)1===pa[$b].SharedRuntime.State?pa[$b].TaskpaneVisible=!1:2===pa[$b].SharedRuntime.State?pa[$b].TaskpaneVisible=!0:kb.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!pa[$b].ContainsCustomFunctions&&!pa[$b].TaskpaneVisible&&!bb.a(pa[$b])){Array.removeAt(pa,$b);continue}}var tc=OSF.OsfControl.isFirstPartyStoreString(pa[$b].PrimaryMarketplace.MarketplaceType);
tb.EwaSettings.ma(187)&&!tc&&(Array.removeAt(pa,$b),qb||(qb=!0,Sb.YPb=Fc.GetServiceTaskFactory.Ua(this.$.da,5,4,3),Ca.TaskExtensions.Ba(Sb.YPb,function(ld){return function(){ld.YPb.result.eg(35,null)}}(Sb),this.la,3)));tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&pa[$b].PrimaryMarketplace&&a.wMa(pa[$b].PrimaryMarketplace.SolutionId)&&(kb.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(pa,
$b))}this.QDe(pa)}}else this.ITc=!1;this.DPb=!0}};a.prototype.g6e=function(pa){var qb=Cb.g(this.$),Sb=qb.ha.Oa.oc;if(Sb&&pa){pa=!1;if(this.Jf)for(var $b=Cl(this.Jf),tc=$b.next();!tc.done;tc=$b.next())if(tc=tc.value,a.wMa(tc.cV)||a.Tji(tc.cV)){pa=!0;break}pa||qb.ha.Oa.oH(Sb)}};a.prototype.dPi=function(){this.Gi&&this.ea.isNamedObjectViewMode&&this.$.qa&&ne.o(this.$.qa)&&(this.$.da.Aa(34).zR?this.$.da.Aa(34).Kmd():this.$.da.Aa(34).Nt(this.bVi))};a.prototype.QDe=function(pa){var qb=this,Sb=null;Sb=function(ld){function Vc(){qb.OPa.shift();
0<qb.OPa.length&&Sb(qb.OPa[0])}var Se=ld.WebExtensionData,Ge=ld.IsTaskPane,Af=ld.RecordHandler;if(qb.Waa(Se.PrimaryMarketplace.SolutionId))Vc();else{Ge&&(Se.WebExtensionOsfControlType=1);var jf=bb.a(Se);if(!Ge||Se.TaskpaneVisible||jf||Se.SharedRuntime&&0!==Se.SharedRuntime.State||Se.ContainsCustomFunctions){var Ef=new T(qb,qb.gi,Se,!Ge);kb.ULS.sendTraceTag(537170517,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Se.PrimaryMarketplace.SolutionId,
Se.PrimaryMarketplace.MarketplaceType,null,null,null,Se.PrimaryMarketplace.MarketplaceRef),Se.PrimaryMarketplace.MarketplaceType,Gb.HelperMethods.Mw(Se));Ef.vmd();Gb.HelperMethods.Mw(Se)&&(Ef.xIa=a.qva(Se,qb.$),Se.TaskpaneWidth=qb.t6b);jf&&(Se.WebExtensionToolTip="");Ge&&Se.TaskpaneVisible&&!jf&&(Se.TaskpaneWidth=qb.t6b);qb.Jf.push(Ef);var Xf=qb.Lxa=null;Xf=Ue.a.instance.GC(function(){Ef.Gy&&(yd.a.Ha(Xf),Xf=null,Af&&Af(ld,Ef),Vc())},100,ef.a.qch)}else Vc()}};for(var $b={},tc=0;tc<pa.length;$b={S1:$b.S1},
tc++)if(!this.pn(pa[tc].InstanceId))if(1!==pa[tc].WebExtensionType)this.g1a(pa[tc]);else if(!tb.EwaSettings.ma(54))this.jnb(pa[tc],Sb);else if(this.$.Pd&8388608||pa[tc].TaskpaneVisible)$b.S1={},$b.S1.marketplaceId=pa[tc].PrimaryMarketplace.SolutionId,$b.S1.marketplaceVersion=pa[tc].PrimaryMarketplace.SolutionVersion,$b.S1.storeType=pa[tc].PrimaryMarketplace.MarketplaceType,$b.S1.storeId=pa[tc].PrimaryMarketplace.MarketplaceRef,$b.S1.targetData=pa[tc],this.Gi.isAddinCommandsAsync($b.S1,function(ld){return function(Vc,
Se,Ge){if(Vc){var Af=Ge.targetData;if(Se){if(tb.EwaSettings.ma(88))if(ld.S1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Vc=ld.S1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Se=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&ld.S1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Vc||Se)&&Gb.HelperMethods.Mw(Af)&&qb.jnb(Af,Sb);else if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))qb.J4h(Ge,
Sb);else{var jf=!1;qb.qda(function(Ef){if(!Ef.errorCode){if(Ef.value){Ef=Cl(Ef.value);for(var Xf=Ef.next();!Xf.done&&!jf;Xf=Ef.next())jf=ae.c(Xf.value[1])===ae.c(Af.PrimaryMarketplace.SolutionId)}jf?Gb.HelperMethods.Mw(Af)&&qb.jnb(Af,Sb):(Ef={},Ef.SolutionId=Ge.marketplaceId,Ef.TargetType=Af.WebExtensionType,Ef.Version=Ge.marketplaceVersion,Ef.StoreType=Af.PrimaryMarketplace.MarketplaceType,Ef.StoreId=Ge.storeId,Ef.AssetId=Ge.marketplaceId,Ef.AssetStoreId=Ge.storeId,Ef.Width=Af.TaskpaneWidth,Af.TaskpaneVisible=
!0,qb.ele(Ef,Af,Sb))}},!0)}}else qb.jnb(Af,Sb)}else Vc=Ge.targetData,kb.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetPrivacyCompliantId(Vc.PrimaryMarketplace.SolutionId,Vc.PrimaryMarketplace.MarketplaceType,null,null,null,Vc.PrimaryMarketplace.MarketplaceRef),Vc.PrimaryMarketplace.MarketplaceType)}}($b))};a.prototype.J4h=function(pa,qb){var Sb=this,$b=!1;this.qda(function(tc){var ld=pa.targetData;if(!tc.errorCode){if(tc.value){tc=
Cl(tc.value);for(var Vc=tc.next();!Vc.done&&!$b;Vc=tc.next())$b=ae.c(Vc.value[1])===ae.c(ld.PrimaryMarketplace.SolutionId)}$b?Gb.HelperMethods.Mw(ld)&&Sb.jnb(ld,qb):(tc={},tc.SolutionId=pa.marketplaceId,tc.TargetType=ld.WebExtensionType,tc.Version=pa.marketplaceVersion,tc.StoreType=ld.PrimaryMarketplace.MarketplaceType,tc.StoreId=pa.storeId,tc.AssetId=pa.marketplaceId,tc.AssetStoreId=pa.storeId,tc.Width=ld.TaskpaneWidth,ld.TaskpaneVisible=!0,Sb.ele(tc,ld,qb))}},!0)};a.prototype.jnb=function(pa,qb){var Sb=
{};Sb.WebExtensionData=pa;Sb.IsTaskPane=!0;this.OPa.push(Sb);1===this.OPa.length&&qb(Sb)};a.prototype.ele=function(pa,qb,Sb){var $b=this,tc={};tc.ActivationInfo=pa;tc.WebExtensionData=qb;tc.IsTaskPane=!1;tc.RecordHandler=function(ld,Vc){var Se=ld.ActivationInfo;$b.Gi.insertBlankControlWithErrorUX($b.JGb(Vc,Se),function(){$b.OQa(Vc.controlId);$b.Gi.purgeOsfControl(Vc.controlId,!1);$b.zag(Se)})};this.OPa.push(tc);1===this.OPa.length&&Sb(tc)};a.prototype.zag=function(pa){var qb={};qb.solutionId=pa.SolutionId;
qb.version=pa.Version;qb.storeType=pa.StoreType;qb.storeId=pa.StoreId;qb.assetId=pa.AssetId;qb.assetStoreId=pa.AssetStoreId;qb.targetType=pa.TargetType;qb.sharedRuntimeId=pa.SharedRuntimeId;pa=new Cc.a;pa.add(qb);qb={};qb[nc.a.pZa]=pa;qb[nc.a.xM]=3;pa=new nd.a(Rb.a.PBb,0,this.$.fd,0,null);this.$.Ka.$b(pa,qb)};a.prototype.JGb=function(pa,qb){var Sb={};Sb.div=pa.Gy;Sb.id=pa.controlId;Sb.solutionId=qb.SolutionId;Sb.version=qb.Version;Sb.storeId=qb.StoreId;Sb.storeType=qb.StoreType;Sb.osfControlType=
OSF.OsfControlTarget.TaskPane;return Sb};a.prototype.TTf=function(){var pa=this;if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var qb=[],Sb=0;Sb<this.Jf.length;Sb++){var $b=this.Jf[Sb];0!==$b.osfControlType&&3!==$b.osfControlType&&4!==$b.osfControlType||qb.push($b)}Sb=!1;for($b=0;$b<qb.length;$b++){var tc=qb[$b];this.OQa(tc.controlId);!Sb&&tc&&tc.nl&&(Sb=Gb.HelperMethods.Mw(tc.nl))}Sb&&(qb={},qb=(qb.DynamicAddinCommandsMethodDispatchId=4,qb),this.qK(-1014260128,
qb))}tb.EwaSettings.ma(405)&&Ca.TaskExtensions.Ba(Fc.GetServiceTaskFactory.Ua(this.$.da,278,279,3),function(ld){ld&&(ld=ld.result)&&(pa.$.da.Aa(278)||pa.$.da.Ga(278,ld),ld.xbf().wna())},this.la,3)};a.prototype.rL=function(){var pa=this,qb=new n(this.$,this.ij,this.SUf);void 0===this.$||null===this.$?kb.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):tb.EwaSettings.ma(260)&&kb.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.ij||null===this.ij));if(qb.DDi()){var Sb=function(){},$b=function(Vc){Vc=rd.a.pg(Vc.data);kb.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",Re.a.Xc(Vc))},tc=qb.WRg();qb=function(Vc,Se,Ge){return te.i(pa.$.na.va,"ExecuteRichApiRequest",pa.YRg(tc),vg.b(Vc,Sb),vg.a(Se,$b),Ge,null,0)};var ld=a.ygd(tc);tb.EwaSettings.qc()?this.$.userOperationManager.Zt(new Sd.a(507,0,qb,ld|64)):this.$.userOperationManager.Zt(new Jf.a(507,
0,qb,ld))}};a.prototype.YRg=function(pa){var qb=this.$.na.va.Na(1);qb.request=pa;return qb};a.prototype.Rye=function(pa,qb){if(pa)for(var Sb=0;Sb<pa.length;Sb++)if(Lf.a.equals(pa[Sb],qb,!0))return!0;return!1};a.prototype.$Qg=function(pa){var qb={};qb.navigationMode=OSF.OsfNavigationMode.DefaultMode;qb.assetId=null;qb.category=null;if(!pa||3>pa.length)return qb;if(pa[0]){var Sb=parseInt(pa[0],10);isNaN(parseInt(Sb,10))||(qb.navigationMode=Sb)}pa[1]&&(qb.assetId=pa[1]);pa[2]&&(qb.category=pa[2]);return qb};
a.prototype.Zai=function(){if(tb.EwaSettings.ma(62)){var pa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(pa&&"*"!==pa.trim()){this.jJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new ea(this),pa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Yf.get(2));try{this.jJa.init()}catch(qb){try{this.jJa.dispose()}catch(Sb){}this.jJa=null;kb.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+qb.message)}pa={};pa.a=this.$.ya.UserSessionId;
zc.b().Pe(39,pa)}}};a.prototype.J3f=function(pa,qb,Sb){var $b=this,tc=a.nQg(pa[0]),ld=tc.Wha,Vc=tc.Oia;tc.Wha=function(){ld&&ld();var Se=tc.$La!==OSF.InfoType.Error?qb:null;pa.shift();pa.length?$b.J3f(pa,Se,Sb):Se&&Se()};tc.Oia=function(){Vc&&Vc();Sb&&tc.$La!==OSF.InfoType.Error&&Sb()};Pa.a.zSd(tc)};a.prototype.ORh=function(){var pa={};pa.AddinRibbonControlsOverriddenByApi=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();pa.AddinActionDefinitionHybridMode=
tb.EwaSettings.ma(647).toString();pa.UseActionIdForUILessCommand=tb.EwaSettings.ma(650).toString();pa.AllowStorageAccessByUserActivationOnIFrame=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();pa.RequirementSetRibbonApiOnePointTwo=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();pa.flightingTreatmentVariables=gb.AFrameworkApplication.ga.F$b;pa.ShortcutInfoArrayInUserPreferenceData=
tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return pa};a.getSolutionId=function(pa){var qb=pa.PrimaryMarketplace.SolutionId;tb.EwaSettings.ma(294)&&pa.OwnerAddinSolutionId&&(qb=pa.OwnerAddinSolutionId);return qb};a.ygd=function(pa){var qb=0;tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?pa.RequestFlags&1&&256!==(pa.RequestFlags&256)||(qb=16):qb=pa.RequestFlags&1?0:16;return qb};a.qva=function(pa,
qb){qb=a.getSolutionId(pa,qb);return a.yZe(qb,pa.PrimaryMarketplace.SolutionVersion,pa.PrimaryMarketplace.MarketplaceType,pa.PrimaryMarketplace.MarketplaceRef)};a.Y9g=function(pa){var qb={};pa=(qb.recording=pa,qb);return JSON.stringify(pa)};a.p5g=function(pa){var qb={};qb.visibility=pa?"Visible":"Hidden";return JSON.stringify(qb)};a.TNh=function(pa){var qb=pa.getSolutionId(),Sb=pa.getVersion(),$b=pa.getStoreType();pa=pa.getStoreId();return a.yZe(qb,Sb,$b,pa)};a.yZe=function(pa,qb,Sb,$b){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",pa,qb,a.OZh(Sb).toString(),$b)};a.zid=function(pa,qb){var Sb=pa.split("|");if(7>Sb.length)return kb.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Sb[0])return kb.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Sb[0]),null;var $b=Sb[1],tc=Sb[2],ld=a.PZh(Sb[3]),Vc=Sb[4];Sb=Sb[5];$b&&$b.length||($b=Sb);Sb={};Sb.InstanceId=String.format("{{{0}}}",pc.a.create().toString());
Sb.WebExtensionOsfControlType=4;Sb.WebExtensionType=1;Sb.PrimaryMarketplace={};Sb.PrimaryMarketplace.SolutionId=$b;Sb.PrimaryMarketplace.SolutionVersion=tc;Sb.PrimaryMarketplace.MarketplaceRef=Vc;Sb.PrimaryMarketplace.MarketplaceType=ld;Sb.ContainsCustomFunctions=qb?!0:!1;qb&&(Sb.OsfPropertyBag=[["customFunctionAddinId",pa]]);return Sb};a.PZh=function(pa){pa=parseInt(pa,10);return pa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:pa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:pa===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:pa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:pa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:pa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:pa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:pa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:pa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:pa===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:pa===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.OZh=function(pa){return pa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:pa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:pa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:pa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:pa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:pa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:pa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:pa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
pa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:pa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:pa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.Xrb=function(pa){var qb={};qb.Version=pa.version;qb.AssetId=pa.assetId;qb.AssetStoreId=null!==pa.assetStoreId?pa.assetStoreId.toString():null;qb.StoreType=pa.storeType;qb.Height=pa.height;qb.SolutionId=pa.solutionId;qb.StoreId=pa.storeId;qb.TargetType=pa.targetType;qb.Width=1===qb.TargetType?0:pa.width;
qb.SharedRuntimeId=pa.sharedRuntimeId;return qb};a.uzb=function(pa){return pa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||pa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||pa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||pa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||pa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};
a.nQg=function(pa){return Object(db.a)(new ud.a,{$La:pa.infoType,id:pa.id,title:pa.title,description:pa.description,buttonText:pa.buttonTxt,Wha:pa.buttonCallback,Aec:pa.highPriority,Oia:pa.dismissCallback,errorCode:pa.errorCode,x$e:pa.iframeNotificationUrl})};a.wMa=function(pa){var qb="FA000000014"===pa;qb||(qb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===pa);return qb};a.Tji=function(pa){return"FA000000005"===pa};Ck.Object.defineProperties(a.prototype,{o0b:{configurable:!0,enumerable:!0,get:function(){return this.wfa||
(this.wfa=new rb.a(this.$.xw))}},Gi:{configurable:!0,enumerable:!0,get:function(){if(!this.zm){var pa={},qb=!(this.$.Pd&1),Sb=Ac.a.current.kO,$b=this.$.workbookContext,tc=Ya.a.HL+Ya.a.A3b,ld=0;tb.EwaSettings.ma(492)&&(ld|=2);pa.pageBaseUrl=Sb.LayoutsContentUrlPrefix;pa.appName=OSF.AppName.ExcelWebApp;pa.appVersion="16";pa.appSettings=this.ORh();pa.singleSignOnSettings=eb.AppsForOfficeSingleSignOnManager.rZh();pa.clientMode=qb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;pa.appUILocale=this.$.ya.UICultureTag;
pa.dataLocale=this.$.ya.DataCultureTag;pa.docUrl=$b.ClientUrl;pa.hostControl=this;pa.formFactor=OSF.FormFactor.Default;pa.lcid=this.$.xG.toString();pa.localizedScriptsUrl=Ya.a.HL+Ya.a.z2c;pa.localizedImagesUrl=tc;pa.localizedStylesUrl=Ya.a.HL+Ya.a.QBe;pa.localizedResourcesUrl=tc;pa.osfOmexBaseUrl=Sb.OsfOmexBaseUrl;pa.firstPartyManifestCDNUrl=Sb.FirstPartyAddInManifestCDN;pa.sdxAssetsToPrefetchMapping=gb.AFrameworkApplication.ga.Va("SdxAssetsToPrefetchMapping");pa.sdxCdnUrl=Sb.SdxCdnUrl;pa.sdxDmsUrl=
Sb.SdxDmsUrl;pa.devCatalogUrl=Sb.DevCatalogUrl;pa.controlStatusChanged=this.poc;pa.notifyHost=this.mBf;pa.allowExternalMarketplace=this.$.ea.Zg.get(27)&&a.j3c;pa.enableAddinCommands=tb.EwaSettings.ma(54);pa.enableBlackForestRedirect=tb.EwaSettings.ma(89);pa.enableMyOrg=this.$.ea.Zg.get(33);pa.enableMyApps=this.$.ea.Zg.get(34);pa.enableDevCatalog=tb.EwaSettings.ma(45);pa.enablePrivateCatalog=this.rxj();pa.enableTaskpaneUpgradeToAppCommand=tb.EwaSettings.ma(94);pa.showSignOutFromPrivateCatalogMessage=
this.$.ea.Zg.get(36);pa.enableUploadFileDevCatalog=tb.EwaSettings.ma(54)&&!tb.EwaSettings.ma(283);pa.userNameHashCode=Db.a.sw(gb.AFrameworkApplication.userName);pa.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();pa.enableSingleSignOnForAddin=!tb.EwaSettings.ma(24)&&gb.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;pa.enableDisplayBlockedMinorError=tb.EwaSettings.ma(184);pa.hideAppsExtensionUrl=gb.AFrameworkApplication.hideAppsExtensionUrl;pa.enableAnonymousUseLegacyCatalogService=
tb.EwaSettings.ma(174);pa.enableInsertDialogAccessibilityFix=tb.EwaSettings.ma(181);pa.disableAppsForOfficeThirdParty=tb.EwaSettings.ma(187);pa.enableFirstPartySSO=tb.EwaSettings.ma(199);pa.wacSessionId=this.$.ya.UserSessionId;pa.disableLogging=!this.$.ya.AriaLoggingIsEnabled;pa.enableFirstPartySDXErrorMessages=tb.EwaSettings.ma(212);pa.enableRichApiCellEditDelay=tb.EwaSettings.ma(191);pa.isHostDocumentDomain=tb.EwaSettings.ma(227);pa.loggableUserId=gb.AFrameworkApplication.ga.Va("LoggableUserId");
pa.sessionStartInfoJson=gb.AFrameworkApplication.ga.Va("SessionStartInfoJson");pa.wopiHostOriginFromPostMessage=gb.AFrameworkApplication.wopiHostOriginFromPostMessage;pa.wopiHostOriginFromWacPropBag=gb.AFrameworkApplication.ga.Va("PostMessageOrigin");pa.wacIsEmbedded=gb.AFrameworkApplication.ga.ra("IsEmbedded");pa.accessibilityAllowFocusAddinTaskpane=gb.AFrameworkApplication.ga.ra("AccessibilityAllowFocusAddinTaskpane");pa.enableRemoveAppCommandsAddin=gb.AFrameworkApplication.ga.ra("RemoveAppCommandsAddinIsEnabled");
pa.isHostFrameTrustCheckEnabledForAddIns=gb.AFrameworkApplication.ga.ra("HostFrameTrustCheckIsEnabledForAddIns");pa.isHostFrameTrusted=gb.AFrameworkApplication.isHostFrameTrusted;pa.agaveAddinUploadEnabled=tb.EwaSettings.ma(47);pa.hostAllowedOfficeStore=gb.AFrameworkApplication.ga.ra("HostAllowedOfficeStore");pa.hostAllowedSdxEmbedding=gb.AFrameworkApplication.ga.ra("HostAllowedSdxEmbedding");pa.hostInstallAddIns=gb.AFrameworkApplication.ga.Va("HostInstallAddIns");pa.hostInstallAddInsIsEnabled=gb.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled");
pa.approvedAddIns=gb.AFrameworkApplication.ga.Va("ApprovedAddIns");pa.addinEnforceHttpsIsEnabled=this.Bwj(pa.sessionStartInfoJson);pa.hostFeatureGateFlag=ld;pa.isUpnCheckEnabled=gb.AFrameworkApplication.ga.ra("IsUpnCheckEnabled");pa.wacUpn=gb.AFrameworkApplication.ga.Va("UserPrincipalName");pa.isReactRibbonEnabled=Jc.a.isReactRibbonEnabled();pa.enableSetFocusOnTaskpaneOnUserAction=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);pa.isSafariWithIndexedDBDisabled=
tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&wb.a.jNa;pa.isIndexedDBDisabled=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&wb.a.jNa||tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&wb.a.Hf;pa.enableCustomShortcuts=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");pa.changeGetModifierKeyStringOutputOrder=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
this.zm=new OSF.ContextActivationManager(pa);pa={};this.zm.setIframeAttributeBag((pa.frameborder=0,pa.marginheight=0,pa.marginwidth=0,pa));this.zm.setWSA(gb.AFrameworkApplication.$m);this.zm&&"undefined"!==typeof this.zm.hostCheckReadyHandler&&gb.AFrameworkApplication.ZFg(Object(ta.a)(this.zm,this.zm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var Vc=ec.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.zm.setOAuthManager(Vc)}catch(Se){}}return this.zm}},BXj:{configurable:!0,enumerable:!0,
get:function(){return this.ITc}},ij:{configurable:!0,enumerable:!0,get:function(){return this.nge}},tna:{configurable:!0,enumerable:!0,get:function(){return this.kge}},NMd:{configurable:!0,enumerable:!0,get:function(){return this.oge}},MMd:{configurable:!0,enumerable:!0,get:function(){return this.mge}},ejj:{configurable:!0,enumerable:!0,get:function(){return this.qge}},cjj:{configurable:!0,enumerable:!0,get:function(){return this.lge}},djj:{configurable:!0,enumerable:!0,get:function(){return this.pge}},
fjj:{configurable:!0,enumerable:!0,get:function(){return this.rge}},gjj:{configurable:!0,enumerable:!0,get:function(){return this.sge}},OMd:{configurable:!0,enumerable:!0,get:function(){return this.tge}},kW:{configurable:!0,enumerable:!0,get:function(){return this.drg}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Ck.Object.defineProperties(a,{j3c:{configurable:!0,enumerable:!0,get:function(){return a.n5d},set:function(pa){a.n5d=pa}}});a.y1a=new lc.a;a.n5d=!0;Object(sb.a)(a,
"DdaFacade",Fb.a,[497,798,794,799,800,2])},951:function(z,E,b){function a(){this.dJd=0;this.pX={};this.vta={}}b.d(E,"a",function(){return a});z=b(0);var c=b(14),e=b(112);a.prototype.lVh=function(f,m){return this.pX[a.AZc(f,m)]};a.prototype.ZLe=function(f,m){m||void 0!==this.vta[f]&&null!==this.vta[f]?m&&void 0!==this.vta[f]&&null!==this.vta[f]&&delete this.vta[f]:this.vta[f]=1};a.prototype.g0b=function(f){return void 0===this.vta[f]||null===this.vta[f]};a.prototype.O3h=function(f){var m=a.AZc(f.messageType,
f.targetId);1===f.actionType?this.g5h(f.controlId,f.messageType,m):2===f.actionType&&this.Q5h(f.controlId,f.messageType,m)};a.prototype.laj=function(f){if(f){var m=Object.keys(this.pX);if(!(void 0===m||null===m||0>=m.length)){m=Cl(m);for(var n=m.next();!n.done;n=m.next()){n=n.value;var w=this.pX[n];w[f]&&(delete w[f],Object.keys(w).length||delete this.pX[n])}}}};a.prototype.C_=function(f,m){f=a.AZc(f,m);f=this.pX[f];return!!f&&0<Object.keys(f).length};a.prototype.F6h=function(){return!e.a.isEmpty(this.pX)};
a.prototype.tif=function(){return 0<this.dJd};a.prototype.EPh=function(){var f=[],m=this.pX,n;for(n in m){var w=n,h=m[n],y;for(y in h){h=y;var r={};r.eventType=parseInt(w.split("#")[0],10);r.targetId=w.split("#")[1];r.addinId=h;f.push(r)}}return f};a.prototype.g5h=function(f,m,n){if(this.pX[n])n=this.pX[n],n[f]=n[f]?n[f]+1:1;else{var w={};w[f]=1;this.pX[n]=w}100===m&&this.dJd++};a.prototype.Q5h=function(f,m,n){if(this.pX[n]){var w=this.pX[n];if(f){var h=w[f];1===h?(delete w[f],Object.keys(w).length||
delete this.pX[n]):w[f]=h-1;100===m&&this.dJd--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",f,n)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",n)};a.AZc=function(f,m){return String.format("{0}#{1}",f,m)};a.BX="Workbook";Object(z.a)(a,"RichApiEventRegistration",null,[])},975:function(z,E,b){function a(c,e,f,m){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=
c;this.controlId=e;this.ddaBinding=f;this.ArrayData=void 0===m?null:m}b.d(E,"a",function(){return a});z=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(z.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/d444f90aa384933990bf0d92b7cd473d/EwaDS.agave.js.map