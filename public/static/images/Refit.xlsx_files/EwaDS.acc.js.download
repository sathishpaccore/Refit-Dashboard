(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1438:function(z,E,b){function a(V){var ya=di.call(this)||this;ya.$=V;ya.Tb();return ya}function c(V,ya){var lb=Fi.call(this)||this;lb.$ob=function(Kb,Lb){Kb=Lb.u5;var Xa=lb.gridView;Lb=Lb.i8h;var od=Lb.Of,Yd=Lb.H$;Da.a.Fh&&Yd.push(new B(od,Xa));switch(Kb){case 24:Lb.H$.push(new t(od,Lb));break;case 0:Lb.H$.push(new v(od,Xa));Da.a.xp||(De.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
(Yd.push(new A(od,lb.gridView.$,Lb.paneType,lb.tableManager,lb.so)),De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Array.add(Yd,new C(od,lb.gridView.$,Lb.paneType,lb.tableManager,lb.so))):Yd.push(new T(od,lb.gridView.$,Lb.paneType,lb.tableManager,lb.so)));Yd.push(new e(Lb,od,Xa,Lb.paneType));break;case 3:Yd.push(new I(od));Da.a.xp||(Yd.push(new ea(od,lb.gridView.$,Lb.paneType,lb.yy,lb.so,Lb)),Yd.push(new h(od,lb.gridView,lb.yy,lb.so,Lb)),Yd.push(new w(od,
lb.gridView,lb.yy,lb.so,Lb)));break;case 4:case 5:Yd.push(new n(od));break;case 30:Yd.push(new m(od));break;case 16:Yd.push(new f(od));Yd.push(new x(Lb,od,Xa,Lb.paneType));break;case 11:case 12:Yd.push(new r(od,11===Kb));break;case 17:Yd.push(new I(od));break;case 19:Yd.push(new I(od)),Yd.push(new H(Lb,od,Xa,Lb.paneType))}Lb.T0b=!0};lb.$=V;lb.gridView=Kf.g(V);lb.tableManager=ya;lb.yy=new u(lb.gridView);lb.so=new aa(lb.gridView);lb.gridView.Cb&&(lb.gridView.Cb.OFg(lb.$ob),lb.gridView.Cb.update(!1));
V.da.Ga(64,lb);return lb}function e(V,ya,lb,Kb){return L.call(this,V,ya,lb,Kb)||this}function f(V){var ya=fa.call(this,V)||this;f.Urb(V,G.a.Dxh+" "+Wc.a.Rua);f.Urb(V,G.a.Cxh+" "+Wc.a.Rua);f.Urb(V,G.a.zxh+" "+Wc.a.Rua);f.Urb(V,G.a.Bxh+" "+Wc.a.Rua);f.Urb(V,Wc.a.Axh);return ya}function m(V){var ya=fa.call(this,V)||this;appChrome.renderSpinner(V);return ya}function n(V){var ya=fa.call(this,V)||this;n.Erb(V,G.a.cxh+" "+Wc.a.Rua);n.Erb(V,G.a.bxh+" "+Wc.a.Rua);n.Erb(V,G.a.Zwh+" "+Wc.a.Rua);n.Erb(V,G.a.axh+
" "+Wc.a.Rua);n.Erb(V,Wc.a.$wh);return ya}function w(V,ya,lb,Kb,Lb){var Xa=y.call(this,V,ya,lb,Kb,Lb)||this;Xa.PEb=function(){var od=3===Ud.a.Vb;Xa.rtd&&!od?Xa.so.WKb(Xa.Aba,Xa.sL,!1):!Xa.rtd&&od&&Xa.so.WKb(Xa.Aba,Xa.sL,!0);Xa.rtd=od};Xa.CRi=function(od,Yd){Yd.ryb===Xa.Aba.aaa&&Xa.so.WKb(Xa.Aba,Xa.sL,!Yd.start&&Xa.jSd())};Ud.a.Eoe(Xa.PEb);Xa.rtd=3===Ud.a.Vb;Xa.so.qGg(Xa.CRi);return Xa}function h(V,ya,lb,Kb,Lb){return y.call(this,V,ya,lb,Kb,Lb)||this}function y(V,ya,lb,Kb,Lb){var Xa=fa.call(this,V)||
this;Xa.wL=null;Xa.Ya=null;Xa.a4=0;Xa.sourceRange=null;Xa.Jb=null;Xa.iTa=!1;Xa.onPointerDown=function(od){od=Zf.a(Xa.$).qe(od);if(Xa.M2f(od)&&!Xa.iTa){Xa.Lnf();Xa.Ya=Xa.so.Edd();Xa.wL=Xa.so.n3e(od);if(!Xa.Ya||!Xa.wL||!Xa.wL.range)return Rb.ULS.shipAssertTag(537159361,0,!!Xa.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Rb.ULS.shipAssertTag(537159360,0,!!Xa.wL,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Rb.ULS.shipAssertTag(537159331,0,!!Xa.wL.range,
"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;Xa.Jb=Xa.wL.range.clone();Xa.sourceRange=Xa.Jb.clone();Xa.a4=Xa.t_e(od);if(4===Xa.a4)return Rb.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var Yd=Xa.e1e(od,!0);if(!Yd)return Rb.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!Xa.hFe(Yd))return Rb.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;Xa.gridView.YLa=!0;Xa.Ya.eH(!1);Xa.yy.CKe(od.Mb);Xa.so.ILf(!0,Xa.Aba.aaa);Xa.Ya.textBox.removeSelection();Xa.Ya.LZb(Xa.V6e);Xa.ZOf();Xa.iTa=!0;Di.b(Xa.$,!0)}return!0};Xa.V6e=function(){Xa.r$b(!0)};Xa.gridView=ya;Xa.$=ya.$;Xa.sL=[];Xa.ha=Xa.gridView.ha;Xa.yy=lb;Xa.so=Kb;Xa.Aba=Lb;Xa.coloredReferencesManager=Xa.$.da.Aa(281);Rb.ULS.shipAssertTag(537159362,0,!!Xa.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
ya=Cl(Xa.$Tf());for(lb=ya.next();!lb.done;lb=ya.next())lb=Xa.so.wEe(V,lb.value,Xa.Fpe(),Xa.onPointerDown),Xa.sL.push(lb);V=Cl(Xa.sL);for(ya=V.next();!ya.done;ya=V.next())ya=ya.value,eg.a.instance.pa(lf.a.dX,ya,Object(Re.a)(Xa.yy,Xa.yy.a$e,"hoveringStarted")),eg.a.instance.pa(lf.a.Iy,ya,Object(Re.a)(Xa.yy,Xa.yy.b$e,"hoveringStopped"));Xa.uZa(Lb);return Xa}function r(V,ya){var lb=fa.call(this,V)||this;var Kb=document.createElement("div"),Lb=document.createElement("div");Kb.className=ya?ca.Fxh:ca.Hxh;
Lb.className=ya?ca.Gxh:ca.Exh;V.appendChild(Kb);V.appendChild(Lb);return lb}function x(V,ya,lb,Kb){return L.call(this,V,ya,lb,Kb)||this}function t(V,ya){var lb=fa.call(this,V)||this;lb.HBf=function(){if(!lb.sv)return Rb.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;lb.sv.ZLf(lb.PH,!1);lb.sv.sMe(lb.PH,!1);if(3===lb.sv.model.state)return!0;lb.sv.X9e(!0);return!0};lb.Sca=function(){if(!lb.sv)return!1;lb.sv.m4i();lb.sv.VLd(lb.PH,
!1);if(3===lb.sv.model.state)return!0;lb.sv.X9e(!1);return!0};lb.onPointerDown=function(Kb){return lb.sv?2===Kb.yb&&Kb.Vn===Sys.UI.MouseButton.leftButton?!0:!1:!1};lb.UEb=function(){if(!lb.sv)return!1;lb.sv.VLd(lb.PH,!0);lb.sv.ZLf(lb.PH,!0);lb.sv.sMe(lb.PH,!0);lb.sv.$Jb(!0);return!0};lb.onDoubleClick=function(Kb){if(Kb.Ca)return Kb.Ca.stopPropagation(),!0;Rb.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};lb.sv=Object(Xf.a)(fi.a,
ya.metadata);lb.rK=document.createElement("div");lb.rK.id=String.format("{0}-{1}",V.id,$d.a.Xxe);lb.rK.className=qh.a.YVg;lb.PH=document.createElement("div");lb.PH.id=String.format("{0}-{1}",V.id,$d.a.c0c);lb.PH.className=qh.a.c0c;lb.rK.appendChild(lb.PH);V.appendChild(lb.rK);Rb.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");eg.a.instance.pa(lf.a.dX,lb.rK,lb.HBf);eg.a.instance.pa(lf.a.Iy,lb.rK,
lb.Sca);eg.a.instance.pa(lf.a.pointerDown,lb.rK,lb.onPointerDown);zh.a.instance.pa(lf.a.click,lb.rK,lb.UEb);zh.a.instance.pa(lf.a.jk,lb.rK,lb.onDoubleClick);return lb}function u(V){var ya=this;this.wh=function(){ya.Spd=!1};this.Fp=function(){ya.Spd=!0};this.gridView=V;this.R5a=0;this.Spd=this.ihc=!1;this.i6=Number.NaN;this.gridView.ha.k3(this.Fp);this.gridView.ha.aZ(this.wh);this.gridView.ha.$Zb(this.wh)}function B(V,ya){var lb=fa.call(this,V)||this;lb.wSi=function(Kb){var Lb=wg.HelperMethods.Km(Kb),
Xa=lb.cwa.X_d(Kb.clientPoint);if(!Xa)return!1;var od=Xa.tf,Yd=lb.cwa.Ea.$vb(od.hashCode).yva(Xa.cJ);if(!Yd)return!1;Kb=od.zj.domElement;Xa=wg.HelperMethods.ene(wg.HelperMethods.QKa(od.domElement,Kb),Xa.cJ);od=0;Yd=lb.cwa.mc(Yd.getRange());for(var ke=0,Yf=B.lye.length;ke<Yf;++ke){var Tf=B.lye[ke];if(128!==Tf&&64!==Tf||!lb.cwa.$.isEditMode){var Kg=Yd.LKa(Tf);if(Kg&&Kg.o6a&&"none"!==Kg.o6a.style.display){Kg=Kg.o6a;var Og=wg.HelperMethods.QKa(Kg,Kb);Kg=new Sys.UI.Bounds(Og.x,Og.y,Kg.offsetWidth,Kg.offsetHeight);
if(qb.a.yB(Kg,Xa)){od=Tf;break}}}}return 0!==od?(Yd.invoke(od,Lb),!0):!1};lb.gqg=ya;Jb.a.instance.pa(lf.a.click,V,lb.wSi);return lb}function v(V,ya){var lb=I.call(this,V)||this;lb.wh=function(){lb.domElement.classList.remove(ca.selecting);jb.c(lb.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};lb.Fp=function(){lb.domElement.classList.add(ca.selecting)};lb.onPointerDown=function(Kb){2===Kb.yb&&Kb.Vn===Sys.UI.MouseButton.leftButton&&(lb.gridView.ha.selectionType=4,lb.gridView.ha.sourceRange=
lb.gridView.ha.ta.ud,jb.c(lb.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};lb.Oca=function(){lb.gridView.$.Zd(1983983164,2,30,null);return!0};lb.zd=function(){le.DOMElementExtensions.setVisible(lb.Uaa,lb.gridView.$.isEditMode)};lb.Z6=function(){le.DOMElementExtensions.setVisible(lb.Uaa,!1)};lb.Y6=function(){le.DOMElementExtensions.setVisible(lb.Uaa,!0)};lb.azf=function(){le.DOMElementExtensions.setVisible(lb.Uaa,!1)};lb.$yf=function(){le.DOMElementExtensions.setVisible(lb.Uaa,
!0)};lb.pEb=function(Kb,Lb){le.DOMElementExtensions.setVisible(lb.Uaa,!Lb.yle)};lb.gridView=ya;ya=document.createElement("div");ya.className=Wc.a.xxh;lb.Uaa=ya;lb.zd(null,null);V.appendChild(ya);eg.a.instance.pa(lf.a.pointerDown,lb.Uaa,lb.onPointerDown);Jb.a.instance.pa(lf.a.jk,lb.Uaa,lb.Oca);lb.gridView.ha.k3(lb.Fp);lb.gridView.ha.aZ(lb.wh);lb.gridView.$.tl(lb.zd);lb.gridView.$.zb.h_b(lb.Z6);lb.gridView.$.zb.g_b(lb.Y6);lb.gridView.Zne(lb.pEb);lb.gridView.Ac.sl(lb.azf);lb.gridView.Ac.To(lb.$yf);return lb}
function C(V,ya,lb,Kb,Lb){var Xa=M.call(this,V,ya,lb,Lb)||this;Xa.rPa=function(){Xa.jq&&Xa.hta(!0)};Xa.aL=function(od){Zf.a(Xa.$).qe(od);Xa.jq=!1;Xa.Cb.Xh(Xa.Nh);Xa.ha.sourceRange=Xa.sourceRange.clone();Xa.zL();Xa.Ys(Xa.$K,Xa.aL);Xa.pj=-1;return!0};Xa.$K=function(od){od=Zf.a(Xa.$).qe(od);var Yd=od.clientPoint;Xa.Zw=od;if(od=Xa.ha.Xn(Yd,od.Mb,5,void 0,void 0,!0)){Xa.beg(od,Xa.isRow,Yd);if(Xa.isRow||Xa.ff)Xa.Jb=Xa.O$(od);Xa.ha.sourceRange=Xa.Jb;Xa.Cb.vj(Xa.Jb,Xa.Nh);Xa.Cb.Gn(Xa.Nh);Xa.Cb.Xh(Xa.nB());
Xa.QB()}return!0};Xa.tableManager=Kb;Xa.ha.$Zb(Xa.rPa);return Xa}function A(V,ya,lb,Kb,Lb){var Xa=M.call(this,V,ya,lb,Lb)||this;Xa.dA=null;Xa.Rq=!1;Xa.Qq=!1;Xa.hBb=0;Xa.PM=null;Xa.QO=null;Xa.Qn=0;Xa.Ria=bf.a.instance.fa(2210);Xa.$sb=bf.a.instance.fa(2211);Xa.doa=bf.a.instance.fa(2212);Xa.rLb=bf.a.instance.fa(2213);Xa.Xud=De.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");Xa.onKeyDown=function(od){if(Xa.Yh){if(Xa.Uka(od)||od.Ca.keyCode===md.a.afa)return Xa.VMa||(vh.KeyInputManager.instance.pa(lf.a.Sd,
Xa.domElement.ownerDocument.body,Xa.onKeyUp),Xa.VMa=!0),!Xa.ju&&Xa.Uka(od)&&(Kf.g(Xa.$).rg.No(A.urb),Xa.ju=!0),Xa.ku||od.Ca.keyCode!==md.a.afa||(Kf.g(Xa.$).rg.No(Z.k2a),Xa.ku=!0,2===Xa.Qn?(Xa.hH(!1),Xa.KE=0,Xa.Nh=Xa.Qq?[11]:[12],Xa.Rq=Xa.Qq,Xa.EQa(),Xa.TL()):3===Xa.Qn?(Xa.G3(!1),Xa.KE=Xa.isRow?1:2,Xa.x7(),Xa.PD()):1===Xa.Qn&&(Xa.hta(!1),Xa.x7(),Xa.PD())),!0}else if(!Xa.ju&&(od.Ca.keyCode===md.a.H8||Da.a.isMac&&od.Ca.keyCode===md.a.epa))return vh.KeyInputManager.instance.pa(lf.a.Sd,Xa.domElement.ownerDocument.body,
Xa.onKeyUp),Kf.g(Xa.$).rg.No(A.urb),Xa.ju=!0;return!1};Xa.onKeyUp=function(od){if(Xa.Yh){if(Xa.Uka(od)||od.Ca.keyCode===md.a.afa)return Xa.hBb=Xa.Uka(od)?0:1,Xa.jq&&Kf.g(Xa.$).rg.No(Z.k2a),od.Ca.keyCode===md.a.afa&&(2===Xa.Qn?(Xa.G3(!1),Xa.KE=0,Xa.x7(!0),Xa.PD(!0)):3===Xa.Qn?(Xa.hH(!1),Xa.KE=Xa.isRow?1:2,Xa.Nh=Xa.isRow?[11]:[12],Xa.EQa(!0),Xa.TL(!0)):1===Xa.Qn&&(Xa.hH(!1),Xa.Nh=Xa.Qq?[11]:[12],Xa.KHb(!0),Xa.TL(!0))),Xa.Woa(Xa.hBb),!0}else if(od.Ca.keyCode===md.a.H8||Da.a.isMac&&od.Ca.keyCode===md.a.epa)return Xa.Woa(),
Xa.jq&&Kf.g(Xa.$).rg.No(Z.K7c),!0;return!1};Xa.aL=function(od){od=Zf.a(Xa.$).qe(od);5===Xa.pj?Xa.pCd(od):(Xa.jq=!1,Xa.Cb.Xh(Xa.Nh),!Xa.$.Dq([Xa.Jb],!1)||Xa.ZHd()||Xa.bAb()||(Xa.ha.sourceRange=Xa.sourceRange.clone(),Xa.Yh?Xa.DGd():Xa.bub(),Xa.uy()?Xa.Jb.top>Xa.sourceRange.top&&(od=Xa.Jb.height,Xa.Jb.top-=od,Xa.Jb.bottom-=od):Xa.Jb.left>Xa.sourceRange.left&&(od=Xa.Jb.width,Xa.Jb.left-=od,Xa.Jb.right-=od),Xa.zL()),Xa.Xud&&Xa.Wud());Xa.Ys(Xa.$K,Xa.aL);Xa.tableRange=null;Xa.pj=-1;Xa.Yh&&(Xa.dA=null,Xa.Qn=
0);return!0};Xa.U6=function(){Xa.jq=!1;Xa.Qn=0;Xa.Cb.Xh(Xa.Nh);if(!Xa.$.Dq([Xa.Jb],!1))return Xa.Ys(Xa.T6,Xa.U6),Xa.pj=-1,!0;if(!(Xa.ha.ta.ud.equals(Xa.Jb)||Xa.Oka(Xa.Jb)||Xa.Oka(Xa.sourceRange)||Xa.bAb())){Xa.zL();Xa.ha.sourceRange=Xa.sourceRange.clone();var od=Xa.ha.sourceRange,Yd=Xa.ha.ta.ud,ke={};Xa.$.Zd(-694765314,2,30,(ke[$d.a.uua]=Xa.ju,ke[$d.a.J7b]=!0,ke[$d.a.K7b]=Xa.Rq,ke[$d.a.s4]=od,ke[$d.a.r4]=Yd,ke[$d.a.Xsb]=Xa.ku,ke));Xa.ju||(Xa.Jb.top>Xa.sourceRange.top&&(Xa.isRow||Xa.Jb.left===Xa.sourceRange.left&&
Xa.Rq)?(od=Xa.Jb.height,Xa.Jb.top-=od,Xa.Jb.bottom-=od):Xa.Jb.left>Xa.sourceRange.left&&(Xa.ff||Xa.Jb.top===Xa.sourceRange.top&&!Xa.Rq)&&(od=Xa.Jb.width,Xa.Jb.left-=od,Xa.Jb.right-=od),Xa.zL())}Xa.Ys(Xa.T6,Xa.U6);Xa.tableRange=null;Xa.dA=null;Xa.pj=-1;Xa.Rq=!1;Xa.Xud&&Xa.Wud();return!0};Xa.$K=function(od){var Yd=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Yd&&(od=Zf.a(Xa.$).qe(od));var ke=od.clientPoint;Yd||(od=Zf.a(Xa.$).qe(od));Xa.Yh&&(Xa.Zw=od);if(od=
Xa.ha.Xn(ke,od.Mb,5,void 0,void 0,!0)){if(Xa.tableRange.contains(od.topLeft)){if(Xa.beg(od,Xa.uy(),ke),Xa.Jb=Xa.O$(od),Xa.ha.sourceRange=Xa.Jb,Xa.Cb.vj(Xa.Jb,Xa.Nh),Xa.Cb.Gn(Xa.Nh),Xa.Cb.Xh(Xa.nB()),6!==Xa.pj){for(ke=1;4>=ke;ke++)od=Xa.Uh[ke.toString()],od.parentNode.removeChild(od),Xa.Cb.Jw(Xa.uy()?11:12,ke).Of.appendChild(od);Xa.pj=6}}else if(Xa.Jb=Xa.aia(od),Xa.Yh)Xa.axb(!1);else if(Xa.Cb.vj(Xa.Jb,Xa.nB()),Xa.Cb.Gn(Xa.nB()),Xa.Cb.Xh(Xa.Nh),5!==Xa.pj){for(ke=1;4>=ke;ke++)od=Xa.Uh[ke.toString()],
od.parentNode.removeChild(od),Xa.Cb.Jw(Xa.Qja(),ke).Of.appendChild(od);Xa.pj=5}Xa.QB()}return!0};Xa.T6=function(od){var Yd=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Yd&&(od=Zf.a(Xa.$).qe(od));var ke=od.clientPoint;Yd||(od=Zf.a(Xa.$).qe(od));Xa.Zw=od;if(Yd=Xa.ha.Xn(ke,od.Mb,5,void 0,void 0,!0)){if(Xa.oxb(Yd))return Xa.Jb=Xa.aia(Yd),Xa.$wb(!1),!0;var Yf=Kf.g(Xa.$),Tf=Yf.qg(Yd),Kg=Yf.Tf(Xa.paneType);ke=Ng.a.Es(Kg.view.Pg,Xa.domElement.parentNode,ke,Yf.rtl);
Kg=!1;var Og=2;Xa.Rq=!1;if(Xa.isRow||Xa.ff){Xa.isRow&&ke.y-Tf.topLeft.y>Tf.height/2?(Kg=!0,Og=1):Xa.ff&&ke.x-Tf.topLeft.x>Tf.width/2&&(Kg=!0);if(Kg){od=Yf.wk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",Yf.yH,Og);try{od.us(Yd),od.$$mn(),Yd=od.$$cu().range}finally{od&&od.dispose()}}Xa.Jb=Xa.aia(Yd)}else{ke.x-Tf.topLeft.x===Tf.width?(Xa.Rq=!1,Kg=!0):ke.y-Tf.topLeft.y>Tf.height/2&&(Kg=!0,Xa.Rq=!0,Og=1);Xa.dA&&(Xa.Rq=Xa.Qq);if(Kg){Yf=Yf.wk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",
Yf.yH,Og);try{Yf.us(Yd),Yf.$$mn(),Yd=Yf.$$cu().range}finally{Yf&&Yf.dispose()}}Xa.Cb.Xh(Xa.Nh);Xa.Nh=Xa.Rq?[11]:[12];for(Yf=1;4>=Yf;Yf++)(Tf=Xa.Uh[Yf.toString()])&&Tf.parentNode.removeChild(Tf),Xa.Uh[Yf.toString()]=null;Xa.PB(od.clientPoint,od.Mb,Xa.Rq?11:12,!0);Xa.Jb=Xa.O$(Yd)}Xa.ha.sourceRange=Xa.Jb;Xa.Cb.vj(Xa.Jb,Xa.Nh);Xa.Cb.Gn(Xa.Nh);Xa.Cb.Xh(Xa.nB());if(6!==Xa.pj){for(od=1;4>=od;od++)Yd=Xa.Uh[od.toString()],Yd.parentNode.removeChild(Yd),Xa.Cb.Jw(Xa.isRow||Xa.Rq?11:12,od).Of.appendChild(Yd);
Xa.pj=6}Xa.QB()}return!0};Xa.rPa=function(){Xa.Yh?Xa.jq&&5<=Xa.pj&&(Xa.tableRange?Xa.ku?Xa.hH(!0):Xa.hta(!0):Xa.ku?Xa.isRow||Xa.ff?Xa.hH(!0):Xa.G3(!0):Xa.isRow||Xa.ff?Xa.G3(!0):Xa.hH(!0)):Xa.jq&&5<=Xa.pj&&(Xa.tableRange?(Xa.Cb.Xh(Xa.Nh),Xa.Ys(Xa.$K,Xa.aL)):(Xa.Cb.Xh(Xa.nB()),Xa.Ys(Object(Re.a)(Xa,Xa.Sh,"onPointerMove"),Object(Re.a)(Xa,Xa.Pf,"onPointerUp"))))};Xa.tableManager=Kb;Xa.tableRange=null;Xa.ku=!1;Xa.ju=!1;Xa.VMa=!1;Xa.ha.$Zb(Xa.rPa);return Xa}function M(V,ya,lb,Kb){var Lb=Z.call(this,V,ya,
lb,Kb)||this;Lb.Nh=null;Lb.isRow=!1;Lb.ff=!1;Lb.wh=function(){Lb.domElement.classList.remove(ca.selecting)};Lb.Fp=function(){Lb.domElement.classList.add(ca.selecting)};Lb.kd=function(){if(Lb.$.isEditMode){var Xa=Lb.Vxc();Lb.Awc(Xa)}};Lb.Uh={};Lb.jq=!1;Lb.ha.k3(Lb.Fp);Lb.ha.aZ(Lb.wh);Lb.ha.sE(Lb.kd);return Lb}function T(V,ya,lb,Kb,Lb){var Xa=Z.call(this,V,ya,lb,Lb)||this;Xa.Ria=bf.a.instance.fa(2210);Xa.$sb=bf.a.instance.fa(2211);Xa.doa=bf.a.instance.fa(2212);Xa.rLb=bf.a.instance.fa(2213);Xa.Nh=null;
Xa.dA=null;Xa.Rq=!1;Xa.isRow=!1;Xa.ff=!1;Xa.Qq=!1;Xa.PM=null;Xa.QO=null;Xa.hBb=0;Xa.Qn=0;Xa.onKeyDown=function(od){if(Xa.Yh){if(Xa.Uka(od)||od.Ca.keyCode===md.a.afa)return Xa.VMa||(vh.KeyInputManager.instance.pa(lf.a.Sd,Xa.domElement.ownerDocument.body,Xa.onKeyUp),Xa.VMa=!0),!Xa.ju&&Xa.Uka(od)&&(Kf.g(Xa.$).rg.No(T.urb),Xa.ju=!0),Xa.ku||od.Ca.keyCode!==md.a.afa||(Kf.g(Xa.$).rg.No(Z.k2a),Xa.ku=!0,2===Xa.Qn?(Xa.hH(!1),Xa.KE=0,Xa.Nh=Xa.Qq?[11]:[12],Xa.Rq=Xa.Qq,Xa.EQa(),Xa.TL()):3===Xa.Qn?(Xa.G3(!1),Xa.KE=
Xa.isRow?1:2,Xa.x7(),Xa.PD()):1===Xa.Qn&&(Xa.hta(!1),Xa.x7(),Xa.PD())),!0}else if(!Xa.ju&&(od.Ca.keyCode===md.a.H8||Da.a.isMac&&od.Ca.keyCode===md.a.epa))return vh.KeyInputManager.instance.pa(lf.a.Sd,Xa.domElement.ownerDocument.body,Xa.onKeyUp),Kf.g(Xa.$).rg.No(T.urb),Xa.ju=!0;return!1};Xa.onKeyUp=function(od){if(Xa.Yh){if(Xa.Uka(od)||od.Ca.keyCode===md.a.afa)return Xa.hBb=Xa.Uka(od)?0:1,Xa.jq&&Kf.g(Xa.$).rg.No(Z.k2a),od.Ca.keyCode===md.a.afa&&(2===Xa.Qn?(Xa.G3(!1),Xa.KE=0,Xa.x7(!0),Xa.PD(!0)):3===
Xa.Qn?(Xa.hH(!1),Xa.KE=Xa.isRow?1:2,Xa.Nh=Xa.isRow?[11]:[12],Xa.EQa(!0),Xa.TL(!0)):1===Xa.Qn&&(Xa.hH(!1),Xa.Nh=Xa.Qq?[11]:[12],Xa.KHb(!0),Xa.TL(!0))),Xa.Woa(Xa.hBb),!0}else if(od.Ca.keyCode===md.a.H8||Da.a.isMac&&od.Ca.keyCode===md.a.epa)return Xa.Woa(),Xa.jq&&Kf.g(Xa.$).rg.No(Z.K7c),!0;return!1};Xa.aL=function(od){od=Zf.a(Xa.$).qe(od);5===Xa.pj?Xa.pCd(od):(Xa.jq=!1,Xa.Cb.Xh(Xa.Nh),!Xa.$.Dq([Xa.Jb],!1)||Xa.ZHd()||Xa.bAb()||(Xa.ha.sourceRange=Xa.sourceRange.clone(),Xa.Yh?Xa.DGd():Xa.bub(),Xa.uy()?
Xa.Jb.top>Xa.sourceRange.top&&(od=Xa.Jb.height,Xa.Jb.top-=od,Xa.Jb.bottom-=od):Xa.Jb.left>Xa.sourceRange.left&&(od=Xa.Jb.width,Xa.Jb.left-=od,Xa.Jb.right-=od),Xa.zL()));Xa.Ys(Xa.$K,Xa.aL);Xa.tableRange=null;Xa.pj=-1;Xa.Yh&&(Xa.dA=null,Xa.Qn=0);return!0};Xa.U6=function(){Xa.jq=!1;Xa.Qn=0;Xa.Cb.Xh(Xa.Nh);if(!Xa.$.Dq([Xa.Jb],!1))return Xa.Ys(Xa.T6,Xa.U6),Xa.pj=-1,!0;if(!(Xa.ha.ta.ud.equals(Xa.Jb)||Xa.Oka(Xa.Jb)||Xa.Oka(Xa.sourceRange)||Xa.bAb())){Xa.zL();Xa.ha.sourceRange=Xa.sourceRange.clone();var od=
Xa.ha.sourceRange,Yd=Xa.ha.ta.ud,ke={};Xa.$.Zd(-694765314,2,30,(ke[$d.a.uua]=Xa.ju,ke[$d.a.J7b]=!0,ke[$d.a.K7b]=Xa.Rq,ke[$d.a.s4]=od,ke[$d.a.r4]=Yd,ke[$d.a.Xsb]=Xa.ku,ke));Xa.ju||(Xa.Jb.top>Xa.sourceRange.top&&(Xa.isRow||Xa.Jb.left===Xa.sourceRange.left&&Xa.Rq)?(od=Xa.Jb.height,Xa.Jb.top-=od,Xa.Jb.bottom-=od):Xa.Jb.left>Xa.sourceRange.left&&(Xa.ff||Xa.Jb.top===Xa.sourceRange.top&&!Xa.Rq)&&(od=Xa.Jb.width,Xa.Jb.left-=od,Xa.Jb.right-=od),Xa.zL())}Xa.Ys(Xa.T6,Xa.U6);Xa.tableRange=null;Xa.dA=null;Xa.pj=
-1;Xa.Rq=!1;return!0};Xa.$K=function(od){var Yd=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Yd&&(od=Zf.a(Xa.$).qe(od));var ke=od.clientPoint;Yd||(od=Zf.a(Xa.$).qe(od));Xa.Yh&&(Xa.Zw=od);if(od=Xa.ha.Xn(ke,od.Mb,5,void 0,void 0,!0)){if(Xa.tableRange.contains(od.topLeft)){Yd=Kf.g(Xa.$);var Yf=Yd.qg(od),Tf=Yd.Tf(Xa.paneType);ke=Ng.a.Es(Tf.view.Pg,Xa.domElement.parentNode,ke,Yd.rtl);Tf=!1;var Kg=2;Xa.uy()&&ke.y-Yf.topLeft.y>Yf.height/2?(Tf=!0,Kg=1):!Xa.uy()&&
ke.x-Yf.topLeft.x>Yf.width/2&&(Tf=!0);if(Tf){Yd=Yd.wk("DragSelectionClickBehavior.OnPointerMoveRearrange",Yd.yH,Kg);try{Yd.us(od),Yd.$$mn(),od=Yd.$$cu().range}finally{Yd&&Yd.dispose()}}Xa.Jb=Xa.O$(od);Xa.ha.sourceRange=Xa.Jb;Xa.Cb.vj(Xa.Jb,Xa.Nh);Xa.Cb.Gn(Xa.Nh);Xa.Cb.Xh(Xa.nB());if(6!==Xa.pj){for(od=1;4>=od;od++)Yd=Xa.Uh[od.toString()],Yd.parentNode.removeChild(Yd),Xa.Cb.Jw(Xa.uy()?11:12,od).Of.appendChild(Yd);Xa.pj=6}}else if(Xa.Jb=Xa.aia(od),Xa.Yh)Xa.axb(!1);else if(Xa.Cb.vj(Xa.Jb,Xa.nB()),Xa.Cb.Gn(Xa.nB()),
Xa.Cb.Xh(Xa.Nh),5!==Xa.pj){for(od=1;4>=od;od++)Yd=Xa.Uh[od.toString()],Yd.parentNode.removeChild(Yd),Xa.Cb.Jw(Xa.Qja(),od).Of.appendChild(Yd);Xa.pj=5}Xa.QB()}return!0};Xa.T6=function(od){var Yd=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Yd&&(od=Zf.a(Xa.$).qe(od));var ke=od.clientPoint;Yd||(od=Zf.a(Xa.$).qe(od));Xa.Zw=od;if(Yd=Xa.ha.Xn(ke,od.Mb,5,void 0,void 0,!0)){if(Xa.oxb(Yd))return Xa.Jb=Xa.aia(Yd),Xa.$wb(!1),!0;var Yf=Kf.g(Xa.$),Tf=Yf.qg(Yd),Kg=Yf.Tf(Xa.paneType);
ke=Ng.a.Es(Kg.view.Pg,Xa.domElement.parentNode,ke,Yf.rtl);Kg=!1;var Og=2;Xa.Rq=!1;if(Xa.isRow||Xa.ff){Xa.isRow&&ke.y-Tf.topLeft.y>Tf.height/2?(Kg=!0,Og=1):Xa.ff&&ke.x-Tf.topLeft.x>Tf.width/2&&(Kg=!0);if(Kg){od=Yf.wk("DragSelectionClickBehavior.OnPointerMoveDragInsert",Yf.yH,Og);try{od.us(Yd),od.$$mn(),Yd=od.$$cu().range}finally{od&&od.dispose()}}Xa.Jb=Xa.aia(Yd)}else{ke.x-Tf.topLeft.x===Tf.width?(Xa.Rq=!1,Kg=!0):ke.y-Tf.topLeft.y>Tf.height/2&&(Kg=!0,Xa.Rq=!0,Og=1);Xa.dA&&(Xa.Rq=Xa.Qq);if(Kg){Yf=Yf.wk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
Yf.yH,Og);try{Yf.us(Yd),Yf.$$mn(),Yd=Yf.$$cu().range}finally{Yf&&Yf.dispose()}}Xa.Cb.Xh(Xa.Nh);Xa.Nh=Xa.Rq?[11]:[12];for(Yf=1;4>=Yf;Yf++)(Tf=Xa.Uh[Yf.toString()])&&Tf.parentNode.removeChild(Tf),Xa.Uh[Yf.toString()]=null;Xa.PB(od.clientPoint,od.Mb,Xa.Rq?11:12,!0);Xa.Jb=Xa.O$(Yd)}Xa.ha.sourceRange=Xa.Jb;Xa.Cb.vj(Xa.Jb,Xa.Nh);Xa.Cb.Gn(Xa.Nh);Xa.Cb.Xh(Xa.nB());if(6!==Xa.pj){for(od=1;4>=od;od++)Yd=Xa.Uh[od.toString()],Yd.parentNode.removeChild(Yd),Xa.Cb.Jw(Xa.isRow||Xa.Rq?11:12,od).Of.appendChild(Yd);
Xa.pj=6}Xa.QB()}return!0};Xa.wh=function(){Xa.domElement.classList.remove(ca.selecting)};Xa.Fp=function(){Xa.domElement.classList.add(ca.selecting)};Xa.kd=function(){if(Xa.$.isEditMode){var od=Xa.Vxc();Xa.Awc(od)}};Xa.rPa=function(){Xa.Yh?Xa.jq&&5<=Xa.pj&&(Xa.tableRange?Xa.ku?Xa.hH(!0):Xa.hta(!0):Xa.ku?Xa.isRow||Xa.ff?Xa.hH(!0):Xa.G3(!0):Xa.isRow||Xa.ff?Xa.G3(!0):Xa.hH(!0)):Xa.jq&&5<=Xa.pj&&(Xa.tableRange?(Xa.Cb.Xh(Xa.Nh),Xa.Ys(Xa.$K,Xa.aL)):(Xa.Cb.Xh(Xa.nB()),Xa.Ys(Object(Re.a)(Xa,Xa.Sh,"onPointerMove"),
Object(Re.a)(Xa,Xa.Pf,"onPointerUp"))))};Xa.tableManager=Kb;Xa.tableRange=null;Xa.Uh={};Xa.jq=!1;Xa.ju=!1;Xa.ku=!1;Xa.VMa=!1;Xa.ha.k3(Xa.Fp);Xa.ha.aZ(Xa.wh);Xa.ha.$Zb(Xa.rPa);Xa.ha.sE(Xa.kd);return Xa}function R(V,ya){this.destinationRange=this.sourceRange=null;this.sourceRange=V;this.destinationRange=ya}function Q(V,ya,lb,Kb,Lb,Xa,od,Yd){Yd=V.Na(41,void 0===Yd?null:Yd);Yd.sourceRange=ya;Yd.destinationRange=lb;return Xh.i(V,"RearrangeRowColumn",Yd,Kb,Lb,Xa,od,0)}function ea(V,ya,lb,Kb,Lb,Xa){var od=
Z.call(this,V,ya,lb,Lb)||this;od.wL=null;od.Ya=null;od.U6e=function(){od.gub(!0)};od.gridView=Kf.g(od.$);od.yy=Kb;od.coloredReferencesManager=od.$.da.Aa(281);Rb.ULS.shipAssertTag(537159391,0,!!od.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");V=Cl(od.ds);for(ya=V.next();!ya.done;ya=V.next())ya=ya.value,eg.a.instance.pa(lf.a.dX,ya,Object(Re.a)(od.yy,od.yy.a$e,"hoveringStarted")),eg.a.instance.pa(lf.a.Iy,
ya,Object(Re.a)(od.yy,od.yy.b$e,"hoveringStopped"));od.uZa(Xa);return od}function Z(V,ya,lb,Kb){var Lb=I.call(this,V)||this;Lb.iTa=!1;Lb.vle=null;Lb.ule=null;Lb.$ra=0;Lb.Yh=De.EwaSettings.getBooleanFeatureGate(nf.a.I7b,!1);Lb.Vhi=De.EwaSettings.getBooleanFeatureGate(nf.a.xih,!1);Lb.KE=0;Lb.Iec=0;Lb.oDc=0;Lb.Uma=null;Lb.sourceRange=null;Lb.Jb=null;Lb.Zw=null;Lb.onPointerDown=function(Xa){Xa=Zf.a(Lb.$).qe(Xa);if(2===Xa.yb&&Xa.Vn===Sys.UI.MouseButton.leftButton&&!Lb.iTa){var od=Lb.Ecc(Xa);if(!od)return Rb.ULS.shipAssertTag(537159379,
0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;Lb.Jb=od.clone();Lb.sourceRange=Lb.Jb.clone();Lb.Uma=Lb.Jb;if(od=Lb.cUh(Xa))Lb.pj=5,Lb.oDc=od.top-Lb.sourceRange.top,Lb.Iec=od.left-Lb.sourceRange.left,Kf.g(Lb.$).rg.No(Lb.Yh?Z.k2a:Z.K7c),Lb.woc(Xa),Lb.iTa=!0,Di.b(Lb.$,!0)}return!1};Lb.zd=function(Xa,od){od.uN||Lb.Awc(Lb.$.isEditMode)};Lb.ds=[];Lb.$=ya;Lb.ha=Kf.g(Lb.$).ha;Lb.paneType=lb;Lb.so=Kb;ya=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
lb=Da.a.xf;ya=Cl(Lb.Vhi?ya&&!lb?[ca.sxh,ca.fxh,ca.kxh,ca.oxh]:[ca.uxh,ca.hxh,ca.mxh,ca.qxh]:ya&&!lb?[ca.rxh,ca.exh,ca.jxh,ca.nxh]:[ca.txh,ca.gxh,ca.lxh,ca.pxh]);for(lb=ya.next();!lb.done;lb=ya.next())lb=Lb.so.wEe(V,lb.value,Lb.Yh?[ca.ixh]:[ca.dxh],Lb.onPointerDown),Lb.ds.push(lb);Lb.$.tl(Lb.zd);Lb.Awc(Lb.$.isEditMode);return Lb}function ca(){}function I(V){var ya=fa.call(this,V)||this;var lb=document.createElement("div");lb.className=Wc.a.yxh;V.appendChild(lb);return ya}function H(V,ya,lb,Kb){return L.call(this,
V,ya,lb,Kb)||this}function L(V,ya,lb,Kb){var Lb=fa.call(this,ya)||this;Lb.Fob=!1;Lb.wXc=!1;Lb.lsd=!1;Lb.Ypb=null;Lb.isd=!1;Lb.Sba=!1;Lb.Ww=function(){Lb.Fob&&Lb.isd?Lb.ioa():Lb.r5()};Lb.fzf=function(od){3===od.yb&&(Lb.isd=!0,Lb.ioa());return!1};Lb.gzf=function(od){if(3===od.yb){if(!od.Mb||Lb.yii(od))return!1;Lb.isd=!1;Lb.r5()}return!1};Lb.wh=function(){Lb.Sba&&Lb.NYd();Lb.ioa();Lb.lsd=!1};Lb.Fp=function(){Lb.r5();Lb.lsd=!0};Lb.dza=function(od,Yd){Yd.u5===Lb.u5&&(Yd.visible?Lb.lsd||Lb.ioa():Lb.r5())};
Lb.KEf=function(){Lb.hzf(Lb.iP.domElement,!1)};Lb.tvf=function(){Lb.hzf(Lb.BM.domElement,!0)};Lb.Lnc=function(od,Yd){Lb.ha.Vza(Yd)};Lb.Mnc=function(od,Yd){Lb.ha.Vza(fe.b(Yd))};Lb.PEb=function(){3===Ud.a.Vb?Lb.ioa():Lb.r5();Lb.Sba&&1===Ud.a.Vb&&Lb.NYd()};Lb.LEf=function(){Lb.ypj()};Lb.ZKe=function(){Lb.r5()};Lb.Dp=function(){Lb.ha.Oa.oc&&Lb.r5()};Lb.hvf=function(){Lb.r5()};Lb.Zyf=function(od,Yd){Lb.NYd();3===Yd.yb?Lb.ioa():Lb.r5()};Lb.Irc=function(){Lb.Fob&&(Lb.r5(),Lb.ioa())};var Xa=lb.$;Lb.cw=lb;
Lb.ha=lb.ha;Lb.Aba=V;Lb.Zmj=ya;Lb.paneType=Kb;V=Lb.domElement.currentStyle;ya="#000000";V&&(ya=V.borderTopColor);Lb.iP=new U(Lb.vbd(),ya,Xa);Lb.BM=new U(Lb.vbd(),ya,Xa);Lb.kgf=Xa.ea.isNamedObjectViewMode&&1===Xa.workbookContext.NovMode;Lb.iP.uoe(Lb.KEf);Lb.iP.toe(Lb.Lnc);Lb.iP.voe(Lb.Mnc);Lb.BM.uoe(Lb.tvf);Lb.BM.toe(Lb.Lnc);Lb.BM.voe(Lb.Mnc);V=Cl(Lb.gridView.An);for(ya=V.next();!ya.done;ya=V.next())ya=ya.value,Je.a.instance.pa(lf.a.Lf,ya.domElement,Lb.gzf),Je.a.instance.pa(lf.a.Ce,ya.domElement,Lb.fzf);
lb.view.Ts(Lb.Ww);lb.rc.sl(Lb.ZKe);lb.Cb.fob(Lb.dza);lb.FVc(Lb.hvf);Xa.RA(Lb.Irc);lb.Nt(Lb.Irc);Lb.ha.aZ(Lb.wh);Lb.ha.k3(Lb.Fp);lb.rE(Lb.Dp);Lb.ha.AZb(Lb.Zyf);Ud.a.Eoe(Lb.PEb);Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(Xa.da,376,377,0),function(od){od.result.RHg(Lb.LEf)},Xa.la,3);return Lb}function U(V,ya,lb){var Kb=Pf.call(this,document.createElement("div"))||this;Kb.N5b=null;Kb.qPb=!1;Kb.onPointerDown=function(Xa){Xa=Zf.a(Kb.$)?Zf.a(Kb.$).qe(Xa):Xa;Kb.qPb=!1;if(3===(Ud.a.Vb=Xa.yb)){var od=
Xa.Ca.rawEvent,Yd=od.srcElement||od.target;le.DOMElementExtensions.Gf(Kb.domElement,Yd)&&le.DOMElementExtensions.Gf(od.currentTarget,Yd)&&(Kb.qPb=!0,Kb.N5b=Xa.clientPoint)}return!1};Kb.Pf=function(Xa){Xa=Zf.a(Kb.$)?Zf.a(Kb.$).qe(Xa):Xa;Kb.raiseEvent("GrPointerUp",Xa);return Kb.qPb=!1};Kb.Sh=function(Xa){Xa=Zf.a(Kb.$)?Zf.a(Kb.$).qe(Xa):Xa;3===Xa.yb&&Kb.qPb&&Kb.B6h(Xa.clientPoint)&&(Kb.raiseEvent("GrDrag"),Kb.qPb=!1);return!1};Kb.vd=function(Xa){Zf.a(Kb.$)&&Zf.a(Kb.$).qe(Xa);return!0};Kb.$=lb;lb=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
var Lb=Da.a.xf;Kb.domElement.classList.add(!lb||Lb?Wc.a.LRe:Wc.a.KRe);Kb.domElement.classList.add(Wc.a.o9b);V.appendChild(Kb.domElement);le.DOMElementExtensions.setVisible(Kb.domElement,!1);Kb.pLa=document.createElement("div");Kb.pLa.classList.add(Wc.a.n9b);Kb.pLa.style.borderColor=ya;Kb.domElement.appendChild(Kb.pLa);eg.a.instance.pa(lf.a.pointerDown,Kb.domElement,Kb.onPointerDown);eg.a.instance.pa(lf.a.$d,Kb.domElement,Kb.Pf);Je.a.instance.pa(lf.a.Ce,Kb.domElement,Kb.Pf);eg.a.instance.pa(lf.a.yh,
Kb.domElement,Kb.Sh);Je.a.instance.pa(lf.a.wg,Kb.domElement,Kb.Sh);Jb.a.instance.pa(lf.a.click,Kb.domElement,Kb.vd);return Kb}function fa(V,ya){return vd.call(this,V,void 0===ya?null:ya)||this}function aa(V){var ya=Yc.call(this)||this;ya.$pf=[3];ya.gridView=V;return ya}function na(V,ya){var lb=gc.call(this)||this;lb.start=V;lb.ryb=ya;return lb}function ha(V){var ya=Ja.call(this)||this;ya.$=V;ya.Tb();return ya}function ka(V){var ya=W.call(this)||this;V.da.Ga(376,ya);return ya}function xa(V){var ya=
Aj.call(this)||this;ya.$=V;ya.Tb();return ya}function va(){this.CMd=zc.AFrameworkApplication.dYj;this.rAi=zc.AFrameworkApplication.bYj;this.hP=zc.AFrameworkApplication.d2h();this.priority=zc.AFrameworkApplication.E0d;this.ege=this.btj();this.NTc=zc.AFrameworkApplication.c2h()}function Aa(V,ya,lb,Kb,Lb,Xa,od){var Yd=this;Kb=void 0===Kb?null:Kb;Lb=void 0===Lb?!1:Lb;Xa=void 0===Xa?null:Xa;od=void 0===od?!1:od;this.xra=0;this.Sga=this.Xi=null;this.IXb=new me.a;this.UT=new me.a;this.fm=null;this.eUb=!1;
this.se=V;this.Vee=ya;this.Vee.execute(function(ke){ke.Tl(tc.a.pld,Object(Re.a)(Yd,Yd.KNi,"onHostResponseReceived"))});this.S9=lb;this.yje=new yi.a("WebServiceCall","TokenRefresh");this.mj=Kb||new qa(V);this.lwg=Lb;this.jU=Xa?Xa:yj.SessionStatusManager.instance;this.$6d=od}function qa(V){this.Qo={};this.nY={};this.Aug={};this.fnf=15;this.iae=!1;this.rwg=new Date;this.lUb=new Date;this.se=V;this.yXb=new Se.a(2,2,6E4*this.fnf,Object(Re.a)(this,this.Ehg,"writeMeasures"),135,"SL",!1);this.se.Yg(this.yXb);
this.Lbi()}function wa(){}function Ta(V,ya){var lb=this;this.documentVisibilityObserver=null;this.Qa=new Ee.a;this.Ox=null;this.seb=this.Klb=!1;this.lsc=null;this.NHb=!1;this.Ivd=!0;this.Nae=this.nae=this.tH=this.Nmb=!1;this.JT=null;this.$6e=function(){if(!lb.E$b||lb.E$b&&lb.$.ea.sc)lb.A7e(!1);else if(lb.Ivd){lb.Ivd=!1;var Kb=Nh.a(lb.$);Rb.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",
Kb.xi?Kb.xi.activityName:"None",lb.o$f())}};this.qd=function(Kb,Lb){lb.context&&(Kb=lb.$.ea,Lb.WH&&lb.context.HHb&&!lb.context.TAc?(lb.context.TAc=!0,Lb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Lb.IsUserActive=Kb.sf.vr,Lb.RefreshAccessTokenCorrelationID=lb.context.correlationID,Lb=Zh.a.Lc(Lb),Rb.ULS.sendTraceTag(537170708,0,50,Lb)):lb.E$b&&lb.Klb&&!Kb.sc&&!lb.context.g5c&&(Lb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
lb.Ox&&(lb.Ox.C(),Lb.Aborted=!0,De.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(Lb.ResetStopRefreshRetriesUntilTokenExpired=!0,lb.seb=!1)),Lb.TimeUntilTokenExpirationInMin=lb.o$f(),Lb.RefreshAccessTokenCorrelationID=lb.context.correlationID,Lb=Zh.a.Lc(Lb),Rb.ULS.sendTraceTag(572019856,0,50,Lb)))};this.$ya=function(){if(lb.context&&lb.context.HHb&&!lb.context.TAc){var Kb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Kb.CreatedForExpired=
lb.context.g5c;Kb.RefreshAccessTokenCorrelationID=lb.context.correlationID;Kb.OpenWorkbookErrors=Ag.a.Xc(lb.$.ea.SF);Kb.ExecutionContextErrors=Ag.a.Xc(Nh.a(lb.$).rd.errors);Kb.accesstokenTTL=zc.AFrameworkApplication.tk;Kb=Zh.a.Lc(Kb);Rb.ULS.sendTraceTag(537170707,0,15,Kb)}};this.z7e=function(){lb.seb=!1;lb.A7e(!0)};this.eDd=function(){lb.NHb&&(lb.$.ea.sf.nAa(lb.eDd),lb.NHb=!1);lb.T6f()};this.$=V;this.ZWd=ya;this.CId=V.Ob.$g("WebServiceCall","refreshToken");this.E$b=De.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
th.a.instance.kWc(this.z7e);th.a.instance.iWc(this.$6e);ya=this.$.ea;ya.gk(this.qd);ya.TZb(this.$ya);this.vBi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.k2f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.gOf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Qeg(V.ea.oGf,zc.AFrameworkApplication.tk);V=new Date;ya={};Rb.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(ya.AccessTokenTtl=zc.AFrameworkApplication.tk,ya.NowGetTime=
V.getTime(),ya.BootTime=zc.AFrameworkApplication.Pha,ya.WopiTokenExpiresAfterMinutes=zc.AFrameworkApplication.C0d,ya.WopiTokenTaskItemPriority=zc.AFrameworkApplication.E0d,ya));this.$.da.$a(291,function(Kb){lb.documentVisibilityObserver=Kb})}function sb(V,ya){this.IXb=V;this.UT=ya}function db(){return kb.apply(this,arguments)||this}function kb(){}function ac(){}function ta(V,ya){this.HHb=!1;this.correlationID=V;this.g5c=ya;this.TAc=!1;this.creationTime=Fg.a.Ta.Wb}function ra(V){var ya=Na.call(this)||
this;ya.Qa=new Ee.a;ya.Nmb=!1;ya.tH=!1;ya.$=V;return ya}function Na(){this.vhe=this.qRc=!1;var V=zc.AFrameworkApplication.tk;if(!(0>=V)){this.tk=V;V=new Date;var ya={};Rb.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(ya.AccessTokenTtl=this.tk,ya.NowGetTime=V.getTime(),ya.BootTime=zc.AFrameworkApplication.Pha,ya));th.a.instance.kWc(Object(Re.a)(this,this.sPa,"onSessionExpiredDetected"));th.a.instance.iWc(Object(Re.a)(this,this.wDf,"onSessionExpiringDetected"))}}function gb(V){var ya=
ri.call(this)||this;ya.$=V;ya.Tb();return ya}function ob(V,ya,lb){lb=void 0===lb?null:lb;var Kb=Hg.call(this,ya)||this;Kb.sheetTabActivatePreviousHidden=bf.a.instance.fa(719);Kb.sheetTabActivateNextHidden=bf.a.instance.fa(721);Kb.svgIconProvider=null;Kb.Ch=[];Kb.WK=Array(6);Kb.xyd=Array(6);Kb.Wk=null;Kb.vRd=null;Kb.vxc=null;Kb.Gdb=null;Kb.txc=null;Kb.VH=null;Kb.Hyb=null;Kb.sSa=null;Kb.isRtl=!1;Kb.jv=0;Kb.EK=0;Kb.Ltc=!1;Kb.D7b=!1;Kb.Ana=0;Kb.oqc=0;Kb.M7b=null;Kb.Aaa=null;Kb.u4=null;Kb.QM=null;Kb.XC=
0;Kb.jdc=0;Kb.$Mb=null;Kb.nBb=-1;Kb.HZ=null;Kb.ypc=0;Kb.kzc=-1;Kb.Xma=0;Kb.iua=new rb;Kb.eMc=!1;Kb.g0=null;Kb.Hhe=null;Kb.wRd=null;Kb.xRd=null;Kb.Mtc=null;Kb.$$d=!1;Kb.nmd=null;Kb.Oxd=!1;Kb.Ghe=null;Kb.lD=function(Lb,Xa){Kb.JDf(Xa.item)};Kb.hza=function(Lb,Xa){Lb=Kb.$.xa.qa.index;for(var od=0,Yd=Kb.Ch.length;od<Yd;od++){var ke=Kb.oR(od);if(ke.name===Xa.oldName){ke.name=Xa.newName;Kb.M0();od===Lb&&Kb.$0(6);break}}};Kb.ODf=function(Lb,Xa){(Lb=Kb.j3a(Xa.item))&&Lb.Vfb()};Kb.PDf=function(Lb,Xa){Xa.visible?
(Kb.jSa(!1),Kb.LDf(Xa.item)):Kb.JDf(Xa.item)};Kb.ZK=function(Lb){Kb.yF?(Kb.HZ=Lb,Kb.uOb()):(Kb.HZ&&(Kb.oqc+=Kb.HZ.clientPoint.x-Lb.clientPoint.x),Kb.HZ=Lb,Math.abs(Kb.oqc)>=Kb.Eih&&Kb.uOb());return!0};Kb.eO=function(Lb){Lb.Ca.preventDefault();return!1};Kb.qXf=function(Lb){Kb.nXf(Lb,!0)};Kb.pXf=function(Lb){Kb.nXf(Lb,!1)};Kb.o0=function(Lb){if(Kb.yF&&(Kb.Iz||Kb.Zhf(Lb)))if(Kb.D7b=Kb.def(Lb),Kb.Iz){var Xa;Lb=(Xa=Kb.oR(Kb.XC+1))?Xa.sheet:null;Kb.reorderSheets(Lb,Kb.XC+1===Kb.tRd,!0)}else Lb=Kb.Oxd?null:
Kb.nmd,Kb.reorderSheets(Lb,Kb.Oxd,!0);Kb.UQ();return!0};Kb.ii=function(Lb,Xa){Xa.UF&&Kb.WZd(Xa.UF);Kb.zwc(!1);Kb.M0();Xa.qa&&(Kb.WZd(Xa.qa),Kb.$0(6),Kb.ea.Ema())};Kb.yuf=function(Lb,Xa){Kb.JCc(Xa.item)};Kb.zuf=function(Lb,Xa){Kb.JCc(Xa.item)};Kb.Auf=function(Lb,Xa){Kb.JCc(Xa.item)};Kb.lPa=function(Lb,Xa){Kb.JCc(Xa.item)};Kb.Mya=function(){Kb.l1c()};Kb.zd=function(){Kb.isVisible=!Kb.ea.isNamedObjectViewMode;Kb.l1c();Kb.Y4c();De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&(ch.d(Kb.$)||ch.e(Kb.$))&&(rg.PageLoadTrackingInfo.instance.tX($d.a.boa,["sheetTabBar"]),rg.PageLoadTrackingInfo.instance.DS($d.a.boa,["sheetTabBar"]));Kb.G4c();Kb.M0();Kb.jSa(!0);Kb.$0(6)};Kb.fj=function(){Kb.isVisible&&(Kb.M0(),Kb.$0(6))};Kb.If=function(){Object(Wg.a)(Pa,Kb.VH)===d.k(Kb.$.kg)&&Kb.G4c();for(var Lb=Cl(Kb.Ch),Xa=Lb.next();!Xa.done;Xa=Lb.next())Xa.value.opj(!d.k(Kb.$.kg))};Kb.NDf=function(Lb,Xa){Kb.Eej(Xa.item,Xa.isUserOperation)};Kb.oFb=function(Lb,Xa){Kb.LDf(Xa.item)};Kb.onKeyDown=
function(Lb){switch(Lb.keyCode){case 9:var Xa=Kb.domElement.querySelectorAll(le.DOMElementExtensions.sr),od=le.DOMElementExtensions.Lm(Xa);Xa=le.DOMElementExtensions.oB(Xa);le.DOMElementExtensions.Ona(Lb,od,Xa);break;case 39:case 37:le.DOMElementExtensions.n_f(Lb,Kb.domElement.querySelectorAll(le.DOMElementExtensions.sr),39===Lb.keyCode?!Kb.isRtl:Kb.isRtl)}Rb.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",Lb.keyCode)};Kb.onScroll=function(){Kb.Wk.scrollLeft!==Kb.Ana&&
Kb.OJj()};Kb.Q6=function(Lb){if(Lb.ctrlKey||Lb.O3)return!1;Kb.Wk.scrollLeft+=Math.floor(30*Lb.zCa);if(Kb.Iz&&Kb.yF){var Xa=Kb.K_e("OnMouseWheel");Xa&&Kb.HVd(0<Lb.zCa,Xa.x+Xa.width/2)}return!0};Kb.OF=function(Lb,Xa){if(Kb.iua)Kb.h7e("PartialInteractivity",Xa.WP?3:0);else{Kb.UQ(!1);Kb.YPd(Xa.WP);Lb=Cl(Kb.jue);for(var od=Lb.next();!od.done;od=Lb.next())(od=od.value)&&od.YX(Xa.WP);Lb=Cl(Kb.Ch);for(od=Lb.next();!od.done;od=Lb.next())(od=od.value)&&od.YX(Xa.WP)}};Kb.pEb=function(Lb,Xa){Lb=0;Xa.yle&&(Lb=
2|(Xa.iwj?1:0));Kb.h7e("ComponentRangePicker",Lb)};Kb.$=V;Kb.ea=Kb.$.ea;Kb.Iz=Zg.a.Uff();Kb.X7b=Kb.Iz&&!De.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Kb.rm=De.EwaSettings.ma(508);Kb.Pw=Zg.a.nrd();Kb.Xhf=Kb.rm&&!(De.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&Kb.$.oN);Kb.Iz&&(Kb.$$d=Kb.rm&&!Da.a.vv);Kb.mDi=Kb.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;Kb.lDi=Kb.$.ya.SheetTabNavigateButtonIntervalPeriodMS;
Kb.Eih=Kb.$.ya.SheetTabDragStartPixelThreshold;Kb.UPa=-1;Kb.TPa=-1;Kb.h3c=!1;Kb.Pw&&(Kb.svgIconProvider=lb);Kb.rC=new P.a(Kb.domElement,3);Kb.rm&&Kb.domElement.classList.add(pb.Kth);Kb.C8g();Kb.b6g();Kb.D8g();Kb.G9g();Kb.zwc(!0);Kb.zd(null,null);V=Kb.$.xa;V.zg(Kb.ii);V.IVc(Kb.Mya);V.$Y(Kb.lD);V.pha(Kb.oFb);V.gGa(Kb.hza);V.Boe(Kb.NDf);V.iZa(Kb.PDf);V.$Fg(Kb.ODf);V.RVc(Kb.yuf);V.yoe(Kb.zuf);V.zoe(Kb.Auf);V.Aoe(Kb.lPa);Kb.$.tl(Kb.zd);Kb.$.RA(Kb.fj);bg.a(Kb.$).ai(Kb);Kb.$.da.Ga(32,Kb);De.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&
Kb.$.ea.Ot(Kb.If);Kb.uxc=Kb.de.Wd(Kb.domElement);Kb.uxc.ka("keydown",Kb.onKeyDown);ig.a(Kb.$).Oq()&&Kb.OF(null,new kc.a(!0));ig.a(Kb.$).tg.qha(Kb.OF);Kf.g(Kb.$).Zne(Kb.pEb);De.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Kb.uxc.ka("mousedown",function(Lb){Lb.preventDefault()});zh.a.instance.pa(lf.a.eD,Kb.domElement,Kb.Q6);Kb.uRd=Kb.de.Wd(Kb.Wk);Kb.uRd.ka("scroll",Kb.onScroll);Kb.OJj=ja.a(function(){Kb.M0()},200,Kb.$.la,yc.a.nwj,!0);Kb.$.NH($d.a.XCj);Kb.Xhf&&
(Kb.Ghe=new eb(Kb.$,Kb.sSa.domElement));De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&rg.PageLoadTrackingInfo.instance.C7($d.a.boa,["sheetTabBar"]);return Kb}function wb(V,ya,lb){ya=nc.call(this,document.createElement("a"),ya)||this;ya.Xha=De.EwaSettings.ma(508)?G.a.b$c:G.a.Ruh;lb.Bb(ya.domElement,bf.a.instance.fa(710),0,ya.Xha,bf.a.instance.fa(710),qe.a.w2c,!0);V.appendChild(ya.domElement);ya.Fc.ka("contextmenu",function(Kb){pd.g(Kb)});return ya}function Oa(V,
ya,lb,Kb,Lb,Xa,od){var Yd=nc.call(this,document.createElement("li"),V)||this;Yd.c2f=0;Yd.d2f=0;Yd.X1c=0;Yd.Y1c=0;Yd.m5c=.5;Yd.oRd=!1;Yd.EV=!1;Yd.eP=null;Yd.uDb=null;Yd.ME=null;Yd.cIc=null;Yd.color=null;Yd.Bff=!1;Yd.Yhc=!1;Yd.T5b="#BEBBB8";Yd.BFc=null;Yd.onKeyDown=function(ke){return 13!==ke.Ca.keyCode||Yd.disabled?!1:(Yd.activateSheet(1),!0)};Yd.Sz=function(ke){return 32!==ke.Ca.charCode||Yd.disabled?!1:(Yd.activateSheet(1),!0)};Yd.bO=function(){Yd.disabled||(Yd.ZS.WSi(Yd),Yd.ZS.yF||Yd.Vna(!0,void 0,
"OnMouseOver"))};Yd.aO=function(){Yd.disabled||Yd.Vna(!1,void 0,"OnMouseOut")};Yd.Xya=function(){Yd.ZS.yF||(Yd.sFj(),Yd.sheet.W7||Kf.g(Yd.$).UIb(Yd.sheet.sheetName));return!1};Yd.Yya=function(){Yd.hMe(!1);return!1};Yd.vd=function(ke){if(Yd.disabled)return!0;var Yf=Kf.g(Yd.$);Yd.sheet.active||3!==ke.yb?Yd.rm?Yd.activateSheet(ke.yb):Zg.a.$rd()&&Yf.focus():(!Zg.a.tNa(Yd.$)&&!Yd.UAb||Yf.isEditing||Yf.Ni||Yf.Isb(),Yd.activateSheet(ke.yb));return 3!==ke.yb};Yd.onPointerDown=function(ke){if(Yd.disabled)return!0;
Yd.hMe(!0);Kf.g(Yd.$).inRangePicker&&Rb.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Yf=3===ke.yb;if(2===ke.yb||Yf&&Yd.vxa)Yd.rm?(Yd.Vna(!0,!Yf,"OnPointerDown"),Yf=Fe.Task.delay(Yf?Yd.d2f:Yd.c2f).CWR(function(){return!0})):Yf=Yd.activateSheet(ke.yb),Yd.y7a&&(Yd.Yhc=!0,Yd.ZS.Mtc=Lc.TaskExtensions.Ba(Yf,function(){Yd.Yhc&&Yd.ZS.YSi(Yd,ke)},Yd.la,11));return!1};Yd.Pf=function(ke){if(Yd.disabled||!Yd.y7a&&
De.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;var Yf=Yd.ZS.yF&&!Zg.a.Uff();Yd.Yhc=!1;Yd.rm&&Yd.Vna(2===ke.yb,void 0,"OnPointerUp");Yd.ZS.Mtc&&(Lc.TaskExtensions.Ba(Yd.ZS.Mtc,function(){Yd.ZS.XSi(Yd)},Yd.la,11),Yd.ZS.Mtc=null);return Yf};Yd.eO=function(){if(!Yd.y7a&&De.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;Yd.Yhc=!1;Yd.oRd||Yd.Vna(!1,void 0,"OnTouchMove");return!1};Yd.dAe=new sa(Yd,V);Yd.rm=Xa;
Yd.Pw=od;Yd.UAb=Zg.a.UAb(V);Yd.Kod=De.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!Yd.Pw;Yd.rm?(Yd.c2f=V.ya.SheetDragReorderDelayInMilliseconds,Yd.d2f=V.ya.SheetDragReorderDelayInMillisecondsForTouch,Yd.X1c=18,Yd.Y1c=20):(Yd.X1c=19,Yd.Y1c=22);Yd.$=V;Yd.OWb=Kb;Yd.ZS=Lb;Yd.y7a=Lb.sqe();Yd.T$g();Yd.Q4g();Yd.sld=V.Ob.$g("UserAction",Yd.name);Yd.Lpd=!1;le.DOMElementExtensions.Bu(Yd.domElement,$d.a.Sr,null,null);Yd.domElement.appendChild(Yd.anchor);Yd.anchor.appendChild(Yd.ME);
Yd.$na=new me.a;V=new Db(Yd.sheet,Yd.rm,Yd.Pw);Yd.$na.add(new Fa(Yd.$,V));Yd.$.ea.nLb&&(V=new pc(Yd.sheet,Yd.rm,Yd.Pw),Yd.$na.add(new Fa(Yd.$,V)));Yd.Kod||(V=new Wa(Yd.sheet,Yd.ZS.qxc,function(){return Yd.color?Oa.vSd(Yd.color):!1},Yd.Pw),Yd.uDb=new Fa(Yd.$,V),Yd.$na.add(Yd.uDb));Yd.vxa=Yd.ZS.vxa;Yd.Vfb();Yd.e$i();Yd.jve=new P.a(Yd.domElement,1);ya.insertBefore(Yd.domElement,lb);jb.a(Yd.$)&&Yd.Geg(!0);return Yd}function sa(V,ya){var lb=ag.call(this,V.domElement)||this;lb.onKeyDown=function(Kb){121===
Kb.keyCode&&Kb.shiftKey&&!lb.coa.disabled&&(lb.showContextMenu(new Sys.UI.Point(0,0),1,lb.coa.anchor),pd.g(Kb))};lb.Oca=function(Kb){if(!lb.$.isEditMode||lb.coa.disabled)return!0;lb.rename(!1,Kb.yb);return!0};lb.il=function(Kb){return lb.coa.disabled?!0:lb.showContextMenu(Kb.clientPoint,Kb.yb,Kb.Mb)};lb.Lhe=V;lb.$=ya;Jb.a.instance.pa(lf.a.jk,V.domElement,lb.Oca);xe.a.instance.pa(V.domElement,lb.il);lb.Fc.ka("keydown",lb.onKeyDown);return lb}function Fa(V,ya){var lb=this;this.Qqa=this.i2=this.xBa=
this.yl=null;this.Ngf=!1;this.$Rc=this.yoa=this.gta=this.gia=this.fta=null;this.bO=function(){lb.dataSource.sN()&&Lc.TaskExtensions.Ba(lb.jCb,function(){dialogControls.renderToolTip(lb.dataSource.Tv(),"SheetIconTooltip",lb.dataSource.dXd(),lb.OI,10,!1,!1,1)},lb.$.la,3)};this.aO=function(){lb.dataSource.sN()&&lb.clearToolTip()};this.$=V;this.dataSource=ya;this.Pw=Zg.a.nrd()}function Wa(V,ya,lb,Kb){this.sheet=V;this.altText=bf.a.instance.fa(1866);this.ILj=ya;this.E3f=lb;this.Pw=Kb}function Db(V,ya,
lb){this.rm=ya;this.Pw=lb;this.sheet=V;this.altText=bf.a.instance.fa(1943)}function pc(V,ya,lb){this.rm=ya;this.Pw=lb;this.sheet=V;this.altText=bf.a.instance.fa(1944)}function lc(V,ya,lb){var Kb=nc.call(this,document.createElement("a"),V,!0)||this;Kb.Gg=function(){Kb.YX(!1);Kb.$.ea.Yn(Kb.Gg)};Kb.vd=function(Lb){Kb.L$f(Lb.yb);return!0};Kb.onKeyDown=function(Lb){return 13===Lb.Ca.keyCode||32===Lb.Ca.keyCode?(Kb.L$f(Lb.yb),!0):!1};Kb.Rsa=ya.Bb(Kb.domElement,bf.a.instance.fa(512),0,G.a.qth,bf.a.instance.fa(512),
qe.a.e3h,Kb.disabled);Kb.domElement.classList.add(pb.tth);lb.appendChild(Kb.domElement);Kb.$.ea.Hl(Kb.Gg);Kb.S8i();return Kb}function eb(V,ya){var lb=Ye.call(this,document.createElement("div"))||this;lb.nS=function(){Rb.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");lb.jSf(!1,"OnSheetsChanged")};lb.uKi=function(){lb.Ek()};lb.tKi=function(){lb.wm()};lb.$=V;lb.KIj=ya;lb.EV=!1;lb.JNb=0;return lb}function ib(V,ya){this.sheetName=null;this.newSheetIndex=0;this.sheetName=V;this.newSheetIndex=
ya}function cc(V,ya,lb){var Kb=nc.call(this,document.createElement("a"),ya)||this;Kb.vd=function(Lb){Kb.$.Zd(-684145703,Lb.yb,0,null);return!0};Kb.VEb=function(Lb){wg.HelperMethods.VWd(Kb.cwe,Kb.Xha,Kb.Xha+$d.a.Pec,("mouseover"===Lb.type||"focus"===Lb.type)&&!Kf.g(Kb.$).inRangePicker)};Kb.$=ya;Kb.Xha=De.EwaSettings.ma(508)?G.a.b$c:G.a.nQe;Kb.cwe=lb.Bb(Kb.domElement,bf.a.instance.fa(510),0,Kb.Xha,bf.a.instance.fa(511),qe.a.w2c);V.appendChild(Kb.domElement);Kb.Fc.ka("contextmenu",function(Lb){pd.g(Lb)});
Kb.Fc.ka("mouseover",Kb.VEb);Kb.Fc.ka("mouseout",Kb.VEb);Jb.a.instance.pa(lf.a.click,Kb.domElement,Kb.vd);Kb.zNa=vh.KeyInputManager.instance.zs(Kb.domElement,Kb.vd,md.a.ei,md.a.L1);return Kb}function Pa(V,ya,lb,Kb){Kb=void 0===Kb?!1:Kb;var Lb=nc.call(this,document.createElement("a"),ya,Kb)||this;Lb.vd=function(Xa){Lb.disabled||Lb.$.Zd(-1935155518,Xa.yb,30,null);return!0};Lb.VEb=function(Xa){Xa="mouseover"===Xa.type||"focus"===Xa.type;var od=jb.a(Lb.$)?Lb.Bab:Lb.Rsa;wg.HelperMethods.VWd(od,Lb.Xha,
Lb.Xha+$d.a.Pec,Xa&&!Kf.g(Lb.$).inRangePicker)};Lb.gj=function(){Lb.YX(!0)};Lb.Ng=function(){Lb.YX(!1)};Lb.Xha=De.EwaSettings.ma(508)?G.a.b$c:G.a.nQe;Lb.Rsa=lb.Bb(Lb.domElement,bf.a.instance.fa(508),0,Lb.Xha,bf.a.instance.fa(509),qe.a.w2c,Kb);V.appendChild(Lb.domElement);Lb.Fc.ka("contextmenu",function(Xa){pd.g(Xa)});De.EwaSettings.ma(508)||(Lb.Fc.ka("mouseover",Lb.VEb),Lb.Fc.ka("mouseout",Lb.VEb));Jb.a.instance.pa(lf.a.click,Lb.domElement,Lb.vd);Lb.zNa=vh.KeyInputManager.instance.zs(Lb.domElement,
Lb.vd,md.a.ei,md.a.L1);De.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Kf.g(Lb.$).Ac.sl(Lb.gj),Kf.g(Lb.$).Ac.To(Lb.Ng));return Lb}function nc(V,ya,lb){lb=void 0===lb?!1:lb;V=ce.call(this,V)||this;V.Rsa=null;V.Bab=null;V.$=ya;V.tY=lb;return V}function pb(){}function rb(){this.jJe=new ij.a(!0);this.pIc=0}function Ya(V){return Ff.call(this,V)||this}function ec(V){this.Uih=V}function yd(V){return Df.call(this,V)||this}function Ub(V,ya,lb,Kb){var Lb=this;this.menuId=
null;this.IRa=-1;this.qEf=function(){Lb.Bda()};this.qUi=function(Xa){if(!(Lb.ta.mMa()||(!De.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||Ch.a(Xa)||Lb.CMa())&&Ch.a(Xa)&&Lb.CMa())){Xa=Lb.ta.activeCell;var od=Lb.ta.activeRange,Yd=Lb.tableManager.Cg.usedRange;2===Lb.IRa&&be.g(Lb.tableManager.Cg)&&Xa.bottom===Yd.bottom&&(od=od.N_?new ue.Range(od.top-1,od.left,od.bottom-1,od.right,!1,!0):new ue.Range(od.top,od.left,od.bottom-1,od.right,!1,!0),Xa=od.contains(Xa)?
Xa:ue.Range.hd(od.bottom,Xa.left),Kf.g(Lb.$).ha.updateSelection(od,Xa,0,3))}};this.JTi=function(Xa){Ch.a(Xa)?(Rb.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),Lb.$.Bf()):Rb.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.ITi=function(){Rb.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");Lb.$.Bf()};this.KTi=function(Xa,od){od&&
Lb.QL(od);Ch.b(Xa,-569193796)&&(Nh.a(Lb.$).rd.nE(-569193796),Lb.vsi(Xa.Errors[0]))};this.$=V;this.tableManager=ya;this.namedSheetViewPublic=lb;this.frame=this.$.frame;this.ha=Kf.g(this.$).ha;this.ta=this.ha.ta;this.ry=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Kb;this.tableStyleManager.oHg(this.qEf)}function Ob(V){V=kh.call(this,V)||this;var ya=Kf.g(V.$);ya=ya.Rb.Qj(ya.ha.ta.activeCell);yg.a.Gh(ya.wTa)?V.CDd="":V.CDd=ya.wTa;yg.a.Gh(ya.xTa)?V.ADd="":
V.ADd=ya.xTa;ya=V.$V(V.CDd,V.ADd);V.initializeAndShow(bf.a.instance.fa(739),V.rIj,ya);return V}function Yb(V){var ya=se.call(this,V)||this;ya.AIj=function(lb,Kb){1===lb&&ya.iNj(Ia.D(ya.OGf(Kb[Yb.lMf])))};ya.hwb=function(lb){lb=ya.Tfd(lb);return ya.mdd(lb)};ya.gridView=Kf.g(V);ya.ta=ya.gridView.ha.ta;ya.zpc=ya.gridView.Rb.Qj(ya.ta.activeCell).usedRange;V=ya.$V(ya.zpc.toString());ya.initializeAndShow(bf.a.instance.fa(730),ya.AIj,V);return ya}function xb(V,ya){V=rh.call(this,V)||this;V.BBa=ya;return V}
function Sa(V,ya){V=Xg.call(this,V,bf.a.instance.fa(729))||this;V.BBa=ya;return V}function Tb(V,ya,lb){this.jAb=!1;this.sharedSheetRange=ya;this.$=V;this.mh=this.$.Ob.$g("UserAction","ConvertToRangeManager");this.tableName=lb}function Cc(V,ya){var lb=this;this.j1d=null;this.k1d=0;this.kj=null;this._state=0;this.moveNext=function(){try{for(lb._state=1;1===lb._state;)lb.Ru=lb.Ru()}catch(Kb){lb.dispose(),lb._state=3}};this.Cf=V;this.ICa=ya;this.Ru=this.ZL;this.moveNext()}function Fb(V){this.tableName=
null;this.tableName=V}function hc(V,ya,lb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=V;this.optionType=ya;this.isPivotTable=lb}function cd(V){this.originalRange=null;this.originalRange=V}function mb(V,ya){this.newName=this.oldName=null;this.oldName=V;this.newName=ya}function $a(V,ya,lb){this.description=this.title=this.tableRange=null;this.tableRange=V;this.title=ya;this.description=lb}function K(V,ya,lb,Kb){V=ba.call(this,V,lb)||this;V.hasHeaders=!1;V.isCreation=
!1;V.hasHeaders=ya;V.isCreation=Kb;return V}function ba(V,ya){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=V;this.tableRange=Ia.l(V.Ranges[0],V.SheetName);this.styleIndex=ya}function ua(V){this.autoFilterOptions=null;this.autoFilterOptions=V}function La(V,ya){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=V;this.sortType=ya}function ub(V){var ya=qi.call(this)||this;ya.tableStyleManager=null;ya.$=V;ya.Tb();return ya}function Va(V,ya,lb){var Kb=pg.call(this)||
this;var Lb={};Kb.t1i=(Lb.height="100%",Lb);Kb.LHb={};Kb.Phd=0;Kb.nIa=0;Kb.lastSyncTime=new Date;Kb.dea=-1;Kb.lO=null;Kb.Tma={};Kb.JL=null;Kb.qG={};Kb.yTa={};Kb.isc=null;Kb.Lgf=!1;Kb.isInitialized=!1;Kb.T6a=!1;Kb.JAb=!1;Kb.lvc=null;Kb.ZVe=!1;Kb.MMb=!1;Kb.Bzc=!1;Kb.DAh=function(){Kb.Mic()?Kb.$.ea.YJd(Kb.DAh):Kb.cLa("tableStyleManagerInitialization")};Kb.Uyf=function(Xa,od,Yd){var ke=!1,Yf=De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(Ch.a(Xa))-315732528!==
Xa.Errors[0].MessageId&&(Rb.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",Ag.a.Xc(Xa.Errors)),Kb.ABd(null,od,Yd));else if(Rb.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(Xa=Xa.Result)&&Xa.TableStyleItems.length){Yd=60<Xa.TableStyleItems.length;var Tf=!1,Kg=!1;if(Kb.JL)for(var Og=0;60>Og;++Og){var Hh=Xa.TableStyleItems[Og],si=Kb.JL.TableStyleItems[Og];if(Yf&&Hh.HasStyleViolations!==
si.HasStyleViolations){ke=Kg=!0;break}for(var Vj=0;9>Vj&&!(Vj>=Hh.TableStyleElementsList.length);Vj++)if(!yg.a.equals(Hh.TableStyleElementsList[Vj].BackgroundColor,si.TableStyleElementsList[Vj].BackgroundColor,!1)){ke=Tf=!0;break}}else for(Kb.nIa=0,Og=Cl(Xa.TableStyleItems),Hh=Og.next();!Hh.done;Hh=Og.next())Hh=Hh.value,Hh.TableStyleElementsList&&Hh.TableStyleElementsList.sort(Cb.hof),Kb.qG[Hh.Name]=Hh;if(Tf||Kg)for(Tf=0;60>Tf;++Tf)Kg=Xa.TableStyleItems[Tf],Kb.qG[Kg.Name]=Kg;if(Yd&&Kb.JL)for(Rb.ULS.sendTraceTag(42821700,
0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",Xa.TableStyleItems.length-60),ke=!0,Yd=60;Yd<Xa.TableStyleItems.length;++Yd)Tf=Xa.TableStyleItems[Yd],Tf.Name in Kb.qG||Tf.TableStyleElementsList&&Tf.TableStyleElementsList.sort(Cb.hof),Kb.qG[Tf.Name]=Tf;if(pi.a(Kb.qG).length!==Xa.TableStyleItems.length)for(ke=!0,Tf=Yd=60;Tf<Kb.JL.TableStyleItems.length;)Yd>=Xa.TableStyleItems.length?delete Kb.qG[Kb.JL.TableStyleItems[Tf].Name]:Yd>=Xa.TableStyleItems.length||!yg.a.equals(Xa.TableStyleItems[Yd].Name,
Kb.JL.TableStyleItems[Tf].Name,!1)?delete Kb.qG[Kb.JL.TableStyleItems[Tf].Name]:++Yd,++Tf;Kb.JL=Xa;Kb.DOf(ke);ke&&Kb.HZc();Yf&&od&&("accessibility"===od?(Kb.MMb=!1,Kb.Bzc=!0):Kb.Bzc=!1);Kb.Lgf||(Kb.uoi()&&Kb.$.Bf(),Kb.Lgf=!0);Kb.Phd=0;Kb.JAb||Kb.ZVe?Yf&&Kb.Bzc&&Kb.raiseEvent("RefreshTableStyleGallery"):(Kb.raiseEvent("RefreshTableStyleGallery"),Kb.ZVe=!0)}};Kb.ABd=function(){Rb.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");Kb.Phd++;5>Kb.Phd&&Xb.a.instance.create(function(){Kb.cLa("getTableStylesFailed")},
1E3,yc.a.a9f,!0,!0)};Kb.pEf=function(){Kb.JAb&&(Kb.JAb=!1,Kb.lvc&&Kb.lvc(),Xb.a.instance.create(function(){Kb.cLa("galleryMenuClosed")},1E3,yc.a.a9f,!0,!0))};Kb.$=V;Kb.Sa=ya;Kb.tableManager=lb;Kb.$.da.Ga(329,Kb);Kb.d_c=Kb.Lvb();Kb.$.Ka.hGa(Kb.pEf);return Kb}function tb(V,ya,lb,Kb,Lb,Xa){this.headerRow=V;this.totalRow=ya;this.firstCol=lb;this.lastCol=Kb;this.JS=Lb;this.pia=Xa}function Cb(){}function nb(){}function Ib(V){var ya=Jh.call(this)||this;ya.tableManager=null;ya.$=V;ya.Tb();return ya}function hb(V){var ya=
Ac.call(this,Kf.g(V))||this;ya.$pb=null;ya.cAc=null;ya.u1=null;ya.bqb=null;ya.Yqe=!1;ya.Bae=null;ya.ZRb=0;ya.V5b=null;ya.F0b=function(){var lb={},Kb=ya.ahd(),Lb;for(Lb in Kb){var Xa=Kb[Lb];if(Xa){var od=ya.r_h(Xa);if(od){if(od in ya.SFa){var Yd=ya.SFa[od];if(Yd.wB){Yd.co.equals(Xa)||(Yd.co=Xa);delete ya.SFa[od];lb[od]=Yd;continue}}(Yd=Fc.createInstance(Kf.g(ya.$),Xa,ya.FJh(),ya))?lb[od]=Yd:Rb.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",
Xa.qB(!1))}}}ya.F2b(null,null);ya.FQb=lb};ya.F2b=function(){var lb=ya.SFa,Kb;for(Kb in lb){var Lb=Kb,Xa=lb[Kb];Xa&&(Xa.dispose(),delete ya.SFa[Lb])}ya.FQb={}};ya.pMf=function(){ya.F2b(null,null);ya.F0b(null,null)};ya.onFocus=function(){ya.Bae=Kf.g(ya.$).ha.ta.activeCell};ya.J6=function(){ya.$.isEditMode&&ya.Rh(null,null)};ya.Rh=function(){!ya.Yqe&&cb.c(ya.$,ya.gridView.ha.ta.activeCell)&&ya.Vti()};ya.RN=function(){ya.Ayb(1);ya.$.ea.Yn(ya.RN)};ya.EGb=function(){ya.Yqe=!0;ya.cAc=new zb(ya.$)};ya.$=
V;ya.gridView=Kf.g(ya.$);ya.$.da.Ga(66,ya);ya.FQb={};ya.F0b(null,null);ya.$.xa&&ya.$.xa.zg(ya.pMf);ya.Yoe(ya.F0b);ya.$.ea.g3(ya.J6);ya.gridView.ha.FJ(ya.Rh);ya.$.isEditMode&&ya.Rh(null,null);return ya}function zb(V){var ya=Bh.call(this,document.createElement("div"))||this;ya.qR=!1;ya.JGf=!1;ya.Wod=!1;ya.oUc=!1;ya.cKb=null;ya.Rh=function(){cb.c(ya.$,ya.gridView.ha.ta.activeCell)?(ya.nMa=!0,ya.Brb(!1)):(ya.nMa=!1,ya.H5=!1,ya.Gcg())};ya.ot=function(){ya.nMa?ya.Brb(!0):ya.H5=!1};ya.Ivf=function(){ya.oUc=
!0;ya.nMa&&(ya.H5=!1)};ya.onContentReady=function(){ya.$.isEditMode?cb.c(ya.$,ya.gridView.ha.ta.activeCell)&&(ya.nMa=!0,ya.Brb(!1)):ya.H5=!1};ya.gEb=function(){ya.oUc=!1;ya.nMa?ya.Brb(!1):ya.H5=!1};ya.zf=function(lb,Kb){ya.nMa&&(lb=ya.gridView.Kpc(Kb.nd.block.je.BlockCachePosition.PaneType).zG(Kb.nd.hash))&&(lb.GKd(ya.zLa),lb.rWc(ya.zLa))};ya.zLa=function(){ya.eSf()};ya.$=V;ya.gridView=Kf.g(ya.$);ya.parentElement=ya.domElement;ya.parentElement.className=Gc.Vth;ya.kLa=ya.gridView.Oj;ya.nMa=!0;ya.tbi();
ya.LMg();ya.Brb(!1);Rb.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return ya}function Gc(){}function Fc(V,ya,lb,Kb){var Lb=Ei.call(this,V)||this;Lb.$8f=[6];Lb.V8f=[26];Lb.Tr=null;Lb.Vic=!1;Lb.Zzb=!1;Lb.uba=null;Lb.nt=null;Lb.onPointerDown=function(Xa){if(1!==Lb.$.Ka.BH())return!0;Xa=Zf.a(Lb.$).qe(Xa);if(Lb.wB)return!0;var od=ig.a(Lb.$).Opd||ig.a(Lb.$).Oq();if(Lb.Drd||od)return Lb.jcb(),!0;Lb.nt=Lb.co;Lb.qJd();Lb.Zkd();od=2===Xa.yb&&Xa.Vn===Sys.UI.MouseButton.leftButton;
var Yd=3===Xa.yb;if(od||Yd)Xa=Lb.ha.Xn(Xa.clientPoint,Xa.Mb,5,void 0,void 0,!0),Xa||(Xa=Lb.nt),Lb.Zzb=od,Lb.Vic=Yd,Lb.nt=Lb.N4e(Xa),Lb.Zkd(),od?Lb.A9i():Yd&&Lb.n$i(),Di.b(Lb.$,!0);return!0};Lb.Sh=function(Xa){Xa=Zf.a(Lb.$).qe(Xa);if(!Lb.wB)return!1;if(Xa=Lb.Zzb?Lb.ha.Xn(Xa.clientPoint,Xa.Mb,5,void 0,void 0,!0):Lb.ha.Xn(Xa.clientPoint,Xa.Mb,5,!0,!1,!0))Xa=Lb.N4e(Lb.vZa(Xa)),Lb.i1b(Xa.bottomRight),Lb.nt.equals(Xa)||(Lb.nt=Xa,Lb.YHb(!1),Lb.qJd(!1),Lb.Zkd(!1),Lb.d8h(),Lb.Cb.update(!1)),Lb.GRj(Lb.nt);
return!0};Lb.Pf=function(Xa){Zf.a(Lb.$).qe(Xa);if(!Lb.wB)return!1;Lb.resizeTable();Lb.jcb();return!0};Lb.AFb=function(Xa){Zf.a(Lb.$).qe(Xa);if(!Lb.wB)return Rb.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;Lb.resizeTable();Lb.jcb();return!0};Lb.Sca=function(Xa){Zf.a(Lb.$).qe(Xa);Lb.jcb();return!0};Lb.Dvf=function(){Lb.wB&&Lb.jcb()};Lb.gridView=ya;Lb.$=ya.$;Lb.tableManager=Kb;Lb.ha=ya.ha;Lb.Cb=ya.Cb;Lb.parentElement=V;Lb.uSg();
Da.a.xp||Da.a.bla||eg.a.instance.pa(lf.a.pointerDown,Lb.uba,Lb.onPointerDown);Lb.co=lb;Lb.Drd=!1;Lb.qMc=!1;Lb.tableManager.GEg(Lb.Dvf);return Lb}function Ed(V){var ya=af.call(this)||this;ya.$=V;ya.Tb();return ya}function Jc(V){var ya=this;this.Gg=function(){ya.Plf();ya.$.ea.Yn(ya.Gg)};this.$=V;this.I8f={};this.EVd={};var lb=De.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",Kb=this.h0e(lb);Kb?(this.zne(Kb),this.$.ea.vh?this.Plf():
V.ea.Hl(this.Gg),this.$.da.Ga(388,this)):Rb.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",lb)}function Ca(){}function bb(V){var ya=Uf.call(this)||this;ya.sparklineManager=null;ya.$=V;ya.Tb();return ya}function dc(V,ya){V=Ac.call(this,V)||this;ya.Ga(240,V);return V}function Ac(V){var ya=Cd.call(this)||this;ya.cU=[];ya.zf=function(Yd,ke){var Yf,Tf=ke.nd.block;Yd=!1;if(Tf.Yj&&Tf.state&1&&(Yf=ya.view.Tf(ke.nd.block.je.BlockCachePosition.PaneType).zG(ke.nd.hash))){Tf=ya.tHd(Tf.ze);
if(Yf=Yf.uf)for(var Kg=ya.cU.length-1;0<=Kg;Kg--)Yf.contains(ya.cU[Kg].bottomRight)&&(Array.removeAt(ya.cU,Kg),Yd=!0);if(Tf)for(Yf=0,Kg=Tf.length;Yf<Kg;Yf++)ya.rangeList.push(Vd.a.fR(Tf[Yf])),Yd=!0;Yd&&(ke=(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?ya.view.Kpc(ke.nd.block.je.BlockCachePosition.PaneType):ya.view.L3).zG(ke.nd.hash),ya.raiseEvent(Ac.uHd,new Sf.a(ke)))}};ya.Tm=function(){ya.SHb()};ya.Go=function(){ya.cU=[]};ya.qke=V;var lb=
V.Ea;lb.Ss(ya.zf);lb.oha(ya.zf);lb.wZb(ya.zf);lb.UG(ya.Tm);V.$.xa.GJ(ya.Go);V.$.Hb.GJ(ya.Go);lb=Cl(V.An);for(var Kb=lb.next();!Kb.done;Kb=lb.next()){Kb=Cl(Kb.value);for(var Lb=Kb.next();!Lb.done;Lb=Kb.next()){Lb=Cl(Lb.value);for(var Xa=Lb.next();!Xa.done;Xa=Lb.next()){Xa=Xa.value;var od=V.Ea.xl(Xa.hashCode);ya.zf(ya,new Uc.a(new mc.a(od,Xa.hashCode),null))}}}return ya}function nd(V){var ya=uf.call(this)||this;ya.$=V;ya.Tb();return ya}function qd(V,ya){var lb=this;this.RW=function(){lb.Od||lb.Rqe()};
this.Od=!1;this.JZ=ya.fV;this.ariaLiveNotifier=V;this.H0d=new Oc(V,ya);this.JZ&&this.JZ.zR?this.Rqe():this.Ek()}function Gb(V,ya,lb){var Kb=this;this.Tzf=function(){Kb.H0d.bNf();Kb.ariaLiveNotifier.setEnabled(!0)};this.$=ya;this.ariaLiveNotifier=V;this.H0d=new Oc(V,ya);this.O$b=lb.Cgd(this.$);this.O$b.fGg(this.Tzf)}function Oc(V,ya){this.$=ya;this.ariaLiveNotifier=V}function he(V){var ya=gf.call(this)||this;ya.$=V;ya.Tb();return ya}function Wd(V,ya,lb,Kb,Lb){var Xa=this;this.gridReadoutNotifier=null;
this.dbb=!1;this.Tsa=this.Uob=null;this.tda=function(){De.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!Xa.$?Rb.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):Kf.g(Xa.$).isEditing||Xa.t0b.$q()};this.KGi=function(){if(!Kf.g(Xa.$).ha.Oa.Eqd){var od=Xa.gJh();Xa.readText(od.returnValue,od.activeCell)}};this.Ep=function(){var od=Xa.activeCell;Xa.readText("Editing",od);De.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||
od&&od.vLa&&!Kf.g(Xa.$).Q7e||Xa.t0b.cancel()};this.kd=function(){De.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!Xa.$?Rb.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(Xa.tda(),Xa.dbb&&Kf.g(Xa.$).inRangePicker&&1===Ud.a.Vb&&(null===Xa.Uob?Xa.Uob=Xb.a.instance.create(Xa.RHd,Wd.lUc,"readSelectedRanges"):Xa.Uob.$q()))};this.$=ya;this.ariaLiveNotifier=V;this.sparklineManager=Kb;this.tableManager=lb;this.xD=new rc;
this.Q6a=de.Q6a();this.dbb=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.Q6a&&(De.EwaSettings.Fb()?this.gridReadoutNotifier=Lb:this.gridReadoutNotifier=ya.da.Aa(244),Rb.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Wd.lUc=700);this.t0b=Xb.a.instance.create(this.KGi,Wd.lUc,yc.a.pnj,!1);this.Ek()}function rc(){this.activeItemName=null;this.Jhf=!1;this.tableName=null;this.C0a=
0;this.Zzc=!1}function gd(){}function kd(V){switch(V){case 1:return 1422;case 2:return 1423;case 3:return 1424;case 4:return 1425;case 5:return 1426;case 6:return 1427;case 7:return 1428;case 8:return 1429;case 9:return 1430;case 10:return 1431;case 11:return 1432;case 12:return 1433;case 13:return 1434;case 14:return 1435;case 15:return 1436;case 16:return 1437;case 17:return 1438;case 18:return 1439;case 19:return 1440;case 20:return 1441;case 21:return 1442;case 22:return 1445;case 23:return 1443;
case 24:return 1444;case 25:return 1446;case 26:return 1447;case 27:return 1448;case 28:return 1449;default:return 1450}}function Qc(V){var ya=Nd.call(this)||this;ya.$=V;ya.Tb();return ya}function de(V,ya){this.L0=this.nX=this.oO=null;this.zja=ya;this.X9g(V);this.E0i();De.EwaSettings.Fb()&&V.da.Ga(244,this)}function Xe(V){var ya=Ph.call(this)||this;ya.$=V;ya.Tb();return ya}function ge(V,ya,lb){var Kb=this;this.owf=function(Lb,Xa){Kb.TMf(Xa.Td.command)};this.$=V;this.ufa=document.createElement("div");
this.ufa.setAttribute($d.a.bQ,$d.a.yj);this.ufa.className=Lg.a.T9c;ya.insertBefore(this.ufa,lb);this.Jga=document.createElement("div");this.Jga.setAttribute($d.a.bQ,$d.a.yj);this.Jga.className=Lg.a.T9c;ya.insertBefore(this.Jga,this.ufa);this.Ssg=bf.a.instance.Wa(2);this.Jha=document.createElement("div");this.Jha.setAttribute($d.a.Rd,$d.a.zsa);this.Jha.setAttribute($d.a.Asa,$d.a.Kob);this.Jha.className=Lg.a.T9c;ya.insertBefore(this.Jha,this.Jga);this.register();this.$.da.Ga(211,this)}function fc(V,
ya){ya&&(V.append(ya),V.append(dd.Mvd))}function dd(V){this.Yuc=V||""}function oc(V){var ya=Rf.call(this)||this;ya.$=V;ya.Tb();return ya}function Zb(V){var ya=Vg.call(this)||this;ya.aud=null;ya.$=V;Rb.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return ya}function Sc(){return jd.call(this)||this}function sd(V){var ya=Cg.call(this)||this;ya.$=V;ya.Tb();return ya}function fd(V){var ya=qc.call(this,document.documentElement,V)||this;ya.eC=0;ya.lOg=[sf.a.tDe,sf.a.nzd,sf.a.iec,sf.a.V$f,
sf.a.IMd,sf.a.JZc,sf.a.Hcd,sf.a.U5e,sf.a.SYc,sf.a.iAc,sf.a.dDj,sf.a.sdc,sf.a.Y_c,sf.a.Eub,sf.a.sRd,sf.a.e0c,sf.a.c7f,sf.a.Klf,sf.a.nZc];ya.EWj=[sf.a.iec,sf.a.ngg,sf.a.mgg,sf.a.ogg];ya.K1i=[sf.a.iec,sf.a.IJf,sf.a.JJf,sf.a.MJf];ya.lWg=[sf.a.hWe,sf.a.T5e,sf.a.Fcd,sf.a.Ccd];ya.k1i=[sf.a.tDe,sf.a.nzd,sf.a.JZc,sf.a.Hcd,sf.a.SYc,sf.a.iAc,sf.a.sdc,sf.a.Y_c,sf.a.Eub,sf.a.sRd,sf.a.eJf,sf.a.e0c,sf.a.nZc];ya.u1i=[sf.a.sdc,sf.a.mWe];var lb=bf.a.instance.Wa(251);ya.hrj=ya.$.shortcutKeyManager.JKa(lb);ya.mode=0;
V.da.Ga(15,ya);Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(V.da,21,137,1),function(Kb){Kb=Kb.result;Kb.mo(tc.a.bnb);Kb.Tl(tc.a.bnb,ya.eJb)},V.la);return ya}function qc(V,ya){var lb=ff.call(this,V)||this;lb.y9=[];lb.xae=null;lb.eJb=function(Kb){var Lb="forward";Kb.Values[$b.a.direction]?Lb=Kb.Values[$b.a.direction].toLowerCase():Rb.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Kb=0;var Xa=!0;"backward"===Lb?(Kb=lb.itd.length-1,Xa=!1):"forward"===Lb?(Kb=0,Xa=!0):Rb.ULS.sendTraceTag(537166663,
0,15,"Received unknown direction to resume focus: {0}",Lb);lb.Drf(Xa,Kb,!1)};lb.Szf=function(){lb.y9=[]};lb.xma=function(Kb){if(-411645385===lb.$.shortcutKeyManager.du(Kb,!0)&&lb.pff()){var Lb={};lb.$.Ka.$b(new td.a(-411645385,1,lb.$.fd,6,null),(Lb.event=Kb,Lb),Kb);Kb.stopPropagation()}};lb.DOi=function(Kb){lb.P6(Kb)};lb.wb=ya;lb.Fc.ka("keydown",lb.DOi);lb.Fc.ka("keyup",lb.xma);bg.a(ya).AHg(lb.Szf);Ma.a(ya.ya,27)&&Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(ya.da,21,137,1),function(Kb){Kb=Kb.result;
Kb.mo(tc.a.H9e);Kb.Tl(tc.a.H9e,lb.eJb)},ya.la);return lb}function vb(){this.Rmb=this.Dfe=this.tb=null;this.Cm=!1}function Pd(V,ya,lb,Kb,Lb,Xa,od){this.bhb={};this.x2=V;this.Ksg=ya;this.tra=new Ve(zc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),zc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.Xw.omc);this.Xra=new Ve(zc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),zc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Xw.omc);this.fvg=lb;this.Jke=Kb;this.wzg={};this.$T=new kf;this.Ppg=Lb;this.OUb="";this.aw=Xa;this.a7d=od;this.gvg=zc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function Tc(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function Ve(V,ya,lb){this.task=null;this.tfc=V;this.pAi=ya;
this.taskManager=lb;this.retryCount=this.Jyb=0;this.IPc=this.wBb=null}function kf(){this._state=0;this.Ice=this.Kce=this.Jce=null;this.state=this.xje=0;this.kLc=!1;return this}function of(V,ya,lb,Kb,Lb){this.Sqg=6E4;this.R$e="inactive";this.ole="active";this.XT=!0;this.se=V;this.Tpg=ya;this.OJc=lb;this.FXb=Kb;this.Za=new Ef.a;Lb&&this.uFj();this.Cae=this.E0e()}function vf(V,ya){this.bhb={};this.x2=V;this.Slb=new ne(ya,this.hDb.omc,"GetMoreInfo");this.Ro=new Xd;return this}function ne(V,ya,lb){this.EWb=
this.Xi=null;this.AQc=0;this.nwg=V;this.se=ya;this.c6d=lb}function Ad(V,ya,lb,Kb,Lb,Xa,od,Yd){this.La=V;this.Wg=ya;this.wlg=lb;this.W1=Kb;this.se=Lb;this.OJc=Xa;this.mqg=od;this.sXb=Yd}function Xd(){this._state=0;this.lSc=this.qlb=null;this.state=0;this.kLc=this.F9d=!1;return this}function ee(){this._state=0}function Le(){this.bhb={}}function Jf(){this.tb=null}function $f(){this.FWa=null}function Dc(V){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",zc.AFrameworkApplication.ga.appSettings.RoamingServiceHandlerWebServiceBase||
"",V,zc.AFrameworkApplication.oj)}function Sd(V){var ya=new jc.a;zc.AFrameworkApplication.Jd.hm(Dc(V),1,null,null,!0,2,function(lb){200===lb.data.httpStatus?ya.setResult("true"===lb.data.me.toLowerCase()):ya.setResult(!1)},function(){ya.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ya.task}function te(V,ya){this.La=V;this.AQb=ya}function rd(V){var ya=Lf.call(this,!1,!1,!0)||this;ya.AQb=V;return ya}function Ue(V,ya){this.ID=V;this.type=ya}function ef(V,ya){this.value=V;this.contextId=
ya}function pe(V,ya,lb,Kb,Lb,Xa,od,Yd){this.type=V;this.startTime=null==lb||void 0==lb.value?new ef(lb,null):lb;this.endTime=null==Kb||void 0==Kb.value?new ef(Kb,null):Kb;null!=Lb&&void 0!=Lb.value||new ef(Lb,null);null!=Xa&&void 0!=Xa.value||new ef(Xa,null);this.operationType=Yd}function Ne(V){this.ID=V}function gg(){this.Pe=[];this.uob=[];this.YWc=0;this.duration=this.startTime=null;this.d8b={};this.Zwd=this.Exd=this.yYc=-1}b.r(E);var ie=b(0),Re=b(82),Ig=b(149),Lf=Ig.a;Am(rd,Lf);rd.prototype.start=
function(){var V={},ya={};V=(ya.id="AccessibilitySettingsDialog",ya.bodyControls=(V.tooltipPersistenceEnabled=this.AQb.Z9e,V),ya);this.initializeAndShow("",Object(Re.a)(this,this.nij,"resultHandler"),V)};rd.prototype.nij=function(V,ya){1===V&&(this.AQb.Z9e=ya.tooltipPersistenceEnabled)};Object(ie.a)(rd,"AccessibilitySettingsDialog",Ig.a,[]);var qf=b(106),vg=b(27);te.prototype.Og=function(){this.La.fc(vg.a.Fzj,qf.a.frame,Object(Re.a)(this,this.Gzj,"showAccessibilitySettingsDialogHandler"))};te.prototype.Gzj=
function(){(new rd(this.AQb)).start();return 32};Object(ie.a)(te,"AccessibilitySettingsDialogActor",null,[525]);var jc=b(161),zc=b(4),Md=b(176);$f.prototype.Kti=function(){var V=this,ya=new jc.a;if(this.FWa)ya.setResult(this.FWa);else if(this.whf()){var lb=Sd("getHoverableRibbonTooltipIsEnabled");lb.continueWith(function(){V.FWa=lb.result;Md.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(lb.result);ya.setResult(lb.result)},8)}else ya.setResult(!1)};$f.prototype.whf=
function(){var V=zc.AFrameworkApplication.ga.ra("IsRoamingServiceEnabled"),ya=zc.AFrameworkApplication.ga.ra("IsAnonymousUser");return V&&!ya};Ck.Object.defineProperties($f.prototype,{Z9e:{configurable:!0,enumerable:!0,get:function(){return!!this.FWa},set:function(V){V!==this.FWa&&(this.FWa=V,Md.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(V),this.whf()&&zc.AFrameworkApplication.Jd.hm(Dc("saveHoverableRibbonTooltipIsEnabled"),2,V.toString().toLowerCase(),null,
!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(ie.a)($f,"AccessibilitySettingsInfo",null,[524]);var Ce=b(255),ae=b(171);Jf.prototype.fi=function(V){var ya=this;this.tb=V;this.tb.register($f,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Oc(function(){return new $f}).Ic();this.tb.register(te,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Oc(function(){return new te(zc.AFrameworkApplication.Ib,
ya.tb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).Ic()};Jf.prototype.init=function(){var V=this.tb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ya=this.tb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");V&&ya?(ya.Og(),V.Kti()):ae.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};Jf.prototype.dispose=function(){};Jf.main=function(){Ce.a.instance.hj(new Jf)};
Ck.Object.defineProperties(Jf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(ie.a)(Jf,"AccessibilitySettingsPackage",null,[4,5]);var ud=b(614),Rb=b(14);Le.prototype.eAg=function(V){this.bhb[V.id.toString()]=V};Le.prototype.NEi=function(V){var ya=this.bhb,lb;for(lb in ya)ya[lb].notify(V,!1);this.bhb={}};Le.prototype.t3i=function(V,ya){ya&&this.eAg(ya);return this.FCf(V,ya)};Le.prototype.y8c=function(V){this.NEi(V)};Le.prototype.OLe=
function(V,ya){V.notify(ya,!0)};Object(ie.a)(Le,"AEventEmitter",null,[629]);var Ie;(function(V){V[V.notStarted=0]="notStarted";V[V.waiting=1]="waiting";V[V.shouldRetry=2]="shouldRetry";V[V.complete=3]="complete"})(Ie||(Ie={}));Object(ie.b)("EventResultState",Ie);Ck.Object.defineProperties(ee.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(V){var ya={};Rb.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(ya.OldState=Ie[this._state],
ya.NewState=Ie[V],ya),"ResultType",this.X2e());this._state=V}}});Object(ie.a)(ee,"AEventResult",null,[676]);Am(Xd,ee);Xd.prototype.X2e=function(){return"GetMoreInfo Result"};Ck.Object.defineProperties(Xd.prototype,{sS:{configurable:!0,enumerable:!0,get:function(){return this.qlb}},voa:{configurable:!0,enumerable:!0,get:function(){return this.lSc}},Idi:{configurable:!0,enumerable:!0,get:function(){return this.F9d}}});Object(ie.a)(Xd,"GetMoreInfoResult",ee,[675,676]);var pa=b(80),qb=b(39),Sb=b(896),
$b=b(390),tc=b(167),ld=b(739),Vc=b(638);Ad.prototype.G8i=function(){this.B9a.fc(vg.a.openUrlInNewTab,qf.a.frame,Object(Re.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.B9a.fc(vg.a.APa,qf.a.frame,Object(Re.a)(this,this.APa,"openDocumentUrl"));zc.AFrameworkApplication.OQ?this.lnf():this.B9a.Ze(vg.a.C7b,qf.a.frame,Object(Re.a)(this,this.C7b,"documentLoaded"),96)};Ad.prototype.openUrlInNewTab=function(V,ya,lb,Kb,Lb){Lb&&Lb.MenuItemId&&(V={},Rb.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",
(V.Id=Lb.SourceControlId,V.AppType=Vc.a[this.Fca],V)),qb.a.rf(Lb.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};Ad.prototype.APa=function(V,ya,lb,Kb,Lb){if(Lb&&Lb.MenuItemId){var Xa=zc.AFrameworkApplication.ga.ra("WacInTabOpenMRUIsEnabledForUiHost"),od=zc.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures");Rb.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Xa,od);if(Xa&&od){V={};Rb.ULS.sendTraceTag(592237458,
202,50,"Opening new tab {0}",(V.Id=Lb.SourceControlId,V.AppType=Vc.a[this.Fca],V));Lb=Lb.MenuItemId.toString();var Yd={};Yd[$b.a.xQa]="1";Yd[$b.a.documentUrl]=Lb;Yd[$b.a.reason]=ld.a.open;Rb.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");zc.AFrameworkApplication.aW().execute(function(ke){ke.Jj(tc.a.pua,Yd)})}else this.openUrlInNewTab(V,ya,lb,Kb,Lb)}return 32};Ad.prototype.C7b=function(){this.lnf();return 32};Ad.prototype.uca=function(V,ya,lb){lb=void 0===
lb?"":lb;if(ya&&ya.tF){var Kb=Sb.a[ya.status];ya=ya.tF.getTime();var Lb=this.Iw()-ya,Xa={};Rb.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(Xa.Caller=V,Xa.RequestStatus=Kb,Xa.ElapsedMs=Lb,Xa.StartTime=ya,Xa.Notes=lb,Xa))}else lb={},Rb.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",(lb.Caller=V,lb))};Ad.prototype.lnf=function(){var V=zc.AFrameworkApplication.ga.ra("QPGVCI"),ya=pa.a.mF(document.URL,"wdNewAndOpenCt",
V);if(ya){ya=parseInt(ya);var lb=pa.a.mF(document.URL,"wdPreviousSession",V);V=pa.a.mF(document.URL,"wdPreviousCorrelation",V);var Kb=zc.AFrameworkApplication.ga.ra("NAOPLP");if(zc.AFrameworkApplication.OQ){var Lb=zc.AFrameworkApplication.OQ.getTime();if(!ya||ya>Lb)Kb={},Rb.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(Kb.ClickTimestamp=ya,Kb.DocumentLoadedTime=Lb,Kb.SessionId=lb,Kb.Correlation=V,Kb));else{var Xa={};Rb.ULS.sendTraceTag(5849683,
202,Kb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(Xa.ClickToLoadTime=Lb-ya,Xa.ClickTimestamp=ya,Xa.SessionId=lb,Xa.Correlation=V,Xa))}}else Lb={},Rb.ULS.sendTraceTag(5849681,202,Kb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(Lb.ClickTimestamp=ya,Lb.SessionId=lb,Lb.Correlation=V,Lb))}};Ad.ZM=function(){return new Ad(new ud.a(function(){return zc.AFrameworkApplication.Ib}),new ud.a(function(){return zc.AFrameworkApplication.Jd}),
new ud.a(function(){return zc.AFrameworkApplication.sa}),new ud.a(function(){return zc.AFrameworkApplication.sa.Pa.Sj}),new ud.a(function(){return zc.AFrameworkApplication.Ri}),function(){return(new Date).getTime()},new ud.a(function(){return zc.AFrameworkApplication.sa.Pa.LW}),new ud.a(function(){return zc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};Ck.Object.defineProperties(Ad.prototype,{B9a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},zDb:{configurable:!0,
enumerable:!0,get:function(){return this.Wg.value}},wsf:{configurable:!0,enumerable:!0,get:function(){return this.wlg.value}},Fca:{configurable:!0,enumerable:!0,get:function(){return this.W1.value}},omc:{configurable:!0,enumerable:!0,get:function(){return this.se.value}},Iw:{configurable:!0,enumerable:!0,get:function(){return this.OJc}},LW:{configurable:!0,enumerable:!0,get:function(){return this.mqg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.sXb.value}}});
Ck.Object.defineProperties(Ad,{instance:{configurable:!0,enumerable:!0,get:function(){return Ad.Ma||(Ad.Ma=Ad.ZM())}}});Ad.Ma=null;Object(ie.a)(Ad,"NewAndOpenCommonHelpers",null,[628]);var Se=b(108);ne.prototype.$Ig=function(){this.AQc=this.wcb+1};ne.prototype.$Ld=function(V){this.Xi&&(this.se.aq(this.Xi),this.Xi=null);V&&(this.AQc=0)};ne.prototype.CFj=function(V){var ya=this.JKj;0<=ya?(this.$Ig(),this.$Ld(!1),this.Xi=new Se.a(4,1,ya,V,107),this.se.Yg(this.Xi)):(this.$Ld(!0),V={},Rb.ULS.sendTraceTag(5849676,
202,50,"Retries exhausted {0}",(V.Action=this.c6d,V)))};Ck.Object.defineProperties(ne.prototype,{wcb:{configurable:!0,enumerable:!0,get:function(){return this.AQc}},JKj:{configurable:!0,enumerable:!0,get:function(){return this.wcb>=this.CYf.length?-1:this.CYf[this.wcb]}},CYf:{configurable:!0,enumerable:!0,get:function(){if(!this.EWb){var V=(this.nwg.value||"0").split(",");this.EWb=[];for(var ya=0;ya<V.length;ya++){var lb=parseInt(V[ya]);isNaN(lb)?(lb={},Rb.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
(lb.Action=this.c6d,lb.Entry=V[ya],lb))):Array.add(this.EWb,lb)}}return this.EWb}}});Object(ie.a)(ne,"RetryHelper",null,[]);var Ge=b(41),Af=b(29);Am(vf,Le);vf.prototype.Oyi=function(){this.Ewd("Document opened")};vf.prototype.l8g=function(V){var ya=this;return function(){ya.Ewd(V,!0)}};vf.prototype.FCf=function(V,ya){ya=void 0===ya?null:ya;var lb={};Rb.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(lb.Trigger=V,lb));3===this.Ro.state?(ya&&this.OLe(ya,this.Ro),ya={},
Rb.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(ya.Trigger=V,ya))):this.Ewd(V);return this.Ro};vf.prototype.Ewd=function(V,ya){this.Slb.$Ld(!(void 0===ya?0:ya));1===this.Ro.state?(ya={},Rb.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",(ya.Trigger=V,ya.RetryIndex=this.Slb.wcb,ya))):(ya={},Rb.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(ya.Trigger=V,ya.RetryIndex=this.Slb.wcb,ya)),this.Ro.state=1,ya=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.hDb.LW,zc.AFrameworkApplication.oj),this.hDb.zDb.j$(ya,1,null,null,[vf.Gee,vf.Cie],!1,5,this.r7g(),this.q7g(V),null))};vf.prototype.r7g=function(){var V=this;return function(ya){var lb=!1,Kb=!1,Lb=!1;if(zc.AFrameworkApplication.ga.ra("GetMoreInfoDataFromResponseBody"))if(ya.data.me){var Xa=Ge.d(ya.data.me);var od=Xa.ev;Xa.returnValue?od?(Lb=!0,V.Ro.lSc=od.StorageServiceDisplayName,V.Ro.qlb=vf.ajf(od.PersonalFileStorageUrl)?od.PersonalFileStorageUrl:"",""===V.Ro.sS&&"SharePointOnlineConsumer"===
zc.AFrameworkApplication.ga.Va("FileSource")&&(V.Ro.qlb=pa.a.Dda(zc.AFrameworkApplication.breadcrumbFolderUrl)),lb=""===V.Ro.sS&&""!==V.Ro.voa):Rb.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):Rb.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else Rb.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");
Lb||((od=ya.data.responseHeaders)?(V.Ro.lSc=(od[vf.Cie]||"").toString(),lb=(od[vf.Gee]||"").toString(),V.Ro.qlb=vf.ajf(lb)?lb:"",""===V.Ro.sS&&"SharePointOnlineConsumer"===zc.AFrameworkApplication.ga.Va("FileSource")?(V.Ro.qlb=pa.a.Dda(zc.AFrameworkApplication.breadcrumbFolderUrl),lb=""===V.Ro.sS&&""!==V.Ro.voa):lb=""===lb&&""!==V.Ro.voa):(Rb.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Kb=!0));Lb=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
V.Slb.wcb,Kb,lb,Lb);V.hDb.uca("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",ya.data,Lb);V.UYf(3,lb,Kb)}};vf.prototype.q7g=function(V){var ya=this;return function(lb){ya.hDb.uca("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",lb.data,"Failure");ya.UYf(2);ya.Slb.CFj(ya.l8g(V))}};vf.prototype.UYf=function(V,ya,lb){this.Ro.state=V;this.Ro.F9d=void 0===ya?!1:ya;this.Ro.kLc=void 0===lb?!1:lb;this.y8c(this.Ro)};vf.ZM=function(){return new vf(new ud.a(function(){return Ad.instance}),
new ud.a(function(){return zc.AFrameworkApplication.aUh}))};vf.ajf=function(V){if(!V)return Rb.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Af.a.Wl(V).startsWith("https://"))return!0;Rb.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1};Ck.Object.defineProperties(vf.prototype,{hDb:{configurable:!0,enumerable:!0,get:function(){return this.x2.value}}});Ck.Object.defineProperties(vf,{instance:{configurable:!0,enumerable:!0,
get:function(){return vf.Ma||(vf.Ma=vf.ZM())}}});vf.Gee="PersonalFileStorageUrl";vf.Cie="StorageServiceDisplayName";vf.Ma=null;Object(ie.a)(vf,"GetMoreInfoActor",Le,[]);var jf=b(103),Ef=b(97);of.prototype.NUc=function(V){this.Za.addHandler(this.ole,V)};of.prototype.xCg=function(V){this.Za.addHandler(this.R$e,V)};of.prototype.uFj=function(){var V=new Se.a(5,2,this.Sqg,Object(Re.a)(this,this.Q9h,"inactiveLoop"),108);this.R9h.Yg(V)};of.prototype.Q9h=function(){var V=this.E0e(),ya=this.Iw()-V;if(ya>this.IAc&&
this.XT){var lb={};Rb.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(lb.TimeSinceLastActive=ya,lb));this.XT=!1;this.Za.raiseEvent(this.R$e)}V-this.Cae>this.IAc&&(this.XT=!0,this.Za.raiseEvent(this.ole));this.Cae=V};of.ZM=function(){return new of(new ud.a(function(){return jf.a.instance}),function(){return zc.AFrameworkApplication.Ykf.getTime()},function(){return(new Date).getTime()},new ud.a(function(){return zc.AFrameworkApplication.IAc}),!0)};Ck.Object.defineProperties(of.prototype,{R9h:{configurable:!0,
enumerable:!0,get:function(){return this.se.value}},E0e:{configurable:!0,enumerable:!0,get:function(){return this.Tpg}},Iw:{configurable:!0,enumerable:!0,get:function(){return this.OJc}},IAc:{configurable:!0,enumerable:!0,get:function(){return this.FXb.value}}});Ck.Object.defineProperties(of,{instance:{configurable:!0,enumerable:!0,get:function(){return of.Ma||(of.Ma=of.ZM())}}});of.Ma=null;Object(ie.a)(of,"InactivityManager",null,[]);var Xf=b(83),ug=b(1111);Am(kf,ee);kf.prototype.X2e=function(){return"MruActor Result"};
Ck.Object.defineProperties(kf.prototype,{Xxd:{configurable:!0,enumerable:!0,get:function(){return this.Jce}},Krf:{configurable:!0,enumerable:!0,get:function(){return this.Kce}},Wxd:{configurable:!0,enumerable:!0,get:function(){return this.Ice}},OKj:{configurable:!0,enumerable:!0,get:function(){return this.xje}}});Object(ie.a)(kf,"MruResult",ee,[677,676]);var Wb=b(243);Ve.prototype.Fli=function(V,ya){return V===Wb.a.tcd||20===ya||18===ya||3===ya};Ve.prototype.Qmi=function(V){return 3===V||5===V||6===
V||7===V||9===V||10===V||11===V||12===V||13===V||14===V||15===V||16===V||23===V||26===V||27===V||28===V};Ve.prototype.reset=function(){this.Jyb=this.retryCount=0;this.IPc=this.wBb=null;this.task&&(this.taskManager.aq(this.task),this.task=null)};Ve.prototype.Kci=function(V,ya,lb,Kb){this.IPc=String.format("{0}_{1}",lb,Kb);if(this.retryCount>=this.pAi)return Rb.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Fli(lb,Kb))return Rb.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.Qmi(Kb)&&1<=this.Jyb)return this.wBb=lb,!1;ya=Math.max(ya,this.tfc*Math.pow(2,this.Jyb));if(26===Kb)ya=Math.max(ya,3E4);else if(27===Kb||28===Kb)ya=Math.max(ya,6E4);9===Kb||412===lb&&(null==this.wBb||412!==this.wBb)?ya=500:this.Jyb+=1;this.wBb=lb;this.retryCount+=1;this.task&&this.taskManager.aq(this.task);Rb.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ya);this.task=new Se.a(2,1,ya,V,107);this.taskManager.Yg(this.task);return!0};Ck.Object.defineProperties(Ve.prototype,
{brc:{configurable:!0,enumerable:!0,get:function(){return this.IPc}}});Object(ie.a)(Ve,"RetryManager",null,[]);var Kc=b(100),Id=b(134);Object(ie.a)(Tc,"WriteOptions",null,[]);var Bd=b(619),oe=b(356);Am(Pd,Le);Pd.prototype.u$i=function(){this.Xw.B9a.fc(vg.a.renameMostRecentlyUsedFileEntry,qf.a.frame,Object(Re.a)(this,this.nej,"renameMruEntry"))};Pd.prototype.nej=function(){return this.N0d("Rename")};Pd.prototype.Zyi=function(){this.Ppf("File Opened")};Pd.prototype.$yi=function(){this.Ppf("IntervalUpdate")};
Pd.prototype.Ppf=function(V){var ya={};Rb.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(ya.Trigger=V,ya));this.N0d(V)};Pd.prototype.Z4=function(V){(V=Af.a.Z4(V))&&V.startsWith(".")&&(V=V.substring(1,V.length));return V};Pd.prototype.VXe=function(){switch(this.Xw.Fca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};Pd.prototype.Y0h=function(V){var ya=this.Ppg();if(!ya)return null;var lb=new Tc;
lb.documentUrl=this.a7d.value?encodeURI(ya):ya;lb.mruItemId=this.OUb;lb.app=this.VXe();if(ya=this.aw())lb.folderName=ya.breadcrumbFolderName,ya=ya.hn,lb.documentName=Af.a.Hq(ya),lb.documentExt=this.Z4(ya);V&&(lb.documentName?lb.documentName.length?255<=lb.documentName.length?V.set("DocumentNameLength","Long"):2084<=lb.documentName.length&&V.set("DocumentNameLength","VeryLong"):V.set("DocumentNameLength","0"):V.set("DocumentNameLength","Null"));return JSON.stringify(lb)};Pd.prototype.N0d=function(V,
ya){ya=void 0===ya?!1:ya;if(4===this.Xw.Fca&&!zc.AFrameworkApplication.oua)return 2;var lb=Id.a.Yr();lb&&(lb.set("Trigger",V),lb.set("IsRetry",ya?"true":"false"),lb.set("MruIdSent",this.OUb?"true":"false"),lb.set("URLEncoded",this.a7d.value?"true":"false"));Kc.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",lb);V=this.Y0h(lb);if(!V)return ya=!zc.AFrameworkApplication.webEditingEnabled,lb&&(lb.set("WebEditingIsEnabled",zc.AFrameworkApplication.webEditingEnabled?"true":"false"),lb.set("ProtectedFile",
zc.AFrameworkApplication.orc?"true":"false")),Kc.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ya,!1,Object.assign(new oe.a,{extendedProperties:lb})),2;this.Xra&&!ya&&this.Xra.reset();lb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Xw.LW,this.localeName);this.Jke?this.SDc["X-FileId"]=zc.AFrameworkApplication.oj:lb+=String.format("&{0}",zc.AFrameworkApplication.oj);zc.AFrameworkApplication.dc&&(this.SDc["X-Office-AudienceGroup"]=Object(Xf.a)(String,zc.AFrameworkApplication.dc.AudienceGroup)||
"");this.SDc["X-Timeout"]=15E3;return this.Xw.zDb.hm(lb,2,V,this.SDc,!0,5,Object(Re.a)(this,this.BYj,"writeMruV2EntryOnServerSuccessCallback"),Object(Re.a)(this,this.Tah,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};Pd.prototype.BYj=function(V){this.Z6e(V.data)};Pd.prototype.Z6e=function(V){var ya=Id.a.Yr();this.Xra&&(ya&&this.Xra.brc&&(ya.set("LastError",this.Xra.brc),ya.set("NumRetries",this.Xra.retryCount.toString())),this.Xra.reset());var lb=ug.c(V.me);
lb&&lb.diagnostics_data&&(this.OUb=lb.diagnostics_data.mru_id);V=+V.S3-+V.tF;ya&&ya.set("RequestDuration",V.toString());Kc.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new oe.a,{extendedProperties:ya}))};Pd.prototype.Tah=function(V){if(V.data.httpStatus===Wb.a.Zrb)this.Z6e(V.data);else{var ya=V.data.httpStatus===Wb.a.HGb,lb=Id.a.Yr();this.k7e(this.Xra,V,this.Iah(),lb);lb&&(lb.set("StatusCode",V.data.httpStatus.toString()),ya||this.WUc(V.data,lb));Kc.Health.instance.recordKpiFailure("WriteMru",
String.format("RequestFailed_{0}",V.data.httpStatus),ya,!1,Object.assign(new oe.a,{extendedProperties:lb}))}};Pd.prototype.Iah=function(){var V=this;return function(){V.N0d("Retry",!0)}};Pd.prototype.hUh=function(){this.d9a("Polling")};Pd.prototype.gUh=function(){this.d9a("Retry",!0)};Pd.prototype.Syi=function(){this.d9a("Open")};Pd.prototype.Ryi=function(){this.d9a("Activity")};Pd.prototype.Qyi=function(){this.d9a("OpenRecentLinks",!1,!0)};Pd.prototype.Pyi=function(){this.d9a("ActivityRecentLinks",
!1,!0)};Pd.prototype.d9a=function(V,ya,lb){ya=void 0===ya?!1:ya;lb=void 0===lb?!1:lb;var Kb={};Rb.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(Kb.Trigger=V,Kb));if(Kb=Id.a.Yr())Kb.set("Trigger",V),Kb.set("IsRetry",ya?"true":"false"),lb&&Kb.set("RecentLinks","true");Kc.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Kb);this.tra&&!ya&&this.tra.reset();lb?this.PEe(Object(Re.a)(this,this.iUh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(Re.a)(this,this.eUh,"getMruForRecentLinksFromServerFailureCallback"),
!0):this.PEe(Object(Re.a)(this,this.jUh,"getMruV2FromServerSuccessCallback"),Object(Re.a)(this,this.fUh,"getMruFromServerFailureCallback"))};Pd.prototype.WUc=function(V,ya){V&&V.responseHeaders&&(V=V.responseHeaders["X-CorrelationId"])&&ya.set("ServerCorrelationId",V)};Pd.prototype.Kvi=function(V,ya){V&&(ya&&ya.set("RequestDuration",(+V.S3-+V.tF).toString()),Kc.Health.instance.recordKpiSuccess("GetMru",Object.assign(new oe.a,{extendedProperties:ya})))};Pd.prototype.jUh=function(V){this.g1e(V)};Pd.prototype.g1e=
function(V,ya){ya=void 0===ya?!1:ya;var lb="",Kb=null,Lb=null,Xa=null,od=ug.c(V.data.me);od&&(Kb=od.places?od.places.items:[],Lb=od.documents?od.documents.items:[],(Xa=ug.a(od,ya))&&(lb=Ge.c(Xa)));zc.AFrameworkApplication.sa&&zc.AFrameworkApplication.sa.Pa.K_&&Md.c()&&!ya&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(lb,!0));lb=Id.a.Yr();this.tra&&(lb&&this.tra.brc&&(lb.set("LastError",this.tra.brc),lb.set("NumRetries",this.tra.retryCount.toString())),this.tra.reset());ya&&lb&&lb.set("RecentLinks",
"true");Xa||Kb||Lb?(ya?this.Xw.uca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",V.data,"Success"):this.Xw.uca("MruActor.GetMruV2FromServerSuccessCallback",V.data,"Success"),this.zCc(3,Xa,Kb,Lb),this.Kvi(V.data,lb)):(ya?this.Xw.uca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",V.data,"Failure: Invalid JSON"):this.Xw.uca("MruActor.GetMruV2FromServerSuccessCallback",V.data,"Failure: Invalid JSON"),lb&&this.WUc(V.data,lb),Kc.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",
!1,!1,Object.assign(new oe.a,{extendedProperties:lb})),this.zCc(3,null,null,null,!0));this.y8c(this.$T)};Pd.prototype.iUh=function(V){this.g1e(V,!0)};Pd.prototype.k7e=function(V,ya,lb,Kb){var Lb=0,Xa=0,od=ug.c(ya.data.me);od&&(null!=od.response_code&&(Lb=od.response_code,Kb&&Kb.set("MruResponseCode",Lb.toString()),9===Lb&&(this.OUb="")),od.error_data&&null!=od.error_data.retry_after_ms&&(Xa=od.error_data.retry_after_ms,Kb&&Kb.set("ExpectedRetryAfter",Xa.toString())));V&&(ya=V.Kci(lb,Xa,ya.data.httpStatus,
Lb),Kb&&(Kb.set("CurrentRetryCount",V.retryCount.toString()),Kb.set("RetryScheduled",ya?"true":"false")))};Pd.prototype.fUh=function(V){this.f1e(V)};Pd.prototype.f1e=function(V,ya){ya=void 0===ya?!1:ya;var lb=V.data.httpStatus===Wb.a.HGb,Kb=Id.a.Yr();Kb&&(Kb.set("StatusCode",V.data.httpStatus.toString()),ya&&Kb.set("RecentLinks","true"),lb||this.WUc(V.data,Kb));ya?this.Xw.uca("MruActor.GetMruForRecentLinksFromServerFailureCallback",V.data,"Failure"):this.Xw.uca("MruActor.GetMruFromServerFailureCallback",
V.data,"Failure");this.zCc(2);this.k7e(this.tra,V,Object(Re.a)(this,this.gUh,"getMruFromServerRetryTask"),Kb);Kc.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",V.data.httpStatus),lb,!1,Object.assign(new oe.a,{extendedProperties:Kb}));this.y8c(this.$T);zc.AFrameworkApplication.sa&&zc.AFrameworkApplication.sa.Pa.K_&&Md.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),ya||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))};Pd.prototype.eUh=
function(V){this.f1e(V,!0)};Pd.prototype.zCc=function(V,ya,lb,Kb,Lb){if(3!==this.$T.state||3===V)this.$T.Jce=void 0===ya?null:ya,this.$T.Kce=void 0===lb?null:lb,this.$T.Ice=void 0===Kb?null:Kb,this.$T.state=V,this.$T.kLc=void 0===Lb?!1:Lb,this.$T.xje=this.Xw.Iw()};Pd.prototype.FCf=function(V,ya){var lb={};Rb.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(lb.Trigger=V,lb.ResultState=this.$T.state,lb));ya&&3===this.$T.state&&this.OLe(ya,this.$T);return this.$T};Pd.prototype.PEe=function(V,
ya,lb){lb=void 0===lb?!1:lb;this.zCc(1);var Kb={};var Lb=lb?String.format(this.Xw.LW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.gvg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Xw.LW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.VXe(),this.localeName);this.fvg.value||(Lb+="&entity=docs");zc.AFrameworkApplication.dc&&(Kb["X-Office-AudienceGroup"]=Object(Xf.a)(String,zc.AFrameworkApplication.dc.AudienceGroup)||"");lb&&(Kb["X-Office-Application"]=
"147");this.Jke?Kb["X-FileId"]=zc.AFrameworkApplication.oj:Lb+=String.format("&{0}",zc.AFrameworkApplication.oj);this.Xw.zDb.hm(Lb,1,null,Kb,!0,5,V,ya,null)};Pd.ZM=function(){return new Pd(new ud.a(function(){return Ad.instance}),new ud.a(function(){return Bd.a.hK(zc.AFrameworkApplication.lcid).name}),new ud.a(function(){return zc.AFrameworkApplication.sa.Pa.wv}),zc.AFrameworkApplication.ga.ra("MruWriteFileIdInHeader"),function(){return zc.AFrameworkApplication.sa.Pa.Sx},function(){return zc.AFrameworkApplication.Ll},
new ud.a(function(){return zc.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")}))};Ck.Object.defineProperties(Pd.prototype,{SDc:{configurable:!0,enumerable:!0,get:function(){return this.wzg}},Xw:{configurable:!0,enumerable:!0,get:function(){return this.x2.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.Ksg.value}}});Ck.Object.defineProperties(Pd,{instance:{configurable:!0,enumerable:!0,get:function(){return Pd.Ma||(Pd.Ma=Pd.ZM())}}});Pd.Ma=null;Object(ie.a)(Pd,"MruActor",
Le,[]);vb.prototype.fi=function(V){this.tb=V;V.register(628,"Common.INewAndOpenCommonHelpers").Ic().Oc(function(){return Ad.instance});V.register(629,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Ic().Oc(function(){return vf.instance});V.register(629,"Common.IEventEmitter<Common.IMruResult>").Ic().Oc(function(){return Pd.instance})};vb.prototype.init=function(){var V=this;zc.AFrameworkApplication.ga.tv(function(){V.uyb()})};vb.prototype.uyb=function(){this.tb.resolve("Common.INewAndOpenCommonHelpers");
this.tb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.tb.resolve("Common.IEventEmitter<Common.IMruResult>");var V=!1;Ad.instance.G8i();zc.AFrameworkApplication.ama&&(V=!0);zc.AFrameworkApplication.VMf&&(Pd.instance.Syi(),zc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Pd.instance.Qyi(),0<zc.AFrameworkApplication.Lrf&&this.Ime(),this.xvj(),V=!0);zc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&V&&vf.instance.Oyi();
zc.AFrameworkApplication.VSj&&(V=Pd.instance,V.u$i(),V.Zyi(),jf.a.instance.Yg(this.WSj))};vb.prototype.xvj=function(){of.instance.NUc(Object(Re.a)(Pd.instance,Pd.instance.Ryi,"makeGetMruRequestActivityTrigger"));zc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&of.instance.NUc(Object(Re.a)(Pd.instance,Pd.instance.Pyi,"makeGetMruForRecentLinksRequestActivityTrigger"));of.instance.NUc(Object(Re.a)(this,this.Ime,"addGetMruFromServerTask"));of.instance.xCg(Object(Re.a)(this,
this.Tdh,"deleteGetMruFromServerTask"))};vb.prototype.Tdh=function(){jf.a.instance.aq(this.Mrf)};vb.prototype.Ime=function(){jf.a.instance.Yg(this.Mrf)};vb.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.Rmb&&(jf.a.instance.aq(this.Rmb),this.Rmb=null))};Ck.Object.defineProperties(vb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},Mrf:{configurable:!0,enumerable:!0,get:function(){return this.Dfe||(this.Dfe=new Se.a(5,2,zc.AFrameworkApplication.Lrf,
Object(Re.a)(Pd.instance,Pd.instance.hUh,"getMruFromServerTask"),109))}},WSj:{configurable:!0,enumerable:!0,get:function(){return this.Rmb||(this.Rmb=new Se.a(2,2,6E4*zc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(Re.a)(Pd.instance,Pd.instance.$yi,"makeUpdateMruTask"),197))}}});Object(ie.a)(vb,"CorePackageManager",null,[4,5,2]);var Hd=b(556);new Ue(0,0,0,0,0,0);new Ue(1,1,0,0,0,0);new Ue(2,2,0,0,0,0);new Ue(3,3,0,0,0,1);new Ue(4,
3,1,0,1,1);new Ue(5,3,0,0,.42,1);new Ue(6,3,.83,0,1,1);new Ue(7,3,0,0,.58,1);new Ue(8,3,.42,0,.58,1);new Ue(9,3,.1,.25,.75,.9);new Ue(10,3,.1,.9,.2,1);new Ue(11,3,.1,.9,.2,1);new Ue(12,3,.9,.1,.2,1);new Ue(13,3,.4,0,0,1);new Ue(14,3,.13,.21,.1,.7);new Ue(15,3,.02,.33,.38,.77);new Ue(16,3,.57,.17,.95,.75);new Ue(17,3,0,.19,.07,.72);new Ue(18,3,0,0,.95,.37);new Ue(19,3,.66,0,.34,1);new Ue(20,3,.8,0,.2,1);new Ue(21,3,.8,0,.2,1);pe.prototype={type:0,startTime:new ef(0,null),endTime:new ef(0,null),W0j:new ef(0,
null),E_j:new ef(0,null),operationType:0};new Ne(0,[new pe(5,0,0,0,null,1,1,0)]);new Ne(1,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,50,null,1,1,0)]);new Ne(2,[new pe(1,3,0,167,null,0,1,1),new pe(2,3,0,167,null,0,1,1)]);new Ne(3,[new pe(3,3,0,167,null,0,1,1),new pe(4,3,0,167,null,0,1,1)]);new Ne(4,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,167,null,1,1,0)]);new Ne(5,[new pe(5,2,0,167,null,0,1,0)]);new Ne(6,[new pe(1,3,0,100,null,0,1,1),new pe(2,3,0,100,null,0,1,1)]);new Ne(7,[new pe(3,3,0,100,null,0,
1,1),new pe(4,3,0,100,null,0,1,1)]);new Ne(8,[new pe(5,2,0,100,null,1,1,0)]);new Ne(9,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,100,null,1,1,0)]);new Ne(10,[new pe(5,2,0,100,null,0,1,0)]);new Ne(11,[new pe(1,3,0,267,null,0,1,1),new pe(2,3,0,267,null,0,1,1)]);new Ne(12,[new pe(3,3,0,267,null,0,1,1),new pe(4,3,0,267,null,0,1,1)]);new Ne(13,[new pe(5,2,0,267,null,1,1,0)]);new Ne(14,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,267,null,1,1,0)]);new Ne(15,[new pe(5,2,0,267,null,0,1,0)]);new Ne(16,[new pe(6,
3,0,267,null,0,1,1),new pe(7,3,0,267,null,0,1,1)]);new Ne(17,[new pe(1,3,0,750,null,0,1,1),new pe(2,3,0,750,null,0,1,1)]);new Ne(18,[new pe(3,3,0,750,null,0,1,1),new pe(4,3,0,750,null,0,1,1)]);new Ne(19,[new pe(5,2,0,750,null,1,1,0)]);new Ne(20,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,750,null,1,1,0)]);new Ne(21,[new pe(6,3,0,1E3,null,0,1,1),new pe(7,3,0,1E3,null,0,1,1)]);new Ne(22,[new pe(1,3,0,367,null,0,1,1),new pe(2,3,0,367,null,0,1,1)]);new Ne(23,[new pe(3,3,0,367,null,0,1,1),new pe(4,3,0,367,
null,0,1,1)]);new Ne(24,[new pe(5,2,0,367,null,1,1,0)]);new Ne(25,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,367,null,1,1,0)]);new Ne(26,[new pe(5,2,0,367,null,0,1,0)]);new Ne(27,[new pe(5,2,0,0,null,1,1,0),new pe(5,2,0,50,null,0,1,0)]);new Ne(28,[new pe(1,3,0,433,null,0,1,1),new pe(2,3,0,433,null,0,1,1)]);new Ne(29,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,50,null,1,1,0),new pe(2,3,0,0,null,40,1,1),new pe(2,3,0,100,null,0,1,1)]);new Ne(30,[new pe(2,0,0,0,null,32,1,1),new pe(2,0,0,100,null,32,1,1),new pe(2,
3,101,350,null,0,1,1),new pe(3,0,0,0,null,0,2,1),new pe(3,0,0,100,null,0,2,1),new pe(3,3,101,350,null,0,1,1),new pe(5,0,0,0,null,0,2,0),new pe(5,0,0,100,null,1,1,0)]);new Ne(31,[new pe(2,3,0,267,null,32,1,1),new pe(3,3,0,267,null,0,2,1),new pe(5,2,0,0,null,1,0,0),new pe(5,2,0,267,null,0,2,0)]);new Ne(32,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,100,null,0,2,0),new pe(5,2,101,267,null,1,1,0)]);new Ne(33,[new pe(1,10,0,300,null,0,1,1),new pe(2,10,0,300,null,0,1,1)]);new Ne(34,[new pe(3,10,0,300,null,
0,1,1),new pe(4,10,0,300,null,0,1,1)]);new Ne(35,[new pe(1,8,0,750,null,0,1,1),new pe(2,8,0,750,null,0,1,1)]);new Ne(36,[new pe(5,2,0,0,null,0,2,0),new pe(5,2,0,200,null,0,2,0),new pe(5,3,201,500,null,1,1,0)]);new Ne(37,[new pe(1,2,0,0,null,0,2,1),new pe(2,2,0,0,null,0,2,1),new pe(1,2,0,200,null,0,2,1),new pe(2,2,0,200,null,0,2,1),new pe(1,3,201,267,null,0,1,1),new pe(2,3,201,267,null,0,1,1)]);new Ne(38,[new pe(1,3,0,267,null,0,1,1),new pe(2,3,0,267,null,0,1,1)]);new Ne(39,[new pe(5,2,0,0,null,0,
2,0),new pe(5,2,0,267,null,1,1,0)]);new Ne(40,[new pe(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(V){window.setTimeout(V,16)}}();gg.prototype={Pe:null,eKg:5,uob:null,YWc:0,startTime:null,duration:null,d8b:null,yYc:-1,Exd:-1,Zwd:-1};gg.prototype.Start=
function(){this.startTime=new Date;this.d8b={}};gg.prototype.GetRecentAnimationStats=function(){var V,ya=[],lb=0;for(V=we.YWc;V<we.eKg;V++)null!=we.uob[V]&&(ya[lb]=we.uob[V],lb++);for(V=0;V<we.YWc;V++)null!=we.uob[V]&&(ya[lb]=we.uob[V],lb++);return ya};gg.prototype.GetAnimationSqmStats=function(){var V=[];return V[0]=0>we.yYc?0:we.yYc,V[1]=0>we.Exd?0:we.Exd,V[2]=0>we.Zwd?0:we.Zwd,V};var we=new gg;var df=b(226),sf=b(254),wf=b(740),$e=b(91),pf=b(88),bg=b(272),Zd=b(165),Ma=b(75),Hb=b(393),ic=b(51),Lc=
b(36),td=b(95),pd=b(72),Qe=b(636),ff=pf.a;Am(qc,ff);qc.prototype.dispose=function(){this.$&&bg.a(this.$).Ldj(this.Szf);this.wb=null;Array.clear(this.y9);ff.prototype.dispose.call(this)};qc.prototype.j2i=function(V){this.P6(V)};qc.prototype.Drf=function(V,ya,lb,Kb){Kb=void 0===Kb?null:Kb;var Lb=this.THj(V,ya,void 0===lb?!0:lb,Kb);if(!Lb){lb=ya;var Xa=V?1:-1,od=this.itd;do{Lb=!1;if(Ma.a(this.$.ya,27)){if(lb+=Xa,lb>=od.length||0>lb)Lb=!0}else lb=(lb+Xa+od.length)%od.length;if(Lb){this.Nxi(V,ya,Kb);break}else if(Lb=
this.SHj(V,ya,lb,Kb))break}while(lb!==ya)}};qc.prototype.THj=function(V,ya,lb,Kb){Kb=void 0===Kb?null:Kb;var Lb=null;0<=ya&&(Lb=this.y9[ya]);return(null===Lb||void 0===Lb?0:Lb.canReceiveFocus)&&Lb.Wf(V,void 0===lb?!0:lb)?(Kb&&pd.g(Kb),Rb.ULS.sendTraceTag(537166669,0,50,"Switched focus inside current section {0} into a sub region",Lb.ve),Lb.Ej(),!0):!1};qc.prototype.SHj=function(V,ya,lb,Kb){Kb=void 0===Kb?null:Kb;lb=this.y9[lb];if((null===lb||void 0===lb?0:lb.canReceiveFocus)&&lb.Wf(V,!1)){Kb&&pd.g(Kb);
lb.Ej();if(V=this.y9[ya])V.Rj(),Rb.ULS.sendTraceTag(537166668,0,50,"Switched focus from section {0} to {1}",V.ve,lb.ve);return!0}return!1};qc.prototype.Nxi=function(V,ya,lb){(lb=void 0===lb?null:lb)&&pd.g(lb);if(ya=this.y9[ya])ya.Rj(),Rb.ULS.sendTraceTag(537166666,0,50,"Lost focus from section {0}",ya.ve);Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(this.$.da,21,137,0),function(Kb){var Lb={};Kb.result.Jj(tc.a.bnb,(Lb[$b.a.direction]=V?"forward":"backward",Lb))},this.$.la)};qc.prototype.P6=function(V){var ya=
this.$.isEditMode?Zd.a(this.$):null;if(!this.$.zb.oxa||qc.Yji(ya))if(117===V.keyCode&&(V.ctrlKey||pd.b(V))){ya=this.tYh(V.target);var lb=!V.shiftKey;Rb.ULS.sendTraceTag(537166662,0,50,"AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: {0}",ya);zc.AFrameworkApplication.sa.Pa.Lz&&this.$.jla&&1===ya&&1===this.$.Eyc&&wf.ShyRibbon.pQ(1,0);this.Drf(lb,ya,!0,V)}else 117!==V.keyCode||qc.dTe?-411645385===this.$.shortcutKeyManager.du(V)?this.pff()&&(ya={},this.$.Ka.$b(new td.a(-411645385,
1,this.$.fd,6,null),(ya.event=V,ya),V),V.stopPropagation()):1588554917===this.$.shortcutKeyManager.du(V)?0===this.mode?(Qe.a(this.$)||(ya={},this.$.Ka.$b(new td.a(1588554917,1,this.$.fd,6,null),(ya.event=V,ya),V)),V.preventDefault(),V.stopPropagation()):3===this.mode&&(V.preventDefault(),V.stopPropagation()):this.W3h(V):(V=Hb.a.gz.notificationBar.laa($e.a.IPh(),!1),V.image=0,Hb.a.gz.notificationBar.oE(V),qc.dTe=!0)};qc.prototype.tYh=function(V){for(var ya=this.itd,lb=0,Kb=ya.length;lb<Kb;++lb){var Lb=
ya[lb];if(Lb&&Lb.sh(V))return lb}return-1};qc.prototype.B0e=function(){for(var V=[],ya=0,lb=this.Mxa.length;ya<lb;ya++){var Kb=bg.a(this.$).eN(this.Mxa[ya]);Kb&&V.push(Kb)}return V};qc.prototype.pff=function(){return 0===this.mode||4===this.mode};qc.Yji=function(V){return V?V.inKeytipMode:!1};Ck.Object.defineProperties(qc.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},itd:{configurable:!0,enumerable:!0,get:function(){this.y9.length||(this.y9=this.B0e());return this.y9}},
Mxa:{configurable:!0,enumerable:!0,get:function(){return this.xae},set:function(V){this.xae=V;this.y9=this.B0e()}}});qc.dTe=!1;Object(ie.a)(qc,"AccessibilityManager",pf.a,[646,2]);var hf=b(153),yg=b(22),bf=b(15);Am(fd,qc);fd.prototype.P6=function(V){this.$.Pd&65536&&qc.prototype.P6.call(this,V)};fd.prototype.W3h=function(V){if(yg.a.equals(this.hrj,this.$.shortcutKeyManager.Efd(V),!1)){var ya=hf.b(this.$);if(null===ya||void 0===ya?0:ya.canReceiveFocus)pd.g(V),ya.Wf(!0,!1)}};Ck.Object.defineProperties(fd.prototype,
{mode:{configurable:!0,enumerable:!0,get:function(){return this.eC},set:function(V){this.eC=V;switch(V){case 0:this.Mxa=this.lOg;break;case 2:this.Mxa=this.EWj;break;case 3:this.Mxa=this.K1i;break;case 4:this.Mxa=this.lWg;break;case 5:this.Mxa=this.k1i;break;case 6:this.Mxa=this.u1i;break;default:Rb.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(ie.a)(fd,"EwaAccessibilityManager",qc,[]);var Cg=df.a;Am(sd,Cg);sd.prototype.create=function(){this.Eb(this.$.da.Aa(15)||
new fd(this.$))};sd.ka=function(V){V.da.Ga(157,new sd(V))};Object(ie.a)(sd,"AccessibilityManagerFactory",df.a,[]);var Gg=b(11),xg=b(148),wc=b(694),jd=wc.a;Am(Sc,jd);Sc.prototype.dispose=function(){xg.WacAirSpace.Und()&&xg.WacAirSpace.NAc()};Sc.prototype.animate=function(V,ya,lb,Kb,Lb){ya&&xg.WacAirSpace.yL(V.element,ya);xg.WacAirSpace.animate(V,Kb,Lb);lb&&xg.WacAirSpace.Q$i(V.element,lb)};Object(ie.a)(Sc,"AnimationManager",wc.a,[2]);var xd=b(101),me=b(201),Ae=b(1017),Ze=b(566),Bf=b(85),Qf=b(76),Vg=
Qf.a;Am(Zb,Vg);Zb.prototype.vij=function(){var V=new me.a,ya=Ze.a.dr(Bf.a.instance.lc("Common.IEventEmitter<Common.IMruResult>")),lb=new ud.a(function(){return ya.result});this.aud=new ud.a(function(){return new Ae.a(lb.value,null)});if(!this.aud)return V;var Kb=this.aud.value.Dz("NewAndOpenCoreManager",!1);if(!Kb||3!==Kb.state||!Kb.Wxd)return Kb?Rb.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",Kb.state,!Kb.Wxd):
Rb.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Kb=Kb.Wxd;for(var Lb=["xlsx","xlsb","xlsm"],Xa=0;Xa<Kb.length;Xa++){var od=Kb[Xa];if(!(0>Array.indexOf(Lb,od.extension))){var Yd=String.format("{0}.{1}",od.title,od.extension),ke=ug.b(od,zc.AFrameworkApplication.isRtl);od=od.url;if(Yd&&ke&&od){var Yf={};V.add((Yf[Zb.fileName]=Yd,Yf[Zb.friendlyPath]=ke,Yf[Zb.section]="mru",Yf[Zb.absoluteUrl]=od,Yf))}else od||Rb.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return V};
Zb.prototype.dispose=function(){Vg.prototype.dispose.call(this)};Zb.fileName="FileName";Zb.friendlyPath="FriendlyPath";Zb.section="Section";Zb.absoluteUrl="AbsoluteUrl";Object(ie.a)(Zb,"NewAndOpenCoreManager",Qf.a,[627,2]);var Rf=df.a;Am(oc,Rf);oc.prototype.create=function(){this.Eb(this.$.da.Aa(451)||this.$.da.Ga(451,new Zb(this.$)))};oc.ka=function(V){V.da.Ga(164,new oc(V))};Object(ie.a)(oc,"NewAndOpenCoreFactory",df.a,[]);var De=b(1),Lg=b(31),$d=b(5),le=b(12),lh=b(250),Kf=b(21);dd.F3a=function(V){V=
Af.a.Sf(V||"");return new dd(V)};dd.fac=function(V){return dd.F3a(bf.a.instance.fa(V))};dd.Ucd=function(V){return new dd(bf.a.instance.Wa(V))};dd.dGh=function(V,ya){for(var lb=[],Kb=1;Kb<arguments.length;++Kb)lb[Kb-1]=arguments[Kb];return dd.cGh.apply(null,[bf.a.instance.Ab(V)].concat(lb))};dd.cGh=function(V,ya){for(var lb=[],Kb=1;Kb<arguments.length;++Kb)lb[Kb-1]=arguments[Kb];Kb=lb.length;for(var Lb=Array(Kb),Xa=0;Xa<Kb;Xa++)Lb[Xa]=(lb[Xa]||dd.TLe).Yuc;return new dd(String.format.apply(null,[V].concat(Lb)))};
Ck.Object.defineProperties(dd,{TLe:{configurable:!0,enumerable:!0,get:function(){return dd.Y6d||(dd.Y6d=new dd(""))}},Mvd:{configurable:!0,enumerable:!0,get:function(){return dd.Sbe||(dd.Sbe=dd.Ucd(2).Yuc)}}});dd.Y6d=null;dd.Sbe=null;Object(ie.a)(dd,"SafeHtml",null,[673]);ge.prototype.dispose=function(){this.$&&this.unregister();le.DOMElementExtensions.Af(this.Jha);le.DOMElementExtensions.Af(this.ufa);le.DOMElementExtensions.Af(this.Jga);this.Jga=this.ufa=this.Jha=this.$=null};ge.prototype.setEnabled=
function(V){this.OZf(this.Jga,V)};ge.prototype.Fqj=function(){this.OZf(this.ufa,!0)};ge.prototype.readText=function(V){this.uHb(dd.F3a(V),!0)};ge.prototype.tQa=function(V){this.uHb(dd.F3a(V),!1)};ge.prototype.WMf=function(V,ya){if(1>ya||!V)Rb.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var lb=new Sys.StringBuilder;V=String.format(bf.a.instance.Ab(34),ya,V);fc(lb,V);fc(lb,bf.a.instance.fa(849));this.uHb(dd.F3a(lb.toString()),!1)}};ge.prototype.B6i=function(V,ya,lb){if(1>
lb||1>ya||ya>lb||!V)Rb.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Kb=new Sys.StringBuilder;fc(Kb,V);Kb.append(String.format(bf.a.instance.Ab(55),ya,lb));this.uHb(dd.F3a(Kb.toString()),!1)}};ge.prototype.TMf=function(V){V=this.QXh(V);this.uHb(V,!1)};ge.prototype.uHb=function(V,ya){if(V=V?V.Yuc:null)ya=ya?this.Jga:this.ufa,yg.a.equals(ya.innerHTML,V,!1)&&(V+=dd.Mvd),ya.innerHTML=V};ge.prototype.jbb=function(V,ya){this.Jha.getAttribute($d.a.Asa)!==ya&&this.Jha.setAttribute($d.a.Asa,
ya);V=V?dd.F3a(V).Yuc:"";this.Jha.innerHTML=V};ge.prototype.C6i=function(V,ya,lb,Kb){var Lb=!0;Lb=void 0===Lb?!1:Lb;var Xa=bf.a.instance.Ab(54);Rb.ULS.shipAssertTag(537153949,0,!(void 0===V||null===V));Rb.ULS.shipAssertTag(537153948,0,!(void 0===ya||null===ya));Rb.ULS.shipAssertTag(537153947,0,!(void 0===lb||null===lb));Rb.ULS.shipAssertTag(537153946,0,!(void 0===Kb||null===Kb));Rb.ULS.shipAssertTag(537153945,0,!(void 0===Xa||null===Xa));V=String.format(Xa,V||"",ya||"",lb||"",Kb||"");Lb?this.jbb(V,
$d.a.SZa):this.readText(V)};ge.prototype.SQj=function(V){var ya=this.Jga.style;V?(V=lh.a.q1b(V.cell,ya),ya=V.IL,ya.top=ya.left=ya.bottom=ya.right=null,V.y$()):ya.cssText=""};ge.prototype.QXh=function(V){switch(V){case -1985798686:return dd.fac(12);case -911352779:return dd.fac(11);case 237279923:return dd.fac(13);case -1502853784:return dd.Ucd(81);case -111689794:return dd.Ucd(78);case -287251124:return this.fhd(1300,function(ya){return ya.bold});case -1925065947:return this.fhd(1301,function(ya){return ya.italic});
case 1764140053:return this.fhd(1302,function(ya){return ya.underline})}return null};ge.prototype.register=function(){Rb.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(Rb.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.dGa(this.owf))};ge.prototype.unregister=function(){this.$&&this.$.Ka.RQa(this.owf)};ge.prototype.OZf=function(V,ya){var lb=V===this.ufa;ya?(V.setAttribute($d.a.Asa,$d.a.SZa),
lb&&V.setAttribute($d.a.Rd,$d.a.zsa),V.setAttribute($d.a.bQ,$d.a.Xo),V.removeAttribute($d.a.bQ),V.innerHTML+=" "):(V.removeAttribute($d.a.Asa),lb&&V.removeAttribute($d.a.Rd),V.setAttribute($d.a.bQ,$d.a.yj))};ge.prototype.fhd=function(V,ya){var lb=this.activeCell;if(!lb)return null;ya=ya(lb)?7:8;return dd.dGh(ya,dd.fac(V))};Ck.Object.defineProperties(ge.prototype,{eya:{configurable:!0,enumerable:!0,get:function(){return this.Ssg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,
enumerable:!0,get:function(){return Kf.g(this.$).mc(null)}}});Object(ie.a)(ge,"AriaLiveNotifier",null,[746,738,2]);var Ph=df.a;Am(Xe,Ph);Xe.prototype.create=function(){this.Eb(this.$.da.Aa(211)||new ge(this.$,this.$.xw,this.$.Mf))};Xe.ka=function(V){V.da.Ga(212,new Xe(V))};Object(ie.a)(Xe,"AriaLiveNotifierFactory",df.a,[]);var Da=b(24),Mb=b(220),Bc=b(141),wd=b(65);de.prototype.readText=function(V){V=String.format(bf.a.instance.Ab(30),V);this.oO.setAttribute($d.a.Pt,V);this.nX.setAttribute($d.a.Pt,
V);this.YHj()};de.prototype.dispose=function(){this.L0&&this.L0.parentNode&&this.L0.parentNode.removeChild(this.L0);this.nX=this.oO=this.L0=this.zja=null};de.prototype.X9g=function(V){var ya=V.Lb+"readoutElementWrapper",lb=V.Lb+"readoutElement1",Kb=V.Lb+"readoutElement2";this.L0=document.getElementById(ya);this.L0||(this.L0=document.createElement(Mb.a.div),this.L0.id=ya,this.oO=document.createElement(Mb.a.label),this.oO.id=lb,this.oO.setAttribute(Bc.a.contentEditable,wd.a.hPb),this.oO.setAttribute($d.a.Rd,
$d.a.TZa),this.nX=document.createElement(Mb.a.label),this.nX.id=Kb,this.nX.setAttribute(Bc.a.contentEditable,wd.a.hPb),this.nX.setAttribute($d.a.Rd,$d.a.TZa),this.oO.style.width="0px",this.oO.style.height="0px",this.nX.style.width="0px",this.nX.style.height="0px",this.oO.tabIndex=-1,this.nX.tabIndex=-1,this.L0.appendChild(this.oO),this.L0.appendChild(this.nX),V=V.Lb+$d.a.a3c,ya=document.getElementById(V),Rb.ULS.shipAssertTag(537153942,3,!!ya,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",
V),ya&&ya.appendChild(this.L0))};de.prototype.E0i=function(){this.zja&&this.oO&&this.nX&&(this.zja.setAttribute($d.a.r3,this.oO.id),this.zja.setAttribute($d.a.HXc,String.format("{0} {1}",this.oO.id,this.nX.id)))};de.prototype.YHj=function(){if(this.isActive){var V="";le.DOMElementExtensions.hasAttribute(this.zja,$d.a.r3)&&(V=this.zja.getAttribute($d.a.r3).toString());this.zja.setAttribute($d.a.r3,V===this.oO.id?this.nX.id:this.oO.id)}else Rb.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};
de.Q6a=function(){if(null==de.Kub)if(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!Da.a.jNa)de.Kub=!0,Rb.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(de.Kub=!1,Da.a.$H||Da.a.Hf)de.Kub=!0,Rb.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return de.Kub};de.ka=function(V){de.Q6a()&&V.da.Ga(244,
new de(V,Kf.g(V).Ac.textBox.lf))};Ck.Object.defineProperties(de.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.zja&&document.activeElement===this.zja}}});de.Kub=null;Object(ie.a)(de,"FocusBasedReadout",null,[738,2]);var Nd=df.a;Am(Qc,Nd);Qc.prototype.create=function(){var V=this;de.Q6a()?Kf.g(this.$).Ac.textBox.SU(function(){var ya=V.$.da.Aa(244)||new de(V.$,Kf.g(V.$).Ac.textBox.lf);V.Eb(ya)}):this.Eb(null)};Qc.ka=function(V){V.da.Ga(315,new Qc(V))};Object(ie.a)(Qc,
"FocusBasedReadoutFactory",df.a,[]);var Pe=b(7),He=b(90),ue=b(25),Ia=b(45),cb=b(248),Xb=b(47),yc=b(44),Xc=b(120);gd.Xgd=function(V){return gd.B2e(V.toString())};gd.B2e=function(V){return gd.FXg.test(V)?V.replace(gd.r5i,"$1 ").replace(gd.q5i,' "$1"').trim():V};gd.Xej=function(V){var ya=V.lastIndexOf("!");return V.substring(0,-1<ya?ya+1:0)+gd.B2e(V.substring(-1<ya?ya+1:0,V.length))};Ck.Object.defineProperties(gd,{r5i:{configurable:!0,enumerable:!0,get:function(){return gd.vfe||(gd.vfe=RegExp("([A-Z]+)",
"g"))}},q5i:{configurable:!0,enumerable:!0,get:function(){return gd.ufe||(gd.ufe=RegExp("([A-Z])","g"))}},FXg:{configurable:!0,enumerable:!0,get:function(){return gd.q4d||(gd.q4d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});gd.vfe=null;gd.ufe=null;gd.q4d=null;Object(ie.a)(gd,"RangeAriaExtensions",null,[]);Object(ie.a)(rc,"SelectionReadoutState",null,[]);var Od=b(63),Ud=b(79);Wd.prototype.dispose=function(){this.$&&
this.wm();He.a.Ha(this.t0b);this.sparklineManager=this.$=this.t0b=null};Wd.prototype.yYe=function(V,ya,lb){lb=void 0===lb?!0:lb;if(!V)return"";var Kb=this.$.da,Lb=new Sys.StringBuilder;this.RKg(Lb,V,ya);if(De.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Xa=this.tableManager.Sva(V.range);(null===Xa||void 0===Xa?0:Xa.GSd)&&this.rre(Lb,Xa);Xa=this.tableManager.tn(V.range);(null===Xa||void 0===Xa?0:Xa.yba)&&this.rre(Lb,Xa)}Xa=V.wba?this.f0e(V):V.text;fc(Lb,Xa);Xa=this.$.activeItemName;
this.xD.activeItemName!==Xa&&(fc(Lb,Xa),this.xD.activeItemName=Xa);Xa=1===ya.length?Ia.K(ya).isSingle?"":bf.a.instance.fa(845):String.format(bf.a.instance.Ab(31),ya.length);fc(Lb,Xa);Xa=Cl(ya);for(var od=Xa.next();!od.done;od=Xa.next())od=od.value,fc(Lb,gd.Xgd(od)),1===ya.length&&Wd.Xoi(od)&&(od=Kf.g(this.$).Ea.hs(od.bottomRight),void 0!==od&&null!==od&&od.text&&(od=od.wba?this.e0e(od,od.text):od.text,fc(Lb,od)));Xa=V.cell;Xa=this.sVh(Xa.zjj,Xa.L_g);fc(Lb,Xa);this.BKg(Lb,V);lb&&(V.q7a?fc(Lb,bf.a.instance.fa(833)):
V.ZMa&&fc(Lb,bf.a.instance.fa(834)));if(V.hasAutoFilter||V.p5)this.SKg(Lb,V.hasAutoFilter?V.cell.ipb:V.cell.gZi),lb&&fc(Lb,bf.a.instance.fa(836));cb.c(this.$,V.range)&&fc(Lb,bf.a.instance.fa(840));this.yKg(Lb,V);lb=(lb=Kb.Aa(14))?lb.eKh():"";fc(Lb,lb);V.LH&&(lb=Kf.g(this.$).Ea.hs(V.range),lb=!!lb&&lb.e8e,Wd.Ewj(V)?Wd.zKg(Lb,V):De.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&lb?fc(Lb,bf.a.instance.fa(838)):fc(Lb,bf.a.instance.fa(837)));V.vba&&(fc(Lb,bf.a.instance.fa(839)),
V.nxb&&fc(Lb,String.format(bf.a.instance.Ab(16),V.ech)),fc(Lb,V.iconName));V.hasRichValueIcon&&(Xa=this.$.da.Aa(271),lb="",Xa&&V.cell.Dlf&&(Xa=Xa.PQ(V.cell.Dlf))&&Xa.DomainId.Id!==Wd.UXj&&(lb=Xa.Name),V.cell.Mfi?(fc(Lb,String.format(bf.a.instance.Ab(178),lb)),fc(Lb,bf.a.instance.fa(1772))):(fc(Lb,String.format(bf.a.instance.Ab(176),lb)),fc(Lb,bf.a.instance.fa(1771))));this.r6h(V)&&fc(Lb,Wd.XQh(V));(Kb=Kb.Aa(231))&&fc(Lb,Kb.u0e(ya,!0));1===ya.length&&ya[0].isSingle&&Wd.Dwj(V,ya[0],this.$)&&(ya=this.$.da.Aa(271))&&
fc(Lb,ya.pKh());V.MNb&&V.NNb&&fc(Lb,V.NNb);(ya=V.cell.rWg)&&fc(Lb,ya);De.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&V.ela&&V.rGb&&(V=V.CEd)&&(fc(Lb,bf.a.instance.fa(1935)),fc(Lb,V));return Lb.toString()};Wd.prototype.swe=function(V){this.Tsa=this.xD;this.xD=Object(Pe.a)(new rc,{activeItemName:this.Tsa.activeItemName,Zzc:V?this.Tsa.Zzc:!1,tableName:V?this.Tsa.tableName:"",C0a:V?this.Tsa.C0a:-1})};Wd.prototype.tUf=function(){this.Tsa&&(this.xD=this.Tsa,this.Tsa=null)};Wd.prototype.sVh=
function(V,ya){return 2===V||2===ya?bf.a.instance.fa(866):1===V||1===ya?bf.a.instance.fa(867):""};Wd.prototype.f0e=function(V){return this.e0e(V.cell,V.text)};Wd.prototype.RKg=function(V,ya,lb){if(lb&&1===lb.length&&lb[0].isSingle){lb="";var Kb=this.tableManager.Sva(ya.range);if(Kb)lb=Kb.pivotTableName,this.gXc(V,lb),this.tre(V,!0,lb,Kb.Pgc?bf.a.instance.fa(828):""),fc(V,this.tableManager.Xmi(Kb,ya.range)?bf.a.instance.fa(830):""),fc(V,this.tableManager.chi(Kb,ya.range)?bf.a.instance.fa(829):"");
else if(Kb=this.tableManager.tn(ya.range)){var Lb=Kf.g(this.$).Rb.Qj(ya.range);lb=Lb?Lb.name:"";this.gXc(V,lb);var Xa="";Lb&&De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Xa=(Lb.wTa?Lb.wTa+" . ":"")+(Lb.xTa?Lb.xTa:""));this.tre(V,!1,lb,Xa);fc(V,this.tableManager.Oef(Kb,ya.range)?bf.a.instance.fa(829):"")}else this.gXc(V,lb),this.xD.tableName="",this.xD.C0a=-1}};Wd.prototype.gXc=function(V,ya){ya!==this.xD.tableName&&this.xD.tableName&&(V.append(bf.a.instance.fa(this.xD.Zzc?
827:826)),fc(V," "+this.xD.tableName))};Wd.prototype.tre=function(V,ya,lb,Kb){lb!==this.xD.tableName&&(V.append(bf.a.instance.fa(ya?825:824)),fc(V," "+lb),fc(V,Kb),this.xD.tableName=lb,this.xD.Zzc=ya,this.xD.C0a=-1)};Wd.prototype.rre=function(V,ya){var lb=Kf.g(this.$).ha.ta.activeCell;if(lb.top!==ya.top&&lb.left!==this.xD.C0a){V.append(bf.a.instance.fa(829));ya=new ue.Range(ya.top,lb.left,ya.top,lb.left,!0,!0);fc(V,gd.Xgd(ya));if(ya=Kf.g(this.$).mc(ya))ya=ya.wba?this.f0e(ya):ya.text,fc(V,ya);this.xD.C0a=
lb.left}};Wd.prototype.e0e=function(V,ya){var lb=V.T5a;return V.qxb?String.format(bf.a.instance.Ab(14),ya,lb):String.format(bf.a.instance.Ab(13),ya,gd.Xej(lb))};Wd.prototype.Ek=function(){Rb.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var V=Kf.g(this.$);Rb.ULS.shipAssertTag(537153929,0,!!V,"Can't register to grid's events");V&&(V.rc.sl(this.Ep),V.Ea.Ix(this.tda),V.rE(this.tda),this.dbb&&V.rc.To(this.Ng.bind(this)),V=V.ha,Rb.ULS.shipAssertTag(537153928,
0,!!V,"Can't register to selectionManager's events"),V&&(V.WG(this.kd),V.FJ(this.tda),V.Oa.i3(this.tda),this.dbb&&(this.RHd=this.RHd.bind(this))))}};Wd.prototype.wm=function(){if(this.$){var V=Kf.g(this.$);V&&(V.rc.kl(this.Ep),V.Ea.Fv(this.tda),V.aG(this.tda),this.dbb&&V.rc.Zn(this.Ng),V=V.ha)&&(V.cG(this.tda),V.tO(this.tda),V.Oa.ina(this.tda))}};Wd.prototype.readText=function(V,ya){this.Q6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(V):(De.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(V),this.dbb&&!ya||this.ariaLiveNotifier.SQj(ya))};Wd.prototype.Ng=function(){this.Uob&&this.Uob.cancel()};Wd.prototype.RHd=function(){this.readText(this.AYh())};Wd.prototype.AYh=function(){var V=this,ya="";Kf.g(this.$).ha.rangePicker.fL.forEach(function(lb){ya+=V.qZh(lb)});return ya+=" selected"};Wd.prototype.qZh=function(V){return" "+(V.sheetId!==Od.d(this.$.qa)?this.$.xa.whd(V.sheetId).name:"")+" "+V.range.topLeft+" "+(V.range.isSingle?
"":V.range.bottomRight)};Wd.prototype.gJh=function(){var V=null;var ya=Kf.g(this.$).ha;if(1!==ya.Ue&&!ya.Oa.oc)return Rb.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",ya.Ue),{returnValue:"",activeCell:V};switch(ya.Ue){case 2:return{returnValue:this.$Lh(ya),activeCell:V};case 64:var lb=ya.Oa.oc.floatingObject,Kb="";if(ya=ya.Oa.oc.Gs||ya.Oa.oc.Qd)Kb=(Kb=ya.firstChild)?le.DOMElementExtensions.getTextContent(Kb):
"";return{returnValue:String.format(bf.a.instance.Ab(53),Wd.uac(lb.altText,lb.altTextDescription,lb.name),Kb,lb.altTextDescription),activeCell:V};case 4:return{returnValue:Wd.LJg(ya.Oa.oc.floatingObject),activeCell:V};case 512:return{returnValue:Xc.a.UZe(ya.Oa.oc.floatingObject.c8c),activeCell:V};case 8:return lb=(lb=ya.Oa.oc.floatingObject)?lb.name:"",{returnValue:String.format(bf.a.instance.Ab(51),lb),activeCell:V};case 1:return V=this.activeCell,{returnValue:this.yYe(V,ya.ta.selectedRanges),activeCell:V}}return{returnValue:"",
activeCell:V}};Wd.prototype.$Lh=function(V){var ya=new Sys.StringBuilder;ya.append(Wd.YWg(V));var lb=this.$.da.Aa(231);lb&&fc(ya,lb.u0e(V.Oa.oc.floatingObject,!1));return ya.toString()};Wd.prototype.r6h=function(V){V=V.Wcf();var ya=!1;this.xD.Jhf!==V&&(this.xD.Jhf=V,ya=!0);return ya};Wd.prototype.BKg=function(V,ya){if(ya.zxb)if(ya=this.sparklineManager.yZh(ya)){var lb=bf.a.instance,Kb=lb.fa;a:switch(ya.type){case 0:var Lb=821;break a;case 1:Lb=822;break a;default:Lb=823}lb=Kb.call(lb,Lb);fc(V,String.format(bf.a.instance.Ab(25),
lb));ya=String.format(bf.a.instance.Ab(24),gd.Xgd(ya.vEj));fc(V,ya)}else Rb.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),fc(V,String.format(bf.a.instance.Ab(25),""))};Wd.prototype.SKg=function(V,ya){switch(ya){case 1:case 11:fc(V,bf.a.instance.fa(841));break;case 6:fc(V,bf.a.instance.fa(841));fc(V,bf.a.instance.fa(843));break;case 7:fc(V,bf.a.instance.fa(841));fc(V,bf.a.instance.fa(844));break;case 2:fc(V,bf.a.instance.fa(842));fc(V,bf.a.instance.fa(843));
break;case 3:fc(V,bf.a.instance.fa(842));fc(V,bf.a.instance.fa(844));break;default:fc(V,bf.a.instance.fa(842))}};Wd.prototype.yKg=function(V,ya){var lb,Kb=this.$.da.Aa(65);ya=Kb?Kb.yKa(ya.range):null;var Lb="",Xa=Object(Xf.a)(744,ya);if(ya)Lb=!ya.a7a&&Xa&&Xa.yoi?String.format(bf.a.instance.Ab(29),Xa.MIj):String.format(bf.a.instance.Ab(23),ya.author);else if(null===(lb=null===Kb||void 0===Kb?void 0:Kb.Sm)||void 0===lb?0:lb.oF)Lb=String.format(bf.a.instance.Ab(28),Kb.Sm.NN.author);fc(V,Lb)};Wd.LJg=
function(V){return String.format(bf.a.instance.Ab(52),Wd.uac(V.altText,V.altTextDescription,V.name),V.altTextDescription)};Wd.XQh=function(V){return bf.a.instance.fa(V.Wcf()?831:832)};Wd.uac=function(V,ya,lb){return V||ya?V:lb};Wd.YWg=function(V){var ya=V.Oa.oc;V=ya.floatingObject;var lb=V.dd,Kb=lb.ChartTitle,Lb=V.altText,Xa=V.altTextDescription,od=!!(lb.Attributes&4);return(ya=ya.getSelectionDescription())?ya:lb.DataRangeForDisplay?String.format(bf.a.instance.Ab(od?49:47),Wd.uac(Lb,Xa,V.name),Xa,
Kb,bf.a.instance.fa(kd(lb.ChartCategory)),lb.DataRangeForDisplay):String.format(bf.a.instance.Ab(od?50:48),Wd.uac(Lb,Xa,V.name),Xa,Kb,bf.a.instance.fa(kd(lb.ChartCategory)))};Wd.Ewj=function(V){return De.EwaSettings.ma(103)&&(V.J6a||V.Mgc)};Wd.zKg=function(V,ya){if(!ya.dTa)Rb.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ya.J6a)ya=ya.dTa.topLeft.toString(),fc(V,String.format(bf.a.instance.Ab(26),
ya));else if(ya.Mgc){var lb=ya.dTa.iT();ya=(lb.LastColumn-lb.FirstColumn+1).toString();lb=(lb.LastRow-lb.FirstRow+1).toString();fc(V,String.format(bf.a.instance.Ab(27),ya,lb))}};Wd.Dwj=function(V,ya,lb){return V.LH||!De.EwaSettings.ma(139)?!1:(V=lb.da.Aa(271))?V.lgc(ya):!1};Wd.Xoi=function(V){return V.top===V.bottom&&V.left+1===V.right||V.top+1===V.bottom&&V.left===V.right};Ck.Object.defineProperties(Wd.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return Kf.g(this.$).mc(null)}}});
Wd.UXj=268435712;Wd.lUc=500;Object(ie.a)(Wd,"SelectionReadoutHandler",null,[745,2]);var Fe=b(55),gf=df.a;Am(he,gf);he.prototype.create=function(){var V=this,ya=this.$.da,lb=ic.GetServiceTaskFactory.Ua(ya,211,212,this.ub),Kb=ic.GetServiceTaskFactory.Ua(ya,66,134,this.ub),Lb=ic.GetServiceTaskFactory.Ua(ya,240,239,this.ub),Xa=Fe.Task.Ra(null);De.EwaSettings.Fb()&&(Xa=ic.GetServiceTaskFactory.Ua(ya,244,315,this.ub));Lc.TaskExtensions.Ba(Lc.TaskExtensions.xe([lb,Kb,Lb,Xa],this.la),function(){var od=ya.Aa(226)||
new Wd(lb.result,V.$,Kb.result,Lb.result,Xa.result);V.Eb(od)},this.$.la,3)};he.ka=function(V){V.da.Ga(227,new he(V))};Object(ie.a)(he,"SelectionReadoutHandlerFactory",df.a,[]);Oc.prototype.bNf=function(){var V=this.gKh();this.ariaLiveNotifier.jbb(V,$d.a.Kob)};Oc.prototype.gKh=function(){var V=new Sys.StringBuilder;this.$.workbookContext&&fc(V,this.$.workbookContext.WorkbookFileName);fc(V,bf.a.instance.fa(847));fc(V,this.iKh());fc(V,this.hKh());fc(V,bf.a.instance.fa(848));return V.toString()};Oc.prototype.iKh=
function(){return this.$.isEditMode?bf.a.instance.fa(852):bf.a.instance.fa(853)};Oc.prototype.hKh=function(){var V=this.bXj(),ya=this.$.xa.qa;V=1!==V?String.format(bf.a.instance.Ab(32),V):bf.a.instance.fa(846);V=new Sys.StringBuilder(V);ya&&ya.sheetName&&(V.append(dd.Mvd),V.append(String.format(bf.a.instance.Ab(33),ya.sheetName)));return V.toString()};Oc.prototype.bXj=function(){for(var V=0,ya=Cl(this.$.xa.items),lb=ya.next();!lb.done;lb=ya.next())lb.value.visible&&V++;return V};Object(ie.a)(Oc,"WorkbookReadout",
null,[]);Gb.prototype.dispose=function(){this.O$b&&this.O$b.Bcj(this.Tzf);this.O$b=this.ariaLiveNotifier=this.$=null};Object(ie.a)(Gb,"EmbeddedWorkbookReadoutHandler",null,[2]);qd.prototype.dispose=function(){this.wm();this.ariaLiveNotifier=this.JZ=null;this.Od=!0};qd.prototype.Ek=function(){if(this.JZ){this.JZ.Nt(this.RW);this.JZ.Ea.Ix(this.RW);this.JZ.rE(this.RW);var V=Object(Xf.a)(433,this.JZ);V&&(V.rc.sl(this.RW),V.ha.WG(this.RW),V.ha.FJ(this.RW),V.ha.Oa.i3(this.RW))}else Rb.ULS.sendTraceTag(537153923,
0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};qd.prototype.wm=function(){if(this.JZ){this.JZ.Ea.Fv(this.RW);this.JZ.aG(this.RW);var V=Object(Xf.a)(433,this.JZ);V&&(V.rc.kl(this.RW),V.ha.cG(this.RW),V.ha.tO(this.RW),V.ha.Oa.ina(this.RW))}};qd.prototype.Rqe=function(){this.H0d.bNf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Fqj();this.dispose()};Object(ie.a)(qd,"WorkbookReadoutHandler",null,[2]);var uf=df.a;Am(nd,uf);nd.prototype.create=function(){var V=
this,ya=ic.GetServiceTaskFactory.Ua(this.$.da,211,212,this.ub);if(this.$.rN){var lb=ic.GetServiceTaskFactory.Ua(this.$.da,12,477,this.ub);Lc.TaskExtensions.Ba(Lc.TaskExtensions.xe([ya,lb],this.$.la),function(){var Kb=new Gb(ya.result,V.$,lb.result);V.Eb(Kb)},this.$.la,3)}else Lc.TaskExtensions.Ba(ya,function(Kb){Kb=new qd(Kb.result,V.$);V.Eb(Kb)},this.$.la,3)};nd.ka=function(V){V.da.Ga(229,new nd(V))};Object(ie.a)(nd,"WorkbookReadoutHandlerFactory",df.a,[]);var Ee=b(38),mc=b(249),Uc=b(375),Vd=b(190),
Sf=b(704),Cd=Ee.a;Am(Ac,Cd);Ac.prototype.dispose=function(){this.view&&(this.view.Ea.Wq(this.zf),this.view.Ea.wI(this.Tm),this.view.Ea.Kbb(this.zf),this.view.Ea.jIb(this.zf),this.view.$.xa.lL(this.Go),this.view.$.Hb.lL(this.Go));this.cU=this.qke=null;Cd.prototype.dispose.call(this)};Ac.prototype.oZb=function(V){V=this.tHd(V);var ya=De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.view.yH:this.view.Hh;if(V&&0<V.length&&ya)for(var lb=0,Kb=
V.length;lb<Kb;lb++)ya.contains(this.cU[lb])||this.cU.push(Vd.a.fR(V[lb]))};Ac.prototype.SHb=function(){var V=De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.view.yH:this.view.Hh;if(this.cU.length&&V)for(var ya=this.cU.length-1;0<=ya;ya--)V.contains(this.cU[ya])||Array.removeAt(this.cU,ya)};Ac.prototype.E2e=function(V){return this.Z1e(V)};Ac.prototype.Z1e=function(V){V=Ia.I(V,this.cU,!0);return 0<V.length?V[0]:null};Ck.Object.defineProperties(Ac.prototype,
{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.cU}},view:{configurable:!0,enumerable:!0,get:function(){return this.qke}}});Ac.uHd="lrc";Object(ie.a)(Ac,"LoadedRangeCollection",Ee.a,[]);Am(dc,Ac);dc.prototype.yZh=function(V){for(var ya=Cl(this.rangeList),lb=ya.next();!lb.done;lb=ya.next())if(lb=lb.value,V.range.contains(lb))return lb;return null};dc.prototype.tHd=function(V){return V.GridBlockModel&&(V=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(V.GridBlockModel))?
V.getSparklineRanges():null};Object(ie.a)(dc,"SparklineManager",Ac,[623]);var Uf=df.a;Am(bb,Uf);bb.prototype.create=function(){this.Eb(this.sparklineManager||(this.sparklineManager=new dc(Kf.g(this.$),this.$.da)))};bb.ka=function(V){V.da.Ga(239,new bb(V))};Object(ie.a)(bb,"SparklineManagerFactory",df.a,[]);var Td=b(54),kg=b(301);Ca.DPe="ewa-svg-icon";Object(ie.a)(Ca,"CssClassNames",null,[]);var Gf=b(325),Kd=b(256);Jc.prototype.dispose=function(){this.EVd=null;this.$.ea.Yn(this.Gg)};Jc.prototype.Yva=
function(V,ya,lb,Kb,Lb){Kb=void 0===Kb?null:Kb;Lb=void 0===Lb?null:Lb;var Xa;(Xa=this.EVd[V])||(this.EVd[V]=Xa=this.bYi(this.I8f[V]));if(!Xa)return Rb.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",V),null;var od=Xa.cloneNode(!0);if(!od.style){var Yd=Gf.b(Xa),ke=Gf.b(od),Yf={};Yf.iconId=V;Yf.isOriginalNodeStyleNull=void 0===Xa.style||null===Xa.style;Yf.isOriginalNodeCurrentStyleNull=void 0===Xa.currentStyle||null===Xa.currentStyle;Yf.isClonedNodeCurrentStyleNull=
void 0===od.currentStyle||null===od.currentStyle;Yf.originalNode=Yd.substring(0,Yd.indexOf(">")+1);Yf.clonedNode=ke.substring(0,ke.indexOf(">")+1);Rb.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(Yf))}V=String.format("height: {0}px; width: {0}px;",ya,lb);od.setAttribute("style",V);Lb&&(V=document.createElement("title"),V.innerHTML=Lb,od.insertBefore(V,od.childNodes[0]));if(Kb)for(Kb=Cl(Kb),Lb=Kb.next();!Lb.done;Lb=Kb.next())Sys.UI.DomElement.addCssClass(od,
Lb.value);return od};Jc.prototype.Iba=function(V,ya,lb,Kb,Lb,Xa,od,Yd){Lb=void 0===Lb?0:Lb;Xa=void 0===Xa?0:Xa;od=void 0===od?null:od;Yd=void 0===Yd?null:Yd;Lb&&Xa||(Xa=le.DOMElementExtensions.getBoundingClientRect(Kb),Lb=Xa.height,Xa=Xa.width);if(od=this.Yva(V,ya,lb,od,Yd))Kb.appendChild(od),(Kb=le.DOMElementExtensions.d_(od,"style",null))?od.setAttribute("style",Kb+String.format(" margin: {0}px {1}px;",(Lb-ya)/2,(Xa-lb)/2)):Rb.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',
V);return od};Jc.prototype.Plf=function(){var V=this;Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(this.$.da,283,284,0),function(ya){ya=Kd.c(ya.result.Jn.loadScript("excel-uiSlice20-sprite"));Lc.TaskExtensions.Ba(ya,function(){var lb=V.h0e("excelUiSlice20Sprite");lb?V.zne(lb):Rb.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},V.$.la,3)},this.$.da.la,3)};Jc.prototype.zne=function(V){V=Cl(V);for(var ya=V.next();!ya.done;ya=V.next())ya=ya.value,ya.type===
Mb.a.G8f&&(this.I8f[ya.id]=ya)};Jc.prototype.bYi=function(V){if(!V)return null;var ya=V.viewBox;V=V.children;var lb=document.createElementNS(kg.a.GVd,Mb.a.G8f);Sys.UI.DomElement.addCssClass(lb,Ca.DPe);lb.setAttribute("focusable","false");lb.setAttribute("viewBox",ya);this.CDg(lb,V);return lb};Jc.prototype.CDg=function(V,ya){ya=Cl(ya);for(var lb=ya.next();!lb.done;lb=ya.next()){lb=lb.value;var Kb=document.createElementNS(kg.a.GVd,lb.type),Lb;for(Lb in lb){var Xa=Lb,od=lb[Lb];"className"===Xa?Kb.setAttribute("class",
od):Kb.setAttribute(Xa,od)}V.appendChild(Kb)}};Jc.prototype.h0e=function(V){return(V=window[V])?V.icons:null};Object(ie.a)(Jc,"SvgIconProvider",null,[622,2]);var af=df.a;Am(Ed,af);Ed.prototype.create=function(){var V=this;Lc.TaskExtensions.Ba(Td.a.Z_([106],4,this.ub,void 0,void 0,void 0,387),function(){var ya=De.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[ya]?V.Eb(V.$.da.Aa(388)||new Jc(V.$)):Rb.ULS.sendTraceTag(537151258,
0,50,"window.[{0}] returned null.",ya)},this.la,3)};Ed.ka=function(V){V.da.Ga(387,new Ed(V))};Object(ie.a)(Ed,"SvgIconProviderFactory",df.a,[]);var Wg=b(438),Hf=b(570),Pg=b(246),be=b(166),$g=b(128),wg=b(10),We=b(354),eg=b(179),lf=b(13),Je=b(160),Di=b(244),kj=b(107),ig=b(43),Zf=b(33),Ei=pf.a;Am(Fc,Ei);Fc.prototype.dispose=function(){this.jcb();this.tableManager.pbj(this.Dvf);this.sif||Da.a.xp||Da.a.bla||eg.a.instance.za(lf.a.pointerDown,this.uba,this.onPointerDown);if(this.wB){Di.b(this.$,!1);try{this.Vv()}catch(V){Rb.ULS.sendTraceTag(537151236,
0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",V)}}this.parentElement&&this.parentElement.contains(this.uba)&&this.parentElement.removeChild(this.uba);this.uba=this.parentElement=null;Ei.prototype.dispose.call(this)};Fc.prototype.N4e=function(V){var ya=V.bottom-this.co.topLeft.bottom-1;return 0<=V.right-this.co.topLeft.right+1&&0<=ya&&V.bottom>=this.co.top&&V.right>=this.co.left?new ue.Range(this.co.top,this.co.left,V.bottom,V.right,!1,!1):this.nt};Fc.prototype.Zkd=
function(V){this.Kwc([this.nt],6,void 0===V?!0:V);this.Cb.Gn(this.$8f)};Fc.prototype.YHb=function(V){V=void 0===V?!0:V;this.Cb.Xh(this.$8f);this.Kwc([null],6,V)};Fc.prototype.qJd=function(V){V=void 0===V?!0:V;this.Cb.Xh(this.V8f);this.Kwc([null],26,V)};Fc.prototype.d8h=function(){var V=!1;V=void 0===V?!0:V;var ya=this.zIj();0<ya.length&&(this.Kwc(ya,26,V),this.Cb.Gn(this.V8f))};Fc.prototype.zIj=function(){var V=[];this.co.contains(this.nt)&&(this.co.right!==this.nt.right&&V.push(new ue.Range(this.co.top,
this.nt.right+1,this.nt.bottom,this.co.right,!1,!1)),this.co.bottom!==this.nt.bottom&&V.push(new ue.Range(this.nt.bottom+1,this.co.left,this.co.bottom,this.co.right,!1,!1)));return V};Fc.prototype.resizeTable=function(){if(!this.nt.equals(this.co)){var V=new ue.Range(this.co.top,this.co.left,this.nt.bottom,this.nt.right,!1,!1);this.nNj(V);this.Drd=!0}};Fc.prototype.onKeyDown=function(V){Zf.a(this.$).qe(V);return!0};Fc.prototype.c$a=function(){this.sif&&(Da.a.xp||Da.a.bla||(eg.a.instance.pa(lf.a.pointerDown,
this.uba,this.onPointerDown),this.uba.classList.remove("ewr-table-resize-default-cursor"),this.qMc=this.uba.disabled=!1),this.qMc=!1)};Fc.prototype.uSg=function(){var V=document.createElement("div");V.className="ewr-table-resize-handle";var ya=document.createElement("div");ya.className="ewr-table-resize-fillhandle-higher";var lb=document.createElement("div");lb.className="ewr-table-resize-fillhandle-broader";V.appendChild(ya);V.appendChild(lb);this.uba=V;this.parentElement.appendChild(this.uba)};
Fc.prototype.i1b=function(V){var ya=this,lb=this.nt.contains(V),Kb=V.top,Lb=V.bottom,Xa=V.left;V=V.right;var od=null;if(lb){if(this.gridView.U5(this.co.topLeft)&&!this.co.YSa)return;Kb=Math.max(1,Lb-5,this.co.top);Xa=Math.max(1,V-5,this.co.left);Lb=Kb;V=Xa;od=new ue.Range(Kb,Xa,Kb,Xa,!1,!1)}else Lb+=5,V+=5,Kb=Lb,Xa=V,od=new ue.Range(Lb,V,Lb,V,!1,!1);this.gridView.U5(od)||(this.Tr?this.Tr.yp||(this.Tr=Xb.a.instance.create(function(){ya.gridView.eu(od,60,kj.a.X8f)},40,yc.a.Y8f)):this.Tr=Xb.a.instance.create(function(){ya.gridView.eu(od,
60,kj.a.X8f)},40,yc.a.Y8f))};Fc.prototype.vZa=function(V){var ya=V;if(this.gridView.rb.o5){if(!this.gridView.mc(V.topLeft)){var lb=this.gridView.wk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.yH,this.nt.top!==V.top?1:2);try{lb.dl=this.nt.top<V.top||this.nt.left<V.left,lb.us(V.topLeft),ya=lb.$$cu().range}finally{lb&&lb.dispose()}}ya.right=ya.left+V.width-1;ya.bottom=ya.top+V.height-1}return ya};Fc.prototype.Kwc=function(V,ya,lb){lb=void 0===lb?!0:lb;var Kb=[];V=Cl(V);for(var Lb=V.next();!Lb.done;Lb=
V.next())Kb.push(new We.a(Lb.value,Od.d(this.$.qa)));this.Cb.lx(Kb,[ya],!0,void 0,lb)};Fc.prototype.A9i=function(){for(var V=Cl(this.gridView.An),ya=V.next();!ya.done;ya=V.next())eg.a.instance.pa(lf.a.yh,ya.value.domElement,this.Sh);eg.a.instance.pa(lf.a.$d,document.documentElement,this.Pf);this.cJe()};Fc.prototype.n$i=function(){for(var V=Cl(this.gridView.An),ya=V.next();!ya.done;ya=V.next())Je.a.instance.pa(lf.a.wg,ya.value.domElement,this.Sh);Je.a.instance.pa(lf.a.Ce,document.documentElement,this.AFb);
this.cJe()};Fc.prototype.Vv=function(){this.Zzb&&this.aQj();this.Vic&&this.lQj()};Fc.prototype.aQj=function(){for(var V=Cl(this.gridView.An),ya=V.next();!ya.done;ya=V.next())eg.a.instance.za(lf.a.yh,ya.value.domElement,this.Sh);eg.a.instance.za(lf.a.$d,document.documentElement,this.Pf);this.eOf()};Fc.prototype.lQj=function(){for(var V=Cl(this.gridView.An),ya=V.next();!ya.done;ya=V.next())Je.a.instance.za(lf.a.wg,ya.value.domElement,this.Sh);Je.a.instance.za(lf.a.Ce,document.documentElement,this.AFb);
this.eOf()};Fc.prototype.cJe=function(){eg.a.instance.pa(lf.a.Iy,document.documentElement,this.Sca);this.gridView.Ac.k8b(!0)};Fc.prototype.eOf=function(){eg.a.instance.za(lf.a.Iy,document.documentElement,this.Sca);this.gridView.Ac.k8b(!1)};Fc.prototype.nNj=function(V){var ya={};V=(ya.ResizeTableRange=V,ya.OriginalTableRange=this.co,ya);this.$.Zd(-1400250766,Ud.a.Vb,30,V)};Fc.prototype.GRj=function(V){if(!this.co.contains(V)){V=this.yIj();V=Cl(V);for(var ya=V.next();!ya.done;ya=V.next())if(this.tableManager.bsd(ya.value)){this.gridView.rg.No($d.a.AEi);
return}}this.gridView.rtl?this.gridView.rg.No($d.a.FDi):this.gridView.rg.No($d.a.SFi)};Fc.prototype.jcb=function(){if(this.wB){Di.b(this.$,!1);try{this.Vv()}catch(V){Rb.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",V)}}this.Tr&&(this.Tr.cancel(),this.Tr.dispose());this.Vic=this.Zzb=!1;this.YHb();this.qJd();Di.b(this.$,!1);this.gridView.rg.No($d.a.k5)};Fc.prototype.yIj=function(){var V=[];this.co.right!==this.nt.right&&V.push(new ue.Range(this.co.top,
this.co.right+1,this.nt.bottom,this.nt.right,!1,!1));this.co.bottom!==this.nt.bottom&&V.push(new ue.Range(this.co.bottom+1,this.co.left,this.nt.bottom,this.co.right,!1,!1));return V};Fc.createInstance=function(V,ya,lb,Kb){if(!ya)return null;var Lb=V.Cb;Lb.lx(lb,[27],!0);Lb.Gn(Fc.tIj);lb=Lb.Jw(27,V.rb.rj(ya.bottomRight),Fc.MOh(ya,lb)).Of;return new Fc(lb,V,ya,Kb)};Fc.MOh=function(V,ya){for(var lb,Kb=0;Kb<ya.length;Kb++)if((null===(lb=ya[Kb])||void 0===lb?0:lb.range)&&ya[Kb].range.equals(V))return Kb;
return 0};Ck.Object.defineProperties(Fc.prototype,{wB:{configurable:!0,enumerable:!0,get:function(){return this.Zzb||this.Vic}},sif:{configurable:!0,enumerable:!0,get:function(){return this.qMc}}});Fc.tIj=[27];Object(ie.a)(Fc,"TableResizeBehavior",pf.a,[]);var ph=b(242);Gc.Vth="ewa-ttrd-buttonarea";Object(ie.a)(Gc,"CssClassNames",null,[]);var ji=b(48),xh=b(131),zg=b(132),wi=b(273),Bh=ph.a;Am(zb,Bh);zb.prototype.dispose=function(){this.$&&this.Eeh();this.$=this.gridView=this.parentElement=this.kLa=
null;Bh.prototype.dispose.call(this)};zb.prototype.CMh=function(V){var ya=this.l0h(this.gridView.mc(null).range);return ya?String.format("=SUBTOTAL({0},{1})",V,ya):null};zb.prototype.l0h=function(V){var ya=Kf.g(this.$).Rb.Qj(V);if(!ya)return null;ya=be.a(ya,!1);ya.right=ya.left=V.left;return ya.toString()};zb.prototype.tbi=function(){zb.yM={};zb.yM["100"]=bf.a.instance.fa(1068);zb.yM["101"]=bf.a.instance.fa(1071);zb.yM["102"]=bf.a.instance.fa(1070);zb.yM["103"]=bf.a.instance.fa(1075);zb.yM["104"]=
bf.a.instance.fa(1072);zb.yM["105"]=bf.a.instance.fa(1073);zb.yM["109"]=bf.a.instance.fa(1069);zb.yM["107"]=bf.a.instance.fa(1076);zb.yM["110"]=bf.a.instance.fa(1078);zb.yM["111"]=bf.a.instance.fa(1129)};zb.prototype.zXi=function(){var V=this.gridView.mc(null);if(V&&(V=V.LH?V.formulaBarText:null))if("=SUBTOTAL("===V.substring(0,10)){if(V=V.substring(10,13),V in zb.yM)return V}else return"111";return"100"};zb.prototype.LMg=function(){this.gridView.Ea.Ss(this.zf);this.gridView.ha.FJ(this.Rh);this.gridView.Nt(this.onContentReady);
this.gridView.Ac.sl(this.Ivf);this.gridView.Ac.To(this.gEb)};zb.prototype.Eeh=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.tO(this.Rh),this.gridView.Ea.Wq(this.zf)),this.gridView.gx(this.onContentReady),this.gridView.Ac&&(this.gridView.Ac.kl(this.Ivf),this.gridView.Ac.Zn(this.gEb)),this.Gcg())};zb.prototype.Brb=function(V){this.RRj(V);this.NAb&&(this.$Gj(),this.mnb?(this.JGf||this.WMg(),this.oUc?this.H5=!1:(this.H5=!0,this.eSf())):(Rb.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.H5=!1))};zb.prototype.eSf=function(){var V=this;appChrome.renderTableTotalRowOptions(this.parentElement,zb.yM,zb.yM[this.zXi()].toString(),Math.round(Zf.a(this.$).Fi(17)),function(ya){Rb.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",ya);var lb={};lb=(lb.SelectedOption=zb.yM[ya],lb.FunctionKeyCode=ya,lb.Location="canvas",lb);zg.b(V.$).Vd(xh.a.DIj,lb,null,!0);if("111"===ya)return V.Sei(),!0;if("100"!==ya){V.cKb=V.CMh(ya);if(!V.cKb)return Rb.ULS.sendTraceTag(537151197,
0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;V.WRa(V.cKb)}else V.WRa("");le.DOMElementExtensions.setFocus(V.gridView.rc.textBox.domElement);return!0})};zb.prototype.Sei=function(){Rb.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var V=new td.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.$b(V)};zb.prototype.Ova=function(V){if(!V)return null;var ya=this.gridView.Ac.textBox.domElement;
var lb=0<le.DOMElementExtensions.getHeight(ya)&&0<le.DOMElementExtensions.getWidth(ya)&&0<=ya.offsetTop&&0<=ya.offsetLeft;if(lb)ya=le.DOMElementExtensions.Ova(ya,this.gridView.Oj);else{ya=this.gridView.getCellBounds(V.cell);var Kb=le.DOMElementExtensions.getBoundingClientRect(this.gridView.Oj);ya=new Sys.UI.Bounds(ya.x-Kb.x,ya.y-Kb.y,ya.width,ya.height)}if(ya)if(lb)2<ya.height&&2<ya.height&&(ya.x+=1,ya.y+=1,ya.height-=2,ya.width-=2);else if(lb=Kf.g(this.$).fK(V.cell))lb=lb.width,Kb=yg.a.equals(lh.a.d4a(V.cell,
this.gridView.rtl),"right",!0),this.gridView.rtl&&Kb&&(ya.x=ya.x+ya.width-lb),V.kla&&this.gridView.rtl===Kb&&(ya.width=lb);else return null;return ya};zb.prototype.RRj=function(V){var ya=this.mnb;if(ya){var lb=17>=ya.height?ya.y:ya.y+ya.height-17-2;ya=this.tki?this.gridView.rtl?ya.x:ya.x+ya.width-(17<ya.height?17:ya.height):this.gridView.rtl?ya.x-(17<ya.height?17:ya.height):ya.x+ya.width;var Kb=Zf.a(this.$).aka(new Sys.UI.Point(ya,lb));this.parentElement.style.top=wg.HelperMethods.nc(Kb.y);this.parentElement.style.left=
wg.HelperMethods.nc(Kb.x);Zf.a(this.$).vsj(this.parentElement);V&&(this.H5=this.gridView.djc(new ji.a(ya,lb)))}else this.H5=!1};zb.prototype.WMg=function(){this.kLa.insertBefore(this.parentElement,this.kLa.firstChild);this.JGf=!0};zb.prototype.$Gj=function(){this.qR||(this.gridView.view.Ts(this.ot),this.qR=!0)};zb.prototype.Gcg=function(){this.qR&&this.gridView.view&&(this.gridView.view.Yq(this.ot),this.qR=!1)};zb.prototype.WRa=function(V){var ya=this.gridView.rc,lb=this.gridView.mc(null);lb&&(V=
Object(Pe.a)(new wi.a,{Text:V}),this.gridView.setCell(V,lb.range,0,127,null),ya.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};Ck.Object.defineProperties(zb.prototype,{H5:{configurable:!0,enumerable:!0,get:function(){return this.Wod},set:function(V){this.Wod!==V&&(this.Wod=this.isVisible=V)}},NAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Pd&16)}},tki:{configurable:!0,enumerable:!0,get:function(){var V=this.gridView.ha.ta.activeCell;return V.right===V.maxColumns}},mnb:{configurable:!0,
enumerable:!0,get:function(){var V=this.gridView.mc(null);return V&&this.gridView.V5(V.range)?this.Ova(V):(V&&Rb.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});zb.CIj="TableTotalRowDropDownIconButtonId";zb.yM=null;Object(ie.a)(zb,"TableTotalRowOptions",ph.a,[2]);Am(hb,Ac);hb.prototype.Yoe=function(V){this.addHandler(Ac.uHd,V)};hb.prototype.sRf=function(V){this.removeHandler(Ac.uHd,V)};hb.prototype.GEg=function(V){this.addHandler("tce",
V)};hb.prototype.pbj=function(V){this.removeHandler("tce",V)};hb.prototype.bsd=function(V){return!!this.Z1e(V)};hb.prototype.tn=function(V){return this.VWh(this.E2e(V))};hb.prototype.qvb=function(V){return this.E2e(V)};hb.prototype.j$i=function(V){V?(this.bqb?this.bqb!==V&&(He.a.Ha(this.u1),this.u1=null,this.bqb=V):this.bqb=V,this.u1||(this.u1=$g.a.instance.Wd(this.bqb)),this.u1.wn("focusin")||this.u1.ka("focusin",this.onFocus)):Rb.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};
hb.prototype.Oef=function(V,ya){return V?V.yba&&V.top===ya.top:(Rb.ULS.shipAssertTag(537151244,0,!!V,"autofilterRange can't be null"),!1)};hb.prototype.Sva=function(V){V=this.$pb?Ia.I(V,this.$pb):this.view.getRangeInformation(V);return 0<V.length&&Object(Wg.a)(Pg.PivotTableRange,V[0])?V[0]:null};hb.prototype.chi=function(V,ya){return V?!V.Pgc&&!!V.IM&&V.IM.Kd(ya):(Rb.ULS.shipAssertTag(537151243,0,!!V,"Pivot table can't be null"),!1)};hb.prototype.Xmi=function(V,ya){return V?!V.Pgc&&!!V.CX&&V.CX.Kd(ya):
(Rb.ULS.shipAssertTag(537151242,0,!!V,"Pivot table can't be null"),!1)};hb.prototype.oZb=function(V){Ac.prototype.oZb.call(this,V);if((V=wg.HelperMethods.l2e(V))&&0<V.length){this.$pb=Array(V.length);for(var ya=0;ya<V.length;ya++)this.$pb[ya]=Vd.a.fR(V[ya])}};hb.prototype.SHb=function(){Ac.prototype.SHb.call(this);this.$pb=null};hb.prototype.v4g=function(V,ya){return this.FDe(V,ya).returnValue};hb.prototype.FDe=function(V,ya){var lb=this;var Kb=!1;if(!V||!ya)return{returnValue:!1,lZ:Kb};V=V.clone();
V.right+=1;V.left=V.right;if(!V.isValidRange)return{returnValue:!1,lZ:Kb};if(V.top<ya.rb.$i){var Lb=V.clone();Lb.bottom>=ya.rb.$i&&(Lb.bottom=ya.rb.$i-1);if(!function(){var od=lb.EDe(Lb,ya);Kb=od.lZ;return od}().returnValue)return{returnValue:!1,lZ:Kb}}if(V.bottom>=ya.rb.$i){var Xa=V.clone();Xa.top<=ya.rb.$i&&(Xa.top=ya.rb.$i);if(!function(){var od=lb.EDe(Xa,ya);Kb=od.lZ;return od}().returnValue)return{returnValue:!1,lZ:Kb}}return{returnValue:!0,lZ:Kb}};hb.prototype.Z8f=function(V){(V=this.tn(V.topLeft))&&
V.toString()in this.SFa&&(this.SFa[V.toString()].Drd=!1)};hb.prototype.e4i=function(){this.raiseEvent("tce")};hb.prototype.Wh=function(V,ya){if(!this.cAc)return!1;switch(ya){case -569786022:case 541421805:if(this.cAc.H5){var lb=document.getElementById(zb.CIj);lb&&Xb.a.instance.create(function(){le.DOMElementExtensions.Ofc(lb,null)},0,yc.a.wIj,!0,!0)}return!0;default:return!1}};hb.prototype.dispose=function(){this.F2b(null,null);this.sRf(this.F0b);this.$.xa.Vg(this.pMf);this.$.sm(this.F2b);this.FQb=
null;this.$.ea&&this.$.ea.Q0(this.J6);this.gridView.ha.tO(this.Rh);this.cAc=null;De.EwaSettings.ma(412)&&this.u1&&(He.a.Ha(this.u1),this.u1=null);Ac.prototype.dispose.call(this)};hb.prototype.K5h=function(V,ya,lb,Kb){var Lb=this.gridView.Rb.Qj(new ue.Range(ya,lb,ya,lb,!1,!1));if(this.V5b=Lb){var Xa=Lb.usedRange,od=V.ctrlKey||Da.a.isMac&&pd.b(V),Yd=!V.shiftKey&&od;V=V.shiftKey&&!od;De.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(Kf.g(this.$).ha.selectionType=3);switch(Kb){case 0:this.ZRb=
0;De.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ya=this.c5c(V,Xa.top,lb,Xa.bottom,lb),this.qQd(ya,Yd,V)):this.rQd(Xa.top,lb,Xa.bottom,lb,be.d(Lb),be.g(Lb),Yd);break;case 1:this.ZRb=1;De.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ya=this.c5c(V,ya,Xa.left,ya,Xa.right),this.qQd(ya,Yd,V)):this.rQd(ya,Xa.left,ya,Xa.right,!1,!1,Yd);break;case 2:this.ZRb=2;De.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ya=this.c5c(V,Xa.top,Xa.left,Xa.bottom,Xa.right),this.qQd(ya,Yd,V)):this.rQd(Xa.top,Xa.left,Xa.bottom,Xa.right,be.d(Lb),be.g(Lb),Yd);break;default:Rb.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Kb.toString());return}De.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(Kf.g(this.$).ha.selectionType=3);Rb.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else Rb.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};hb.prototype.axj=function(V){var ya=this.V5b.usedRange;return this.Vgf(V)||1!==this.wIa&&this.Vgf(new ue.Range(ya.top,V.left,ya.bottom,V.right,!1,!1))?!0:!1};hb.prototype.tHd=function(V){return V.Autofilters};hb.prototype.EDe=function(V,ya){var lb=!1;var Kb=ya.rb.rj(V),Lb=ya.Tf(Kb).Hh;if(!Lb)return Rb.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
Kb),{returnValue:!1,lZ:lb};if(!Lb.Te(V))return{returnValue:!0,lZ:lb};V=ya.wk("TableManager.CouldExpandImpl",V,2);try{for(;V.$$mn();){if(V.$$cu().text||V.uo.f8e)return lb=!0,{returnValue:!1,lZ:lb};if(V.$$cu().wF)return{returnValue:!1,lZ:lb}}}finally{V&&V.dispose()}return{returnValue:!0,lZ:lb}};hb.prototype.VWh=function(V){if(!V)return null;var ya=new Hf.AutofilterRange(V.top,V.left,V.bottom,V.right,null,null,null,V.id,V.yba);ya.YSa=V.YSa;for(var lb=0,Kb=this.rangeList.length;lb<Kb;lb++){var Lb=this.rangeList[lb];
Lb.id===V.id&&Lb!==V&&this.emi(Lb)&&(ya.union(Lb),Lb.YSa&&(ya.YSa=!0))}return ya};hb.prototype.emi=function(V){return!!Kf.g(this.$).Rb.Qj(V)};hb.prototype.FJh=function(){for(var V=[],ya=Cl(this.rangeList),lb=ya.next();!lb.done;lb=ya.next())lb=new We.a(this.tn(lb.value.topLeft),Od.d(this.$.qa)),V.push(lb);return V};hb.prototype.ahd=function(){for(var V={},ya=Cl(this.rangeList),lb=ya.next();!lb.done;lb=ya.next())if(lb=lb.value){var Kb=this.tn(lb.topLeft);Kb&&(V[Kb.toString()]=this.tn(lb.topLeft))}return V};
hb.prototype.Vti=function(){this.$.ea.vh?this.Ayb(0):this.$.ea.Hl(this.RN)};hb.prototype.Ayb=function(V){var ya=this;this.$.WC(function(lb){lb.sva(V).then(ya.EGb)})};hb.prototype.r_h=function(V){var ya=this.gridView.Rb.Qj(V);return ya?ya.name:V.toString()};hb.prototype.rQd=function(V,ya,lb,Kb,Lb,Xa,od){var Yd=V+(Lb?1:0),ke=lb-(Xa?1:0),Yf=this.gridView.inRangePicker||this.gridView.Ni,Tf=!1,Kg=new ue.Range(Yd,ya,ke,Kb,!1,!1);if(Lb||Xa)for(Lb=Yf?We.a.Trb(this.gridView.ha.rangePicker.fL):this.gridView.ha.ta.selectedRanges,
Lb=Cl(Lb),Xa=Lb.next();!Xa.done;Xa=Lb.next()){Xa=Xa.value;Tf=this.crb(Xa,Yd,ya,ke,Kb);var Og=this.crb(Xa,V,ya,lb,Kb);if(Yf&&Tf)break;if(!Yf&&(Tf||Og)){this.gridView.ha.updateSelection(Xa,Xa.topLeft,0,1);if(od&&Og)return;break}}Tf&&(Kg.top=V,Kg.bottom=lb);V=Kg.topLeft;od?this.gridView.ha.updateSelection(Kg,V,0,1):Yf?this.gridView.ha.JD([Kg],0,V,0):this.gridView.ha.updateSelection(Kg,V,0,3)};hb.prototype.qQd=function(V,ya,lb){V&&(lb=lb?Kf.g(this.$).ha.ta.activeCell:V.topLeft,ya?this.gridView.ha.updateSelection(V,
lb,0,1):this.gridView.ha.JD([V],0,lb,0))};hb.prototype.c5c=function(V,ya,lb,Kb,Lb){var Xa=be.d(this.V5b),od=be.g(this.V5b),Yd=ya+(1!==this.wIa&&Xa?1:0),ke=Kb-(1!==this.wIa&&od?1:0),Yf=this.gridView.inRangePicker||this.gridView.Ni;if(V){var Tf=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Yf&&!We.a.Trb(this.gridView.ha.rangePicker.fL).length?new ue.Range(Yd,lb,ke,Lb,!1,!1):Yf?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ta.activeCell;Tf=new ue.Range(Tf.top<
Yd?Tf.top:Yd,Tf.left<lb?Tf.left:lb,Tf.bottom>ke?Tf.bottom:ke,Tf.right>Lb?Tf.right:Lb,!1,!1)}else Tf=new ue.Range(Yd,lb,ke,Lb,!1,!1);if(1!==this.wIa&&(Xa||od)&&(!V||V&&this.crb(Tf,Yd,lb,ke,Lb)))for(V=Yf?We.a.Trb(this.gridView.ha.rangePicker.fL):this.gridView.ha.ta.selectedRanges,V=Cl(V),Xa=V.next();!Xa.done;Xa=V.next())if(this.crb(Xa.value,Yd,lb,ke,Lb)){Tf.top=ya;Tf.bottom=Kb;break}return Tf};hb.prototype.Vgf=function(V){var ya=this.gridView.inRangePicker||this.gridView.Ni?We.a.Trb(this.gridView.ha.rangePicker.fL):
this.gridView.ha.ta.selectedRanges;ya=Cl(ya);for(var lb=ya.next();!lb.done;lb=ya.next())if(this.crb(lb.value,V.top,V.left,V.bottom,V.right))return!0;return!1};hb.prototype.crb=function(V,ya,lb,Kb,Lb){return!!V&&V.top===ya&&V.bottom===Kb&&V.left===lb&&V.right===Lb};Ck.Object.defineProperties(hb.prototype,{SFa:{configurable:!0,enumerable:!0,get:function(){return this.FQb}},ktd:{configurable:!0,enumerable:!0,get:function(){return this.Bae}},wIa:{configurable:!0,enumerable:!0,get:function(){return this.ZRb}},
Cg:{configurable:!0,enumerable:!0,get:function(){var V=Kf.g(this.$);return V.Rb.Qj(V.ha.ta.activeCell,!1)}},dGd:{configurable:!0,enumerable:!0,get:function(){return this.ktd?Kf.g(this.$).Rb.Qj(this.ktd,!1):null}}});Object(ie.a)(hb,"TableManager",Ac,[621,2]);var Jh=df.a;Am(Ib,Jh);Ib.prototype.create=function(){this.Eb(this.tableManager||(this.tableManager=new hb(this.$)))};Object(ie.a)(Ib,"TableManagerFactory",df.a,[]);var nh=b(112),fh=b(1023),rj=b(1475),Qh=b(933),bh=b(1427),Xh=b(84),ci=b(111),Fg=
b(28),ki=b(197),Ag=b(30),Ch=b(293);Object(ie.a)(nb,"TableStyleElement",null,[]);var Yg=b(959),hh=b(213),Ug=b(89),yh=b(591);Cb.hof=function(V,ya){return Cb.b9f[V.Type]-Cb.b9f[ya.Type]};Cb.t4a=function(V,ya){try{return appChrome.buildTableStyleGalleryIconNew(Cb.zBa,Cb.Boa,V,ya)}catch(lb){return null}};Cb.uif=function(V){return V&&Ud.a.ld in V&&(V=V[Ud.a.ld])?yg.a.FL(V,$d.a.NGb):!1};Cb.xta=function(V){var ya=[],lb=0;V=Cl(V);for(var Kb=V.next();!Kb.done;Kb=V.next()){Kb=Kb.value;ya[lb]={};ya[lb].backgroundColor=
"white";ya[lb].color="black";for(var Lb in Kb){var Xa=Kb[Lb];switch(Lb){case "background-color":ya[lb].backgroundColor=Xa;break;case "color":ya[lb].color=Xa;break;case "font-size":ya[lb].fontSize=Xa;break;case "border-bottom":ya[lb].borderBottom=Xa;break;case "border-right":ya[lb].borderRight=Xa;break;case "border-left":ya[lb].borderLeft=Xa;break;case "border-top":ya[lb].borderTop=Xa}}lb++}return ya};Cb.r4b=function(V,ya){var lb=[];if(null===V||void 0===V?0:V.TableStyleElementsList)for(var Kb=0===
V.Category,Lb=0;Lb<Cb.Boa;Lb++)lb.push.apply(lb,Cb.BNh(V,ya,Kb,Lb));else{if(Cb.C6c)return Cb.C6c;V={color:"black","background-color":"white"};for(ya=0;ya<Cb.Boa;ya++)for(Kb=0;Kb<Cb.zBa;Kb++)lb.push(V);Cb.C6c=lb}return lb};Cb.s_h=function(V,ya){if(!V.TableStyleElementsList)return"";var lb="";V=Cl(V.TableStyleElementsList);for(var Kb=V.next();!Kb.done;Kb=V.next())if(Kb=Kb.value,Kb.BackgroundColor&&"#000000"!==Kb.BackgroundColor)switch(Kb.Type){case 0:lb=Kb.BackgroundColor;break;case 5:case 7:if(ya.pia||
ya.JS)lb=Kb.BackgroundColor;break;case 3:case 4:if(ya.firstCol||ya.lastCol)lb=Kb.BackgroundColor;break;case 2:ya.totalRow&&(lb=Kb.BackgroundColor);break;case 1:ya.headerRow&&(lb=Kb.BackgroundColor)}return lb};Cb.p3b=function(V){V=new hh.a(parseInt(String("0x"+V.substr(1,2)),16),parseInt(String("0x"+V.substr(3,2)),16),parseInt(String("0x"+V.substr(5,2)),16));return Yg.a.OKa(V)};Cb.i4e=function(V,ya){if(!V||!ya)return"";ya=(ya=Cb.s_h(V,ya))?Cb.p3b(ya)+", ":bf.a.instance.fa(2020)+", ";switch(V.Index){case 0:return ya+
bf.a.instance.fa(1954);case 1:return ya+bf.a.instance.fa(1955);case 2:return ya+bf.a.instance.fa(1956);case 3:return ya+bf.a.instance.fa(1957);case 4:return ya+bf.a.instance.fa(1958);case 5:return ya+bf.a.instance.fa(1959);case 6:return ya+bf.a.instance.fa(1960);case 7:return ya+bf.a.instance.fa(1961);case 8:return ya+bf.a.instance.fa(1962);case 9:return ya+bf.a.instance.fa(1963);case 10:return ya+bf.a.instance.fa(1964);case 11:return ya+bf.a.instance.fa(1965);case 12:return ya+bf.a.instance.fa(1966);
case 13:return ya+bf.a.instance.fa(1967);case 14:return ya+bf.a.instance.fa(1968);case 15:return ya+bf.a.instance.fa(1969);case 16:return ya+bf.a.instance.fa(1970);case 17:return ya+bf.a.instance.fa(1971);case 18:return ya+bf.a.instance.fa(1972);case 19:return ya+bf.a.instance.fa(1973);case 20:return ya+bf.a.instance.fa(1974);case 21:return ya+bf.a.instance.fa(1975);case 22:return ya+bf.a.instance.fa(1976);case 23:return ya+bf.a.instance.fa(1977);case 24:return ya+bf.a.instance.fa(1978);case 25:return ya+
bf.a.instance.fa(1979);case 26:return ya+bf.a.instance.fa(1980);case 27:return ya+bf.a.instance.fa(1981);case 28:return ya+bf.a.instance.fa(1982);case 29:return ya+bf.a.instance.fa(1983);case 30:return ya+bf.a.instance.fa(1984);case 31:return ya+bf.a.instance.fa(1985);case 32:return ya+bf.a.instance.fa(1986);case 33:return ya+bf.a.instance.fa(1987);case 34:return ya+bf.a.instance.fa(1988);case 35:return ya+bf.a.instance.fa(1989);case 36:return ya+bf.a.instance.fa(1990);case 37:return ya+bf.a.instance.fa(1991);
case 38:return ya+bf.a.instance.fa(1992);case 39:return ya+bf.a.instance.fa(1993);case 40:return ya+bf.a.instance.fa(1994);case 41:return ya+bf.a.instance.fa(1995);case 42:return ya+bf.a.instance.fa(1996);case 43:return ya+bf.a.instance.fa(1997);case 44:return ya+bf.a.instance.fa(1998);case 45:return ya+bf.a.instance.fa(1999);case 46:return ya+bf.a.instance.fa(2E3);case 47:return ya+bf.a.instance.fa(2001);case 48:return ya+bf.a.instance.fa(2002);case 49:return ya+bf.a.instance.fa(2003);case 50:return ya+
bf.a.instance.fa(2004);case 51:return ya+bf.a.instance.fa(2005);case 52:return ya+bf.a.instance.fa(2006);case 53:return ya+bf.a.instance.fa(2007);case 54:return ya+bf.a.instance.fa(2008);case 55:return ya+bf.a.instance.fa(2009);case 56:return ya+bf.a.instance.fa(2010);case 57:return ya+bf.a.instance.fa(2011);case 58:return ya+bf.a.instance.fa(2012);case 59:return ya+bf.a.instance.fa(2013);default:return V.Name?V.Name:""}};Cb.GUh=function(V){return(V+1)%Cb.X8h};Cb.Pwb=function(V,ya,lb){lb=void 0===
lb?"":lb;return V||!lb?String.format("{0}, {1}, -version, {2}",Cb.o$e,V.Index.toString(),ya.toString()):String.format("{0}, {1}, -version, {2}",Cb.o$e,lb,ya.toString())};Cb.BNh=function(V,ya,lb,Kb){for(var Lb=[],Xa=0;Xa<Cb.zBa;Xa++)Lb.push(Cb.Bed(V,ya,lb,Kb,Xa));return Lb};Cb.Bed=function(V,ya,lb,Kb,Lb){var Xa=V.TableStyleElementsList;V=new nb;var od={};if(!Xa)return od;for(var Yd=Cl(Xa),ke=Yd.next();!ke.done;ke=Yd.next())if(ke=ke.value,0===ke.Type){V=ke;break}Yd=!!V.BackgroundColor;var Yf="";!lb&&
V.TableStyleBorderFromatList&&0<V.TableStyleBorderFromatList.length&&(Yf=V.TableStyleBorderFromatList[0].Color);od["background-color"]=Yd?V.BackgroundColor:"#FFFFFF";V.FontColor||(V.FontColor="#000000");od.color=V.FontColor;Cb.Kye(Kb,Lb,od,V,Yf,lb,Yd);Xa=Cl(Xa);for(ke=Xa.next();!ke.done;ke=Xa.next())(ke=ke.value)&&0!==ke.Type&&(2!==ke.Type||Yd||(ke.BackgroundColor=V.BackgroundColor),Cb.Wrd(ke,Kb,Lb,ya)&&(ke.BackgroundColor&&(od["background-color"]=ke.BackgroundColor),od.color=ke.FontColor||V.FontColor,
Cb.Kye(Kb,Lb,od,ke,Yf,lb,Yd)));return od};Cb.VV=function(V,ya,lb,Kb,Lb,Xa){lb&&(lb.Color&&!lb.Style&&(lb.Style=1),lb.Style&&!lb.Color&&(lb.Color=Lb?"#000000":Kb?Kb:Xa?"#FFFFFF":"#000000"),ya[Cb.borders[V]]="1px "+Cb.EW[lb.Style]+" "+lb.Color)};Cb.Wrd=function(V,ya,lb,Kb){return-1===V.Type?!1:Cb.Xrd(V,ya,lb,Kb)||Cb.eoi(V,ya,lb,Kb)||Cb.Yrd(V,ya,lb,Kb)};Cb.eoi=function(V,ya,lb,Kb){return!ya&&Kb.headerRow||ya===Cb.Boa-1&&Kb.totalRow?!1:1===ya%2&&5===V.Type&&Kb.JS&&Kb.headerRow||1<ya&&!!((ya-1)%(V.BandSize+
1))&&6===V.Type&&Kb.JS&&Kb.headerRow||!(ya%2)&&5===V.Type&&Kb.JS&&!Kb.headerRow||!!(ya%(V.BandSize+1))&&6===V.Type&&Kb.JS&&!Kb.headerRow||!(lb%2)&&7===V.Type&&Kb.pia||!!(lb%(V.BandSize+1))&&8===V.Type&&Kb.pia};Cb.Yrd=function(V,ya,lb,Kb){return ya===Cb.Boa-1&&2===V.Type&&Kb.totalRow||lb===Cb.zBa-1&&ya===Cb.Boa-1&&12===V.Type&&Kb.totalRow&&Kb.lastCol||!lb&&ya===Cb.Boa-1&&11===V.Type&&Kb.totalRow&&Kb.firstCol||lb===Cb.zBa-1&&4===V.Type&&Kb.lastCol};Cb.Xrd=function(V,ya,lb,Kb){return!ya&&1===V.Type&&
Kb.headerRow||!lb&&3===V.Type&&Kb.firstCol||!lb&&!ya&&9===V.Type&&Kb.headerRow&&Kb.firstCol||lb===Cb.zBa-1&&!ya&&10===V.Type&&Kb.headerRow&&Kb.lastCol};Cb.Kye=function(V,ya,lb,Kb,Lb,Xa,od){if(Kb.TableStyleBorderFromatList)for(var Yd=Cl(Kb.TableStyleBorderFromatList),ke=Yd.next();!ke.done;ke=Yd.next())if(ke=ke.value,ke.Style)switch(ke.Position){case 0:V&&12!==Kb.Type&&11!==Kb.Type&&2!==Kb.Type&&5!==Kb.Type&&6!==Kb.Type||Cb.VV(0,lb,ke,Lb,Xa,od);break;case 1:V!==Cb.Boa-1&&1!==Kb.Type&&10!==Kb.Type&&
9!==Kb.Type&&5!==Kb.Type&&6!==Kb.Type||Cb.VV(1,lb,ke,Lb,Xa,od);break;case 2:ya&&12!==Kb.Type&&10!==Kb.Type&&7!==Kb.Type&&8!==Kb.Type&&4!==Kb.Type||Cb.VV(2,lb,ke,Lb,Xa,od);break;case 3:ya!==Cb.zBa-1&&9!==Kb.Type&&11!==Kb.Type&&3!==Kb.Type&&7!==Kb.Type&&8!==Kb.Type||Cb.VV(3,lb,ke,Lb,Xa,od);break;case 5:ya!==Cb.zBa-1&&3!==Kb.Type&&4!==Kb.Type&&7!==Kb.Type&&8!==Kb.Type&&Cb.VV(3,lb,ke,Lb,Xa,od);break;case 6:V!==Cb.Boa-1&&2!==Kb.Type&&1!==Kb.Type&&5!==Kb.Type&&6!==Kb.Type&&Cb.VV(1,lb,ke,Lb,Xa,od)}};Cb.v_h=
function(){var V=Array(12);V[0]=0;V[7]=1;V[8]=2;V[5]=3;V[6]=4;V[4]=5;V[3]=6;V[1]=7;V[2]=8;V[9]=9;V[10]=10;V[11]=11;V[12]=13;return V};Cb.Boa=5;Cb.zBa=5;Cb.X8h=5;Cb.o$e="TableStyleIcon";Cb.EW=[null,Ug.a.solid,Ug.a.dashed,Ug.a.dotted,Ug.a.dashed,Ug.a.dotted,Ug.a.dashed,Ug.a.double];Cb.borders=[yh.a.borderTop,yh.a.borderBottom,yh.a.borderLeft,yh.a.borderRight];Cb.b9f=Cb.v_h();Cb.C6c=null;Object(ie.a)(Cb,"TableStyleHelper",null,[]);tb.prototype.equals=function(V){return V?this.headerRow===V.headerRow&&
this.totalRow===V.totalRow&&this.firstCol===V.firstCol&&this.lastCol===V.lastCol&&this.pia===V.pia&&this.JS===V.JS:!1};Object(ie.a)(tb,"TableStyleOptions",null,[]);var pi=b(1003),pg=Ee.a;Am(Va,pg);Va.prototype.w7e=function(V){var ya=this.tableManager.Cg;if(!ya)return!1;V=V[Ud.a.ld];if(!V)return!1;switch(Number.parseInvariant(V)){case 0:return be.d(ya);case 1:return be.c(ya);case 2:return be.g(ya);case 3:return be.e(ya);case 4:return be.f(ya);case 5:return be.b(ya);case 6:return ya.hasAutoFilter}return!1};
Va.prototype.jIf=function(V,ya){if(nh.a.isEmpty(this.qG))return!0;if("PopulateTableMoreStylesMenu"!==V&&"PopulateTableAccessibleStylesMenu"!==V)return!1;if(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===V&&!this.Bzc)return this.MMb||(this.MMb=!0,this.cLa("accessibilityTab")),!0;this.JAb=!0;var lb=this.Sa.Zp("TableStylesMenu"),Kb=this.Sa.fB("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Lb=this.Sa.fB("Ribbon.TableTools.TableStyles.Gallery.Dark",
7,"Size48by48"),Xa=this.Sa.fB("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),od=this.Sa.fB("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),Yd=-123538519;if(ya.MenuId)if(yg.a.contains(ya.MenuId,"FormatAsTable",!0))Yd=753331043,this.T6a=!0;else{var ke=bf.a.instance.fa(1953);var Yf=Cb.Pwb(null,1,"-1");De.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?od.Mt("-1",Yd,"QueryTableStyle",0,"-1",Yf,void 0,void 0,ke):od.Mt("-1",Yd,"QueryTableStyle",
0,"-1",void 0,void 0,void 0,ke);this.T6a=!1}Yf=0;var Tf=this.qG,Kg;for(Kg in Tf){var Og=Tf[Kg];if(!De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==V||!Og.HasStyleViolations){ke=Cb.i4e(Og,this.Lvb());var Hh=Cb.Pwb(Og,this.nIa);if(Og)switch(Og.Category){case 0:Kb.Mt(Og.Index.toString(),Yd,"QueryTableStyle",0,Og.Index.toString(),Hh,void 0,void 0,ke);Yf++;break;case 3:Lb.Mt(Og.Index.toString(),Yd,"QueryTableStyle",0,Og.Index.toString(),
Hh,void 0,void 0,ke);break;case 2:Xa.Mt(Og.Index.toString(),Yd,"QueryTableStyle",0,Og.Index.toString(),Hh,void 0,void 0,ke);break;case 1:od.Mt(Og.Index.toString(),Yd,"QueryTableStyle",0,Og.Index.toString(),Hh,void 0,void 0,ke)}}}0<Yf&&this.d3(lb,Kb,1921);this.d3(lb,od,1922);this.d3(lb,Xa,1923);this.d3(lb,Lb,1924);ya.MenuItems=lb.sC();this.isInitialized||(this.isInitialized=!0);return!0};Va.prototype.Pjd=function(V){var ya=this;V[fh.a.On]=!1;var lb=V[Ud.a.ld];if(lb&&!nh.a.isEmpty(this.qG)){yg.a.contains(V.ParentMenuId,
"FormatAsTable",!0)?this.T6a=!0:this.T6a=!1;this.T6a||this.rdg();Cb.uif(V)&&(lb=this.gwb(lb).toString());var Kb=this.Lvb();V[fh.a.Alt]="-1"===lb?bf.a.instance.fa(1953):Cb.i4e(this.Ohd(lb),Kb);if(lb in this.yTa&&Kb.equals(this.d_c))this.lIf(V,lb,Kb,!0);else{if(!this.isc||this.isc&&!this.isc.yp)this.Tma={},this.isc=Xb.a.instance.create(function(){ya.DOf();ya.d_c=ya.Lvb()},0,yc.a.BIj,!0,!0);this.ZEd(Kb,V,lb)}}};Va.prototype.getTableStyleIndexFromName=function(V){if(!V||nh.a.isEmpty(this.qG))return-1;
if(V in this.qG)return this.qG[V].Index;this.cLa("getTableStyleIndexFromName");return-1};Va.prototype.Mic=function(){return!!this.JL};Va.prototype.gwb=function(V){this.lO||this.HZc();return V in this.lO?this.lO[V]:-1};Va.prototype.cLa=function(V){if(this.$.isEditMode)if(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ya=new Date;if(30<ci.getElapsedSeconds(this.lastSyncTime,ya)||nh.a.isEmpty(this.qG)||this.MMb){var lb=this.$.na.va.hc();this.lastSyncTime=
ya;V=this.MMb&&"accessibilityTab"===V||"galleryMenuClosed"===V;Xh.s(this.$.na.va,V,this.Uyf,this.ABd,null,V?"accessibility":"normal",lb)}}else if(lb=new Date,30<ci.getElapsedSeconds(this.lastSyncTime,lb)||nh.a.isEmpty(this.qG))V=this.$.na.va.hc(),this.lastSyncTime=lb,Xh.r(this.$.na.va,this.Uyf,this.ABd,null,null,V)};Va.prototype.dispose=function(){this.lO=this.yTa=this.JL=this.qG=null;this.$.Ka.Qbb(this.pEf);pg.prototype.dispose.call(this)};Va.prototype.oHg=function(V){this.addHandler("RefreshTableStyleGallery",
V)};Va.prototype.xdj=function(V){this.removeHandler("RefreshTableStyleGallery",V)};Va.prototype.HZc=function(){var V={};this.tableManager.Cg&&(this.dea=this.getTableStyleIndexFromName(this.tableManager.Cg.bAc));for(var ya=1;7>=ya;ya++)V["preview"+ya]=this.JTh(ya);this.lO=V};Va.prototype.JTh=function(V){var ya=this.JL.TableStyleItems.length;ya=4>=this.dea?this.dea+V-1:4<this.dea&&this.dea<ya-4?4===V?this.dea:Math.floor(this.dea+V-4):this.dea+V-1;-1===ya||ya.toString()in this.yTa||(ya=V-3);return ya};
Va.prototype.rdg=function(){if(this.tableManager.Cg){var V=!1,ya=this.getTableStyleIndexFromName(this.tableManager.Cg.bAc);if(ya!==this.dea){if(this.lO){var lb=this.lO,Kb;for(Kb in lb)lb[Kb]===ya&&(V=!0)}this.dea=ya;V||nh.a.isEmpty(this.yTa)||this.HZc()}}};Va.prototype.d3=function(V,ya,lb){var Kb=this.Sa.Pc();Kb.cq="Thin";Kb.title=bf.a.instance.fa(lb);Kb.buttons.push(ya);V.Dc.push(Kb)};Va.prototype.Lvb=function(){var V=this.tableManager.Cg;return this.T6a||!V?new tb(!0,!1,!1,!1,!0,!1):new tb(be.d(V),
be.g(V),be.c(V),be.e(V),be.f(V),be.b(V))};Va.prototype.DOf=function(V){V=void 0===V?!1:V;var ya={},lb={},Kb=this.Lvb();if(!nh.a.isEmpty(this.qG)&&(this.tableManager.Cg&&this.rdg(),!Kb.equals(this.d_c)||V||nh.a.isEmpty(this.yTa))){this.nIa=Cb.GUh(this.nIa);V=this.qG;for(var Lb in V){var Xa=V[Lb],od=Cb.Pwb(Xa,this.nIa);ya[Xa.Index.toString()]=Cb.t4a(Cb.xta(Cb.r4b(Xa,Kb)),od);lb[od]=ya[Xa.Index.toString()];this.JHb(lb)}Lb=Cb.Pwb(null,this.nIa,"-1");ya["-1"]=Cb.t4a(Cb.xta(Cb.r4b(null,Kb)),Lb);lb[Lb]=
ya["-1"];this.JHb(lb);ki.c(this.yTa,ya,!1)}};Va.prototype.uoi=function(){var V=Zd.a(this.$);return V?V.Wm.Mo===$d.a.ibb:!1};Va.prototype.ZEd=function(V,ya,lb){Number.parseInvariant(lb);"-1"===lb&&yg.a.contains(ya.ParentMenuId,"FormatAsTable",!0)||this.lIf(ya,lb,V,!1)};Va.prototype.lIf=function(V,ya,lb,Kb){var Lb=Cb.Pwb(null,this.nIa,ya);Cb.uif(V)?(Lb in this.Tma?lb=this.Tma[Lb]:(lb=Cb.xta(Cb.r4b(this.Ohd(ya),lb)),this.Tma[Lb]=lb),V[fh.a.GalleryButtonProps]=Object(Pe.a)(new rj.a,{Command:"-123538519",
QueryCommand:"QueryTableStyle",Id:Lb,Alt:V[fh.a.Alt],MenuItemId:ya,TableCellStyles:lb,TableStyles:this.t1i})):(V[Qh.a.Icon]=Lb,V[fh.a.GalleryButtonProps]=Object(Pe.a)(new bh.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Lb,Alt:V[fh.a.Alt],MenuItemId:ya}),Kb||(Kb=[],this.Ohd(ya),"-1"===ya||yg.a.contains(V.ParentMenuId,"FormatAsTable",!0)||(Kb=Cb.r4b(this.JL.TableStyleItems[Number.parseInvariant(ya)],lb)),this.yTa[ya]=Cb.t4a(Cb.xta(Kb),Lb)))};Va.prototype.JHb=function(V){var ya=this;if(this.JAb)this.lvc=
function(){ya.JHb(V)};else{this.lvc=null;var lb=[],Kb;for(Kb in V){var Lb=Kb;Lb in this.LHb?lb.push(Lb):this.LHb[Lb]=!0}try{0<lb.length&&appChrome.api.unregisterIcons(lb),nh.a.isEmpty(V)||appChrome.api.registerIconProvider(function(){return V})}catch(Xa){}}};Va.prototype.Ohd=function(V){V=Number.parseInvariant(V);if(-1===V||!this.JL)return null;if(60<V)for(var ya=60;ya<this.JL.TableStyleItems.length;++ya){var lb=this.JL.TableStyleItems[ya];if(lb.Index===V)return lb}return this.JL.TableStyleItems[V]};
Object(ie.a)(Va,"TableStyleManager",Ee.a,[619,2]);var qi=df.a;Am(ub,qi);ub.prototype.create=function(){var V=this,ya=ic.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),lb=ic.GetServiceTaskFactory.Ua(this.$.da,66,134,this.ub);Lc.TaskExtensions.Ba(Fe.Task.WAA(ya,lb),function(){V.Eb(V.tableStyleManager||(V.tableStyleManager=new Va(V.$,ya.result,lb.result)))},this.$.la,8)};Object(ie.a)(ub,"TableStyleManagerFactory",df.a,[]);var tg=b(904),Zh=b(56);La.prototype.QV=function(){return this.autoFilterOptions};
Object(ie.a)(La,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[447]);ua.prototype.QV=function(){return this.autoFilterOptions};Object(ie.a)(ua,"MacroRecorderRangeItemFilteredPayload",null,[447]);var Ga=b(1131),oa=b(387),Bb=b(175),Rd=b(186),je=b(292);Object(ie.a)(ba,"MacroRecorderTableStyleAppliedPayload",null,[447]);Am(K,ba);Object(ie.a)(K,"MacroRecorderRangeFormatedAsTablePayload",ba,[]);$a.prototype.tn=function(){return this.tableRange};$a.prototype.getTitle=function(){return this.title};
$a.prototype.getDescription=function(){return this.description};Object(ie.a)($a,"MacroRecorderTableAltTextEditedPayload",null,[447]);Object(ie.a)(mb,"MacroRecorderTableRenamedPayload",null,[447]);Object(ie.a)(cd,"MacroRecorderTableResizedPayload",null,[447]);Object(ie.a)(hc,"MacroRecorderTableStyleOptionToggledPayload",null,[447]);Object(ie.a)(Fb,"MacroRecorderTableConvertedToRangePayload",null,[447]);Cc.prototype.ZL=function(){Rb.ULS.sendTraceTag(537151186,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.Cf.mh.zc);if(this.ICa&&!Ch.a(this.ICa)){this.Cf.jAb=this.ICa.Result;if(this.Cf.jAb)return this.j1d=Ag.a.gd(3,2,0,735,0,-66108047,"ConvertToRange"),this.kj=ig.a(this.Cf.$).ui(this.j1d).G(),this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext)),this.gEc;this.Cf.pDe();return this.tgb}return this.R1};Cc.prototype.R1=function(){this.Cf.mh.stop();Rb.ULS.sendTraceTag(537151185,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.Cf.mh.zc);
this._state=3};Cc.prototype.tgb=function(){return this.R1};Cc.prototype.gEc=function(){this.k1d=this.kj.Dz();Rb.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.Cf.mh.zc);0===this.k1d&&this.Cf.oDe();return this.tgb};Cc.prototype.dispose=function(){};Object(ie.a)(Cc,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[2]);var yf=b(954);Tb.prototype.mab=function(){var V=this;this.mh.start();
var ya=this.$.na.va.hc();return De.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?yf.h(this.$.na.va,this.sharedSheetRange,function(lb){V.showDialog(lb)},null,null,null,ya):yf.h(this.$.na.va,this.sharedSheetRange,function(lb){V.qAj(lb)},null,null,null,ya)};Tb.prototype.showDialog=function(V){var ya=this;Rb.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.mh.zc);V&&!Ch.a(V)&&((this.jAb=V.Result)?(V=Ag.a.gd(3,2,0,735,0,-66108047,"ConvertToRange"),Lc.TaskExtensions.Ba(ig.a(this.$).ui(V),function(lb){Rb.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",ya.mh.zc);0===lb.result&&ya.oDe()},this.$.la,11)):this.pDe());this.mh.stop();Rb.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.mh.zc)};Tb.prototype.qAj=
function(V){new Cc(this,V)};Tb.prototype.uve=function(){var V={};V.IsQueryTable=this.jAb;V.Range=this.sharedSheetRange;return V};Tb.prototype.oDe=function(){var V=this,ya=this.$.na.va;Rb.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.mcf(194,function(lb,Kb,Lb){return yf.d(ya,V.uve(),lb,Kb,Lb,null)});Rb.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};Tb.prototype.pDe=function(){var V=this,ya=this.$.na.va;Rb.ULS.sendTraceTag(537151188,
0,50,"Convert To Range initiated for Normal Table");this.mcf(193,function(lb,Kb,Lb){return yf.c(ya,V.uve(),lb,Kb,Lb,null)},function(){return new Fb(V.tableName)});Rb.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};Tb.prototype.mcf=function(V,ya,lb){lb=void 0===lb?null:lb;oa.a(this.$.userOperationManager,ya,function(Kb){return new Bb.a(V,0,Kb,void 0,lb)},null)};Object(ie.a)(Tb,"ConvertToRangeManager",null,[]);var Of=b(1284),Mf=b(1283),ah=b(1319),Xg=ah.a;Am(Sa,Xg);Sa.prototype.vk=
function(){var V=this,ya=Ia.s(this.FC.TableRange);return function(){return new K(ya,V.w5a.checked,V.BBa,!0)}};Sa.prototype.Nx=function(){var V=this,ya=Ia.s(this.FC.TableRange);return function(lb,Kb,Lb){return yf.g(V.$.na.va,ya,V.w5a.checked,!1,V.FC.HasTotalRow,V.BBa,lb,Kb,Lb,null)}};Sa.prototype.Dy=function(V,ya,lb){Xg.prototype.Dy.call(this,V,ya,lb)};Ck.Object.defineProperties(Sa.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Iu:{configurable:!0,enumerable:!0,
get:function(){return 215}}});Object(ie.a)(Sa,"FormatAsTableDialogDeprecated",ah.a,[]);var Eh=b(1152),rh=Eh.a;Am(xb,rh);xb.prototype.vk=function(){var V=this,ya=Ia.s(this.FC.TableRange);return function(){return new K(ya,V.hasHeaders,V.BBa,!0)}};xb.prototype.Nx=function(){var V=this,ya=Ia.s(this.FC.TableRange),lb=this.FC.HasTotalRow;return function(Kb,Lb,Xa){return yf.g(V.$.na.va,ya,V.hasHeaders,!1,lb,V.BBa,Kb,Lb,Xa,null)}};Ck.Object.defineProperties(xb.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"FormatAsTableDialog"}},Iu:{configurable:!0,enumerable:!0,get:function(){return 215}},Im:{configurable:!0,enumerable:!0,get:function(){return bf.a.instance.fa(729)}}});Object(ie.a)(xb,"FormatAsTableReactDialog",Eh.a,[]);var Fh=b(388),Rh=b(87),se=Fh.a;Am(Yb,se);Yb.prototype.OGf=function(V){V=V.startsWith("=")?V.substring(1,V.length):V;var ya=Ia.Z(V,this.$.xa);V=ya.sheetName;var lb=ya.range;return ya.returnValue&&lb?(lb=Ia.v(lb,this.$),lb.SheetName=yg.a.equals(V,"",!0)?this.$.qa.name:
V,lb):null};Yb.prototype.$V=function(V){var ya={};return ya[Yb.x5]="ResizeTableDialog",ya[Yb.lMf]=V,ya.getInputErrorIfInvalid=this.hwb,ya};Yb.prototype.Tfd=function(V){V=this.OGf(V);if(!V)return 1;var ya=Ia.D(V);return yg.a.equals(V.SheetName,this.$.qa.sheetName,!0)&&this.zpc.top===ya.top&&this.zpc.Kd(ya)?0:2};Yb.prototype.mdd=function(V){var ya="";switch(V){case 1:ya=bf.a.instance.fa(74);break;case 2:ya=Rh.a.fg(bf.a.instance.fa(73))}return ya};Yb.prototype.iNj=function(V){var ya={};V=(ya.ResizeTableRange=
V,ya.OriginalTableRange=this.zpc,ya);this.$.Zd(-1400250766,Ud.a.Vb,8,V)};Ck.Object.defineProperties(Yb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});Yb.x5="id";Yb.lMf="range";Object(ie.a)(Yb,"ResizeTableDialog",Fh.a,[]);var kh=Fh.a;Am(Ob,kh);Ob.prototype.rIj=function(V,ya){if(1===V&&(V=ya[Ob.UKj],ya=ya[Ob.keh],V!==this.CDd||ya!==this.ADd)){var lb={};V=(lb.Title=V,lb.Description=ya,lb);this.$.Zd(868579142,Ud.a.Vb,8,V)}};Ob.prototype.$V=function(V,ya){var lb=
{};return lb.id="AltTextDialog",lb.title=V,lb.description=ya,lb};Ck.Object.defineProperties(Ob.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});Ob.x5="id";Ob.UKj="title";Ob.keh="description";Object(ie.a)(Ob,"TableAltTextDialog",Fh.a,[]);var jg=b(981),oh=b(982),Mi=b(145),Nh=b(66),Zg=b(37);Ub.prototype.$c=function(V,ya){switch(ya){case -544558380:return!(this.tableManager&&this.ta.wK()&&!this.CMa()&&be.d(this.tableManager.Cg));case 1544516694:return!(this.tableManager&&
(this.ta.wK()?!this.CMa():this.ta.mMa()));case -697806646:case 323142015:return!this.ta.wK();case 341449783:case 2128797448:return De.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ta.wK()?!this.CMa():this.ta.mMa())):!(this.tableManager&&this.tableManager.bsd(this.ta.activeCell));case -123538519:return!(this.ta.wK()&&this.tableStyleManager&&this.tableStyleManager.Mic());case 756677940:return!(De.EwaSettings.ma(412)&&this.lfi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&
this.mfi());case 844144422:return!this.ta.wK();case -723113214:return!(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&this.ta.wK())}return!1};Ub.prototype.executeCommand=function(V,ya,lb){var Kb=this,Lb;V=Lc.TaskExtensions.Dl();var Xa=this.$.na.va,od=null,Yd=1,ke=ya.command,Yf=this.$.na.va.hc(),Tf=null;switch(ke){case -2058042992:var Kg=Zh.a.oi(lb[Ud.a.Ag]);Ub.$Yf(this.$,Kg);od=function(vj,Hi,Pj){return yf.a(Xa,Kg,null,null,!1,!1,!1,jg.a.Xva(Mi.a.Gsa,
oh.a.clearAutoFilter,vj),Hi,Pj,null)};Yd=176;Tf=function(){return new ua(Kg)};break;case 504133448:case -798968736:case 477776686:var Og=Zh.a.oi(lb[Ud.a.Ag]),Hh=lb.TopCellAddress;Ub.$Yf(this.$,Og);var si=504133448===ya.command?1:-798968736===ya.command?2:3;if(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&Hh){lb=this.tableManager.tn(Hh);if(!lb&&De.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var Vj=this.$.xa.qa;(null===
(Lb=Ia.D(Vj.j1))||void 0===Lb?0:Lb.contains(Hh))?lb=Ia.D(Vj.j1):Rb.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!De.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||lb&&!this.$.AXc([lb],!0,1))break}else if(lb&&!this.$.Dq([lb],!0,1))break}od=function(vj,Hi,Pj){return Xh.ib(Xa,Og,si,je.b(vj,Kb.KTi),Hi,Pj,Hh,Yf)};Yd=177;Tf=function(){return new La(Og,si)};
break;case 341449783:case 2128797448:this.IRa=341449783===ke?0:2;Lb=this.toggleTableStyleOption(Xa,Yf);od=Lb.Zgg;Yd=Lb.operationName;Tf=Lb.vk;break;case -712419744:this.ry?this.Wbf(lb[$d.a.event]):this.Wbf(null);break;case 1868184698:De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new Mf.a(this.$):(Lb=new Of.a(this.$),Lb.initialize(),Lb.kf());break;case 844144422:new Yb(this.$);break;case 1544516694:case -544558380:if(Lb=lb[Ud.a.ld])this.IRa=this.u_h(Lb),-1!==this.IRa&&
(Lb=this.toggleTableStyleOption(Xa,Yf),od=Lb.Zgg,Yd=Lb.operationName,Tf=Lb.vk);break;case 756677940:if(this.CMa()&&this.Ogf()){Rb.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var mg=lb.Text,Ti=this.OSh();if(Ti){od=function(vj,Hi,Pj){return yf.i(Xa,mg,Ti,je.b(vj,Kb.JTi),je.a(Hi,Kb.ITi),Pj,Yf)};Yd=217;var Bg=null;this.tableManager.Cg?Bg=this.tableManager.Cg.name:
this.tableManager.dGd?Bg=this.tableManager.dGd.name:Rb.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");Bg&&(Tf=function(){return new mb(Bg,mg)})}else return Rb.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Fe.Task.Ra(!1);break;case 323142015:if(this.CMa())break;return(new Tb(this.$,this.Fdd(),this.tableManager.Cg.name)).mab();
case -1400250766:Yd=211;od=this.Ehj(lb,Xa,Yf);var Zj=Ia.m(lb.OriginalTableRange,this.$.xa.qa);Tf=function(){return new cd(Zj)};break;case 1872288872:this.tableManager.e4i();break;case -123538519:var zi=this.t_h(lb);Lb=yg.a.contains(lb[Ud.a.ld],$d.a.NGb,!0)||yg.a.contains(lb[$d.a.nG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";Rb.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",Lb,zi.toString());var sg=
this.r3e();sg&&(od=function(vj,Hi,Pj){return yf.b(Xa,sg,zi,vj,Hi,Pj,null,Yf)},Tf=function(){return new ba(sg,zi)},Yd=212);break;case 753331043:Lb=lb[Ud.a.ld];if(!Lb)break;var bk=Number.parseInvariant(Lb);if(this.ta.wK()){Rb.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",bk);var lj=this.r3e();lj&&(od=function(vj,Hi,Pj){return yf.g(Xa,lj,!1,!1,!1,bk,vj,Hi,Pj,null,Yf)},Tf=function(){return new K(lj,!1,bk,!1)},Yd=215)}else Rb.ULS.sendTraceTag(51181322,
0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",bk),De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new xb(this.$,Number.parseInvariant(Lb)):(Lb=new Sa(this.$,Number.parseInvariant(Lb)),Lb.initialize(),Lb.kf());break;case 71074531:var pk=lb.HasHeader,wk=lb.TableRange;od=function(vj,Hi,Pj){return yf.e(Xa,wk,pk,!1,!1,vj,Hi,Pj,null)};Tf=function(){return new Ga.a(pk,wk)};Yd=206;break;case -723113214:new Ob(this.$);break;
case 868579142:Rb.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Yd=1022;var cg=lb.Title,Wj=lb.Description,dj=this.Fdd();od=function(vj,Hi,Pj){return yf.f(Xa,cg,Wj,dj,vj,Hi,Pj,null)};if(this.tableManager.Cg){Vj=yg.a.Gh(this.tableManager.Cg.wTa)?"":this.tableManager.Cg.wTa;var Oh=yg.a.Gh(this.tableManager.Cg.xTa)?"":this.tableManager.Cg.xTa}Tf=cg==Vj?function(){return new $a(dj,void 0,Wj)}:Wj==Oh?function(){return new $a(dj,cg,void 0)}:function(){return new $a(dj,cg,Wj)};break;default:return Rd.a(ke)}if(od){var Mg=
function(vj){return new Bb.a(Yd,0,vj,void 0,Tf)};V=!this.namedSheetViewPublic||-2058042992!==ke&&504133448!==ke&&-798968736!==ke&&477776686!==ke?oa.a(this.$.userOperationManager,od,Mg,ya):this.namedSheetViewPublic.jBa().continueWith(function(vj){vj.result&&oa.a(Kb.$.userOperationManager,od,Mg,ya)})}return V};Ub.prototype.toggleTableStyleOption=function(V,ya){var lb=this,Kb=this.ta.mMa();Rb.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Kb?"PivotTable":
"table",this.IRa);var Lb=this.Fdd();return{Zgg:function(Xa,od,Yd){return yf.k(V,Lb,lb.IRa,je.b(Xa,lb.qUi),od,Yd,null,ya)},operationName:196,vk:function(){return new hc(Lb,lb.IRa,Kb)}}};Ub.prototype.Ehj=function(V,ya,lb){function Kb(ke){ke.Errors&&Xa.tableManager.Z8f(od)}function Lb(){Xa.tableManager.Z8f(od)}var Xa=this,od=V.OriginalTableRange,Yd=Ia.m(V.ResizeTableRange,this.$.xa.qa);return function(ke,Yf,Tf){return yf.j(ya,Yd,je.b(ke,Kb),je.a(Yf,Lb),Tf,null,lb)}};Ub.prototype.t_h=function(V){var ya=
-1;V[Ud.a.ld]&&(ya=V[Ud.a.ld],ya=yg.a.contains(ya,$d.a.NGb,!0)?this.tableStyleManager.gwb(ya):Number.parseInvariant(V[Ud.a.ld]));return ya};Ub.prototype.Kc=function(V,ya){V=!1;switch(ya.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:V=!0;break;case 756677940:V=De.EwaSettings.ma(412);
break;case -723113214:case 868579142:V=De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)}return V};Ub.prototype.jd=function(V,ya,lb){V=!1;switch(ya){case "PopulateTableMoreStylesMenu":this.menuId=lb.MenuId;this.tableStyleManager.Mic()||this.tableStyleManager.cLa("formatAsTableMenu");V=this.tableStyleManager.jIf(ya,lb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=lb.MenuId,this.tableStyleManager.Mic()||this.tableStyleManager.cLa("accessibilityTab"),
V=this.tableStyleManager.jIf(ya,lb)}return V};Ub.prototype.dispose=function(){this.tableStyleManager.xdj(this.qEf)};Ub.prototype.Bda=function(){(yg.a.contains(this.menuId,"Format",!0)||yg.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Wv(this.menuId)};Ub.prototype.Fdd=function(){return Ia.v(this.ta.activeCell,this.$)};Ub.prototype.OSh=function(){var V=this.tableManager.ktd;return V?Ia.v(V,this.$):null};Ub.prototype.Wbf=function(V){if(this.tableManager){var ya=Kf.g(this.$),lb=this.ta.activeCell,
Kb=this.tableManager.tn(lb),Lb=null;if(!Kb||Kb.YSa)for(ya=Cl(ya.L3),Kb=ya.next();!Kb.done;Kb=ya.next()){Kb=Cl(Kb.value);for(var Xa=Kb.next();!Xa.done;Xa=Kb.next()){Xa=Xa.value;var od=Xa.Sn;lb.left>=od[0]&&lb.left<=od[od.length-1]&&(Lb=(Xa=Xa.ks(lb).iK())?le.DOMElementExtensions.Cj(Xa,Lg.a.cqe):null)}}else{var Yd=ya.mc(ue.Range.hd(Kb.top,lb.left));if(this.ry){Xb.a.instance.create(function(){Yd.invoke(8,V)},0,yc.a.T8f,!0,!0);return}Lb=Yd.LKa(56).o6a}Lb&&Xb.a.instance.create(function(){le.DOMElementExtensions.Ofc(Lb,
null)},0,yc.a.T8f,!0,!0)}};Ub.prototype.u_h=function(V){V=Number.parseInvariant(V);return-1<V&&8>=V?V:-1};Ub.prototype.CMa=function(){return!this.tableManager.Cg};Ub.prototype.Ogf=function(){return this.tableManager.dGd?!1:(Rb.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};Ub.prototype.mfi=function(){var V=this.ta.wK(),ya=this.ta.Lg&&!Kf.g(this.$).Rb.W5(this.ta.ud);return V||ya};Ub.prototype.lfi=function(){return this.ta.wK()||
!this.Ogf()};Ub.prototype.w_h=function(V){var ya=[];V=Cl(V);for(var lb=V.next();!lb.done;lb=V.next())if(lb=cb.b(this.$,lb.value),null===lb||void 0===lb?0:lb.length){lb=Cl(lb);for(var Kb=lb.next();!Kb.done;Kb=lb.next())Kb=Kb.value,Kb.usedRange&&!Array.contains(ya,Kb.usedRange)&&ya.push(Kb.usedRange)}return ya};Ub.prototype.r3e=function(){var V=this.ta.selectedRanges,ya=[];if(De.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))ya=this.w_h(V);else{V=
Cl(V);for(var lb=V.next();!lb.done;lb=V.next())lb=lb.value,Kf.g(this.$).Rb.W5(lb)&&ya.push(lb)}return ya&&ya.length?Ia.r(ya,this.$):null};Ub.prototype.QL=function(V){Zg.a.$ba(this.$)&&Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(ya){ya.result.Oea(V);Rb.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};Ub.prototype.vsi=function(V){var ya=this;Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(this.$.da,
446,447,0),function(lb){lb.result.S$g(ya.$,V)},this.$.la,3)};Ub.$Yf=function(V,ya){ya.SheetName=V.qa.name;ya.NamedObjectView=V.ea.isNamedObjectViewMode};Object(ie.a)(Ub,"TableCommandHandler",null,[424]);var Df=tg.a;Am(yd,Df);yd.prototype.dispose=function(){Df.prototype.dispose.call(this)};yd.prototype.Nd=function(){var V=this,ya=ic.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),lb=ic.GetServiceTaskFactory.create(this.$.da,330,this.la,this.ub),Kb=ic.GetServiceTaskFactory.Ua(this.$.da,
309,310,this.ub);Lc.TaskExtensions.Ba(Fe.Task.WAA(ya,Kb,lb),function(){V.Dd([new Ub(V.$,ya.result,Kb.result,lb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};yd.ka=function(V){tg.a.he(86,new yd(V))};Object(ie.a)(yd,"TableCommandHandlerFactory",tg.a,[]);ec.prototype.$c=function(){return!1};ec.prototype.executeCommand=function(V,ya){V=ya.command;ya=null;switch(V){case 1243860697:this.Uih.rLj();break;default:ya=Rd.a(V)}return ya||Fe.Task.Ra(!0)};
ec.prototype.Kc=function(V,ya){return 1243860697===ya.command};ec.prototype.jd=function(){return!1};Object(ie.a)(ec,"SheetDropdownMenuCommandHandler",null,[424]);var Ff=tg.a;Am(Ya,Ff);Ya.prototype.Nd=function(){var V=this;this.$.WC(function(ya){ya.mfc().then(function(){Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(V.$.da,32,33,V.ub),function(lb){V.Dd([new ec(lb.result.gwj)])},V.$.la)})})};Ya.ka=function(V){tg.a.he(392,new Ya(V))};Object(ie.a)(Ya,"SheetDropdownMenuCommandHandlerFactory",tg.a,[]);
var zh=b(194),og=b(42),vh=b(109),ij=b(35);rb.prototype.bLg=function(V,ya){this.jJe.add(V,ya);this.mT()};rb.prototype.mT=function(){var V=this;this.pIc=0;ij.a.forEach(this.jJe.nu,function(ya){V.pIc=V.g7c|ya.value})};Ck.Object.defineProperties(rb.prototype,{g7c:{configurable:!0,enumerable:!0,get:function(){return this.pIc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.g7c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.g7c&
2)}}});Object(ie.a)(rb,"SheetTabBarDisabledStateManager",null,[]);pb.Kth="ewa-stb-uir";pb.nPe="ewa-stb-drag";pb.uth="ewa-stb-navarea";pb.vth="ewa-stb-navarea-dimensions";pb.xth="ewa-stb-navbutton";pb.FZ="cui-disabled";pb.Fia="cui-img-container";pb.wth="ewa-stb-navareaextra";pb.rth="ewa-stb-contentarea";pb.oPe="ewa-stb-left-scrollable";pb.APe="ewa-stb-right-scrollable";pb.Ith="ewa-stb-tabarea";pb.Hth="ewa-stb-sheettabmoveindicator";pb.CPe="ewa-stb-tabs";pb.eIj="tab-active";pb.lIj="tab-inactive";pb.kIj=
"tab-hover";pb.Jth="ewa-stb-tabs-ghost";pb.gIj="tab-anchor-text";pb.dark="dark";pb.light="light";pb.fIj="tab-active-text";pb.iIj="tab-content-container";pb.nIj="tab-text";pb.Ath="ewa-stb-nsv-inactive";pb.Bth="ewa-stb-nsv-inactive-svg";pb.yth="ewa-stb-nsv-active";pb.zth="ewa-stb-nsv-active-svg";pb.dsh="ewa_nsv_margin";pb.sth="ewa-stb-disable-scrollbar";pb.Hsi="leave-size-fixed-on-tab-hover-old";pb.Gsi="leave-size-fixed-on-tab-hover";pb.sPe="ewa-stb-locked-sheet";pb.tPe="ewa-stb-locked-sheet-svg";pb.uPe=
"ewa-stb-locked-sheet-svg-16px";pb.tth="ewa-stb-dropdown-menu-button";pb.dnh="ewa-active-sheet-menu-item";Object(ie.a)(pb,"CssClassNames",null,[]);var k=b(563),G=b(19),d=b(102),S=b(561),P=b(296),ja=b(329),D=b(99),da=b(359),Ha=b(195),jb=b(389),kc=b(385),Jb=b(228),md=b(86),ce=ph.a;Am(nc,ce);nc.prototype.dispose=function(){this.Bab=this.Rsa=this.$=null;ce.prototype.dispose.call(this)};nc.prototype.YX=function(V){this.tY=V;this.domElement.setAttribute($d.a.Dha,V.toString());le.DOMElementExtensions.toggleCssClass(this.domElement,
k.a.FZ,V)};Ck.Object.defineProperties(nc.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.tY}}});Object(ie.a)(nc,"SheetBarButton",ph.a,[]);var qe=b(920);Am(Pa,nc);Pa.prototype.dispose=function(){Jb.a.instance.za(lf.a.click,this.domElement,this.vd);vh.KeyInputManager.instance.Uv(this.domElement,this.zNa);De.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Kf.g(this.$)&&Kf.g(this.$).Ac&&(Kf.g(this.$).Ac.kl(this.gj),Kf.g(this.$).Ac.Zn(this.Ng));
nc.prototype.dispose.call(this)};Pa.prototype.YX=function(V){var ya=Pa.K2f(this.$);nc.prototype.YX.call(this,V||ya)};Pa.K2f=function(V){return!V.isEditMode||!V.xa.count};Object(ie.a)(Pa,"InsertSheetButton",nc,[]);Am(cc,nc);cc.prototype.dispose=function(){Jb.a.instance.za(lf.a.click,this.domElement,this.vd);vh.KeyInputManager.instance.Uv(this.domElement,this.zNa);this.cwe=null;nc.prototype.dispose.call(this)};Object(ie.a)(cc,"InsertTemplateButton",nc,[]);ib.prototype.getSheetName=function(){return this.sheetName};
Object(ie.a)(ib,"MacroRecorderSheetReorderedPayload",null,[447]);var Ye=ph.a;Am(eb,Ye);eb.prototype.dispose=function(){this.wm();Ye.prototype.dispose.call(this)};eb.prototype.rLj=function(){this.jSf(!0,"TogglerSheetDropdownMenu")};eb.prototype.jSf=function(V,ya){Rb.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",ya,V,this.JNb);V&&(this.JNb+=1);var lb=this.$.Ob.Hc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",
ya,V,this.JNb,this.$.xa.count));V=this.I$g();appChrome.renderSheetDropdownMenu(this.domElement,this.KIj,V,this.JNb,this.uKi,this.tKi,function(){lb.stop()},jb.a(this.$))};eb.prototype.I$g=function(){for(var V=this.$.xa,ya=[],lb=0;lb<V.count;lb++){var Kb=Object(Xf.a)(D.a,V.getItem(lb));0===Kb.Ty&&(Kb=this.H$g(Kb),ya.push(Kb))}return ya};eb.prototype.H$g=function(V){var ya={};ya.key=V.name;ya.text=V.name;ya.onClick=this.J$g(V);V.active&&(ya.className=jb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":
pb.dnh);return ya};eb.prototype.J$g=function(V){var ya=this;return function(){var lb=new td.a(-1876836819,0,ya.$.fd,30,null),Kb={};ya.$.Ka.$b(lb,(Kb[$d.a.qRd]=V.name,Kb))}};eb.prototype.Ek=function(){if(!this.EV){var V=this.$.xa;V.zg(this.nS);V.IVc(this.nS);V.$Y(this.nS);V.pha(this.nS);V.gGa(this.nS);V.Boe(this.nS);V.iZa(this.nS);this.EV=!0}};eb.prototype.wm=function(){if(this.EV){var V=this.$.xa;V.Vg(this.nS);V.WJd(this.nS);V.z7(this.nS);V.jna(this.nS);V.SQa(this.nS);V.jRf(this.nS);V.uIb(this.nS);
this.EV=!1}};Object(ie.a)(eb,"SheetDropdownMenu",ph.a,[701,2]);var ma=b(368);Am(lc,nc);lc.prototype.dispose=function(){this.TPj();nc.prototype.dispose.call(this)};lc.prototype.YX=function(V){nc.prototype.YX.call(this,V||!this.$.ea.Ywa)};lc.prototype.L$f=function(V){this.disabled||(Rb.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",ma.a[V]),this.$.Ka.$b(new td.a(1243860697,V,this.$.fd,30,null)))};lc.prototype.S8i=function(){Jb.a.instance.pa(lf.a.click,this.domElement,
this.vd);vh.KeyInputManager.instance.pa(lf.a.Xb,this.domElement,this.onKeyDown)};lc.prototype.TPj=function(){Jb.a.instance.za(lf.a.click,this.domElement,this.vd);vh.KeyInputManager.instance.za(lf.a.Xb,this.domElement,this.onKeyDown)};Object(ie.a)(lc,"SheetDropdownMenuAnchor",nc,[]);var ab=b(203),bc=b(126),Rc=b(59),Nc=b(227),id=b(172);pc.prototype.sN=function(){return this.sheet.active};pc.prototype.Mpd=function(){return this.sheet.isLockPausedInSession};pc.prototype.fta=function(){return this.rm?
G.a.rPe:this.sN()?G.a.qPe:G.a.pPe};pc.prototype.yoa=function(){return this.sheet.tj?qe.a.EKf:De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?qe.a.FPj:qe.a.EPj};pc.prototype.DVd=function(){return De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};pc.prototype.FVd=function(){return De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};pc.prototype.gia=function(){return null};pc.prototype.gta=
function(){return this.rm?this.Pw?De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?pb.uPe:pb.tPe:pb.sPe:null};pc.prototype.dXd=function(){return null};pc.prototype.Tv=function(){return null};pc.prototype.Rld=function(){return 0};pc.prototype.fXc=function(){return!0};Object(ie.a)(pc,"LockPausedSheetIconDataSource",null,[671]);Db.prototype.sN=function(){return this.sheet.active};Db.prototype.Mpd=function(){return this.sheet.tj};Db.prototype.fta=function(){return this.rm?
G.a.rPe:this.sN()?G.a.qPe:G.a.pPe};Db.prototype.yoa=function(){return qe.a.EKf};Db.prototype.DVd=function(){return De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};Db.prototype.FVd=function(){return De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};Db.prototype.gia=function(){return null};Db.prototype.gta=function(){return this.rm?this.Pw?De.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
pb.uPe:pb.tPe:pb.sPe:null};Db.prototype.dXd=function(){return null};Db.prototype.Tv=function(){return null};Db.prototype.Rld=function(){return 0};Db.prototype.fXc=function(){return!0};Object(ie.a)(Db,"LockedSheetIconDataSource",null,[671]);Wa.prototype.sN=function(){return this.sheet.active};Wa.prototype.Mpd=function(){return this.sheet.Yd.ty};Wa.prototype.gia=function(){return this.Pw?this.sN()?pb.zth:pb.Bth:this.sN()?pb.yth:pb.Ath};Wa.prototype.fta=function(){return!this.sN()&&this.E3f()?G.a.Avh:
G.a.zvh};Wa.prototype.yoa=function(){return!this.sN()&&this.E3f()?qe.a.qwj:qe.a.pwj};Wa.prototype.DVd=function(){return 14};Wa.prototype.FVd=function(){return 16};Wa.prototype.gta=function(){return pb.dsh};Wa.prototype.dXd=function(){return this.sheet.Yd.rnb};Wa.prototype.Tv=function(){return this.ILj};Wa.prototype.Rld=function(){return 8};Wa.prototype.fXc=function(){return!1};Object(ie.a)(Wa,"NamedSeetViewSheetIconDataSource",null,[671]);Fa.prototype.Pdg=function(){if(this.OI&&(this.yl||this.xBa)){if(this.Pw){var V=
this.dataSource.yoa();this.yoa!==V&&(this.xBa&&this.xBa.parentNode.removeChild(this.xBa),this.kbf(),this.yoa=V)}else V=this.dataSource.fta(),this.fta!==V&&(this.YKd(this.yl,this.fta,V),this.fta=V);V=this.dataSource.gia();this.gia!==V&&(this.Pw?this.Nej(this.xBa,this.gia,V):this.YKd(this.yl,this.gia,V),this.gia=V);V=this.dataSource.gta();this.gta!==V&&(this.YKd(this.OI,this.gta,V),this.gta=V);this.dataSource.Tv()&&!this.dataSource.sN()&&this.clearToolTip()}};Fa.prototype.TAj=function(V,ya,lb){this.pci(V,
ya,lb);le.DOMElementExtensions.setVisible(this.OI,this.dataSource.Mpd())};Fa.prototype.clearToolTip=function(){var V=this;Lc.TaskExtensions.Ba(this.jCb,function(){dialogControls.clearToolTip(V.dataSource.Tv())},this.$.la,3)};Fa.prototype.pci=function(V,ya,lb){this.OI&&this.Ngf!==V&&(this.OI.parentNode.removeChild(this.OI),this.gta=this.gia=this.yoa=this.fta=this.$Rc=null,this.dataSource.Tv()&&(this.Fc.detach("mouseover",!0),this.Fc.detach("mouseout",!0)));this.OI||(this.$Rc=document.createElement("span"),
Sys.UI.DomElement.addCssClass(this.OI,k.a.Fia),Sys.UI.DomElement.addCssClass(this.OI,G.a.Wr),De.EwaSettings.ma(508)?V===this.dataSource.fXc()?ya.appendChild(this.OI):ya.insertBefore(this.OI,lb):V?ya.insertBefore(this.OI,lb):ya.appendChild(this.OI),this.Pw?this.kbf():(this.yl=document.createElement("img"),this.yl.tabIndex=-1,this.yl.alt=this.dataSource.altText,this.OI.appendChild(this.yl),this.yl.src=Td.a.Se(this.dataSource.Rld())),this.dataSource.Tv()&&(this.Fc.ka("mouseover",this.bO,!0),this.Fc.ka("mouseout",
this.aO,!0)),this.Ngf=V)};Fa.prototype.Nej=function(V,ya,lb){V&&(Sys.UI.DomElement.removeCssClass(V,ya),Sys.UI.DomElement.addCssClass(V,lb))};Fa.prototype.YKd=function(V,ya,lb){ya&&Sys.UI.DomElement.removeCssClass(V,ya);lb&&Sys.UI.DomElement.addCssClass(V,lb)};Fa.prototype.dispose=function(){He.a.Ha(this.i2)};Fa.prototype.kbf=function(){var V=this.$.da.Aa(388);V?(this.xBa=V.Yva(this.dataSource.yoa(),this.dataSource.DVd(),this.dataSource.FVd()))?this.OI.appendChild(this.xBa):Rb.ULS.shipAssertTag(537153763,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.yoa()):Rb.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Ck.Object.defineProperties(Fa.prototype,{Fc:{configurable:!0,enumerable:!0,get:function(){return this.i2||(this.i2=$g.a.instance.Wd(this.OI))}},jCb:{configurable:!0,enumerable:!0,get:function(){var V=this;if(this.Qqa)return this.Qqa;var ya=new jc.a;this.$.WC(function(lb){Lc.TaskExtensions.Ba(lb.wud(),
function(){ya.setResult(!0)},V.$.la,3)});return this.Qqa=ya.task}},OI:{configurable:!0,enumerable:!0,get:function(){return this.$Rc}}});Object(ie.a)(Fa,"SheetIcon",null,[2]);var xe=b(366),cf=b(157),ag=pf.a;Am(sa,ag);sa.prototype.dispose=function(){this.coa&&(Jb.a.instance.za(lf.a.jk,this.coa.domElement,this.Oca),xe.a.instance.za(this.coa.domElement,this.il),this.Lhe=null);this.$=null;ag.prototype.dispose.call(this)};sa.prototype.showContextMenu=function(V,ya,lb){this.coa.activate(ya,Zg.a.$rd());ya=
new td.a(-1075099431,ya,this.$.fd,30,null);var Kb,Lb={};return!cf.a(Kb=this.$.Ka.$b(ya,(Lb[$d.a.g2f]=V,Lb[sa.hwj]=this.coa.sheet,Lb[$d.a.h2f]=lb,Lb)))&&(6!==Kb.status||Kb.result)};sa.prototype.rename=function(V,ya){this.$.Zd(817296323,ya,V?19:0,null)};Ck.Object.defineProperties(sa.prototype,{coa:{configurable:!0,enumerable:!0,get:function(){return this.Lhe}}});sa.hwj="Sheet";Object(ie.a)(sa,"SheetOpsSheetClickHelper",pf.a,[]);Am(Oa,nc);Oa.prototype.CQh=function(){return le.DOMElementExtensions.canReceiveFocus(this.anchor)?
this.anchor:null};Oa.prototype.dispose=function(){if(this.EV){eg.a.instance.za(lf.a.pointerDown,this.domElement,this.onPointerDown);vh.KeyInputManager.instance.za(lf.a.Xb,this.domElement,this.onKeyDown);vh.KeyInputManager.instance.za(lf.a.Ap,this.domElement,this.Sz);Jb.a.instance.za(lf.a.click,this.domElement,this.vd);eg.a.instance.za(lf.a.dX,this.domElement,this.Xya);eg.a.instance.za(lf.a.Iy,this.domElement,this.Yya);if(this.y7a||De.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))eg.a.instance.za(lf.a.$d,
this.domElement,this.Pf),this.vxa&&(Je.a.instance.za(lf.a.Ce,this.domElement,this.Pf),Je.a.instance.za(lf.a.wg,this.domElement,this.eO));this.EV=!1;this.T5b="#BEBBB8"}He.a.yc([this.dAe,this.jve]);this.eP=this.ME=this.BFc=this.ZS=this.jve=this.dAe=null;if(this.$na){for(var V=Cl(this.$na),ya=V.next();!ya.done;ya=V.next())ya.value.dispose();this.$na=null}this.color=this.OWb=null;nc.prototype.dispose.call(this)};Oa.prototype.YX=function(V){V&&this.Vna(!1,!1);nc.prototype.YX.call(this,V)};Oa.prototype.aTd=
function(V){if(Rc.a.Dg.PR){this.rJe();var ya=ic.GetServiceTaskFactory.Ua(this.$.da,322,323,1);Lc.TaskExtensions.Ba(ya,function(lb){ab.UISurfaces.ZV().then(function(Kb){var Lb=lb.result;Lb.msj(Kb);Lb.show(V);return null},function(Kb){Rb.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Kb);return null})},this.la,3)}};Oa.prototype.ine=function(){var V=this;if(this.sheet.active&&this.$.kr){var ya=this.$.kr,lb=Kf.g(this.$),Kb=lb.Nq;
if(this.sheet.Yd.ty){if(!this.uDb){var Lb=new Wa(this.sheet,this.ZS.qxc,function(){return V.color?Oa.vSd(V.color):!1},this.Pw);this.uDb=new Fa(this.$,Lb);this.$na.add(this.uDb)}Kb?lb.Jfb(1):ya.classList.add(G.a.O$c);ya=Oa.lgd($d.a.jsf);lb=Oa.lgd($d.a.nyd);Kb=Oa.lgd($d.a.asf);Lb=this.sheet.Yd.hSd;this.sheet.Yd.hSd=!1;"true"===Kb&&Lb&&this.$.ea.kSd?(bc.a.Mv($d.a.asf,"false",bc.a.KW),this.$.ea.kSd=!1,this.aTd(3)):"true"===ya&&"true"===lb&&"true"===Kb?this.$.ea.lSd&&this.$.ea.JLb&&(this.sheet.Yd.CK?(ya=
1,bc.a.Mv($d.a.nyd,"false",bc.a.KW),this.$.ea.JLb=!1):ya=0,bc.a.Mv($d.a.jsf,"false",bc.a.KW),this.$.ea.lSd=!1,this.aTd(ya)):this.sheet.Yd.CK&&"true"===lb&&"true"===Kb&&this.$.ea.JLb&&(bc.a.Mv($d.a.nyd,"false",bc.a.KW),this.$.ea.JLb=!1,this.aTd(2))}else this.rJe(),Kb?lb.Jfb(0):ya.classList.remove(G.a.O$c)}};Oa.prototype.rJe=function(){if(De.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var V=this.$.da.Aa(322);V&&V.dismiss()}else this.$.Krd&&(V=ic.GetServiceTaskFactory.Ua(this.$.da,322,
323,0),Lc.TaskExtensions.Ba(V,function(ya){ya.result.dismiss()},this.$.la,3))};Oa.prototype.Vfb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.k7a()?pb.eIj:pb.lIj;De.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.eP.parentNode.classList.add(pb.Gsi):this.eP.parentNode.classList.add(pb.Hsi);this.Heg();this.Kod&&this.ine();this.UAj();this.Neg();this.WBc();this.Kod||this.ine()};Oa.prototype.USi=function(){this.oRd=!0;this.Vna(!0,!0,
"OnSheetReorderStarted")};Oa.prototype.TSi=function(){this.oRd=!1;this.Vna(!1,void 0,"OnSheetReorderEnded")};Oa.prototype.activate=function(V,ya){V=void 0===V?0:V;ya=void 0===ya?!1:ya;this.A2b()||(this.sheet.activate(),ya&&Kf.g(this.$).focus(),ya={},V=(ya.InputMethod=ma.a[V],ya.AppMode=this.$.fd,ya.Location="canvas",ya),zg.b(this.$).Vd(xh.a.dwj,V))};Oa.prototype.Geg=function(V){this.T5b=V?"#797775":"#BEBBB8";this.m5c=V?-.5:.5;this.cIc=V?Nc.a.iq("#3B3A39"):Nc.a.iq("#F5F5F5");this.Neg()};Oa.prototype.opj=
function(V){this.y7a=V};Oa.prototype.QAd=function(V){V.L2c();this.wye(V)};Oa.prototype.wye=function(V){V.M0a();this.sheet.activate()};Oa.prototype.oAg=function(V){V=new td.a(-1876836819,V,this.$.fd,30,null);var ya={};return this.$.Ka.$b(V,(ya[$d.a.qRd]=this.sheet.name,ya))};Oa.prototype.Heg=function(){this.eP.parentNode.setAttribute("sheet-title",this.eP.innerText)};Oa.prototype.WBc=function(){var V=this.fKh();this.anchor.setAttribute($d.a.Pt,V);this.anchor.setAttribute($d.a.Eha,this.sheet.active.toString())};
Oa.prototype.fKh=function(){var V=this.sheet.Yd.ty,ya=this.sheet.Yd.rnb,lb=this.sheet.tj,Kb=this.sheet.isLockPausedInSession;return V&&lb?String.format(bf.a.instance.Ab(20),this.name,ya):V&&Kb?String.format(bf.a.instance.Ab(22),this.name,ya):V?String.format(bf.a.instance.Ab(19),this.name,ya):lb?String.format(bf.a.instance.Ab(18),this.name):Kb?String.format(bf.a.instance.Ab(21),this.name):this.name};Oa.prototype.activateSheet=function(V){V=void 0===V?0:V;if(Zg.a.$rd()){if(De.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.A2b())return Fe.Task.Ra(!1);id.a.current.PS="ActivateSheet";this.sheet.activate();return Fe.Task.Ra(!0)}return this.oAg(V)};Oa.prototype.Neg=function(){var V=this.sheet.tabColor;this.color=V?Nc.a.iq(V):this.odh;this.Bff=Oa.vSd(this.color);this.Vna(!1,void 0,"UpdateTabColor")};Oa.prototype.Vna=function(V,ya,lb){ya=void 0===ya?!1:ya;lb=void 0===lb?null:lb;if(this.sheet){lb=this.sheet.active;var Kb=this.k7a(),Lb=!!this.sheet.tabColor,Xa=Nc.a.sG(lb||Kb?hh.a.white:this.color);this.ME.style.background=
"";lb||Kb?(Lb?De.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.ILa?this.fuj():this.rm?this.euj():this.duj():this.rm||(this.ME.style.backgroundColor=Xa),this.ME.style.height=this.X1c.toString()+"px"):(this.ME.style.filter="",this.ME.style.backgroundColor=Xa,this.ME.style.height=this.Y1c.toString()+"px");this.eP.className=lb?pb.fIj:Kb?pb.dark:this.Bff?pb.light:pb.dark;Xa=Cl(this.$na);for(var od=Xa.next();!od.done;od=Xa.next())od.value.Pdg();this.rm&&
(V&&!Lb&&(this.ME.style.backgroundColor="#E1DFDD"),le.DOMElementExtensions.toggleCssClass(this.domElement,pb.kIj,V),ya?(Lb||(this.ME.style.backgroundColor=this.T5b),this.domElement.style.backgroundColor=this.T5b):(Lb||(this.ME.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.eP.style.fontWeight=lb||Kb||!this.rm&&V?this.rm?"600":"bold":""}else Rb.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",
lb)};Oa.prototype.euj=function(){var V=this.ME.style,ya=Nc.a.sG(Oa.n0c(this.color,this.m5c));V.background=ya};Oa.prototype.duj=function(){var V=this.ME.style,ya=Nc.a.sG(Oa.n0c(this.color,1)),lb=Nc.a.sG(Oa.n0c(this.color,this.m5c)),Kb="";if(Da.a.Ixa)Kb="-webkit-";else if(Da.a.Hf)Kb="-moz-";else if(Da.a.xf){if(Kb="-ms-",!Da.a.Z6a){V.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",ya,lb);return}}else Da.a.qgf&&(Kb="-o-");V.background=String.format("{0}linear-gradient({1}, {2})",
Kb,ya,lb)};Oa.prototype.fuj=function(){this.ME.style.background="transparent"};Oa.prototype.Q4g=function(){this.BFc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=pb.gIj;le.DOMElementExtensions.Bu(this.anchor,$d.a.Nob,null,null);this.tabIndex=-1};Oa.prototype.T$g=function(){this.ME=document.createElement("span");this.ME.className=pb.iIj;this.eP=document.createElement("span");this.eP.className=pb.nIj;this.eP.dir=this.sheet.rtlName?"rtl":"ltr";this.ME.appendChild(this.eP)};
Oa.prototype.UAj=function(){for(var V=this.$.BJ,ya=Cl(this.$na),lb=ya.next();!lb.done;lb=ya.next())lb.value.TAj(V,this.ME,this.eP)};Oa.prototype.k7a=function(){return Kf.g(this.$).k7a(this.sheet)};Oa.prototype.sFj=function(){this.sld.start();this.Lpd=!0};Oa.prototype.hMe=function(V){if(this.Lpd){this.sld.stop();var ya={};V=(ya["Sheet index"]=this.sheet.index,ya["Active Sheet"]=this.sheet.active,ya["Hovering time"]=this.sld.zc,ya["Has been clicked"]=V,ya);Rb.ULS.sendTraceTag(537153686,0,50,Ge.c(V));
this.Lpd=!1}};Oa.prototype.e$i=function(){eg.a.instance.pa(lf.a.pointerDown,this.domElement,this.onPointerDown);vh.KeyInputManager.instance.pa(lf.a.Xb,this.domElement,this.onKeyDown);vh.KeyInputManager.instance.pa(lf.a.Ap,this.domElement,this.Sz);this.Fc.ka("mouseover",this.bO);this.Fc.ka("mouseout",this.aO);eg.a.instance.pa(lf.a.dX,this.domElement,this.Xya);eg.a.instance.pa(lf.a.Iy,this.domElement,this.Yya);if(this.y7a||De.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))eg.a.instance.pa(lf.a.$d,
this.domElement,this.Pf),this.vxa&&(Je.a.instance.pa(lf.a.Ce,this.domElement,this.Pf),Je.a.instance.pa(lf.a.wg,this.domElement,this.eO));Jb.a.instance.pa(lf.a.click,this.domElement,this.vd);this.EV=!0};Oa.prototype.A2b=function(){var V=this.$.da.Aa(65);return V&&V.Nba()?(V.HJb(),this.wye(V),!0):!1};Oa.lgd=function(V){var ya=bc.a.get(V);ya||(bc.a.Mv(V,"true",bc.a.KW),ya=bc.a.get(V));return ya};Oa.n0c=function(V,ya){if(1<ya||-1>ya)return V;var lb=V.r,Kb=V.g;V=V.b;0<ya?(lb=lb*(1-ya)+255*ya,Kb=Kb*(1-
ya)+255*ya,V=V*(1-ya)+255*ya):(lb*=1+ya,Kb*=1+ya,V*=1+ya);return hh.a.$ub(Math.round(lb),Math.round(Kb),Math.round(V))};Oa.vSd=function(V){return 128>=(222*V.r+707*V.g+71*V.b)/1E3};Ck.Object.defineProperties(Oa.prototype,{odh:{configurable:!0,enumerable:!0,get:function(){return this.cIc||(this.cIc=Nc.a.iq("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.eP.innerText},set:function(V){this.eP&&(this.eP.innerText=V,this.WBc(),this.Heg())}},sheet:{configurable:!0,enumerable:!0,
get:function(){return this.OWb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.BFc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(V){this.anchor.tabIndex=V}}});Object(ie.a)(Oa,"SheetTabButton",nc,[]);Am(wb,nc);Object(ie.a)(wb,"WorkbookProtectionButton",nc,[]);var tf=b(49),rg=b(46),ch=b(53),Hg=ph.a;Am(ob,Hg);ob.prototype.Bb=function(V,ya,lb,Kb,Lb,Xa,od){od=void 0===od?!1:od;V.removeAttribute("Href");V.setAttribute($d.a.Rd,$d.a.Us);
V.className=pb.xth;V.title=ya;V.tabIndex=0;this.Pw&&Xa?lb=this.svgIconProvider.Iba(Xa,12,12,V,24,24):(ya=document.createElement("span"),ya.className=this.rm?G.a.CZg:G.a.Wr,ya.classList.add(k.a.Fia),ya.tabIndex=-1,V.appendChild(ya),Xa=document.createElement("img"),Xa.src=Td.a.Se(lb),Xa.className=Kb,Xa.alt=Lb,Xa.tabIndex=-1,ya.appendChild(Xa),lb=Xa);od&&V.classList.add(k.a.FZ);return lb};ob.prototype.dispose=function(){if(this.$){var V=this.$.xa;V.Vg(this.ii);V.WJd(this.Mya);V.z7(this.lD);V.jna(this.oFb);
V.SQa(this.hza);V.jRf(this.NDf);V.uIb(this.PDf);V.vcj(this.ODf);V.gKd(this.yuf);V.gRf(this.zuf);V.hRf(this.Auf);V.iRf(this.lPa);this.$.Ul(this.zd);this.$.AD(this.fj);ig.a(this.$)&&ig.a(this.$).tg.kna(this.OF);this.iua&&Kf.g(this.$).MQf(this.pEb);zh.a.instance.za(lf.a.eD,this.domElement,this.Q6)}He.a.yc(this.xyd);this.xyd=null;if(this.WK)for(V=0;V<this.WK.length;V++){var ya=le.DOMElementExtensions.iK(this.WK[V],this.domElement,!1,"a");ya&&og.a.fna(ya)}He.a.Ha(this.rC);He.a.Ha(this.uxc);He.a.Ha(this.uRd);
this.uRd=this.uxc=this.Hyb=this.VH=this.rC=null;this.$&&this.Iz&&this.UQ(!1);this.Aaa=null;this.tPd(null,"Dispose");this.$Mb=this.QM=this.M7b=null;this.l1c();this.Gdb=this.vxc=this.vRd=this.Wk=this.WK=this.$=this.ea=null;Hg.prototype.dispose.call(this)};ob.prototype.Wf=function(V,ya){if(!ya){Rb.ULS.shipAssertTag(537153760,0,0<this.Ch.length,"There is no sheet tab button.");if(!this.Ch.length)return!1;V=null;for(var lb=Cl(this.Ch),Kb=lb.next();!Kb.done&&!(V=Kb.value.CQh());Kb=lb.next());if(!V)return Rb.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;le.DOMElementExtensions.setFocus(V)}return!ya};ob.prototype.sh=function(V){return le.DOMElementExtensions.Gf(this.uc,V)};ob.prototype.Ej=function(){};ob.prototype.Rj=function(){};ob.prototype.reorderSheets=function(V,ya,lb){if(this.g0&&this.g0!==V){var Kb=this.g0.index;this.Dej(this.g0,V,ya);V=V?V.index-1:ya?this.$.xa.count-1:0;Kb!==V&&(this.Owi(Kb,V,lb),this.Clh(this.g0.name,V))}};ob.prototype.o1h=function(V){V=this.rja(V);return-1!==V&&this.jv<=V&&V<=
this.EK?this.Ch[V].domElement:null};ob.prototype.WTj=function(V){if(this.Pw){for(var ya=0;ya<this.WK.length;ya++){var lb=this.WK[ya];if(lb&&this.svgIconProvider){var Kb=lb.parentNode;this.qQf(lb);Kb&&(this.WK[ya]=this.svgIconProvider.Iba(V?this.cJf[ya]:this.yyd[ya],12,12,Kb,24,24))}}for(ya=0;ya<this.Ch.length;ya++)this.Ch[ya].Geg(V);this.sSa&&this.sSa.Rsa&&this.Feg(qe.a.f3h,this.sSa,V);this.VH&&this.VH.Rsa&&this.Feg(qe.a.M0g,this.VH,V)}};ob.prototype.Feg=function(V,ya,lb){ya.Bab||(ya.Bab=this.svgIconProvider.Iba(V,
12,12,ya.Rsa.parentNode,24,24));ya.Bab&&(le.DOMElementExtensions.setVisible(ya.Rsa,!lb),le.DOMElementExtensions.setVisible(ya.Bab,lb))};ob.prototype.YSi=function(V,ya){var lb=Kf.g(this.$),Kb=lb.inRangePicker,Lb=wg.HelperMethods.Km(ya);if(lb.isEditing&&!Kb){var Xa=lb.Fj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",od=void 0;De.EwaSettings.m7a&&(od=[Object(Ha.a)(lb.Ac.textBox.GBa)]);Ha.b(this.$).STa(Lb.rawEvent,Xa,od);lb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}lb=this.vxa&&
3===ya.yb;!(2===ya.yb&&Lb.button===Sys.UI.MouseButton.leftButton||lb)||Kb||this.yF||ig.a(this.$).Oq()||(lb&&V.USi(),this.nBb=ya.clientPoint.x,this.HZ=ya,this.COg(V))};ob.prototype.WSi=function(V){!this.Iz&&this.yF&&this.mTd(V.sheet,!1)};ob.prototype.XSi=function(V){this.Iz||(this.yF&&this.reorderSheets(V.sheet,!1,!0),this.UQ());this.M0()};ob.prototype.sqe=function(){return this.$.isEditMode&&!d.k(this.$.kg)};ob.prototype.M0=function(){var V=this,ya=wg.HelperMethods.Cca(function(){V.$Rj();V.rm&&V.Gtj();
V.YPd()});Rb.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",ya)};ob.prototype.Gtj=function(){var V=this.EK===this.Ch.length-1;le.DOMElementExtensions.toggleCssClass(this.Gdb,this.$.BJ?pb.APe:pb.oPe,!!this.jv);le.DOMElementExtensions.toggleCssClass(this.Gdb,this.$.BJ?pb.oPe:pb.APe,!V)};ob.prototype.YPd=function(V){V=void 0===V?!1:V;var ya=!this.jv,lb=this.EK===this.Ch.length-1;this.W_f(4,this.sheetTabActivatePreviousHidden,!ya);this.W_f(5,this.sheetTabActivateNextHidden,
!lb);this.Qwc(0,ya||V);this.Qwc(1,ya||V);this.Qwc(2,lb||V);this.Qwc(3,lb||V)};ob.prototype.W_f=function(V,ya,lb){if(V=this.WK[V]){le.DOMElementExtensions.setVisible(V,lb);var Kb=this.o1e(V);Kb.title="img"===V.nodeName?V.alt=0<this.Ch.length&&lb?ya:"":V.title=0<this.Ch.length&&lb?ya:"";Kb.tabIndex=lb?0:-1}};ob.prototype.o1e=function(V){return this.Pw?V.parentNode:V.parentNode.parentNode};ob.prototype.Qwc=function(V,ya){if(V=this.WK[V])V=this.o1e(V),void 0!==V&&null!==V&&(!this.Ch.length||ya?(V.classList.add(k.a.FZ),
V.setAttribute($d.a.Dha,"true")):(V.classList.remove(k.a.FZ),V.setAttribute($d.a.Dha,"false")))};ob.prototype.jSa=function(V){var ya=this.$.BJ?this.Ch.length-1:0,lb=this.E3e(this.$.BJ?0:this.Ch.length-1);lb&&(lb.borderRightWidth=V?"1px":"0");this.jv!==this.EK&&(lb=this.E3e(ya))&&(lb.borderRightWidth="0")};ob.prototype.vne=function(V,ya){this.Ch||(this.Ch=[]);-1===ya?Array.add(this.Ch,V):Array.insert(this.Ch,ya,V)};ob.prototype.j5b=function(V,ya){var lb=-1,Kb=null;ya||(lb=this.FUh(V.index),-1!==lb&&
(Kb=this.$Ka(lb)));V=new Oa(this.$,this.Wk,Kb,V,this,this.rm,this.Pw);this.vne(V,lb);le.DOMElementExtensions.setVisible(V.domElement,!0)};ob.prototype.mTd=function(V,ya){var lb=this.j3a(V);if(lb){this.nmd=V;this.Oxd=ya;V=lb.domElement;lb=this.isRtl?V.offsetLeft+(this.Wk.scrollWidth-this.Wk.clientWidth-this.Wk.scrollLeft):V.offsetLeft-this.Wk.scrollLeft;if(!this.isRtl&&ya||this.isRtl&&!ya)lb+=V.offsetWidth;this.txc.style.left=wg.HelperMethods.nc(lb-4);le.DOMElementExtensions.setVisible(this.txc,!0)}};
ob.prototype.o9e=function(){le.DOMElementExtensions.setVisible(this.txc,!1)};ob.prototype.$0=function(V){var ya=this,lb=wg.HelperMethods.Cca(function(){switch(V){case 0:ya.qvc(0);break;case 1:ya.qvc(ya.jv-1);break;case 2:ya.qvc(ya.jv+1);break;case 3:ya.scrollIntoView(ya.Ch.length-1);break;case 4:ya.jv&&1<=ya.Ch.length&&(ya.kle(ya.jv-1),ya.ONd());break;case 5:ya.EK!==ya.Ch.length-1&&1<=ya.Ch.length&&(ya.kle(ya.EK+1),ya.ONd());break;case 6:ya.ONd()}});this.X7b&&this.yF&&this.uOb();Rb.ULS.sendTraceTag(537153755,
0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",V,lb)};ob.prototype.kle=function(V){(V=this.oR(V))&&V.activate()};ob.prototype.WCh=function(V){if(0===V.Ty)for(var ya=this.$.xa,lb=0,Kb=0,Lb=ya.count;Kb<Lb;Kb++){var Xa=Object(Xf.a)(D.a,ya.getItem(Kb));if(Xa===V)return lb;0===Xa.Ty&&lb++}return-1};ob.prototype.JCh=function(V){var ya=this.$.xa;V=V.index+1;for(var lb=ya.count;V<lb;V++){var Kb=Object(Xf.a)(D.a,ya.getItem(V));if(0===Kb.Ty)return Kb}return null};ob.prototype.rja=
function(V){for(var ya=0;ya<this.Ch.length;ya++){var lb=this.oR(ya);if(!lb)Rb.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",ya);else if(lb.sheet===V)return ya}return-1};ob.prototype.j3a=function(V){V=this.rja(V);return this.oR(V)};ob.prototype.Owi=function(V,ya,lb){var Kb={};Kb.a=this.$.ya.UserSessionId;Kb.b=lb;Kb.c=this.D7b;Kb.d=V;Kb.e=ya;Kb.f=this.$.xa.count;tf.b().Pe(2,Kb,lb)};ob.prototype.Dej=
function(V,ya,lb){var Kb=Object(Xf.a)(da.a,this.$.xa);ya?(ya=ya.index,ya=V.index<ya?ya-1:ya):ya=lb?Kb.count-1:0;Kb.reorderSheet(V,ya,!0)};ob.prototype.t_f=function(V){Kf.g(this.$).rg.No(V)};ob.prototype.COg=function(V){if(!this.Ltc){var ya=this.domElement.ownerDocument.body;this.Iz?(eg.a.instance.pa(lf.a.yh,document.documentElement,this.ZK),this.vxa&&(Je.a.instance.pa(lf.a.wg,document.documentElement,this.ZK),Je.a.instance.pa(lf.a.wg,this.domElement,this.eO))):(eg.a.instance.pa(lf.a.yh,ya,this.ZK),
Je.a.instance.pa(lf.a.wg,ya,this.ZK));eg.a.instance.pa(lf.a.$d,document.documentElement,this.o0);Je.a.instance.pa(lf.a.Ce,ya,this.o0);this.Ltc=!0}this.g0=V.sheet;this.D7b=!1;this.Iz?(this.QM=null,this.M7b=V,this.Aaa=V.domElement,this.tPd(le.DOMElementExtensions.getBoundingClientRect(this.Aaa),"BeginSheetTabButtonDrag")):(Rb.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(pb.nPe),this.domElement.style.cursor=
"",this.t_f("pointer"))};ob.prototype.UQ=function(V){V=void 0===V?!0:V;if(this.Ltc){this.t_f($d.a.k5);var ya=this.domElement.ownerDocument.body;this.Iz?(eg.a.instance.za(lf.a.yh,document.documentElement,this.ZK),this.vxa&&(Je.a.instance.za(lf.a.wg,document.documentElement,this.ZK),Je.a.instance.za(lf.a.wg,this.domElement,this.eO))):(eg.a.instance.za(lf.a.yh,ya,this.ZK),Je.a.instance.za(lf.a.wg,ya,this.ZK));eg.a.instance.za(lf.a.$d,document.documentElement,this.o0);Je.a.instance.za(lf.a.Ce,ya,this.o0);
this.eMc=this.Ltc=!1}this.oqc=0;this.D7b=!1;this.nmd=this.g0=null;this.Iz?(this.Aaa&&(this.Aaa.style.visibility="visible",this.Aaa=null),this.M7b=null,this.tPd(null,"EndSheetTabButtonDrag"),this.QM&&(this.QM.parentNode&&this.QM.parentNode.removeChild(this.QM),this.QM=null),this.Rgj(V)):(this.domElement.classList.remove(pb.nPe),this.o9e())};ob.prototype.Rgj=function(V){this.WUd(V);this.XC=this.nBb=-1};ob.prototype.Clh=function(V,ya){function lb(od,Yd,ke){var Yf=Xa.Na(9,null);Yf.sheetName=V;Yf.newSheetIndex=
ya;return Xh.i(Xa,"ReorderSheets",Yf,od,Yd,ke,null,0)}function Kb(){return new ib(V,ya)}var Lb=this.$.na,Xa=Lb?Lb.va:null;De.EwaSettings.qc()?this.$.userOperationManager.ic(new Bb.a(557,0,lb,64,Kb),null):this.$.userOperationManager.ic(new S.a(557,0,lb,void 0,Kb),null)};ob.prototype.oR=function(V){return 0<=V&&V<this.Ch.length?this.Ch[V]:null};ob.prototype.D3e=function(V){return(V=this.oR(V))?V.sheet:null};ob.prototype.$Ka=function(V){return(V=this.oR(V))?V.domElement:null};ob.prototype.E3e=function(V){return(V=
this.$Ka(V))?V.style:null};ob.prototype.FUh=function(V){var ya=this.$.xa;V+=1;for(var lb=-1,Kb=this.Ch?this.Ch.length:0;V<ya.count;){var Lb=Object(Xf.a)(D.a,ya.getItem(V));if(0===Lb.Ty){for(lb=0;lb<Kb&&this.D3e(lb)!==Lb;lb++);break}V++}return-1===lb||lb===Kb?-1:lb};ob.prototype.JDf=function(V){var ya=this.j3a(V);ya&&(this.Iz&&this.yF&&(Rb.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),De.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.UQ()),this.Wk.removeChild(ya.domElement),ya=Array.indexOf(this.Ch,ya),Array.removeAt(this.Ch,ya),this.M0(),(!this.isRtl&&ya===this.Ch.length||this.isRtl&&!ya)&&this.jSa(!0),this.X7b&&this.yF?V===this.g0?(this.UQ(),this.$0(6)):this.uOb():this.$0(6))};ob.prototype.LDf=function(V){var ya=Object(Xf.a)(D.a,V);this.Iz&&this.yF&&(Rb.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),De.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.UQ());if(0===ya.Ty){this.jSa(!1);var lb=this.rja(V);-1===lb&&(Rb.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.j5b(ya,!1),lb=this.rja(V));this.q7e(lb,!0)}};ob.prototype.Eej=function(V,ya){var lb=this.j3a(V);lb&&(this.Iz&&this.yF&&!ya&&(Rb.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),De.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.UQ()),V=this.aIj(V,lb),!De.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Iz&&V&&ya&&V.TSi())};ob.prototype.aIj=function(V,ya){var lb=Array.indexOf(this.Ch,ya),Kb=this.WCh(Object(Xf.a)(D.a,V));if(-1===Kb||-1===lb)return null;lb!==Kb||this.Iz?(this.jSa(!1),Kb=ob.Aej(lb,Kb,this.jv,this.EK),this.jv=Kb.vDh,this.EK=Kb.Jri,ya&&ya.domElement.parentNode===this.Wk&&(this.Wk.removeChild(ya.domElement),Array.removeAt(this.Ch,lb)),ya=this.JCh(V),lb=this.rja(ya),
ya=new Oa(this.$,this.Wk,this.$Ka(lb),Object(Xf.a)(D.a,V),this,this.rm,this.Pw),this.vne(ya,lb),lb=this.rja(V),this.q7e(lb,!1,!this.rm)):ya=null;return ya};ob.prototype.omh=function(){for(var V=this.Ch?this.Ch.length:0,ya=this.jv,lb=this.EK,Kb=0;Kb<V;Kb++){var Lb=this.oR(Kb),Xa=Kb>=ya;Lb&&(Lb.tabIndex=Xa&&Kb<=lb?0:-1)}};ob.prototype.OQj=function(){for(var V=this.Ch?this.Ch.length:0,ya=0;ya<V;ya++){var lb=this.oR(ya);lb&&lb.Vfb()}};ob.prototype.q7e=function(V,ya,lb){lb=void 0===lb?!0:lb;ya&&V<=this.jv&&
this.jv++;this.omh();this.jSa(!0);this.M0();this.X7b&&this.yF?this.uOb():lb&&this.$0(6)};ob.prototype.zwc=function(V){var ya=this.$.BJ;if(V||this.isRtl!==ya)this.isRtl=ya,this.domElement.classList.remove(this.isRtl?G.a.vPe:G.a.BPe),this.domElement.classList.add(this.isRtl?G.a.BPe:G.a.vPe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.OQj();V||this.jSa(!0);for(V=0;V<this.WK.length;V++)0!==V&&3!==V&&(!this.rm||4!==V&&5!==V)&&this.X_f(V)};ob.prototype.C8g=function(){var V=this.vRd=document.createElement("div");
V.className=pb.uth;this.rm&&V.classList.add(pb.vth);this.domElement.appendChild(V);this.c5b(V,1,714,713);this.c5b(V,2,716,715);this.Xhf&&(this.sSa=new lc(this.$,this,V));this.rm||this.c5b(V,4,720,719)};ob.prototype.D8g=function(){var V=this.vxc=document.createElement("div");V.className=pb.wth;this.domElement.appendChild(V);this.rm||this.c5b(V,5,722,721);this.G4c()};ob.prototype.G9g=function(){var V=document.getElementById($d.a.ewj),ya=document.getElementById($d.a.fwj);V&&!ya&&Rb.ULS.sendTraceTag(537153746,
0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",V.parentNode.id,!!V.firstChild,!!document.getElementById($d.a.lRd));if(Zg.a.cif(this.$)&&V&&ya)this.domElement.appendChild(V),this.wRd=V.firstChild,this.xRd=document.getElementById($d.a.lRd),ya.style.visibility="visible";else{V=document.createElement("div");ya=document.createElement("div");V.className=G.a.Fth;ya.className=
G.a.Dth;ya.style.display="none";var lb=document.createElement("div");lb.className=G.a.Gth;var Kb=document.createElement("div");Kb.className=G.a.Eth;var Lb=document.createElement("div");Lb.className=G.a.Cth;ya.appendChild(lb);ya.appendChild(Kb);ya.appendChild(Lb);V.appendChild(ya);this.domElement.appendChild(V);this.wRd=ya;this.xRd=Kb}};ob.prototype.X_f=function(V){var ya=this.WK[V];if(ya)if(this.Pw){var lb=ya.parentNode;this.qQf(ya);ya=jb.a(this.$)?this.cJf[V]:this.yyd[V];this.WK[V]=this.svgIconProvider.Iba(ya,
12,12,lb,24,24)}else ya.className=this.wyd[V]};ob.prototype.qQf=function(V){(null===V||void 0===V?0:V.parentNode)&&V.parentNode.removeChild(V)};ob.prototype.b6g=function(){var V=this.Gdb=document.createElement("div");V.className=pb.rth;this.domElement.appendChild(V);this.K$g(V)};ob.prototype.K$g=function(V){var ya=document.createElement("div");ya.className=pb.Ith;ya.classList.add(pb.sth);this.$.printingEnabled||ya.classList.add(Lg.a.JRe);V.appendChild(ya);this.Wk=document.createElement("ul");le.DOMElementExtensions.Bu(this.Wk,
$d.a.LXc,null,null);this.Wk.className=Lg.a.CPe;ya.appendChild(this.Wk);this.v8g();this.Hhe=document.createElement("div");this.qxc.id="SheetIconTooltipContainer";ya.appendChild(this.qxc)};ob.prototype.v8g=function(){var V=document.createElement("div"),ya="<div class='"+G.a.FZg+"'>{0}</div>",lb=Td.a.jed(G.a.Quh,0,"55_16_N","");V.innerHTML=String.format(ya,lb);V.className=pb.Hth;le.DOMElementExtensions.setVisible(V,!1);this.txc=V;this.Wk.appendChild(V)};ob.prototype.Y4c=function(){for(var V=this.$.xa,
ya=0,lb=V.count;ya<lb;ya++){var Kb=Object(Xf.a)(D.a,V.getItem(ya));0===Kb.Ty&&(this.j5b(Kb,!0),Kb.active&&Kb.activate())}};ob.prototype.l1c=function(){He.a.yc(this.Ch);this.Ch=[];this.EK=this.jv=0};ob.prototype.c5b=function(V,ya,lb,Kb){function Lb(ke){"mouseup"===ke.type&&Xa.Iz&&Xa.yF||pd.g(ke);od.classList.contains(k.a.FZ)||(Yd?Xa.JPi(ke,ya):Xa.rm||Xa.WAf(ke,ya))}var Xa=this,od=document.createElement("a");V.appendChild(od);V=this.yyd[ya];this.WK[ya]=this.Bb(od,bf.a.instance.fa(Kb),0,this.wyd[ya],
bf.a.instance.fa(lb),V);if(5===ya||4===ya)le.DOMElementExtensions.iK(this.WK[ya],od,!1,"span").style.marginTop="10px";this.X_f(ya);lb=this.xyd[ya]=this.de.Wd(od);eg.a.instance.pa(lf.a.pointerDown,od,function(ke){return ke.ctrlKey&&Xa.KJi(ya)?!0:Xa.UAf(ya)});eg.a.instance.pa(lf.a.$d,od,function(){return Xa.VAf()});Je.a.instance.pa(lf.a.Ce,od,function(){return Xa.VAf()});eg.a.instance.pa(lf.a.pointerOut,od,function(){return Xa.d1c()});vh.KeyInputManager.instance.pa(lf.a.Xb,od,function(ke){return 13!==
ke.Ca.keyCode&&32!==ke.Ca.keyCode||Xa.h3c?!1:(Xa.h3c=!0,Xa.UAf(ya))});vh.KeyInputManager.instance.pa(lf.a.Sd,od,function(ke){return 13===ke.Ca.keyCode||32===ke.Ca.keyCode?(Xa.h3c=!1,Xa.d1c()):!1});var Yd=this.sqe();lb.ka("mouseover",Lb);lb.ka("mouseout",Lb);lb.ka("focus",Lb);lb.ka("blur",Lb);Yd&&lb.ka("mouseup",Lb)};ob.prototype.def=function(V){var ya=!1,lb=this.$.Mf;lb&&(ya=qb.a.yB(le.DOMElementExtensions.getBoundingClientRect(lb),V.clientPoint));return ya};ob.prototype.Zhf=function(V){return qb.a.yB(le.DOMElementExtensions.getBoundingClientRect(this.domElement),
V.clientPoint)||this.def(V)};ob.prototype.SCh=function(V){var ya=null,lb=V.clientPoint,Kb=this.jv;if(this.Zhf(V))for(Kb=this.jv;Kb<=this.EK;Kb++)if(ya=this.oR(Kb))if(V=le.DOMElementExtensions.getBoundingClientRect(ya.domElement),!this.isRtl&&lb.x<V.x+V.width||this.isRtl&&lb.x>V.x)break;return{returnValue:ya,Jzj:Kb>this.EK}};ob.prototype.uOb=function(){if(this.Iz){if(!this.QM){Rb.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.QM=this.Aaa.cloneNode(!0);if(!this.LVf(this.QM,this.Aaa,!0,"UpdateDragAndDropState"))return;this.Aaa.style.visibility="hidden";this.QM.classList.add(pb.Jth);this.QM.style.borderRightWidth="";this.jdc=this.HZ.clientPoint.x-this.u4.width/2;this.QM.style.left=this.jdc+"px";this.XC=this.rja(this.g0);0>this.XC&&Rb.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.X7b&&(this.XC=this.rja(this.g0));var V=le.DOMElementExtensions.getBoundingClientRect(this.Wk),
ya=V.x;V=V.x+V.width;var lb=this.HZ.clientPoint.x-this.u4.width/2;lb=Math.min(lb,V-this.u4.width);lb=Math.max(lb,ya);this.QM.style.transform="translateX("+Math.abs(lb-this.jdc)*(this.jdc<lb?1:-1)+"px)";var Kb=this.HZ.clientPoint.x>this.nBb,Lb=this.HZ.clientPoint.x;lb>=V-this.u4.width?(Lb=V-this.u4.width/2,this.MNd()||this.Xma||(Rb.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.ypc=this.Wk.scrollLeft,
this.Xma=window.requestAnimationFrame(this.qXf))):lb<=ya?(Lb=ya+this.u4.width/2,this.LNd()||this.Xma||(Rb.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.ypc=this.Wk.scrollLeft,this.Xma=window.requestAnimationFrame(this.pXf))):this.Xma&&(Rb.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.WUd());this.HZ.clientPoint.x!==
this.nBb&&(this.HVd(Kb,Lb),this.nBb=this.HZ.clientPoint.x)}else V=this.SCh(this.HZ),ya=V.Jzj,(V=V.returnValue)?this.mTd(V.sheet,ya):this.o9e();this.eMc=!0};ob.prototype.HVd=function(V,ya){for(var lb=this,Kb;function(){var Lb=lb.Fih(ya,V);Kb=Lb.a2b;return Lb}().returnValue;)this.$Mb=Kb,this.ZJg(V)};ob.prototype.ZJg=function(V){if(this.$Mb){var ya=(V?1:-1)*this.u4.width;if(V&&!this.$.BJ||!V&&this.$.BJ){var lb=this.Aaa;var Kb=this.XC+1;var Lb=!0}else lb=(Kb=this.oR(this.XC+1))?Kb.domElement:null,Kb=
this.XC-1,Lb=!1;if(this.LVf(this.$Mb,lb,Lb,"AnimateSheetSwap")){Rb.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.XC,Kb,this.tRd,V);0<=this.XC&&this.XC<this.Ch.length&&0<=Kb&&Kb<this.Ch.length?(V=this.Ch[Kb],this.Ch[Kb]=this.Ch[this.XC],this.Ch[this.XC]=V):(Rb.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",
this.Ch.length,this.XC,Kb),this.UQ());this.XC=Kb;var Xa=this.$Mb;Xa.style.transform="translateX("+ya+"px)";window.requestAnimationFrame(function(){Xa.style.transform="translateX(0px)"})}}};ob.prototype.LVf=function(V,ya,lb,Kb){function Lb(Xa){return Xa?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",Xa.id,Xa.className,Xa.nodeName):null}try{return this.Wk.insertBefore(V,ya),!0}catch(Xa){return V=this.j3a(this.g0),Rb.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
V?V!==this.M7b?"Changed":"NoChange":"Removed",Kb,Lb(ya),Lb(ya.parentNode),Lb(this.Wk),lb,this.XC,this.tRd,Xa),this.UQ(),!1}};ob.prototype.Fih=function(V,ya){var lb=this.$.BJ===ya?this.oR(this.XC-1):this.oR(this.XC+1);if(!lb)return{returnValue:!1,a2b:null};lb=lb.domElement;var Kb=le.DOMElementExtensions.getBoundingClientRect(lb);return this.u4?ya?{returnValue:V+this.u4.width/2>=Kb.x+.5*Kb.width,a2b:lb}:{returnValue:V-this.u4.width/2<=Kb.x+.5*Kb.width,a2b:lb}:(Rb.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.UQ(),{returnValue:!1,a2b:lb})};ob.prototype.nXf=function(V,ya){var lb=ya?this.qXf:this.pXf;if(-1===this.kzc)this.kzc=V,this.Xma=window.requestAnimationFrame(lb);else{V=Math.floor((V-this.kzc)/1E3*300);var Kb=this.mJb>this.UBb?1:-1;this.scrollLeft(Math.abs(this.Wk.scrollLeft-(ya?this.ypc+V*Kb:this.ypc-V*Kb))*(ya?-1:1));if(V=this.K_e("ScrollStep"))this.HVd(ya,V.x+V.width/2),ya&&!this.MNd()||!ya&&!this.LNd()?this.Xma=window.requestAnimationFrame(lb):(Rb.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.WUd())}};ob.prototype.MNd=function(){var V=this.mJb>this.UBb;return V&&this.Ana>=this.mJb||!V&&this.Ana<=this.mJb};ob.prototype.LNd=function(){var V=this.mJb>this.UBb;return V&&this.Ana<=this.UBb||!V&&this.Ana>=this.UBb};ob.prototype.WUd=function(V){V=void 0===V?!0:V;this.Wk&&(this.Ana=this.Wk.scrollLeft);window.cancelAnimationFrame(this.Xma);this.Xma=0;this.kzc=-1;V&&this.M0()};ob.prototype.tPd=function(V,ya){V||Rb.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
ya);this.u4=V};ob.prototype.KJi=function(V){return 2===V?(this.$0(3),!0):1===V?(this.$0(0),!0):!1};ob.prototype.UAf=function(V){var ya=this;Rb.ULS.shipAssertTag(537153732,0,-1===this.UPa&&-1===this.TPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.UPa&&(window.clearTimeout(this.UPa),this.UPa=-1);-1!==this.TPa&&(window.clearInterval(this.TPa),this.TPa=-1);this.$0(V);this.UPa=window.setTimeout(function(){ya.IFj(V)},
this.mDi);return!0};ob.prototype.IFj=function(V){var ya=this;this.TPa=window.setInterval(function(){ya.$0(V)},this.lDi)};ob.prototype.VAf=function(){this.d1c();return!this.Iz||!this.yF};ob.prototype.d1c=function(){window.clearTimeout(this.UPa);window.clearInterval(this.TPa);this.TPa=this.UPa=-1;return!0};ob.prototype.WAf=function(V,ya){var lb=this.wyd[ya];wg.HelperMethods.VWd(this.WK[ya],lb,lb+$d.a.Pec,"mouseover"===V.type||"focus"===V.type)};ob.prototype.JPi=function(V,ya){var lb=this.ghc(ya),Kb=
5===ya;if("mouseup"===V.type){if(Kb||4===ya)lb||this.reorderSheets(null,Kb,!1),this.UQ()}else!this.Iz&&this.yF?(lb||this.mTd(this.D3e(Kb?this.EK:this.jv),Kb),this.$0(Kb?2:1)):this.rm||this.WAf(V,ya)};ob.prototype.ghc=function(V){return!!le.DOMElementExtensions.ifd(this.WK[V],"a").title};ob.prototype.JCc=function(V){this.WZd(V);this.M0()};ob.prototype.WZd=function(V){(V=this.j3a(V))&&V.Vfb()};ob.prototype.ONd=function(){var V=this.$.xa;if(V.qa&&(!ch.e(this.$)||V.count))if(V=this.rja(V.qa),-1===V)Rb.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ya=this.$Ka(V);V<this.jv?this.qvc(V):V>this.jv&&!this.asd(ya)&&this.scrollIntoView(V)}};ob.prototype.$Rj=function(){this.jv=0;this.EK=this.Ch.length-1;for(var V=!1,ya=0;ya<this.Ch.length;ya++){var lb=this.oR(ya);if(!lb)break;var Kb=this.asd(lb.domElement);lb.tabIndex=Kb?0:-1;if(!V&&Kb)this.jv=ya,V=!0;else if(V&&!Kb){this.EK=ya-1;break}}};ob.prototype.qvc=function(V){this.$.xa.count&&(this.Ch.length||
this.Y4c(),this.cZf(this.$Ka(Math.max(0,Math.min(V,this.Ch.length-1)))),this.M0())};ob.prototype.scrollIntoView=function(V){Rb.ULS.shipAssertTag(537153697,0,V>=this.jv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.Ch.length||this.Y4c();var ya=this.$Ka(Math.max(0,Math.min(V,this.Ch.length-1))),lb=this.$Ka(this.jv);if(!this.asd(ya)){ya=le.DOMElementExtensions.getBoundingClientRect(ya);var Kb=le.DOMElementExtensions.getBoundingClientRect(this.Gdb);
ya=this.isRtl?Kb.x-ya.x:ya.x+ya.width-(Kb.x+Kb.width);for(Kb=0;lb&&Kb<ya;){var Lb=le.DOMElementExtensions.getBoundingClientRect(lb);Kb+=Lb.width;lb=lb.nextSibling}lb?this.cZf(lb):Rb.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.jv,this.EK,V)}this.M0()}};ob.prototype.cZf=function(V){var ya=le.DOMElementExtensions.getBoundingClientRect(this.Wk);V=le.DOMElementExtensions.getBoundingClientRect(V);
this.isRtl?this.scrollLeft(Math.floor(ya.x+ya.width-(V.x+V.width+.5))):this.scrollLeft(Math.ceil(ya.x-V.x-.5))};ob.prototype.scrollLeft=function(V){(0>V&&this.MNd()||0<V&&this.LNd())&&Rb.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var ya=this.Wk.scrollLeft;if(this.isRtl){if(Da.a.CF||Da.a.Hf){this.Wk.scrollLeft=this.Ana=ya-V;return}if(Da.a.vB||Da.a.$H){this.Wk.scrollLeft=this.Ana=ya+V;return}Rb.ULS.sendTraceTag(537153694,
0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Wk.scrollLeft=this.Ana=ya-V};ob.prototype.asd=function(V){V=le.DOMElementExtensions.getBoundingClientRect(V);var ya=le.DOMElementExtensions.getBoundingClientRect(this.Gdb);return V&&ya?V.x>=ya.x-1&&V.x+V.width<=ya.x+ya.width+1:(Rb.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};ob.prototype.X8g=function(){var V=this.vxc;if(Pa.K2f(this.$))this.rm?(He.a.Ha(this.VH),
this.VH=new Pa(V,this.$,this,!0)):(He.a.Ha(this.VH),this.VH=null);else if(!this.VH||this.rm)He.a.Ha(this.VH),d.k(this.$.kg)?this.VH=new wb(V,this.$,this):this.VH=new Pa(V,this.$,this)};ob.prototype.oFe=function(V,ya){var lb=this.$.xa;if(!this.$.isEditMode||!lb.count)He.a.Ha(ya),ya=null;else if(!ya)if(lb=this.rm?this.vRd:this.vxc,d.k(this.$.kg))ya=new wb(lb,this.$,this);else switch(V){case 0:ya=new Pa(lb,this.$,this);break;case 1:ya=new cc(lb,this.$,this);break;default:Rb.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ya};ob.prototype.G4c=function(){De.EwaSettings.ma(429)?(this.VH=this.oFe(0,this.VH),this.Hyb=this.oFe(1,this.Hyb)):this.X8g()};ob.prototype.K_e=function(V){var ya=le.DOMElementExtensions.getBoundingClientRect(this.QM);ya||(Rb.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",
V),this.UQ());return ya};ob.prototype.h7e=function(V,ya){this.iua.bLg(V,ya);this.UQ(!1);this.YPd(this.navigationButtonsDisabled);V=Cl(this.mIj);for(ya=V.next();!ya.done;ya=V.next())(ya=ya.value)&&ya.YX(this.navigationButtonsDisabled);V=Cl(this.jue);for(ya=V.next();!ya.done;ya=V.next())(ya=ya.value)&&ya.YX(this.operationButtonsDisabled)};ob.Aej=function(V,ya,lb,Kb){V<lb?(ya>lb&&lb--,ya>Kb&&Kb--):V>Kb?(ya<lb&&lb++,ya<Kb&&Kb++):ya<lb&&lb++;return{vDh:lb,Jri:Kb}};Ck.Object.defineProperties(ob.prototype,
{uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},ve:{configurable:!0,enumerable:!0,get:function(){return sf.a.sRd}},yF:{configurable:!0,enumerable:!0,get:function(){return this.eMc}},tRd:{configurable:!0,enumerable:!0,get:function(){return this.Ch.length}},qxc:{configurable:!0,enumerable:!0,get:function(){return this.Hhe}},vxa:{configurable:!0,enumerable:!0,get:function(){return this.$$d}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.iua&&this.iua.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.iua&&this.iua.operationButtonsDisabled}},wyd:{configurable:!0,enumerable:!0,get:function(){return this.rm?this.$.BJ?[G.a.Z8b,G.a.xPe,G.a.zPe,G.a.Y8b,G.a.Mua,G.a.Mua]:[G.a.Y8b,G.a.zPe,G.a.xPe,G.a.Z8b,G.a.Mua,G.a.Mua]:this.$.BJ?[G.a.Z8b,G.a.wPe,G.a.yPe,G.a.Y8b,G.a.Mua,G.a.Mua]:[G.a.Y8b,G.a.yPe,
G.a.wPe,G.a.Z8b,G.a.Mua,G.a.Mua]}},yyd:{configurable:!0,enumerable:!0,get:function(){return this.$.BJ?[null,qe.a.OBe,qe.a.MBe]:[null,qe.a.MBe,qe.a.OBe]}},cJf:{configurable:!0,enumerable:!0,get:function(){return this.$.BJ?[null,qe.a.PBe,qe.a.NBe]:[null,qe.a.NBe,qe.a.PBe]}},UBb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(Da.a.CF)return 0;if(Da.a.Hf)return-1*(this.Wk.scrollWidth-this.Wk.clientWidth);if(Da.a.vv)return this.Wk.scrollWidth-this.Wk.clientWidth;Rb.ULS.sendTraceTag(537153762,
0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},mJb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(Da.a.CF)return this.Wk.scrollWidth-this.Wk.clientWidth;if(Da.a.Hf||Da.a.vv)return 0;Rb.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Wk.scrollWidth-this.Wk.clientWidth}},jue:{configurable:!0,enumerable:!0,get:function(){return this.iua?[this.VH,this.Hyb]:[this.VH,this.Hyb,this.sSa]}},mIj:{configurable:!0,
enumerable:!0,get:function(){return this.Ch.concat(this.sSa)}},gwj:{configurable:!0,enumerable:!0,get:function(){return this.Ghe}}});Object(ie.a)(ob,"SheetTabBarControl",ph.a,[617,2,438]);var ri=df.a;Am(gb,ri);gb.prototype.create=function(){var V=this,ya=this.$.Lb,lb=De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.makingFosSheetTabOptional",!1);if(Ma.a(this.$.ya,1))lb&&rg.PageLoadTrackingInfo.instance.Nda($d.a.boa,["sheetTabBar"]);else{var Kb=document.getElementById(ya+$d.a.d6c);Kb?(De.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&rg.PageLoadTrackingInfo.instance.RAa($d.a.boa),Zg.a.nrd()?Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.Ua(this.$.da,388,387,this.ub),function(Lb){V.Eb(V.$.da.Aa(32)||new ob(V.$,Kb,Lb.result))},this.$.la,3):this.Eb(this.$.da.Aa(32)||new ob(this.$,Kb))):lb&&rg.PageLoadTrackingInfo.instance.Nda($d.a.boa,["sheetTabBar"])}};gb.ka=function(V){V.da.Ga(33,new gb(V))};Object(ie.a)(gb,"SheetTabBarFactory",df.a,[]);var wh=b(52),th=b(199);Na.prototype.sPa=function(){th.a.instance.BKd(Object(Re.a)(this,
this.sPa,"onSessionExpiredDetected"));Rb.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.v5h()};Na.prototype.wDf=function(){th.a.instance.AKd(Object(Re.a)(this,this.wDf,"onSessionExpiringDetected"));this.vhe||this.qRc||(Rb.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.vhe=!0,this.kCj())};Na.prototype.v5h=function(){this.qRc||(zc.AFrameworkApplication.fG(wh.a.dwc),this.qRc=!0,this.jCj())};Object(ie.a)(Na,"ASessionExpirationManager",null,
[]);var hg=b(258),li=b(6),Ni=b(81),Si=b(261);Am(ra,Na);ra.prototype.Voe=function(V){this.Qa.addHandler("SessionExpired",V)};ra.prototype.RZb=function(V){this.Qa.addHandler("TokenRefreshed",V)};ra.prototype.pKd=function(V){this.Qa.removeHandler("TokenRefreshed",V)};ra.prototype.aec=function(){return th.a.instance.WR(zc.AFrameworkApplication.tk)};ra.prototype.dispose=function(){He.a.Ha(this.Qa);this.$=null};ra.prototype.kCj=function(){this.$.isEditMode&&this.ydc(!1)};ra.prototype.jCj=function(){this.Nmb=
!0;this.ydc(!0);this.Qa.raiseEvent("SessionExpired")};ra.prototype.ydc=function(V){var ya=this;Rb.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",V,this.$.ea.rba);var lb=this.$.zb.$p;V&&lb&&lb.isVisible&&1299163859===lb.error.MessageId&&this.$.zb.$p.Ut();var Kb=this.gd(V);ig.a(this.$).rt(new hg.a(li.a.Az,5,function(){var Lb=Nh.a(ya.$),Xa=Lb.rd.activityState;Xa[Ni.a.V2]=ya.$.Hpb(ya.$.isEditMode);Xa[Ni.a.sM]=
Ni.a.y9a;Xa[Si.a.hr]=li.a.accessTokenExpiringWarning;Lb.rd.Lt([Kb])}))};ra.prototype.gd=function(V){return V?Ag.a.NFe():this.E$g()};ra.prototype.E$g=function(){var V=Ag.a.gd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");V.Description=this.accessTokenExpiringMessage;return V};Ck.Object.defineProperties(ra.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var V=(new Date(this.tk)).format(this.$.ya.ShortTimeFormat);return String.format(bf.a.instance.Ab(78),V)}},
tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Nmb}},Jdb:{configurable:!0,enumerable:!0,get:function(){return!1}},fca:{configurable:!0,enumerable:!0,get:function(){return!1}},EId:{configurable:!0,enumerable:!0,get:function(){return!1}},g6:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(ie.a)(ra,"EwaAccessTokenExpirationManager",Na,[618,265,2]);var sj=b(177),Bj=b(737);Object(ie.a)(ta,"RefreshAccessTokenContext",null,[]);var ih=b(188),xi=b(117),uj=b(146),Cj=
b(34),Vh=b(114);Object(ie.a)(ac,"Error",null,[]);Object(ie.a)(kb,"NamedResult",null,[]);Am(db,kb);Object(ie.a)(db,"ErrorInfo",kb,[]);Ck.Object.defineProperties(sb.prototype,{hP:{configurable:!0,enumerable:!0,get:function(){return this.IXb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.UT}}});Object(ie.a)(sb,"TokenRefreshArgs",null,[643]);Ta.prototype.Voe=function(V){this.Qa.addHandler("SessionExpired",V)};Ta.prototype.RZb=function(V){this.Qa.addHandler("TokenRefreshed",V)};Ta.prototype.pKd=
function(V){this.Qa.removeHandler("TokenRefreshed",V)};Ta.prototype.aec=function(){return th.a.instance.WR(zc.AFrameworkApplication.tk)};Ta.prototype.dispose=function(){th.a.instance.BKd(this.z7e);th.a.instance.AKd(this.$6e);var V=this.$.ea;V&&(V.Fk(this.qd),V.ttc(this.$ya));He.a.Ha(this.Qa);this.documentVisibilityObserver=this.$=null};Ta.prototype.o$f=function(){return this.aec()?0:(zc.AFrameworkApplication.tk-(new Date).getTime())/6E4};Ta.prototype.Qeg=function(V,ya){if(0<ya&&!this.aec()){var lb=
zc.AFrameworkApplication.ga.Cd("AccessTokenExpirationPromptSeconds",zc.AFrameworkApplication.UY),Kb=(ya-V.getTime())/6E4;Rb.ULS.shipAssertTag(537170713,0,0<=Kb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",ya,V.getTime(),Kb);Kb<this.vBi?(Rb.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",
this.k2f,Kb),zc.AFrameworkApplication.UY=this.k2f):zc.AFrameworkApplication.UY!==lb&&(Rb.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",lb,Kb),zc.AFrameworkApplication.UY=lb)}};Ta.prototype.Z4g=function(V){return!this.context||this.context.HHb||this.context.g5c!==V?(V=new ta(sj.a.create().toString(),V),this.context&&!this.context.TAc&&Rb.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",
V.correlationID,this.context.correlationID,this.context.HHb),this.JT=V,!0):!1};Ta.prototype.Ugj=function(V){V&&this.tH&&!this.fca&&this.$.ea.sf.vr&&!this.g6&&(this.tH=!1)};Ta.prototype.A7e=function(V){var ya=this;this.Ugj(V);if(!(this.Klb||this.seb&&!V||this.tH)&&this.Jdb){this.Klb=!0;var lb=this.context?this.context.creationTime:null,Kb=this.Z4g(V);this.Ivd=!0;var Lb=this.$.ea,Xa={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:Kb};Xa.IsUserActive=Lb.sf.vr;Xa.IsSessionActive=
Lb.sc;Xa.ContainsChangesWorkbookOperations=this.$.userOperationManager.RHa();Xa.isSessionExpired=V;Xa.stopRefreshRetriesUntilTokenExpired=this.seb;Xa.FailedToRefreshExpiredToken=this.tH;Xa.numOfFailuresWhileUserIsActive=Vh.a.D6;Xa.numOfFailuresWhileUserIsInActive=Vh.a.E6;Xa.numOfFailuresWhileOffline=Vh.a.Gya;Xa.RefreshAccessTokenCorrelationID=this.context.correlationID;Kb&&lb&&(Xa.TimeInMinFromPreviosContextCreation=Math.round(xi.b(Fg.a.Ta,lb)/60));lb=Zh.a.Lc(Xa);Rb.ULS.sendTraceTag(40416199,0,50,
lb);this.CId.start();this.nae=Lb.sf.vr;this.Ox=new Bj.a;this.fti(V);var od=this.ZWd.q8i(!V,this.Ox?this.Ox.token:null);od.continueWith(function(){ya.HYg();var Yd=ya.ZWd.H2i(od);ya.CId.stop();var ke=ya.aec();if(!Yd||De.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&ke){var Yf=od.result.errors;Yd&&ke&&ya.HBg(Yf);ya.d5h(Yf,V)}else ya.seb=!1,ya.f5h(od.result.hP,V);ya.Klb=!1},this.E$b?8:0)}};Ta.prototype.HBg=function(V){var ya=[Object(Pe.a)(new ac,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];
V.add(Object(Pe.a)(new db,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ya}))};Ta.prototype.fti=function(V){V&&(this.$.ea.sf.vr?this.T6f():(this.$.ea.sf.ksa(this.eDd),this.NHb=!0))};Ta.prototype.T6f=function(){var V=this;this.lsc=ih.AsyncMethodContext.av(function(){V.p8i()},1E3*this.gOf,yc.a.X7i,this.lsc)};Ta.prototype.HYg=function(){this.lsc&&this.lsc.cancel();this.NHb&&(this.$.ea.sf.nAa(this.eDd),this.NHb=!1);this.Ox=null};Ta.prototype.p8i=function(){Rb.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",
this.gOf);this.Ox.C()};Ta.prototype.d5h=function(V,ya){this.seb=!0;ya&&(this.tH||(this.Nmb=this.tH=!0),this.ZWd.Shc(V)&&(this.Nae=!0));var lb=!ya||this.Jdb&&!Vh.a.Nxc?40380379:39982555;ya=this.uEe(ya);ya.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ya.FailedToRefreshExpiredToken=this.tH;ya.LastErrorIsPermanent=this.g6;if(0<V.count){var Kb=V.oa(0);ya.errorName=Kb.Name;0<Kb.Errors.length&&(ya.ErrorId=Kb.Errors[0].Id,Kb=Kb.Errors[0].Details,ya.ErrorDetails=this.fih(Kb.toString())?
"PiiScrubbed":Kb)}ya=Zh.a.Lc(ya);Rb.ULS.sendTraceTag(lb,0,15,ya);this.Qa.raiseEvent("TokenRefreshed",new sb(null,V))};Ta.prototype.fih=function(V){return yg.a.contains(V,"makes the internet safe for businesses",!0)};Ta.prototype.uEe=function(V){var ya={},lb=this.$.ea;ya.Name="";ya.IsUserActive=lb.sf.vr;ya.IsSessionActive=lb.sc;ya.GotDeploymentOrTimedOutError=lb.rba;ya.TimeInSecFromLastStatefulSuccessfulRequest=lb.o8;ya.TimeFromLastUserActivityInMs=lb.sf.Teb;ya.calledFromSessionExpiredFlow=V;ya.RefreshTokenDurationInMS=
this.CId.zc;ya.numOfFailuresWhileUserIsActive=Vh.a.D6;ya.numOfFailuresWhileUserIsInActive=Vh.a.E6;ya.numOfFailuresWhileOffline=Vh.a.Gya;ya.RefreshAccessTokenCorrelationID=this.context.correlationID;ya.accessTokenTTL=zc.AFrameworkApplication.tk;ya.ContainsChangesWorkbookOperations=this.$.userOperationManager.RHa();ya.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Bi.toString():"Unknown";ya.TimeFromFirstOpenInHr=Math.floor(xi.b(Fg.a.Ta,ci.toUtc(lb.oGf))/3600);return ya};
Ta.prototype.f5h=function(V,ya){this.tH=!1;this.wUj();this.Qeg(new Date,zc.AFrameworkApplication.tk);var lb=this.$.ea,Kb=!ya&&lb.sf.vr,Lb=!this.$.isEditMode&&lb.mbb;ya=this.uEe(ya);ya.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ya.shouldTriggerSilentReloadAfterExpiring=Kb;ya.WopiTokenTaskItemPriority=zc.AFrameworkApplication.E0d;ya.isDirtyViewSession=Lb;ya=Zh.a.Lc(ya);Rb.ULS.sendTraceTag(39982556,0,15,ya);this.Qa.raiseEvent("TokenRefreshed",new sb(V,null));Lb?lb.sf.vr&&(Rb.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),lb.ycd()):lb.sf.vr?Kb&&(V=Nh.a(this.$).rd.activityState,V[Vh.a.kfb]=!0,V[uj.a.YY]=!0,V[Cj.a.Rs]=this.$.isEditMode,ig.a(this.$).rt(new hg.a(li.a.Kna,2,null))):lb.sc&&Xh.m(this.$.na.va,!0,!1,!1,null,null,null,null,null)};Ta.prototype.wUj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
pa.a.uU(this.$.ea.workbookContext.WorkbookUri,zc.AFrameworkApplication.VP,zc.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=pa.a.uU(this.$.ea.workbookContext.WorkbookUri,zc.AFrameworkApplication.VY,zc.AFrameworkApplication.tk.toString()),this.$.ea.npc()):Rb.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=zc.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=zc.AFrameworkApplication.tk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=pa.a.uU(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,zc.AFrameworkApplication.VP,zc.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=pa.a.uU(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,zc.AFrameworkApplication.VY,zc.AFrameworkApplication.tk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=pa.a.uU(this.$.ya.EmbedConfiguratorUrl,zc.AFrameworkApplication.VP,zc.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=pa.a.uU(this.$.ya.EmbedConfiguratorUrl,zc.AFrameworkApplication.VY,zc.AFrameworkApplication.tk.toString()));this.context.HHb=!0};Ck.Object.defineProperties(Ta.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Nmb}},fca:{configurable:!0,
enumerable:!0,get:function(){return this.nae}},g6:{configurable:!0,enumerable:!0,get:function(){return this.Nae}},context:{configurable:!0,enumerable:!0,get:function(){return this.JT}},Jdb:{configurable:!0,enumerable:!0,get:function(){return this.g6?!1:this.$.ea.sf.vr?1>Vh.a.D6:6>Vh.a.E6}},EId:{configurable:!0,enumerable:!0,get:function(){return this.Klb}}});Object(ie.a)(Ta,"EwaAccessTokenExpirationRefreshManager",null,[618,265,2]);wa.LYb="ActivityDuration";wa.error="Error";wa.Jmh="Errors";wa.failed=
"Failed";wa.iDh="FirstActivity";wa.initialized="Initialized";wa.vri="LastActivity";wa.Bij="RetryOverride";wa.rgj="RequestGroups";wa.requests="Requests";wa.pUf="Responses";wa.ewc="SessionDuration";wa.status="Status";wa.success="Success";wa.RMb="Successful";wa.hP="Tokens";Object(ie.a)(wa,"SessionExpirationStrings",null,[]);qa.prototype.Ehg=function(){var V={};Rb.ULS.sendTraceTag(41964821,217,50,Rb.ULS.Lc((V.Aggregate=this.nY,V.Current=this.Qo,V)))};qa.prototype.Lbi=function(){this.nY[wa.rgj]=0;this.nY[wa.requests]=
0;this.nY[wa.pUf]=0;this.nY[wa.status]=wa.initialized;this.nY[wa.iDh]=new Date;this.nY[wa.ewc]=0;this.nY[wa.LYb]=0;this.nY[wa.ewc]=0;this.Qo[wa.ewc]=0;this.nY[wa.LYb]=0;this.Qo[wa.LYb]=0};qa.prototype.jmd=function(V,ya){var lb=V[ya];lb=lb?lb:0;lb++;V[ya]=lb;this.OPd(V)};qa.prototype.OPd=function(V){var ya=new Date;V[wa.LYb]=+ya-+this.lUb;this.lUb=ya;V[wa.ewc]=+this.lUb-+this.rwg;V[wa.vri]=this.lUb};qa.prototype.odb=function(V,ya){this.Qo[V]=ya;this.OPd(this.Qo)};qa.prototype.CZf=function(V,ya){this.Qo[V]=
ya;this.OPd(this.Qo)};qa.prototype.incrementCounter=function(V){this.jmd(this.Qo,V);this.jmd(this.nY,V);this.jmd(this.Aug,V)};qa.prototype.flush=function(){this.iae||(this.nY[wa.status]=this.Qo[wa.status],this.Ehg(this.yXb),this.se.pna(this.yXb,6E4*this.fnf))};qa.prototype.stop=function(){Rb.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.iae=!0;this.se.aq(this.yXb)};Object(ie.a)(qa,"SessionLogger",null,[703]);var yj=b(738),yi=b(1141);Aa.prototype.KNi=
function(V){if(V.MessageId!==tc.a.pld)ae.a(39408099,306,15,"Unexpected message.");else{var ya=new me.a,lb=new me.a;this.mj.incrementCounter(wa.pUf);var Kb=V.Values[$b.a.IYf];if(!Kb||0>=Kb.length)ae.a(40122317,306,15,"Found no tokens in the dictionary"),Kb=V.Values;ae.a(40122318,306,100,"The Tokens array contains {0} tokens",Kb.length);this.mj.odb("Correlation",V.CorrelationId);for(var Lb="",Xa=0;Xa<Kb.length;Xa++){this.mj.CZf(wa.hP,Kb.length);var od=Kb[Xa],Yd=od;if(Yd&&Yd.Name){this.mj.incrementCounter(Yd.Name);
var ke=od;if(ke&&ke.Value)ae.a(39408128,306,100,"Received token with name: {0}",ke.Name),ya.add(ke),this.IXb.add(ke),this.mj.odb(wa.status,wa.success),this.$6d&&this.jU&&this.jU.rhj();else if(od=this.sYh(od),ae.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Yd.Name,JSON.stringify(od),this.Sga),lb.add(od),this.UT.add(od),Lb=JSON.stringify(od),this.mj.odb(wa.error,JSON.stringify(od)),this.mj.odb(wa.status,wa.failed),this.$6d)for(Yd=Cl(od.Errors),od=Yd.next();!od.done;od=
Yd.next())od=this.xPh(od.value),this.jU&&this.jU.WDg(od)}}0<lb.count&&""!==Lb?(Kb=Object.assign(new oe.a,{extendedProperties:new Map}),Kb.extendedProperties.set("Errors",Lb),Kc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Kb)):Kc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ae.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ya.count,lb.count,V.CorrelationId,this.Sga);0<lb.count&&!this.Shc(lb)?(V=
this.S9.OXh(lb),V!==this.S9.CMd&&(this.mj.CZf(wa.Bij,V),this.se.pna(this.Xi,V))):(this.mj.flush(),this.Xi&&(ae.a(39408131,306,100,"Deleting task {0} from task manager",this.Xi.name),this.se.aq(this.Xi)),this.fm&&!this.fm.task.isCompleted&&this.fm.setResult(new sb(ya,lb)))}};Aa.prototype.sYh=function(V){if(!V)return null;var ya=Object.assign(new db,{Name:V.Name,Errors:[]});V=Cl(V.Errors);for(var lb=V.next();!lb.done;lb=V.next()){lb=lb.value;var Kb=new ac;Kb.Id=lb.Id;Kb.Details=this.rYh(lb.Details);
ya.Errors.push(Kb)}return ya};Aa.prototype.rYh=function(V){if(!V)return"";var ya=V.toLowerCase();return 0<ya.indexOf("<!doctype")?this.bhd("Seems to contain HTML - Contains <!DOCTYPE"):0<ya.indexOf("<html")?this.bhd("Seems to contain HTML - Contains <html>"):500<ya.length?this.bhd(String.format("Error details content too long: Length: {0}",ya.length)):V};Aa.prototype.bhd=function(V){return String.format("{0} - Reason: [{1}]","### REDACTED ###",V)};Aa.prototype.requestTokensOnce=function(){this.xTf()};
Aa.prototype.xTf=function(){zc.AFrameworkApplication.Dvd("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.xra>=this.S9.rAi?(ae.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Sga),this.AEe(this.fm,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Kc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.tnj())};Aa.prototype.tnj=function(){var V={};V[$b.a.IYf]=
this.S9.hP;var ya=sj.a.create().toString();ae.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.S9.hP),this.xra+1,ya,this.Sga);this.Vee.execute(function(lb){lb.Jj(tc.a.fre,V,ya)});this.xra++;this.mj.incrementCounter(wa.requests)};Aa.prototype.AEe=function(V,ya,lb){for(var Kb=new me.a,Lb=0;Lb<this.S9.hP.length;Lb++){var Xa=Object.assign(new db,{Name:this.S9.hP[Lb],Errors:[Object.assign(new ac,{Id:ya,Details:lb})]});Kb.add(Xa);this.UT.add(Xa)}this.se.aq(this.Xi);
this.mj.odb(wa.Jmh,JSON.stringify(this.UT));this.mj.odb(wa.status,wa.failed);V&&!V.task.isCompleted&&V.setResult(new sb(new me.a,this.UT))};Aa.prototype.q8i=function(V,ya){var lb=this;ya=void 0===ya?null:ya;this.yje.start();this.eUb=V;this.Sga=sj.a.create().toString();ae.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Sga,this.eUb);this.xra=0;this.UT.clear();this.IXb.clear();var Kb=new jc.a;this.fm=Kb;ya&&ya.R(function(){var Lb=!!Kb&&!Kb.task.isCompleted;ae.a(588096223,
306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",lb.Sga,lb.eUb,Lb);Lb&&lb.AEe(Kb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Xi=new Se.a(this.S9.priority,2,this.S9.CMd,Object(Re.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,tc.a.fre,!0);this.lwg&&this.xTf();this.se.Yg(this.Xi);return this.fm.task};Aa.prototype.H2i=function(V){this.yje.stop();var ya=this.n6h(V.result.errors);Rb.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ya,this.Sga,this.eUb,this.xra,this.UT.count,0<V.result.errors.count?V.result.errors.oa(0).Name:"",0<V.result.errors.count&&0<V.result.errors.oa(0).Errors.length?V.result.errors.oa(0).Errors[0].Id:"",0<V.result.errors.count&&0<V.result.errors.oa(0).Errors.length?V.result.errors.oa(0).Errors[0].Details:"");return ya?!1:this.G2i(V.result.hP)};Aa.prototype.Shc=function(V){return this.S9.Shc(V)};Aa.prototype.G2i=function(V){for(var ya=0;ya<V.count;ya++){var lb=V.oa(ya);if(lb.Name===$b.a.accessToken){var Kb=
(new Date).getTime();if(lb.Expiry>zc.AFrameworkApplication.tk){var Lb={};Rb.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(Lb.AccessTokenTtl=lb.Expiry,Lb.NowGetTime=Kb,Lb.BootTime=zc.AFrameworkApplication.Pha,Lb),"PreviousAccessTokenTtl",zc.AFrameworkApplication.tk);zc.AFrameworkApplication.accessToken=lb.Value;zc.AFrameworkApplication.tk=Math.floor(lb.Expiry);zc.AFrameworkApplication.D0d=Kb;zc.AFrameworkApplication.FYa=Math.floor(lb.Expiry)}else Lb={},Rb.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(Lb.AccessTokenTtl=lb.Expiry,Lb.NowGetTime=Kb,Lb.BootTime=zc.AFrameworkApplication.Pha,Lb),"PreviousAccessTokenTtl",zc.AFrameworkApplication.tk)}}return!0};Aa.prototype.n6h=function(V){for(var ya=!1,lb=0;lb<V.count;lb++){ya=!0;var Kb=V.oa(lb);Rb.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Kb.Name,JSON.stringify(Kb.Errors),this.Sga)}return ya};Aa.prototype.xPh=function(V){var ya=
wh.a.dwc;V=parseInt(V.Id);if(isNaN(V))ya=wh.a.YXj;else{switch(V){case 401:ya=wh.a.aYj;break;case 403:ya=wh.a.WXj;break;case 500:ya=wh.a.XXj;break;case 503:ya=wh.a.$Xj}ya===wh.a.dwc&&(ya=500<V?wh.a.ZXj:wh.a.VXj)}return ya};Object(ie.a)(Aa,"TokenRefreshManager",null,[616]);va.prototype.Shc=function(V){V=JSON.stringify(V);if(this.NTc&&0<this.NTc.length)for(var ya=Cl(this.NTc),lb=ya.next();!lb.done;lb=ya.next())if(lb=lb.value,0<lb.length&&0<=V.indexOf(lb))return!0;return!1};va.prototype.OXh=function(V){try{if(V)for(var ya=
Cl(V),lb=ya.next();!lb.done;lb=ya.next()){var Kb=lb.value;if(Kb.Errors)for(var Lb=Cl(Kb.Errors),Xa=Lb.next();!Xa.done;Xa=Lb.next()){var od=Xa.value;if(od.Id in this.ege)return Number.parseInvariant(this.ege[od.Id].toString())}}}catch(Yd){Rb.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Yd.toString())}return this.CMd};va.prototype.btj=function(){var V={};try{if(!zc.AFrameworkApplication.idc()||0>=zc.AFrameworkApplication.idc().length||""===zc.AFrameworkApplication.idc()[0])return V;
for(var ya=Cl(zc.AFrameworkApplication.idc()),lb=ya.next();!lb.done;lb=ya.next()){var Kb=lb.value;0<Kb.length&&(V[Kb]=zc.AFrameworkApplication.cYj)}}catch(Lb){Rb.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Lb.toString())}return V};Object(ie.a)(va,"TokenRefreshPolicy",null,[615]);var Aj=df.a;Am(xa,Aj);xa.prototype.create=function(){zc.AFrameworkApplication.AN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
zc.AFrameworkApplication.ga.ra("RefreshAccessTokenSilently")?this.Eb(this.S6g()):this.Eb(this.$.da.Aa(38)||this.$.da.Ga(38,new ra(this.$)))};xa.prototype.S6g=function(){var V=this.$.da.Aa(38);if(V)return V;V=new Aa(zc.AFrameworkApplication.Ri,zc.AFrameworkApplication.aW(),new va);return this.$.da.Ga(38,new Ta(this.$,V))};xa.ka=function(V){V.da.Ga(39,new xa(V))};Object(ie.a)(xa,"AccessTokenExpirationManagerFactory",df.a,[]);var W=Ee.a;Am(ka,W);ka.prototype.RHg=function(V){this.addHandler("TAF",V)};
ka.prototype.Zdj=function(V){this.removeHandler("TAF",V)};ka.prototype.r4i=function(){this.raiseEvent("TAF")};Object(ie.a)(ka,"GridHighlightBehaviorEventManager",Ee.a,[620,2]);var Ja=df.a;Am(ha,Ja);ha.prototype.create=function(){this.Eb(this.$.da.Aa(376)||new ka(this.$))};ha.ka=function(V){V.da.Ga(377,new ha(V))};Object(ie.a)(ha,"GridHighlightBehaviorEventManagerFactory",df.a,[]);var Eb=b(121),gc=Sys.EventArgs;Am(na,gc);Object(ie.a)(na,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var Yc=
Ee.a;Am(aa,Yc);aa.prototype.qGg=function(V){this.addHandler("mrek",V)};aa.prototype.Ly=function(V,ya,lb){for(var Kb=Cl(this.gridView.An),Lb=Kb.next();!Lb.done;Lb=Kb.next())eg.a.instance.pa(lf.a.yh,Lb.value.domElement,V);eg.a.instance.pa(lf.a.$d,document.documentElement,ya);this.gridView.Ac.k8b(!0);lb&&eg.a.instance.pa(lf.a.Iy,this.gridView.Oj,ya)};aa.prototype.JYd=function(V,ya,lb){for(var Kb=Cl(this.gridView.An),Lb=Kb.next();!Lb.done;Lb=Kb.next())eg.a.instance.za(lf.a.yh,Lb.value.domElement,V);eg.a.instance.za(lf.a.$d,
document.documentElement,ya);this.gridView.Ac.k8b(!1);lb&&eg.a.instance.za(lf.a.Iy,this.gridView.Oj,ya)};aa.prototype.l9i=function(V,ya){for(var lb=Cl(this.gridView.An),Kb=lb.next();!Kb.done;Kb=lb.next())Je.a.instance.pa(lf.a.wg,Kb.value.domElement,V);Je.a.instance.pa(lf.a.Ce,document.documentElement,ya)};aa.prototype.XPj=function(V,ya){for(var lb=Cl(this.gridView.An),Kb=lb.next();!Kb.done;Kb=lb.next())Je.a.instance.za(lf.a.wg,Kb.value.domElement,V);Je.a.instance.za(lf.a.Ce,document.documentElement,
ya)};aa.prototype.wEe=function(V,ya,lb,Kb){var Lb=document.createElement("div");Lb.className=ya;ya=Cl(lb);for(lb=ya.next();!lb.done;lb=ya.next())Lb.classList.add(lb.value);V.appendChild(Lb);eg.a.instance.pa(lf.a.pointerDown,Lb,Kb);return Lb};aa.prototype.n3e=function(V){V=V.Mb.parentNode;if(!V)return Rb.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;V=parseInt(V.getAttribute($d.a.ryb),10);return isNaN(V)?(Rb.ULS.shipAssertTag(537159393,
0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Cb.Jw(3,1,V)};aa.prototype.WKb=function(V,ya,lb){V=(void 0===lb?!0:lb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.Gki(V);ya=Cl(ya);for(lb=ya.next();!lb.done;lb=ya.next())le.DOMElementExtensions.setVisible(lb.value,V)};aa.prototype.Edd=function(){return this.gridView.Fj?Eb.a(this.gridView.$):this.gridView.rc};aa.prototype.xNf=function(){var V=this.Edd();
V&&this.coloredReferencesManager?this.coloredReferencesManager.$X(V,null):(Rb.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Cb.Xh(this.$pf),this.gridView.Cb.vj(null,this.$pf))};aa.prototype.ILf=function(V,ya){this.raiseEvent("mrek",new na(V,ya))};Ck.Object.defineProperties(aa.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var V=this.gridView.$.da.Aa(281);
V||Rb.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return V}}});Object(ie.a)(aa,"BehaviorHelperMethods",Ee.a,[]);var vd=pf.a;Am(fa,vd);fa.prototype.uZa=function(){};Object(ie.a)(fa,"HighlightFlyweightBehavior",pf.a,[]);var fe=b(493),re=b(115),Oe=b(9),Wc=b(71),Pf=ph.a;Am(U,Pf);U.prototype.uoe=function(V){this.addHandler("GrDrag",
V)};U.prototype.cRf=function(V){this.removeHandler("GrDrag",V)};U.prototype.toe=function(V){this.addHandler("GrContxt",V)};U.prototype.bRf=function(V){this.removeHandler("GrContxt",V)};U.prototype.voe=function(V){this.addHandler("GrPointerUp",V)};U.prototype.dRf=function(V){this.removeHandler("GrPointerUp",V)};U.prototype.dispose=function(){og.a.fna(this.domElement);Pf.prototype.dispose.call(this)};U.prototype.ieg=function(V){this.domElement.parentNode.removeChild(this.domElement);V.appendChild(this.domElement)};
U.prototype.ZYf=function(){this.domElement.classList.remove(Wc.a.o9b);this.pLa.classList.remove(Wc.a.n9b);this.pLa.classList.add(Wc.a.MRe)};U.prototype.Bcg=function(){this.pLa.classList.remove(Wc.a.MRe);this.pLa.classList.add(Wc.a.n9b);this.domElement.classList.add(Wc.a.o9b)};U.prototype.B6h=function(V){return!!this.N5b&&(3<Math.abs(V.x-this.N5b.x)||3<Math.abs(V.y-this.N5b.y))};U.Bvb=function(V){var ya=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),lb=Da.a.xf;return ya&&!lb?
(V=Zf.a(V.$)?Zf.a(V.$).zoom:Oe.a.l0,Math.round(9/Math.max(V,1))):9};U.Kwd=0;Object(ie.a)(U,"TouchGrippie",ph.a,[]);Am(L,fa);L.prototype.dispose=function(){He.a.yc([this.iP,this.BM]);this.iP.cRf(this.KEf);this.iP.bRf(this.Lnc);this.iP.dRf(this.Mnc);this.BM.cRf(this.tvf);this.BM.bRf(this.Lnc);this.BM.dRf(this.Mnc);for(var V=Cl(this.gridView.An),ya=V.next();!ya.done;ya=V.next())ya=ya.value,Je.a.instance.za(lf.a.Lf,ya.domElement,this.gzf),Je.a.instance.za(lf.a.Ce,ya.domElement,this.fzf);this.gridView.view.Yq(this.Ww);
this.gridView.rc.kl(this.ZKe);this.gridView.Cb.BIb(this.dza);this.gridView.UJd(this.hvf);this.gridView.$.AD(this.Irc);this.gridView.gx(this.Irc);this.ha.qX(this.wh);this.ha.B7(this.Fp);this.gridView.aG(this.Dp);this.ha.atc(this.Zyf);Ud.a.lRf(this.PEb);this.Sba&&Rb.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(V=this.gridView.$.da.Aa(376))&&V.Zdj(this.LEf);fa.prototype.dispose.call(this)};L.prototype.CSa=function(){if(!this.Aba.range||!this.Aba.range.equals(this.Rcb))return!1;
var V=!this.gridView.YMa();return this.gridView.isEditing&&V&&(this.Rcb.isRow||this.Rcb.ff)?!1:this.Sba?!0:3===Ud.a.Vb};L.prototype.r5=function(){this.Fob&&(this.iP.set_visible(!1),this.BM.set_visible(!1),this.Fob=!1)};L.prototype.ioa=function(){if(this.CSa()){this.oTj();var V=le.DOMElementExtensions.getBoundingClientRect(this.Ypb);V||Rb.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.kgf,this.wXc,this.gridView.Oj,this.gridView.rb.dj);var ya=le.DOMElementExtensions.getBoundingClientRect(this.Zmj),lb=new Sys.UI.Bounds(ya.x-V.x,ya.y-V.y,ya.width,ya.height),Kb=this.Rcb,Lb=Kb.topLeft,Xa=Kb.bottomRight,od=Kb.isRow||Kb.ff;if(Kb.ff){var Yd=this.wCh();Kb=lb.x-2*U.Bvb(this.gridView);var ke=Yd;var Yf=lb.x+ya.width}else Kb.isRow?(Kb=Yf=this.vCh(),ke=lb.y-2*U.Bvb(this.gridView),Yd=lb.y+ya.height):(ke=lb.y,Yd=lb.y+ya.height,this.gridView.rtl?(Kb=
lb.x+ya.width,Yf=lb.x):(Kb=lb.x,Yf=lb.x+ya.width));ya=U.Kwd+(od?0:U.Bvb(this.gridView));this.iP.style.left=wg.HelperMethods.nc(Kb-ya);this.iP.style.top=wg.HelperMethods.nc(ke-ya);this.BM.style.left=wg.HelperMethods.nc(Yf-ya);this.BM.style.top=wg.HelperMethods.nc(Yd-ya);this.iP.set_visible(this.Mef(ke,Kb,Lb,od,V));this.BM.set_visible(this.Mef(Yd,Yf,Xa,od,V));this.Fob=!0}};L.prototype.Mef=function(V,ya,lb,Kb,Lb){var Xa=le.DOMElementExtensions.getBoundingClientRect(this.gridView.Tf(this.paneType).domElement);
Lb=new Sys.UI.Bounds(Xa.x-Lb.x-3,Xa.y-Lb.y-3,Xa.width+6,Xa.height+6);return(this.gridView.rb.rj(lb)===this.paneType||Kb)&&qb.a.yB(Lb,new Sys.UI.Point(ya,V))};L.prototype.oTj=function(){if(this.kgf!==this.wXc){this.Ypb=null;var V=this.vbd();this.iP.ieg(V);this.BM.ieg(V)}};L.prototype.wCh=function(){return(this.gridView.view.visibleArea.height+this.gridView.rb.height+U.Kwd-U.Bvb(this.gridView))/2};L.prototype.vCh=function(){return(this.gridView.view.visibleArea.width+this.gridView.rb.width+U.Kwd-U.Bvb(this.gridView))/
2};L.prototype.$Cf=function(){this.ioa()};L.prototype.yii=function(V){return le.DOMElementExtensions.Gcb(V.Mb,G.a.lm)&&(this.Bji(V)||this.Cji(V))};L.prototype.Cji=function(V){if(this.gridView.rtl)V=V.clientPoint.x;else{var ya=le.DOMElementExtensions.getBoundingClientRect(V.Mb);V=V.clientPoint.x-(ya.x+ya.width-re.a.zu)}return 0<V&&V<=re.a.zu};L.prototype.Bji=function(V){var ya=le.DOMElementExtensions.getBoundingClientRect(V.Mb);V=V.clientPoint.y-(ya.y+ya.height-re.a.zu);return 0<V&&V<=re.a.zu};L.prototype.hzf=
function(V,ya){this.Sba&&Rb.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.Q_c(V,ya,this.Sba);this.r5()};L.prototype.ypj=function(){this.Sba||(Rb.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Sba=!0,this.iP.ZYf(),this.BM.ZYf(),this.gridView.ha.sourceRange=this.gridView.ha.ta.ud,this.ioa())};L.prototype.NYd=function(){this.Sba&&(Rb.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.Sba=!1,this.iP.Bcg(),this.BM.Bcg())};L.prototype.vbd=function(){this.Ypb||(this.wXc=!1,this.Ypb=this.gridView.Oj);return this.Ypb};Ck.Object.defineProperties(L.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.cw}}});Object(ie.a)(L,"SelectionTouchGrippiesBehaviorBase",fa,[]);Am(H,L);H.prototype.CSa=function(){var V=this.gridView.Ni||this.gridView.isEditing;return!this.gridView.ha.ta.Lg&&!V&&L.prototype.CSa.call(this)};Ck.Object.defineProperties(H.prototype,{u5:{configurable:!0,
enumerable:!0,get:function(){return 19}},Rcb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.ta.activeRange}}});Object(ie.a)(H,"DiscontinuousSelectionTouchGrippiesBehavior",L,[]);var nf=b(327);Am(I,fa);Object(ie.a)(I,"SelectionBorderBehavior",fa,[]);ca.dxh="ewr-selection-draghandle";ca.ixh="ewr-selection-draghandle-grab";ca.txh="ewr-selection-draghandle-top-ie";ca.uxh="ewr-selection-draghandle-top-ie-enhanced";ca.rxh="ewr-selection-draghandle-top";ca.sxh="ewr-selection-draghandle-top-enhanced";
ca.gxh="ewr-selection-draghandle-bottom-ie";ca.hxh="ewr-selection-draghandle-bottom-ie-enhanced";ca.exh="ewr-selection-draghandle-bottom";ca.fxh="ewr-selection-draghandle-bottom-enhanced";ca.lxh="ewr-selection-draghandle-left-ie";ca.mxh="ewr-selection-draghandle-left-ie-enhanced";ca.jxh="ewr-selection-draghandle-left";ca.kxh="ewr-selection-draghandle-left-enhanced";ca.pxh="ewr-selection-draghandle-right-ie";ca.qxh="ewr-selection-draghandle-right-ie-enhanced";ca.nxh="ewr-selection-draghandle-right";
ca.oxh="ewr-selection-draghandle-right-enhanced";ca.SRe="ewr-selection-dragtooltip";ca.TRe="ewr-selection-dragtooltip-updated";ca.Fxh="ewr_selection_rearrangeleft";ca.Gxh="ewr_selection_rearrangeright";ca.Hxh="ewr_selection_rearrangetop";ca.Exh="ewr_selection_rearrangebottom";ca.selecting="selecting";ca.Ixh="ewr-selection-resizemarqueehandle";ca.Lxh="ewr-selection-resizemarqueehandle-topleft";ca.Mxh="ewr-selection-resizemarqueehandle-topright";ca.Jxh="ewr-selection-resizemarqueehandle-bottomleft";
ca.Kxh="ewr-selection-resizemarqueehandle-bottomright";ca.Uwh="ewr-marquee-thick";ca.Ywh="ewr-resizemarqueehandle-thick";Object(ie.a)(ca,"CssClassNames",null,[]);Am(Z,I);Z.prototype.dispose=function(){var V=this;this.ds.forEach(function(ya){eg.a.instance.za(lf.a.pointerDown,ya,V.onPointerDown)});Array.clear(this.ds);this.Uma=this.sourceRange=this.Jb=null;Rb.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.$ra,!this.$);
this.$&&(this.$.Ul(this.zd),1===this.$ra&&(Rb.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Ys(this.ule,this.vle,!1)));I.prototype.dispose.call(this)};Z.prototype.Pf=function(V){V=Zf.a(this.$).qe(V);return this.pCd(V)};Z.prototype.pCd=function(V){if(5!==this.pj)return!1;(V=this.aza(V))||this.gub(!1);Di.b(this.$,!1);return V};Z.prototype.Sh=function(V){V=Zf.a(this.$).qe(V);if(this.Yh&&this.yoc(V))return!0;if(V=this.ha.Xn(V.clientPoint,
V.Mb,5,void 0,void 0,!0)){V=this.aia(V);if(this.Jb.equals(V))return!0;this.Jb=V;if(!this.PD())return Rb.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.gub(!0),!1}return!0};Z.prototype.Ly=function(V,ya){Rb.ULS.shipAssertTag(537159377,0,!this.$ra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.$ra+=1;this.ule=V;this.vle=ya;this.so.Ly(V,ya,this.iBc())};Z.prototype.aia=
function(V){if(!V||!this.Jb)return Rb.ULS.shipAssertTag(537159376,0,!!V,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),Rb.ULS.shipAssertTag(537159375,0,!!this.Jb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var ya=this.Jb.clone();1!==this.KE&&(ya.left=Math.max(V.left-this.Iec,1),ya.right=ya.left+this.sourceRange.width-1);2!==this.KE&&(ya.top=Math.max(V.top-this.oDc,1),ya.bottom=ya.top+this.sourceRange.height-1);return this.vZa(ya)};
Z.prototype.Ys=function(V,ya,lb,Kb){lb=void 0===lb?!0:lb;Kb=void 0===Kb?!0:Kb;Rb.ULS.shipAssertTag(537159374,0,1===this.$ra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.$ra;this.Yh||Kf.g(this.$).rg.No($d.a.k5);this.so.JYd(V,ya,this.iBc());lb&&this.Aqb(Kb);this.KE=0;this.iTa=!1};Z.prototype.vZa=function(V){var ya=Kf.g(this.$),lb=V;if(ya.rb.o5){if(!ya.mc(V.topLeft)){ya=ya.wk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ya.yH,this.Uma.top!==V.top?
1:2);try{ya.dl=this.Uma.top<V.top||this.Uma.left<V.left,ya.us(V.topLeft),lb=ya.$$cu().range}finally{ya&&ya.dispose()}}lb.right=lb.left+V.width-1;lb.bottom=lb.top+V.height-1}return this.Uma=lb};Z.prototype.Awc=function(V){this.ds.forEach(function(ya){le.DOMElementExtensions.setVisible(ya,V)})};Z.prototype.cUh=function(V){var ya=V.Mb;V=V.clientPoint;if(!ya||!V)return Rb.ULS.shipAssertTag(537159373,0,!!ya,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Rb.ULS.shipAssertTag(537159372,
0,!!V,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;V.y+=ya===this.ds[Z.$Ia]?2:ya===this.ds[Z.P7c]?-2:0;V.x+=ya===this.ds[Z.Q7c]?2:ya===this.ds[Z.ZIa]?-2:0;return this.ha.Xn(V,ya,5,void 0,void 0,!0)};Ck.Object.defineProperties(Z.prototype,{Cb:{configurable:!0,enumerable:!0,get:function(){return Kf.g(this.$).Cb}},pj:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(V){this.ha.selectionType=V}}});Z.K7c="move";Z.k2a="grabbing";Z.$Ia=
0;Z.P7c=1;Z.Q7c=2;Z.ZIa=3;Object(ie.a)(Z,"DragSelectionClickBehaviorBase",I,[]);Am(ea,Z);ea.prototype.uZa=function(V){this.so.WKb(V,this.ds);this.yy.uAa()};ea.prototype.woc=function(V){Rb.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.YLa=!0;this.Ya.eH(!1);this.pj=5;this.yy.CKe(V.Mb);this.Ya.textBox.removeSelection();this.Ya.LZb(this.U6e);this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,
"onPointerUp"));this.KE=this.sourceRange.isRow?1:this.sourceRange.ff?2:0};ea.prototype.aza=function(){var V=this.zL();this.pj=-1;this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"));return V};ea.prototype.Aqb=function(){this.gridView.YLa=!1;this.yy.DKe(this.ds[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.mtc(this.U6e);this.so.xNf()};ea.prototype.gub=function(V){Rb.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
V&&this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"))};ea.prototype.Ecc=function(V){this.Ya=this.so.Edd();this.wL=this.so.n3e(V);return this.Ya&&this.wL&&this.wL.range?this.wL.range:(Rb.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Rb.ULS.shipAssertTag(537159387,0,!!this.wL,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Rb.ULS.shipAssertTag(537159386,0,!!this.wL.range,
"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};ea.prototype.zL=function(){return this.wL?this.coloredReferencesManager.Frf(this.Ya,this.wL,this.Jb):(Rb.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};ea.prototype.PD=function(){return this.zL()};ea.prototype.iBc=function(){return!0};ea.prototype.yoc=function(){return!1};Object(ie.a)(ea,
"DragMarqueeClickBehavior",Z,[]);var Qg=b(972),Ng=b(916),ti=b(119);Object(ie.a)(R,"MacroRecorderTableRowColumnRearrangedPayload",null,[447]);Am(T,Z);T.prototype.dispose=function(){this.ha&&(this.ha.B7(this.Fp),this.ha.qX(this.wh),this.ha.xKd(this.rPa),this.ha.xI(this.kd));if(this.Uh)for(var V=1;4>=V;V++)le.DOMElementExtensions.Af(this.Uh[V.toString()]);this.Uh=this.Nh=null;this.ju&&this.Woa();this.Yh&&this.ku&&this.Woa(1);Z.prototype.dispose.call(this)};T.prototype.woc=function(V){this.Yh&&(this.Zw=
V,this.dA=null,this.Qq=this.isRow=this.ff=this.Rq=!1,vh.KeyInputManager.instance.pa(lf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown));this.jq=!0;this.tableRange=this.k_c(this.tableManager.tn(this.sourceRange.topLeft));Kf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Yh?(this.dA=this.tableRange,this.Qn=1,this.Nh=(this.Qq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Ly(this.$K,this.aL),this.PM=
this.Ria,this.QO=this.doa,this.PB(V.clientPoint,V.Mb,this.Qq?11:12,!0,!0),this.TL(!0)):(this.Nh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Ly(this.$K,this.aL),this.PB(V.clientPoint,V.Mb,this.isRow?11:12,!0)):(this.tableRange=null,this.Yh?(this.isRow=this.sourceRange.isRow,this.ff=this.sourceRange.ff,this.isRow||this.ff?(this.Qn=3,this.KE=this.isRow?1:2,this.pj=6,this.Nh=this.isRow?[11]:[12],this.Ly(this.T6,this.U6),
this.PM=this.Ria,this.QO=this.doa,this.PB(V.clientPoint,V.Mb,this.isRow?11:12,!0,!0),this.TL(!0)):(this.Qn=2,this.KE=0,this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp")),this.PM=this.$sb,this.QO=this.rLb,this.PB(V.clientPoint,V.Mb,this.Qja(),!1,!0),this.PD(!0))):(this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp")),vh.KeyInputManager.instance.pa(lf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown),this.KE=this.sourceRange.isRow?
1:this.sourceRange.ff?2:0,this.PB(V.clientPoint,V.Mb,this.Qja(),!1),this.PD()))};T.prototype.aza=function(){this.jq=!1;this.Yh&&(this.Qn=0);this.Cb.Xh(this.nB());if(!this.$.Dq([this.Jb],!1))return this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp")),this.pj=-1,!0;if(this.ha.ta.ud.equals(this.Jb)||this.Oka(this.Jb)||this.Oka(this.sourceRange))this.pj=-1;else{this.zL();this.ha.sourceRange=this.sourceRange.clone();var V=this.ha.sourceRange,ya=this.ha.ta.ud;if(this.Yh){var lb=
{};this.$.Zd(-694765314,2,30,(lb[$d.a.uua]=this.ju,lb[$d.a.s4]=V,lb[$d.a.r4]=ya,lb[$d.a.Xsb]=this.ku,lb))}else lb={},this.$.Zd(-694765314,2,30,(lb[$d.a.uua]=this.ju,lb[$d.a.s4]=V,lb[$d.a.r4]=ya,lb))}!this.Yh&&this.tableRange||this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"));return!0};T.prototype.Aqb=function(V){V&&(vh.KeyInputManager.instance.za(lf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown),this.Yh&&Kf.g(this.$).rg.No($d.a.k5),this.jq=!1);for(V=
1;4>=V;V++){var ya=this.Uh[V.toString()];ya&&ya.parentNode.removeChild(ya);this.Uh[V.toString()]=null}this.Nh=null};T.prototype.yoc=function(V){var ya=this.ha.Xn(V.clientPoint,V.Mb,5,void 0,void 0,!0);this.Zw=V;return this.oxb(ya)?(this.Jb=this.O$(ya),this.$wb(!0),!0):this.akd(ya)?(this.Jb=this.aia(ya),this.axb(!0),!0):!1};T.prototype.oxb=function(V){return!!this.dA&&1!==this.Qn&&!!V&&this.dA.contains(V.topLeft)};T.prototype.akd=function(V){return!!this.dA&&1===this.Qn&&!!V&&!this.dA.contains(V.topLeft)};
T.prototype.$wb=function(V){this.tableRange=this.dA;this.Qn=1;var ya=!this.ku;V?(this.hH(!1),this.Nh=this.Qq?[11]:[12],this.KHb(ya),this.TL(ya)):(this.G3(!1),this.x7(ya),this.PD(ya))};T.prototype.axb=function(V){this.tableRange=null;this.Qn=2;var ya=!this.ku;V?(this.hH(!1),this.Nh=this.Qq?[11]:[12],this.Rq=this.Qq,this.EQa(ya),this.TL(ya)):(this.hta(!1),this.x7(ya),this.PD(ya))};T.prototype.Ecc=function(){return this.ha.ta.ud};T.prototype.zL=function(){this.ha.updateSelection(this.Jb,this.Jb.topLeft,
0);return!0};T.prototype.PD=function(V){V=void 0===V?!1:V;this.Cb.vj(this.Jb,this.nB());this.Cb.Gn(this.nB());this.QB(V);return!0};T.prototype.TL=function(V){V=void 0===V?!1:V;this.Cb.vj(this.Jb,this.Nh);this.Cb.Gn(this.Nh);this.QB(V)};T.prototype.gub=function(){Rb.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};T.prototype.iBc=function(){return!1};T.prototype.Vxc=function(){if(!Kf.g(this.$).ha.ta.Lg)return!1;
var V=Kf.g(this.$).getRangeInformation(this.ha.ta.ud);V=Cl(V);for(var ya=V.next();!ya.done;ya=V.next())if(Object(Wg.a)(Pg.PivotTableRange,ya.value))return!1;return!0};T.prototype.k_c=function(V){if(V&&V.contains(this.sourceRange)&&!V.equals(this.sourceRange)){if(V.yba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===V.top){var ya=new ue.Range(this.sourceRange.top,this.sourceRange.left,V.bottom,this.sourceRange.right,!1,!1);if(!ya.equals(V))return this.sourceRange=ya,this.ha.updateSelection(this.sourceRange,
this.sourceRange.topLeft,0),V}this.Yh?this.Qq=V.left===this.sourceRange.left&&V.right===this.sourceRange.right:this.isRow=V.left===this.sourceRange.left&&V.right===this.sourceRange.right;if(V.top===this.sourceRange.top&&V.bottom===this.sourceRange.bottom||this.uy())return V}return null};T.prototype.O$=function(V){var ya=V.clone();this.uy()?ya.left=Math.max(V.left-this.Iec,1):ya.top=Math.max(V.top-this.oDc,1);ya.right=ya.left+this.sourceRange.width-1;ya.bottom=ya.top+this.sourceRange.height-1;return this.vZa(ya)};
T.prototype.bAb=function(){var V=this.Jb.topLeft.Kd(this.sourceRange);return V||this.Yh&&!this.tableRange?V:this.uy()?this.Jb.top===this.sourceRange.bottom+1:this.Jb.left===this.sourceRange.right+1};T.prototype.ZHd=function(){if(this.uy()&&this.Jb.left!==this.tableRange.left||!this.uy()&&this.Jb.top!==this.tableRange.top){var V=Ag.a.gd(1,1,0,897,0,2065438552,"RearrangeInvalidDest");ig.a(this.$).Bs([V]);return!0}return!1};T.prototype.DGd=function(){var V=this,ya=this.$.Ob.Hc("UserAction","RearrangeRowColumnClientSide"),
lb={},Kb=(lb.CopyPasteTargetType=1,lb.OperationId=sj.a.create().toString(),lb.Stopwatch=ya,lb.DragDropIsShiftKeyDown=this.ku,lb.EncounteredDeploymentErrors=!1,lb),Lb=this.ju?2:1,Xa=this.$.da.Aa(254);(new Promise(function(od,Yd){V.bub(function(ke){ke.Errors&&0<ke.Errors.length?Yd(new Qg.a(22,ke.Errors)):od(!0)},function(ke){ke=ti.a.pg(ke.data);Yd(new Qg.a(22,ke))})})).then(function(){Rb.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);Xa&&Xa.vnf(Kb,Lb,V.sourceRange,V.Jb);return Promise.resolve(!0)},function(od){Rb.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',od?copyPasteInfra.getStringifiedError(od):"null",1);return Xa?Xa.jCf(od,Kb,Lb,V.sourceRange,V.Jb):Promise.reject(od)})};T.prototype.bub=function(V,ya){function lb(){return new R(od,Xa)}function Kb(Yd,ke,Yf){return Q(Lb.$.na.va,od,Xa,V?je.b(Yd,V):Yd,ya?je.a(ke,ya):ke,Yf,null)}var Lb=this;V=void 0===V?null:
V;ya=void 0===ya?null:ya;var Xa={};this.uy()?(Xa.FirstRow=this.Jb.top-1,Xa.FirstColumn=0,Xa.DeltaColumn=0,Xa.DeltaRow=this.Jb.bottom-this.Jb.top+1):(Xa.FirstRow=0,Xa.FirstColumn=this.Jb.left-1,Xa.DeltaColumn=this.Jb.right-this.Jb.left+1,Xa.DeltaRow=0);Xa.LastRow=Oe.a.zy;Xa.LastColumn=Oe.a.yv;Xa.SheetName=this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;var od=Ia.v(this.sourceRange,this.$);De.EwaSettings.qc()?this.$.userOperationManager.ic(new Bb.a(514,0,Kb,64,lb),
null):this.$.userOperationManager.ic(new S.a(514,0,Kb,void 0,lb),null)};T.prototype.Oka=function(V){V=Kf.g(this.$).getRangeInformation(V);for(var ya=0,lb=V.length;ya<lb;++ya)if(Object(Wg.a)(Pg.PivotTableRange,V[ya]))return V=Ag.a.gd(1,0,0,892,0,2105176604,"InsDelCellsPivotTable"),ig.a(this.$).Bs([V]),!0;return!1};T.prototype.PB=function(V,ya,lb,Kb,Lb){Lb=void 0===Lb?!1:Lb;var Xa=le.DOMElementExtensions.getBoundingClientRect(ya),od=ya===this.ds[Z.$Ia]||ya===this.ds[Z.P7c];if(this.Yh){var Yd=ya===this.ds[Z.Q7c]||
ya===this.ds[Z.ZIa];this.isRow&&Yd||this.ff&&od?Yd="100px":(od=this.isRow||od,Yd=(od?Lb?T.gXd:T.mXd:Lb?T.fXd:T.jXd)+"px");ya=od?ya===this.ds[Z.$Ia]?"top":"bottom":ya===this.ds[Z.ZIa]?"right":"left";V=100*(od?V.x-Xa.x:V.y-Xa.y)/(od?Xa.width:Xa.height);for(Xa=1;4>=Xa;Xa++){Kb=document.createElement("div");var ke=document.createElement("div"),Yf=document.createElement("div");Kb.appendChild(ke);Kb.appendChild(Yf);Lb&&(ke=document.createElement("div"),Kb.appendChild(ke),Yf.style.fontWeight="bold");Kb.className=
ca.TRe;this.Uh[Xa.toString()]=Kb;this.Cb.Jw(lb,Xa).Of.appendChild(Kb);Kb=this.Uh[Xa.toString()];Kb.style[ya]=Yd;Kb.style[od?"left":"top"]=V+"%"}}else for(Lb=(od?-T.lXd:-T.iXd)+"px",Yd=od?ya===this.ds[Z.$Ia]?"top":"bottom":ya===this.ds[Z.ZIa]||Kb?"right":"left",ya=100*(od?Kb?0:V.x-Xa.x:V.y-Xa.y)/(od?Xa.width:Xa.height),V=1;4>=V;V++)Xa=document.createElement("div"),Xa.className=ca.SRe,this.Uh[V.toString()]=Xa,this.Cb.Jw(lb,V).Of.appendChild(Xa),Xa=this.Uh[V.toString()],Xa.style[Yd]=Lb,Xa.style[od?"left":
"top"]=ya+"%"};T.prototype.QB=function(V){V=void 0===V?!1:V;var ya=this.Jb.toString();if(this.Yh)for(var lb=1;4>=lb;lb++)this.Uh[lb.toString()].childNodes[0].innerText=ya,this.Uh[lb.toString()].childNodes[1].innerText=this.PM,V&&(this.Uh[lb.toString()].childNodes[2].innerText=this.QO);else for(V=1;4>=V;V++)this.Uh[V.toString()].innerText=ya};T.prototype.Woa=function(V){V=void 0===V?0:V;0===V?this.ju=!1:1===V&&(this.ku=!1);this.Yh&&(this.ju||this.ku)||(vh.KeyInputManager.instance.za(lf.a.Sd,this.domElement.ownerDocument.body,
this.onKeyUp),this.VMa=!1)};T.prototype.hH=function(V){this.Cb.Xh(this.nB());this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"),void 0,V)};T.prototype.G3=function(V){this.Cb.Xh(this.Nh);this.Ys(this.T6,this.U6,void 0,V)};T.prototype.hta=function(V){this.Cb.Xh(this.Nh);this.Ys(this.$K,this.aL,void 0,V)};T.prototype.x7=function(V){V=void 0===V?!1:V;this.pj=5;this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"));this.PM=
this.$sb;this.QO=this.rLb;this.PB(this.Zw.clientPoint,this.Zw.Mb,this.Qja(),!1,V)};T.prototype.EQa=function(V){V=void 0===V?!1:V;this.pj=6;this.Ly(this.T6,this.U6);this.PM=this.Ria;this.QO=this.doa;this.PB(this.Zw.clientPoint,this.Zw.Mb,this.isRow||this.Qq?11:12,!0,V)};T.prototype.KHb=function(V){V=void 0===V?!1:V;this.pj=6;this.Ly(this.$K,this.aL);this.PM=this.Ria;this.QO=this.doa;this.PB(this.Zw.clientPoint,this.Zw.Mb,this.uy()?11:12,!0,V)};T.prototype.Uka=function(V){return V.Ca.keyCode===md.a.H8||
Da.a.isMac&&V.Ca.keyCode===md.a.epa};T.prototype.uy=function(){return!this.Yh&&this.isRow||this.Yh&&this.Qq};T.prototype.Qja=function(){return this.Yh?45:6};T.prototype.nB=function(){return this.Yh?T.M7c:T.R7c};T.iXd=50;T.lXd=25;T.jXd=-85;T.mXd=-40;T.fXd=-120;T.gXd=-50;T.urb="copy";T.R7c=[6];T.M7c=[45];Object(ie.a)(T,"DragSelectionClickBehavior",Z,[]);Am(M,Z);M.prototype.dispose=function(){this.ha&&(this.ha.B7(this.Fp),this.ha.qX(this.wh),this.ha.xKd(this.rPa),this.ha.xI(this.kd));if(this.Uh)for(var V=
1;4>=V;V++)le.DOMElementExtensions.Af(this.Uh[V.toString()]);this.Uh=this.Nh=null;Z.prototype.dispose.call(this)};M.prototype.Aqb=function(V){V&&(this.Yh&&Kf.g(this.$).rg.No($d.a.k5),this.jq=!1);for(V=1;4>=V;V++){var ya=this.Uh[V.toString()];ya&&ya.parentNode.removeChild(ya);this.Uh[V.toString()]=null}this.Nh=null};M.prototype.Ecc=function(){return this.ha.ta.ud};M.prototype.zL=function(){this.ha.updateSelection(this.Jb,this.Jb.topLeft,0);return!0};M.prototype.PD=function(V){V=void 0===V?!1:V;this.Cb.vj(this.Jb,
this.nB());this.Cb.Gn(this.nB());this.QB(V);return!0};M.prototype.TL=function(V){V=void 0===V?!1:V;this.Cb.vj(this.Jb,this.Nh);this.Cb.Gn(this.Nh);this.QB(V)};M.prototype.gub=function(){Rb.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};M.prototype.iBc=function(){return!1};M.prototype.PB=function(V,ya,lb,Kb,Lb){Lb=void 0===Lb?!1:Lb;var Xa=le.DOMElementExtensions.getBoundingClientRect(ya),od=ya===this.ds[Z.$Ia]||
ya===this.ds[Z.P7c];if(this.Yh){var Yd=ya===this.ds[Z.Q7c]||ya===this.ds[Z.ZIa];this.isRow&&Yd||this.ff&&od?Yd="100px":(od=this.isRow||od,Yd=(od?Lb?M.gXd:M.mXd:Lb?M.fXd:M.jXd)+"px");ya=od?ya===this.ds[Z.$Ia]?"top":"bottom":ya===this.ds[Z.ZIa]?"right":"left";V=100*(od?V.x-Xa.x:V.y-Xa.y)/(od?Xa.width:Xa.height);for(Xa=1;4>=Xa;Xa++){Kb=document.createElement("div");var ke=document.createElement("div"),Yf=document.createElement("div");Kb.appendChild(ke);Kb.appendChild(Yf);Lb&&(ke=document.createElement("div"),
Kb.appendChild(ke),Yf.style.fontWeight="bold");Kb.className=ca.TRe;this.Uh[Xa.toString()]=Kb;this.Cb.Jw(lb,Xa).Of.appendChild(Kb);Kb=this.Uh[Xa.toString()];Kb.style[ya]=Yd;Kb.style[od?"left":"top"]=V+"%"}}else for(Lb=(od?-M.lXd:-M.iXd)+"px",Yd=od?ya===this.ds[Z.$Ia]?"top":"bottom":ya===this.ds[Z.ZIa]||Kb?"right":"left",ya=100*(od?Kb?0:V.x-Xa.x:V.y-Xa.y)/(od?Xa.width:Xa.height),V=1;4>=V;V++)Xa=document.createElement("div"),Xa.className=ca.SRe,this.Uh[V.toString()]=Xa,this.Cb.Jw(lb,V).Of.appendChild(Xa),
Xa=this.Uh[V.toString()],Xa.style[Yd]=Lb,Xa.style[od?"left":"top"]=ya+"%"};M.prototype.beg=function(V,ya,lb){var Kb=Kf.g(this.$),Lb=Kb.qg(V),Xa=Kb.Tf(this.paneType);lb=Ng.a.Es(Xa.view.Pg,this.domElement.parentNode,lb,Kb.rtl);Xa=!1;var od=2;ya&&lb.y-Lb.topLeft.y>Lb.height/2?(Xa=!0,od=1):!ya&&lb.x-Lb.topLeft.x>Lb.width/2&&(Xa=!0);if(Xa){ya=Kb.wk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Kb.yH,od);try{ya.us(V),ya.$$mn(),ya.$$cu()}finally{ya&&ya.dispose()}}};M.prototype.hta=function(V){this.Cb.Xh(this.Nh);
this.Ys(this.$K,this.aL,void 0,V)};M.prototype.Qja=function(){return this.Yh?45:6};M.prototype.nB=function(){return this.Yh?M.M7c:M.R7c};M.iXd=50;M.lXd=25;M.jXd=-85;M.mXd=-40;M.fXd=-120;M.gXd=-50;M.R7c=[6];M.M7c=[45];Object(ie.a)(M,"DragSelectionClickBehaviorTemporary",Z,[]);Am(A,M);A.prototype.dispose=function(){this.ju&&this.Woa();this.Yh&&this.ku&&this.Woa(1);M.prototype.dispose.call(this)};A.prototype.woc=function(V){this.Yh&&(this.Zw=V,this.dA=null,this.Qq=this.isRow=this.ff=this.Rq=!1,vh.KeyInputManager.instance.pa(lf.a.Xb,
this.domElement.ownerDocument.body,this.onKeyDown));this.jq=!0;this.tableRange=this.k_c(this.tableManager.tn(this.sourceRange.topLeft));Kf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Yh?(this.dA=this.tableRange,this.Qn=1,this.Nh=(this.Qq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Ly(this.$K,this.aL),this.PM=this.Ria,this.QO=this.doa,this.PB(V.clientPoint,V.Mb,this.Qq?11:12,!0,!0),this.TL(!0)):
(this.Nh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.pj=6,this.Ly(this.$K,this.aL),this.PB(V.clientPoint,V.Mb,this.isRow?11:12,!0)):(this.tableRange=null,this.Yh?(this.isRow=this.sourceRange.isRow,this.ff=this.sourceRange.ff,this.isRow||this.ff?(this.Qn=3,this.KE=this.isRow?1:2,this.pj=6,this.Nh=this.isRow?[11]:[12],this.Ly(this.T6,this.U6),this.PM=this.Ria,this.QO=this.doa,this.PB(V.clientPoint,V.Mb,this.isRow?11:12,!0,
!0),this.TL(!0)):(this.Qn=2,this.KE=0,this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp")),this.PM=this.$sb,this.QO=this.rLb,this.PB(V.clientPoint,V.Mb,this.Qja(),!1,!0),this.PD(!0))):(this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp")),vh.KeyInputManager.instance.pa(lf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown),this.KE=this.sourceRange.isRow?1:this.sourceRange.ff?2:0,this.PB(V.clientPoint,V.Mb,this.Qja(),
!1),this.PD()))};A.prototype.aza=function(){this.jq=!1;this.Yh&&(this.Qn=0);this.Cb.Xh(this.nB());if(!this.$.Dq([this.Jb],!1))return this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp")),this.pj=-1,!0;if(this.ha.ta.ud.equals(this.Jb)||this.Oka(this.Jb)||this.Oka(this.sourceRange))this.pj=-1;else{this.zL();this.ha.sourceRange=this.sourceRange.clone();var V=this.ha.sourceRange,ya=this.ha.ta.ud;if(this.Yh){var lb={};this.$.Zd(-694765314,2,30,(lb[$d.a.uua]=this.ju,
lb[$d.a.s4]=V,lb[$d.a.r4]=ya,lb[$d.a.Xsb]=this.ku,lb))}else lb={},this.$.Zd(-694765314,2,30,(lb[$d.a.uua]=this.ju,lb[$d.a.s4]=V,lb[$d.a.r4]=ya,lb))}!this.Yh&&this.tableRange||this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"));this.Xud&&this.Wud();return!0};A.prototype.Aqb=function(V){V&&vh.KeyInputManager.instance.za(lf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown);M.prototype.Aqb.call(this,V)};A.prototype.yoc=function(V){var ya=this.ha.Xn(V.clientPoint,
V.Mb,5,void 0,void 0,!0);this.Zw=V;return this.oxb(ya)?(this.Jb=this.O$(ya),this.$wb(!0),!0):this.akd(ya)?(this.Jb=this.aia(ya),this.axb(!0),!0):!1};A.prototype.QB=function(V){V=void 0===V?!1:V;var ya=this.Jb.toString();if(this.Yh)for(var lb=1;4>=lb;lb++)this.Uh[lb.toString()].childNodes[0].innerText=ya,this.Uh[lb.toString()].childNodes[1].innerText=this.PM,V&&(this.Uh[lb.toString()].childNodes[2].innerText=this.QO);else for(V=1;4>=V;V++)this.Uh[V.toString()].innerText=ya};A.prototype.oxb=function(V){return!!this.dA&&
1!==this.Qn&&!!V&&this.dA.contains(V.topLeft)};A.prototype.akd=function(V){return!!this.dA&&1===this.Qn&&!!V&&!this.dA.contains(V.topLeft)};A.prototype.$wb=function(V){this.tableRange=this.dA;this.Qn=1;var ya=!this.ku;V?(this.hH(!1),this.Nh=this.Qq?[11]:[12],this.KHb(ya),this.TL(ya)):(this.G3(!1),this.x7(ya),this.PD(ya))};A.prototype.axb=function(V){this.tableRange=null;this.Qn=2;var ya=!this.ku;V?(this.hH(!1),this.Nh=this.Qq?[11]:[12],this.Rq=this.Qq,this.EQa(ya),this.TL(ya)):(this.hta(!1),this.x7(ya),
this.PD(ya))};A.prototype.Vxc=function(){if(!Kf.g(this.$).ha.ta.Lg)return!1;var V=Kf.g(this.$).getRangeInformation(this.ha.ta.ud);V=Cl(V);for(var ya=V.next();!ya.done;ya=V.next())if(Object(Wg.a)(Pg.PivotTableRange,ya.value))return!1;return!0};A.prototype.k_c=function(V){if(V&&V.contains(this.sourceRange)&&!V.equals(this.sourceRange)){if(V.yba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===V.top){var ya=new ue.Range(this.sourceRange.top,this.sourceRange.left,V.bottom,this.sourceRange.right,
!1,!1);if(!ya.equals(V))return this.sourceRange=ya,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),V}this.Yh?this.Qq=V.left===this.sourceRange.left&&V.right===this.sourceRange.right:this.isRow=V.left===this.sourceRange.left&&V.right===this.sourceRange.right;if(V.top===this.sourceRange.top&&V.bottom===this.sourceRange.bottom||this.uy())return V}return null};A.prototype.O$=function(V){var ya=V.clone();this.uy()?ya.left=Math.max(V.left-this.Iec,1):ya.top=Math.max(V.top-this.oDc,
1);ya.right=ya.left+this.sourceRange.width-1;ya.bottom=ya.top+this.sourceRange.height-1;return this.vZa(ya)};A.prototype.bAb=function(){var V=this.Jb.topLeft.Kd(this.sourceRange);return V||this.Yh&&!this.tableRange?V:this.uy()?this.Jb.top===this.sourceRange.bottom+1:this.Jb.left===this.sourceRange.right+1};A.prototype.ZHd=function(){if(this.uy()&&this.Jb.left!==this.tableRange.left||!this.uy()&&this.Jb.top!==this.tableRange.top){var V=Ag.a.gd(1,1,0,897,0,2065438552,"RearrangeInvalidDest");ig.a(this.$).Bs([V]);
return!0}return!1};A.prototype.DGd=function(){var V=this,ya=this.$.Ob.Hc("UserAction","RearrangeRowColumnClientSide"),lb={},Kb=(lb.CopyPasteTargetType=1,lb.OperationId=sj.a.create().toString(),lb.Stopwatch=ya,lb.DragDropIsShiftKeyDown=this.ku,lb.EncounteredDeploymentErrors=!1,lb),Lb=this.ju?2:1,Xa=this.$.da.Aa(254);(new Promise(function(od,Yd){V.bub(function(ke){ke.Errors&&0<ke.Errors.length?Yd(new Qg.a(22,ke.Errors)):od(!0)},function(ke){ke=ti.a.pg(ke.data);Yd(new Qg.a(22,ke))})})).then(function(){Rb.ULS.sendTraceTag(523638492,
0,50,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);Xa&&Xa.vnf(Kb,Lb,V.sourceRange,V.Jb);return Promise.resolve(!0)},function(od){Rb.ULS.sendTraceTag(523638491,0,10,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',od?copyPasteInfra.getStringifiedError(od):"null",1);return Xa?Xa.jCf(od,Kb,Lb,V.sourceRange,V.Jb):Promise.reject(od)})};A.prototype.bub=function(V,ya){function lb(){return new R(od,Xa)}function Kb(Yd,
ke,Yf){return Q(Lb.$.na.va,od,Xa,V?je.b(Yd,V):Yd,ya?je.a(ke,ya):ke,Yf,null)}var Lb=this;V=void 0===V?null:V;ya=void 0===ya?null:ya;var Xa={};this.uy()?(Xa.FirstRow=this.Jb.top-1,Xa.FirstColumn=0,Xa.DeltaColumn=0,Xa.DeltaRow=this.Jb.bottom-this.Jb.top+1):(Xa.FirstRow=0,Xa.FirstColumn=this.Jb.left-1,Xa.DeltaColumn=this.Jb.right-this.Jb.left+1,Xa.DeltaRow=0);Xa.LastRow=Oe.a.zy;Xa.LastColumn=Oe.a.yv;Xa.SheetName=this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;var od=
Ia.v(this.sourceRange,this.$);De.EwaSettings.qc()?this.$.userOperationManager.ic(new Bb.a(514,0,Kb,64,lb),null):this.$.userOperationManager.ic(new S.a(514,0,Kb,void 0,lb),null)};A.prototype.Oka=function(V){V=Kf.g(this.$).getRangeInformation(V);for(var ya=0,lb=V.length;ya<lb;++ya)if(Object(Wg.a)(Pg.PivotTableRange,V[ya]))return V=Ag.a.gd(1,0,0,892,0,2105176604,"InsDelCellsPivotTable"),ig.a(this.$).Bs([V]),!0;return!1};A.prototype.Woa=function(V){V=void 0===V?0:V;0===V?this.ju=!1:1===V&&(this.ku=!1);
this.Yh&&(this.ju||this.ku)||(vh.KeyInputManager.instance.za(lf.a.Sd,this.domElement.ownerDocument.body,this.onKeyUp),this.VMa=!1)};A.prototype.x7=function(V){V=void 0===V?!1:V;this.pj=5;this.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"));this.PM=this.$sb;this.QO=this.rLb;this.PB(this.Zw.clientPoint,this.Zw.Mb,this.Qja(),!1,V)};A.prototype.EQa=function(V){V=void 0===V?!1:V;this.pj=6;this.Ly(this.T6,this.U6);this.PM=this.Ria;this.QO=this.doa;this.PB(this.Zw.clientPoint,
this.Zw.Mb,this.isRow||this.Qq?11:12,!0,V)};A.prototype.KHb=function(V){V=void 0===V?!1:V;this.pj=6;this.Ly(this.$K,this.aL);this.PM=this.Ria;this.QO=this.doa;this.PB(this.Zw.clientPoint,this.Zw.Mb,this.uy()?11:12,!0,V)};A.prototype.Uka=function(V){return V.Ca.keyCode===md.a.H8||Da.a.isMac&&V.Ca.keyCode===md.a.epa};A.prototype.uy=function(){return!this.Yh&&this.isRow||this.Yh&&this.Qq};A.prototype.hH=function(V){this.Cb.Xh(this.nB());this.Ys(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,
this.Pf,"onPointerUp"),void 0,V)};A.prototype.G3=function(V){this.Cb.Xh(this.Nh);this.Ys(this.T6,this.U6,void 0,V)};A.prototype.Wud=function(){var V=Bf.a.instance.lc("Common.ISystemInitiatedFeedback");V&&V.execute(function(ya){ya.logActivity("DragDrop",null)})};A.urb="copy";Object(ie.a)(A,"DragSelectionClickBehaviorTableRange",M,[]);Am(C,M);C.prototype.woc=function(V){this.Zw=V;this.isRow=this.ff=!1;this.jq=!0;this.Gc=this.tableManager.Sva(this.sourceRange);Kf.g(this.$);Kf.g(this.$).rg.No(Z.k2a);
this.Bhi()&&(this.isRow=this.Zmi(),this.ff=this.dhi(),this.isRow||this.ff)&&(this.Nh=this.isRow?[11]:[12],this.pj=6,this.Ly(this.$K,this.aL),this.PB(V.clientPoint,V.Mb,this.isRow?11:12,!0,!1),this.Jb=this.O$(this.Jb),this.TL())};C.prototype.aza=function(){return!1};C.prototype.yoc=function(V){this.ha.Xn(V.clientPoint,V.Mb,5,void 0,void 0,!0);this.Zw=V;return!0};C.prototype.QB=function(){for(var V=1;4>=V;V++)this.Uh[V.toString()].childNodes[0].innerText=this.Jb.toString()};C.prototype.Vxc=function(){if(!Kf.g(this.$).ha.ta.Lg)return!1;
var V=Kf.g(this.$).getRangeInformation(this.ha.ta.ud);V=Cl(V);for(var ya=V.next();!ya.done;ya=V.next())if(Object(Wg.a)(Pg.PivotTableRange,ya.value))return!0;return!1};C.prototype.O$=function(V){V=V.clone();this.isRow?(V.left=this.sourceRange.left,V.right=this.Gc.right,V.bottom=V.top+this.sourceRange.height-1):this.ff&&(V.top=this.sourceRange.top,V.bottom=this.Gc.CX.bottom,V.right=V.left+this.sourceRange.width-1);return this.vZa(V)};C.prototype.Bhi=function(){return this.Jb.left>=this.Gc.CX.left&&
this.Jb.right<=this.Gc.IM.right&&this.Jb.top>=this.Gc.IM.top&&this.Jb.bottom<=this.Gc.CX.bottom};C.prototype.Zmi=function(){return this.Gc.CX.top<=this.Jb.top&&this.Gc.CX.left<=this.Jb.left&&this.Gc.CX.right>=this.Jb.left};C.prototype.dhi=function(){return this.Gc.IM.top==this.Jb.top&&this.Gc.IM.left<=this.Jb.left&&this.Gc.IM.right>=this.Jb.right};Object(ie.a)(C,"DragSelectionClickBehaviorPivotTableRange",M,[]);Am(v,I);v.prototype.dispose=function(){eg.a.instance.za(lf.a.pointerDown,this.Uaa,this.onPointerDown);
Jb.a.instance.za(lf.a.jk,this.Uaa,this.Oca);this.gridView.$&&(this.gridView.ha.B7(this.Fp),this.gridView.ha.qX(this.wh),this.gridView.$.Ul(this.zd),this.gridView.$.zb.Ctc(this.Z6),this.gridView.$.zb.Btc(this.Y6),this.gridView.MQf(this.pEb),this.gridView.Ac.kl(this.azf),this.gridView.Ac.Zn(this.$yf));I.prototype.dispose.call(this)};Object(ie.a)(v,"FillHandleClickBehavior",I,[]);Am(B,fa);Ck.Object.defineProperties(B.prototype,{cwa:{configurable:!0,enumerable:!0,get:function(){return this.gqg}}});B.lye=
[1,2,32,256,128,64];Object(ie.a)(B,"IPadSelectionClickThroughBehavior",fa,[]);u.prototype.dispose=function(){this.gridView.ha.B7(this.Fp);this.gridView.ha.qX(this.wh);this.gridView.ha.xKd(this.wh)};u.prototype.uAa=function(){this.R5a=0;this.ihc=!1;this.i6=Number.NaN};u.prototype.a$e=function(V){this.gCc(V.Mb,1);return!0};u.prototype.b$e=function(V){this.gCc(V.Mb,-1);return!0};u.prototype.CKe=function(V){this.ihc=!0;this.gCc(V,1)};u.prototype.DKe=function(V){this.ihc=!1;this.gCc(V,-1)};u.prototype.gCc=
function(V,ya){if(V)if(V.parentNode)if(this.Spd)isNaN(this.i6)||(this.tCc(this.i6,!1),this.i6=Number.NaN);else if(V=parseInt(V.parentNode.getAttribute($d.a.ryb),10),isNaN(V))Rb.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.i6)&&V!==this.i6){if(this.ihc)return;this.tCc(this.i6,!1)}if(isNaN(this.i6)||V!==this.i6)this.i6=V,this.R5a=0;!this.R5a&&0<ya&&this.tCc(V,!0);this.R5a=Math.max(this.R5a+ya,0);!this.R5a&&
0>ya&&(this.tCc(V,!1),this.i6=Number.NaN)}else Rb.ULS.shipAssertTag(537159367,0,!!V.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else Rb.ULS.shipAssertTag(537159368,0,!!V,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};u.prototype.tCc=function(V,ya){for(var lb=1;4>=lb;lb++){var Kb=this.gridView.Cb.Jw(3,lb,V).Of;le.DOMElementExtensions.toggleCssClass(Kb,ca.Uwh,ya);for(Kb=Kb.firstChild;Kb;Kb=Kb.nextSibling)yg.a.contains(Kb.className,"resizemarqueehandle",
!0)&&le.DOMElementExtensions.toggleCssClass(Kb,ca.Ywh,ya)}};Object(ie.a)(u,"MarqueeHoveringManager",null,[]);var qh=b(1034),fi=b(1312);Am(t,fa);t.prototype.dispose=function(){eg.a.instance.za(lf.a.dX,this.rK,this.HBf);eg.a.instance.za(lf.a.Iy,this.rK,this.Sca);eg.a.instance.za(lf.a.pointerDown,this.rK,this.onPointerDown);zh.a.instance.za(lf.a.click,this.rK,this.UEb);zh.a.instance.za(lf.a.jk,this.rK,this.onDoubleClick);le.DOMElementExtensions.Af(this.PH);this.PH=null;le.DOMElementExtensions.Af(this.rK);
this.sv=this.rK=null;fa.prototype.dispose.call(this)};t.prototype.uZa=function(V){this.sv=Object(Xf.a)(fi.a,V.metadata)};Object(ie.a)(t,"RangeCatchUpActivityHighlightBehavior",fa,[]);Am(x,L);x.prototype.CSa=function(){return(this.gridView.inRangePicker||this.gridView.Ni)&&L.prototype.CSa.call(this)};Ck.Object.defineProperties(x.prototype,{u5:{configurable:!0,enumerable:!0,get:function(){return 16}},Rcb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.Hdd(!1)}}});Object(ie.a)(x,
"RangePickerTouchGrippiesBehavior",L,[]);Am(r,fa);Object(ie.a)(r,"RearrangeHighlightBehavior",fa,[]);var $h;(function(V){V[V.topLeft=0]="topLeft";V[V.topRight=1]="topRight";V[V.bottomLeft=2]="bottomLeft";V[V.bottomRight=3]="bottomRight";V[V.error=4]="error"})($h||($h={}));Object(ie.b)("Corner",$h);Am(y,fa);y.prototype.dispose=function(){var V=this;this.sL.forEach(function(ya){eg.a.instance.za(lf.a.pointerDown,ya,V.onPointerDown)});Array.clear(this.sL);fa.prototype.dispose.call(this)};y.prototype.uZa=
function(V){this.Aba=V;this.Ope(V);this.so.WKb(V,this.sL,this.jSd());this.yy.uAa()};y.prototype.Sh=function(V){V=Zf.a(this.$).qe(V);V=this.e1e(V,!1);if(!V)return!0;V=this.hFe(V);if(!V)return Rb.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.r$b(!0),!1;if(this.Jb.equals(V))return!0;this.Jb=V;V=this.PD();V||(Rb.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.r$b(!0));return V};y.prototype.Pf=
function(V){var ya=this;V=Zf.a(this.$).qe(V);V=this.zL();Rb.ULS.shipAssertTag(537159325,0,V,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");Da.a.vB&&(this.ha.Vec(!0),window.setTimeout(function(){ya.ha.Vec(!1)},100));this.r$b(!V);return V};y.prototype.e1e=function(V,ya){var lb=V.Mb;V=V.clientPoint;if(!lb||!V)return Rb.ULS.shipAssertTag(537159324,0,!!lb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Rb.ULS.shipAssertTag(537159323,0,!!V,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),
null;ya&&(V=this.Grf(V));ya=this.ha.Xn(V,lb,0,!0,!1,!0);ya||(V=this.Grf(V),ya=this.ha.Xn(V,lb,0,!0,!1,!0));return ya};y.prototype.Grf=function(V){V.y+=0===this.a4||1===this.a4?2:-2;V.x+=0===this.a4||2===this.a4?2:-2;return V};y.prototype.hFe=function(V){if(!V||!this.sourceRange)return Rb.ULS.shipAssertTag(537159322,0,!!V,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),Rb.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.a4)return new ue.Range(V.top,V.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.a4)return new ue.Range(V.top,this.sourceRange.left,this.sourceRange.bottom,V.right,!0,!1);if(2===this.a4)return new ue.Range(this.sourceRange.top,V.left,V.bottom,this.sourceRange.right,!0,!1);if(3===this.a4)return new ue.Range(this.sourceRange.top,this.sourceRange.left,V.bottom,V.right,!0,!1);Rb.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",
$h[this.a4]);return null};y.prototype.zL=function(){return this.coloredReferencesManager.Frf(this.Ya,this.wL,this.Jb)};y.prototype.PD=function(){return this.zL()};y.prototype.r$b=function(V){V&&Rb.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.yy.DKe(this.sL[0]);this.so.ILf(!1,this.Aba.aaa);this.Ya.textBox.setCaretPositionToEnd();this.Ya.mtc(this.V6e);this.vcg();this.iTa=this.gridView.YLa=
!1;Di.b(this.$,!1);this.so.xNf()};Object(ie.a)(y,"ResizeMarqueeBehaviorBase",fa,[]);Am(h,y);h.prototype.$Tf=function(){return[ca.Lxh,ca.Mxh,ca.Jxh,ca.Kxh]};h.prototype.Fpe=function(){return[ca.Ixh]};h.prototype.t_e=function(V){V=V.Mb;if(V===this.sL[0])return 0;if(V===this.sL[1])return 1;if(V===this.sL[2])return 2;if(V===this.sL[3])return 3;Rb.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};h.prototype.ZOf=function(){this.so.Ly(Object(Re.a)(this,
this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"),!0)};h.prototype.vcg=function(){this.so.JYd(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"),!0)};h.prototype.M2f=function(V){return 2===(Ud.a.Vb=V.yb)&&V.Vn===Sys.UI.MouseButton.leftButton};h.prototype.jSd=function(){return!0};h.prototype.Lnf=function(){Rb.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};h.prototype.Ope=
function(V){for(var ya=Cl(this.sL),lb=ya.next();!lb.done;lb=ya.next())lb.value.style.backgroundColor=V.Of.style.borderColor};Object(ie.a)(h,"ResizeMarqueeMouseBehavior",y,[]);Am(w,y);w.prototype.dispose=function(){Ud.a.lRf(this.PEb);y.prototype.dispose.call(this)};w.prototype.$Tf=function(){return[Wc.a.Mwh,Wc.a.Lwh]};w.prototype.Fpe=function(){var V=De.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),ya=Da.a.xf;V=!V||ya;return[V?Wc.a.LRe:Wc.a.KRe,Wc.a.o9b,V?Wc.a.Kwh:Wc.a.n9b]};w.prototype.t_e=
function(V){V=V.Mb;if(V===this.sL[0])return 0;if(V===this.sL[1])return 3;Rb.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};w.prototype.ZOf=function(){Da.a.vv?this.so.Ly(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"),!1):this.so.l9i(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"))};w.prototype.vcg=function(){Da.a.vv?this.so.JYd(Object(Re.a)(this,
this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"),!1):this.so.XPj(Object(Re.a)(this,this.Sh,"onPointerMove"),Object(Re.a)(this,this.Pf,"onPointerUp"))};w.prototype.M2f=function(V){return 3===(Ud.a.Vb=V.yb)};w.prototype.jSd=function(){return 3===Ud.a.Vb};w.prototype.Lnf=function(){Rb.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};w.prototype.Ope=function(){};Object(ie.a)(w,"ResizeMarqueeTouchBehavior",
y,[]);Am(n,fa);n.Erb=function(V,ya){var lb=document.createElement("div");lb.className=ya;V.appendChild(lb)};Object(ie.a)(n,"SelectionCutCopyBehavior",fa,[]);Am(m,fa);Object(ie.a)(m,"SelectionPasteBehavior",fa,[]);Am(f,fa);f.Urb=function(V,ya){var lb=document.createElement("div");lb.className=ya;V.appendChild(lb)};Object(ie.a)(f,"SelectionRangePickerBehavior",fa,[]);Am(e,L);e.prototype.CSa=function(){var V=this.gridView.Ni||this.gridView.isEditing;return this.gridView.ha.ta.Lg&&!V&&L.prototype.CSa.call(this)};
Ck.Object.defineProperties(e.prototype,{u5:{configurable:!0,enumerable:!0,get:function(){return 0}},Rcb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.ta.ud}}});Object(ie.a)(e,"SelectionTouchGrippiesBehavior",L,[]);var Fi=Qf.a;Am(c,Fi);c.prototype.dispose=function(){this.gridView.Cb.ocj(this.$ob);this.yy&&(this.yy.dispose(),this.yy=null);Fi.prototype.dispose.call(this)};Object(ie.a)(c,"GridHighlightsBehaviorManager",Qf.a,[]);var di=df.a;Am(a,di);a.prototype.create=function(){var V=
this;Lc.TaskExtensions.Ba(ic.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),function(ya){V.Eb(V.$.da.Aa(64)||new c(V.$,ya.result))},this.la,3)};a.ka=function(V){V.da.Ga(149,new a(V))};Object(ie.a)(a,"GridHighlightsBehaviorManagerFactory",df.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");
Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");Jf.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.NewAndOpen.Core");Ce.a.instance.hj(new vb);Hd.a.Li('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
Hd.a.Li('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:-webkit-focus-ring-color auto 1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text{margin:1px}.tab-anchor-text:focus-visible{outline:-webkit-focus-ring-color auto 1px;margin:1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
Hd.a.Li(".ewa-svg-icon{height:100%;width:100%}");Hd.a.Li(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
Gg.a.Fa(sd.ka);xd.a.el.Ga(141,new Sc);Gg.a.Fa(oc.ka);(function(){Gg.a.Fa(function(V){Xe.ka(V);De.EwaSettings.Fb()?Qc.ka(V):de.ka(V);he.ka(V);nd.ka(V)})})();Gg.a.Fa(bb.ka);Gg.a.Fa(Ed.ka);(function(){Gg.a.Fa(function(V){V.da.Ga(134,new Ib(V));V.da.Ga(330,new ub(V))})})();Gg.a.Fa(yd.ka);(function(){Gg.a.Fa(function(V){gb.ka(V);Ya.ka(V)})})();Type.registerNamespace("Common.App.SessionExpiration");Gg.a.Fa(xa.ka);Gg.a.Fa(a.ka);Gg.a.Fa(ha.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/cdc26c00fefd42845d9b9f642449ddd6/EwaDS.acc.js.map