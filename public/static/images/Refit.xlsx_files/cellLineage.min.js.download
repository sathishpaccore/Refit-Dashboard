var cellLineage=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[10],{1780:function(e,t,i){"use strict";i.r(t);var n=i(1),o=i(59),a=i(60),r=i(221),s=function(){function e(){var e=this;this._initialLatestId=0,this._initialOldestId=0,this._latestActivityIdProcessed=this._initialLatestId,this._oldestActivityIdProcessed=this._initialOldestId,this._lineageActivities=[],this.evictActivitiesFromTop=function(t){if(e._latestActivityIdProcessed===t)return!1;var i=e._lineageActivities,n=[];i.forEach((function(e){e.activityId<=t&&n.push(e)})),e._lineageActivities=n,e.updateBounds(e._oldestActivityIdProcessed,t);var s=0===e._lineageActivities.length;return o.a.sendTraceTag(575533843,a.a.msoulscat_ES_EWAJS,r.a.Info,JSON.stringify({msg:"LineageActivityCache.evictActivitiesFromTop: Evicting activities from top.",latestActivityId:s?0:e._lineageActivities[0].activityId,oldestActivityId:s?0:e._lineageActivities[e._lineageActivities.length-1].activityId,latestActivityIdProcessed:e._latestActivityIdProcessed,oldestActivityIdProcessed:e._oldestActivityIdProcessed})),i.length!==e._lineageActivities.length},this.evictActivitiesFromBottom=function(t){if(e._oldestActivityIdProcessed===t)return!1;var i=e._lineageActivities,n=[];i.forEach((function(e){e.activityId>=t&&n.push(e)})),e._lineageActivities=n,e.updateBounds(t,e._latestActivityIdProcessed);var s=0===e._lineageActivities.length;return o.a.sendTraceTag(575533844,a.a.msoulscat_ES_EWAJS,r.a.Info,JSON.stringify({msg:"LineageActivityCache.evictActivitiesFromBottom: Evicting activities from bottom.",latestActivityId:s?0:e._lineageActivities[0].activityId,oldestActivityId:s?0:e._lineageActivities[e._lineageActivities.length-1].activityId,latestActivityIdProcessed:e._latestActivityIdProcessed,oldestActivityIdProcessed:e._oldestActivityIdProcessed})),i.length!==e._lineageActivities.length},this._maxActivitiesInCache=0,this.initializeCache()}return e.prototype.isSafeForAppend=function(e){return 0===this._oldestActivityIdProcessed||this._oldestActivityIdProcessed===e+1||(o.a.sendTraceTag(544814680,a.a.msoulscat_ES_EWAJS,r.a.Warning,"LineageActivityCache.isSafeForAppend: Latest searched activity id in response does not align with the oldest processed activity id in cache."),!1)},e.prototype.appendActivitiesAndUpdateBounds=function(e,t,i){this.appendActivities(e);var n=t,o=0===this.getLatestId()?i:this.getLatestId();this.updateBounds(n,o)},e.prototype.appendActivities=function(e){o.a.sendTraceTag(590485195,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityCache.appendActivities called.");var t=this.createFinalActivityList(e);this._lineageActivities=this._lineageActivities.concat(t),this._maxActivitiesInCache=Math.max(this._lineageActivities.length,this._maxActivitiesInCache)},e.prototype.updateBounds=function(e,t){this._oldestActivityIdProcessed=e,this._latestActivityIdProcessed=t},e.prototype.isSafeForPrepend=function(e){return 0===this._latestActivityIdProcessed||this._latestActivityIdProcessed+1===e||(o.a.sendTraceTag(544814681,a.a.msoulscat_ES_EWAJS,r.a.Warning,"LineageActivityCache.isSafeForPrepend: Oldest searched activity id in response does not align with the latest processed activity id in cache."),!1)},e.prototype.prependActivitiesAndUpdateBounds=function(e,t,i){this.prependActivities(e);var n=i,o=0===this.getOldestId()?t:this.getOldestId();this.updateBounds(o,n)},e.prototype.prependActivities=function(e){o.a.sendTraceTag(590485197,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityCache.prependActivities called.");var t=this.createFinalActivityList(e);this._lineageActivities=Object(n.__spreadArray)(Object(n.__spreadArray)([],t,!0),this._lineageActivities,!0),this._maxActivitiesInCache=Math.max(this._lineageActivities.length,this._maxActivitiesInCache)},e.prototype.updateLastSearchedTimestamp=function(e){isNaN(e.getTime())||(this._lastSearchedTimestamp=e)},e.prototype.updateLineageActivitiesUpdateResponse=function(e,t,i){this._lineageActivities=[],null!=e&&(this.appendActivities(e),this.updateBounds(t,i))},e.prototype.getActivities=function(){return this._lineageActivities},e.prototype.getOldestId=function(){return this._oldestActivityIdProcessed},e.prototype.getLatestId=function(){return this._latestActivityIdProcessed},e.prototype.getLastSearchedTimestamp=function(){return this._lastSearchedTimestamp},e.prototype.getMaxActivitiesInCache=function(){return this._maxActivitiesInCache},e.prototype.resetCache=function(){this.initializeCache()},e.prototype.initializeCache=function(){this._latestActivityIdProcessed=this._initialLatestId,this._oldestActivityIdProcessed=this._initialOldestId,this._lastSearchedTimestamp=void 0,this._lineageActivities=[],this._maxActivitiesInCache=0},e.prototype.createFinalActivityList=function(e){var t=this,i=[];return null!=e&&e.forEach((function(e){if(null!=e)if(25===e.activityType){var o=[];t.flattenNestedActivity(e,o),o.reverse(),i=Object(n.__spreadArray)(Object(n.__spreadArray)([],i,!0),o,!0)}else i.push(e)})),i},e.prototype.flattenNestedActivity=function(e,t){var i=this;25===e.activityType?e.nestedActivityList.forEach((function(e){null!=e&&i.flattenNestedActivity(e,t)})):t.push(e)},e}(),l=i(0),c=i(3);var d,p,h,u,g=i(41),v=i(549),m=i(169),y=i(625),C=i(13),f=i(1310),A='-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',b={root:{color:"#107C41",cursor:"pointer",fontFamily:A,fontSize:"12px",fontWeight:600,height:"22px",paddingLeft:"5px",paddingRight:"5px",width:"fit-content"},rootPressed:{color:"#0C5F32"},rootHovered:{color:"#0F703B"},rootFocused:{color:"#107C41"},label:{margin:"0px"}},E={details:{padding:"0px 5px 0px 5px"},primaryText:{fontWeight:600,fontFamily:A,fontSize:"14px",color:"rgb(37, 36, 35)",lineHeight:"18px",userSelect:"text"}},S={backgroundColor:"#ffffff",boxShadow:"0px 2px 2px 0px rgba(0, 0, 0, 0.04)",marginBottom:16,maxWidth:"236px",overflow:"hidden",padding:"12px",borderRadius:"4px",selectors:{":focus-within":{outline:"unset",padding:"10px",border:"2px solid #217346",boxShadow:f.a.depth8},":hover":{boxShadow:f.a.depth8}}},x={marginRight:"6px",float:"left",userSelect:"text",lineHeight:"14px",paddingTop:"2px"},_={overflow:"auto"},I={color:"#252423",cursor:"text",float:"left",fontFamily:A,fontSize:"12px",fontWeight:600,lineHeight:"16px",userSelect:"text",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},L={fontFamily:A,fontSize:"12px",overflowWrap:"break-word",userSelect:"text",cursor:"text",lineHeight:"16px",padding:"0px 2px"},F={root:{paddingLeft:"5px"},activityContent:{width:"90%",paddingLeft:"6.5px"},activityTypeIcon:{margin:"0px",height:"14px",paddingTop:"2px"}},R=Object(C.c)((function(e,t){var i;return{itemParentCard:Object(c.db)([S]),itemActivityVerb:Object(c.db)([I],{color:"#605E5C",fontFamily:A,maxWidth:"90%",paddingRight:"4px"}),itemSheetName:Object(c.db)([I],{maxWidth:"45%",paddingRight:"4px"}),itemGridLocation:Object(c.db)([I],{padding:"0px 2px"}),boxHighlightCardGridLocation:Object(c.db)([I],{backgroundColor:t?"#FFF4CE":e?"#CAEAD8":"#EDEBE9",borderRadius:"2px",maxWidth:"55%"}),itemMoveSheetName:Object(c.db)([I],{maxWidth:"35%",paddingRight:"4px"}),itemMoveGridLocation:Object(c.db)([I],{maxWidth:"35%",padding:"0px 2px",borderRadius:"2px"}),itemGreyBackgroundCard:Object(c.db)([S,{backgroundColor:"#F3F2F1"}]),itemRightArrowIcon:Object(c.db)({float:"left",display:"inline",padding:"2px 4px 2px 4px",height:"12px",width:"12px"}),itemDegradedCardExplanationText:Object(c.db)({fontSize:"11px",color:"#605E5C",left:"38px"}),itemDegradedCardExplanationTextAndIconContainer:Object(c.db)({paddingTop:"10px"}),itemPersonaStack:Object(c.db)({paddingBottom:"8px"}),itemActivityIcon:Object(c.db)({height:"14px",width:"14px"}),itemDegradedIcon:Object(c.db)({padding:"1px 3px 1px 3px"}),itemDegradedExplanationIcon:Object(c.db)({height:"12px",width:"12px",color:"#605E5C",lineHeight:"12px",fontSize:"12px",padding:"2px 4px 2px 4px",left:"25%",right:"0%"}),itemPrevValueUnavailableIcon:Object(c.db)({height:"12px",width:"12px",padding:"1px 5px 0px 4px",selectors:{svg:{fill:"#605E5C"}}}),itemShowChangesDiv:Object(c.db)({margin:"0px -12px",paddingBottom:"6px",boxShadow:"rgba(0, 0, 0, 0.133) 0px 2.3px 2.3px 0px, rgba(0, 0, 0, 0.11) 0px 0.1px 0.3px 0px"}),itemCellValueStyle:Object(c.db)({color:"#252423",fontFamily:A,fontSize:"12px",height:"18px",lineHeight:"18px",margin:"0px",userSelect:"text",paddingTop:"8px",paddingLeft:"2px"}),singleValueChangeComponent:Object(c.db)({paddingLeft:"23px",overflow:"auto",maxHeight:"240px",lineHeight:"16px"}),valuesListContainer:Object(c.db)({overflow:"auto",maxHeight:"240px",paddingLeft:"23px"}),bulkEditOverflowContainer:Object(c.db)({padding:"22px 20px 0px 10px",textAlign:"center"}),bulkEditOverflowIcon:Object(c.db)({paddingBottom:"6px",height:"20px",width:"20px",selectors:(i={},i.svg={fill:"#212121"},i)}),newPrevValueContainer:Object(c.db)({borderBottom:"1px solid #e6e6e6",paddingBottom:"4px",width:"inherit",lineHeight:"16px"}),newValueContainer:Object(c.db)([_]),prevValueContainer:Object(c.db)([_]),itemNewValueIcon:Object(c.db)([x,{color:""}]),itemPrevValueIcon:Object(c.db)([x,{color:"#605E5C"}]),itemNewValueText:Object(c.db)([L,{color:"#00000"}]),itemPrevValueText:Object(c.db)([L,{color:"#605E5C"}]),itemVerticalLine:Object(c.db)({borderLeft:"1px dashed",marginLeft:"6.5px",marginRight:"6.5px",top:"16px",height:"calc(100% - 5px)",position:"absolute",color:"#d9d9d9"})}})),w=i(473),P=i(512),T=i(61),k=i(1102),B=i(155),D=i(1211),O=i(45),V=i(521),M=i(871),H=i(1235),N=Object(C.c)((function(){return{itemFriendlyDate:Object(c.db)({color:"#605E5C",fontFamily:'-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',fontSize:"12px",height:"16px",marginLeft:"auto !important",maxWidth:"100px",padding:"1px 0px 0px 4px",userSelect:"text",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"})}})),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){W.register(this)},t.prototype.componentWillUnmount=function(){W.unregister(this)},t.prototype.render=function(){var e=this.props.formatter(this.props.date);return l.createElement(M.a,{content:e,directionalHint:T.a.bottomAutoEdge,hostClassName:N().itemFriendlyDate,overflowMode:V.a.Self},e)},t}(l.PureComponent),W=new(function(){function e(){this.components=[]}return e.prototype.register=function(e){var t=this;this.components.push(e),void 0===this.timerId&&(this.timerId=window.setInterval((function(){return t.onTimerFired()}),6e4))},e.prototype.unregister=function(e){this.components=this.components.filter((function(t){return t!==e})),this.components.length||(window.clearInterval(this.timerId),this.timerId=void 0)},e.prototype.onTimerFired=function(){this.components.forEach((function(e){return e.forceUpdate()}))},e}()),j=i(78),G=i(48),z=i.n(G),J=i(20),q=i.n(J),Z=i(58),K=i.n(Z),X=i(5),Q=i.n(X),Y=function(e){function t(t){var i=e.call(this,t)||this;return i._fzRef=l.createRef(),i.onCardClicked=function(){i.props.onCardSelected(i.props.activity,void 0)},i.onKeyDown=function(e){var t,n=i.props.activity,o=i.hasMultipleEdits(n.valueChanges);e.which===O.a.right?(!i.props.isSelected&&i.props.onCardSelected(i.props.activity,void 0),null===(t=i._fzRef.current)||void 0===t||t.focus(),o&&i.setState({expandLineageActivityCard:!0})):e.which===O.a.left&&(e.currentTarget.focus(),o&&i.setState({expandLineageActivityCard:!1}))},i.onExpandClicked=function(){Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"SeeHideChangesButtonClicked"}]}),o.a.sendTraceTag(591734541,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityCard.onExpandClicked: See/Hide Changes clicked "),i.setState({expandLineageActivityCard:!i.state.expandLineageActivityCard})},i.fetchLocationTokensForMoveCards=function(e){var t=e.lastIndexOf("!");return{sheetName:e.substring(0,t),gridLocation:e.substring(t+1)}},i.renderActivityDescription=function(e,t){var n=i.props.activity;if(21===n.activityType){var o=n.valueChanges;if(null==o||null===o[0]||void 0===o[0])return;var a=o[0].hasNewValue?o[0].newValue:"",r=o[0].hasOldValue?o[0].oldValue:"";return i.renderMoveTypeCard(e,r,a,t)}var s=n.sheetName?n.sheetName:"",l=n.gridLocation?n.gridLocation:"";return i.renderSimpleCardDescription(e,s,l,t)},i.renderSingleValueChangeComponent=function(e,t,n){if(t)return l.createElement(w.a,{className:R().singleValueChangeComponent},n&&1===e.length&&l.createElement("p",{className:R().itemCellValueStyle}," ",e[0].cellLocation," "),i.renderSingleActivityValuePair(e[0],!1))},i.renderDegradedExplanationComponent=function(e){if(e)return l.createElement(w.a,{horizontal:!0,className:R().itemDegradedCardExplanationTextAndIconContainer},l.createElement(B.a,{iconName:"Info",className:R().itemDegradedExplanationIcon}),l.createElement(k.a,{className:R().itemDegradedCardExplanationText},ExcelRibbonStrings.ShowChangesDegradedCardInfo))},i.renderMultipleValueChangeComponent=function(e,t){var n=i.state.expandLineageActivityCard&&i.props.isSelected?ExcelRibbonStrings.ShowChangesButtonHideChanges:ExcelRibbonStrings.ShowChangesButtonSeeChanges,o=i.state.expandLineageActivityCard&&i.props.isSelected?ExcelRibbonStrings.ShowChangesCardStateExpanded:ExcelRibbonStrings.ShowChangesCardStateCollapsed;return l.createElement(w.a,{style:{marginTop:"6px"}},l.createElement("div",{style:{height:"16px"},className:i.state.expandLineageActivityCard?R().itemShowChangesDiv:""},l.createElement(P.a,{id:"expandDiv",onClick:i.onExpandClicked,styles:b,"aria-expanded":i.state.expandLineageActivityCard,style:{margin:i.state.expandLineageActivityCard?"0px 12px":"0px"}},n)),l.createElement("span",{"aria-label":o}),i.state.expandLineageActivityCard&&i.props.isSelected&&l.createElement("div",{className:R().valuesListContainer,"data-is-scrollable":!0},l.createElement(y.a,{items:e,onRenderCell:i.onRenderValue,onShouldVirtualize:i.onShouldVirtualize,role:"list"}),t&&l.createElement("div",{className:R().bulkEditOverflowContainer},l.createElement(B.a,{className:R().bulkEditOverflowIcon,iconName:z.a.InfoDynamicColor_16}),l.createElement(k.a,{block:!0,variant:"smallPlus",className:R().itemCellValueStyle},ExcelRibbonStrings.ShowChangesBulkEditOverflow))))},i.onShouldVirtualize=function(){return!0},i.onRenderValue=function(e){if(void 0!==e){var t=e.cellLocation;if(null!=t){return l.createElement(w.a,{role:"listitem",id:"valueChanges",className:R().newPrevValueContainer,onClick:function(e){e.stopPropagation(),i.props.onCardSelected(i.props.activity,t)}},l.createElement("p",{className:R().itemCellValueStyle}," ",t," "),i.renderSingleActivityValuePair(e,!0))}}},i.renderSingleActivityValuePair=function(e,t){if(null!=e){var n=e.newValue?e.newValue:"",s=e.oldValue?e.oldValue:"",c=!0;return e.hasOldValue?e.hasOldValue&&""===e.oldValue&&(c=!0):(o.a.sendTraceTag(591541205,a.a.msoulscat_ES_EWAJS,r.a.Warning,"LineageActivityCard.renderSingleActivityValuePair: Missing old value "),c=!1),l.createElement(w.a,null,l.createElement(w.a,{horizontal:!0,style:{marginTop:"6px",marginBottom:c?"6px":"0px",position:"relative"}},l.createElement(w.a,null,l.createElement(B.a,{className:R().itemNewValueIcon,iconName:"Location"}),c&&l.createElement("div",{"aria-hidden":!0,className:R().itemVerticalLine})),l.createElement("div",{className:R().newValueContainer},i.valueText(n,R().itemNewValueText,t))),c&&l.createElement(w.a,{horizontal:!0},l.createElement(B.a,{className:R().itemPrevValueIcon,iconName:"RadioBullet"}),l.createElement("div",{className:R().prevValueContainer},i.valueText(s,R().itemPrevValueText,t))))}},i.isActivityTypeNavigable=function(e){switch(e){case 6:case 14:case 13:case 19:case 18:case 20:return!1;default:return!0}},i.isHighlightLocationRange=function(e){if(null==e)return!1;if(0===e.length)return!1;if(1===e.length){var t=e[0];return null!=t&&(t.firstCol!==t.lastCol||t.firstRow!==t.lastRow)}return!0},i.onCardBlur=function(){i.setState({highlightCardGridLocation:!1})},i.onCardFocus=function(){i.setState({highlightCardGridLocation:!0})},i.state={expandLineageActivityCard:!1,highlightCardGridLocation:!1},i}return Object(n.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.expandLineageActivityCard&&!e.isSelected?{expandLineageActivityCard:!1}:null},t.prototype.processValueChangesArray=function(e){var t=[];return null!=e&&e.forEach((function(e){null!=e&&t.push(e)})),t},t.prototype.hasMultipleEdits=function(e){return null!=e&&e.length>1},t.prototype.renderMoveTypeCard=function(e,t,i,n){var o=V.a.Self,a=T.a.bottomAutoEdge,r=this.fetchLocationTokensForMoveCards(t),s=this.fetchLocationTokensForMoveCards(i);return l.createElement(l.Fragment,{key:1},l.createElement(M.a,{content:e,directionalHint:a,hostClassName:R().itemActivityVerb,key:2,overflowMode:o},e),l.createElement(M.a,{content:r.sheetName,directionalHint:a,hostClassName:R().itemMoveSheetName,key:3,overflowMode:o},r.sheetName),l.createElement(M.a,{content:r.gridLocation,directionalHint:a,hostClassName:R(this.state.highlightCardGridLocation,n).itemMoveGridLocation,key:4,overflowMode:o},r.gridLocation),l.createElement(B.a,{className:R().itemRightArrowIcon,key:5,iconName:Q.a.ArrowForward_20}),l.createElement(M.a,{content:s.sheetName,directionalHint:a,hostClassName:R().itemMoveSheetName,key:6,overflowMode:o},s.sheetName),l.createElement(M.a,{content:s.gridLocation,directionalHint:a,hostClassName:R(this.state.highlightCardGridLocation,n).itemMoveGridLocation,key:7,overflowMode:o},s.gridLocation))},t.prototype.renderSimpleCardDescription=function(e,t,i,n){var o=V.a.Self,a=T.a.bottomAutoEdge;return l.createElement(l.Fragment,{key:1},l.createElement(M.a,{content:e,directionalHint:a,hostClassName:R().itemActivityVerb,key:2,overflowMode:o},e),l.createElement(M.a,{content:t,directionalHint:a,hostClassName:R().itemSheetName,key:3,overflowMode:o},t),l.createElement(w.a,{horizontal:!0,key:4,className:R(this.state.highlightCardGridLocation,n).boxHighlightCardGridLocation},this.renderGridLocation(i),this.renderDegradedCardIcon(n)))},t.prototype.renderGridLocation=function(e){if(""!==e){var t=V.a.Self,i=T.a.bottomAutoEdge;return l.createElement(M.a,{content:e,directionalHint:i,overflowMode:t,hostClassName:R().itemGridLocation},e)}},t.prototype.renderDegradedCardIcon=function(e){if(e)return l.createElement(M.a,{content:ExcelRibbonStrings.ShowChangesDegradedCardIconWarning,directionalHint:T.a.bottomCenter,key:26},l.createElement(B.a,{className:R().itemDegradedIcon,iconName:"Info","data-is-focusable":"true"}))},t.prototype.valueText=function(e,t,i){var n=this.props.isSelected&&!i||this.state.expandLineageActivityCard&&i;return l.createElement(l.Fragment,null,l.createElement(k.a,{style:{whiteSpace:n?"pre-wrap":"nowrap"},className:t,"data-is-focusable":!0,block:!0,nowrap:!n,variant:"smallPlus"},e))},t.prototype.generateActivityInformationFromType=function(e){switch(e){case 10:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeEdit,hasAssociatedValueChange:!0,activityIcon:q.a.EditExcel_16,parentCardCss:R().itemParentCard};case 11:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeFullRowInsert,hasAssociatedValueChange:!1,activityIcon:Q.a.InsertRows_20,parentCardCss:R().itemParentCard};case 13:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeFullRowDelete,hasAssociatedValueChange:!1,activityIcon:Q.a.DeleteRows_20,parentCardCss:R().itemGreyBackgroundCard};case 15:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypePartialRowInsert,hasAssociatedValueChange:!1,activityIcon:Q.a.InsertCellsShiftDown_20,parentCardCss:R().itemParentCard};case 18:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypePartialRowDelete,hasAssociatedValueChange:!1,activityIcon:Q.a.DeleteCellsShiftUp_20,parentCardCss:R().itemGreyBackgroundCard};case 12:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeFullColInsert,hasAssociatedValueChange:!1,activityIcon:Q.a.InsertColumns_20,parentCardCss:R().itemParentCard};case 14:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeFullColDelete,hasAssociatedValueChange:!1,activityIcon:Q.a.DeleteColumns_20,parentCardCss:R().itemGreyBackgroundCard};case 16:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypePartialColInsert,hasAssociatedValueChange:!1,activityIcon:Q.a.InsertCellsShiftRight_20,parentCardCss:R().itemParentCard};case 17:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypePartialColInsertRTL,hasAssociatedValueChange:!1,activityIcon:Q.a.InsertCellsShiftRight_20,parentCardCss:R().itemParentCard};case 19:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypePartialColDelete,hasAssociatedValueChange:!1,activityIcon:Q.a.DeleteCellsShiftLeft_20,parentCardCss:R().itemGreyBackgroundCard};case 20:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypePartialColDeleteRTL,hasAssociatedValueChange:!1,activityIcon:Q.a.DeleteCellsShiftLeft_20,parentCardCss:R().itemGreyBackgroundCard};case 6:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeDeleteSheet,hasAssociatedValueChange:!1,activityIcon:Q.a.DeleteSheet_20,parentCardCss:R().itemGreyBackgroundCard};case 5:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeInsertSheet,hasAssociatedValueChange:!1,activityIcon:Q.a.InsertWorksheet_20,parentCardCss:R().itemParentCard};case 7:return{activityVerb:"SheetRename",hasAssociatedValueChange:!0,activityIcon:Q.a.InsertWorksheet_20,parentCardCss:R().itemParentCard};case 21:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeMove,hasAssociatedValueChange:!1,activityIcon:z.a.RangeDrag_32,parentCardCss:R().itemParentCard};case 22:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeSort,hasAssociatedValueChange:!1,activityIcon:Q.a?Q.a.SortUp_20:"",parentCardCss:R().itemParentCard};case 23:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeMergeCells,hasAssociatedValueChange:!1,activityIcon:K.a.MergeCells_20,parentCardCss:R().itemParentCard};case 24:return{activityVerb:ExcelRibbonStrings.ShowChangesActivityTypeUnmergeCells,hasAssociatedValueChange:!1,activityIcon:Q.a.SplitCells_20,parentCardCss:R().itemParentCard};default:return{activityVerb:"None",hasAssociatedValueChange:!1,activityIcon:"",parentCardCss:""}}},t.prototype.isDeletedLocationType=function(e){return(e&Be.DeletedLocation)===Be.DeletedLocation},t.prototype.render=function(){var e,t=this,i=this.props.activity,n=this.generateActivityInformationFromType(i.activityType),o=n.activityVerb,a=n.hasAssociatedValueChange,r=n.activityIcon,s=n.parentCardCss,c=i.valueChanges,d=this.hasMultipleEdits(c),p=this.processValueChangesArray(c),h=this.isActivityTypeNavigable(i.activityType),u=this.isHighlightLocationRange(null===(e=i.rangeHighlightLocation)||void 0===e?void 0:e.rangeList),g=this.isDeletedLocationType(i.degradedCardTypeBits);return g&&(s=R().itemGreyBackgroundCard),l.createElement("div",{ref:function(e){return t.props.setActivityCardRef(e,t.props.activity.activityGuid)},"data-is-focusable":!0,tabIndex:0,role:"option",onClick:this.onCardClicked,onKeyDown:this.onKeyDown,className:s,"aria-disabled":!h,"aria-selected":this.props.isSelected,onBlur:this.onCardBlur,onFocus:this.onCardFocus},l.createElement(v.a,{ref:this._fzRef,isCircularNavigation:!0,direction:m.a.vertical,handleTabKey:m.b.all,disabled:!this.props.isSelected},l.createElement(w.a,{horizontal:!0,className:R().itemPersonaStack},l.createElement("span",{"aria-label":ExcelRibbonStrings.ShowChangesCardRole}),i.author&&i.author.displayName&&l.createElement(H.a,{styles:E,coinSize:20,text:i.author.displayName,imageUrl:i.author.imageUrl?i.author.imageUrl:"",showInitialsUntilImageLoads:!0}),i.displayTimestamp&&!isNaN(i.displayTimestamp.getTime())&&l.createElement(U,{date:i.displayTimestamp,formatter:this.props.dateFormatter})),l.createElement(D.a,{key:i.activityId,styles:F,activityDescription:[this.renderActivityDescription(o,g)],activityIcon:l.createElement(B.a,{className:R().itemActivityIcon,iconName:r})}),!d&&this.renderSingleValueChangeComponent(p,a,u),d&&this.renderMultipleValueChangeComponent(p,!!i.isBulkEditOverflow&&i.isBulkEditOverflow),this.props.isSelected&&this.renderDegradedExplanationComponent(g)))},t}(l.Component),$=function(e){function t(t){var i=e.call(this,t)||this;return i._list=l.createRef(),i._activityGuidToCardHeightMap=new Map,i.measureItemHeight=function(e){if(0===i.props.activityList.length)return 0;var t=i.props.activityList[e];if((null==t?void 0:t.activityId)===Ue)return 0;var n=i._activityGuidToCardHeightMap.get(null==t?void 0:t.activityGuid);return void 0===n?(o.a.shipAssertTag(572327504,a.a.msoulscat_ES_EWAJS,!1,"LineageActivitySection.measureItemHeight: Card height not found in activityGuidToCardHeightMap"),0):n},i.onRenderLineageActivities=function(e,t){if(void 0!==e&&void 0!==t){if(e.activityId!==Ne)return e.activityId===Ue?l.createElement("div",{style:{borderTop:"1px solid #D2D0CE",width:"260px",marginTop:"20px",paddingBottom:"16px"}}):l.createElement(Y,{activity:e,isSelected:e.activityGuid===i.props.selectedActivityGuid,onCardSelected:i.props.onCardSelected,dateFormatter:i.props.dateFormatter,setActivityCardRef:i.setActivityCardRefs});i.props.onEOLSeen()}},i.setActivityCardRefs=function(e,t){if(e){var n=e.clientHeight+16;i._activityGuidToCardHeightMap.set(t,n)}},i.processActivityList=function(e){var t=[];return e.forEach((function(e){null!=e&&t.push(e)})),t},i}return Object(n.__extends)(t,e),t.prototype.getSnapshotBeforeUpdate=function(){return this._list.current&&this._list.current.forceUpdate(),null},t.prototype.componentDidUpdate=function(){if(this._list.current&&-1!==this.props.scrollToCardIndex){var e=this.props.separatorPosition===ke.Above?1:3;this._list.current.scrollToIndex(this.props.scrollToCardIndex,this.measureItemHeight,e)}},t.prototype.render=function(){var e=this.processActivityList(this.props.activityList);return l.createElement(v.a,{direction:m.a.vertical},l.createElement(y.a,{ref:this._list,items:e,onRenderCell:this.onRenderLineageActivities,renderedWindowsAhead:1,"aria-label":ExcelRibbonStrings.ShowChangesActivityList,role:"listbox"}))},t}(l.Component),ee=i(794),te=i(109),ie=i(635),ne=i(1245),oe=i(514),ae=i(1241),re=i(995),se=i(2103),le='-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',ce={root:{backgroundColor:"#FFFFFF",border:"1px solid #BEBBB8",boxSizing:"border-box",borderRadius:"2px",fontFamily:le,fontSize:"12px",fontWeight:"400",cursor:"pointer",height:"26px",minWidth:"110px",maxWidth:"160px",padding:"unset",marginTop:"15px"},rootHovered:{backgroundColor:"#F3F2F1"},rootPressed:{backgroundColor:"#C8C6C4"},rootFocused:{background:"#FFFFFF",borderColor:"1px solid #C8C6C4 !important"},rootDisabled:{background:"#EDEBE9",border:"1px solid #BEBBB8 !important"},label:{textAlign:"center",margin:"0px 4px"}},de={root:{background:"#FFFFFF",border:"1px solid #BEBBB8",boxSizing:"border-box",borderRadius:"2px",padding:"0px",position:"relative",height:"100%",minHeight:"26px",minWidth:"100px",maxWidth:"180px",fontSize:"12px",fontWeight:"600",fontFamily:le,cursor:"pointer",justifyContent:"center"},rootHovered:{backgroundColor:"#F3F2F1"},rootPressed:{backgroundColor:"#C8C6C4"},rootFocused:{backgroundColor:"#FFFFFF",borderColor:"1px solid #C8C6C4 !important"},rootDisabled:{background:"#EDEBE9",border:"1px solid #BEBBB8 !important"},label:{textAlign:"center",margin:"0px 10px"}},pe={root:{background:"#FFFFFF",border:"1px solid #BEBBB8",boxSizing:"border-box",borderRadius:"2px",padding:"0px",height:"100%",minHeight:"26px",minWidth:"120px",maxWidth:"180px",fontSize:"12px",fontWeight:"600",fontFamily:le,cursor:"pointer",marginTop:"14px",justifyContent:"center"},rootHovered:{backgroundColor:"#F3F2F1"},rootPressed:{backgroundColor:"#C8C6C4"},rootFocused:{backgroundColor:"#FFFFFF",borderColor:"1px solid #C8C6C4 !important"},rootDisabled:{background:"#EDEBE9",border:"1px solid #BEBBB8 !important"},label:{textAlign:"center",margin:"0px 10px"}},he={root:{backgroundColor:"#107C41",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.07)",border:"unset",color:"#FFFFFF",fontFamily:le,fontSize:"12px",borderRadius:"72px",position:"relative",height:"26px",minWidth:"100px",maxWidth:"210px",cursor:"pointer",fontWeight:"600",alignItems:"center",textAlign:"center",padding:"unset"},rootHovered:{backgroundColor:"#0F703B",color:"#FFFFFF",cursor:"pointer"},rootPressed:{backgroundColor:"#0C5F32",color:"#FFFFFF"},rootFocused:{backgroundColor:"#107C41",selectors:(d={},d[".ms-Button-flexContainer"]={border:"1px solid white",borderRadius:"72px"},d)},rootDisabled:{background:"#EDEBE9",border:"1px solid #BEBBB8 !important"},flexContainer:{height:"20px",margin:"2px",padding:"0 8px 0 8px"},label:{margin:"unset",display:"block",paddingBottom:"2px",maxWidth:"160px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden"},icon:{height:"16px",width:"16px",paddingRight:"8px"}},ue=Object(C.c)((function(e){return{UserMessageContainerStyle:Object(c.db)({width:"260px",marginTop:"28px",textAlign:"center",userSelect:"text"}),LoadMoreContainerStyle:Object(c.db)({width:"260px",textAlign:"center"}),UserMessageTitle:Object(c.db)({fontFamily:le,fontSize:"14px",fontWeight:"600",paddingTop:"20px",lineHeight:"28px",margin:"unset",userSelect:"text"}),UserMessageBody:Object(c.db)({fontFamily:le,fontSize:"12px",userSelect:"text",margin:"0px"}),UserMessageClearHistoryBody:Object(c.db)({fontFamily:le,fontSize:"12px",userSelect:"text",margin:"0px",display:"inline"}),UserMessageIllustrationStyle:Object(c.db)({paddingTop:"60px"}),RefreshButtonWrapperStyle:Object(c.db)({position:"absolute",zIndex:1,top:e?"96px":"78px",textAlign:"center",width:"260px"}),SpinnerStyle:Object(c.db)({width:"260px",paddingBottom:"5px"}),ShimmerStyle:Object(c.db)({backgroundColor:"#ffffff",boxShadow:f.a.depth4,width:"230px",padding:"15px",marginBottom:"16px",height:"60px",borderRadius:"4px"}),LearnMoreLinkStyles:Object(c.db)({color:"#107C41",fontSize:"12px",marginTop:"4px",selectors:{":hover":{color:"#0F703B"},":active":{color:"#0C5F32"},":focus":{color:"#0C5F32"}}})}})),ge={details:{padding:"0px 0px 0px 3px"},primaryText:{fontWeight:600,fontFamily:le,fontSize:"12px",color:"rgb(37, 36, 35)",lineHeight:"16px",userSelect:"text"},root:{display:"inline-flex",verticalAlign:"text-bottom"}},ve={root:{height:"25px",background:"#EDEBE9",padding:"0px 2px 0px 0px",minWidth:"fit-content",borderStyle:"none",verticalAlign:"top",marginTop:"-2px",marginRight:"1px",selectors:(p={":focus::after":{outline:"unset !important"}},p[c.m]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},p[c.n]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},p)},rootFocused:{backgroundColor:"unset",outline:"1px solid black"},rootHovered:{backgroundColor:"#E1DFDD",selectors:(h={},h[c.l]={backgroundColor:"ButtonFace",color:"ButtonText"},h)},rootExpanded:{background:"#E1DFDD"},rootExpandedHovered:{background:"#EDEBE9"},rootPressed:{backgroundColor:"#C8C6C4"},menuIcon:{fontSize:"8px",margin:"0px",height:"8px",width:"8px",lineHeight:"12px"},icon:{width:"16px",height:"16px",margin:"0px 2px"},flexContainer:{paddingLeft:"2px",width:"34px"}},me={root:{verticalAlign:"top",height:"25px",color:"black",marginTop:"-2px",background:"#107C41",border:"solid",borderRadius:"none",borderWidth:"thin",borderColor:"transparent",width:"25px",selectors:(u={},u[c.m]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},u[c.n]={selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"ButtonText !important"}}},u)},rootHovered:{backgroundColor:"#0F703B"},rootPressed:{backgroundColor:"#0C5F32"},rootFocused:{backgroundColor:"#0C5F32"},rootDisabled:{background:"#EDEBE9",border:"1px solid #C8C6C4 !important"},icon:{width:"14px",height:"14px"}},ye={root:{maxWidth:"160px",minWidth:"120px"}},Ce={root:{minWidth:"100px",maxWidth:"257px"},subComponentStyles:{callout:{},menuItem:{item:{width:"100%"}}}},fe=Object(C.c)((function(e,t,i){var n=e?"#a80000":"#C8C6C4";return{root:{width:i?"220px":"194px",fontSize:"14px"},wrapper:{},fieldGroup:{height:"25px",alignItems:"center",background:t?"#F3F2F1":"#FFFFFF",borderColor:n,borderRadius:i?"2px":"2px 0 0 2px",borderRight:i?"1px solid "+n:"none",selectors:{":hover":{border:e?"1px solid "+n:"1px solid #B3B0AD",borderRadius:i?"2px":"2px 0 0 2px",borderRight:i?"1px solid "+n:"none"},":focus":{border:"1px solid #A19F9D",borderRight:i?"1px solid #B3B0AD":"none"}}},field:{},description:{color:"#a80000",fontSize:"11px"}}})),Ae={color:"rgb(58, 58, 56)",fontSize:"14px",fontFamily:'-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',maxWidth:"210px",fontWeight:"600",display:"inline-block",verticalAlign:"top",overflow:"hidden",textOverflow:"ellipsis",padding:"0px 3px"},be=Object(C.c)((function(e){return{displayFilterTokenOneStyle:Object(c.db)([Ae],{maxWidth:e?"118px":"210px"}),displayFilterTokenTwoStyle:Object(c.db)([Ae],{maxWidth:"86px",marginLeft:"2px",borderRadius:"2px",backgroundColor:"#E1DFDD"}),filterParent:Object(c.db)({minHeight:"25px",padding:"5px 2px 10px 2px",overflow:"hidden",display:"inline-block",fontSize:"14px"}),filterMenuItems:Object(c.db)({color:"rgb(34, 34, 30)",fontFamily:'-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',fontSize:"12px"}),rangeInputBox:Object(c.db)({fontSize:"14px",fontWeight:"600"}),rangeInputWrapper:Object(c.db)({display:"inline-block",width:"155px",marginTop:"-2px"})}})),Ee=i(377),Se=i(1201);function xe(e){return null==e?"":(e.length>1&&o.a.sendTraceTag(593609313,a.a.msoulscat_ES_EWAJS,r.a.Error,"Lineage RangeUtils, discontinuous ranges sent."),e[0]?function(e){if(function(e){return e.firstRow+1===1&&16383===e.lastCol&&e.firstCol+1===1&&1048575===e.lastRow}(e))return"";var t=e.firstCol+1===1&&16383===e.lastCol,i=e.firstRow+1===1&&1048575===e.lastRow,n=i?"":(e.firstRow+1).toString(),o=i?"":(e.lastRow+1).toString(),a=t?n:_e(e.firstCol+1)+n,r="";e.firstCol===e.lastCol&&e.firstRow===e.lastRow||(r=":"+(t?o:_e(e.lastCol+1)+o));return a+r}(e[0]):"")}function _e(e){for(var t,i=e,n="";i>0;)t=(i-1)%26,n=String.fromCharCode("A".charCodeAt(0)+t)+n,i=Math.floor((i-t)/26);return n}var Ie=i(283),Le=i(805),Fe={iconName:z.a.ArrowForwardWhite_20},Re=function(e){function t(t){var i=e.call(this,t)||this;return i._rangeInputRef=l.createRef(),i.handleRangeInputValueChange=function(e,t){i.props.validActiveRangeFilter&&i.props.clearPreviousSelection&&i.props.clearPreviousSelection(),i.setState({rangeInputValue:t})},i.onUserRangeCommit=function(e){var t=i.getRangeInputValue();i.props.onRangeFilterCommit(t)},i.onKeyDown=function(e){if(e.which===O.a.enter){var t=i.getRangeInputValue();i.props.onRangeFilterCommit(t)}else e.which===O.a.escape&&i.props.onRangeFilterInputEnabled(!1)},i.state={rangeInputValue:void 0},i}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){var e;null===(e=this._rangeInputRef.current)||void 0===e||e.focus()},t.prototype.componentDidUpdate=function(){var e;this.props.isRangeCommittedInvalid&&(null===(e=this._rangeInputRef.current)||void 0===e||e.focus())},t.prototype.componentWillReceiveProps=function(e){this.setState({rangeInputValue:e.validActiveRangeFilter})},t.prototype.getRangeInputValue=function(){return this._rangeInputRef&&this._rangeInputRef.current?this._rangeInputRef.current.value:void 0},t.prototype.render=function(){var e=this.props.isRangeCommittedInvalid?ExcelRibbonStrings.ShowChangesInvalidRangeText:"",t=!this.state.rangeInputValue;return l.createElement(l.Fragment,null,l.createElement("span",null,l.createElement(Le.a,{description:e,placeholder:ExcelRibbonStrings.ShowChangesFilterInputPlaceholderText,ariaLabel:this.props.isRangeCommittedInvalid?e:ExcelRibbonStrings.ShowChangesFilterInputPlaceholderText,className:be().rangeInputWrapper,componentRef:this._rangeInputRef,inputClassName:be().rangeInputBox,value:this.state.rangeInputValue,onChange:this.handleRangeInputValueChange,onKeyDown:this.onKeyDown,key:this.props.validActiveRangeFilter,styles:fe(this.props.isRangeCommittedInvalid,!this.props.isEnabled,t),disabled:!this.props.isEnabled}),!t&&l.createElement(M.a,{directionalHint:T.a.bottomCenter,content:ExcelRibbonStrings.ShowChangesFilterCommit},l.createElement(Ie.a,{iconProps:Fe,ariaLabel:ExcelRibbonStrings.ShowChangesFilterCommit,onClick:this.onUserRangeCommit,disabled:!this.props.isEnabled,styles:me}))))},t}(l.Component);Object(Se.a)();var we={iconName:Q.a.Filter_20},Pe=function(e){function t(t){var i=e.call(this,t)||this;return i.filterButtonId="LineagePaneFilterButton",i.componentDidUpdate=function(){if(i.props.shouldFocusOnFilterButton){var e=document.getElementById(i.filterButtonId);null==e||e.focus()}},i.onFilterChanged=function(e,t){var n=null==t?void 0:t.key;if(o.a.sendTraceTag(591734540,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineagePaneFilter.onFilterChanged"),"rangeFilter"===n)i.props.onRangeFilterInputEnabled(!0);else if("clearFilter"===n)i.props.onUserFilterChanged(void 0);else{(null==e?void 0:e.currentTarget).focus();var s={filterSheetMultiRange:{sheetName:null==t?void 0:t.key}};i.props.onUserFilterChanged(s)}},i}return Object(n.__extends)(t,e),t.prototype.generateDisplayedFilterInfo=function(e){var t="",i="";return e?(t=e.sheetName,i=xe(e.rangeList)):t=ExcelRibbonStrings.ShowChangesDefaultFilter,{filterInfoTokenOne:t,filterInfoTokenTwo:i}},t.prototype.generateActiveRangeInputDisplayValue=function(e){var t="";if(e){var i=e.sheetName,n=xe(e.rangeList);t="'"+i+"'"+(n="!"+n)}return t},t.prototype.getSheetSubMenuItems=function(){var e=this,t=[];this.props.filterSheetList&&this.props.filterSheetList.forEach((function(i){var n={key:i,text:i,onClick:e.onFilterChanged,className:be().filterMenuItems};t.push(n)}));return t},t.prototype.generateFilterMenuProps=function(){return{items:[{key:"rangeFilter",text:ExcelRibbonStrings.ShowChangesFilterByRange,className:be().filterMenuItems,onClick:this.onFilterChanged},{key:"sheetFilter",text:ExcelRibbonStrings.ShowChangesFilterBySheet,subMenuProps:{items:this.getSheetSubMenuItems(),styles:Ce,calloutProps:{calloutMaxHeight:200}},className:be().filterMenuItems},{key:"clearFilter",text:ExcelRibbonStrings.ShowChangesClearFilter,className:be().filterMenuItems,onClick:this.onFilterChanged,disabled:void 0===this.props.appliedFilterInfo||null===this.props.appliedFilterInfo}],styles:ye}},t.prototype.render=function(){var e,t=this.generateFilterMenuProps(),i=this.generateDisplayedFilterInfo(null===(e=this.props.appliedFilterInfo)||void 0===e?void 0:e.filterSheetMultiRange),n=ExcelRibbonStrings.ShowChangesFilterTooltip+", "+i.filterInfoTokenOne+i.filterInfoTokenTwo,o=this.props.isRangeInputActive,a="";return o&&this.props.validActiveRangeFilter&&(a=this.generateActiveRangeInputDisplayValue(this.props.validActiveRangeFilter)),l.createElement(k.a,{nowrap:!0,className:be().filterParent},l.createElement(M.a,{content:ExcelRibbonStrings.ShowChangesFilterTooltip,directionalHint:T.a.bottomCenter},l.createElement(Ee.a,{id:this.filterButtonId,"aria-label":n,iconProps:we,menuProps:t,disabled:!this.props.isEnabled,styles:ve})),o?l.createElement(Re,{onRangeFilterCommit:this.props.onRangeFilterCommit,validActiveRangeFilter:a,clearPreviousSelection:this.props.clearPreviousSelection,isRangeCommittedInvalid:this.props.isRangeCommittedInvalid,isEnabled:this.props.isEnabled,onRangeFilterInputEnabled:this.props.onRangeFilterInputEnabled}):l.createElement(l.Fragment,null,l.createElement(M.a,{content:i.filterInfoTokenOne,directionalHint:T.a.bottomAutoEdge,hostClassName:be(i.filterInfoTokenTwo).displayFilterTokenOneStyle,key:2,overflowMode:V.a.Self},i.filterInfoTokenOne),l.createElement(M.a,{content:i.filterInfoTokenTwo,directionalHint:T.a.bottomAutoEdge,hostClassName:be().displayFilterTokenTwoStyle,key:3,overflowMode:V.a.Self},i.filterInfoTokenTwo)))},t}(l.Component);var Te,ke,Be,De=function(e){function t(t){var i=e.call(this,t)||this;return i._paneTopAnchorId="TopOfPaneId",i._activitySectionTopAnchorId="TopOfActivitySectionId",i.componentDidUpdate=function(){if(i.state.contentProps.showLoadPreviousProcessing){var e=document.getElementById(i._activitySectionTopAnchorId);null==e||e.scrollIntoView({block:"center"})}},i.update=function(e){i.setState({contentProps:e})},i.onCardSelected=function(e,t){i.state.contentProps.onCardSelected(e,t)},i.onVersionHistoryButtonClicked=function(e){i.state.contentProps.onVersionHistoryButtonClicked(e.inputMethod)},i.onLearnMoreLinkClicked=function(){i.state.contentProps.onLearnMoreLinkClicked()},i.onLoadPreviousClicked=function(){i.state.contentProps.onLoadPreviousClicked()},i.getShimmerCardElements=function(){return l.createElement(ee.a,{flexWrap:!0,shimmerElements:[{type:te.a.line,width:"40%",height:14},{type:te.a.gap,width:"60%",height:26},{type:te.a.line,width:"100%",height:12}]})},i.showShimmerUI=function(e){void 0===e&&(e=i.state.contentProps.clientBatchSize);for(var t=[];t.length<e;)t.push(l.createElement("div",{className:ue().ShimmerStyle},l.createElement(ie.a,{customElementsGroup:i.getShimmerCardElements()})));return t},i.handleRefreshButtonClick=i.handleRefreshButtonClick.bind(i),i.state={contentProps:i.props},i}return Object(n.__extends)(t,e),t.prototype.handleRefreshButtonClick=function(){var e=document.getElementById(this._paneTopAnchorId);null==e||e.scrollIntoView(!1),this.state.contentProps.onRefreshUISelected()},t.prototype.render=function(){var e,t,i=this.state.contentProps.userMessage,n=this.state.contentProps.isRangeCommittedInvalid,o=n?"calc(100% - 63px)":"calc(100% - 44px)",a=null===(e=null==i?void 0:i.eolPersonHideHistory)||void 0===e?void 0:e.displayName;return a&&i&&i.body&&(t=i.body.split("{0}")),l.createElement(l.Fragment,null,l.createElement(Pe,{appliedFilterInfo:this.state.contentProps.appliedFilterInfo,onUserFilterChanged:this.state.contentProps.onUserFilterChanged,filterSheetList:this.state.contentProps.filterSheetList,isEnabled:this.state.contentProps.areButtonsEnabled,isRangeInputActive:this.state.contentProps.isRangeInputActive,onRangeFilterInputEnabled:this.state.contentProps.onRangeFilterInputEnabled,onRangeFilterCommit:this.state.contentProps.onRangeFilterCommit,validActiveRangeFilter:this.state.contentProps.validActiveRangeFilter,clearPreviousSelection:this.state.contentProps.clearPreviousSelection,isRangeCommittedInvalid:n,shouldFocusOnFilterButton:this.state.contentProps.shouldFocusOnFilterButton}),this.state.contentProps.showRefreshCapsule&&l.createElement("div",{"aria-live":"polite",className:ue(n).RefreshButtonWrapperStyle},l.createElement(M.a,{content:ExcelRibbonStrings.ShowChangesSeeNewChangesButtonText,directionalHint:T.a.bottomAutoEdge},l.createElement(se.b,{id:"CellLineageExplicitRefreshButton",type:"AppButtonProps",label:ExcelRibbonStrings.ShowChangesSeeNewChangesButtonText,icon:z.a.RefreshWhite_20,onExecute:this.handleRefreshButtonClick,styles:he,takeFocusOnClick:!0,role:"button",disabled:!this.state.contentProps.areButtonsEnabled}))),l.createElement(ne.a,{scrollbarVisibility:oe.b.auto,initialScrollPosition:this.state.contentProps.activityList.length?void 0:0,id:"LineageScrollablePaneId",styles:{root:{position:"relative",height:o,marginTop:"3px"},stickyAbove:{display:"none"}}},l.createElement("div",{id:this._paneTopAnchorId}),this.state.contentProps.showRefreshProcessing&&l.createElement(ae.a,{label:ExcelRibbonStrings.ShowChangesLoadingSpinnerText,className:ue().SpinnerStyle,ariaLive:"assertive",ariaLabel:ExcelRibbonStrings.ShowChangesLoadingSpinnerText,labelPosition:"top"}),this.state.contentProps.showLoadPreviousProcessing&&this.showShimmerUI(1),this.state.contentProps.showLoadPreviousButton&&!this.state.contentProps.showLoadPreviousProcessing&&l.createElement("div",{style:{marginTop:this.state.contentProps.showRefreshCapsule?"30px":"10px",marginBottom:"10px",textAlign:"center",width:"260px"}},l.createElement(se.b,{id:"CellLineageTaskPaneLoadPreviousButton",type:"AppButtonProps",label:ExcelRibbonStrings.ShowChangesLoadPreviousButtonText,onExecute:this.onLoadPreviousClicked,role:"button",styles:de,"aria-selected":!1,disabled:!this.state.contentProps.areButtonsEnabled})),l.createElement("div",{id:this._activitySectionTopAnchorId}),l.createElement($,{activityList:this.state.contentProps.activityList,onCardSelected:this.onCardSelected,selectedActivityGuid:this.state.contentProps.selectedActivityGuid,dateFormatter:this.props.dateFormatter,onEOLSeen:this.props.onEOLSeen,scrollToCardIndex:this.state.contentProps.scrollToViewCardIndex,separatorPosition:this.state.contentProps.separatorPosition}),l.createElement("div",{style:{paddingBottom:"24px"}},i&&this.state.contentProps.areButtonsEnabled&&l.createElement("div",{className:ue().UserMessageContainerStyle},i.illustration&&l.createElement(l.Fragment,null,l.createElement(B.a,{className:ue().UserMessageIllustrationStyle,iconName:i.illustration}),l.createElement("p",{className:ue().UserMessageTitle},ExcelRibbonStrings.ShowChangesResponseSuccessEmptyPaneTitle)),!i.illustration&&l.createElement("div",{style:{borderTop:"1px solid #D2D0CE",paddingBottom:"24px"}}),i.body&&(a?t&&l.createElement("div",null,l.createElement("p",{className:ue().UserMessageClearHistoryBody},t[0]),i.eolPersonHideHistory&&i.eolPersonHideHistory.displayName&&l.createElement(H.a,{styles:ge,coinSize:16,text:i.eolPersonHideHistory.displayName,imageUrl:i.eolPersonHideHistory.imageUrl?i.eolPersonHideHistory.imageUrl:"",showInitialsUntilImageLoads:!0}),l.createElement("p",{className:ue().UserMessageClearHistoryBody},t[1])):l.createElement("p",{className:ue().UserMessageBody}," ",i.body)),!this.state.contentProps.showLoadMoreButton&&l.createElement(re.a,{className:ue().LearnMoreLinkStyles,onClick:this.onLearnMoreLinkClicked,rel:"noopener noreferrer"},ExcelRibbonStrings.ShowChangesResponseLearnMore),i.showVHButton&&l.createElement(se.b,{id:"CellLineageTaskPaneVersionHistoryButton",type:"AppButtonProps",label:ExcelRibbonStrings.ShowChangesVersionHistoryButtonText,styles:ce,role:"button",onExecute:this.onVersionHistoryButtonClicked,takeFocusOnClick:!0,disabled:!this.state.contentProps.areButtonsEnabled})),this.state.contentProps.showLoadMoreButton&&!this.state.contentProps.showLoadMoreProcessing&&l.createElement("div",{className:ue().LoadMoreContainerStyle},l.createElement(se.b,{id:"CellLineageTaskPaneLoadMoreButton",type:"AppButtonProps",label:ExcelRibbonStrings.ShowChangesLoadMoreButtonText,onExecute:this.state.contentProps.onLoadMoreSelected,styles:pe,role:"button","aria-selected":!1,disabled:!this.state.contentProps.areButtonsEnabled,takeFocusOnClick:!0})),this.state.contentProps.showLoadMoreProcessing&&this.showShimmerUI())))},t}(l.PureComponent),Oe=i(659),Ve=function(){function e(e){this._isRangeInputActive=!1,this._isRangeCommittedInvalid=!1,this._filterableSheetList=e}return e.prototype.initialize=function(){this._isRangeInputActive=!1,this._isRangeCommittedInvalid=!1,this._validActiveRangeFilter=void 0},e.prototype.getAppliedFilterType=function(){if(null===this._appliedFilterInfo||void 0===this._appliedFilterInfo)return"NoFilter";var e=this._appliedFilterInfo.filterSheetMultiRange;return null==e?"NoFilter":e.rangeList?"RangeFilter":"SheetFilter"},e}(),Me=i(94),He=i(192);!function(e){e[e.None=0]="None",e[e.LoadFromBelow=1]="LoadFromBelow",e[e.LoadPrevious=2]="LoadPrevious",e[e.FetchFiltered=3]="FetchFiltered",e[e.ExplicitRefresh=4]="ExplicitRefresh",e[e.PaneOpen=5]="PaneOpen"}(Te||(Te={})),function(e){e[e.None=0]="None",e[e.Above=1]="Above",e[e.Below=2]="Below"}(ke||(ke={})),function(e){e[e.None=0]="None",e[e.DeletedLocation=1]="DeletedLocation"}(Be||(Be={}));var Ne=-1,Ue=-2,We="Office.Excel.Online.Lineage.PaneUsedEvent",je=function(){function e(e,t,i,n,d,p){var h=this;this._shouldFocusOnFilterButton=!1,this._shouldRenderLoadPrevious=!1,this._scrollToViewActivityGuid="EmptyActivityGuid",this._scrollToViewCardIndex=-1,this._separatorPosition=ke.None,this.getScrollToViewActivityGuid=function(e){var t=h._lineageActivityCache.getActivities();if(0===t.length)return h._separatorPosition=ke.None,void(h._scrollToViewActivityGuid="EmptyActivityGuid");switch(e){case Te.LoadPrevious:return h._separatorPosition=ke.Above,void(h._scrollToViewActivityGuid=t[0].activityGuid);case Te.LoadFromBelow:return h._separatorPosition=ke.Below,void(h._scrollToViewActivityGuid=t[t.length-1].activityGuid);default:return h._separatorPosition=ke.None,void(h._scrollToViewActivityGuid="EmptyActivityGuid")}},this.verifyAndLogCacheBounds=function(e,t){var i=h._lineageActivityCache.getLatestId()===t&&h._lineageActivityCache.getOldestId()===e,n=h._lineageActivityCache.getActivities(),r=0===n.length||n[n.length-1].activityId>=e&&n[0].activityId<=t;i&&r||o.a.shipAssertTag(575689362,a.a.msoulscat_ES_EWAJS,!1,JSON.stringify({msg:"LineageActivityController.verifyAndLogCacheBounds: Client cache bounds or activities within are not aligned with the server bounds.",latestIdInClientList:n[0].activityId,oldestIdInClientList:n[n.length-1].activityId,latestActivityIdProcessed:h._lineageActivityCache.getLatestId(),oldestActivityIdProcessed:h._lineageActivityCache.getOldestId(),serverLatestId:t,serverOldestId:e}))},this.isActivityTypeNavigable=function(e){switch(e){case 6:case 14:case 13:case 19:case 18:case 20:return!1;default:return!0}},this.onVersionHistoryButtonClicked=function(e){var t,i;h._shouldFocusOnFilterButton=!1,h._paneSessionEventsAggregator.incrementCounter("VHButtonClickedEvent"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"VersionHistoryButtonClicked"}]}),o.a.sendTraceTag(590485252,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityController.onVersionHistoryButtonClicked: Go to Version History button clicked via: "+e),null===(i=(t=h._lineageAppCallbacks).onVersionHistoryButtonClicked)||void 0===i||i.call(t,e)},this.onLearnMoreLinkClicked=function(){var e,t;o.a.sendTraceTag(577840921,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityController.onLearnMoreLinkClicked"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"LearnMoreLinkClicked"}]}),null===(t=(e=h._lineageAppCallbacks).onLearnMoreLinkClicked)||void 0===t||t.call(e)},this.tryCreateListWithSeparatorLine=function(e){var t={activityId:Ue,activityType:0,degradedCardTypeBits:Be.None},i=h.computeSeparatorLineIndex();if(-1===i)return e;if(0===e.length)return[];var n=[];return(n=e.slice(0,i)).push(t),n=n.concat.apply(n,e.slice(i,e.length))},this._lineageAppCallbacks=p,this._clientBatchSize=e,this._uiCulture=t,this._dataCulture=i,this._lineageActivityCache=new s,this._filterData=new Ve(n),this.onCardSelected=this.onCardSelected.bind(this),this.onLoadMoreSelected=this.onLoadMoreSelected.bind(this),this.onRefreshPillSelected=this.onRefreshPillSelected.bind(this),this.onLoadPreviousClicked=this.onLoadPreviousClicked.bind(this),this.onEOLSeen=this.onEOLSeen.bind(this),this.onUserFilterChanged=this.onUserFilterChanged.bind(this),this.onRangeFilterInputEnabled=this.onRangeFilterInputEnabled.bind(this),this.onRangeFilterCommit=this.onRangeFilterCommit.bind(this),this.clearPreviousSelection=this.clearPreviousSelection.bind(this),Object(c.hb)({icons:{NoChangesIllustration:l.createElement("svg",{width:"160",height:"160",viewBox:"0 0 160 160",fill:"none"},l.createElement("g",{clipPath:"url(#clip0)"},l.createElement("path",{d:"M100.896 91.662L31.8769 102.646C31.8769 102.646 33.6631 78.231 25.7035 56.9757C17.7439 35.7204 1.27416 19.6775 1.27416 19.6775L71.5949 7.74976C71.5949 7.74976 87.8544 20.3562 97.0284 42.8052C106.202 65.2542 100.896 91.662 100.896 91.662Z",fill:"url(#paint0_linear)"}),l.createElement("path",{d:"M75.8357 43.61C78.7252 54.1685 72.5417 65.0389 61.975 67.9673C51.4165 70.8568 40.5461 64.6733 37.6176 54.1065C45.9637 51.8469 63.5825 46.9949 75.8357 43.61Z",fill:"#C8C6C4"}),l.createElement("path",{d:"M56.8651 49.0711C46.3066 51.9605 45.2348 52.0179 37.6569 54.1149C34.7674 43.5564 40.9509 32.686 51.5177 29.7576C53.4188 36.7233 55.4204 43.7918 56.8651 49.0711Z",fill:"#E1DFDD"}),l.createElement("path",{d:"M59.3547 44.2618C69.9132 41.3724 70.9094 41.0952 78.4484 38.9899C75.5589 28.4315 64.6495 22.2397 54.0911 25.1292C56.0229 32.1421 57.9016 39.0216 59.3547 44.2618Z",fill:"#E1DFDD"}),l.createElement("path",{d:"M137.12 29.2194L60.0037 35.3239C60.0037 35.3239 57.642 55.4674 58.9894 83.8444C60.3368 112.221 67.8829 134.858 67.8829 134.858L145 128.754C145 128.754 137.367 105.1 135.51 81.4826C133.654 57.8651 137.12 29.2194 137.12 29.2194Z",fill:"#FCFCFB"}),l.createElement("path",{d:"M103.163 67.7344L118.949 66.5201",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M78.6523 69.6233L96.1475 68.2741",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M104.198 78.2135L119.849 76.9992",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M79.5518 80.1025L96.9569 78.7532",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M104.737 88.6926L120.748 87.4333",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M80.4512 90.5366L97.7214 89.1874",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M105.592 98.7669L122.098 97.5077",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M81.8008 100.566L98.7113 99.3066",stroke:"#E1DFDD",strokeWidth:"4.16188",strokeMiterlimit:"10",strokeLinecap:"round"}),l.createElement("path",{d:"M102.194 151.458L98.5942 156.758C98.0942 157.558 98.2942 158.558 98.9942 159.158C99.7942 159.658 100.794 159.458 101.394 158.758L104.994 153.458L102.194 151.458Z",fill:"#185C37"}),l.createElement("path",{d:"M158.016 83.8538C159.39 84.7647 159.772 86.6144 158.87 87.9951L125.359 139.304C122.143 144.227 117.93 148.42 112.991 151.611L103.536 157.722L98.7519 154.264L101.134 143.124C102.264 137.842 104.401 132.829 107.429 128.357L142.235 76.9592C143.157 75.5971 145.004 75.2319 146.376 76.1406L158.016 83.8538Z",fill:"#21A366"}),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.613 146.313C117.596 148.293 115.378 150.069 112.991 151.611L103.536 157.722L98.752 154.264L101.134 143.124C101.685 140.547 102.477 138.033 103.494 135.615L119.613 146.313Z",fill:"white"}),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M103.496 135.611C104.563 133.076 105.88 130.645 107.429 128.357L108.036 127.461L125.502 139.085L125.359 139.304C123.694 141.853 121.761 144.207 119.598 146.328L103.496 135.611Z",fill:"#185C37"}),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M110.136 124.36L112.042 121.544L129.408 133.103L127.549 135.95L110.136 124.36Z",fill:"#185C37"}),l.createElement("path",{d:"M139.5 83.5C138.167 82.5 133.318 81.4639 129.5 83.5C122 87.5 121 101 112.5 113",stroke:"#21A366",strokeWidth:"4"}),l.createElement("circle",{cx:"111.5",cy:"112.5",r:"3.5",fill:"#21A366"})),l.createElement("defs",null,l.createElement("linearGradient",{id:"paint0_linear",x1:"101.28",y1:"82.4826",x2:"37.1567",y2:"39.3253",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#E4E4E4"}),l.createElement("stop",{offset:"1",stopColor:"white"})),l.createElement("clipPath",{id:"clip0"},l.createElement("rect",{width:"160",height:"160",fill:"white"}))))}});var u=new Oe.a(this._uiCulture,this._dataCulture,d,!0);this._dateFormatter=u.format.bind(u),this._paneSessionEventsAggregator=new Me.TelemetryCollector,this._userActionEventsAggregator=new Me.TelemetryCollector,this.initializeController()}return e.prototype.createLineagePane=function(e,t){var i=this;if(e){this._lineageActivityCache.resetCache();var s=void 0;null!=t&&(s={filterSheetMultiRange:t}),this._filterData._appliedFilterInfo=s,this.resetController(),function(e,t){return e.style.scrollBehavior="smooth",new Promise((function(i){g.render(l.createElement(De,Object(n.__assign)({ref:function(e){return i(e)}},t)),e)}))}(e,this.getLineagePaneProps()).then((function(e){i._lineageActivityPane=e,i.onLineagePaneReady()}))}else o.a.sendTraceTag(590485201,a.a.msoulscat_ES_EWAJS,r.a.Error,"LineageActivityController.createLineagePane: An uninitialized containerElement received.")},e.prototype.onLineageActivitiesResponse=function(e){this.processLineageActivityResponse(e),this._userActionEventsAggregator.addEvent("PreRenderTime",Date.now().toString()),this.updateView(),this._userActionEventsAggregator.addEvent("EventEndTime",Date.now().toString()),Object(j.sendTelemetryEvent)({name:"Office.Excel.Online.Lineage.UserActionEventsAggregated",dataFields:[{name:"Events",string:this._userActionEventsAggregator.getJsonForLogging()}]}),this._userActionEventsAggregator.clearEvents()},e.prototype.onLineageActivitiesUpdateResponse=function(e){this.shouldProcessActivityUpdateResponse(e)&&(this.processActivityUpdateResponse(e),this.updateView())},e.prototype.onRefreshRequired=function(){var e,t;this.isUpdateNeeded()?null===(t=(e=this._lineageAppCallbacks).lineageUpdateViewRequest)||void 0===t||t.call(e):o.a.sendTraceTag(587481611,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityController.onRefreshRequired bailed out.")},e.prototype.onStaleActivitiesDetected=function(){var e,t;o.a.sendTraceTag(576247010,a.a.msoulscat_ES_EWAJS,r.a.Warning,JSON.stringify({msg:"LineageActivityController.onStaleActivitiesDetected: Stale activities detected.",isFilterApplied:!(void 0===this._filterData._appliedFilterInfo||null===this._filterData._appliedFilterInfo)})),this.resetController(),this._lineageActivityCache.resetCache(),this._filterData._appliedFilterInfo=void 0;var i=this.fetchClientParams();null===(t=(e=this._lineageAppCallbacks).lineageOpenPaneOrChangeFilterRequest)||void 0===t||t.call(e,i,void 0)},e.prototype.onSelectedRangeUpdated=function(e){e&&this._filterData._isRangeInputActive&&(this._filterData._validActiveRangeFilter=e,this._filterData._isRangeCommittedInvalid=!1,this.updateView())},e.prototype.onPaneClosed=function(){this._paneSessionEventsAggregator.endTimer("LineagePaneSessionEvents"),Object(j.sendTelemetryEvent)({name:"Office.Excel.Online.Lineage.PaneSessionEventsAggregated",dataFields:[{name:"Events",string:this._paneSessionEventsAggregator.getJsonForLogging()}]}),this._paneSessionEventsAggregator.clearCounters(),this._lineageActivityCache.resetCache(),this._lastLoggedEolCorrelationId=void 0},e.prototype.onFilterableSheetListChange=function(e){if(e){var t=e.filter((function(e){return!(void 0===e)}));0!==t.length?(this._filterData._filterableSheetList=t,this.updateView()):o.a.sendTraceTag(574128528,a.a.msoulscat_ES_EWAJS,r.a.Info,JSON.stringify({msg:"LineageActivityController.onFilterableSheetListChange: Empty sheet list, bail out."}))}},e.prototype.getActivityCache=function(){return this._lineageActivityCache},e.prototype.getLineageFilterData=function(){return this._filterData},e.prototype.onRefreshPillSelected=function(){var e,t;this._shouldFocusOnFilterButton=!1,this._paneSessionEventsAggregator.incrementCounter("RefreshEventTriggered"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"SeeNewChangesButtonClicked"}]}),this._userActionEventsAggregator.addEvent("EventName","RefreshEventTriggered"),this._userActionEventsAggregator.addEvent("EventStartTime",Date.now().toString()),o.a.sendTraceTag(590485206,a.a.msoulscat_ES_EWAJS,r.a.Info,JSON.stringify({msg:"LineageActivityController.onRefreshUISelected: Refresh UI clicked by user."})),this.isUserRequestInProgress()?o.a.shipAssertTag(590485207,a.a.msoulscat_ES_EWAJS,!1,"LineageActivityController.onRefreshUISelected: onRefreshUISelected clicked while another request marked as processing.  "+this._requestInformation):(this._requestInformation=Te.ExplicitRefresh,this._showRefreshUI=!1,this.updateView(),this._lineageActivityCache.resetCache(),null===(t=(e=this._lineageAppCallbacks).lineageRefreshViewRequest)||void 0===t||t.call(e))},e.prototype.onUserFilterChanged=function(e){var t,i;if(this._shouldFocusOnFilterButton=!0,this._paneSessionEventsAggregator.incrementCounter("PaneFilterChangedEvent"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"UserFilterChanged"}]}),this._userActionEventsAggregator.addEvent("EventName","PaneFilterChangedEvent"),this._userActionEventsAggregator.addEvent("EventStartTime",Date.now().toString()),this.isUserRequestInProgress())o.a.shipAssertTag(590485208,a.a.msoulscat_ES_EWAJS,!1,"LineageActivityController.onUserFilterUpdated: Pane filter updated while another request marked as processing.  "+this._requestInformation);else{this.resetController(),this._lineageActivityCache.resetCache(),this._requestInformation=Te.FetchFiltered,this._filterData._appliedFilterInfo=e,this._userActionEventsAggregator.addEvent("FilterType",this._filterData.getAppliedFilterType()),this.updateView();var n=this.fetchClientParams(),r=this._filterData._appliedFilterInfo;null===(i=(t=this._lineageAppCallbacks).lineageOpenPaneOrChangeFilterRequest)||void 0===i||i.call(t,n,r)}},e.prototype.onLoadMoreSelected=function(){var e,t;this._shouldFocusOnFilterButton=!1,this._paneSessionEventsAggregator.incrementCounter("LoadMoreEventTriggered"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"ShowMoreChangesButtonClicked"}]}),this._userActionEventsAggregator.addEvent("EventName","LoadMoreEventTriggered"),this._userActionEventsAggregator.addEvent("EventStartTime",Date.now().toString()),this.isUserRequestInProgress()?o.a.shipAssertTag(590485209,a.a.msoulscat_ES_EWAJS,!1,"LineageActivityController.onLoadMoreSelected: Load more clicked while another request marked as processing.  "+this._requestInformation):(this._requestInformation=Te.LoadFromBelow,this.getScrollToViewActivityGuid(this._requestInformation),this.updateView(),null===(t=(e=this._lineageAppCallbacks).lineageLoadMoreRequest)||void 0===t||t.call(e,!0))},e.prototype.onLoadPreviousClicked=function(){var e,t;this._shouldFocusOnFilterButton=!1,this._paneSessionEventsAggregator.incrementCounter("LoadPreviousEventTriggered"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"ShowPreviousButtonClicked"}]}),this._userActionEventsAggregator.addEvent("EventName","LoadPreviousEventTriggered"),this._userActionEventsAggregator.addEvent("EventStartTime",Date.now().toString()),this.isUserRequestInProgress()?o.a.shipAssertTag(574694918,a.a.msoulscat_ES_EWAJS,!1,"LineageActivityController.onLoadPreviousClicked: Load previous clicked while another request marked as processing.  "+this._requestInformation):(this._requestInformation=Te.LoadPrevious,this.getScrollToViewActivityGuid(this._requestInformation),this.updateView(),null===(t=(e=this._lineageAppCallbacks).lineageLoadMoreRequest)||void 0===t||t.call(e,!1))},e.prototype.onLineagePaneReady=function(){var e,t;this._shouldFocusOnFilterButton=!0,this._paneSessionEventsAggregator.startTimer("LineagePaneSessionEvents"),this._userActionEventsAggregator.addEvent("EventName","LineagePaneOpened"),this._userActionEventsAggregator.addEvent("EventStartTime",Date.now().toString()),this._userActionEventsAggregator.addEvent("FilterType",this._filterData.getAppliedFilterType()),this._requestInformation=Te.PaneOpen,this.updateView(),this._userActionEventsAggregator.addEvent("PreInvokeWebRequest",Date.now().toString());var i=this.fetchClientParams(),n=this._filterData._appliedFilterInfo;null===(t=(e=this._lineageAppCallbacks).lineageOpenPaneOrChangeFilterRequest)||void 0===t||t.call(e,i,n)},e.prototype.fetchClientParams=function(){return{clientViewCapacity:100}},e.prototype.processLineageActivityResponse=function(e){var t,i=this._requestInformation!==Te.LoadPrevious,n=this._requestInformation;(this._requestInformation=Te.None,this.logAndValidateActivityResponse(e))?(this._responseCodeReceived=e.serverMessageCode,this._latestEolCorrelationId=e.eolCorrelationId,this.checkResponseCode(e.serverMessageCode)?(20===this._responseCodeReceived&&(o.a.shipAssertTag(556095379,a.a.msoulscat_ES_EWAJS,!!e.eolDateHideHistory&&!!e.eolPersonHideHistory,"LineageActivityController.processLineageActivityResponse: clear history eol date and person should not be empty"),this._eolDateHideHistory=e.eolDateHideHistory,this._eolPersonHideHistory=e.eolPersonHideHistory),this.getScrollToViewActivityGuid(n),this._shouldRenderLoadPrevious=e.showLoadPrevious,null===(t=e.activityList)||void 0===t||t.reverse(),(i?this.tryAppend(e):this.tryPrepend(e))?(this._paneSessionEventsAggregator.addEvent("MaxActivitiesInCache",this._lineageActivityCache.getMaxActivitiesInCache().toString()),this._lineageActivityCache.updateLastSearchedTimestamp(e.lastSearchedActivityTimestamp)):this.onStaleActivitiesDetected()):o.a.sendTraceTag(590485213,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.processActivityUpdateResponse: returning on failed response code check")):o.a.sendTraceTag(590485212,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.processLineageActivityResponse: returning on failed logAndValidate()")},e.prototype.processActivityUpdateResponse=function(e){this._shouldFocusOnFilterButton=!1,this._showRefreshUI=e.hasNewActivities,this._shouldRenderLoadPrevious=e.showLoadPrevious,this._responseCodeReceived=e.serverMessageCode,this._latestEolCorrelationId=e.eolCorrelationId,20===this._responseCodeReceived&&(o.a.shipAssertTag(556095380,a.a.msoulscat_ES_EWAJS,!!e.eolDateHideHistory&&!!e.eolPersonHideHistory,"LineageActivityController.processActivityUpdateResponse: clear history eol date and person should not be empty"),this._eolDateHideHistory=e.eolDateHideHistory,this._eolPersonHideHistory=e.eolPersonHideHistory),this._filterData._appliedFilterInfo=Object(n.__assign)(Object(n.__assign)({},this._filterData._appliedFilterInfo),{filterSheetMultiRange:e.filterSheetMultiRange}),this._lineageActivityCache.updateLineageActivitiesUpdateResponse(e.activityList,e.serverFirstActivityId,e.serverLastActivityId)},e.prototype.shouldProcessActivityUpdateResponse=function(e){var t;return this.logAndValidateActivityUpdateResponse(e)?this.checkResponseCode(e.serverMessageCode)?this.isUpdateNeeded()?(null===(t=e.activityList)||void 0===t||t.reverse(),o.a.sendTraceTag(575010203,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityController.shouldProcessActivityUpdateResponse: Update response validated."),!0):(o.a.sendTraceTag(574436056,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.shouldProcessActivityUpdateResponse: returning if another fresh request is in progress"+this._requestInformation),!1):(o.a.sendTraceTag(590485215,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.shouldProcessActivityUpdateResponse: returning on failed response code check"),!1):(o.a.sendTraceTag(590485214,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.shouldProcessActivityUpdateResponse: returning on failed logAndValidateActivityUpdateResponse"),!1)},e.prototype.checkResponseCode=function(e){switch(this._paneSessionEventsAggregator.incrementCounter(e.toString()),e){case 16:case 17:case 18:case 20:case 21:case 0:case 1:return!0;case 128:return!1;default:return o.a.shipAssertTag(542938334,a.a.msoulscat_ES_EWAJS,!1,"LineageActivityController.checkResponseCode: Unmapped ResponseCode "+e),!1}},e.prototype.computeSeparatorLineIndex=function(){var e=this;if("EmptyActivityGuid"===this._scrollToViewActivityGuid)return-1;var t=this._lineageActivityCache.getActivities(),i=Object(He.e)(t,(function(t){return t.activityGuid===e._scrollToViewActivityGuid}));return this._separatorPosition===ke.Below&&(i+=1),i},e.prototype.logAndValidateActivityUpdateResponse=function(e){var t;return!!e&&(o.a.sendTraceTag(590485218,a.a.msoulscat_ES_EWAJS,r.a.Info,JSON.stringify({msg:"LineageActivityController.logAndValidateActivityUpdateResponse : Received activityDataUpdateResponse",length:null===(t=e.activityList)||void 0===t?void 0:t.length,latestActivityId:e.latestActivityId,oldestActivityId:e.oldestActivityId,statusCode:e.serverMessageCode,hasNewActivities:e.hasNewActivities,serverLastActivityId:e.serverLastActivityId,serverFirstActivityId:e.serverFirstActivityId,showLoadPrevious:e.showLoadPrevious})),!0)},e.prototype.logAndValidateActivityResponse=function(e){var t,i;return void 0===e?(o.a.sendTraceTag(590485219,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.logAndValidateActivityResponse: An uninitialized activityDataResponse received."),!1):(o.a.sendTraceTag(590485248,a.a.msoulscat_ES_EWAJS,r.a.Info,JSON.stringify({msg:"LineageActivityController.logAndValidateActivityResponse : Received activityDataResponse ",length:null===(t=e.activityList)||void 0===t?void 0:t.length,latestActivityId:e.latestActivityId,oldestActivityId:e.oldestActivityId,statusCode:e.serverMessageCode,serverLastActivityId:e.serverLastActivityId,serverFirstActivityId:e.serverFirstActivityId,showLoadPrevious:e.showLoadPrevious})),e.latestActivityId<e.oldestActivityId?(o.a.sendTraceTag(590485249,a.a.msoulscat_ES_EWAJS,r.a.Error,"LineageActivityController.logAndValidateActivityResponse: Corrupt activityDataResponse received with out of order activities."),!1):(0===(null===(i=e.activityList)||void 0===i?void 0:i.length)&&o.a.sendTraceTag(590485250,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.logAndValidateActivityResponse: Empty activity list returned."),!0))},e.prototype.tryAppend=function(e){var t=this._lineageActivityCache.isSafeForAppend(e.latestActivityId);if(t){if(this._lineageActivityCache.appendActivitiesAndUpdateBounds(e.activityList,e.oldestActivityId,e.latestActivityId),this._lineageActivityCache.evictActivitiesFromTop(e.serverLastActivityId)){var i=this.computeSeparatorLineIndex();this._scrollToViewCardIndex=i-1}this.verifyAndLogCacheBounds(e.serverFirstActivityId,e.serverLastActivityId)}return t},e.prototype.tryPrepend=function(e){var t=this._lineageActivityCache.isSafeForPrepend(e.oldestActivityId);if(t){if(this._lineageActivityCache.prependActivitiesAndUpdateBounds(e.activityList,e.oldestActivityId,e.latestActivityId),this._lineageActivityCache.evictActivitiesFromBottom(e.serverFirstActivityId)){var i=this.computeSeparatorLineIndex();this._scrollToViewCardIndex=i+1}this.verifyAndLogCacheBounds(e.serverFirstActivityId,e.serverLastActivityId)}return t},e.prototype.onCardSelected=function(e,t){var i,n;this._shouldFocusOnFilterButton=!1,this._paneSessionEventsAggregator.incrementCounter("ActivityCardSelectedEvent"),Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"ActivityCardSelected"},{name:"SubEditClicked",bool:null!=t},{name:"DegradedType",string:e.degradedCardTypeBits.toString()}]}),o.a.sendTraceTag(590485251,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityController.onCardSelected: User selected Activity type: "+e.activityType),this._selectedActivityGuid=e.activityGuid,this.isActivityTypeNavigable(e.activityType)&&(null===(n=(i=this._lineageAppCallbacks).onCardSelected)||void 0===n||n.call(i,e,t)),this.updateView()},e.prototype.onEOLSeen=function(){var e;this._latestEolCorrelationId!==this._lastLoggedEolCorrelationId?(this._lastLoggedEolCorrelationId=this._latestEolCorrelationId,Object(j.sendTelemetryEvent)({name:We,dataFields:[{name:"UserAction",string:"EOLSeen"},{name:"EOLType",string:null===(e=this._responseCodeReceived)||void 0===e?void 0:e.toString()},{name:"EOLCorrelationId",string:null===this._latestEolCorrelationId?"":this._latestEolCorrelationId}]})):o.a.sendTraceTag(556410524,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.onEOLSeen: EolSeen already logged CorrelationID : "+this._latestEolCorrelationId)},e.prototype.onRangeFilterInputEnabled=function(e){var t,i;e||(this._filterData._isRangeCommittedInvalid=!1),this._shouldFocusOnFilterButton=!1,this._filterData._isRangeInputActive=e,null===(i=(t=this._lineageAppCallbacks).onRangeFilterInputEnabled)||void 0===i||i.call(t,e),this.updateView()},e.prototype.clearPreviousSelection=function(){this._filterData._validActiveRangeFilter&&(this._filterData._validActiveRangeFilter=void 0,this._filterData._isRangeCommittedInvalid=!1)},e.prototype.onRangeFilterCommit=function(e){var t,i;if(o.a.sendTraceTag(590485253,a.a.msoulscat_ES_EWAJS,r.a.Verbose,"LineageActivityController.onRangeFilterCommit by user."),this._filterData._validActiveRangeFilter||(this._filterData._validActiveRangeFilter=null===(i=(t=this._lineageAppCallbacks).tryParseRangeInfo)||void 0===i?void 0:i.call(t,e)),!this._filterData._validActiveRangeFilter)return this._filterData._isRangeCommittedInvalid=!0,this.updateView(),void o.a.sendTraceTag(590485254,a.a.msoulscat_ES_EWAJS,r.a.Info,"LineageActivityController.onRangeFilterCommit parse failed.");var n={filterSheetMultiRange:this._filterData._validActiveRangeFilter};this.onUserFilterChanged(n)},e.prototype.updateView=function(){if(this._lineageActivityPane){var e=this.getLineagePaneProps();this._lineageActivityPane.update(e)}this._scrollToViewCardIndex=-1},e.prototype.getLineagePaneProps=function(){var e={isRangeInputActive:this._filterData._isRangeInputActive,isRangeCommittedInvalid:this._filterData._isRangeCommittedInvalid,filterSheetList:this._filterData._filterableSheetList,appliedFilterInfo:this._filterData._appliedFilterInfo,validActiveRangeFilter:this._filterData._validActiveRangeFilter},t=this._lineageActivityCache.getActivities();return t=this.tryCreateListWithSeparatorLine(t),t=this.tryAddMarkerEOLActivity(t,void 0!==this._responseCodeReceived),Object(n.__assign)(Object(n.__assign)({activityList:t,selectedActivityGuid:this._selectedActivityGuid,showLoadMoreButton:this.shouldRenderLoadMoreButton(),showLoadMoreProcessing:this.shouldRenderLoadMoreProcessing(),userMessage:this.getUserMessageInformation(),dateFormatter:this._dateFormatter,onCardSelected:this.onCardSelected,onEOLSeen:this.onEOLSeen,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,onLoadMoreSelected:this.onLoadMoreSelected,onRefreshUISelected:this.onRefreshPillSelected,showRefreshCapsule:this.shouldRenderExplicitRefreshButton(),showRefreshProcessing:this.shouldRenderExplicitRefreshProcessing(),shouldFocusOnFilterButton:this._shouldFocusOnFilterButton,showLoadPreviousButton:this._shouldRenderLoadPrevious,showLoadPreviousProcessing:this.shouldRenderLoadPreviousProcessing(),onLoadPreviousClicked:this.onLoadPreviousClicked,scrollToViewCardIndex:this._scrollToViewCardIndex,separatorPosition:this._separatorPosition,onRangeFilterCommit:this.onRangeFilterCommit,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,clearPreviousSelection:this.clearPreviousSelection,onUserFilterChanged:this.onUserFilterChanged},e),{areButtonsEnabled:!this.isUserRequestInProgress(),clientBatchSize:this._clientBatchSize})},e.prototype.shouldRenderExplicitRefreshProcessing=function(){return this._requestInformation===Te.ExplicitRefresh},e.prototype.tryAddMarkerEOLActivity=function(e,t){if(!t)return e;var i={activityId:Ne,activityType:0,degradedCardTypeBits:Be.None};return e.concat(i)},e.prototype.shouldRenderExplicitRefreshButton=function(){return!!this._showRefreshUI},e.prototype.shouldRenderLoadMoreButton=function(){return 0===this._responseCodeReceived},e.prototype.shouldRenderLoadMoreProcessing=function(){return this._requestInformation===Te.LoadFromBelow||this._requestInformation===Te.FetchFiltered||this._requestInformation===Te.PaneOpen},e.prototype.shouldRenderLoadPreviousProcessing=function(){return this._requestInformation===Te.LoadPrevious},e.prototype.isUpdateNeeded=function(){return this._requestInformation!==Te.ExplicitRefresh&&this._requestInformation!==Te.FetchFiltered},e.prototype.isUserRequestInProgress=function(){return!(this._requestInformation===Te.None)},e.prototype.initializeController=function(){this._responseCodeReceived=void 0,this._selectedActivityGuid=void 0,this._showRefreshUI=!1,this._shouldFocusOnFilterButton=!1,this._shouldRenderLoadPrevious=!1,this._scrollToViewActivityGuid="EmptyActivityGuid",this._scrollToViewCardIndex=-1,this._requestInformation=Te.None,this._separatorPosition=ke.None,this._eolDateHideHistory=void 0,this._eolPersonHideHistory=void 0,this._filterData.initialize(),this._latestEolCorrelationId=void 0,this._lastLoggedEolCorrelationId=void 0},e.prototype.resetController=function(){this.initializeController()},e.prototype.getControllerStateVariables=function(){return{appliedFilterInfo:this._filterData,shouldRenderLoadPreviousButton:this._shouldRenderLoadPrevious,serverMessageCode:this._responseCodeReceived,showRefreshUI:this._showRefreshUI,requestInformation:this._requestInformation,scrollToViewCardIndex:this._scrollToViewCardIndex,separatorPosition:this._separatorPosition}},e.prototype.getUserMessageInformation=function(){var e;switch(this._lineageActivityCache.getLastSearchedTimestamp()&&(e=this._dateFormatter(this._lineageActivityCache.getLastSearchedTimestamp()),e=this.createUserMessageFromFriendlyDate(e)),this._responseCodeReceived){case 17:case 16:case 18:case 21:case 1:return 0===this._lineageActivityCache.getActivities().length?{illustration:"NoChangesIllustration",body:ExcelRibbonStrings.ShowChangesResponseSuccessEmptyPaneBody,showVHButton:!1,eolPersonHideHistory:void 0}:{illustration:void 0,body:ExcelRibbonStrings.ShowChangesResponseSuccessEndOfLog,showVHButton:!1,eolPersonHideHistory:void 0};case 0:return{illustration:void 0,body:e,showVHButton:!1,eolPersonHideHistory:void 0};case 20:var t=ExcelRibbonStrings.ShowChangesClearHistoryEndOfChangeDescription;return this._eolDateHideHistory&&this._eolPersonHideHistory&&this._eolPersonHideHistory.displayName?t=t.replace("{1}",this._eolDateHideHistory.toLocaleString()):o.a.sendTraceTag(556095381,a.a.msoulscat_ES_EWAJS,r.a.Warning,"LineageActivityController.getUserMessageInformation: Eol_HidePrev required data missing."),0===this._lineageActivityCache.getActivities().length?{illustration:"NoChangesIllustration",body:t,showVHButton:!1,eolPersonHideHistory:this._eolPersonHideHistory}:{illustration:void 0,body:t,showVHButton:!1,eolPersonHideHistory:this._eolPersonHideHistory};default:return{illustration:void 0,body:e,showVHButton:!1,eolPersonHideHistory:void 0}}},e.prototype.createUserMessageFromFriendlyDate=function(e){return e===FriendlyDatesStrings.JustNow?ExcelRibbonStrings.ShowChangesResponseSuccessJustNow:ExcelRibbonStrings.ShowChangesEndOfChangesText.replace("{0}",e)},e}(),Ge=i(86);var ze=new(function(){function e(){}return e.prototype.createLineageActivityController=function(e){if(e&&e.clientBatchSize&&e.uiCulture&&e.dataCulture&&e.logger&&e.lineageAppCallbacks&&e.filterableSheetList){var t=e.filterableSheetList.filter((function(e){return!(void 0===e)})),s=Object(n.__assign)({},FriendlyDatesStrings);return o.a.setLogger(e.logger),i(575),excelLazyAppSprite?Object(c.hb)({icons:Object(Ge.iconSpriteToReactMap)(excelLazyAppSprite)}):o.a.sendTraceTag(544747659,a.a.msoulscat_ES_EWAJS,r.a.Error,"excelLazyAppSprite icon script is not loaded."),excelAppSprite&&Object(c.hb)({icons:Object(Ge.iconSpriteToReactMap)(excelAppSprite)}),excelInitialAppSprite&&Object(c.hb)({icons:Object(Ge.iconSpriteToReactMap)(excelInitialAppSprite)}),ribbonMenuSprite&&Object(c.hb)({icons:Object(Ge.iconSpriteToReactMap)(ribbonMenuSprite)}),new je(e.clientBatchSize,e.uiCulture,e.dataCulture,t,s,e.lineageAppCallbacks)}},e}());i.d(t,"LineageActivityControllerFactoryGlobal",(function(){return ze}))},78:function(e,t){e.exports=otel}},[[1780,2,0,1]]]);
//# sourceMappingURL=cellLineage.min.js.map