(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1058:function(z,E,b){function a(t){var u=this;this.businessBar=this.r8a=null;this.HHi=function(B,v){v.r7c?u.JHi(v):u.IHi(v)};this.Th=function(B,v){B=v.context.methodName;u.r8a&&B===u.r8a&&(m.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',u.r8a),u.M8a(a.sKb,!0),u.r8a=null);u.snf(!1);u.R3b=!1};this.Wn=function(B,
v){w.a.qh(v.errors,[-1387426400])&&!u.R3b&&(u.R3b=!0,u.U2f()&&window.performance.mark(a.kuf),(new c(u)).Sri())};this.Gg=function(){u.snf(!0);u.M8a(a.xDb,!1);u.M8a(a.sKb,!1)};this.Zya=function(){m.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");u.M8a(a.xDb,!0)};this.$=t;this.na=this.$.na;this.localStorage=new y.a;this.R3b=!1;this.$.ea.Hl(this.Gg);this.na.qf.$nb(this.Zya);this.na.Bq(this.Th);this.$.da.$a(5,
function(B){u.businessBar=B;B.DEg(u.HHi)});this.na.iz(this.Wn)}function c(t){var u=this;this.rld=[r.a.tig,r.a.AEc];this.So=function(B,v){u.wO[v]=B;u.H6h()&&u.Vfj("OnNetworkDownImmediatePing"===B.caller)};this.Zla=t;this.$=t.$;this.wO={}}function e(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(E);z=b(0);var f=b(7),m=b(14),n=b(333),w=b(30),h=b(10),y=b(324);Object(z.a)(e,"ConnectionErrorLogInfo",null,[]);var r=b(1277),x=b(1321);c.prototype.Sri=function(){var t=x.a.sdd(this.So,
"OnNetworkDownImmediatePing",this.$,this.rld);t=Cl(t);for(var u=t.next();!u.done;u=t.next())u.value.runTest()};c.prototype.H6h=function(){for(var t=Cl(this.rld),u=t.next();!u.done;u=t.next())if(u=u.value,void 0===this.wO[u]||null===this.wO[u])return!1;return!0};c.prototype.Vfj=function(t){var u=this.$.qf.oW;t&&this.KGj(u);t=Cl(this.rld);for(var B=t.next();!B.done;B=t.next())B=B.value,this.wO[B]=Sys.Serialization.JavaScriptSerializer.serialize(this.wO[B]);t=Date.now();B=this.Zla.Xhd(b(1058).NetworkConnectionHealthChecker.xDb).returnValue;
var v=this.Zla.Xhd(b(1058).NetworkConnectionHealthChecker.sKb).returnValue;this.wO.isOfflineMode=u;this.wO.networkDownBBAge=-1===B?B:t-B;this.wO.transientServerCommunicationFailuresBBAge=-1===v?v:t-v;this.Zla.businessBar?(this.wO.isNetworkDownBBShown=this.Zla.businessBar.vC(54).toString(),this.wO.isServerErrorBBShown=this.Zla.businessBar.vC(21).toString()):(this.wO.isNetworkDownBBShown="unknown",this.wO.isServerErrorBBShown="unknown");m.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",
Sys.Serialization.JavaScriptSerializer.serialize(this.wO))};c.prototype.KGj=function(t){for(var u=b(1058).NetworkConnectionHealthChecker,B={},v=Cl(Object.keys(this.wO)),C=v.next();!C.done;C=v.next())C=this.wO[C.value],B[C.testName]=C.isSuccess;B.isOfflineMode=t;this.Zla.$Ud(u.N2c,Sys.Serialization.JavaScriptSerializer.serialize(B))};Object(z.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(E,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Yn(this.Gg),
this.na&&(this.na.qf.xIb(this.Zya),this.na.Yz(this.Wn),this.na.Dr(this.Th)))};a.prototype.JHi=function(t){var u={};u.Timestamp=Date.now().toString();switch(t.aHa){case 21:this.r8a=t.data.FailedMethod;u.FailedMethod=this.r8a;this.$Ud(a.sKb,JSON.stringify(u));break;case 54:this.$Ud(a.xDb,JSON.stringify(u))}};a.prototype.IHi=function(t){switch(t.aHa){case 21:this.M8a(a.sKb,!0);break;case 54:this.M8a(a.xDb,!0)}};a.prototype.$Ud=function(t,u){try{this.localStorage.Mg()&&this.localStorage.setItem(t,u)}catch(B){m.ULS.sendTraceTag(537155231,
0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",B.message||"Unknown")}};a.prototype.Xhd=function(t){if(this.localStorage.Mg()&&(t=this.localStorage.iwb(t))&&"null"!==t){var u=JSON.parse(t);t=parseInt(u.Timestamp,10);u=Sys.Serialization.JavaScriptSerializer.serialize(u);return{returnValue:t,rawData:u}}return{returnValue:-1,rawData:null}};a.prototype.snf=function(t){if(this.localStorage.Mg()){var u=this.localStorage.iwb(a.N2c);if(u&&"null"!==
u){var B=-1;this.R3b&&(B=this.aPh(a.kuf,a.uGi));m.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(u),B,t);this.localStorage.removeItem(a.N2c)}}};a.prototype.aPh=function(t,u){if(!this.U2f())return-1;window.performance.measure(u,t);t=window.performance.getEntriesByName(u);return t.length&&t[t.length-1]?t[t.length-1].duration:(m.ULS.sendTraceTag(537155228,
0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",u),-1)};a.prototype.M8a=function(t,u){try{var B=this.Xhd(t);var v=B.rawData;var C=B.returnValue;if(-1!==C){var A=Object(f.a)(new e,{timeElapsed:Date.now()-C,scenario:t,isNewSession:!u,rawData:v});m.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(A))}this.localStorage.removeItem(t)}catch(M){m.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",
M.message||"Unknown")}};a.prototype.U2f=function(){return h.HelperMethods.sZc&&n.a.Bpb};a.xDb="NetworkDownBBShown";a.sKb="ServerCommunicationFailureBBShown";a.N2c="ConnectionHealthPingRsults";a.kuf="offMoStMa";a.uGi="offMoDuMea";Object(z.a)(a,"NetworkConnectionHealthChecker",null,[2])},1277:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.AEc="b-ring_Apc_Trans";a.tig="cdn_static_resource_ewa_image";Object(z.a)(a,"ResourceHosts",null,[])},1321:function(z,E,b){function a(){}function c(h,
y,r,x,t){this.url="";this.g6a=!1;this.p8=-1;this.testIteration=0;this.baseUrl=r;this.uwf=x;this.jld=y;this.result=new e(y,t)}function e(h,y){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=h;this.caller=y;this.reset()}z=b(0);var f=b(56),m=b(14),n=b(260);e.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage=
"";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(z.a)(e,"NetworkTestResult",null,[]);var w=b(641);c.prototype.runTest=function(){try{if(this.g6a)return m.ULS.sendTraceTag(537155206,0,50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.jld),!1;this.reset();this.g6a=!0;this.result.startTimeMs=Date.now();var h=new n.QueryStringBuilder(this.baseUrl);h.i$("tid",this.result.startTimeMs.toString());this.url=h.toString();this.unj();this.testIteration++;
this.result.testIteration=this.testIteration;return!0}catch(y){return this.tub("Exeption: "+y.message),!1}};c.prototype.reset=function(){this.url="";this.result.reset();this.g6a=!1;this.p8=-1};c.prototype.clearTimeout=function(){-1!==this.p8&&(window.clearTimeout(this.p8),this.p8=-1)};c.prototype.unj=function(){var h=this;try{var y=new XMLHttpRequest;y.onreadystatechange=function(){4===y.readyState&&(200===y.status?h.ZCh():h.tub(String.format("Error when downloading resource. status code: {0}, status text: {1}",
y.status,y.statusText),y.status.toString()))};y.onerror=function(){h.tub(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",y.status,y.statusText))};this.p8=window.setTimeout(function(){h.p8=-1;h.tub("Request timeout")},1E4);y.open("GET",this.url,!0);y.send(null)}catch(r){this.tub("Exeption: "+r.message)}};c.prototype.ZCh=function(){this.g6a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=
w.a(this.url),this.result.isSuccess=!0,this.E3b())};c.prototype.tub=function(h,y){y=void 0===y?null:y;this.g6a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=y,this.E3b())};c.prototype.E3b=function(){this.g6a=!1;this.uwf&&this.uwf(this.result,this.jld)};Object(z.a)(c,"NetworkTestReq",null,[]);b.d(E,"a",function(){return a});a.sdd=function(h,y,r,x){x=void 0===x?null:x;a.mmc||(a.mmc=Array.isArray(f.a.oi(r.ya.NetworkMeasurementUrlList))?f.a.oi(r.ya.NetworkMeasurementUrlList):
null);for(var t=[],u=0;u<a.mmc.length;u++){var B=a.mmc[u],v=B.key;v||(v=B.Key);if(!x||Array.contains(x,v)){var C=B.value;C||(C=B.Value);v&&C&&t.push(new c(r,v,C,h,y))}}return t};a.mmc=null;Object(z.a)(a,"NetworkConnectionHelpers",null,[])},1437:function(z,E,b){function a(W){var Ja=Aj.call(this)||this;Ja.$=W;Ja.Tb();return Ja}function c(){}function e(W,Ja,Eb,gc,Yc,vd,fe){W=m.call(this,W,Ja,Eb,gc,Yc,!1)||this;W.f_d=!1;W.t1=fe;W.$ec=e.kHh(vd);vd=W.E_d(W.$ec.name,W.$ec.size);if(0!==vd)return W.VSd(vd),
W.t1.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),W.dispose(),W;W.Lj=new r(W.$.domElement,Object(qb.a)(W,W.CFb,"onUploadFrameInitialized"),Object(qb.a)(W,W.dpa,"uploadResponseReceived"),gc,!1,W.$);return W}function f(W,Ja){this.filename=W;this.blob=Ja}function m(W,Ja,Eb,gc,Yc,vd){vd=void 0===vd?!0:vd;W=h.call(this,W,Eb,gc,Yc,!1)||this;W.Td=Ja;vd&&W.showDialog();return W}function n(W,Ja){this.dataUri=this.sheetName=null;this.sheetName=W;this.dataUri=Ja}function w(W,Ja,Eb,gc,
Yc,vd){vd=void 0===vd?!0:vd;Ja=h.call(this,W,Ja,Eb,gc,!1)||this;Ja.dBh=Yc;Ja.c$b=W.Ob.$g("LoadResource","FileReaderUploaderLoadResource");vd&&Ja.showDialog();return Ja}function h(W,Ja,Eb,gc,Yc){Yc=void 0===Yc?!0:Yc;var vd=pb.call(this,null,Ja,Eb)||this;vd.At=null;vd.Paa=null;vd.S7a=!1;vd.EEd=null;vd.dpa=function(fe){vd.v0d.stop();vd.y0b.cancel();if(r.Fii(fe))vd.LAc?vd.x6e(4):(fe=new Bj.a(0,2,null,null,!1,null,null,null),fe.status=8,vd.MXd(new ih.a(fe),null,"InsertPictureWebMethod")),Rb.ULS.sendTraceTag(526399121,
0,50,"Http Error occurred, isTimeoutError: {0}",vd.LAc);else{var re=h.eWj(fe);0!==re?(Rb.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",fe),vd.x6e(re)):vd.F5h(fe)}vd.gpc();vd.dispose()};vd.$Ki=function(fe){vd.qCa(fe,vd.Lj)&&vd.finalizeUpload(vd.Lj,null)};vd.CFb=function(fe){Rb.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");vd.Lj=fe;if(!vd.T1a){if(vd.f_d){if(vd.bxe()||vd.v9a&&ug.a.CF){fe.t7b(vd.$Ki);return}var re=fe.t7b(null);if(!vd.qCa(re,fe))return}vd.finalizeUpload(fe,
null)}};vd.hUi=function(){vd.LAc=!0};vd.wb=W;vd.v0d=W.Ob.$g("WebServiceCall","InsertPictureOperation");vd.y0b=nh.a.instance.create(vd.hUi,1E5,fh.a.mOg,!1);vd.LAc=!1;vd.plc=vd.$.ya.InsertPictureMaxFileSizeBytes;gc&&(vd.S7a="TestOnly"in gc);Yc&&vd.showDialog();return vd}function y(W,Ja,Eb){var gc=u.call(this,W,!1)||this;gc.AV=null;gc.wBa=!1;gc.unc=function(){gc.iZd("");gc.LBc();return!1};gc.$=Ja;gc.QCc=W;gc.uR=Vh.a.instance;gc.ga=Eb;gc.b1f();gc.Mmd();gc.$.zb.Mz=!0;return gc}function r(W,Ja,Eb,gc,Yc,
vd,fe){W=x.call(this,W,Ja,Eb,gc,Yc,"UploadFrame",vd.ea.sessionId,"image/*",!1,null,void 0===fe?!1:fe)||this;W.$=vd;W.mfg=!0;xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?W.abf():W.yre();return W}function x(W,Ja,Eb,gc,Yc,vd,fe,re,Oe,Wc,Pf){Oe=void 0===Oe?!0:Oe;Pf=void 0===Pf?!1:Pf;this.VTe="FileUpload.ashx";this.ho=null;this._initialized=!1;this.Qg=this.Yib=this.aJc=this.Yga=this.OSb=this.fr=this.Ks=null;this.Cm=!1;this.ZD=this.PSb=this.qTc=null;this._parent=
W;this.Yqg=Ja;this.Evg=Eb;this.g8d=Yc;this.rRc=fe;this.j2d=re;this.h4d=void 0===Wc?null:Wc;this.pTc=!1;this.rrg=gc.ra("CanaryRenewalForFileUploadIsEnabled");this.mfg=!1;(this.fra=Pf)||this.$4g(vd);Oe&&this.abf()}function t(W,Ja,Eb){if(W){var gc=0;do{try{W();break}catch(Yc){if(Rb.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",gc,Eb,Yc.message,Yc.stack),gc>=Ja)break}gc++}while(1)}}function u(W,Ja){return v.call(this,W,void 0===Ja?
!0:Ja)||this}function B(){}function v(W,Ja){Ja=void 0===Ja?!0:Ja;var Eb=Cj.call(this,!1,!1,v.Hu)||this;Eb.HXa=null;Eb.D7d=!1;Eb.fn=[];Eb.Lj=null;Eb.TXb=W;Eb.swg=Ja;Eb.Wie=!1;Eb.dw=!1;Eb.Yga=null;Eb.bJc=!1;Eb.gg=Eb.wfh;Eb.Oe="InsertFileDialog";Eb.Bc(1,Eb.pYb);if(v.Hu){W={};Ja={};var gc={};Eb.HXa=(gc.id=Eb.Oe,gc.bodyControls=(Ja.uploadButtonProps=(W.label=CommonUIStrings.l_DialogChooseFile,W.onExecute=Object(qb.a)(Eb,Eb.KUi,"onUploadButtonClick"),W),Ja),gc.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,
gc.onFrameReady=Object(qb.a)(Eb,Eb.BLi,"onFrameReady"),gc);Eb.initializeAndShow(Eb.titleText,Object(qb.a)(Eb,Eb.Efc,"insertDialogHandler"),Eb.HXa);Eb.qSb=!0}else Eb.showDialog(Eb.titleText,Object(qb.a)(Eb,Eb.Efc,"insertDialogHandler")),Ja&&Eb.b1f(),(W=Eb.RV(1))&&Eb.fn.push(W),(W=Eb.RV(0))&&Eb.fn.push(W),Eb.Xdg(),Eb.qSb=!1;return Eb}function C(W){var Ja=sj.call(this)||this;Ja.$=W;Ja.Tb();return Ja}function A(W,Ja,Eb,gc){var Yc=this;this.kL=null;this.oeg=function(){Yc.kL&&(Yc.i0d=ma.a.Ta.oe.m,Yc.hide(),
nh.a.instance.create(function(){Yc.wTj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.tJe=function(vd){10===vd&&Yc.RIa()};this.tgh=function(){if(Yc.kL){var vd=document.getElementById("PasteRecoveryUI");vd&&Uc.a.yj===vd.getAttribute(Uc.a.gZ)&&vd.click();Yc.documentHidden=!0;Yc.RIa()}};this.uJe=function(){Yc.RIa()};this.vJe=function(){Yc.RIa()};this.onKeyUp=function(vd){if(Yc.kL){if(Yc.S_)return!1;if(17===vd.Ca.keyCode&&Yc.D9b){vd=document.getElementById("PasteRecoveryUI");
if(!vd)return Rb.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var fe=vd.getAttribute(Uc.a.gZ)||"";if(Uc.a.Xo===fe)return vd.click(),!0}}return!1};this.onKeyDown=function(vd){if(Yc.kL){Yc.D9b=!1;Yc.S_=vd.ctrlKey;vd=vd.Ca.keyCode;if(27===vd)return Yc.RIa(),!0;if(17===vd)return Yc.D9b=!0}return!1};this.n0=function(vd,fe){vd=fe.Td;Yc.oBb=vd;-1027730316!==vd.command&&-1059615499!==vd.command?Yc.RIa():(fe=fe.properties)&&fe.launcherId!==Yc.YSh()&&Yc.RIa()};
this.$=W;this.Jrc=Ja;this.xr=Eb;this.ol=gc;this.wtd=this.oBb=this.ltd=null;this.S_=this.D9b=this.$6b=this.qec=!1;this.i0d=0;this.documentHidden=!1;xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)||this.$.da.Ga(406,this)}function M(W){var Ja=li.call(this)||this;Ja.$=W;Ja.Tb();return Ja}function T(W,Ja,Eb){Eb=void 0===Eb?!0:Eb;var gc=hg.call(this)||this;gc.RSa=null;gc.loa=null;gc.XOa=null;gc.S3b=null;gc.m1=null;gc.usf=0;gc.Abb=!1;gc.zbb=!1;gc.vsc=!1;gc.documentVisibilityObserver=
null;gc.vsf=null;gc.MCj=null;gc.dga=!1;gc.n8=0;gc.emd=0;gc.qAb=!1;gc.B5f=0;gc.RRd=!1;gc.x1=null;gc.ZEb=function(){Rb.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");gc.Plc(1,!1)};gc.Qya=function(){gc.Wka||gc.xCb?window.setTimeout(function(){gc.WWd()},gc.usf):gc.WWd();gc.documentVisibilityObserver.oIb(gc.Qya);gc.qAb=!1};gc.Ng=function(){Rb.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",
gc.xCb&&gc.Gxc,gc.Pkc&&!gc.dga&&gc.zLb);gc.xCb&&gc.Gxc&&gc.ile();gc.Pkc&&!gc.dga&&gc.zLb&&gc.fle();$d.g(gc.$).Ac.Zn(gc.Ng);gc.zbb=!1;gc.Abb=!1};gc.ZAf=function(){Rb.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");gc.Plc(1,!0);gc.zbb&&!gc.Abb&&$d.g(gc.$).Ac.Zn(gc.Ng);gc.zbb=!1};gc.Uca=function(Yc,vd){gc.emd=gc.n8;gc.n8=vd.GAc};gc.YDf=function(){gc.$&&(gc.vsc||(vh.a(gc.$).gR(og.a.BPa).sFg(gc.iBf),gc.$.tl(gc.zd),gc.vsc=!0),gc.dga=gc.Xfi(),
gc.Plc(2,!1))};gc.iBf=function(){var Yc=vh.a(gc.$).xi,vd=Yc.zLg();Yc=xh.f(Yc.Is.rd.errors,function(fe){return fe.MessageIdName});Rb.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",vd,gc.dga,ph.a.Lc(Yc));vd&&(gc.RSa?(gc.dga=!1,gc.kHe(),gc.IBc()):gc.loa&&(gc.lHe(),gc.IBc()))};gc.zd=function(){gc.$?(Rb.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),
gc.dga=!1,xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&gc.m1&&gc.m1.yp&&(Jh.a.Ha(gc.m1),gc.m1=null),xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&gc.x1&&gc.x1.yp&&(Jh.a.Ha(gc.x1),gc.x1=null),gc.Plc(2,!0),gc.IBc()):Rb.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};gc.Cwf=function(){gc.rrf(!0)};gc.Dwf=function(){gc.rrf(!1)};
gc.GWb=na.uti;gc.O2c=na.connected;gc.$=W;gc.qf=W.na.qf;gc.H2f=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");gc.zLb=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");gc.Gxc=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");Eb&&(gc.vsf=new ea(W,Ja));xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&gc.$.da.$a(291,function(Yc){gc.documentVisibilityObserver=
Yc});gc.Gxc&&(xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||gc.$.da.$a(291,function(Yc){gc.documentVisibilityObserver=Yc}),gc.usf=gc.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,gc.qf.yGg(gc.ZEb),gc.qf.$nb(gc.ZAf),gc.qf.aoe(gc.Cwf),gc.qf.ZEg(gc.Dwf));if(gc.H2f||gc.zLb)gc.MCj=new R(gc.$,gc);gc.cof=gc.$.ya.LongInactivityTimePeriodSeconds;gc.$.ea.oWc(gc.YDf);gc.$.ea.sf.ksa(gc.Uca);gc.zLb&&(gc.B5f=gc.$.ya.SilentReopenDuringWorkDelayMs);return gc}function R(W){var Ja=
this;this.d8=null;this.ZDf=function(Eb,gc){Ja.WDf(gc,3)};this.sAf=function(Eb,gc){Ja.WDf(gc,2)};this.$=W;this.tg=tf.a(this.$).tg;this.tg.Goe(this.sAf);this.tg.MHg(this.ZDf)}function Q(W,Ja,Eb,gc){W=aa.call(this,W,Ja,Eb)||this;W.wasInteruptedByOfflineMode=!1;W.type=gc;W.wasInteruptedByOfflineMode=!1;return W}function ea(W,Ja){this.Zla=this.Gyd=this.luf=null;this.$=W;!xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||xd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
ug.a.Hf||(this.luf=new Z(W,Ja));xd.EwaSettings.ma(213)&&(this.Gyd=new H(this.$),this.Gyd.L$h());!xd.EwaSettings.ma(570)||xd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&ug.a.Hf||(this.Zla=new Hg.NetworkConnectionHealthChecker(this.$));this.d2g=new L(this.$)}function Z(W,Ja){var Eb=this;this.WOa=this.hV=null;this.aGd=-1;this.Gub=null;this.Kkf=ic.Task.delay(0);this.v$a=function(gc,Yc){Yc.WP?Eb.kQi(Yc.zoa):Eb.lQi()};this.Vca=function(gc,Yc){5===Yc.QGf&&Eb.p3a()};
this.eWf=function(gc,Yc){Eb.hV.Nqj(Yc.zV)};this.p3a=function(){Eb.WOa.ERj();Eb.Ukj(Z.eEd,Sys.Serialization.JavaScriptSerializer.serialize(Eb.WOa))};this.Qfj=function(gc){if(gc=gc.result)Eb.Rgg=!0,Rb.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",gc)};this.caj=function(){Eb.Rgg&&(Eb.$?Nd.TaskExtensions.Ba(Eb.indexedDB.I6c(Z.eEd),function(){Rb.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},
Eb.$.la):Rb.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.aPa=function(){if(Eb.WOa&&0<Eb.WOa.count){var gc=Sys.Serialization.JavaScriptSerializer.serialize(Eb.WOa);Rb.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",gc)}};this.$=W;this.indexedDB=Ja;this.Rgg=!1;this.indexedDB.Mg()&&(this.indexedDB.initialize(Z.lmd,
Z.mmd),this.jfj(),this.WOa=new I(this.$.ya.UserSessionId),tf.a(this.$).tg.WVc(this.v$a));this.ol=Ag.a.instance.PE();this.ol.ka("beforeunload",this.aPa)}function ca(W,Ja,Eb){W=aa.call(this,W,Ja,Eb)||this;W.timeFromLastOffline=0;W._errorDataDuringOfflineMode=null;W.timeFromLastOffline=-1;W.type=5;return W}function I(W){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=W}function H(W){var Ja=this;
this.hVf=null;this.std=this.Fxd=this.SDb=this.TDb=0;this.YRd=!1;this.F2c=this.VSa=this.Tyc=this.A9a=null;this.T2c=0;this.xnj=function(){if(12E4>Ja.$.ea.sf.Teb)for(var Eb=Cl(Ja.Tyc),gc=Eb.next();!gc.done;gc=Eb.next())gc.value.runTest();else Ja.RUd("UserInactive")};this.$fj=function(Eb){Eb=Sys.Serialization.JavaScriptSerializer.serialize(Eb);Rb.ULS.sendTraceTag(388821830,0,50,Eb)};this.ofj=function(Eb){if(Eb){var gc=Ja.F2c[Eb.testIteration.toString()];gc?gc.push(Eb):(gc=[Eb],Ja.F2c[Eb.testIteration.toString()]=
gc);if(gc.length===Ja.hVf.length){gc=Sys.Serialization.JavaScriptSerializer.serialize(gc);if(Ja.$&&Ja.$.qf){if(Eb.EstimatedLatency=Ja.$.qf.due,Ja.$.qf.due>Ja.$.Yu.ExcelRountripThresholdMs){Rb.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",gc,Ja.T2c++);return}}else Rb.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");Rb.ULS.sendTraceTag(570712142,0,50,
"Periodic ping tests results: {0}",gc);Ja.T2c=1}}};this.Th=function(Eb,gc){Eb=gc.context.methodName;if(Eb===Ae.a.Cwb||Eb===Ae.a.SKa)Ja.SDb++,Eb=Date.now(),Ja.Txj(Eb)&&(Ja.SDb=0,Ja.std=Eb,Ja.OFj())};this.Uca=function(){Ja.yUd("OnThrottledUserActivity")};this.PW=function(){Ja.RUd("OnDocumentHidden")};this.Qya=function(){Ja.yUd("OnDocumentUnhidden")};this.$=W;if(this.ZRd=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.BXg())this.hVf=[wh.a.AEc],this.T2c=1,this.F2c=
{},this.$.ea.sf.ksa(this.Uca),this.$.da.$a(291,function(Eb){Eb.fGa(Ja.PW);Eb.Tnb(Ja.Qya)})}function L(W){var Ja=this;this.Cjc=this.data=null;this.zad=0;this.xCe=null;this.Ewf=function(Eb,gc){gc.WP?(Ja.data=new fa(ma.a.Ta.Wb,Ja.$,5===gc.zoa,0!==gc.zoa,Ja.$.qf.disconnectionSource,Ja.xCe),Ja.Cjc=Ja.$.qf.Qkf,Ja.zad=1,Ja.$.na.qf.iIg(Ja.Wn),ch.a(Ja.$).LVc(Ja.dWf)):(Ja.data.hJi(Ja.$,5===gc.zoa),Ja.$.na.qf.KRf(Ja.Wn),Ja.data.lastFailedRequestToOnlineTimeGapSec=cf.getElapsedSeconds(Ja.Cjc,ma.a.Ta.Wb),xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
Vg.b().oKb(557682689,0,50,U.connectivityIssues,Ja.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",ph.a.Lc(Ja.data)):Rb.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",ph.a.Lc(Ja.data)),xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ja.data&&Ja.data.isToastShown&&tc.Health.instance.recordQosError(Xc.a.qZg,[Od.a.ekc],
!0,!1,!1,!1,null),ch.a(Ja.$).bKd(Ja.dWf),Ja.data=null)};this.dWf=function(Eb,gc){Ja.data.Mqj(gc.zV)};this.Wn=function(Eb,gc){Ja.data.x7i(gc.context.methodName);Eb=ma.a.Ta.Wb;gc=cf.getElapsedSeconds(Ja.Cjc,Eb);Ja.Cjc=Eb;gc>Ja.data.longestDurationBetweenFailedRequestsSec&&(Ja.data.longestDurationBetweenFailedRequestsSec=gc);Ja.zad++;Ja.data.averageDurationBetweenFailedRequestsSec=Ja.XTg(gc)};this.Bwf=function(Eb,gc){Ja.xCe=gc.rNj};this.$=W;tf.a(this.$).tg.boe(this.Ewf);this.$.qf.aoe(this.Bwf)}function U(){}
function fa(W,Ja,Eb,gc,Yc,vd){W=aa.call(this,W,Ja,gc)||this;W.swappedByOffline=!1;W.swappedOffline=!1;W.averageDurationBetweenFailedRequestsSec=0;W.longestDurationBetweenFailedRequestsSec=0;W.lastFailedRequestToOnlineTimeGapSec=0;W.disconnectionSource=null;W.errorDataDuringConnectivityIssuesMode=null;W.failedRequests=[];W.triggeringRequest=null;W.type=4;W.swappedOffline=Eb;W.disconnectionSource=Enum.toString(rg.a,Yc);W.triggeringRequest=vd;return W}function aa(W,Ja,Eb){var gc=this,Yc;this.type=0;
this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.rvf=function(vd,fe){gc.blockedOperationsCount++;vd=String.format("{0}_{1}_{2})",fe.componentName,fe.actionName,fe.details);
gc.blockedActions[vd]=gc.blockedActions[vd]?gc.blockedActions[vd]+1:1;gc.isToastShown&&gc.blockedUserOperationsWhileToastShown++};this.fDd=function(vd){gc.durationUntilUserInactive=cf.getElapsedSeconds(gc.startTime,ma.a.Ta.Wb);vd.HKd(gc.fDd)};this.PW=function(){gc.hasTabbedOut=!0};this.Vca=function(vd,fe){fe.QGf!==gc.type||gc.isToastShown||(gc.durationUntilToastShownMs=ag.a(ma.a.Ta,gc.startTime),gc.toastRaiser=fe.toastRaiser,gc.isToastShown=!0)};this.startTime=W;this.durationUntilToastShownMs=0;this.blockedActions=
{};this.isToastShown=Eb;if(null===(Yc=Ja.ea)||void 0===Yc?0:Yc.sf)this.wasUserActiveOnPIStart=Ja.ea.sf.vr;this.Ek(Ja);xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ja.zb.pS,W=Ja.da.Aa(183),this.isTaskPaneShown=!!W&&W.isVisible&&!W.isCollapsed,this.isTaskPaneCollapsed=!!W&&W.isVisible&&W.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function na(){}function ha(W){var Ja=xe.call(this)||this;Ja.Rc=W;Ja.Tb();return Ja}function ka(W,
Ja,Eb){Eb=void 0===Eb?null:Eb;var gc=id.call(this)||this;gc.b0a=null;gc.X5a=null;gc.jfc=null;gc.lDa=null;Rb.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");gc.$=W;gc.zXa=new db(W);xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1)&&(gc.LAa=new xa(gc.$));gc.Z1a=new qa(gc.$.na.va,gc.$,void 0,void 0,gc.LAa);gc.gai(W,Eb);gc.nga=new kb(gc.lDa,gc.zXa);gc.yLd=new wa(W,gc.nga,Ja,gc.Z1a);xd.EwaSettings.ma(255)&&(gc.jfc=new gb(W,gc));Rb.ULS.sendTraceTag(588276810,
0,50,"MergeSuspensionManager created");return gc}function xa(W){var Ja=this;this.pzc=0;this.oC=this.$C=null;this.I2d=new Aa;this.J2d=new Aa(!0);this.EF=0;this.iJj=!1;this.wBi=1E4;this.Qi=function(){Ja.gYc(!0,!1)};this.W9a=function(){Ja.gYc(!1,!1)};this.$=W;this.gridView=$d.g(this.$);this.gridView.Ea.Ix(this.Qi);this.gridView.Ea.Ss(this.W9a);this.gridView.Ea.Une(this.W9a);this.gridView.Ea.oha(this.W9a);this.agj=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.$.da.$a(276,
function(){bc.a(Ja.$).f3(Ja.I2d);bc.a(Ja.$).f3(Ja.J2d)});this.oDb=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1)}function va(W,Ja,Eb,gc,Yc){this.wb=W;this.CG=Ja;this.X9=Eb;this.PWb=gc;this.Rkg=Yc;(this.pOc=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1))?this.v3d=this.selectedRanges.map(function(vd){return $d.g(W).Ea.vKa(vd,Yc)}):this.cVa&&(this.v3d=[$d.g(W).Ea.vKa(this.selectedRanges[0],Yc)])}function Aa(W){this.differentSheetAdjust=
this.parallel=this.errors=this.nonContinuous=this.divergence=this.adjusted=this.adjustedDidntChange=0;this.K9h=void 0===W?!1:W}function qa(W,Ja,Eb,gc,Yc){Eb=void 0===Eb?null:Eb;gc=void 0===gc?null:gc;Yc=void 0===Yc?null:Yc;var vd=ab.call(this)||this;vd.CBb=null;vd.jDd=0;vd.documentVisibilityObserver=null;vd.$jf=!1;vd.va=W;vd.guc=Ja.ya.MergeSuspensionRequestThrottlingTimeInMs;var fe=Ja.ya.GetRangeContentPrefetchDelayForMergeInMs;vd.Oy=function(){Ja.RWf(fe)};vd.hh=Eb||ma.a.Ta;vd.dDc=0;vd.bP=gc;vd.LAa=
Yc;vd.PGe=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMHiddenTabRequestThrottling",!1);vd.hfg=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6248201_useDoPendingMergeSuccessCallback");vd.AUg=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6237816_CallDoPendingMergeRequest");vd.PGe&&(vd.u7h=Ja.ya.MergeSuspensionHiddenTabRequestThrottlingTimeInMs);Ja.da.$a(291,function(re){vd.documentVisibilityObserver=re});return vd}function wa(W,Ja,Eb,gc){var Yc=qe.call(this)||this;Yc.Z1a=null;Yc.dBb=
0;Yc.i8a=null;Yc.eBb=null;Yc.iCf=function(vd,fe){Yc.Z1a.iNg(fe.Dca,fe.IJg)};Yc.zFb=function(vd,fe){fe.sxa?Yc.vFj():Yc.uzc()};Yc.xAf=function(){Yc.dBb=0};Yc.gYf=function(){var vd=Yc.v6.hgd();Ta(Yc.va,null!=vd.SuspensionStartTimestamp?vd.SuspensionStartTimestamp:0,null,function(){Yc.AOi(vd)},null,null,Yc.va.hc())};Yc.J8=function(vd,fe){if(fe){fe.AGa.MergeCount=Yc.v6.hgd();var re=$d.g(Yc.$).sBi();vd=re.min;re=re.max;xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?fe.AGa.ClientRevisions=
Object(Cg.a)(new sb,{Min:vd,Max:re,MaxFromBlockCache:$d.g(Yc.$).Ea.vqf}):fe.AGa.ClientRevisions=Object(Cg.a)(new sb,{Min:vd,Max:re})}};Yc.$=W;Yc.YZa=Eb;Yc.v6=Ja;Yc.v6.jHg(Yc.iCf);Yc.v6.c_b(Yc.zFb);Yc.v6.rGg(Yc.xAf);Yc.$.na.n$(Yc.J8);Yc.va=Yc.$.na.va;Yc.guc=Yc.$.ya.MergeSuspensionRequestThrottlingTimeInMs;Yc.$qi=Yc.$.ya.KeepBlockingPendingMergesRequestIntervalMs;Yc.Z1a=gc;Rb.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return Yc}function Ta(W,Ja,Eb,gc,Yc,vd,fe){fe=W.Na(1,void 0===
fe?null:fe);fe.suspensionStartTimestamp=Ja;return Vd.i(W,"KeepBlockingPendingMerges",fe,Eb,gc,Yc,vd,0)}function sb(){}function db(W){var Ja=ce.call(this)||this;Ja.u2=null;Ja.Hjc=0;Ja.I8=function(Eb,gc){var Yc;if(null===(Yc=null===gc||void 0===gc?void 0:gc.od)||void 0===Yc?0:Yc.MergeCount)Xb.a.equals(gc.od.SessionId,Ja.$.ea.sessionId,!1)?Ja.nPa(gc.od.MergeCount,db.W7c):Rb.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",gc.od.MergeCount.Current,gc.od.MergeCount.Pending)};Ja.$Cb=function(Eb,
gc){(null===gc||void 0===gc?0:gc.Dca)&&Ja.nPa(gc.Dca,db.x0d)};Ja.hwc=function(){Ja.STf();Ja.JLf(Ja.u2)};Ja.c$a=function(Eb,gc){gc.LBe&&Ja.u2.SuspensionStartTimestamp&&Rb.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",Wa(Ja.u2))};Ja.STf();Ja.$=W;Ja.$.na.Bq(Ja.I8);Ja.$.ea.gk(Ja.hwc);Ja.$.ea.vM(Ja.hwc);$d.g(Ja.$).rc.To(Ja.c$a);Ja.$.da.$a(292,function(Eb){Eb.jZa(Ja.$Cb);Rb.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return Ja}
function kb(W,Ja){var Eb=md.call(this)||this;Eb.Wya=function(gc,Yc){gc=Eb.getState();var vd=Eb.Sla;Eb.Sla=Yc.Dca;Yc=Eb.getState();Eb.uwi(gc,Yc,vd);Eb.raiseEvent(kb.qxd);Eb.PUe(gc,Yc)};Eb.qPa=function(gc,Yc){gc=Eb.getState();Eb.nI=Yc.nI;Yc=Eb.getState();Eb.PUe(gc,Yc)};Eb.lzb=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);Eb.kia=W;Eb.kia.YZb(Eb.qPa);Eb.Kma=Ja;Eb.Kma.jZa(Eb.Wya);Eb.Sla=Object(Cg.a)(new P.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});
Eb.nI=Eb.M$h();return Eb}function ac(W,Ja){W=Jb.call(this,W)||this;W.IJg=Ja;return W}function ta(W){this.tqe=!1;this.tqe=W;return this}function ra(){}function Na(W){var Ja=ja.call(this)||this;Ja.sxa=W;return Ja}function gb(W,Ja){var Eb=S.call(this)||this;Eb.statusBarManager=null;Eb.Tyd=!1;Eb.Wya=function(gc,Yc){gc=String.format("{0}{1}",Yc.Dca.Current===Yc.Dca.Pending?"\u26ad":"\u26ae",Yc.Dca.Current);Xb.a.equals(Eb.pmc,gc,!1)||(Eb.pmc=gc,Eb.Qz())};Eb.qPa=function(gc,Yc){gc=0==Yc.nI;Eb.Tyd!==gc&&
(Eb.Tyd=gc,Eb.Qz())};Eb.mergeSuspensionManager=Ja;Eb.mergeSuspensionManager.Kma.jZa(Eb.Wya);Eb.pmc="";k.a.Z2(1905775613,G.a.Mc,0,1);Eb.Ka=W.Ka;Eb.HNb=new ob;W.da.$a(29,function(gc){Eb.mergeSuspensionManager&&(Eb.statusBarManager=gc,gc.EJ(Eb),Eb.mergeSuspensionManager.kia.YZb(Eb.qPa))});Eb.Ka.a3(Eb.HNb);return Eb}function ob(){return d.call(this)||this}function wb(W,Ja){Ja=void 0===Ja?null:Ja;var Eb=ij.call(this,1)||this;Eb.fga=!1;Eb.YN=function(){Eb.refresh()};Eb.Owf=function(){Eb.refresh()};Eb.$=
W;Eb.f9d=Ja||vh.a(W).gR(og.a.idle);vh.a(W).KVc(Eb.Owf);Eb.W5a.Aq(Eb.YN);Eb.refresh();return Eb}function Oa(W,Ja){var Eb=zh.call(this)||this;Eb.Ikf=null;Eb.Ijc=!1;Eb.vRa=new we.a;Eb.Ske=W;Eb.Kma=Ja;Eb.lzb=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);Eb.lzb&&(Eb.Ske.sGg(Eb.yAf.bind(Eb)),Eb.Kma.jZa(Eb.Wya.bind(Eb)));return Eb}function sa(W){return(null===W||void 0===W?void 0:W.SuspensionStartTimestamp)&&W.Pending>W.Current}function Fa(W,Ja){return W||Ja?
W&&Ja?W.Current===Ja.Current&&W.Pending===Ja.Pending&&W.SuspensionStartTimestamp===Ja.SuspensionStartTimestamp:!1:!0}function Wa(W){return W?String.format("{0} / {1} @{2}",W.Current,W.Pending,W.SuspensionStartTimestamp):null}function Db(W,Ja){this.handler=null;this.publisher=W;this.nI=Ja}function pc(W){var Ja=Df.call(this,1)||this;Ja.fga=!1;Ja.Jvf=function(){Ja.refresh()};Ja.Kvf=function(){Ja.refresh()};Ja.gridView=$d.g(W);Ja.gridView.rc.sl(Ja.Kvf);Ja.gridView.rc.To(Ja.Jvf);Ja.refresh();return Ja}
function lc(W){return kh.call(this,W)||this}function eb(W,Ja){this.$=W;this.uploaderCreator=Ja}function ib(W,Ja,Eb,gc,Yc,vd){var fe=pb.call(this,null,Eb,gc)||this;fe.kof=0;fe.EQi=function(re){Bb.a(re)?Rb.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",ue.a.Xc(re.Errors)):(Rb.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),re.Result?Ei.a(fe.$).Dna(1,re.Result):
Rb.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};fe.DQi=function(){Rb.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};fe.$=W;fe.Td=Ja;fe.t1=vd;fe.bre=Bd.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");fe.showDialog();return fe}function cc(W,Ja,Eb,gc,Yc,vd){var fe=Fh.call(this)||this;fe.khc=!1;fe.Jwa=null;fe.uS=null;fe.VNa=null;fe.VHi=function(){fe.Tua(fe.Cpb)};
fe.ftd=function(re){re.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==re.target.id||re.shiftKey?"KeepFocusStartDiv"===re.target.id&&re.shiftKey&&(re.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(re.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};fe.QOi=function(){fe.wob&&(fe.wob.launchUpsellExperience("stockimages"),Rb.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};fe.Im=vd;fe.$=W;fe.mbf=Ja;fe.wob=Eb;fe.KAa=[];fe.Lqf=gc;
fe.xfh=Yc;fe.vqe=fe.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;fe.gg=fe.S7g();return fe}function Pa(){}function nc(W,Ja){return Eh.call(this,W,Xg.a.nba(Ja))||this}function pb(W,Ja,Eb){W=rb.call(this,W,Ja,Eb)||this;W.Tra=null;W.yVb=null;return W}function rb(W,Ja,Eb){this.Lj=this.cDd=null;this.iFa=this.xra=0;this.QSb=null;this.JT=W;this.se=Ja;this.vb=Eb;this.T1a=!1;this.f_d=!0;this.fhj();this.v9a=this.ga.ra("NativeFileOpenDialogIsEnabled")}function Ya(W){var Ja=Ug.call(this)||this;Ja.cmd=null;
Ja.$=W;Ja.Tb();return Ja}function ec(W){var Ja=Yg.call(this)||this;Ja.$=W;Ja.Tb();return Ja}function yd(W,Ja){this.dVe=W;this.tDh=Ja}function Ub(W){this.$=W}function Ob(W){var Ja=Ch.call(this)||this;Ja.$=W;Ja.Tb();return Ja}function Yb(W,Ja,Eb){var gc=ki.call(this)||this;gc.statusBarManager=null;gc.eJe=function(){gc.W6b()};gc.bgh=function(){gc.W6b()};gc.dJe=function(Yc){10===Yc&&gc.W6b()};gc.onKeyDown=function(Yc){if(13===Yc.Ca.keyCode){Yc=new wg.a(237279923,1,2,6,null);var vd={};gc.$.Ka.$b(Yc,(vd[Uc.a.skipClipboardAccess]=
!0,vd[Uc.a.VMe]=!0,vd));return!0}return!1};gc.$=W;gc.xr=Ja;gc.ol=Eb;gc.j9c=!1;gc.v3f=xd.EwaSettings.getBooleanFeatureGate(Kf.a.fQa,!1);gc.lif=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");gc.v3f&&gc.$.da.$a(29,function(Yc){gc.statusBarManager=Yc;Yc.EJ(gc)});return gc}function xb(W){var Ja=bh.call(this)||this;Ja.$=W;Ja.Zm=Bf.a.instance;Ja.Tb();return Ja}function Sa(W){var Ja=this;this.M5b="";this.U2=this.Vs=null;this.Mqc=!1;this.Z8e=function(Eb,gc){Ja.hide(void 0===
Eb?null:Eb,void 0===gc?null:gc)};this.gridView=$d.g(W);this.gridView.ha.WG(this.Z8e)}function Tb(){}function Cc(W,Ja){var Eb=wi.call(this,W)||this;Eb.fp=null;Eb.cdi=function(gc,Yc){1===gc?(gc=Cc.Tfh[Yc[Cc.Sfh]],Rb.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",0===gc?"Horizontal":"Vertical"),Eb.fp.setResult(gc)):(Rb.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),
Eb.fp.Cu())};Eb.jh(Ja);return Eb}function Fb(W){this.RFc=this.ZPc=null;this.$=W}function hc(){}function cd(){}function mb(){}function $a(){}function K(W){this.w3c=this.Ata=null;this.fab=15;this.$=W}function ba(W,Ja){this.$=W;this.Qob=Ja}function ua(W,Ja,Eb,gc){W=nd.call(this,W)||this;W.isFromCurrentSession=!1;W.top=0;W.left=0;W.isFromCurrentSession=Ja;W.top=Eb;W.left=gc;return W}function La(W,Ja,Eb,gc,Yc){Yc=void 0===Yc?null:Yc;var vd=Gc.call(this,W,"ArtCopyPasteHandler")||this;vd.KZg="XLO";vd.LZg=
"3";vd.nV=new Ib(W);vd.X$=Ja;vd.VZa=Eb;vd.ha=$d.g(W).ha;vd.y3c=Yc||new zb(vd.X$);vd.mYi=new ub(Eb,W);vd.Qob=gc;return vd}function ub(W,Ja){this.TIb=new Fe.a;this.VZa=W;this.$=Ja;this.X2i=function(Eb){return Promise.resolve(Eb)};this.eFb=function(Eb){return Promise.reject(Eb)}}function Va(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){this.promise=null;this.ribbonCommandInfo=W;this.destination=Ja;this.rIe=Eb;this.TOb=Yc;this.i1=vd;this.item=fe;this.pasteContext=re;this.mOa=Eb||Ja.FirstRow+"_"+Ja.FirstColumn;this.rff=
!0;this.hAe=Oe}function tb(W,Ja,Eb,gc,Yc,vd,fe){this.floatingObjectId=W;this.commandParameters=Ja;this.At=Eb;this.Dbh=gc;this.Qaa=void 0===vd?null:vd;this.TOb=void 0===fe?null:fe;this.d4g=Yc}function Cb(W,Ja,Eb,gc){Ja=hb.call(this,W,Ja,Eb,"AcrossSessionRangeCopyPasteHandler",void 0===gc?null:gc)||this;Ja.nV=new Ib(W);return Ja}function nb(W,Ja){Ja=void 0===Ja?null:Ja;var Eb=kj.call(this,lf[W])||this;Eb.copyErrorName=0;Eb.ewaErrors=null;Eb.copyErrorName=W;Eb.ewaErrors=Ja;if(null===Ja||void 0===Ja?
0:Ja.length)Eb.innerError=new Di.a(Ja,null);return Eb}function Ib(W){this.nV=new eg.a(!0);this.$=W}function hb(W,Ja,Eb,gc,Yc){Yc=void 0===Yc?null:Yc;gc=Gc.call(this,W,gc)||this;gc.n4g=Ja;gc.X$=Eb;gc.z3c=Yc||new zb(gc.X$);gc.gridView=$d.g(W);gc.ha=gc.gridView.ha;gc.clipboardRangeFactory=W.da.Aa(169);return gc}function zb(W){this.clipboardItems=this.key=null;this.X$=W}function Gc(W,Ja){this._name=Ja;this.$=W;this.Zm=Bf.a.instance;this.Xr=new bb(W,$d.g(W))}function Fc(W){return W.shadowWorkbookSizeExceedsLimit?
!0:Ed(W)>Ae.a.slc}function Ed(W){return W?W.shadowWorkbookSizeExceedsLimit&&void 0!==W.shadowWorkbookBlockedSize&&null!==W.shadowWorkbookBlockedSize?W.shadowWorkbookBlockedSize:W.shadowWorkbookBase64?W.shadowWorkbookBase64.length:0:0}function Jc(){}function Ca(W){var Ja={};this.L7f=(Ja["SourceItemType.Range"]=0,Ja["SourceItemType.Art"]=1,Ja);this.yMb={};Ja={};this.H7f=(Ja["FloatingObjectType.Unknown"]=99,Ja["FloatingObjectType.CardView"]=6,Ja["FloatingObjectType.Chart"]=0,Ja["FloatingObjectType.Group"]=
7,Ja["FloatingObjectType.Image"]=1,Ja["FloatingObjectType.Ink"]=8,Ja["FloatingObjectType.InteractiveReport"]=4,Ja["FloatingObjectType.ModernOfficeExtension"]=3,Ja["FloatingObjectType.Shape"]=5,Ja["FloatingObjectType.Slicer"]=2,Ja["FloatingObjectType.Unsupported"]=100,Ja);Ja={};this.PXc=(Ja["99"]="FloatingObjectType.Unknown",Ja["6"]="FloatingObjectType.CardView",Ja["0"]="FloatingObjectType.Chart",Ja["7"]="FloatingObjectType.Group",Ja["1"]="FloatingObjectType.Image",Ja["8"]="FloatingObjectType.Ink",
Ja["4"]="FloatingObjectType.InteractiveReport",Ja["3"]="FloatingObjectType.ModernOfficeExtension",Ja["5"]="FloatingObjectType.Shape",Ja["2"]="FloatingObjectType.Slicer",Ja["100"]="FloatingObjectType.Unsupported",Ja);Ja={};this.K7f=(Ja["RibbonCommand.Copy"]=-911352779,Ja["RibbonCommand.Cut"]=-1985798686,Ja);Ja={};this.HMd=(Ja["-911352779"]="RibbonCommand.Copy",Ja["-1985798686"]="RibbonCommand.Cut",Ja);Ja={};this.J7f=(Ja["InputManager.InputMethod.NotDefined"]=-1,Ja["InputManager.InputMethod.Unknown"]=
0,Ja["InputManager.InputMethod.Keyboard"]=1,Ja["InputManager.InputMethod.Mouse"]=2,Ja["InputManager.InputMethod.Touch"]=3,Ja["InputManager.InputMethod.CrossSlide"]=9,Ja);this.Ika={};Ja={};this.I7f=(Ja["FrameMode.None"]=0,Ja["FrameMode.Reading"]=1,Ja["FrameMode.Edit"]=2,Ja);this.D3a={};Ja={};this.M7f=(Ja["UILocation.Unknown"]=0,Ja["UILocation.UpperRibbon"]=1,Ja["UILocation.Ribbon"]=2,Ja["UILocation.QAT"]=3,Ja["UILocation.Jewel"]=4,Ja["UILocation.NavigationPane"]=5,Ja["UILocation.KeyboardShortcut"]=
6,Ja["UILocation.StatusBar"]=7,Ja["UILocation.Dialog"]=8,Ja["UILocation.Floatie"]=9,Ja["UILocation.NotificationBar"]=10,Ja["UILocation.StandaloneCuiRoot"]=11,Ja["UILocation.TaskPane"]=12,Ja["UILocation.HeroDock"]=13,Ja["UILocation.SingleLineRibbon"]=14,Ja["UILocation.MultilineRibbon"]=15,Ja["UILocation.Overflow"]=16,Ja["UILocation.TellMe"]=17,Ja["UILocation.FarPeripheralControls"]=18,Ja["UILocation.ContextMenu"]=19,Ja["UILocation.DialogMenu"]=20,Ja["UILocation.Header"]=21,Ja["UILocation.FileMenu"]=
22,Ja["UILocation.Toolbar"]=26,Ja["UILocation.Canvas"]=30,Ja);this.Ir={};this.$=W;this.Ika.notDefined="InputManager.InputMethod.NotDefined";this.Ika.unknown="InputManager.InputMethod.Unknown";this.Ika.keyboard="InputManager.InputMethod.Keyboard";this.Ika.mouse="InputManager.InputMethod.Mouse";this.Ika.touch="InputManager.InputMethod.Touch";this.Ika.crossSlide="InputManager.InputMethod.CrossSlide";this.D3a.none="FrameMode.None";this.D3a.reading="FrameMode.Reading";this.D3a.edit="FrameMode.Edit";this.Ir.unknown=
"UILocation.Unknown";this.Ir.upperRibbon="UILocation.UpperRibbon";this.Ir.ribbon="UILocation.Ribbon";this.Ir.QAT="UILocation.QAT";this.Ir.jewel="UILocation.Jewel";this.Ir.navigationPane="UILocation.NavigationPane";this.Ir.keyboardShortcut="UILocation.KeyboardShortcut";this.Ir.statusBar="UILocation.StatusBar";this.Ir.dialog="UILocation.Dialog";this.Ir.floatie="UILocation.Floatie";this.Ir.notificationBar="UILocation.NotificationBar";this.Ir.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Ir.taskPane=
"UILocation.TaskPane";this.Ir.heroDock="UILocation.HeroDock";this.Ir.singleLineRibbon="UILocation.SingleLineRibbon";this.Ir.multilineRibbon="UILocation.MultilineRibbon";this.Ir.overflow="UILocation.Overflow";this.Ir.tellMe="UILocation.TellMe";this.Ir.farPeripheralControls="UILocation.FarPeripheralControls";this.Ir.header="UILocation.Header";this.Ir.fileMenu="UILocation.FileMenu";this.Ir.contextMenu="UILocation.ContextMenu";this.Ir.dialogMenu="UILocation.DialogMenu";this.Ir.toolbar="UILocation.Toolbar";
this.Ir.canvas="UILocation.Canvas";this.yMb.range="SourceItemType.Range";this.yMb.art="SourceItemType.Art"}function bb(W,Ja){this.zjc=this.DNa=null;this.eab=Kf.a.eab;this.xgc=xd.EwaSettings.getBooleanFeatureGate(Kf.a.u5b,!1);this.Mnd=!1;this.ixa=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=W;this.gridView=Ja;this.Mnd&&(this.$.userOperationManager.Wu(Object(qb.a)(this,this.PF,"onQueueChanged")),this.Bv=new we.a)}function dc(W,Ja,Eb,gc,Yc,vd,fe,
re,Oe){this.destinationRange=W;this.vrb=Eb;this.aHf=gc;this.Td=Yc;this.TOb=vd;this.pasteContext=fe;this.zqb=re;this.pXd=Oe}function Ac(W){this.parameters=null;this.parameters=W}function nd(W){this.pasteParameters=null;this.pasteParameters=W}function qd(W,Ja){this.content=this.destinationRange=null;this.destinationRange=W;this.content=Ja}function Gb(W,Ja,Eb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=W;this.destinationRange=Ja;this.pasteFlags=Eb}function Oc(W,Ja,
Eb,gc,Yc,vd,fe,re){re=void 0===re?null:re;fe=W.Na(1,void 0===fe?null:fe);fe.pasteParameters=Ja;return Vd.i(W,"Paste",fe,Eb,gc,Yc,vd,64,re)}function he(W,Ja,Eb,gc,Yc,vd,fe,re){re=void 0===re?null:re;fe=W.Na(1,void 0===fe?null:fe);fe.copyParameters=Ja;return Vd.i(W,"Copy",fe,Eb,gc,Yc,vd,0,re)}function Wd(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){Oe=void 0===Oe?null:Oe;re=W.Na(9,re);re.destinationRange=Ja;re.source=Eb;return Vd.i(W,"PasteString",re,gc,Yc,vd,fe,64,Oe)}function rc(W,Ja,Eb,gc,Yc,vd,fe,re){re=void 0===
re?null:re;fe=W.Na(1,fe);fe.pasteHtmlParameters=Ja;return Vd.i(W,"PasteHtmlContent",fe,Eb,gc,Yc,vd,64,re)}function gd(){this.t0a=this.lAe=null}function kd(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){Oe=void 0===Oe?null:Oe;var Wc=uf.call(this)||this;Wc.pasteShortcutManager=null;Wc.ddf=xd.EwaSettings.Fb();Wc.ixa=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);Wc.V9f=null;Wc.H7a=!1;Wc.Off=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");
Wc.YBd=function(Pf){Wc.Twj(Pf)&&(Wc.Xr.Nxb(),Rb.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};Wc.bxi=function(Pf,nf){Rb.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",Pf,nf);Wc.gridView.focus()};Wc.zd=function(Pf,nf){nf.uN||nf.Fg||Wc.Vr("OnWorkbookOpened",
!1).catch(function(){})};Wc.ii=function(Pf,nf){Pf=Zb(Wc.QK);var Qg=Wc.Xr.Gwb(Pf);Qg&&(nf.qa&&nf.qa.sheetName===Qg.sheetName&&Qg.isFromCurrentSession(Wc.$)?Wc.Xr.u9e(Qg.ranges,Pf.commandParameters.commandType):Wc.Xr.Nxb())};Wc.Tnc=function(Pf,nf){Pf=Zb(Wc.QK);(Pf=Wc.Xr.Gwb(Pf))&&nf.item&&nf.item.sheetName===Pf.sheetName&&Pf.isFromCurrentSession(Wc.$)&&Wc.Vr("OnItemDeleting",!1).catch(function(){})};Wc.tFb=function(Pf,nf){Wc.ddf?Wc.V9f(Pf,nf):Wc.iEf()};Wc.mS=function(Pf,nf){1===nf.uu&&nf.Hg.operation.flags&
2&&Wc.Vr("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};Wc.$=W;Wc.Sg=Eb;Wc.gridView=$d.g(W);Wc.Xr=Yc;Wc.bdi=vd;Wc.QK=Ja;Wc.t4b=gc;Wc.getStringifiedError=Oe||copyPasteInfra.getStringifiedError;Wc.t3f=1===re;Wc.Ek();Wc.copyPasteShortcutDialogFactory=Wc.$.da.Aa(85);Rb.ULS.shipAssertTag(537167825,0,!!Wc.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");fe||(Rb.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),
fe=kd.sdh);Wc.userHash=Hb.a.sw(fe);Wc.dBi="CultureTag: "+Bf.a.instance.ysb+" HASH: ";Wc.QK.addMetadataChangeListener(kd.crf,Wc.YBd);Wc.Twd=Wc.$.ya.MaxCopyPasteLength;Wc.zOa=Wc.ixa?xd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",Wc.$.ya.CopyPasteMaxPayloadLength):Ae.a.zOa;Wc.Ao=xd.EwaSettings.getBooleanFeatureGate(Kf.a.fQa,!1);Wc.Ao&&W.da.$a(478,function(Pf){Wc.pasteShortcutManager=Pf});Wc.ddf&&(Wc.V9f=Ia.a(function(){Wc.iEf()},1,Wc.$.la,"CopyPasteInfrastructure.OnStartEditInternal",
!0));return Wc}function Qc(W){if(!W)return"null";var Ja=[];W=Cl(W.get());for(var Eb=W.next();!Eb.done;Eb=W.next())Eb=Eb.value,Eb=String.format("{0}({1})",Eb.clipboardDataFormat,Eb.data.length),Ja.push(Eb);Ja.sort();return Ja.join(",")}function de(W){switch(W){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function Xe(W,Ja){return W?Ja&&Ja.ya?W.sessionId!==Ja.ya.UserSessionId:(Rb.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(Rb.ULS.shipAssertTag(537166210,
0,!1,"copyContext shouldn't be null"),!1)}function ge(){}function fc(){}function dd(){}function oc(W,Ja,Eb,gc){this.$=W;this.originalDestinations=Ja;this.C9b=Eb;this.clg=gc;this.hvg=this.originalDestinations;this.Tog=this.C9b;this.wsg="PasteRecoveryUI"}function Zb(W){return W&&(W=W.getCachedMetadata(),null===W||void 0===W?0:W.lastCopy)?W.lastCopy:null}function Sc(W){return W.clipboardItems&&(W=W.clipboardItems.getItem(qc.Ugi))&&"1"===W?!0:!1}function sd(W){return fd(W)&&!(void 0===W.clipboardItems||
null===W.clipboardItems)&&!!W.clipboardItems.getItem(qc.png)&&!W.clipboardItems.getItem(qc.cX)}function fd(W){return W.clipboardItems&&(W=W.clipboardItems.getItem(qc.vki))&&"1"===W?!0:!1}function qc(){}function vb(){}function Pd(W){return!!W&&Object.getType(W)===Tc}function Tc(W,Ja,Eb,gc,Yc){gc=kf.call(this,gc,Yc)||this;Rb.ULS.shipAssertTag(537167645,0,!!Ja&&0<Ja.length,"RangeSourceItem.ctor: ranges should not be null or empty");gc.$=W;gc.ranges=Ja;gc.sheetName=Eb;return gc}function Ve(W,Ja,Eb,gc,
Yc){Eb=kf.call(this,Eb,gc)||this;Eb.activeFloatingObjectControlId=W;Eb.sheetName=Ja;Eb.type=Yc;return Eb}function kf(W,Ja){var Eb=this;this.ZGh=function(){var gc={};gc.SourceItem=Eb.toString();return gc};this.sessionStateId=W;this.sessionId=Ja;this.toJSON=this.ZGh}function of(W,Ja,Eb,gc,Yc){var vd=W.Stopwatch,fe={};fe.a=Yc;fe.e=vd.id;fe.c="RearrangeRowColumn";fe.b="mouse";fe.d=W.OperationId.toString();fe.f=Eb.toString();fe.g=gc.toString();fe.h=Ja.toString();fe.i=W.DragDropIsShiftKeyDown;fe.j=!0;fe.o=
vd.zc;fe.q=!1;fe.r=W.CopyPasteTargetType.toString();fe.s=W.EncounteredDeploymentErrors;return fe}function vf(W){W=Qf.call(this,W)||this;W.JZg=function(){Rb.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};Rb.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");W.jc=0;W.Bc(1,Bf.a.instance.fa(2202));var Ja=Bf.a.instance.fa(2200),Eb=W.$V();W.initializeAndShow(Ja,W.JZg,Eb);return W}function ne(){this.tb=null}function Ad(){this.djb=
this.WSb=this.hw=null}function Xd(W,Ja,Eb,gc,Yc){this.hw=W;this.qjb=Ja;this.mjb=Eb;this.Uee=void 0===gc?null:gc;this.ulb=void 0===Yc?null:Yc}function ee(){this.tb=null}function Le(W){this.pc=W}function Jf(){this.Cje=0;this.fXa=Array(5);this.fXa[0]=10;this.fXa[1]=15;this.fXa[2]=50;this.fXa[3]=100;this.fXa[4]=200}function $f(W,Ja,Eb,gc,Yc){this.bac=!1;this.Hsb=null;this.La=W;this.wYa=Ja;this.fWb=Eb;this.W1=gc;this.JFc=Yc}function Dc(){this.qPf=this.eUf=this.i9f=this.Xjc=this.instance=null}function Sd(W,
Ja,Eb){this.La=W;this.ef=Ja;this.yTb=Eb}function te(){this.completed=this.G$i=!1}function rd(){this.$he=this.Bce=this.i3d=!0;this.dfj=this.DZi=null;this.OCi=!1;this.locale=null;this.Jbg={}}function Ue(){}function ef(){this.EVb=this.VSb=null}function pe(W){return Ma.call(this,W)||this}function Ne(){this.tb=null}function gg(W,Ja){if(void 0===W||null===W||void 0===Ja||null===Ja)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=W;this.Wg=Ja;this.uRc=this.Ee=null}function ie(){this.oKe=
this.wfg=this.Vt=0;this.pKe=this.xfg=this.XHa="";this.cSc=this.$ea=2}function Re(W,Ja){this.SGc=0;this.g3b=null;this.Ajb=new Ce(W,Ja);this.vb=W;Ja=W.Va("HostAuthType");this.OEa=W.ra("OcpsIsEnabled")&&W.ra("IsO365CommercialHost")&&!(void 0===Ja||null===Ja)&&"aad"===Ja.toLowerCase();this.ude=Af.b(W.Va("OcpsDefaultSettings")||"{}");this.pkb=this.Tbc();Ja=this.vb.qz("ServicesControlsMicrosoftControllerServicesList")?this.vb.Kw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.RRb=new jf.a;
for(var Eb=0;Eb<Ja.length;Eb++)this.RRb.add(Ja[Eb]);this.OEa&&!W.ra("IsAnonymousUser")&&W.ra("SideCarIsEnabled")?this.g3b=this.iOj():this.g3b=this.Roa(this.OEa,this.Gva("/afhs/CloudPolicySettings.ashx"),Object(qb.a)(this,this.FXi,"parseCloudPolicySettingsResponse"));this.g3b.then(function(){return null}).catch(function(gc){Rb.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(gc))})}function Ig(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function Lf(){}function qf(W,Ja){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=W.PolicySettings;W=new Date;W.setMinutes(W.getMinutes()+Ja);this.ExpirationTime=W.getTime()}function vg(W,Ja,Eb,gc,Yc){var vd=this;Eb=void 0===Eb?null:Eb;gc=void 0===gc?null:gc;Yc=void 0===Yc?null:Yc;this.Vua=this.iWb=this.Wfe=this.Pqa=this.lXb=null;this.Ajb=new Ce(W,Ja);this.vb=W;this.Bsg=W.Cd("LicensingMaxRetryAttempts",0);this.YLc=W.ra("IsO365ConsumerHost");this.XLc=W.ra("IsO365CommercialHost");this.RTb=W.ra("PremiumUpsellIsEnabled");this.F4d=Eb;this.gke=
gc;this.La=Yc;this.Oqa=W.ra("LicensingIsEnabled");this.OEa=W.ra("OcpsIsEnabled")&&this.XLc;this.uTc=W.ra("ShowPrivacyDialog")&&!!gc;this.Q9d=W.ra("IsAnonymousUser");this.Cad=new Promise(function(fe){fe(!1)});this.WBa=new Promise(function(fe){fe(!0)});this.Uua=new Ie.a(pa.a.Pk());this.$Xb=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.qbe=this.hTh();this.uqd()&&!this.Q9d?(void 0!==Vc.AFrameworkApplication.sa&&null!==Vc.AFrameworkApplication.sa&&
(this.lXb=Vc.AFrameworkApplication.sa.MD,void 0!==this.lXb&&null!==this.lXb&&(this.Pqa=this.lXb.$g("WebServiceCall","ApplicationFeatureHelperService"))),this.Vua=this.hYd()):this.Vua=new Promise(function(fe){fe({})});this.Vua.catch(function(fe){Rb.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(fe))});this.$Xb&&(this.RTb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(fe){vd.RTb=vd.vb.ra("PremiumUpsellIsEnabled")&&fe;return null}))}function jc(W,Ja,Eb){this.featureName=null;this.isEnabled=
!1;this.tierName=0;this.featureName=W;this.isEnabled=Ja;this.tierName=Eb}function zc(W,Ja){this.wLj=3E5;if(void 0===W||null===W||void 0===Ja||null===Ja)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=W;this.PQb=new Ie.a(pa.a.Pk());this.Ajb=new Ce(W,Ja);void 0!==Ge.a.Lvd&&null!==Ge.a.Lvd&&void 0!==Ge.a.Okc&&null!==Ge.a.Okc&&0<Ge.a.Okc&&(W=new Md,W.Token=Ge.a.Lvd,W.ExpirationTime=Ge.a.Okc,this.PQb.ia("loki",W))}function Md(){this.Token=null;this.ExpirationTime=0}function Ce(W,
Ja){this.vb=W;this.Wg=Ja}function ae(){this.message=null;this.Qec=0}b.r(E);var ud=b(0),Rb=b(14),Ie=b(893),pa=b(615),qb=b(82),Sb=b(83),$b;(function(W){W[W.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";W[W.cloudPolicySettings=1]="cloudPolicySettings";W[W.alternateAuthToken=2]="alternateAuthToken"})($b||($b={}));Object(ud.b)("ApplicationFeatureHelperRequestType",$b);Object(ud.a)(ae,"HttpRequstToPromiseRejectData",null,[]);var tc=b(100),ld=b(243);Ce.prototype.r4c=function(W,Ja,
Eb,gc,Yc,vd,fe,re){var Oe=this;gc=void 0===gc?null:gc;Yc=void 0===Yc?null:Yc;vd=void 0===vd?null:vd;fe=void 0===fe?null:fe;re=void 0===re?null:re;var Wc=$b[Eb],Pf=Wc+"RequestFailure";tc.Health.instance.recordKpiUsage(Pf,0,"jpittsdirects",null);return new Promise(function(nf,Qg){Rb.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Wc);var Ng=null!=fe?fe:Oe.vb.Cd("ApplicationFeatureHelperRequestQueueTimeout",15E3),ti=null!=re?re:
Oe.vb.Cd("ApplicationFeatureHelperRequestSentTimeout",3E4);Oe.Wg.j$(W,1,null,Oe.IRh(Eb,gc),vd,!1,1,function(qh){Rb.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Wc);try{if(void 0===qh||null===qh||void 0===qh.data||null===qh.data||void 0===qh.data.me||null===qh.data.me){tc.Health.instance.recordKpiFailure(Pf,"Invalid RequestSucceededEventArgs",!1,!0,null);var fi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
Wc);Qg(Oe.Hwb(fi,qh))}else if(qh.data.httpStatus!==ld.a.tP){tc.Health.instance.recordKpiFailure(Pf,"HttpStatusCode_"+qh.data.httpStatus.toString(),!1,!0,null);var $h=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",qh.data.httpStatus,Wc);Qg(Oe.Hwb($h,qh))}else{void 0!==Yc&&null!==Yc&&void 0!==qh.data.responseHeaders&&null!==qh.data.responseHeaders&&Yc(qh.data.responseHeaders);
var Fi=Ja(qh.data.me);if(Fi)Rb.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Wc),nf(Fi);else{tc.Health.instance.recordKpiFailure(Pf,"Parse Failure",!1,!0,null);var di=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Wc);Qg(Oe.Hwb(di,qh))}}}catch(V){tc.Health.instance.recordKpiFailure(Pf,"Unexpected Failure",!1,!0,null),fi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
V,Wc),Qg(Oe.Hwb(fi,qh))}},function(qh){Rb.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",Wc);if(qh.data){tc.Health.instance.recordKpiFailure(Pf,"HttpStatusCode_"+qh.data.httpStatus.toString(),!1,!0,null);var fi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",qh.data.httpStatus,qh.data.me||"No Data",Wc)}else tc.Health.instance.recordKpiFailure(Pf,
"Invalid RequestFailedEventArgs",!1,!0,null),fi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Wc);Qg(Oe.Hwb(fi,qh))},null,void 0,void 0,Ng,ti)})};Ce.prototype.Hwb=function(W,Ja){var Eb=new ae;Eb.message=W;Eb.Qec=Ja&&Ja.data?Ja.data.httpStatus:-1;return Eb};Ce.prototype.IRh=function(W,Ja){var Eb={};Eb["x-UserDataSignature"]=this.vb.Va("UserDataSignature");Eb["x-LicensingIsEnabled"]=this.vb.ra("LicensingIsEnabled").toString();
Eb["x-CacheIsEnabled"]=this.vb.ra("LicensingRedisIsEnabled").toString();Eb["x-OcpsIsEnabled"]=this.vb.ra("OcpsIsEnabled").toString();Eb["x-LicensingAADIdIsEnabled"]=this.vb.ra("LicensingAadIdIsEnabled").toString();0===W&&(Eb["x-LicenseCheckOnTenantEnabled"]=this.vb.ra("LicensingForSafeLinksIsEnabled").toString(),Eb["x-SupportUserConsentDependentFeatures"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),Eb["x-AFHUserConsentGroupValue"]=
this.vb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),Eb["x-UseShellServiceForUserConsentGroup"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),Eb["x-UseSALForLicensing"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),Eb["x-SMBUserLicensingEnabled"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());
if(Ja){W=Cl(Ja.keys);for(var gc=W.next();!gc.done;gc=W.next())gc=gc.value,Eb[gc]=Ja.oa(gc)}return Eb};Object(ud.a)(Ce,"HttpRequestToPromiseUtility",null,[]);var Vc=b(4),Se;(function(W){W[W.loki=0]="loki";W[W.augloopACLP=1]="augloopACLP"})(Se||(Se={}));Object(ud.b)("AlternateAuthSupportApp",Se);var Ge=b(941),Af=b(41);Object(ud.a)(Md,"WacAlternateAuthToken",null,[]);zc.prototype.SJh=function(){var W=null;this.PQb.xb(Se[0])&&(W=this.PQb.oa(Se[0]));return void 0===W||null===W||this.hsd(W)?this.BAh():
Promise.resolve(W.Token)};zc.prototype.hsd=function(W){return W.ExpirationTime-Date.now()<this.wLj};zc.prototype.BAh=function(){var W=this,Ja=new Ie.a(pa.a.Pk());Ja.ia("X-AlternateAuthApp",Se[0]);return this.Ajb.r4c(this.Gva("/afhs/AlternateAuthHelperHandler.ashx"),Object(qb.a)(this,this.BXi,"parseAlternateAuthTokenResponse"),2,Ja).then(function(Eb){Rb.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Se[0]);W.PQb.ia(Se[0],
Eb);return Eb.Token},function(Eb){Eb=Object(Sb.a)(ae,Eb);Rb.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Eb.message,Eb.Qec);return null})};zc.prototype.BXi=function(W){var Ja=Af.d(W).ev;Rb.ULS.sendTraceTag(545821457,3004,Ja?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",W);return Ja};zc.prototype.Gva=function(W){return String.format("{0}{1}?{2}",this.vb.Va("WebServiceBase"),W,Vc.AFrameworkApplication.oj)};
Object(ud.a)(zc,"AlternateAuthHelper",null,[519]);var jf=b(488);Object(ud.a)(jc,"FeatureStateChangeArgs",null,[]);var Ef=b(134),Xf=b(260),ug=b(24),Wb=b(112),Kc=b(177),Id;(function(W){W[W.Enabled=0]="Enabled";W[W.Disabled=1]="Disabled"})(Id||(Id={}));Object(ud.b)("FeatureState",Id);var Bd=b(85),oe=b(27),Hd=b(356);vg.prototype.hTh=function(){for(var W=this.vb.qz("AllLicensedFeatures")?this.vb.Kw("AllLicensedFeatures"):[],Ja=new jf.a,Eb=0;Eb<W.length;Eb++)Ja.add(W[Eb]);return Ja};vg.prototype.uqd=function(){return this.XLc||
this.YLc};vg.prototype.hYd=function(W,Ja){var Eb=this;W=void 0===W?0:W;Ja=void 0===Ja?!1:Ja;Rb.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ja);var gc=Ef.a.Yr();gc&&(gc.set("retryAttempt",W.toString()),gc.set("forceRefresh",Ja.toString()),gc.set("isO365ConsumerHost",this.YLc.toString()),gc.set("isO365CommercialHost",this.XLc.toString()),gc.set("isFreemiumUpsellEnabled",this.RTb.toString()));tc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",gc);tc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",gc);void 0!==this.Pqa&&null!==this.Pqa&&this.Pqa.start();var Yc=null;Ja&&(Yc=new Ie.a(pa.a.Pk()),Yc.ia("x-LicensingForceRefresh","true"));this.Wfe=new Date;return(this.Oqa?this.Ajb.r4c(this.Gva("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(qb.a)(this,this.EXi,"parseApplicationFeatureHelperResponse"),0,Yc,Object(qb.a)(this,this.$1i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):
Promise.resolve({})).then(function(vd){var fe=Object.assign(new Hd.a,{durationMs:Eb.f7f()});fe.extendedProperties=gc;fe.extendedProperties&&vd&&(fe.extendedProperties.set("featureCount",Wb.a.count(vd).toString()),fe.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in vd).toString()),fe.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in vd).toString()),Eb.iWb&&fe.extendedProperties.set("fromCache",(Eb.iWb<Eb.Wfe).toString()));tc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
fe);return vd},function(vd){var fe=Object.assign(new Hd.a,{durationMs:Eb.f7f()}),re=Object(Sb.a)(ae,vd);if(!re)return Rb.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),tc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,fe),new Promise(function(Oe,Wc){Wc(vd)});fe.extendedProperties=gc;fe.extendedProperties&&fe.extendedProperties.set("status",re.Qec.toString());
tc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,fe);return 408===re.Qec&&++W<=Eb.Bsg?Eb.hYd(W):new Promise(function(Oe,Wc){Wc(re)})})};vg.prototype.EXi=function(W){(W=Af.b(W))?(Rb.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),Rb.ULS.sendTraceTag(50938594,3004,50,"{0}",W)):Rb.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return W.Features};vg.prototype.Gva=function(W){var Ja=String.format("{0}{1}",this.vb.Va("WebServiceBase"),W);this.vb.qz("ApplicationFeatureHelperHttpCachingEnabled")&&this.vb.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(W=vg.Tbc(this.vb))&&0<W.length&&(this.$Xb&&(W+="ucbf"),Ja=new Xf.QueryStringBuilder(Ja),Ja.Yi("afhskey",W),Ja=Ja.toString());return Ja};vg.prototype.isFeatureEnabled=function(W,Ja){var Eb=this;if(!this.OEa&&!this.uTc&&!this.Oqa)return this.WBa;Rb.ULS.sendTraceTag(42513091,3004,
50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",W);if("ConnectedServices"===W){var gc=this.OEa?this.F4d.eK("ControllerConnectedServicesEnabled"):this.WBa,Yc=this.uTc?this.gke.getSettings().then(function(re){return 2!==re.Vt},function(){return Ja}):this.WBa;return gc.then(function(re){return re?Yc:Eb.Cad})}gc=null;gc=this.OEa?this.F4d.isFeatureEnabled(W):this.WBa;var vd=null;vd=this.Oqa?this.Hii(W,Ja):this.WBa;var fe=null;fe=this.uTc?this.gke.isFeatureEnabled(W):
this.WBa;return gc.then(function(re){return re?fe.then(function(Oe){return Oe?vd:Eb.Cad}):Eb.Cad}).then(function(re){Eb.Vmf(W,re,!0);return re},function(){Eb.Vmf(W,Ja,!1);return Ja})};vg.prototype.Vmf=function(W,Ja,Eb){Rb.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",W,Ja,Eb)};vg.prototype.getFeatureTier=function(W,Ja){var Eb=this;if(!this.Oqa)return new Promise(function(gc){gc(2)});Rb.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
W);return this.Vua.then(function(gc){return Eb.Ucc(W,gc,Ja)},function(){return Ja})};vg.prototype.isFreemiumUpsellEnabled=function(){return this.RTb&&this.YLc&&!this.Q9d};vg.prototype.launchUpsellExperience=function(W,Ja){Ja=void 0===Ja?null:Ja;Rb.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",W));var Eb=Ef.a.Yr();Eb&&(Eb.set("experienceId",W),Ja&&Eb.set("campaignId",Ja));tc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Eb);if(Eb=Bd.a.instance.Lh("Common.IInProductMessagingUIManager")){var gc=Object(qb.a)(this,this.E3h,"handleDimeTaskComplete");Eb.blf(W,gc,Ja)}else Rb.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),tc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Ja={},this.La.Be(oe.a.cac,2,(Ja.experience=W,Ja))};vg.prototype.cna=function(W,Ja){if(!this.Oqa)return null;if(!W||!Ja)return Rb.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var Eb=Kc.a.create().toString();this.Uua.xb(W)||this.Uua.ia(W,new Ie.a(pa.a.Pk()));this.Uua.oa(W).add(Eb,Ja);Rb.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Eb,W));return Eb};vg.prototype.rJd=function(W,Ja){this.Oqa&&(W&&this.Uua.xb(W)?Ja&&Kc.a.isValid(Ja)?this.Uua.oa(W).xb(Ja)?(Rb.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Ja,W)),this.Uua.oa(W).remove(Ja)):Rb.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ja,W)):Rb.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ja,W)):Rb.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",W)))};vg.prototype.Ucc=function(W,Ja,Eb){return this.$Xb?W in Ja?Ja[W].LicenseTier:Eb:W in Ja?this.cYi(Ja[W],Eb):Eb};vg.prototype.cYi=function(W,Ja){switch(W.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ja}};vg.prototype.E3h=function(){var W=this;Rb.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.Vua.then(function(Ja){W.tOf(Ja)}).catch(function(){W.tOf({})})};vg.prototype.tOf=function(W){var Ja=this;Rb.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var Eb=this.hYd(0,!0);Eb.then(function(gc){Ja.Vua=Eb;Wb.a.count(gc)>Wb.a.count(W)?tc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):tc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var Yc=Cl(Ja.Uua.keys),vd=Yc.next();!vd.done;vd=
Yc.next())if(vd=vd.value,vd in gc){var fe=Ja.Ucc(vd,gc,0);vd in W?Ja.Ucc(vd,W,0)!==fe&&Ja.tzd(vd,!0,fe):Ja.tzd(vd,!0,fe)}else vd in W&&Ja.tzd(vd,!1,Ja.Ucc(vd,W,0))}).catch(function(gc){tc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);Rb.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(gc))})};vg.prototype.tzd=function(W,Ja,Eb){Rb.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
W,Ja,Eb);Ja=new jc(W,Ja,Eb);Eb=this.Uua.oa(W);Eb=Cl(Eb);for(var gc=Eb.next();!gc.done;gc=Eb.next()){gc=gc.value;try{gc.value(Ja)}catch(Yc){Rb.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",W,gc.key,Yc.message))}}};vg.prototype.ke=function(W,Ja){var Eb=this;if(this.Oqa){var gc=this.qbe.contains(W),Yc=!0,vd="",fe=!1;return this.Vua.then(function(re){W in re?
(re=re[W],vd=Id[re.FeatureState],Yc=1!==re.FeatureState):Yc=!gc;Eb.gnf(W,gc,vd,fe,Ja,Yc);return Yc},function(){fe=!0;gc&&(Yc=Ja);Eb.gnf(W,gc,vd,fe,Ja,Yc);return Yc})}return this.WBa};vg.prototype.gnf=function(W,Ja,Eb,gc,Yc,vd){Rb.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",W,Ja,gc,Eb,Yc,vd)};vg.prototype.Hii=function(W,Ja){if(this.$Xb)return this.ke(W,Ja);if(this.Oqa){if(this.qbe.contains(W))return this.Vua.then(function(Eb){return W in
Eb},function(){return Ja});Rb.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",W)}return this.WBa};vg.prototype.$1i=function(W){try{W&&"Date"in W&&(this.iWb=new Date(W.Date),Rb.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.iWb.toString()))}catch(Ja){Rb.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Ja)}};vg.prototype.f7f=function(){if(void 0!==this.Pqa&&null!==this.Pqa){var W=this.Pqa.zc;this.Pqa.stop();return W}return null};vg.Tbc=function(W){try{if(ug.a.JHj){var Ja=W.Va("UserDataSignature").split(".");if(1<Ja.length){var Eb=window.self.atob(Ja[1]),gc=JSON.parse(Eb).LocalStorageKey;if(void 0!==gc&&null!==gc&&0<gc.length)return gc}}}catch(Yc){Rb.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",Yc.toString())}return null};Object(ud.a)(vg,"ApplicationFeatureHelper",null,
[520]);var we=b(201);Object(ud.a)(qf,"CloudPolicySettingsCacheData",null,[]);var df=b(1025),sf=b(391),wf=b(231);Lf.s5f=function(){return Vc.AFrameworkApplication.ga.ra("SideCarIsEnabled")?Lf.ovc&&Lf.Uod?new Promise(function(W){W(!0)}):new Promise(function(W,Ja){Lf.ovc=wf.a.create(Vc.AFrameworkApplication.ga.Va("SideCarUrl"));sf.a.Zia(Lf.ovc);Lf.ovc.m$(function(Eb,gc){(Lf.Uod=gc.succeeded)?W(gc.succeeded):Ja(gc.succeeded)})}):new Promise(function(W){W(!1)})};Lf.Uod=!1;Lf.ovc=null;Object(ud.a)(Lf,"SideCarLoader",
null,[]);Object(ud.a)(Ig,"CloudPolicySettingsData",null,[]);Re.prototype.eK=function(W,Ja){Ja=void 0===Ja?!0:Ja;if(!this.OEa){var Eb=this;return new Promise(function(fe){fe(Eb.twb(W))})}var gc=this,Yc=this,vd=this.g3b.then(function(fe){try{var re=null;fe.PolicySettings&&"unknown"in fe.PolicySettings&&(re=fe.PolicySettings.unknown);if(re){if(W in re&&void 0!==re[W]&&null!==re[W])return new Promise(function(Wc){Wc("0"!==re[W])});var Oe=W.toLowerCase();if(Oe in re&&void 0!==re[Oe]&&null!==re[Oe])return new Promise(function(Wc){Wc("0"!==
re[Oe])});Rb.ULS.sendTraceTag(51512667,3004,50,"Policy"+W+" not found, using default");return new Promise(function(Wc){Wc(gc.twb(W))})}return new Promise(function(Wc){Wc(gc.twb(W))})}catch(Wc){return Rb.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+W+" policy value. Error Message: {0}",Wc.message),gc.handleError(Wc.toString(),Ja,gc.twb(W))}},function(fe){return Yc.handleError(fe,Ja,Yc.twb(W))});vd.then(function(fe){Rb.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
W,fe);return null});return vd};Re.prototype.isFeatureEnabled=function(W,Ja){Ja=void 0===Ja?!0:Ja;if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Jii(W,Ja);var Eb=new Promise(function(Yc){Yc(!0)}),gc="";this.RRb.contains(W)&&(gc="ControllerConnectedServicesEnabled",Eb=this.eK(gc,Ja));Eb.then(function(Yc){Rb.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
W,Yc,gc);return null});return Eb};Re.prototype.Jii=function(W,Ja){Ja=void 0===Ja?!0:Ja;var Eb=new Promise(function(Yc){Yc(!0)}),gc="";"mso_sendASmile"===W?gc="Enabled":"Survey"===W||"FloodgateSurvey"===W?gc="SurveyEnabled":this.RRb.contains(W)&&(gc="ControllerConnectedServicesEnabled");""!==gc&&(Eb=this.eK(gc,Ja));Eb.then(function(Yc){Rb.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",W,Yc,gc);return null});return Eb};
Re.prototype.handleError=function(W,Ja,Eb){return Ja?new Promise(function(gc){gc(Eb)}):new Promise(function(gc,Yc){Yc(W)})};Re.prototype.Roa=function(W,Ja,Eb){var gc=this;if(!W)return Promise.resolve(new Ig);var Yc=!1,vd=null;tc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var fe=this.P3c("GetCloudPolicySettings");return(new Promise(function(re,Oe){if(void 0!==gc.pkb&&null!==gc.pkb&&0<gc.pkb.length){var Wc=gc.TNj();if(void 0!==Wc&&null!==Wc){Yc=!0;re(Wc);return}}gc.Ajb.r4c(Ja,
Eb,1,null,Object(qb.a)(gc,gc.d2i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],gc.vb.Cd("CloudPolicySettingsRequestQueueTimeout",15E3),gc.vb.Cd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(Pf){Rb.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");gc.IOj(Pf);re(Pf);return Pf},function(Pf){Oe(Pf);return null})})).then(function(re){var Oe=gc.rzc(fe);fe=Oe.stopwatch;vd=Oe.returnValue;(Oe=Ef.a.Yr())&&Oe.set("FromCache",Yc.toString());Oe=
Object.assign(new Hd.a,{durationMs:vd,extendedProperties:Oe});tc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Oe);return re})};Re.prototype.iOj=function(){return Lf.s5f().then(function(){Rb.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};Re.prototype.Gva=function(W){return String.format("{0}{1}",this.vb.Va("WebServiceBase"),W)};Re.prototype.FXi=function(W){var Ja=
Af.d(W).ev;Rb.ULS.sendTraceTag(50622687,3004,Ja?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",W);return Ja};Re.prototype.d2i=function(W){try{if(void 0!==W&&null!==W&&"CheckIn-Interval"in W){var Ja=parseInt(W["CheckIn-Interval"]);void 0!==Ja&&null!==Ja&&0<Ja&&(this.SGc=Ja)}}catch(Eb){Rb.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Eb)}};Re.prototype.twb=function(W){return W in this.ude?"0"!==this.ude[W]:!0};Re.prototype.TNj=
function(){try{var W=df.a.instance.getItem(this.pkb);if(void 0===W||null===W)return Rb.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;Rb.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",W);var Ja=JSON.parse(W);if(void 0===Ja||null===Ja)return Rb.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===
Ja.ExpirationTime||null===Ja.ExpirationTime)return Rb.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ja.ExpirationTime)).getTime()<Date.now())return Rb.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var Eb=new Ig;Eb.PolicySettings=Ja.PolicySettings;Eb.ControllerConnectedServicesFeatureNames=new we.a;this.vb.qz("ServicesControlsMicrosoftControllerServicesList")&&
this.vb.Kw("ServicesControlsMicrosoftControllerServicesList");for(var gc=Cl(this.RRb),Yc=gc.next();!Yc.done;Yc=gc.next())Eb.ControllerConnectedServicesFeatureNames.add(Yc.value);Rb.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Eb}catch(vd){return Rb.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",vd.toString()),null}};Re.prototype.IOj=function(W){try{if(void 0===W||null===W||void 0===W.PolicySettings||
null===W.PolicySettings)Rb.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.SGc)Rb.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Ja=new qf(W,this.SGc),Eb=JSON.stringify(Ja);Rb.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Eb);df.a.instance.setItem(this.pkb,Eb);Rb.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(gc){Rb.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",gc.toString())}};Re.prototype.Tbc=function(){var W=vg.Tbc(this.vb);return W&&0<W.length?"OCPS"+W:null};Re.prototype.P3c=function(W){var Ja=Bd.a.instance.Lh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ja&&null!==Ja?Ja.Hc("WebServiceCall",W):null};Re.prototype.rzc=function(W){if(void 0!==W&&null!==W){var Ja=W.zc;W.stop();return{returnValue:Ja,stopwatch:null}}return{returnValue:null,stopwatch:W}};Object(ud.a)(Re,
"CloudPolicySettingsHelper",null,[517]);ie.prototype.clone=function(){var W=new ie;W.Vt=this.Vt;W.wfg=this.wfg;W.oKe=this.oKe;W.XHa=this.XHa;W.xfg=this.xfg;W.pKe=this.pKe;W.$ea=this.$ea;W.cSc=this.src;return W};ie.prototype.serialize=function(W){W=void 0===W?null:W;var Ja={};if(!W||W.contains(ie.VOa))Ja[ie.VOa]=this.Vt;if(!W||W.contains(ie.XDb))Ja[ie.XDb]=this.XHa;if(!W||W.contains(ie.YDb))Ja[ie.YDb]=this.$ea;return JSON.stringify(Ja)};ie.create=function(W,Ja){Ja=void 0===Ja?null:Ja;var Eb=new ie;
Eb.cSc=W;void 0!==Ja&&null!==Ja&&(ie.VOa in Ja&&(Eb.Vt=Ja[ie.VOa]),ie.XDb in Ja&&(Eb.XHa=Ja[ie.XDb]),ie.YDb in Ja&&(Eb.$ea=Ja[ie.YDb]));return Eb};ie.deserialize=function(W,Ja){try{var Eb=JSON.parse(W);if(void 0!==Eb&&null!==Eb)return ie.create(Ja,Eb);Rb.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",W);throw Error.argument("settingsData");}catch(gc){throw Rb.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",gc.toString()),
gc;}};Ck.Object.defineProperties(ie.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.cSc}}});ie.VOa="CCS";ie.XDb="CCSTime";ie.YDb="OfficePrivacyRoamedNoticeShown";Object(ud.a)(ie,"UserPrivacySettings",null,[]);var $e=b(126);gg.prototype.Gva=function(W){var Ja=String.format("{0}RoamingServiceHandler.ashx?action=",this.vb.appSettings.RoamingServiceHandlerWebServiceBase||"");Ja=new Sys.StringBuilder(Ja);Ja.append(W);Ja.append("&");Ja.append(Vc.AFrameworkApplication.oj);return Ja.toString()};
gg.prototype.executeRequest=function(W,Ja,Eb,gc){return this.Wg.rZb(W,Ja,void 0===gc?null:gc,null,Eb,"33",!1,null,6E4)};gg.prototype.saveSettings=function(W){var Ja=this;return new Promise(function(Eb,gc){try{if(void 0===Ja.Ee||null===Ja.Ee||void 0===W||null===W)Rb.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),gc("Can't determine setting changes to save");else{var Yc=Ja.Ee.Vt!==W.Vt;if(2===Ja.Ee.src&&Yc)Ja.Okj(W),Eb(!0);else{var vd=Ja.Joj(W);
if(void 0===vd||null===vd||!vd.length)Rb.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),gc("No changes to save");else if(1===Ja.Ee.src)Eb(Ja.sbg(vd));else if(0===Ja.Ee.src){Rb.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",vd);var fe=Ja.executeRequest(Ja.Gva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",vd);fe.continueWith(function(){if(fe.Oh||fe.ig)Rb.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
Eb(!1);else{var re=fe.result;void 0!==re.gh&&null!==re.gh&&void 0!==re.gh.data&&null!==re.gh.data&&re.gh.data.httpStatus===ld.a.tP?(Rb.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Eb(!0)):(Rb.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Eb(!1))}})}}}}catch(re){Rb.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",re.toString()),Eb(!1)}})};gg.prototype.Joj=function(W){if(void 0===this.Ee||null===
this.Ee||void 0===W||null===W)throw Error.invalidOperation("User Privacy settings have not been initialized");var Ja=new we.a;0===W.src?(this.Ee.Vt!==W.Vt&&(Ja.add(ie.VOa),Ja.add(ie.XDb)),this.Ee.$ea!==W.$ea&&Ja.add(ie.YDb)):1===W.src&&this.Ee.Vt!==W.Vt&&Ja.add(ie.VOa);return Ja.count?W.serialize(Ja):(Rb.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};gg.prototype.getSettings=function(){if(!this.uRc){var W=this;this.uRc=new Promise(function(Ja){try{W.Ee?
Ja(W.Ee.clone()):W.aOj().then(function(Eb){W.Ee=Eb;Ja(W.Ee.clone());return null},function(){W.ZNj().then(function(Eb){W.Ee=Eb;Ja(W.Ee.clone());return null},function(){W.$Nj().then(function(Eb){W.Ee=Eb;Ja(W.Ee.clone());return null},function(){Rb.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");W.Ee=new ie;Ja(W.Ee.clone());return null});return null});return null})}catch(Eb){Rb.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
Eb.toString()),W.Ee=new ie,Ja(W.Ee.clone())}})}return this.uRc};gg.prototype.aOj=function(){var W=this;return new Promise(function(Ja,Eb){try{var gc=-1!==window.location.href.indexOf("&wd_pn=2");if(W.vb.ra("PrivacyDialogShouldCheckRoaming")||gc){var Yc=W.executeRequest(W.Gva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Yc.continueWith(function(){try{if(Yc.Oh||Yc.ig)Rb.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var vd=Yc.result;
if(vd&&vd.gh&&vd.gh.data)if(vd.gh.data.httpStatus!==ld.a.tP)Rb.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",vd.gh.data.httpStatus);else{if(vd.gh.data.me){Ja(gg.parse(vd.gh.data.me,0));Rb.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",vd.gh.data.me);return}Rb.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else Rb.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Eb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(fe){Rb.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",fe.toString()),Eb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else Rb.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Eb("Roaming should not be used")}catch(vd){Rb.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",vd.toString()),Eb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};gg.prototype.ZNj=function(){var W=this;return new Promise(function(Ja,Eb){try{var gc=$e.a.get("WacUPToggleState"),Yc=null;void 0!==gc&&null!==gc&&0<gc.length&&(Yc=decodeURIComponent(gc));if(void 0!==Yc&&null!==Yc&&0<Yc.length){var vd=gg.parse(Yc,1);Rb.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",vd.toString());
Ja(vd)}else{var fe=ie.create(1),re=new we.a;re.add(ie.VOa);var Oe=fe.serialize(re);W.sbg(Oe)?(Rb.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Oe),Ja(fe)):(Rb.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Oe),Eb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Wc){Rb.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Wc.toString()),Eb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};gg.prototype.$Nj=function(){return new Promise(function(W){try{var Ja=-1!==window.location.href.indexOf("&wdccsoff=1"),Eb=ie.create(2);Ja?(Eb.Vt=2,Vc.AFrameworkApplication.YIe(),Rb.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Eb.toString())):(Eb.Vt=1,Rb.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Eb.toString()));W(Eb)}catch(gc){Rb.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",gc.toString()),Ja=ie.create(2),Ja.Vt=1,W(Ja)}})};gg.prototype.Okj=function(W){Rb.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===W.Vt?Vc.AFrameworkApplication.YIe():Vc.AFrameworkApplication.$kh();Rb.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",W)};gg.prototype.sbg=function(W){try{Rb.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",W);var Ja=this.vb.Va("PrivacyCookieDomain")||"";if(!Ja||!Ja.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");Rb.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",W);return $e.a.AQd("WacUPToggleState",W,$e.a.KW,"/",Ja)}catch(Eb){return Rb.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Eb.toString()),!1}};gg.prototype.isFeatureEnabled=
function(W){var Ja=this;return this.getSettings().then(function(Eb){for(var gc=Ja.vb.qz("ServicesControlsMicrosoftControllerServicesList")?Ja.vb.Kw("ServicesControlsMicrosoftControllerServicesList"):[],Yc=new jf.a,vd=0;vd<gc.length;vd++)Yc.add(gc[vd]);return Yc.contains(W)?2!==Eb.Vt:!0},function(){Rb.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",W);return!0})};gg.parse=function(W,Ja){try{return Rb.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
W,Ja),ie.deserialize(W,Ja)}catch(Eb){throw Rb.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Eb.toString()),Eb;}};Object(ud.a)(gg,"UserPrivacySettingsHelper",null,[518]);var pf=b(255);Ne.prototype.fi=function(W){var Ja=this;this.tb=W;this.tb.register(517,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Ic().Oc(function(){return new Re(Vc.AFrameworkApplication.ga,Vc.AFrameworkApplication.Jd)});this.tb.register(518,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Ic().Oc(function(){return new gg(Vc.AFrameworkApplication.ga,
Vc.AFrameworkApplication.Jd)});this.tb.register(519,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Ic().Oc(function(){return new zc(Vc.AFrameworkApplication.ga,Vc.AFrameworkApplication.Jd)});this.tb.register(520,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Ic().Oc(function(){return new vg(Vc.AFrameworkApplication.ga,Vc.AFrameworkApplication.Jd,Ja.tb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Ja.tb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
Vc.AFrameworkApplication.Ib)})};Ne.prototype.init=function(){var W=this;Vc.AFrameworkApplication.ga.tv(function(){var Ja=W.tb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Vc.AFrameworkApplication.ga.ra("LicensingIsEnabled")&&(Ja.isFeatureEnabled("LicensingTestFeature",!1).then(function(Eb){Rb.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Eb,Vc.AFrameworkApplication.ga.Va("IsAnonymousUser"));
return null}),Ja.getFeatureTier("LicensingTestFeature",0).then(function(Eb){Rb.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Eb,Vc.AFrameworkApplication.ga.Va("IsAnonymousUser"));return null}));W.tb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");W.eJj()})};Ne.prototype.dispose=function(){};Ne.prototype.eJj=function(){try{Vc.AFrameworkApplication.ga.ra("SideCarIsEnabled")&&Lf.s5f().then(function(W){Rb.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",W);return W})}catch(W){}};Ne.main=function(){pf.a.instance.hj(new Ne)};Ck.Object.defineProperties(Ne.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(ud.a)(Ne,"ApplicationFeatureHelperPackage",null,[4,5]);var bg=b(118),Zd=b(420),Ma=Zd.a;Am(pe,Ma);pe.prototype.createElement=function(){var W=document.createElement("link");W.setAttribute("rel",
"stylesheet");W.setAttribute("type","text/css");W.setAttribute("href",this.wu);return W};pe.prototype.p4c=function(){return null};pe.prototype.Asc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.yI.wu)};Ck.Object.defineProperties(pe.prototype,{y4b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(ud.a)(pe,"CssResource",Zd.a,[]);var Hb=b(29),ic=b(55);ef.prototype.Hti=function(){this.VSb||(Rb.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.VSb=ic.Task.WAA(ef.Mti(),ef.Eti()),this.VSb.continueWith(function(W){Rb.ULS.sendTraceTag(21030599,324,10,"{0}",Hb.a.Xed(W.exception))},5));return this.VSb};ef.prototype.Jti=function(){if(!this.EVb)try{Rb.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.EVb=ic.Task.WAA(ef.R8c(wf.a.create(Vc.AFrameworkApplication.ga.Va("DimeUrl"),null,null))),this.EVb.continueWith(function(W){Rb.ULS.sendTraceTag(39978391,324,10,"{0}",Hb.a.Xed(W.exception))},5)}catch(W){Rb.ULS.sendTraceTag(594874951,
324,10,"{0}",Hb.a.Xed(W))}return this.EVb};ef.Mti=function(){var W=ef.Wcc("inproductmessaging.js");W=wf.a.create(W,null,null);return ef.R8c(W)};ef.Eti=function(){var W=ef.Wcc("inproductmessaging.css");W=new pe(W);return ef.R8c(W)};ef.Wcc=function(W){return bg.a.B3b(String.format("ipm/{0}",W))};ef.R8c=function(W){sf.a.Zia(W);return W.J8a};Object(ud.a)(ef,"DependencyDownloader",null,[728]);Ue.OWi="inProductMessagingOverlayDiv";Ue.CZi="PlayButtonImage";Ue.cfj="ReplayButtonImage";Object(ud.a)(Ue,"Constants",
null,[]);rd.prototype.Ksj=function(){this.Jne(Ue.CZi,this.DZi);this.Jne(Ue.cfj,this.dfj)};rd.prototype.Jne=function(W,Ja){Ja&&(this.Jbg[W]=Ja)};Ck.Object.defineProperties(rd.prototype,{JNg:{configurable:!0,enumerable:!0,get:function(){return this.i3d},set:function(W){this.i3d=W}},TBi:{configurable:!0,enumerable:!0,get:function(){return this.Bce},set:function(W){this.Bce=W}},fBj:{configurable:!0,enumerable:!0,get:function(){return this.$he},set:function(W){(this.$he=W)&&this.Ksj()}}});Object(ud.a)(rd,
"FirstRunExperienceUISettings",null,[727]);Object(ud.a)(te,"FirstRunExperienceViewData",null,[639]);var Lc=b(180),td=b(106);Sd.prototype.Og=function(){this.La.Ze(oe.a.uDh,td.a.frame,Object(qb.a)(this,this.sDh,"firstRunExperienceHandler"),64);this.La.fc(oe.a.cVe,td.a.frame,Object(qb.a)(this,this.N9h,"inProductMessagingTabHandler"));this.La.fc(oe.a.bVe,td.a.frame,Object(qb.a)(this,this.M9h,"inProductMessagingShiftTabHandler"));this.La.fc(oe.a.Ofh,td.a.frame,Object(qb.a)(this,this.Pfh,"dimeLaunchHandler"));
this.La.fc(oe.a.GSf,td.a.frame,Lc.ActionManager.og);this.La.fc(oe.a.Bfj,td.a.frame,Lc.ActionManager.og);this.La.fc(oe.a.Cfj,td.a.frame,Lc.ActionManager.og);this.ef&&this.ef.updateCommandUI()};Sd.prototype.sDh=function(W,Ja,Eb,gc,Yc){2===Eb&&this.yTb.isi(Yc);return 32};Sd.prototype.Pfh=function(W,Ja,Eb,gc,Yc){2===Eb&&this.yTb.fsi(Yc);return 32};Sd.prototype.N9h=function(W,Ja,Eb){return 2===Eb?this.yTb.Rxd():32};Sd.prototype.M9h=function(W,Ja,Eb){return 2===Eb?this.yTb.Pxd():32};Object(ud.a)(Sd,"InProductMessagingActor",
null,[]);Object(ud.a)(Dc,"DimeExperienceUISettings",null,[]);var pd=b(176),Qe=b(495);$f.prototype.vbi=function(W){pd.b("getHeaderApi")?W.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ja){var Eb=W.isFreemiumUpsellEnabled();Eb&&(appChrome.getHeaderApi().then(function(gc){gc.updatePremiumStatus(Ja,Eb);return null}),W.cna("MsoPremiumBadge",function(gc){appChrome.getHeaderApi().then(function(Yc){Yc.updatePremiumStatus(gc.isEnabled,Eb);return null})}));return null}):Rb.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};$f.prototype.isi=function(W){var Ja=this;this.fWb.Hti().continueWith(function(){Ja.wYa.ACj(W)})};$f.prototype.fsi=function(W){function Ja(){}var Eb="gopremium",gc=null;W?(W.experience&&""!==Object(Sb.a)(String,W.experience)&&(Eb=Object(Sb.a)(String,W.experience)),W.onTaskComplete&&(Ja=W.onTaskComplete),W.campaignId&&""!==Object(Sb.a)(String,W.campaignId)&&(gc=Object(Sb.a)(String,W.campaignId))):Rb.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.blf(Eb,Ja,gc)};$f.prototype.blf=function(W,Ja,Eb){var gc=this;Eb=void 0===Eb?null:Eb;if(this.bac&&this.Hsb){var Yc={};Yc.experience=W||"gopremium";Yc.campaignId=Eb||Qe.b(this.W1,this.JFc,Object(Sb.a)(String,Yc.experience),!0);this.La.processAction(oe.a.GSf,2);Rb.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Yc.experience);try{var vd=Object.assign(new Dc,{instance:this.Hsb,Xjc:Yc,i9f:Ja||function(){},eUf:function(fe){Rb.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
fe.status)},qPf:function(){Rb.ULS.sendTraceTag(51675406,324,10,"Dime launch error");gc.bac=!1;gc.Hsb=null}});this.wYa.NAj(vd)}catch(fe){Rb.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+fe.message),this.bac=!1,this.Hsb=null,W={},this.La.Be(oe.a.cac,2,(W.experience=Yc.experience,W))}}else Rb.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),Yc={},this.La.Be(oe.a.cac,2,(Yc.experience=W,Yc))};$f.prototype.Tlf=function(){var W=this;this.fWb.Jti().continueWith(function(){try{var Ja=
Hb.a.Wl(Vc.AFrameworkApplication.uiCulture),Eb=Qe.c(W.W1);if(Eb){Ja={partnerId:Eb,language:Ja};Ja.sessionId=Vc.AFrameworkApplication.userSessionId;Ja.authHint=Vc.AFrameworkApplication.ga.Va("UserPrincipalName");var gc=Vc.AFrameworkApplication.ga.Va("Puid")||"";""!==gc&&(Ja.userInfo={puid:gc});W.Hsb=new Dime(Ja);W.bac=!0;Rb.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else Rb.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Yc){Rb.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
Yc.message)}},3)};$f.prototype.Rxd=function(){return this.wYa.Rxd()};$f.prototype.Pxd=function(){return this.wYa.Pxd()};Object(ud.a)($f,"InProductMessagingUIManager",null,[602]);Jf.prototype.Init=function(W){this.Cje=W};Jf.prototype.SendTrace=function(W,Ja){Rb.ULS.sendTraceTag(34182235,this.Cje,this.fXa[W],"{0}",Ja)};Object(ud.a)(Jf,"DefaultNetworkingManager",null,[717]);var ff=b(257),hf=b(326),yg=b(96);Le.prototype.ACj=function(W){W&&(InProductMessaging.Networking.NetworkingMgr=new Jf,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(W.fBj,W.TBi,W.JNg,W.OCi,W.locale,Object(qb.a)(this,this.hKi,"onDismissFirstRunExperience"),W.Jbg),this.eSa(Ue.OWi,!0))};Le.prototype.NAj=function(W){var Ja=this;if(W&&W.instance&&W.Xjc){var Eb=document.getElementById("wacDimeContainer");Eb||(Eb=document.createElement("div"),Eb.id="wacDimeContainer",document.body.appendChild(Eb));Vc.AFrameworkApplication.ga.ra("DimeFocusManagerIsEnabled")&&this.eSa("wacDimeContainer",!1);W.Xjc.parentElementId="wacDimeContainer";W.instance.launch(W.Xjc,
W.i9f).then(function(gc){Ja.XHb();document.body.removeChild(Eb);W.eUf(gc)}).catch(function(gc){Ja.XHb();document.body.removeChild(Eb);W.qPf(gc)})}else throw Error.argument("DimeExperienceUISettings");};Le.prototype.eSa=function(W,Ja){if(this.pc&&W&&(W=document.getElementById(W),this.mbi(W),W=this.pc.dN("InProductMessagingFocusId"))){var Eb=this.pc.Ii;Eb&&"InProductMessagingFocusId"===Eb.name||this.pc.vS("InProductMessagingFocusId",!1);Ja&&this.vNf(W.scope)}};Le.prototype.mbi=function(W){var Ja=!1;
Ja=void 0===Ja?!0:Ja;var Eb=this.pc.Ai("InProductMessagingFocusId");Eb.parent=ff.AFrame.CU;var gc=new hf.DOMFocusListing(function(){return W});gc.Dbb=Ja;gc.oo(3);gc.oo(2);gc.oo(4);Ja=this.pc.Psa(function(){return W},Eb,gc);Ja.RHb();Ja.a0=!0;Ja.PHa=!0};Le.prototype.vNf=function(W){W.Yk(yg.FocusManager.instance().J2);W.Yk(yg.FocusManager.instance().K2);W.bindAction(yg.FocusManager.instance().J2,oe.a.cVe);W.bindAction(yg.FocusManager.instance().K2,oe.a.bVe)};Le.prototype.XHb=function(){this.pc&&(this.pc.ida("InProductMessagingFocusId"),
this.pc.PQa("InProductMessagingFocusId"))};Le.prototype.hKi=function(W,Ja){this.XHb();W=Object.assign(new te,{completed:W,G$i:Ja});Vc.AFrameworkApplication.Ib.Be(oe.a.rDh,2,W)};Le.prototype.Rxd=function(){var W=document.activeElement,Ja=this.pc.iR();return W&&Ja&&Ja.gf&&W===Ja.gf.Rw?(Ja.gf.Cl(W),Ja.xya()?32:8):4};Le.prototype.Pxd=function(){var W=document.activeElement,Ja=this.pc.iR();return W&&Ja&&Ja.gf&&W===Ja.gf.firstElement?(Ja.gf.Cl(W),Ja.JOa()?32:8):4};Object(ud.a)(Le,"InProductMessagingUIWrapper",
null,[601]);var bf=b(140);ee.prototype.fi=function(W){W.register(ef,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Ic().Oc(function(){return new ef});W.register(Le,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Ic().Oc(function(){return new Le(yg.FocusManager.instance())});W.register($f,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Ic().Oc(function(){return new $f(Vc.AFrameworkApplication.Ib,
W.resolve("Common.IInProductMessagingUIWrapper"),W.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Vc.AFrameworkApplication.sa.Pa.Sj,Vc.AFrameworkApplication.sa.Pa.Lca)});W.register(Sd,"Common.App.InProductMessaging.InProductMessagingActor").Ic().Oc(function(){return new Sd(Vc.AFrameworkApplication.Ib,Vc.AFrameworkApplication.sa,W.resolve("Common.IInProductMessagingUIManager"))});W.register(rd,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Ic().Oc(function(){return new rd});
W.register(te,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Ic().Oc(function(){return new te});this.tb=W};ee.prototype.init=function(){var W=this;this.tb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Og();Vc.AFrameworkApplication.ga.tv(function(){Vc.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled&&bf.a.get_instance().Lk(15,function(){W.tb.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ja){W.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").vbi(Ja)})});
Vc.AFrameworkApplication.ga.ra("FreemiumUpsellShowDialogIsEnabled")&&Qe.a()&&!ug.a.vB&&1!==Vc.AFrameworkApplication.sa.Pa.Sj&&W.tb.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ja){Ja.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Eb){!Eb&&Ja.isFreemiumUpsellEnabled()&&W.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Tlf();return null})})})};ee.prototype.dispose=function(){};ee.main=function(){pf.a.instance.hj(new ee)};Ck.Object.defineProperties(ee.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(ud.a)(ee,"InProductMessagingPackage",null,[4,5]);Xd.prototype.$$c=function(W){var Ja=new Sys.StringBuilder(this.hw.oJb);Ja.append("RoamingServiceHandler.ashx?action=");Ja.append("getFirstRunExperienceSettings");Ja.append("&");Ja.append(this.Vgd(W));Ja.append("&");Ja.append(Vc.AFrameworkApplication.oj);Vc.AFrameworkApplication.Jd.hm(Ja.toString(),1,null,null,!0,2,Object(qb.a)(this,this.WKa,"getRequestSuccessCallback"),
Object(qb.a)(this,this.cka,"getRequestFailureCallback"),null)};Xd.prototype.aub=function(W){var Ja=new Sys.StringBuilder(this.hw.oJb);Ja.append("RoamingServiceHandler.ashx?action=");Ja.append("saveFirstRunExperienceSettings");Ja.append("&");Ja.append(Vc.AFrameworkApplication.oj);Ja=Ja.toString();W=Af.c(W);Vc.AFrameworkApplication.Jd.hm(Ja,2,W,null,!0,4,Object(qb.a)(this,this.Z_i,"postRequestSuccessCallback"),Object(qb.a)(this,this.g7,"postRequestFailureCallback"),null)};Xd.prototype.WKa=function(W){var Ja=
!1,Eb=null;try{if(0<W.data.me.length){var gc=Object(Sb.a)(Object,Af.a(W.data.me)),Yc=gc?gc[this.hw.dXc]:null;Yc&&(Eb=Object(Sb.a)(Object,Af.a(Yc.toString())))}Ja=!0}catch(vd){this.cka(null)}Ja&&this.qjb&&this.qjb(W.data,Eb)};Xd.prototype.cka=function(W){this.mjb&&this.mjb(W?W.data:null)};Xd.prototype.Z_i=function(W){this.Uee&&this.Uee(W?W.data:null)};Xd.prototype.g7=function(W){this.ulb&&this.ulb(W?W.data:null)};Xd.prototype.Vgd=function(W){for(var Ja=new Sys.StringBuilder("requestedsettings="),Eb=
0;Eb<W.count;Eb++)Ja.append(W.oa(Eb)),Eb<W.count-1&&Ja.append(";");return Ja.toString()};Object(ud.a)(Xd,"FirstRunExperienceRequestHandler",null,[]);Ad.prototype.QSd=function(W){W?(this.hw=W,this.Nki()&&(Rb.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),W=new we.a,W.add(this.hw.dXc),this.WSb=new Xd(this.hw,Object(qb.a)(this,this.WKa,"getRequestSuccessCallback"),Object(qb.a)(this,this.cka,"getRequestFailureCallback"),null,Object(qb.a)(this,
this.g7,"postRequestFailureCallback")),this.WSb.$$c(W)),(this.hw.S7a||Vc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.RSd()):Rb.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};Ad.prototype.Nki=function(){try{if(this.hw.S7a)return!0;if(!Vc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Vc.AFrameworkApplication.ga.ra("IsAnonymousUser"))return!1;if(this.hw.Hhi||
this.hw.V7a||Vc.AFrameworkApplication.ga.ra("IsO365ConsumerHost"))return!0;var W=Vc.AFrameworkApplication.ga.Va("FlightId");return-1!==(W?W.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ja){Rb.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ja?Ja.toString():null)}return!1};Ad.prototype.fWf=function(W){var Ja={},Eb={};Eb.FREDisplayedDate=(new Date).toUTCString();Eb.VersionDisplayed=W;Eb.RemindMeLater=!1;Ja[this.hw.dXc]=Af.c(Eb);Rb.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.WSb&&this.WSb.aub(Ja)};Ad.prototype.WKa=function(W,Ja){W=W?+W.S3-+W.tF:-1;W>this.hw.XUf?Rb.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",W,this.hw.XUf):Ja?this.Czj(Ja)?(Rb.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.hw.krf),this.RSd()):Rb.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(Rb.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.RSd())};Ad.prototype.cka=function(W){Rb.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",W?W.httpStatus:-1)};Ad.prototype.g7=function(W){Rb.ULS.sendTraceTag(51675542,306,10,
"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",W?W.httpStatus:-1)};Ad.prototype.RSd=function(){var W=this,Ja=Bd.a.instance.Lh("Common.ISystemInitiatedFeedback");Ja?this.g4f(Ja):(Rb.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Vc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Ja=Bd.a.instance.lc("Common.ISystemInitiatedFeedback"))?Ja.execute(function(Eb){W.g4f(Eb)}):
Rb.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};Ad.prototype.g4f=function(W){if(W){var Ja=this.hw.GDh;Ja&&(Vc.AFrameworkApplication.Dla(Ja),Vc.AFrameworkApplication.nCb(Ja));Rb.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ja);W.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.djb=Object(qb.a)(this,this.eLi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.djb,!0),window.addEventListener("FRELaunchedEvent",this.djb,!0)):(Rb.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.fWf(this.hw.currentVersion))}else Rb.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};Ad.prototype.eLi=function(W){if(W){var Ja=W.detail;W=W.type;var Eb=this.hw&&this.hw.campaignId?this.hw.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===W||Eb&&Ja&&Ja.id&&-1!==Ja.id.indexOf(Eb))Ja.success&&(Rb.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.fWf(this.hw.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.djb,!0),window.removeEventListener("FRELaunchedEvent",this.djb,!0))}};Ad.prototype.Czj=function(W){if("RemindMeLater"in W&&"FREDisplayedDate"in W){if("true"===W.RemindMeLater.toString()&&(+new Date-+new Date(W.FREDisplayedDate.toString()))/36E5>this.hw.krf)return!0}else if(Vc.AFrameworkApplication.ga.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in W&&W.VersionDisplayed<this.hw.currentVersion)return Rb.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(ud.a)(Ad,"FirstRunExperienceLauncher",null,[586]);ne.prototype.fi=function(W){this.tb=W;this.tb.register(586,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Ic().Oc(function(){return new Ad})};ne.prototype.init=function(){};ne.prototype.dispose=function(){};ne.main=function(){pf.a.instance.hj(new ne)};
Ck.Object.defineProperties(ne.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(ud.a)(ne,"FirstRunExperienceLauncherPackage",null,[4,5]);var Cg=b(7),Gg=b(226),xg=b(368),wc=b(276),jd=b(372),xd=b(1),me=b(38),Ae=b(9),Ze=b(388),Bf=b(15),Qf=Ze.a;Am(vf,Qf);vf.prototype.$V=function(){var W={};W.id=this.Cc;var Ja=Bf.a.instance.fa(2201);W.DialogMessage=Ja;return W};Ck.Object.defineProperties(vf.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"ClipboardReadPermissionAskDialog"}}});Object(ud.a)(vf,"ClipboardReadPermissionAskDialog",Ze.a,[]);var Vg=b(49);kf.prototype.Zdf=function(W){return W?this.sessionStateId===W.sessionStateId&&this.sessionId===W.sessionId:!1};kf.prototype.isFromCurrentSession=function(W){return this.sessionId===W.ya.UserSessionId};Object(ud.a)(kf,"SourceItem",null,[]);Am(Ve,kf);Ve.prototype.isEqual=function(W){return W&&Object.getType(W)===Ve?this.Zdf(W)&&this.activeFloatingObjectControlId===W.activeFloatingObjectControlId&&
this.sheetName===W.sheetName:!1};Ve.prototype.toString=function(){return this.type.toString()};Object(ud.a)(Ve,"ArtSourceItem",kf,[]);var Rf;(function(W){W[W.valid=0]="valid";W[W.notPairwiseDisjoint=1]="notPairwiseDisjoint";W[W.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";W[W.notValidForm=3]="notValidForm";W[W.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Rf||(Rf={}));Object(ud.b)("CopySourceValidationOptions",Rf);var De=b(45);Am(Tc,kf);Tc.prototype.isEqual=
function(W){return W&&Object.getType(W)===Tc?this.Zdf(W)&&De.Q(this.ranges,W.ranges)&&this.sheetName===W.sheetName:!1};Tc.prototype.toString=function(){return De.i(this.ranges,",",this.$,!1)};Object(ud.a)(Tc,"RangeSourceItem",kf,[]);vb.nVj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(ud.a)(vb,"ExpectedErrorNames",null,[]);qc.cX="text/plain";qc.html="text/html";qc.png="image/png";qc.PO="data/shadow-workbook";qc.vki="metadata/is-last-copy-was-external";qc.Ugi="metadata/is-last-copy-was-external-XLO-source";
qc.eYg="metadata/chrome-extension-id";qc.vrb="copyId";qc.CIg="metadata/additional-signature-data-attributes";Object(ud.a)(qc,"ClipboardDataFormat",null,[]);var Lg=b(48),$d=b(21),le=b(33);oc.prototype.AKa=function(){return oc.uYi};oc.prototype.KOh=function(){return this.C9b&&1===this.C9b.length?this.LOh(this.C9b[0]):null};oc.prototype.LOh=function(W){var Ja=$d.g(this.$),Eb=Ja.rb.rj(W),gc=Ja.qg(W,Eb);Ja=Ja.rtl;if(!gc)return null;W=$d.g(this.$).Tf(Eb);var Yc=W.Bn;if(!Yc.Kd(gc))return null;gc=Yc.Te(gc);
var vd=gc.topLeft.y,fe=gc.bottomRight.y,re=Ja?gc.bottomRight.x:gc.topLeft.x;gc=Ja?gc.topLeft.x:gc.bottomRight.x;var Oe=new Lg.a(gc+(Ja?-81:81),fe+38+6);if(Yc.SHa(Oe))return this.G4a(W,Yc,Eb,gc,fe,Ja?12:-3,66);Oe=new Lg.a(gc+(Ja?-81:81),fe);if(Yc.SHa(Oe))return this.G4a(W,Yc,Eb,gc,fe,Ja?20:3,22);Oe=new Lg.a(gc,fe+38+6);if(Yc.SHa(Oe))return this.G4a(W,Yc,Eb,gc,fe,-81+(Ja?18:0),66);gc=new Lg.a(re+(Ja?81:-81),fe);if(Yc.SHa(gc))return this.G4a(W,Yc,Eb,re,fe,-81+(Ja?12:-6),22);fe=new Lg.a(re,vd-38-6);return Yc.SHa(fe)?
this.G4a(W,Yc,Eb,re,vd,Ja?15:0,16):this.G4a(W,Yc,Eb,Ja?Yc.topLeft.x:Yc.bottomRight.x,Yc.bottomRight.y,-81+(Ja?15:-6),22)};oc.prototype.G4a=function(W,Ja,Eb,gc,Yc,vd,fe){var re=$d.g(this.$),Oe=re.rtl;W=Sys.UI.DomElement.getLocation(W.domElement);gc=new Sys.UI.Point(gc+(Oe?0:W.x)-Ja.topLeft.x,Yc+W.y-Ja.topLeft.y);Oe&&(re=re.view.visibleArea,gc.x=re.bottomRight.x-re.topLeft.x-gc.x,2===Eb||4===Eb)&&(gc.x+=Ja.bottomRight.x);gc=le.a(this.$).aka(gc);return new Sys.UI.Point(gc.x+vd,gc.y+fe)};Ck.Object.defineProperties(oc.prototype,
{BIg:{configurable:!0,enumerable:!0,get:function(){return this.clg}},Bsi:{configurable:!0,enumerable:!0,get:function(){return this.wsg}},R7i:{configurable:!0,enumerable:!0,get:function(){return this.hvg}},qzh:{configurable:!0,enumerable:!0,get:function(){return this.Tog}}});oc.uYi=["PasteRecoveryUI"];Object(ud.a)(oc,"PasteRecoveryUI",null,[988]);var lh=b(79),Kf=b(327);dd.tAg="ActiveSelection";dd.PO="ShadowWorkbook";dd.sjg="GVML";dd.cX="PlainText";dd.html="Html";dd.POg="Bitmap";Object(ud.a)(dd,"PayloadType",
null,[]);fc.hDj="Slice4";fc.iDj="Slice5";fc.jDj="Slice6";Object(ud.a)(fc,"SliceName",null,[]);ge.BEi="NotCalled";ge.success="Success";ge.failed="Failed";Object(ud.a)(ge,"SucceededPopulatingSystemClipboardOptions",null,[]);var Ph=b(374),Da;(function(W){W[W.valid=0]="valid";W[W.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";W[W.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";W[W.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
W[W.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";W[W.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";W[W.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";W[W.copySourceNotValid=7]="copySourceNotValid";W[W.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";W[W.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
W[W.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";W[W.unknown=100]="unknown"})(Da||(Da={}));Object(ud.b)("PasteValidationOptions",Da);var Mb=b(51),Bc=b(37),wd=b(150),Nd=b(36),Pe=b(158),He=b(357),ue=b(30),Ia=b(329),cb=b(10),Xb=b(22),yc=b(107),Xc=b(168),Od=b(145),Ud=b(626),Fe=b(98),gf=b(256),uf=me.a;Am(kd,uf);kd.prototype.SGg=function(W){this.addHandler(kd.WCd,W)};kd.prototype.fdj=function(W){this.removeHandler(kd.WCd,W)};kd.prototype.copy=function(W){var Ja=this;W.stopwatch=this.$.Ob.Hc("UserAction",
Vg.b().ti(W.ribbonCommandInfo.command)+"ClientSide");if(this.Ao){var Eb=Mb.GetServiceTaskFactory.Ua(this.$.da,478,479,0);Nd.TaskExtensions.Ba(Eb,function(){Ja.pasteShortcutManager=Eb.result},this.la,3)}var gc=!!Zb(this.QK);xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ug.a.bD&&(this.H7a=!1);this.Vr("Copy/before/"+xg.a[W.ribbonCommandInfo.method],!1,void 0,!0,W.copyPasteTargetType).catch(function(){});var Yc=-1985798686===W.ribbonCommandInfo.command;
if(1===this.gridView.Ue&&(Yc=this.Xr.rdf(this.gridView.ha.ta.selectedRanges,Yc),0!==Yc)){var vd=kd.t3g(Yc);this.Fza(vd,Rf[Yc],!1);return Promise.reject(!1)}W.userHash=this.userHash;W.id=Kc.a.create().toString();var fe=this,re=this;return this.t4b.onCopy(W).then(function(Oe){Oe.isAsyncCopy||W.stopwatch.stop();fe.pasteIndicationManager.uKe();Rb.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",Ph.d(W));fe.fvi(Oe,gc);!W.isFormatPainter&&fe.Ao&&
(fe.pasteShortcutManager?fe.pasteShortcutManager.elh():Rb.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(Oe){var Wc=!1,Pf="none",nf=kd.vsb,Qg=!0,Ng=-1,ti=kd.copyErrorName+kd.oJa,qh=!1,fi=null;if(Oe){fi=Oe.copyContext;Ng=Oe.reason;ti+=kd.HKa(Oe);Oe.message&&(nf=Oe.message);var $h=kd.s3g(Oe);if($h)if(3===$h.copyErrorName)Wc=!0,nf=Pf="Async Copy canceled by the user.",Qg=!1;else if(ue.a.lr($h.ewaErrors))if(nf=re.zbc($h.ewaErrors),ue.a.qh($h.ewaErrors,
kd.operationSucceededWithAlert))qh=Wc=!0;else if(ue.a.qh($h.ewaErrors,kd.pasteDataLimitHit)||ue.a.qh($h.ewaErrors,kd.copyThrottlingError))Wc=!0;13===Oe.reason?(Wc=!0,Qg=!1):11===Oe.reason&&(Qg=!1)}Wc?Rb.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Qg,Pf,Oe?re.getStringifiedError(Oe):"null",Ph.d(W)):Rb.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
Qg,Oe?re.getStringifiedError(Oe):"null",Ph.d(W));Qg&&re.Vr("Copy/fail/"+xg.a[W.ribbonCommandInfo.method],!0,void 0,void 0,W.copyPasteTargetType).catch(function(){});re.evi(W,Wc,nf,ti,Ng,qh,fi);return Promise.reject(Oe)})};kd.prototype.paste=function(W){var Ja=this;W.stopwatch=this.$.Ob.Hc("UserAction",Vg.b().ti(W.ribbonCommandInfo.command)+"ClientSide");xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ug.a.bD&&(Rb.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.H7a=!1,W.clipboardPicklingApiDataFormatsToRead=[qc.PO]);$d.g(this.$).Ki&&$d.g(this.$).Ki.e8(this.zgd(W.ribbonCommandInfo.command),W.stopwatch.id);if(W.isPasteCommandFromRecoveryUI){var Eb=this.$.da.Aa(406);var gc=wc.a.clone(Eb.wtd);Eb=Eb.ltd;W.pasteRecoveryCachedClipboardItems=Eb?Eb[kd.cHf]:null}else gc=wc.a.clone(this.gridView.ha.ta.selectedRanges);W.originalDestinations=gc;W.expandDestinations=this.i_c(W.originalDestinations,W.commandType);if(this.u_c(W.commandType,W.expandDestinations)||this.cVg())return W.userHash=
this.userHash,W.id=Kc.a.create().toString(),xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!ug.a.bD&&(W.clipboardReadPermissionPromptShown=!1,W.clipboardAsyncApiDataFormatsToRead=[qc.cX+"Async"],this.t4b.shouldShowClipboardReadPermissionDialog().then(function(Yc){Yc&&(W.clipboardReadPermissionPromptShown=!0,new vf(Ja.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.t4b.onPaste(W).then(function(Yc){return Ja.soc(Yc,W)},
function(Yc){return Ja.eFb(W,Yc)});this.$.Zd(927125067,lh.a.Vb,30,null);Rb.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',De.i(W.expandDestinations,",",this.$,!1),W.commandType,W.copyPasteTargetType);return Promise.resolve(!0)};kd.prototype.zgd=function(W){if(xd.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(W){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};kd.prototype.cVg=function(){return!!$d.g(this.$).ha.Oa.activeFloatingObjectControlId&&this.$.Dq(null,!1,470)};kd.prototype.EBb=function(){var W=Zb(this.QK);return W&&W.commandParameters?W.commandParameters.copyPasteTargetType:0};kd.prototype.uki=function(){return!!Zb(this.QK)&&Xe(Zb(this.QK),this.$)};kd.prototype.Vr=function(W,Ja,Eb,gc,Yc){var vd=this;Eb=void 0===Eb?!1:Eb;gc=void 0===gc?!1:gc;Yc=void 0===Yc?0:Yc;try{this.Ao&&this.pasteShortcutManager&&
this.pasteShortcutManager.W6b();var fe=Yc,re=this.xri();if(!gc&&2===re)return Rb.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ja,Eb,gc,Yc,re),Promise.reject(null);0===fe&&(fe=re);var Oe=this.$.Ob.Hc("UserAction","ClearCopyState"),Wc=Oe.id;Rb.ULS.sendTraceTag(537167820,
0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ja,Eb,gc,Yc,re);this.Xr.Nxb();this.c5i();return this.t4b.onCancelCopy(Ja).then(function(){Ja&&xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ug.a.bD&&(vd.H7a=!1);Oe.stop();vd.Kmf(W,Wc,!0,Eb,Ja,"","",Oe.zc,fe);return Promise.resolve(!0)},
function(Pf){Rb.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",Pf?vd.getStringifiedError(Pf):"null");Oe.stop();var nf=kd.rVg+kd.oJa,Qg=kd.vsb;Pf&&(nf+=kd.HKa(Pf),Pf.message&&(Qg=Pf.message));vd.Kmf(W,Wc,!1,Eb,Ja,Qg,nf,Oe.zc,fe);return Promise.reject(Pf)})}catch(Pf){return Promise.reject(null)}};kd.prototype.R2b=function(W,Ja,Eb,gc,Yc){Eb=void 0===Eb?!1:Eb;gc=void 0===gc?!1:gc;Yc=void 0===Yc?0:Yc;return gc||!xd.EwaSettings.ma(665)||
this.eih()?this.Vr(W,Ja,Eb,gc,Yc):(Rb.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};kd.prototype.Fza=function(W,Ja,Eb){Rb.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Ja);var gc=new Fe.a;gc.ia("reason",Ja);Ud.a(Xc.a.discontinuousSelectionBlocking,
[Eb?Od.a.oYi:Od.a.j4g],!0,!0,!1,!1,gc);W=ue.a.gd(1,1,748,W,0,371863010,"DiscontinuousSelectionBlocking");xd.EwaSettings.Kz()?new He.a(this.$,W):(W=new Pe.ErrorDialog(this.$,W),W.initialize(),W.kf())};kd.prototype.xri=function(){var W=Zb(this.QK);return W&&W.sourceItem?Object.getType(W.sourceItem)===Ve?2:1:0};kd.prototype.dragDropCells=function(W,Ja,Eb,gc,Yc){var vd=this;Yc=void 0===Yc?!1:Yc;W.stopwatch=this.$.Ob.Hc("UserAction","DragDropClientSide");this.Vr("DragDrop/before/"+xg.a[W.ribbonCommandInfo.method],
!1,void 0,void 0,W.copyPasteTargetType).catch(function(){});var fe=Yc?2:1,re=0;re=Yc?4:gc?256:128;var Oe={encounteredDeploymentErrors:!1};Oe.commandParameters=W;W.userHash=this.userHash;W.id=Kc.a.create().toString();return this.Xr.pasteRange(W.ribbonCommandInfo,De.q(Ja,this.$),De.q(Eb,this.$),fe,re,[W.stopwatch],Oe,!1).then(function(){Rb.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',W.copyPasteTargetType);vd.gridView.ha.selectionType=-1;
vd.Vud(W,fe,Ja,Eb,Oe);return Promise.resolve(!0)},function(Wc){Rb.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',Wc?vd.getStringifiedError(Wc):"null",W.copyPasteTargetType);return vd.aBd(Wc,W,fe,Ja,Eb,Oe)})};kd.prototype.zih=function(W,Ja,Eb,gc,Yc){var vd=this;Yc=void 0===Yc?!1:Yc;W.stopwatch=this.$.Ob.Hc("UserAction","DragDropReplaceClientSide");this.R2b("DragDropReplace/before/"+xg.a[W.ribbonCommandInfo.method],!1,void 0,void 0,W.copyPasteTargetType).catch(function(){});
var fe=Yc?2:1,re=0;re=Yc?4:gc?256:128;var Oe={encounteredDeploymentErrors:!1};Oe.commandParameters=W;xd.EwaSettings.getBooleanFeatureGate(Kf.a.I7b,!1)&&(W.isDragInsert=!1);W.userHash=this.userHash;W.id=Kc.a.create().toString();return this.Xr.pasteRange(W.ribbonCommandInfo,De.q(Ja,this.$),De.q(Eb,this.$),fe,re,[W.stopwatch],Oe,!1).then(function(){Rb.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',W.copyPasteTargetType);vd.gridView.ha.selectionType=
-1;vd.Vud(W,fe,Ja,Eb,Oe);return Promise.resolve(!0)},function(Wc){Rb.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',Wc?vd.getStringifiedError(Wc):"null",W.copyPasteTargetType);return vd.aBd(Wc,W,fe,Ja,Eb,Oe)})};kd.prototype.yih=function(W,Ja,Eb,gc,Yc){var vd=this;Yc=void 0===Yc?!1:Yc;W.stopwatch=this.$.Ob.Hc("UserAction","DragDropInsertClientSide");this.R2b("DragDropInsert/before/"+xg.a[W.ribbonCommandInfo.method],!1,void 0,void 0,W.copyPasteTargetType).catch(function(){});
var fe=Yc?2:1,re=De.K(this.i_c([Eb],fe)),Oe=this.$.ea.qa.sheetName,Wc=this.$.ea.qa.sheetName,Pf=De.v(Ja,this.$);Pf.SheetName=Oe;Oe=De.v(re,this.$);Oe.SheetName=Wc;gc=re.isRow||Ja.isRow||gc?1:0;var nf={encounteredDeploymentErrors:!1};W.isDragInsert=!0;nf.commandParameters=W;W.userHash=this.userHash;W.id=Kc.a.create().toString();Yc=this.Xr.Bih(nf,Pf,Oe,Yc,gc,W.ribbonCommandInfo);var Qg=this;return gf.c(Yc.then(function(){Rb.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',
W.copyPasteTargetType);vd.gridView.ha.selectionType=-1;vd.Vud(W,fe,Ja,Eb,nf);return Promise.resolve(!0)},function(Ng){Rb.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',Ng?Qg.getStringifiedError(Ng):"null",W.copyPasteTargetType);return Qg.aBd(Ng,W,fe,Ja,Eb,nf)})).CWR(function(){return!0})};kd.prototype.adi=function(W,Ja){var Eb=this,gc=Zb(this.QK);if(!gc)return Rb.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
ic.Task.Ra(!1);if(!Pd(gc.sourceItem))return Rb.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),ic.Task.Ra(!1);var Yc=gc.sourceItem;if(!Yc)return Rb.ULS.shipAssertTag(537167810,0,!!Yc,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),ic.Task.Ra(!1);if(!Yc.isFromCurrentSession(this.$))return Rb.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),ic.Task.Ra(!1);if(1<Yc.ranges.length)return Rb.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.Fza(2139,"InsertCopiedCutCells",!0),ic.Task.Ra(!1);gc=De.K(Yc.ranges);var vd=this.gridView.ha.ta.ud.clone();W=De.K(this.i_c([vd],W));var fe=this.Akf();Yc=Yc.sheetName;vd=this.$.ea.qa.sheetName;var re=De.v(gc,this.$);re.SheetName=Yc;var Oe=De.v(W,this.$);Oe.SheetName=vd;return(W.ff||gc.ff?ic.Task.Ra(0):W.isRow||gc.isRow?ic.Task.Ra(1):this.bdi.J4b(this.$,$d.g(this.$).rtl)).CWR(function(Wc){return Eb.Xr.executeInsertCopiedCutCellsOperation(re,
Oe,fe,Wc.result,Ja)}).continueWith(function(){fe?Eb.Xr.Nxb():Eb.Vr("InsertCopiedCutCells/success/"+xg.a[Ja.method],!0)})};kd.prototype.Tpd=function(){var W=Zb(this.QK),Ja=this.gridView.ha.ta.Lg;return!!W&&Pd(W.sourceItem)&&Ja&&1===W.sourceItem.ranges.length};kd.prototype.Akf=function(){return this.Bkf(-911352779)};kd.prototype.Ljc=function(){return this.Bkf(-1985798686)};kd.prototype.u_c=function(W,Ja){var Eb=new wd.a(this.$.xa),gc=36===W,Yc=Eb.ke(4);W=2===this.EBb()&&Eb.ke(1);gc=gc&&Yc;Eb=!Eb.tj||
!this.Ljc()||!wd.a.v7b(Ja,$d.g(this.$));return gc||W||this.$.Dq(Ja,!0)&&Eb};kd.prototype.Zgc=function(W,Ja){return this.Xr.Zgc(W,Ja)};kd.prototype.dispose=function(){uf.prototype.dispose.call(this);this.wm();this.QK.removeMetadataChangeListener(kd.crf)};kd.prototype.z7c=function(W,Ja,Eb,gc,Yc,vd){if(!this.sZg(W.commandParameters.ribbonCommandInfo.command))return W.cseStatus=2,!1;if(vd&&Ja.Kd(gc))return W.cseStatus=4,!1;if(Eb!==Yc)return W.cseStatus=6,!1;if(xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(gc.width%Ja.width||gc.height%Ja.height))return W.cseStatus=16,!1;if(xd.EwaSettings.getBooleanFeatureGate(Kf.a.pGe,!1)){if(Eb=Ja,gc=gc.Te(this.gridView.Hh),Ja=null===Ja.Te(this.gridView.Hh),Yc=W.commandParameters.ribbonCommandInfo.command,Ja&&1804571062!==Yc&&-185374993!==Yc||!gc)return W.cseStatus=7,!1}else if(Eb=Ja.Te(this.gridView.Hh),gc=gc.Te(this.gridView.Hh),!Eb||!gc)return W.cseStatus=7,!1;Ja=De.v(Eb,this.$);Ja=this.Sg.sYi(this.gridView,Ja,De.v(gc,this.$),W.commandParameters.ribbonCommandInfo.command,
W.commandParameters.stopwatch);1===Ja&&(vd&&(this.Sg.f1c(Eb,!1),this.Sg.f1c(Eb,!0)),-185374993===W.commandParameters.ribbonCommandInfo.command&&$d.g(this.$).O4i(),this.pasteIndicationManager.Ikd(W.commandParameters.id),this.Evc(W.commandParameters.expandDestinations,W.commandParameters.isPasteCommandFromRecoveryUI),this.Yze("DoPasteClientEstimation/"+xg.a[W.commandParameters.ribbonCommandInfo.method],W));W.cseStatus=Ja;return 1===Ja};kd.prototype.nIf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,
!1,!1,this.bxi)};kd.prototype.vnf=function(W,Ja,Eb,gc){W=of(W,Ja,Eb,gc,this.$.ya.UserSessionId);W.k=!0;Vg.b().Pe(45,W,!0)};kd.prototype.jCf=function(W,Ja,Eb,gc,Yc){var vd=!1,fe=!1,re=kd.vsb,Oe=kd.yKe+kd.oJa;W&&(Oe+=kd.HKa(W),ue.a.lr(W.ewaErrors)?(re=this.zbc(W.ewaErrors),ue.a.qh(W.ewaErrors,[-103190598])&&(vd=!0)):W.message&&(re=W.message));fe||(fe=this.mpd(W));Ja=of(Ja,Eb,gc,Yc,this.$.ya.UserSessionId);Ja.k=!1;Ja.l=fe;Ja.n=re;Ja.p=Oe;Ja.q=vd;Vg.b().Pe(45,Ja,!0);return Promise.reject(W)};kd.prototype.sZg=
function(W){switch(W){case 237279923:case 808159687:return Kf.a.Bli;case -185374993:return!0;case 1804571062:return!0;default:return!1}};kd.prototype.Bkf=function(W){var Ja=Zb(this.QK);if(!Ja)return!1;var Eb=Ja.sourceItem;return Eb&&!Eb.isFromCurrentSession(this.$)?(Rb.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Ja.commandParameters.ribbonCommandInfo.command===W};kd.prototype.eih=function(){var W=Zb(this.QK);
return W?(W=W.sourceItem)&&!W.isFromCurrentSession(this.$)?(Rb.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};kd.prototype.Twj=function(W){return W&&W.lastCopy?Xe(W.lastCopy,this.$):!0};kd.prototype.PZe=function(W,Ja,Eb,gc,Yc){var vd={};vd.a=this.$.ya.UserSessionId;vd.e=W.stopwatch.id;vd.c=Vg.b().ti(W.ribbonCommandInfo.command);vd.b=xg.a[W.ribbonCommandInfo.method];vd.d=W.id;vd.f=Eb.toString();
vd.g=gc.toString();vd.h=Ja.toString();vd.o=W.stopwatch.zc;vd.q=!1;vd.r=W.copyPasteTargetType.toString();vd.s=Yc.encounteredDeploymentErrors;xd.EwaSettings.getBooleanFeatureGate(Kf.a.I7b,!1)&&(vd.i=Yc.commandParameters.dragDropIsShiftKeyDown,vd.j=Yc.commandParameters.isDragInsert);return vd};kd.prototype.Vud=function(W,Ja,Eb,gc,Yc){W=this.PZe(W,Ja,Eb,gc,Yc);W.k=!0;Vg.b().Pe(45,W,!0)};kd.prototype.mvi=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){W=this.PZe(W,Ja,Eb,gc,Oe);W.k=!1;W.l=Yc;W.n=vd;W.p=fe;W.q=re;Vg.b().Pe(45,
W,!0)};kd.prototype.Kmf=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){var Wc={};Wc.a=this.$.ya.UserSessionId;Wc.b=Ja;Wc.c=W;Wc.f=Eb;Wc.e=gc;Wc.d=Yc;Wc.g=vd;Wc.h=fe;Wc.i=re;Wc.j=Oe.toString();Vg.b().Pe(46,Wc,!0)};kd.prototype.fvi=function(W,Ja){W=this.nZe(W.commandParameters,W);W.l=!0;W.j=Ja;Vg.b().Pe(43,W,!0)};kd.prototype.evi=function(W,Ja,Eb,gc,Yc,vd,fe){W=this.nZe(W,fe);W.l=!1;W.m=Ja;W.o=Eb;W.y=gc;W.x=Yc;W.z=vd;Vg.b().Pe(43,W,!0);Rb.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
W.y,W.x,W.m,W.z,W.o)};kd.prototype.nZe=function(W,Ja){var Eb={};Eb.a=this.$.ya.UserSessionId;Eb.f=W.stopwatch.id;Eb.g=W.id;Eb.c=Vg.b().ti(W.ribbonCommandInfo.command);Eb.b=xg.a[W.ribbonCommandInfo.method];Eb.q=W.stopwatch.zc;Eb.bd=kd.Jac();Eb.bg=W.copyPasteHandlerName;Eb.bj=void 0===W.ribbonCommandInfo.Xe||null===W.ribbonCommandInfo.Xe?null:jd.a[W.ribbonCommandInfo.Xe];Eb.bq=W.uploadToClipService;Eb.br=W.floatingObjectType;Eb.s=W.copyPasteTargetType.toString();Eb.bc=de(W.copyPasteTargetType);Eb.z=
!1;if(Ja){Eb.bk=Ja.id;Eb.bl=Ja.serverRequestTimeInMs;Ja.requestTelemetryData&&(Eb.bm=Ja.requestTelemetryData.EcsOperationDuration,Eb.bn=Ja.requestTelemetryData.EcsRequestDuration,Eb.bo=Ja.requestTelemetryData.WfeRequestDuration);Eb.d=Ja.sourceItem?Ja.sourceItem.toString():null;Eb.e=-1;if(Pd(Ja.sourceItem)){Eb.e=0;W=Cl(Ja.sourceItem.ranges);for(var gc=W.next();!gc.done;gc=W.next())Eb.e+=gc.value.mQ}Eb.h=Ja.isAsyncCopy;Eb.i=Ja.isFromCache;Eb.k=Ja.isSelectionAllowed;Eb.r=Ja.plainTextPayloadSize;Eb.u=
Ja.htmlPayloadSize;Eb.v=Ja.htmlSizeExceedsLimit;Eb.w=Ja.copyTotalSizeExceedsLimit;Eb.t=Ja.shadowWorkbookPayloadSize;Eb.p=Ja.clientSideCopyTime;Eb.ba=Ja.encounteredDeploymentErrors;Eb.bb=Ja.shadowWorkbookSizeExceedsLimit;Eb.be=Ja.syncClipboardItemsKeys;Eb.bf=Ja.asyncClipboardItemsKeys;Eb.bh=this.mDe(Ja.succeededPopulatingSystemClipboardSync);Eb.bi=this.mDe(Ja.succeededPopulatingSystemClipboardAsync)}return Eb};kd.prototype.Evc=function(W,Ja){Ja=void 0===Ja?!1:Ja;if(!this.gridView.isEditing&&!this.gridView.Ni){var Eb=
this.gridView.ha.ta,gc=!Ja&&1===W.length&&De.Q(W,Eb.selectedRanges),Yc=gc?Eb.activeCell:W[0].topLeft;W[0].contains(Yc)||(Rb.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",Eb.selectedRanges,Eb.sB,Eb.activeCell,W,gc,Yc,Ja),Yc=W[0].topLeft);this.gridView.ha.JD(W,0,Yc,0,void 0,yc.a.o4g)}};kd.prototype.d2e=
function(W,Ja){var Eb={};Eb.a=this.$.ya.UserSessionId;Eb.g=W.stopwatch.id;Eb.t=W.stopwatch.zc;Eb.bz=!1;Ja&&(Eb.bv=Ja.id,Eb.bw=Ja.serverRequestTimeInMs,Eb.n=Ja.commandParameters.clipboardFormatReadTimes,Eb.o=Ja.commandParameters.clipboardFormatReadStatus,Eb.p=Ja.commandParameters.clipboardReadPermissionPromptShown,Eb.q=Ja.commandParameters.asyncApiReadTimedOut,Ja.requestTelemetryData&&(Eb.cb=Ja.requestTelemetryData.EcsOperationDuration,Eb.cc=Ja.requestTelemetryData.EcsRequestDuration,Eb.cd=Ja.requestTelemetryData.WfeRequestDuration));
Eb.x=W.copyPasteTargetType.toString();Eb.bl=de(W.copyPasteTargetType);Eb.br=W.copyPasteHandlerName;Eb.i=De.i(W.expandDestinations,",",this.$,!1);Eb.h=De.i(W.originalDestinations,",",this.$,!1);Eb.e=W.id;Eb.d=W.commandType;Eb.c=Vg.b().ti(W.ribbonCommandInfo.command);Eb.b=xg.a[W.ribbonCommandInfo.method];Eb.bf=!1;Eb.bg=!1;Eb.bp=kd.Jac();Eb.bt=void 0===W.ribbonCommandInfo.Xe||null===W.ribbonCommandInfo.Xe?null:jd.a[W.ribbonCommandInfo.Xe];Eb.cj=W.isPasteCommandFromEnterShortcut;if(Eb.ca=W.isPasteCommandFromRecoveryUI)Eb.cf=
W.pasteRecoveryUndoStopwatch.id,Eb.cg=W.pasteRecoveryUndoStopwatch.zc;if(Ja){if((W=Ja.copyContextSnapshot)&&!Ja.wasLastCopyExternal){Eb.f=W.commandParameters.id;Eb.j=W.sourceItem.toString();Eb.k=-1;if(Pd(W.sourceItem)){Eb.k=0;for(var gc=Cl(W.sourceItem.ranges),Yc=gc.next();!Yc.done;Yc=gc.next())Eb.k+=Yc.value.mQ}Eb.bg=1===W.commandParameters.commandType}else Ja.clipboardItems?Eb.f=Ja.clipboardItems.getItem(qc.vrb):Rb.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
Eb.bz=Ja.pasteRecoveryUIDisplayed;Eb.ci=Ja.cseStatus}else Rb.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Eb};kd.prototype.swi=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){W=this.d2e(W,re);W.l=!1;W.m=Ja;W.s=Eb;W.bc=gc;W.be=Yc;W.bd=vd;W.bf=fe;re?(W.y=fd(re)||!re.copyContextSnapshot,W.bi=!W.y&&Xe(re.copyContextSnapshot,this.$),W.bj=re.shadowWorkbookSizeExceedsLimit,W.v=re.shadowWorkbookPayloadSize,W.w=re.htmlPayloadSize,W.bq=Qc(re.clipboardItems),
W.bb=re.activeSelectionType,W.bs=re.isSameSession,W.bn=re.payloadOrigin,W.bo=re.payloadType,W.bu=re.externalAppSource,W.bx=re.indicationDisplayScheduled,W.by=re.pasteIndicationDisplayStatus,W.ck=re.pasteDestinationHasMergedCells):W.bi=Xe(Oe,this.$);Vg.b().Pe(44,W,!0);Rb.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",W.be,W.bd,W.m,W.bf,W.s)};kd.prototype.twi=function(W){var Ja=
this.d2e(W.commandParameters,W);Ja.y=W.wasLastCopyExternal;Ja.l=!0;Ja.u=W.plainTextPayloadSize;Ja.v=W.shadowWorkbookPayloadSize;Ja.w=W.htmlPayloadSize;Ja.z=W.isClipboardDataContainShadowWorkbook;Ja.ba=W.isShadowWorkbookParsedSuccessfully;Ja.bb=W.activeSelectionType;Ja.bc=W.pasteResult;Ja.bh=W.encounteredDeploymentErrors;Ja.bj=W.shadowWorkbookSizeExceedsLimit;Ja.bk=Sc(W);Ja.bq=Qc(W.clipboardItems);Ja.bs=W.isSameSession;Ja.bn=W.payloadOrigin;Ja.bo=W.payloadType;Ja.bu=W.externalAppSource;Ja.bx=W.indicationDisplayScheduled;
Ja.by=W.pasteIndicationDisplayStatus;Ja.ck=W.pasteDestinationHasMergedCells;Ja.bm=W.clipboardItems?W.clipboardItems.getItem(qc.eYg):null;Ja.bi=!W.isSameSession&&!W.wasLastCopyExternal;Vg.b().Pe(44,Ja,!0)};kd.prototype.Ek=function(){this.$.xa.zg(this.ii);this.$.xa.xoe(this.Tnc);this.$.userOperationManager.Wu(this.mS);this.$.tl(this.zd);$d.g(this.$).rc.sl(this.tFb)};kd.prototype.wm=function(){this.$&&this.$.xa&&(this.$.xa.Vg(this.ii),this.$.xa.fRf(this.Tnc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.Cr(this.mS);
this.gridView&&this.gridView.rc&&this.gridView.rc.kl(this.tFb)};kd.prototype.eFb=function(W,Ja){var Eb=null,gc=!1,Yc=null,vd="UnknownFailure",fe=-1,re=kd.vsb,Oe=kd.pasteErrorName+kd.oJa,Wc=!1;this.pasteIndicationManager.Ikd(W.id);this.Off&&this.pasteDestinationHasMergedCells(W.expandDestinations)&&(Ja.pasteContext.pasteDestinationHasMergedCells=!0);var Pf=Zb(this.QK);(W.clearStateOnFinish||W.clearSystemClipboard)&&this.Vr("Paste/fail/"+xg.a[W.ribbonCommandInfo.method],!0,void 0,void 0,W.copyPasteTargetType).catch(function(){});
if(Ja){fe=Ja.reason;Oe+=kd.HKa(Ja);Ja.message&&(re=Ja.message);if(Eb=kd.F3g(Ja))if(1===Eb.pasteErrorName)gc=!0,vd="CopyPasteLengthTooLongPopup",re=Yc="The pasted content is too long. Popup a dialog to the user.",Rb.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Yc,W.copyPasteTargetType),Eb=ue.a.gd(1,0,26,687,0,1306609195,"CopyPasteOversizeError"),xd.EwaSettings.Kz()?new He.a(this.$,Eb):(Eb=new Pe.ErrorDialog(this.$,Eb),Eb.initialize(),Eb.kf());
else if(7===Eb.pasteErrorName)gc=!0,vd="No-Op",re=Yc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Rb.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Yc,W.copyPasteTargetType);else if(8===Eb.pasteErrorName)gc=!0,vd="UseShortcutsPopup",re=Yc="Unable to paste content from the system clipboard. Popup dialog to the user.",Rb.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
Yc,W.copyPasteTargetType),this.nIf();else if(18===Eb.pasteErrorName){gc=!0;vd="PasteExternalNotSupportMultipleSelectionPopup";re="Paste external not support multiple selection.";Yc="Unknown";var nf=2139;100!==Eb.validationFailureReason&&(Yc=Da[Eb.validationFailureReason],nf=kd.fDe(Eb.validationFailureReason));this.Fza(nf,Yc,!0)}else 20===Eb.pasteErrorName||19===Eb.pasteErrorName?(gc=!0,20===Eb.pasteErrorName?(vd="PasteAcrossSessionNotSupportMultipleSelectionPopup",re="Paste across session does not support multiple selection."):
(vd="PasteInSameSessionNotSupportMultipleSelectionPopup",re="This kind of multiple selection is not supported for same session paste."),Yc="Unknown",nf=2139,100!==Eb.validationFailureReason&&(Yc=Da[Eb.validationFailureReason],nf=kd.fDe(Eb.validationFailureReason)),Eb=6===Eb.validationFailureReason,this.u_c(W.commandType,W.expandDestinations)&&Eb&&this.Evc(W.expandDestinations),this.Fza(nf,Yc,!0)):6===Eb.pasteErrorName?(gc=!0,vd="No-Op",re=Yc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
Rb.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Yc,W.copyPasteTargetType)):17===Eb.pasteErrorName?(gc=!0,vd="No-Op",re=Yc="Paste text on Art is not yet a supported operation",Rb.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Yc,W.copyPasteTargetType)):16===Eb.pasteErrorName?(gc=!0,vd="No-Op",re=Yc="Paste has failed because the previous copy has failed",Rb.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
Yc,W.copyPasteTargetType,this.getStringifiedError(Eb))):ue.a.lr(Eb.ewaErrors)?(ue.a.A$(Eb.ewaErrors)||ue.a.qh(Eb.ewaErrors,ue.a.hdc())?(gc=!0,vd="CommunicationError",Yc=ue.a.Xc(Eb.ewaErrors),Rb.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',re,W.copyPasteTargetType)):ue.a.qh(Eb.ewaErrors,kd.$kj)?(gc=!0,vd="SavingWorkbookError",Yc=ue.a.Xc(Eb.ewaErrors),Rb.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
re,W.copyPasteTargetType)):ue.a.qh(Eb.ewaErrors,kd.operationSucceededWithAlert)&&(Wc=gc=!0,vd="OperationSucceededWithAlert",Yc=ue.a.Xc(Eb.ewaErrors),Rb.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',re,W.copyPasteTargetType)),gc||(re=this.zbc(Eb.ewaErrors),gc=this.mpd(Ja))):11===Eb.pasteErrorName&&(gc=!0,vd="No-Op",re="Paste has failed because user try copy cross-session oart object");15===Ja.reason&&(gc=!0,vd="No-Op",re="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Xb.a.equals(Oe,vb.nVj,!1)&&(gc=!0,vd="No-Op",re="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}gc||Rb.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Ja?this.getStringifiedError(Ja):"null",W.copyPasteTargetType);this.swi(W,gc,re,vd,Oe,fe,Wc,Ja.pasteContext,Pf);return Promise.reject(Ja)};kd.prototype.soc=function(W,Ja){var Eb;Rb.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Ja.copyPasteTargetType);this.pasteIndicationManager.Ikd(Ja.id);if(this.xYi(Ja.copyPasteTargetType,W)){xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ug.a.bD&&W.wasLastCopyExternal&&W.payloadType===dd.PO&&(this.H7a=!0);var gc=null;(null===(Eb=W.pastedRange)||void 0===Eb?0:Eb.Ranges)&&0<W.pastedRange.Ranges.length?gc=De.g(W.pastedRange.Ranges):W.wasLastCopyExternal||(gc=Ja.expandDestinations);this.Lmj(W,gc);if(this.Pyj(W,gc)){Eb=wc.a.clone(Ja.originalDestinations);
gc=1028===Ja.commandType?wc.a.clone(Ja.expandDestinations):wc.a.clone(gc);var Yc=null;W.wasLastCopyExternal&&(Ja.isKeyboardEvent||Ja.isPasteCommandFromRecoveryUI)&&(Yc={},Yc=(Yc[kd.cHf]=W.clipboardItems,Yc));this.Off&&this.pasteDestinationHasMergedCells(Ja.expandDestinations)&&(W.pasteDestinationHasMergedCells=!0);W.pasteRecoveryUIDisplayed=!0;var vd=new oc(this.$,Eb,gc,Yc),fe=Mb.GetServiceTaskFactory.Ua(this.$.da,406,405,0);Nd.TaskExtensions.Ba(fe,function(){var re=fe.result;re.OOg(vd);re.ZBj(Ja.ribbonCommandInfo.method)},
this.la,8)}}this.Yze("Paste/success/"+xg.a[Ja.ribbonCommandInfo.method],W);this.twi(W);this.t3f&&(!Ja.isKeyboardEvent||Sc(W))&&this.$.ea.Zg.get(66)&&(Rb.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.t3f=!1,this.f5g());return Promise.resolve(!0)};kd.prototype.Pyj=function(W,Ja){return!Ja||1!==Ja.length||W.commandParameters.clearSystemClipboard||W.commandParameters.clearStateOnFinish||W.commandParameters.skipClipboardAccess?!1:
fd(W)&&(Ja=W.clipboardItems.getItem(qc.cX),W=W.clipboardItems.getItem(qc.html),void 0===Ja||null===Ja||Ja.length>this.Twd||void 0===W||null===W||W.length>this.zOa)?(Rb.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};kd.prototype.xYi=function(W,Ja){return 1===W||Ja.payloadType===dd.cX||xd.EwaSettings.ma(162)&&Ja.payloadType===dd.html||xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!ug.a.bD&&Ja.payloadType===dd.PO};kd.prototype.pasteDestinationHasMergedCells=function(W){var Ja=$d.g(this.$).Ea.kF();if(!Ja||!Ja.length)return!1;Ja=Cl(Ja);for(var Eb=Ja.next();!Eb.done;Eb=Ja.next())if(Eb.value.Lw(W[0]))return!0;return!1};kd.prototype.Yze=function(W,Ja){var Eb=this,gc;(function(){var Yc=Eb.Tgi(Ja);gc=Yc.uHa;return Yc})().returnValue&&this.Vr(W,gc,void 0,void 0,Ja.commandParameters.copyPasteTargetType).catch(function(){})};kd.prototype.aBd=function(W,Ja,Eb,gc,Yc,vd){Rb.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",W?this.getStringifiedError(W):"null");var fe=!1,re=!1,Oe=!1,Wc=kd.vsb,Pf=kd.yKe+kd.oJa;W&&(Pf+=kd.HKa(W),ue.a.lr(W.ewaErrors)?(Wc=this.zbc(W.ewaErrors),ue.a.qh(W.ewaErrors,kd.operationSucceededWithAlert)&&(fe=!0),ue.a.qh(W.ewaErrors,kd.dragDropNonEmptyRange)&&(re=Oe=!0)):W.message&&(Wc=W.message));Oe||(Oe=this.mpd(W));re?this.gridView.ha.selectionType=-1:this.Xr.U7i(Yc);this.mvi(Ja,Eb,gc,Yc,Oe,Wc,Pf,fe,vd);return Promise.reject(W)};kd.prototype.i_c=
function(W,Ja){var Eb=W,gc=this.USh();if(null===gc||void 0===gc?0:gc.ranges)Eb=this.Xr.pUg(Ja,gc.ranges,W);return Eb};kd.prototype.USh=function(){var W=Zb(this.QK);return W&&Pd(W.sourceItem)?W.sourceItem:null};kd.prototype.c5i=function(){this.raiseEvent(kd.WCd,null)};kd.prototype.Lmj=function(W,Ja){var Eb=W.commandParameters.originalDestinations;Ja&&(De.Q(this.gridView.ha.ta.selectedRanges,Eb)?(this.Evc(Ja),Rb.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
cb.HelperMethods.Oob(Ja))):W.commandParameters.isPasteCommandFromRecoveryUI?(this.Evc(Ja,!0),Rb.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Ja,Ja[0].topLeft)):Rb.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",cb.HelperMethods.Oob(Eb)))};
kd.prototype.Tgi=function(W){if(W.isPlainTextPaste||W.isHtmlPaste||sd(W)||W.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,uHa:!1};var Ja=W.copyContextSnapshot;if(W.commandParameters.clearStateOnFinish)return{returnValue:!0,uHa:!0};if(Ja&&Pd(Ja.sourceItem)){var Eb=Ja.sourceItem;if(!Eb.isFromCurrentSession(this.$))return{returnValue:!1,uHa:!0};Ja=-1985798686===Ja.commandParameters.ribbonCommandInfo.command;if(!(1<Eb.ranges.length||1<W.commandParameters.expandDestinations.length)){var gc=
De.K(Eb.ranges);W=De.K(W.commandParameters.expandDestinations);var Yc=this.$.ea.qa.sheetName;Eb=Eb.sheetName;if(Eb===Yc&&W.equals(gc))return{returnValue:!1,uHa:!0};if(Eb===Yc&&W.Te(gc))return{returnValue:!0,uHa:!1}}return{returnValue:Ja,uHa:!0}}return{returnValue:!1,uHa:!0}};kd.prototype.iEf=function(){var W=Zb(this.QK);(W=this.Xr.Gwb(W))&&W.isFromCurrentSession(this.$)&&this.Vr("OnStartEdit",!1).catch(function(){})};kd.prototype.zbc=function(W){W=ue.a.BPh(W,kd.oJa);return this.dBi+Hb.a.sw(W).toString()};
kd.prototype.mpd=function(W){W=kd.HKa(W);return!!W&&Xb.a.w2a(W,kd.cBi)};kd.prototype.f5g=function(){var W=ue.a.gd(1,2,328,329,ug.a.rp?330:ug.a.$H?331:332,530046625,"ActivateLocalStorage"),Ja=Mb.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Nd.TaskExtensions.Ba(Ja,function(){Ja.result.eg(41,W)},this.la,3)};kd.prototype.mDe=function(W){return void 0===W||null===W?ge.BEi:W?ge.success:ge.failed};kd.F3g=function(W){var Ja=W.innerError;return Ja&&0!==Ja.pasteErrorName?W.innerError:null};kd.s3g=function(W){var Ja=
W.innerError;return Ja&&0!==Ja.copyErrorName?W.innerError:null};kd.HKa=function(W){var Ja="";if(!W)return kd.BHe;W.errorName&&(Ja=W.errorName,W.innerError&&(Ja+=kd.oJa+kd.HKa(W.innerError)));Ja||(Ja=W&&W.name?W.name:kd.BHe);return Ja};kd.Jac=function(){kd.pMb||(Bc.a.dgf()?kd.pMb=fc.jDj:Bc.a.qqd()?kd.pMb=fc.iDj:kd.pMb=fc.hDj);return kd.pMb};kd.fDe=function(W){switch(W){case 7:case 1:return 2146;case 5:return 2143;case 6:return 2142;case 8:case 3:case 2:case 4:case 9:case 10:return 2139;default:return Rb.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",W),2146}};kd.t3g=function(W){switch(W){case 3:return 2140;case 1:return 2141;case 2:case 4:return 2139;default:return Rb.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",W),2146}};Ck.Object.defineProperties(kd.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.Aa(373)}}});
kd.crf="EwaJsMetadataChangeListenerId";kd.WCd="cpiOSC";kd.sdh="cpiDID";kd.vsb="Unknown";kd.BHe="UnknownError";kd.oJa="_";kd.yKe="DragAndDropError";kd.pasteErrorName="PasteError";kd.rVg="CancelError";kd.copyErrorName="CopyError";kd.cBi="MergedCellOverlap";kd.cHf="PasteRecoveryCachedClipboardItems";kd.$kj=[1352631530,1679665408];kd.operationSucceededWithAlert=[-103190598];kd.pasteDataLimitHit=[1306609195];kd.copyThrottlingError=[-386183710];kd.dragDropNonEmptyRange=[563945982];kd.pMb=null;Object(ud.a)(kd,
"CopyPasteInfrastructure",me.a,[735,736,2]);Object(ud.a)(gd,"ClipboardPlatformInitializationResult",null,[]);var Ee=b(736),mc=b(125),Uc=b(5),Vd=b(84);Object(ud.a)(Gb,"MacroRecorderPasteRangePayload",null,[447]);qd.prototype.getContent=function(){return this.content};Object(ud.a)(qd,"MacroRecorderPasteStringPayload",null,[447]);var Sf=b(63);Object(ud.a)(nd,"MacroRecorderPastePayload",null,[447]);var Cd=b(646),Uf=b(972),Td=b(561),kg=b(175),Gf=b(212),Kd=b(119),af=b(292),Wg=b(354);Ac.prototype.getParameters=
function(){return this.parameters};Object(ud.a)(Ac,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[447]);var Hf=b(387);Object(ud.a)(dc,"PasteHtmlRequestParams",null,[]);bb.prototype.copy=function(W,Ja,Eb,gc,Yc){function vd(Wc,Pf,nf){var Qg={CopyPasteTargetType:1};Qg.SourceRanges=W;Qg.CopyOperationId=Ja.id;Rb.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",fe.ixa,Qg.CopyOperationId);fe.DNa=fe.ixa?he(fe.$.na.yw,Qg,af.b(Wc,
Eb),gc?af.a(Pf,gc):Pf,nf,Ja.ribbonCommandInfo,re,Yc):he(fe.$.na.va,Qg,af.b(Wc,Eb),gc?af.a(Pf,gc):Pf,nf,Ja.ribbonCommandInfo,re,Yc);return fe.DNa}var fe=this;gc=void 0===gc?null:gc;Yc=void 0===Yc?null:Yc;var re=this.$.na.va.hc();this.Mnd&&this.TY();this.zjc=re.ClientRequestId;var Oe=xd.EwaSettings.qc()?new kg.a(505,0,vd,80):new Td.a(505,0,vd,16);Oe=this.$.userOperationManager.ic(Oe,Ja.ribbonCommandInfo);this.Mnd&&this.Bv.add(Oe)};bb.prototype.bHf=function(W,Ja,Eb,gc,Yc,vd){var fe=this;return new Promise(function(re,
Oe){var Wc,Pf=vd.commandParameters.stopwatch.zc,nf=2;20===vd.commandParameters.commandType&&(nf=16);36===vd.commandParameters.commandType&&(nf=32);Bc.a.qqd()&&68===vd.commandParameters.commandType&&(nf=64);Bc.a.Dsd(fe.$)&&1028===vd.commandParameters.commandType&&(nf=1024);var Qg=null;if(null===(Wc=vd.copyContextSnapshot)||void 0===Wc?0:Wc.commandParameters)Qg=vd.copyContextSnapshot.commandParameters.id;bb.EOd(fe.$,W,gc,Ja,Eb,null,function(Ng){bb.Gdc(Ng,vd,re,Oe,Pf,fe.$)},function(Ng){vd.serverRequestTimeInMs=
vd.commandParameters.stopwatch.zc-Pf;Ng=Kd.a.pg(Ng.data);Oe(new Uf.a(5,Ng))},Yc,nf,Qg,vd.commandParameters.id)})};bb.prototype.pasteRange=function(W,Ja,Eb,gc,Yc,vd,fe,re){var Oe=this;return new Promise(function(Wc,Pf){var nf=fe.commandParameters.stopwatch.zc;bb.Znj(Oe.$,W,Ja,Eb,gc|-5&Yc,function(Qg){bb.Gdc(Qg,fe,Wc,Pf,nf,Oe.$)},function(Qg){fe.serverRequestTimeInMs=fe.commandParameters.stopwatch.zc-nf;Qg=Kd.a.pg(Qg.data);Pf(new Uf.a(5,Qg))},vd,re)})};bb.prototype.w2i=function(W,Ja,Eb,gc,Yc,vd,fe){var re=
this;return(new Promise(function(Oe,Wc){if(Ja)if(Ja.length>re.zOa){var Pf=fe.clipboardItems.getItem(qc.cX),nf=-1;void 0!==Pf&&null!==Pf&&(nf=Pf.length);Rb.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Ja.length,re.zOa,nf);Wc(new Uf.a(1))}else Pf=function(Qg,Ng,ti){re.$.Oy();var qh=fe.commandParameters.stopwatch.zc;Qg=af.b(Qg,function(di){bb.Gdc(di,fe,Oe,Wc,qh,re.$,Ja)});
Ng=af.a(Ng,function(di){fe.serverRequestTimeInMs=fe.commandParameters.stopwatch.zc-qh;di=Kd.a.pg(di.data);Wc(new Uf.a(3,di))});var fi=re.$.na.va.hc(),$h=De.v(W,re.$),Fi={};Fi.SourceHtml=Ja;Fi.DestinationRanges=$h?De.s($h):null;Fi.CopyOperationId=Eb;Fi.PasteId=gc;Rb.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",re.ixa,Fi.PasteId);return re.ixa?rc(re.$.na.yw,Fi,Qg,Ng,ti,null,fi,vd):rc(re.$.na.va,Fi,Qg,Ng,ti,null,fi,vd)},Pf=
xd.EwaSettings.qc()?new kg.a(204,0,Pf,65):new Td.a(204,0,Pf,1),re.$.userOperationManager.ic(Pf,Yc);else Oe("")})).then(function(){Kf.a.Eii&&Ja.length>re.eab&&(re.o_i(Ja),re.iO=new dc(W,Ja,Eb,gc,Yc,vd,fe,0,re.hEd.length),window.requestIdleCallback&&window.requestIdleCallback(re.oHf))})};bb.prototype.o_i=function(W){var Ja=this.$.Ob.Hc("Task","pasteHtmlChunkOperation"),Eb=Math.floor(W.length/this.eab)+1;this.hEd=Array(Eb);for(var gc=0;gc<Eb;)this.hEd[gc]=W.substring(gc*this.eab,(gc+1)*this.eab),gc++;
Rb.ULS.sendTraceTag(523257954,0,50,"CopyPasteUtils.populatePasteChunks Time taken for chunking: "+Ja.zc)};bb.prototype.oHf=function(){var W=this.hEd[this.iO.zqb],Ja=this.$.Ob.Hc("Task","pasteHtmlServerCall");this.qYi(this.iO.destinationRange,W,this.iO.vrb,this.iO.aHf,this.iO.Td,this.iO.TOb,this.iO.pasteContext,this.iO.zqb,this.iO.pXd);this.iO.zqb++;Rb.ULS.sendTraceTag(523257953,0,15,"CopyPasteUtils.performChunkedPasteHtml server call time: "+Ja.zc+",\n       pasteid:"+this.iO.aHf+",\n       chunkIndex:"+
this.iO.zqb+",\n       totalChunks:"+this.iO.pXd);this.iO.zqb<this.iO.pXd&&window.requestIdleCallback(this.oHf)};bb.prototype.qYi=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){function Wc(Qg,Ng,ti){var qh=fe.commandParameters.stopwatch.zc;Qg=af.b(Qg);Ng=af.a(Ng,function(){fe.serverRequestTimeInMs=fe.commandParameters.stopwatch.zc-qh});var fi=Pf.$.na.va.hc(),$h=De.v(W,Pf.$);$h={SourceHtml:Ja,DestinationRanges:$h?De.s($h):null,CopyOperationId:Eb,PasteId:gc+"_chunk_"+re,ChunkIndex:re,TotalChunks:Oe};Rb.ULS.sendTraceTag(523257952,
0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",Pf.ixa,$h.PasteId);return rc(Pf.$.na.yw,$h,Qg,Ng,ti,null,fi,vd)}var Pf=this,nf=xd.EwaSettings.qc()?new kg.a(204,0,Wc,65):new Td.a(204,0,Wc,1);this.$.userOperationManager.ic(nf,Yc)};bb.prototype.x2i=function(W,Ja,Eb,gc,Yc){var vd=this;return new Promise(function(fe,re){Rb.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",Yc.id);
Ja&&(Ja=Xb.a.trimEnd(Ja,"\n","\r"));Rb.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",Yc.id);if(Ja){var Oe=vd.Twd;if(Ja.length>Oe)Rb.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Ja.length,Oe),re(new Uf.a(1));else{var Wc=De.v(W,vd.$);Rb.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",
Yc.id);Oe=!vd.$.ea.isNamedObjectViewMode&&!Ja.includes("\n")&&!Ja.includes("\t");Rb.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",Yc.id,Oe);Oe=Oe&&Xb.a.Cff(Ja);Rb.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",Yc.id,Oe);var Pf=vd.$.na.va.hc();if(Oe){var nf=526;Rb.ULS.sendTraceTag(537167749,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",Yc.id);var Qg=Gf.a.Pbd(Ja);Rb.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",Yc.id);var Ng=De.s(Wc);Oe=function(qh,fi,$h){var Fi=Yc.commandParameters.stopwatch.zc;qh=af.b(qh,function(di){Rb.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",
Yc.id);Yc.requestTelemetryData=di.RequestTelemetryData;Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.zc-Fi;di.Errors&&0<di.Errors.length?re(new Uf.a(2,di.Errors)):fe(Ja)});fi=af.a(fi,function(di){Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.zc-Fi;di=Kd.a.pg(di.data);re(new Uf.a(2,di))});vd.$.Oy();Rb.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",Yc.id);return Vd.c(vd.$.na.va,Ng,Ja,Qg,!1,!1,
63,qh,fi,$h,W,Pf,gc)};var ti=function(){return new Cd.a(Ng,Ja,Qg)}}else nf=180,Oe=function(qh,fi,$h){vd.$.Oy();var Fi=Yc.commandParameters.stopwatch.zc;qh=af.b(qh,function(di){Rb.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",Yc.id);bb.Gdc(di,Yc,fe,re,Fi,vd.$,Ja)});fi=af.a(fi,function(di){Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.zc-Fi;di=Kd.a.pg(di.data);re(new Uf.a(4,di))});Rb.ULS.sendTraceTag(537167744,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",Yc.id);return Wd(vd.$.na.va,Wc,Ja,qh,fi,$h,null,Pf,gc)},ti=function(){return new qd(Wc,Ja)};Rb.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",Yc.id);Oe=xd.EwaSettings.qc()?new kg.a(nf,0,Oe,65,ti):new Td.a(nf,0,Oe,1,ti);Rb.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",
Yc.id);vd.$.userOperationManager.ic(Oe,Eb)}}else fe("")})};bb.prototype.u9e=function(W,Ja){Ja=[1===Ja?4:5];this.gridView.Cb.lx(Wg.a.q8(Sf.d(this.$.qa),W),Ja,!0);this.gridView.Cb.Gn(Ja);this.gridView.Cb.update(!0)};bb.prototype.Nxb=function(){var W=[4,5];this.gridView.Cb.Xh(W,!1,!1);this.gridView.Cb.vj(null,W,!1);1===this.gridView.ha.Ue&&this.gridView.Gn(!1,!1);this.gridView.Cb.update(!1,!1)};bb.prototype.pUg=function(W,Ja,Eb){var gc=[];Eb=Cl(Eb);for(var Yc=Eb.next();!Yc.done;Yc=Eb.next())gc.push(this.sUg(W,
Ja,Yc.value));return gc};bb.prototype.TY=function(){if(this.Bv)for(var W=Cl(this.Bv),Ja=W.next();!Ja.done;Ja=W.next())Ja=Ja.value,this.$&&this.$.userOperationManager&&(Ja.operation&&Rb.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",mc.a(Ja.operation.operationName)),this.pVg(),this.$.userOperationManager.JIa(Ja))};bb.prototype.pVg=function(){if(this.DNa){var W=this.DNa.Qt;Rb.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",
W);Kd.a.Fu(W);!xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.zjc&&Vd.j(this.$.na.va,this.zjc,null,null,null);this.zjc=this.DNa=null}};bb.prototype.PF=function(W,Ja){2===Ja.uu?(this.Bv.clear(),this.DNa=null):1===Ja.uu&&this.Bv&&this.Bv.contains(Ja.Hg)&&(Rb.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",mc.a(Ja.Hg.operation.operationName),Ja.Hg.dequeueUtcTime.getTime()-Ja.Hg.enqueueUtcTime.getTime()),
this.Bv.remove(Ja.Hg),this.DNa=null)};bb.prototype.sUg=function(W,Ja,Eb){Rb.ULS.shipAssertTag(537167713,0,!!Ja,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");Rb.ULS.shipAssertTag(537167712,0,0<Ja.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var gc=0,Yc=0,vd=new Set,fe=new Set;Ja=Cl(Ja);for(var re=Ja.next();!re.done;re=Ja.next()){re=re.value;var Oe=String.format("{0}_{1}",re.left,re.right),Wc=String.format("{0}_{1}",re.top,
re.bottom);fe.has(Oe)||(fe.add(Oe),Yc+=re.width);vd.has(Wc)||(vd.add(Wc),gc+=re.height)}if(36===W)return Eb.isSingle?bb.MSe(Yc,gc,Eb):Eb.clone();516===W&&(W=gc,gc=Yc,Yc=W);W=!(Eb.width%Yc)&&!(Eb.height%gc);vd=Eb.uW&&!(Eb.height%gc);Eb.N_&&!(Eb.width%Yc)||vd?Eb=bb.MSe(Yc,gc,Eb):W?Eb=Eb.clone():(Eb=Eb.clone(),Eb.bottom=Math.min(Ae.a.Ih,Eb.top+gc-1),Eb.right=Math.min(Ae.a.Qh,Eb.left+Yc-1));return Eb};bb.prototype.NLg=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe,Wc,Pf){if(!gc||!gc.length)return 1;if(1<gc.length){if(!this.xgc&&
vd)return 3;if(Wc)return 0;if(re)return 9;if(Oe)return 8;if(Pf)return 2;if(1<Ja.length)return 4;var nf=Ja[0];if(!fe&&!wc.a.all(gc,function(Qg){return Qg.isSingle||!(Qg.width%nf.width)&&!(Qg.height%nf.height)}))return 5;if((!this.xgc||!vd)&&Xb.a.equals(W,Eb,!0))for(Yc=Cl(Yc),W=Yc.next();!W.done;W=Yc.next())if(W=W.value,W.Kd(nf)&&!W.equals(nf))return 6}else if(Ja&&0<Ja.length){if(0!==this.rdf(Ja,Oe))return 7;if(1<Ja.length){if(!this.xgc&&vd)return 3;if((!this.xgc||!vd)&&Xb.a.equals(W,Eb,!0))for(W=Cl(Ja),
Ja=W.next();!Ja.done;Ja=W.next())if(Ja=Ja.value,Eb=Yc[0],Ja.Kd(Eb)&&!Ja.equals(Eb))return 6}}return 0};bb.prototype.rdf=function(W,Ja){if(!W||1>=W.length)return 0;if(Ja)return 2;if(!De.S(W))return 1;Ja=new Ee.a(pa.a.Pk());for(var Eb=Cl(W),gc=Eb.next();!gc.done;gc=Eb.next()){gc=gc.value;for(var Yc=Cl(W),vd=Yc.next();!vd.done;vd=Yc.next()){vd=vd.value;var fe=gc.top===vd.top&&gc.bottom===vd.bottom,re=gc.left===vd.left&&gc.right===vd.right,Oe=Math.max(gc.left,vd.left)<Math.min(gc.right,vd.right);if(Math.max(gc.top,
vd.top)<Math.min(gc.bottom,vd.bottom)&&!fe||Oe&&!re)return 3;Ja.add(String.format("{0}-{1}-{2}-{3}",gc.top,gc.bottom,vd.left,vd.right));Ja.add(String.format("{0}-{1}-{2}-{3}",vd.top,vd.bottom,gc.left,gc.right))}}W=Cl(W);for(Eb=W.next();!Eb.done;Eb=W.next())Eb=Eb.value,Ja.remove(String.format("{0}-{1}-{2}-{3}",Eb.top,Eb.bottom,Eb.left,Eb.right));return 0<Ja.count?3:0};bb.prototype.U7i=function(W){var Ja=this.gridView.ha;Ja.updateSelection(W,W.topLeft,0);Ja.selectionType=-1};bb.prototype.Gwb=function(W){if(null===
W||void 0===W?0:W.sourceItem){if(!Pd(W.sourceItem))return null;if((W=W.sourceItem)&&De.cb(W.ranges,!0))return W}return null};bb.prototype.Zgc=function(W,Ja){Rb.ULS.shipAssertTag(537167711,0,!!W,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ja&&Uc.a.nG in Ja||W.tabName?!1:1===W.method};bb.Znj=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){function Wc(){return new Gb(Eb,gc,Yc)}function Pf(Qg,Ng,ti){W.Oy();var qh=W.na.va;Qg=af.b(Qg,vd);Ng=af.a(Ng,fe);var fi=re;fi=void 0===fi?null:
fi;var $h=qh.Na(9,nf);$h.sourceRanges=Eb;$h.destinationRanges=gc;$h.flags=Yc;return Vd.i(qh,"PasteRange",$h,Qg,Ng,ti,null,64,fi)}var nf=W.na.va.hc(Oe?{Lla:!0,Lka:1}:{Lla:!1,Lka:0});Oe=xd.EwaSettings.qc()?new kg.a(506,0,Pf,65,Wc):new Td.a(506,0,Pf,1,Wc);W.userOperationManager.ic(Oe,Ja)};bb.Gdc=function(W,Ja,Eb,gc,Yc,vd,fe){fe=void 0===fe?null:fe;Rb.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Ja.id);Ja.requestTelemetryData=
W.RequestTelemetryData;Ja.serverRequestTimeInMs=Ja.commandParameters.stopwatch.zc-Yc;ue.a.rh(W.Errors)?ue.a.zha(W.Errors)?(Ja&&(Ja.encounteredDeploymentErrors=!0),Rb.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",ue.a.Xc(W.Errors))):gc(new Uf.a(5,W.Errors)):W.Result?(gc=!!W&&!!W.RequestTelemetryData,$d.g(vd).Ki.Ola(Ja.commandParameters.stopwatch.id,W.StateId,gc?W.RequestTelemetryData.EcsOperationDuration:
0,gc?W.RequestTelemetryData.EcsRequestDuration:0,gc?W.RequestTelemetryData.WfeRequestDuration:0),Ja.pastedRange=W.Result.SheetMultiRange,Rb.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Ja.id),Eb(!0)):(Rb.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Ja.id),Eb(fe||!0))};
bb.EOd=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe,Wc,Pf,nf){function Qg(){return new nd(qh)}function Ng(fi,$h,Fi){W.Oy();return Oc(W.na.va,qh,af.b(fi,fe),af.a($h,re),Fi,vd,ti,Oe)}var ti=W.na.va.hc(),qh=bb.i9g(Eb,gc,Yc,Wc,Pf,nf);Eb=xd.EwaSettings.qc()?new kg.a(503,0,Ng,65,Qg):new Td.a(503,0,Ng,1,Qg);W.userOperationManager.ic(Eb,Ja)};bb.i9g=function(W,Ja,Eb,gc,Yc,vd){var fe={};fe.ShadowWorkbookBase64=W.shadowWorkbookBase64;fe.SourceRanges={};fe.SourceRanges.Ranges=Array(1);fe.SourceRanges.Ranges[0]={};fe.SourceRanges.Ranges[0].FirstRow=
W.rangeRowStart;fe.SourceRanges.Ranges[0].LastRow=W.rangeRowEnd;fe.SourceRanges.Ranges[0].FirstColumn=W.rangeColumnStart;fe.SourceRanges.Ranges[0].LastColumn=W.rangeColumnEnd;xd.EwaSettings.getBooleanFeatureGate(Kf.a.u5b,!1)?Eb?fe.DestinationRanges=De.u(Eb.SheetName,Eb.NamedObjectName,De.g(Eb.Ranges)):(Rb.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),fe.DestinationRanges=null):fe.DestinationRanges=Ja?De.s(Ja):null;fe.CopyPasteTargetType=
1;fe.PasteType=gc;fe.CopyOperationId=Yc;fe.PasteId=vd;fe.SourceClientPath=W.sourceClientPath;fe.SourceSheetName=W.sourceSheetName;fe.SourceWorkbookName=W.sourceWorkbookName;if(!W.originalSourceRangesCountExceedsLimit&&W.originalSourceRanges&&0<W.originalSourceRanges.length&&1024===gc){fe.OriginalSourceMultiRange={};Ja=Array(W.originalSourceRanges.length);for(Eb=0;Eb<Ja.length;++Eb)Ja[Eb]={},Ja[Eb].FirstRow=W.originalSourceRanges[Eb][0],Ja[Eb].FirstColumn=W.originalSourceRanges[Eb][1],Ja[Eb].LastRow=
W.originalSourceRanges[Eb][2],Ja[Eb].LastColumn=W.originalSourceRanges[Eb][3];fe.OriginalSourceMultiRange.Ranges=Ja}return fe};bb.MSe=function(W,Ja,Eb){Eb=Eb.clone();Eb.height<Ja&&(Eb.bottom=Math.min(Ae.a.Ih,Eb.top+Ja-1));Eb.width<W&&(Eb.right=Math.min(Ae.a.Qh,Eb.left+W-1));return Eb};bb.prototype.executeInsertCopiedCutCellsOperation=function(W,Ja,Eb,gc,Yc,vd,fe){function re(){return new Ac(Oe)}vd=void 0===vd?null:vd;fe=void 0===fe?null:fe;var Oe={};Oe.InsertDirection=gc;Oe.SourceRange=W;Oe.DestRange=
Ja;Oe.CopyCutOperation=Eb?0:1;var Wc=this.$.na.va;return Hf.a(this.$.userOperationManager,function(Pf,nf,Qg){Pf=vd?af.b(Pf,vd):Pf;nf=fe?af.a(nf,fe):nf;var Ng=Wc.Na(41,null);Ng.insertCopiedCutCellsParameters=Oe;return Vd.i(Wc,"InsertCopiedCutCells",Ng,Pf,nf,Qg,null,4)},function(Pf){return new kg.a(104,0,Pf,void 0,re)},Yc)};bb.prototype.Bih=function(W,Ja,Eb,gc,Yc,vd){var fe=this;return new Promise(function(re,Oe){function Wc(nf){nf=Kd.a.pg(nf.data);Oe(new Uf.a(21,nf))}function Pf(nf){W.requestTelemetryData=
nf.RequestTelemetryData;nf.Errors&&0<nf.Errors.length?Oe(new Uf.a(21,nf.Errors)):re(!0)}xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?fe.executeInsertCopiedCutCellsOperation(Ja,Eb,gc,Yc,vd,Pf,Wc):fe.executeInsertCopiedCutCellsOperation(Ja,Eb,gc,Yc,vd,Pf,Wc).continueWith(function(){if(gc)fe.Nxb();else{var nf=fe.$.da.Aa(254);nf&&nf.R2b("DragDropInsert/success/"+xg.a[vd.method],!0)}})})};Ck.Object.defineProperties(bb.prototype,{Twd:{configurable:!0,
enumerable:!0,get:function(){Rb.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},zOa:{configurable:!0,enumerable:!0,get:function(){return this.ixa?xd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):Ae.a.zOa}}});Object(ud.a)(bb,"CopyPasteUtils",null,[733]);var Pg=b(540),be;
(function(W){W[W.range=0]="range";W[W.art=1]="art"})(be||(be={}));Object(ud.b)("SourceItemType",be);var $g=b(25),wg=b(95);Ca.prototype.serializeSourceItem=function(W){var Ja={};if(W&&Object.getType(W)===Tc)Ja.sheetName=W.sheetName,Ja.topArray=wc.a.map(W.ranges,function(Eb){return Eb.top}),Ja.leftArray=wc.a.map(W.ranges,function(Eb){return Eb.left}),Ja.bottomArray=wc.a.map(W.ranges,function(Eb){return Eb.bottom}),Ja.rightArray=wc.a.map(W.ranges,function(Eb){return Eb.right}),Ja.sessionStateId=W.sessionStateId,
Ja.sessionId=W.sessionId,Ja.sourceItemType=this.wYf(0);else if(W&&Object.getType(W)===Ve)Ja.activeFloatingObjectControlId=W.activeFloatingObjectControlId,Ja.sheetName=W.sheetName,Ja.sessionStateId=W.sessionStateId,Ja.sessionId=W.sessionId,Ja.floatingObjectType=this.Aoj(W.type),Ja.sourceItemType=this.wYf(1);else return Rb.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Ja)};Ca.prototype.serializeCommandParameters=
function(W){if(!W)return Rb.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Ja={};Ja.id=W.id;Ja.commandType=W.commandType;Ja.copyPasteTargetType=W.copyPasteTargetType;W.ribbonCommandInfo&&(Ja.ribbonCommandName=this.Ioj(W.ribbonCommandInfo.command),Ja.inputMethodName=this.Coj(W.ribbonCommandInfo.method),Ja.frameModeName=this.Boj(W.ribbonCommandInfo.mode),Ja.uiLocationName=this.Loj(W.ribbonCommandInfo.Xe),Ja.tabName=W.ribbonCommandInfo.tabName);
return JSON.stringify(Ja)};Ca.prototype.deserializeSourceItem=function(W){if(!W)return null;try{var Ja=JSON.parse(W);if(!Ja)return Rb.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var Eb=null;switch(this.ueh(Ja.sourceItemType)){case 0:Eb=new Tc(this.$,this.reh(Ja),Ja.sheetName,Ja.sessionStateId,Ja.sessionId);break;case 1:Eb=new Ve(Ja.activeFloatingObjectControlId,Ja.sheetName,Ja.sessionStateId,Ja.sessionId,this.oeh(Ja.floatingObjectType))}return Eb}catch(gc){return Rb.ULS.sendTraceTag(537167702,
0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",W?W.length:0,gc),null}};Ca.prototype.deserializeCommandParameters=function(W){if(!W)return null;try{var Ja=JSON.parse(W);if(!Ja)return Rb.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var Eb=Ph.a();Eb.id=Ja.id;Eb.ribbonCommandInfo=this.teh(Ja);Eb.commandType=Ja.commandType;Eb.copyPasteTargetType=
Ja.copyPasteTargetType;return Eb}catch(gc){return Rb.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",W?W.length:0,gc),null}};Ca.prototype.reh=function(W){var Ja=[];Rb.ULS.shipAssertTag(537167699,0,!!W.topArray&&0<W.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",W.topArray?"empty":"null");Rb.ULS.shipAssertTag(537167698,0,!!W.leftArray&&
0<W.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",W.leftArray?"empty":"null");Rb.ULS.shipAssertTag(537167697,0,!!W.bottomArray&&0<W.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",W.bottomArray?"empty":"null");Rb.ULS.shipAssertTag(537167696,0,!!W.rightArray&&0<W.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",W.rightArray?"empty":"null");if(!(W.topArray&&
W.leftArray&&W.bottomArray&&W.rightArray))return Ja;Rb.ULS.shipAssertTag(537167695,0,W.topArray.length===W.bottomArray.length&&W.topArray.length===W.leftArray.length&&W.topArray.length===W.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",W.topArray.length,W.bottomArray.length,W.leftArray.length,W.rightArray.length);for(var Eb=Math.min(W.topArray.length,W.bottomArray.length,W.leftArray.length,
W.rightArray.length),gc=0;gc<Eb;gc++)Ja.push(new $g.Range(W.topArray[gc],W.leftArray[gc],W.bottomArray[gc],W.rightArray[gc],!1,!1));return Ja};Ca.prototype.teh=function(W){return new wg.a(this.seh(W.ribbonCommandName),this.qeh(W.inputMethodName),this.peh(W.frameModeName),this.veh(W.uiLocationName),W.tabName)};Ca.prototype.Ioj=function(W){return void 0!==W&&null!==W&&W.toString()in this.HMd?this.HMd[W.toString()]:(Rb.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,W),this.HMd["-911352779"])};Ca.prototype.seh=function(W){return W&&W in this.K7f?this.K7f[W]:(Rb.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,W),-911352779)};Ca.prototype.Coj=function(W){return void 0!==W&&null!==W&&xg.a[W]in this.Ika?this.Ika[xg.a[W]]:(Rb.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
W),this.Ika.unknown)};Ca.prototype.qeh=function(W){return W&&W in this.J7f?this.J7f[W]:(Rb.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",W),0)};Ca.prototype.Boj=function(W){return void 0!==W&&null!==W&&Pg.a[W]in this.D3a?this.D3a[Pg.a[W]]:(Rb.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",W),this.D3a.edit)};Ca.prototype.peh=function(W){return W&&W in this.I7f?this.I7f[W]:
(Rb.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",W),2)};Ca.prototype.wYf=function(W){return void 0!==W&&null!==W&&be[W]in this.yMb?this.yMb[be[W]]:(Rb.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",W),this.yMb.range)};Ca.prototype.ueh=function(W){return W&&W in this.L7f?this.L7f[W]:(Rb.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
W),0)};Ca.prototype.Aoj=function(W){return void 0!==W&&null!==W&&W.toString()in this.PXc?this.PXc[W.toString()]:(Rb.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",W),this.PXc["99"])};Ca.prototype.oeh=function(W){return W&&W in this.H7f?this.H7f[W]:(Rb.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",W),99)};Ca.prototype.Loj=function(W){return void 0!==W&&
null!==W&&jd.a[W]in this.Ir?this.Ir[jd.a[W]]:(Rb.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",W),this.Ir.ribbon)};Ca.prototype.veh=function(W){return W&&W in this.M7f?this.M7f[W]:(Rb.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",W),2)};Object(ud.a)(Ca,"EnvironmentSerializationHelper",null,[]);Jc.PVf="SameSession";Jc.qGe="CrossSession";Jc.mlf="LegacyCrossSession";Jc.external=
"External";Object(ud.a)(Jc,"PayloadOrigin",null,[]);Gc.prototype.shouldWaitForCopyToComplete=function(){return!1};Gc.prototype.onDeferredPasteStarted=function(){};Gc.prototype.onDeferredPasteCompleted=function(){};Gc.prototype.beforePaste=function(){};Gc.prototype.sOj=function(W){var Ja=null;try{var Eb=W.getItem(qc.PO);if(!Eb)return{returnValue:!1,i1:Ja};Ja=JSON.parse(Eb);return{returnValue:this.Bpi(Ja),i1:Ja}}catch(gc){return Rb.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
gc),{returnValue:!1,i1:Ja}}};Gc.prototype.Bpi=function(W){return!!W&&(!!W.shadowWorkbookBase64||W.shadowWorkbookSizeExceedsLimit)&&void 0!==W.rangeRowStart&&void 0!==W.rangeRowEnd&&void 0!==W.rangeColumnStart&&void 0!==W.rangeColumnEnd};Gc.prototype.Ypc=function(W){W.wasLastCopyExternal=!0;if(xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!ug.a.bD&&516!==W.commandParameters.commandType&&1028!==W.commandParameters.commandType){var Ja=this.sOj(W.clipboardItems);
var Eb=Ja.i1;if(Ja.returnValue)return W.isShadowWorkbookParsedSuccessfully=!0,this.pYi(W,Eb)}return 516!==W.commandParameters.commandType&&36!==W.commandParameters.commandType?xd.EwaSettings.ma(162)&&20!==W.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.Bgc)&&(Eb=W.clipboardItems.getItem(qc.html),void 0!==Eb&&null!==Eb&&Eb&&Eb.trim()!==this.TXc&&(Eb.startsWith("<")||ug.a.Hf&&Eb.startsWith("\n<")))?(Ja=W.clipboardItems.getItem(qc.vrb),this.nYi(W,Eb,void 0===
Ja?null:Ja)):this.XGf(W):Promise.reject(new Uf.a(6))};Gc.prototype.pYi=function(W,Ja){Rb.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");W.pasteResult="SystemClipboardShadowWorkbookPaste";W.payloadType=dd.PO;W.payloadOrigin=Jc.external;W.shadowWorkbookPayloadSize=Ed(Ja);W.shadowWorkbookSizeExceedsLimit=Fc(Ja);var Eb=null,gc=null,Yc=W.commandParameters.originalDestinations;xd.EwaSettings.getBooleanFeatureGate(Kf.a.u5b,
!1)?Eb=De.r(Yc,this.$):gc=De.v(De.K(Yc),this.$);Ja.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(W.originalSourceRangesCountExceedsLimit=Ja.originalSourceRangesCountExceedsLimit);if(W.shadowWorkbookSizeExceedsLimit)return Rb.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",W.shadowWorkbookPayloadSize,Ae.a.slc,Ja.shadowWorkbookSizeExceedsLimit),
Promise.reject(new Uf.a(1));Rb.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",W.commandParameters.id);return this.Xr.bHf(W.commandParameters.ribbonCommandInfo,gc,Eb,Ja,[W.commandParameters.stopwatch],W)};Gc.prototype.XGf=function(W){var Ja=W.clipboardItems.getItem(qc.cX);if(void 0!==Ja&&null!==Ja&&Ja.trim()===this.TXc)return Promise.reject(new Uf.a(7));void 0!==Ja&&null!==Ja&&(W.plainTextPayloadSize=Ja.length);
W.isPlainTextPaste=!0;W.pasteResult="SystemClipboardPaste";W.payloadOrigin=Sc(W)?Jc.mlf:Jc.external;W.payloadType=dd.cX;Rb.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",W.id,W.commandParameters.id);Ja=this.Xr.x2i(De.K(W.commandParameters.originalDestinations),Ja,W.commandParameters.ribbonCommandInfo,[W.commandParameters.stopwatch],W);Rb.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
W.id);return Ja};Gc.prototype.nYi=function(W,Ja,Eb){W.htmlPayloadSize=Ja.length;W.isHtmlPaste=!0;W.pasteResult="SystemClipboardHtmlPaste";W.payloadType=dd.html;W.payloadOrigin=Sc(W)?Jc.mlf:Jc.external;Rb.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",W.commandParameters.id);return this.Xr.w2i(De.K(W.commandParameters.originalDestinations),Ja,Eb,W.commandParameters.id,W.commandParameters.ribbonCommandInfo,[W.commandParameters.stopwatch],
W)};Gc.prototype.OFe=function(W){var Ja={};W&&(Ja.shadowWorkbookBase64=W.ShadowWorkbookBase64,Ja.shadowWorkbookSizeExceedsLimit=W.ShadowWorkbookSizeExceedsLimit,Ja.originalSourceRangesCountExceedsLimit=W.OriginalSourceRangesCountExceedsLimit,Ja.originalSourceRangesCount=W.OriginalSourceRangesCount,Ja.shadowWorkbookBlockedSize=W.ShadowWorkbookBlockedSize);return Ja};Gc.prototype.Wfg=function(W,Ja){var Eb=fd(W),gc=32===(W.commandParameters.commandType&32),Yc=1024===(W.commandParameters.commandType&
1024),vd=!1,fe=null,re=null,Oe=!1;if(!Eb){vd=-1985798686===W.commandParameters.ribbonCommandInfo.command;var Wc=W.copyContextSnapshot;if(Ja)Oe=!Wc.sourceItem.isFromCurrentSession(this.$);else if(Wc=this.Xr.Gwb(Wc))fe=Wc.ranges,re=Wc.sheetName,Oe=!W.isSameSession}return this.Xr.NLg(re,fe,this.$.qa.sheetName,W.commandParameters.originalDestinations,W.commandParameters.expandDestinations,Oe,gc,Yc,vd,Ja,Eb)};Ck.Object.defineProperties(Gc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
TXc:{configurable:!0,enumerable:!0,get:function(){return this.Zm.Wa(5)}}});Object(ud.a)(Gc,"BaseCopyPasteHandler",null,[1003,1004,1005]);zb.prototype.getValue=function(W){return this.key&&this.key.isEqual(W)?this.createClipboardItems(this.clipboardItems):null};zb.prototype.setValue=function(W,Ja){this.key=W;this.clipboardItems=this.createClipboardItems(Ja)};zb.prototype.createClipboardItems=function(W){var Ja=this.X$.create(),Eb=W.getItem(qc.cX);Eb&&Ja.setItem(qc.cX,Eb);(Eb=W.getItem(qc.PO))&&Ja.setItem(qc.PO,
Eb);(W=W.getItem(qc.html))&&Ja.setItem(qc.html,W);return Ja};Object(ud.a)(zb,"CopyCache",null,[]);var We=b(70);Am(hb,Gc);hb.prototype.getSourceItem=function(){var W=wc.a.clone(this.gridView.ha.ta.selectedRanges);return new Tc(this.$,W,this.$.ea.qa.sheetName,this.$.ea.af,this.$.ya.UserSessionId)};hb.prototype.beforeSerialize=function(W){var Ja=this;W.isSelectionAllowed=!1;W.isAsyncCopy=!1;W.isFromCache=!1;W.encounteredDeploymentErrors=!1;W.plainTextPayloadSize=0;W.shadowWorkbookPayloadSize=0;W.htmlPayloadSize=
0;W.clientSideCopyTime=0;var Eb=new wd.a(this.$.xa),gc=W.sourceItem;W.isSelectionAllowed=wc.a.all(gc.ranges,function(Yc){return Ja.isSelectionAllowed(Eb,Yc)});W.isSelectionAllowed&&this.Xr.u9e(gc.ranges,W.commandParameters.commandType)};hb.prototype.dNa=function(W){return this.gridView.Ea.y_()&&$d.i(this.gridView,W)};hb.prototype.LYi=function(W,Ja,Eb,gc){var Yc=!1,vd=1===Ja.commandParameters.commandType,fe=gc[0].mQ;1===Eb.ranges.length&&1===gc.length?xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&
vd&&1!==fe&&fe!==Eb.ranges[0].mQ?W.cseStatus=17:Yc=this.n4g.z7c(W,De.K(Eb.ranges),Eb.sheetName,De.K(W.commandParameters.expandDestinations),this.$.ea.qa.sheetName,vd):W.cseStatus=5;Yc&&$d.g(this.$).Ki.o1(W.commandParameters.stopwatch.id,We.BasicTelemetryCalculator.wR);return this.vYi(W,Eb,De.u(this.$.qa.sheetName,null,gc),Ja.commandParameters.commandType,Yc)};hb.prototype.isSelectionAllowed=function(W,Ja){return W.EAb(Ja,this.gridView)};hb.prototype.vYi=function(W,Ja,Eb,gc,Yc){Ja=De.u(Ja.sheetName,
null,Ja.ranges);W.pasteResult="SameSessionPaste";W.payloadOrigin=Jc.PVf;W.payloadType=dd.tAg;Rb.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",W.commandParameters.id);return this.Xr.pasteRange(W.commandParameters.ribbonCommandInfo,Ja,Eb,gc,W.commandParameters.commandType,[W.commandParameters.stopwatch],W,Yc)};Object(ud.a)(hb,"BaseRangeCopyPasteHandler",Gc,[]);var eg=b(35);Ib.prototype.onDeferredPasteStarted=function(W){this.nV.xb(W.id)||
this.nV.add(W.id,!0);if(0<this.nV.count){var Ja=Mb.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Nd.TaskExtensions.Ba(Ja,function(){Ja.result.eg(28,null)},this.$.la,3)}};Ib.prototype.onDeferredPasteCompleted=function(W){var Ja=0<this.nV.count;this.nV.xb(W.id)&&this.nV.remove(W.id);if(Ja&&!this.nV.count){var Eb=Mb.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Nd.TaskExtensions.Ba(Eb,function(){Eb.result.removeEntry(28)},this.$.la,3)}};Object(ud.a)(Ib,"DeferredPasteTracker",null,[]);var lf;(function(W){W[W.none=
0]="none";W[W.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";W[W.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";W[W.asyncCopyCanceled=3]="asyncCopyCanceled";W[W.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(lf||(lf={}));Object(ud.b)("CopyErrorType",lf);var Je=b(1127),Di=b(1276),kj=Je.a;Am(nb,kj);Object(ud.a)(nb,"CopyInnerError",Je.a,[]);Am(Cb,hb);Cb.prototype.serialize=function(W){var Ja=W.sourceItem,Eb={},gc=this.z3c.getValue(Ja);
if(gc)Eb.synchronousResult=gc,W.isFromCache=!0,W.clientSideCopyTime=W.commandParameters.stopwatch.zc;else{var Yc=null,vd=De.F(Ja.ranges);if(!Bc.a.bff()&&this.dNa(vd)){Rb.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");vd=this.clipboardRangeFactory.create(vd);try{Yc=vd.toString(),gc=this.X$.create(),gc.setItem(qc.cX,Yc),this.z3c.setValue(Ja,gc),Eb.synchronousResult=gc,W.clientSideCopyTime=W.commandParameters.stopwatch.zc}finally{vd&&
vd.dispose()}}else W.isAsyncCopy=!0,Eb.synchronousResult=this.X$.create(),Eb.synchronousResult.setItem(qc.cX,this.TXc);Eb.asynchronousResult=this.Aed(W,Ja,Yc)}W.syncClipboardItemsKeys=Qc(Eb.synchronousResult);return Eb};Cb.prototype.shouldWaitForCopyToComplete=function(W){if(!W||!W.copyContextSnapshot)return Rb.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;Rb.ULS.shipAssertTag(537167906,
0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(W.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return Rb.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;Rb.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Cb.prototype.onDeferredPasteStarted=
function(W){this.nV.onDeferredPasteStarted(W)};Cb.prototype.onDeferredPasteCompleted=function(W){this.nV.onDeferredPasteCompleted(W)};Cb.prototype.deserialize=function(W){W.isClipboardDataContainShadowWorkbook=!(void 0===W.clipboardItems.getItem(qc.PO)||null===W.clipboardItems.getItem(qc.PO));if($d.g(this.$).ha.Ue&326)return fd(W)&&(W.wasLastCopyExternal=!0),Promise.reject(new Uf.a(17));var Ja=this.Wfg(W,!1);if(0!==Ja)return Promise.reject(new Uf.a(fd(W)?18:W.isSameSession?19:20,void 0,void 0,void 0,
Ja));var Eb=W.copyContextSnapshot,gc=this.Xr.Gwb(Eb);if(fd(W))return this.Ypc(W);Ja=W.commandParameters.originalDestinations;if(gc&&W.isSameSession)return this.LYi(W,Eb,gc,Ja);if(516!==W.commandParameters.commandType){gc=this.rOj(W.clipboardItems);Eb=gc.i1;if(gc.returnValue){W.isShadowWorkbookParsedSuccessfully=!0;var Yc=gc=null;xd.EwaSettings.getBooleanFeatureGate(Kf.a.u5b,!1)?gc=De.r(Ja,this.$):Yc=De.v(De.K(Ja),this.$);return this.lYi(W,Yc,gc,Eb)}if(W.isClipboardInaccessible)return Promise.reject(new Uf.a(8));
if(36!==W.commandParameters.commandType)return this.XGf(W)}return Promise.reject(new Uf.a(6))};Cb.prototype.beforePaste=function(W){this.$.da.Aa(373).vlj(W);W.indicationDisplayScheduled=!0};Cb.prototype.NNj=function(W){if(!(W&&W.SourceRanges&&W.SourceRanges.Ranges&&W.SourceRanges.Ranges.length&&(W.OriginalSourceRangesCountExceedsLimit||W.OriginalSourceMultiRange&&W.OriginalSourceMultiRange.Ranges&&W.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,i1:null};var Ja=W.SourceRanges.Ranges[0];
if(!W.ShadowWorkbookBase64&&!W.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,i1:null};var Eb=this.OFe(W);Eb.rangeRowStart=Ja.FirstRow;Eb.rangeRowEnd=Ja.LastRow;Eb.rangeColumnStart=Ja.FirstColumn;Eb.rangeColumnEnd=Ja.LastColumn;Eb.sourceClientPath=W.SourceClientPath;Eb.sourceSheetName=W.SourceSheetName;Eb.sourceWorkbookName=W.SourceWorkbookName;if(!W.OriginalSourceRangesCountExceedsLimit)for(W=W.OriginalSourceMultiRange.Ranges,Eb.originalSourceRanges=Array(W.length),Ja=0;Ja<W.length;++Ja)Eb.originalSourceRanges[Ja]=
[W[Ja].FirstRow,W[Ja].FirstColumn,W[Ja].LastRow,W[Ja].LastColumn];return{returnValue:!0,i1:Eb}};Cb.prototype.rOj=function(W){var Ja=null;W=W.getItem(qc.PO);if(!W)return{returnValue:!1,i1:Ja};Ja=JSON.parse(W);return{returnValue:this.Api(Ja),i1:Ja}};Cb.prototype.Api=function(W){return!!W&&(!!W.shadowWorkbookBase64||W.shadowWorkbookSizeExceedsLimit)&&void 0!==W.rangeRowStart&&void 0!==W.rangeRowEnd&&void 0!==W.rangeColumnStart&&void 0!==W.rangeColumnEnd};Cb.prototype.lYi=function(W,Ja,Eb,gc){Rb.ULS.shipAssertTag(537167903,
0,!!gc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");Vc.AFrameworkApplication.AN("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");W.pasteResult="CrossSessionPaste";W.payloadOrigin=Jc.qGe;W.payloadType=dd.PO;W.shadowWorkbookPayloadSize=Ed(gc);W.shadowWorkbookSizeExceedsLimit=Fc(gc);gc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(W.originalSourceRangesCountExceedsLimit=gc.originalSourceRangesCountExceedsLimit);
if(W.shadowWorkbookSizeExceedsLimit)return Rb.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",W.shadowWorkbookPayloadSize,Ae.a.slc,gc.shadowWorkbookSizeExceedsLimit),Promise.reject(new Uf.a(1));if(1028===W.commandParameters.commandType&&W.originalSourceRangesCountExceedsLimit)return Rb.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",
gc.originalSourceRangesCount,Ae.a.Uzi,gc.originalSourceRangesCountExceedsLimit),Promise.reject(new Uf.a(1));Rb.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",W.commandParameters.id);return this.Xr.bHf(W.commandParameters.ribbonCommandInfo,Ja,Eb,gc,[W.commandParameters.stopwatch],W)};Cb.prototype.Aed=function(W,Ja,Eb){var gc=this;Rb.ULS.shipAssertTag(537167901,0,!!W,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");
var Yc=W.commandParameters.stopwatch.zc;return new Promise(function(vd,fe){Rb.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",W.id);var re=De.u(Ja.sheetName,null,Ja.ranges);gc.Xr.copy(re,W.commandParameters,function(Oe){W.requestTelemetryData=Oe.RequestTelemetryData;W.serverRequestTimeInMs=W.commandParameters.stopwatch.zc-Yc;if(ue.a.rh(Oe.Errors))ue.a.zha(Oe.Errors)?(W.encounteredDeploymentErrors=
!0,Rb.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",ue.a.Xc(Oe.Errors),W.id)):(Rb.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",ue.a.Xc(Oe.Errors),W.id),fe(new nb(2,Oe.Errors)));else if(Rb.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",
W.id),W.markForCancellation)fe(new nb(3,Oe.Errors));else{Oe=Oe.Result;var Wc=Oe.PlainTextResult;void 0!==Eb&&null!==Eb&&(Wc=Eb);void 0!==Wc&&null!==Wc&&(W.plainTextPayloadSize=Wc.length);var Pf=gc.X$.create(),nf=gc.NNj(Oe);var Qg=nf.i1;nf.returnValue&&(W.shadowWorkbookPayloadSize=Ed(Qg),W.shadowWorkbookSizeExceedsLimit=Fc(Qg),W.originalSourceRangesCountExceedsLimit=Oe.OriginalSourceRangesCountExceedsLimit,Qg=JSON.stringify(Qg),Pf.setItem(qc.PO,Qg));Pf.setItem(qc.cX,Wc);Bc.a.bff()&&(Wc=Oe.HtmlResult,
W.htmlSizeExceedsLimit=Oe.HtmlSizeExceedsLimit,void 0!==Wc&&null!==Wc&&(W.htmlPayloadSize=Wc.length),Pf.setItem(qc.html,Wc));W.copyTotalSizeExceedsLimit=Oe.CopyTotalSizeExceedsLimit;Pf.setItem(qc.vrb,W.commandParameters.id);gc.z3c.setValue(Ja,Pf);W.asyncClipboardItemsKeys=Qc(Pf);vd(Pf)}},function(Oe){W.serverRequestTimeInMs=W.commandParameters.stopwatch.zc-Yc;Oe=Kd.a.pg(Oe.data);Rb.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
ue.a.Xc(Oe),W.id);fe(new nb(2,Oe))},[W.commandParameters.stopwatch])})};Object(ud.a)(Cb,"AcrossSessionRangeCopyPasteHandler",hb,[]);Object(ud.a)(tb,"CopyArtRequest",null,[]);Object(ud.a)(Va,"PasteArtRequest",null,[]);ub.prototype.l5h=function(W){if(this.Cli(W.mOa)){Rb.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",W.mOa);var Ja=this.TIb.oa(W.mOa);this.TIb.ia(W.mOa,W);var Eb=Ja.promise;Ja.rff=!1;return this.Dlh(W,
Eb)}this.TIb.ia(W.mOa,W);return this.tsi(W)};ub.prototype.Cli=function(W){return this.TIb.xb(W)};ub.prototype.tsi=function(W){var Ja=this;return new Promise(function(Eb,gc){W.promise=Ja.VZa.WGf(W).then(function(Yc){Eb(null);return Ja.soc(W,Yc)},function(Yc){gc(null);return Ja.eFb(Yc)})})};ub.prototype.Dlh=function(W,Ja){var Eb=this;return new Promise(function(gc,Yc){W.promise=Ja.then(function(vd){Eb.pTj(W,vd);return Eb.VZa.WGf(W).then(function(fe){gc(null);return Eb.soc(W,fe)},function(fe){Yc(null);
return Eb.eFb(fe)})},function(vd){return Eb.eFb(vd)})})};ub.prototype.soc=function(W,Ja){W.rff&&(this.QYg(W.mOa),this.eOd(W,Ja));return this.X2i(Ja)};ub.prototype.QYg=function(W){this.TIb.remove(W)};ub.prototype.eOd=function(W,Ja){var Eb=this.xYh();W.mOa===Eb&&this.VZa.eOd(W.destination,Ja,W.item.type)};ub.prototype.xYh=function(){var W=$d.g(this.$).ha.Oa.activeFloatingObjectControlId;W||(W=De.v($d.g(this.$).ha.ta.activeCell,this.$),W=W.FirstRow+"_"+W.FirstColumn);return W};ub.prototype.pTj=function(W,
Ja){W.destination=null;W.rIe=Ja};Object(ud.a)(ub,"PasteArtRequestManager",null,[]);var ig=b(202),Zf=b(120),Ei=b(104);Am(La,Gc);La.prototype.getSourceItem=function(){Rb.ULS.shipAssertTag(537167896,0,!!this.ha.Oa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");Rb.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Oa.activeFloatingObjectControlId);return new Ve(this.ha.Oa.activeFloatingObjectControlId,
this.$.ea.qa.sheetName,this.$.ea.af,this.$.ya.UserSessionId,this.ha.Oa.oc.floatingObject.type)};La.prototype.beforeSerialize=function(W){W&&W.commandParameters?(W?(W.isAsyncCopy=!1,W.isSelectionAllowed=!1,W.isFromCache=!1,W.plainTextPayloadSize=0,W.shadowWorkbookPayloadSize=0,W.htmlPayloadSize=0,W.htmlSizeExceedsLimit=!1,W.clientSideCopyTime=0,W.encounteredDeploymentErrors=!1,W.shadowWorkbookSizeExceedsLimit=!1,W.originalSourceRangesCountExceedsLimit=!1,W.copyTotalSizeExceedsLimit=!1):Rb.ULS.sendTraceTag(537167826,
0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),W.commandParameters.copyPasteTargetType=2):Rb.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};La.prototype.serialize=function(W){var Ja=W.sourceItem,Eb={};if(!Ja)return Rb.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Eb;if(!this.noi())return Rb.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
Eb;Rb.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Ja.activeFloatingObjectControlId);this.rFd();var gc=this.y3c.getValue(Ja);if(gc)Eb.synchronousResult=gc,W.isFromCache=!0,W.isAsyncCopy=!1,W.clientSideCopyTime=W.commandParameters.stopwatch.zc,1===W.commandParameters.commandType&&this.$.Zd(2045211913,W.commandParameters.ribbonCommandInfo.method,W.commandParameters.ribbonCommandInfo.Xe,null);else{W.isFromCache=!1;W.isAsyncCopy=
!0;gc=this.X$.create();if(W.commandParameters.uploadToClipService){var Yc={};Yc["data-clipservice-ccpid"]=W.commandParameters.id;Yc["data-pkey"]=W.commandParameters.pKey;Yc["data-clipservice-type"]=W.commandParameters.clipServiceDataType;Yc["data-clipservice-count"]=W.commandParameters.objectCount.toString();Yc["data-clipservice-dc"]=W.commandParameters.clipServiceDataCenter;Yc["data-clipservice-client"]=this.KZg;Yc["data-TimeStamp"]=(new Date).toUTCString();Yc["data-clipservice-version"]=this.LZg;
gc.setItem(qc.CIg,JSON.stringify(Yc))}Eb.synchronousResult=this.YBg(gc);Eb.asynchronousResult=this.Aed(W,Ja,gc)}W.syncClipboardItemsKeys=Qc(Eb.synchronousResult);return Eb};La.prototype.YBg=function(W){Rb.ULS.shipAssertTag(537167891,0,!!this.ha.Oa.oc,"Expecting a floating object to be currently selected for copy");W||(W=this.X$.create());var Ja=this.ha.Oa.oc.fvb();Ja&&(Ja=String.format("<img src='{0}'>",Ja),W.setItem(qc.html,Ja));return W};La.prototype.rFd=function(){var W=this.ha.Oa.oc;this.Qob.rFd(Zf.a.Nqb(W.floatingObject),
Zf.a.NZg(W.Xt))};La.prototype.shouldWaitForCopyToComplete=function(){Rb.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};La.prototype.onDeferredPasteStarted=function(W){this.nV.onDeferredPasteStarted(W)};La.prototype.onDeferredPasteCompleted=function(W){this.nV.onDeferredPasteCompleted(W)};La.prototype.deserialize=function(W){var Ja=fd(W),Eb=null,gc=null,Yc=!1;if(!Ja){Eb=W.copyContextSnapshot;gc=Eb.sourceItem;if(!gc)return Promise.reject(new Uf.a(10));
Yc=gc.isFromCurrentSession(this.$)}var vd=this.Wfg(W,!0);if(0!==vd)return Promise.reject(new Uf.a(Ja?18:Yc?19:20,void 0,void 0,void 0,vd));if(Ja)return this.Ypc(W);if(!Yc&&!La.whi(gc))return W=String.format("User attempted to paste art of type [{0}] between sessions.",gc.type),Rb.ULS.sendTraceTag(537167889,0,50,W),Promise.reject(new Uf.a(11,void 0,void 0,W));if(Eb.isAsyncSerializeFailed)return Promise.reject(new Uf.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var fe=W.clipboardItems.getItem(qc.PO);var re=JSON.parse(fe)}catch(Oe){return Rb.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(Oe)),Promise.reject(new Uf.a(12,void 0,Oe))}re.floatingObjectId!==gc.activeFloatingObjectControlId?Rb.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
gc.activeFloatingObjectControlId,re.floatingObjectId):Rb.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",gc.activeFloatingObjectControlId,re.floatingObjectId);if(!re||!re.shadowWorkbookBase64)return Promise.reject(new Uf.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!re)));W.isShadowWorkbookParsedSuccessfully=!0;W.shadowWorkbookPayloadSize=
Ed(re);W.shadowWorkbookSizeExceedsLimit=Fc(re);W.payloadOrigin=Yc?Jc.PVf:Jc.qGe;W.payloadType=dd.sjg;if(Fc(re))return W=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",W.shadowWorkbookPayloadSize,Ae.a.slc,re.shadowWorkbookSizeExceedsLimit),Rb.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",W),Promise.reject(new Uf.a(1,void 0,void 0,W));Eb=Ja=null;$d.g(this.$).ha.Ue&326?Eb=$d.g(this.$).ha.Oa.activeFloatingObjectControlId:
Ja=this.$.qa&&this.$.qa.activeCell?De.v(this.$.qa.activeCell,this.$):De.v(De.K(W.commandParameters.originalDestinations),this.$);Yc=null;if(this.Qob.X2f(gc))try{Yc=this.Qob.z7c()}catch(Oe){Rb.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(Oe))}return this.mYi.l5h(new Va(W.commandParameters.ribbonCommandInfo,Ja,Eb,W.commandParameters.commandType,[W.commandParameters.stopwatch],
re,gc,W,Yc))};La.prototype.Ypc=function(W){W.wasLastCopyExternal=!0;if(W.clipboardItems.getItem("image/png")){var Ja=W.commandParameters.stopwatch.zc;W.payloadType=dd.POg;var Eb={};return gf.b(this.$.Zd(1403967063,W.commandParameters.ribbonCommandInfo.method,W.commandParameters.ribbonCommandInfo.Xe,(Eb.dataUrl=W.clipboardItems.getItem("image/png"),Eb))).then(function(gc){W.serverRequestTimeInMs=W.commandParameters.stopwatch.zc-Ja;return gc?Promise.resolve(null):Promise.reject(new Uf.a(15))},function(){W.serverRequestTimeInMs=
W.commandParameters.stopwatch.zc-Ja;return Promise.reject(new Uf.a(15))})}Rb.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Gc.prototype.Ypc.call(this,W)};La.prototype.noi=function(){var W=$d.g(this.$).ha;return W.Oa.activeFloatingObjectControlId&&W.Oa.oc&&W.Oa.oc.floatingObject?W.Oa.oc.floatingObject.tVd():!1};La.prototype.Aed=function(W,Ja,Eb){var gc=this;return new Promise(function(Yc,vd){var fe=W.commandParameters.stopwatch.zc;
Rb.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");gc.VZa.f4g(new tb(Ja.activeFloatingObjectControlId,W.commandParameters,function(re){W.requestTelemetryData=re.RequestTelemetryData;W.serverRequestTimeInMs=W.commandParameters.stopwatch.zc-fe;if(ue.a.rh(re.Errors))ue.a.zha(re.Errors)?(W.encounteredDeploymentErrors=!0,Rb.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
ue.a.Xc(re.Errors))):(Rb.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",ue.a.Xc(re.Errors)),vd(new nb(4,re.Errors)));else if(Rb.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Ja.activeFloatingObjectControlId),W.markForCancellation)vd(new nb(3,re.Errors));else{ue.a.lr(re.Errors)&&Rb.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
ue.a.Xc(re.Errors));var Oe=re.Result;if(Oe){Oe=gc.OFe(Oe);Oe.floatingObjectId=Ja.activeFloatingObjectControlId;W.shadowWorkbookPayloadSize=Ed(Oe);W.shadowWorkbookSizeExceedsLimit=Fc(Oe);try{var Wc=JSON.stringify(Oe)}catch(Pf){vd(new Uf.a(14,void 0,Pf,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",W.shadowWorkbookPayloadSize,Oe.floatingObjectId)));return}Rb.ULS.shipAssertTag(537167881,0,!!Eb,"Expecting syncClipboardItems to be defined");
Eb.setItem(qc.PO,Wc);1===W.commandParameters.commandType&&(gc.B0i(Ja.type,Ja.activeFloatingObjectControlId,re.StateId),gc.deleteFloatingObject(Ja.activeFloatingObjectControlId,Ja.type));gc.y3c.setValue(Ja,Eb);W.asyncClipboardItemsKeys=Qc(Eb);Yc(Eb)}else Rb.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Ja.activeFloatingObjectControlId),Yc(gc.y3c.getValue(Ja))}},W.commandParameters.commandType,Ja.type,function(re){W.serverRequestTimeInMs=
W.commandParameters.stopwatch.zc-fe;re=Kd.a.pg(re.data);1===W.commandParameters.commandType&&gc.VZa.pPj(Ja.type,Ja.activeFloatingObjectControlId);Rb.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",ue.a.Xc(re));vd(new nb(4,re))},[W.commandParameters.stopwatch]))})};La.prototype.deleteFloatingObject=function(W,Ja){W=ig.a.wz(Ja,W);if(W=Ei.a(this.$).Iq(W))Ei.a(this.$).deleteFloatingObject(W,14,!0),$d.g(this.$).ha.Oa.IC=null};La.prototype.B0i=
function(W,Ja,Eb){var gc=this.$.da.Aa(277);if(gc){var Yc=null;W=ig.a.wz(W,Ja);W=Ei.a(this.$).Iq(W);if(null===W||void 0===W?0:W.Zi)Yc=W.Zi.block;if(Yc){var vd=W.floatingObject.Tg();gc.fZb(function(){return!Yc.aj.xb(vd)},Eb,"CutArt")}}};La.whi=function(W){return 1===W.type||5===W.type};Object(ud.a)(La,"ArtCopyPasteHandler",Gc,[]);var ph=b(56);Am(ua,nd);Object(ud.a)(ua,"MacroRecorderPasteArtPayload",nd,[]);ba.prototype.x$h=function(W,Ja,Eb,gc,Yc,vd,fe){var re=this;vd=void 0===vd?null:vd;fe=void 0===
fe?null:fe;var Oe=this.$.na.va.hc(),Wc=null,Pf={CopyPasteTargetType:2};Pf.FloatingObjectId=W;Pf.CopyOperationId=Eb.id;Eb.floatingObjectType=Ja;Pf.UploadToClipService=Eb.uploadToClipService;Pf.PKey=Eb.pKey;Pf.ClipServiceDataCenter=Eb.clipServiceDataCenter;var nf=0;2===Yc?(Yc=505,nf=16,Wc=function(Qg,Ng,ti){return he(re.$.na.va,Pf,af.b(Qg,gc),vd?af.a(Ng,vd):Ng,ti,Eb.ribbonCommandInfo,Oe,fe)}):(Yc=179,Wc=function(Qg,Ng,ti){re.Ehh(Ja,W);re.$.Oy();var qh=re.$.na.va;Qg=af.b(Qg,gc);Ng=vd?af.a(Ng,vd):Ng;
var fi=Eb.ribbonCommandInfo,$h=fe;$h=void 0===$h?null:$h;var Fi=qh.Na(1,void 0===Oe?null:Oe);Fi.copyParameters=Pf;return Vd.i(qh,"Cut",Fi,Qg,Ng,ti,fi,0,$h)});xd.EwaSettings.qc()?this.$.userOperationManager.ic(new kg.a(Yc,0,Wc,nf|64),Eb.ribbonCommandInfo):this.$.userOperationManager.ic(new Td.a(Yc,0,Wc,nf),Eb.ribbonCommandInfo)};ba.prototype.Ehh=function(W,Ja){var Eb=ig.a.wz(W,Ja);(Eb=Ei.a(this.$).Iq(Eb))?($d.g(this.$).ha.Oa.oH(Eb),Eb.isVisible=!1):Rb.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
W,Ja)};ba.prototype.pPj=function(W,Ja){W=ig.a.wz(W,Ja);if(W=Ei.a(this.$).Iq(W))W.isVisible=!0};ba.prototype.f4g=function(W){this.x$h(W.floatingObjectId,W.d4g,W.commandParameters,W.At,W.Dbh,W.Qaa,W.TOb)};ba.prototype.X$h=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){var Wc=this;re=void 0===re?null:re;Oe=void 0===Oe?!0:Oe;return new Promise(function(Pf,nf){var Qg=vd.commandParameters.stopwatch.zc;Wc.EOd(W,Yc,Ja,Eb,function(Ng){vd.requestTelemetryData=Ng.RequestTelemetryData;vd.serverRequestTimeInMs=vd.commandParameters.stopwatch.zc-
Qg;if(ue.a.zha(Ng.Errors))vd&&(vd.encounteredDeploymentErrors=!0),Rb.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",ue.a.Xc(Ng.Errors));else if(ue.a.rh(Ng.Errors))Rb.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",ue.a.Xc(Ng.Errors)),nf(new Uf.a(9,Ng.Errors));else if(Ng.Result){var ti=Ng.Result;Rb.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
Wc.Q0i(fe,ti.FloatingObjectId,Ng.StateId);Pf(ba.Uld(ti.FloatingObjectId))}else Rb.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),nf(new Uf.a(9,Ng.Errors))},function(Ng){vd.serverRequestTimeInMs=vd.commandParameters.stopwatch.zc-Qg;Ng=Kd.a.pg(Ng.data);Rb.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",ue.a.Xc(Ng));nf(new Uf.a(9,Ng))},gc,re,Oe)})};ba.prototype.Q0i=function(W,Ja,Eb){var gc=
this,Yc=this.$.da.Aa(277);if(Yc){var vd=ig.a.wz(W,ba.Uld(Ja));Yc.fZb(function(){return!!Ei.a(gc.$).Iq(vd)},Eb,"PasteArt")}};ba.prototype.zYd=function(W,Ja){Ja&&this.Qob.zYd(W,ig.a.wz(W.type,Ja))};ba.prototype.WGf=function(W){var Ja=this;return this.X$h(W.ribbonCommandInfo,W.destination,W.rIe,W.TOb,W.i1,W.pasteContext,W.item.type,W.hAe,W.item.isFromCurrentSession(this.$)).then(function(Eb){return Eb},function(Eb){Ja.zYd(W.item,W.hAe);return Promise.reject(Eb)})};ba.prototype.eOd=function(W,Ja,Eb){W||
(W=De.v($d.g(this.$).ha.ta.activeCell,this.$));$d.g(this.$).iic(De.D(W),1)?Ei.a(this.$).Dna(Eb,Ja,!0):$d.g(this.$).ha.Oa.cta(W,Ja,Eb).continueWith(function(gc){gc.result?Rb.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Ja):Rb.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Ja)})};ba.prototype.EOd=function(W,Ja,Eb,gc,Yc,vd,fe,re,Oe){function Wc(){if(Oe){var ti=
ph.a.oi(ph.a.Lc(Ng));ti.FloatingObjectId=Ja.floatingObjectId;Ng.DestinationRanges||(ti.DestinationRanges=De.p(nf.$.xa.qa.sheetName,"",0,0,0,0));return new ua(ti,Oe,0,0)}return new ua(Ng,Oe,0,0)}function Pf(ti,qh,fi){re||nf.$.Oy();return Oc(nf.$.na.va,Ng,af.b(ti,Yc),af.a(qh,vd),fi,null,Qg,fe)}var nf=this;Oe=void 0===Oe?!0:Oe;var Qg=this.$.na.va.hc(),Ng={};Ng.ShadowWorkbookBase64=Ja.shadowWorkbookBase64;Ng.FloatingObjectId=gc;Ng.DestinationRanges=Eb?De.s(Eb):null;Ng.CopyPasteTargetType=2;Ng.ClientEstimationFloatingObjectId=
re;Eb=xd.EwaSettings.qc()?new kg.a(503,0,Pf,void 0,Wc):new Td.a(503,0,Pf,void 0,Wc);Eb.flags=xd.EwaSettings.qc()?65:1;this.$.userOperationManager.ic(Eb,W)};ba.Uld=function(W){return String.format("{0}.{{{1}}}",W.length+2,W.toUpperCase())};Object(ud.a)(ba,"ArtCopyPasteUtils",null,[991]);var ji=b(249);K.prototype.rFd=function(W,Ja){this.Ata=W;this.w3c=Ja};K.prototype.z7c=function(){if(!this.Ata||!this.w3c)return Rb.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var W=Zf.a.Nqb(new ig.a(this.Ata));W.Id=ba.Uld(Kc.a.create().toString());W.Version=-1;W.Name="";W.IsClientEstimation=!0;var Ja=this.jbi(W);if(!Ja)return null;var Eb=new ig.a(W);Ja.block.aj.add(Eb);Eb.YIb();var gc=Ei.a(this.$);gc.H4b(Eb,Ja);Ja=gc.Iq(ig.a.yRh(W));!Ja||Ja.floatingObject.OMa||Ja.floatingObject.kNa||Ja.$Ra(this.w3c);gc.Dna(W.Type,W.Id,!0);return W.Id};K.prototype.X2f=function(W){return xd.EwaSettings.ma(223)&&W.isFromCurrentSession(this.$)&&!$d.g(this.$).rtl&&!$d.g(this.$).rb.dj};K.prototype.zYd=
function(W,Ja){this.X2f(W)&&(W=Ei.a(this.$).Iq(Ja))&&(Rb.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Ja,W.floatingObject.type),Ei.a(this.$).deleteFloatingObject(W,15,!0),W.Zi&&W.Ebb(W.Zi,!1))};K.prototype.jbi=function(W){if(!W)return Rb.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;
if($d.g(this.$).ha.Oa.activeFloatingObjectControlId){var Ja=$d.g(this.$).ha.Oa.IC.floatingObject;W.OriginDeltaX=Ja.offsetX+this.fab;W.OriginDeltaY=Ja.offsetY+this.fab;W.AbsoluteLeft+=this.fab;W.AbsoluteTop+=this.fab;W.AbsoluteRight+=this.fab;W.AbsoluteBottom+=this.fab;W.ZOrder=Ja.Xy+1;return $d.g(this.$).ha.Oa.IC.Zi}if(!this.$.qa||!this.$.qa.activeCell)return Rb.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var Eb=this.$.qa.activeCell;Ja=$d.g(this.$).N1(Eb);if(!Ja)return Rb.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",Eb.toString()),null;var gc=cb.HelperMethods.QKa(Ja.domElement,Ja.zj.domElement);Eb=Ja.gridView.qg(Eb,2);if(!gc||!Eb)return Rb.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!gc,!Eb),null;W.OriginDeltaX=Eb.topLeft.x-gc.x;W.OriginDeltaY=Eb.topLeft.y-gc.y;W.AbsoluteLeft=Eb.topLeft.x;W.AbsoluteTop=Eb.topLeft.y;W.AbsoluteRight=W.AbsoluteLeft+Math.abs(this.Ata.AbsoluteRight-this.Ata.AbsoluteLeft);W.AbsoluteBottom=W.AbsoluteTop+Math.abs(this.Ata.AbsoluteBottom-this.Ata.AbsoluteTop);W.ZOrder=this.Ata.ZOrder+100;return new ji.a(Ja.gridView.Ea.xl(Ja.hashCode),Ja.hashCode)};Object(ud.a)(K,"ArtPasteClientEstimation",null,[990]);$a.prototype.create=function(){var W=window.clipboardPlatform;
return W?W.createClipboardItems():null};Object(ud.a)($a,"ClipboardItemsFactory",null,[989]);mb.undefined="Undefined";Object(ud.a)(mb,"CCPTelemetryConsts",null,[]);cd.cells="Cells";cd.floatingObject="FloatingObject";cd.unknown="Unknown";Object(ud.a)(cd,"ActiveSelection",null,[]);hc.Jgh="DisplayNotInvoked";hc.r7c="Displayed";hc.b1i="PrerequisitesNotReady";Object(ud.a)(hc,"PasteIndicationDisplayStatus",null,[]);var xh=b(110);Fb.prototype.getCopyFlowHandler=function(W){var Ja=this.rNh($d.g(this.$).Ue);
W.commandParameters.copyPasteHandlerName=Ja.name;return Ja};Fb.prototype.getPasteFlowHandler=function(W){var Ja=W.copyContextSnapshot;Ja=sd(W)?this.OXc:fd(W)?this.sHd:(null===Ja||void 0===Ja?0:Ja.sourceItem)&&Object.getType(Ja.sourceItem)===Ve?this.OXc:this.sHd;W.commandParameters.copyPasteHandlerName=Ja.name;return Ja};Fb.prototype.initializePasteContext=function(W){if(W&&(W.isSameSession=!1,W.isShadowWorkbookParsedSuccessfully=!1,W.pasteResult=mb.undefined,W.payloadOrigin=mb.undefined,W.payloadType=
mb.undefined,W.encounteredDeploymentErrors=!1,W.shadowWorkbookSizeExceedsLimit=!1,W.originalSourceRangesCountExceedsLimit=!1,W.activeSelectionType=this.jJh(),W.indicationDisplayScheduled=!1,W.pasteDestinationHasMergedCells=!1,W.pasteIndicationDisplayStatus=hc.Jgh,W.copyContextSnapshot)){var Ja=W.copyContextSnapshot,Eb=Pd(Ja.sourceItem),gc=Ja.sourceItem;var Yc=!!gc&&Object.getType(gc)===Ve;gc=0;var vd=!1;Eb?(vd=Ja.sourceItem,W.isSameSession=vd.isFromCurrentSession(this.$),gc=1,vd=this.Dli(vd,W)):Yc&&
(W.isSameSession=Ja.sourceItem.isFromCurrentSession(this.$),gc=2);if(W.copyContextSnapshot.commandParameters){Yc=-1985798686===Ja.commandParameters.ribbonCommandInfo.command;var fe=W.commandParameters;var re=this.$;Ja?re&&re.ya?Ja=Ja.sessionId===re.ya.UserSessionId:(Rb.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ja=!1):(Rb.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ja=!1);fe.clearSystemClipboard=Ja&&Yc&&Eb&&!vd;W.commandParameters.copyPasteTargetType=gc}}};
Fb.prototype.getSessionId=function(){return this.$.ya.UserSessionId};Fb.prototype.Dli=function(W,Ja){var Eb=xh.b(W.ranges,function(gc){return gc.ff})&&xh.b(Ja.commandParameters.originalDestinations,function(gc){return 1!==gc.top});return xh.b(W.ranges,function(gc){return gc.isRow})&&xh.b(Ja.commandParameters.originalDestinations,function(gc){return 1!==gc.left})||Eb};Fb.prototype.rNh=function(W){switch(W){case 1:return this.sHd;case 64:case 4:case 2:case 256:return this.OXc;default:throw Error.invalidOperation("Unsupported selection");
}};Fb.prototype.jJh=function(){return $d.g(this.$).ha.Ue&470?cd.floatingObject:1===$d.g(this.$).ha.Ue?cd.cells:cd.unknown};Fb.prototype.getDialogResponse=function(){};Ck.Object.defineProperties(Fb.prototype,{sHd:{configurable:!0,enumerable:!0,get:function(){if(!this.ZPc){var W=this.$.da.Aa(254,!0);W&&(this.ZPc=new Cb(this.$,W,new $a))}return this.ZPc}},OXc:{configurable:!0,enumerable:!0,get:function(){if(!this.RFc&&this.$.da.Aa(254,!0)){var W=new K(this.$);this.RFc=new La(this.$,new $a,new ba(this.$,
W),W)}return this.RFc}}});Object(ud.a)(Fb,"ExcelCopyPasteApplicationHost",null,[732]);var zg=b(161),wi=Ze.a;Am(Cc,wi);Cc.prototype.jh=function(W){this.fp=new zg.a;var Ja=Bf.a.instance.fa(16);W=this.$V(W);this.initializeAndShow(Ja,this.cdi,W)};Cc.prototype.$V=function(W){var Ja={};return Ja[Cc.ay]=this.Cc,Ja[Cc.cni]=W,Ja};Ck.Object.defineProperties(Cc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});Cc.Sfh="direction";Cc.cni="isRtl";var Bh={};Cc.Tfh=
(Bh.Vertical=1,Bh.Horizontal=0,Bh);Object(ud.a)(Cc,"InsertCopiedCutCellsDialog",Ze.a,[]);Tb.prototype.J4b=function(W,Ja){return(new Cc(W,Ja)).fp.task};Object(ud.a)(Tb,"InsertCopiedCutCellsDialogFactory",null,[731]);var Jh=b(90),nh=b(47),fh=b(44);Sa.prototype.uKe=function(){var W=this;this.Mqc||(Rb.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.WC(function(Ja){Ja.sva(0).then(function(){W.Mqc=!0})}))};Sa.prototype.vlj=
function(W){var Ja=this,Eb=W.commandParameters.id;Rb.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",Eb,!this.Vs,this.Mqc);this.uKe();this.M5b=Eb;Eb=!this.Fsf();if(!this.Vs||Eb)this.rxe(),this.Vs=nh.a.instance.create(function(){Ja.Igh(W)},void 0===W.timeoutToShowSpinnerInMs||null===W.timeoutToShowSpinnerInMs?100:W.timeoutToShowSpinnerInMs,fh.a.rYi);this.U2=W.commandParameters.originalDestinations};
Sa.prototype.Igh=function(W){this.Mqc?(this.display(W.commandParameters.originalDestinations),W.pasteIndicationDisplayStatus=hc.r7c):(Rb.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),W.pasteIndicationDisplayStatus=hc.b1i)};Sa.prototype.display=function(W){Rb.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Cb.lx(Wg.a.q8(Sf.d(this.gridView.$.qa),W),Sa.Zpc,!0);this.gridView.Cb.Gn(Sa.Zpc)};
Sa.prototype.Ikd=function(W){Rb.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",W,this.M5b);W&&Xb.a.equals(W,this.M5b,!1)&&this.hide()};Sa.prototype.hide=function(W){this.U2&&(void 0===W?0:W)&&this.Fsf()&&Rb.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.M5b="";this.rxe();this.U2=null;this.gridView.Cb.Xh(Sa.Zpc);
this.gridView.Cb.vj(null,Sa.Zpc)};Sa.prototype.Fsf=function(){return De.Q(this.gridView.ha.ta.selectedRanges,this.U2)};Sa.prototype.rxe=function(){this.Vs&&(Jh.a.Ha(this.Vs),this.Vs=null)};Sa.prototype.dispose=function(){this.hide();this.gridView.ha.cG(this.Z8e)};Sa.Zpc=[30];Object(ud.a)(Sa,"PasteIndicationManager",null,[730,2]);var rj=b(1197),Qh=b(54),bh=Gg.a;Am(xb,bh);xb.prototype.create=function(){var W=this,Ja=Qh.a.Z_([51,52],4,this.ub,void 0,void 0,void 0,xb.NRa),Eb=Mb.GetServiceTaskFactory.create(this.$.da,
18,this.$.la,this.ub);Nd.TaskExtensions.Ba(Nd.TaskExtensions.xe([Eb,Ja],this.la),function(){var gc=new rj.a,Yc=null;W.I1g(gc).then(function(vd){Yc=vd.lAe;var fe=copyPasteInfra.createCopyPasteInfra(Yc,new Fb(W.$),gc,W.$);Rb.ULS.shipAssertTag(537167762,0,!!W.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Rb.ULS.shipAssertTag(537167761,0,!!W.$.ya&&!!W.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
var re=Yc.getMetadataManager();W.Eb(new kd(W.$,re,Eb.result,fe,new bb(W.$,$d.g(W.$)),new Tb,W.$.ya.DocumentHostInfo.UserId,Yc.getInitializationError()));vd.t0a?Rb.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",kd.Jac(),vd.t0a.dataClipboardStrategyType,JSON.stringify(vd.t0a.dataClipboardCapabilities),vd.t0a.clipboardStrategiesToInitialize[0].clipboardStrategyType===
vd.t0a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):Rb.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(vd){Rb.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",
kd.Jac(),vd?copyPasteInfra.getStringifiedError(vd):"null")})},this.la,3)};xb.prototype.dispose=function(){bh.prototype.dispose.call(this)};xb.prototype.I1g=function(W){var Ja=null,Eb=window.clipboardPlatform;Eb&&(Ja=Eb.getClipboardPlatformEnvironment());if(!Ja)return Rb.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Eb=this.$.ya;var gc=[Eb.OfficeOnlineChromeExtensionId,
Eb.ChromeClipboardAccessExtensionId],Yc=this.Zm.Wa(5),vd=this.$.Yf.get(57),fe=!vd&&this.$.Yf.get(5),re=this.$.ea.wc;re&&(re.inWebPart||re.inViewerFromWebPart||re.isDivSyndicated)&&(fe=!1);vd=this.nMh(fe,!vd);Rb.ULS.shipAssertTag(537167758,0,!!Eb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Ja.init(this.$,W,gc,Eb.SharedClipboardHostingApp,Eb.SharedClipboardHostingApps,Eb.SharedClipboardHostingEnvironments,
Eb.SharedClipboardOverrideOrigin,Eb.SharedClipboardSchemaVersion,Eb.SharedClipboardExpirationInMinutes,Eb.ClipboardPromiseTimeoutInMinutes,Yc,Eb.MachineCluster,new Ca(this.$),vd,Eb.DocumentHostInfo.UserId,Eb.ClipboardTtlInMS,xd.EwaSettings.ma(311),Eb.UserSessionId).then(function(Oe){return Object(Cg.a)(new gd,{lAe:Ja,t0a:Oe})},function(Oe){return Promise.reject(Oe)})};xb.prototype.nMh=function(W,Ja){var Eb=[];W&&Ja&&Eb.push(this.fah());Ja&&(Eb.push(this.a5c(7)),Eb.push(this.a5c(0)));W&&Eb.push(this.YEe());
Eb.push({clipboardStrategyType:4});Rb.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",W,Ja,Eb?Eb.join(","):"[]");return Eb};xb.prototype.YEe=function(){var W=this.$.ya,Ja={clipboardStrategyType:5};Ja.sessionId=W.UserSessionId;Ja.useSharedClipboardIframe=!0;Ja.sharedClipboardHostingApp=W.SharedClipboardHostingApp;Ja.sharedClipboardHostingApps=
W.SharedClipboardHostingApps;Ja.sharedClipboardHostingEnvironments=W.SharedClipboardHostingEnvironments;Ja.sharedClipboardOverrideOrigin=W.SharedClipboardOverrideOrigin;Ja.sharedClipboardSchemaVersion=W.SharedClipboardSchemaVersion;Ja.sharedClipboardExpirationInMinutes=W.SharedClipboardExpirationInMinutes;Ja.wacCluster=W.MachineCluster;return Ja};xb.prototype.fah=function(){var W={clipboardStrategyType:6};W.localStorageStrategyParameters=this.YEe();W.systemClipboardStrategyParameters=this.a5c(0);
return W};xb.prototype.a5c=function(W){var Ja={};Ja.clipboardStrategyType=W;Ja.skipFilesIfPlainTextExists=!0;return Ja};xb.ka=function(W){W.da.Ga(373,new Sa(W));W.da.Ga(xb.NRa,new xb(W))};xb.NRa=255;Object(ud.a)(xb,"CopyPasteInfrastructureFactory",Gg.a,[]);var Xh=b(11),ci=b(109),Fg=b(13),ki=me.a;Am(Yb,ki);Yb.prototype.dispose=function(){this.wm();this.ol=this.xr=this.$=null;this.statusBarManager&&(this.statusBarManager.ZF(this),this.statusBarManager=null)};Yb.prototype.xn=function(){return this.v3f};
Yb.prototype.fs=function(W,Ja){if("QueryPasteShortcutEnabledLabel"!==W&&!Array.contains(Yb.iGj,W))return!1;var Eb=this.Ao();"QueryPasteShortcutEnabledLabel"===W?(Ja.Visible=Eb,Rb.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",Eb,W)):(Ja.Visible=!Eb,Rb.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!Eb,W));return!0};Yb.prototype.elh=function(){this.Ek();this.raiseEvent("pasteShortcutStatusChanged")};
Yb.prototype.W6b=function(){this.wm();this.raiseEvent("pasteShortcutStatusChanged")};Yb.prototype.Ao=function(){return this.j9c};Yb.prototype.Aq=function(W){this.addHandler("pasteShortcutStatusChanged",W)};Yb.prototype.Xq=function(W){this.removeHandler("pasteShortcutStatusChanged",W)};Yb.prototype.Ek=function(){if(!this.Ao()){this.j9c=!0;$d.g(this.$).kk.sl(this.eJe);this.ol.ka("blur",this.bgh);var W=this.$.da.Aa(65);W&&W.P3&&W.P3.registerForCommentEvents(this.dJe);this.xr.wt(Fg.a.Xb,this.lif?this.$.xw:
this.$.domElement,this.onKeyDown,!0)}};Yb.prototype.wm=function(){if(this.Ao()){this.j9c=!1;$d.g(this.$).kk.kl(this.eJe);this.ol.detach("blur");var W=this.$.da.Aa(65);W&&W.P3&&W.P3.unregisterForCommentEvents(this.dJe);this.xr.Ft(Fg.a.Xb,this.lif?this.$.xw:this.$.domElement,this.onKeyDown,!0)}};Yb.iGj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(ud.a)(Yb,"PasteShortcutManager",me.a,[597,543,373,2]);var Ag=b(128),Ch=Gg.a;Am(Ob,Ch);Ob.prototype.create=function(){var W=this.$;this.Eb(W.da.Aa(478)||
this.$.da.Ga(478,new Yb(W,ci.KeyInputManager.instance,Ag.a.instance.PE())))};Ob.ka=function(W){W.da.Ga(479,new Ob(W))};Object(ud.a)(Ob,"PasteShortcutManagerFactory",Gg.a,[]);Ub.prototype.isEnabled=function(){if(Vc.AFrameworkApplication.ga?Vc.AFrameworkApplication.ga.ra("IsAnonymousUser"):1)return!1;var W=Vc.AFrameworkApplication.dc?Object(Sb.a)(String,Vc.AFrameworkApplication.dc.AudienceGroup):"";return"Unknown"!==W&&"Automation"!==W};Ck.Object.defineProperties(Ub.prototype,{dXc:{configurable:!0,
enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},Hhi:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(338)}},V7a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(340)}},S7a:{configurable:!0,enumerable:!0,
get:function(){return this.$.ma(339)}},GDh:{configurable:!0,enumerable:!0,get:function(){return null}},krf:{configurable:!0,enumerable:!0,get:function(){return 24}},XUf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},oJb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(ud.a)(Ub,"FirstRunExperienceLauncherSettings",null,[734]);yd.prototype.QSd=function(){this.dVe&&this.dVe.QSd(this.tDh)};Object(ud.a)(yd,"FirstRunExperienceManager",null,[596]);
var Yg=Gg.a;Am(ec,Yg);ec.prototype.create=function(){this.Eb(this.$.da.Aa(311)||this.d7g())};ec.prototype.d7g=function(){var W=new Ub(this.$);W=new yd(Bd.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),W);W.QSd();return W};ec.ka=function(W){W.da.Ga(312,new ec(W))};Object(ud.a)(ec,"FirstRunExperienceManagerFactory",Gg.a,[]);var hh=b(59),Ug=Gg.a;Am(Ya,Ug);Ya.prototype.create=function(){this.Eb(this.$.da.Aa(361)||this.P7g())};Ya.prototype.P7g=function(){var W=
this;this.cmd=Bd.a.instance.Lh("Common.IInProductMessagingUIManager");hh.a.Dg.isReactSharedHeaderUxEnabled?bf.a.get_instance().Lk(16,function(){W.dbf()}):this.dbf();return this.cmd};Ya.prototype.dbf=function(){var W=this;Bd.a.instance.lc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ja){Ja.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Eb){!Eb&&Ja.isFreemiumUpsellEnabled()&&W.cmd.Tlf();return null})})};Ya.ka=function(W){W.da.Ga(362,new Ya(W))};Object(ud.a)(Ya,
"InProductMessagingManagerFactory",Gg.a,[]);var yh=b(904),pi=b(103),pg=b(186),qi=b(108);rb.prototype.CFb=function(W){this.Lj=W;if(!this.T1a){if(this.f_d){if(this.v9a&&ug.a.CF){this.QSb=W.t7b(Object(qb.a)(this,this.jBd,"onFileChosen"));return}this.QSb=W.t7b(null);if(!this.qCa(this.QSb,W))return}this.finalizeUpload(W,null)}};rb.prototype.jBd=function(W){if(this.qCa(W,this.Lj)){if(ug.a.CF||ug.a.Hf)this.QSb=W;this.finalizeUpload(this.Lj,null)}};rb.prototype.gpc=function(){this.cDd&&this.cDd()};rb.prototype.fhj=
function(){this.xra=0;this.iFa=this.ga.Cd("Box4UploadRetryDelayStart",200);this.Lj&&(this.Lj.dispose(),this.Lj=null)};Ck.Object.defineProperties(rb.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.JT}},ga:{configurable:!0,enumerable:!0,get:function(){return this.vb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.xra}},AMd:{configurable:!0,enumerable:!0,get:function(){return this.iFa}}});Object(ud.a)(rb,"FileUploader",null,[]);var tg=b(331),Zh=b(990),
Ga=b(133);Am(pb,rb);pb.prototype.d_e=function(W){switch(W){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};pb.prototype.Ufg=function(W){return pb.qCa(W,this.Z0h())};pb.prototype.Z0h=function(){return pb.kke};pb.prototype.qCa=function(W,Ja){Ja=void 0===Ja?null:Ja;W=this.Ufg(W);return 0!==W?(Ja&&Ja.ume(),2===W&&this.ui(0,this.d_e(W)),!1):!0};pb.prototype.finalizeUpload=function(W,Ja){Rb.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.cDd=Ja;this.jBj();tg.a.mark(5576);this.yVb=this.YO.Hc("LoadResource","PictureUploadTime")};pb.prototype.ui=function(W,Ja){var Eb=new Ga.StandardDialog;Eb.jc=0;Eb.cA(W,CommonUIStrings.l_ImageUploadFailedTitle,Ja,null)};pb.prototype.gpc=function(){Rb.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");rb.prototype.gpc.call(this);this.yVb&&(this.yVb.stop(),this.yVb=null);this.ZZg()};pb.prototype.jBj=function(){this.Tra=(new Zh.a).create();
this.Tra.message=CommonUIStrings.l_ImageUploadWait;this.Tra.jc=5;this.Tra.rv=!1;this.Tra.kBa(null,null,null)};pb.prototype.ZZg=function(){this.Tra&&(this.Tra.close(),this.Tra=null)};pb.S6h=function(W,Ja){W=Hb.a.Wl(W);for(var Eb=0;Eb<Ja.length;++Eb)if(W.endsWith(Ja[Eb]))return!0;return!1};pb.qCa=function(W,Ja){Ja=void 0===Ja?null:Ja;Ja||(Ja=pb.kke);return W?pb.S6h(W,Ja)?0:2:1};Ck.Object.defineProperties(pb.prototype,{YO:{configurable:!0,enumerable:!0,get:function(){return Vc.AFrameworkApplication.sa.MD}}});
pb.kke=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(ud.a)(pb,"PictureUploader",rb,[]);var oa=b(619),Bb=b(293),Rd=b(149),je=b(91),yf=b(167),Of=b(182),Mf=b(87),ah=b(1314),Xg=b(80),Eh=ah.a;Am(nc,Eh);nc.prototype.osc=function(W,Ja){this.isEnabled()&&this.XFa(this.targetOrigin)&&(this.mo(W),this.Tl(W,Ja))};Object(ud.a)(nc,"InsertMediaCrossDocumentMessenger",ah.a,[674,107,2]);Object(ud.a)(Pa,"OnlineMediaSearchResult",null,[]);var rh=b(325),Fh=Rd.a;Am(cc,Fh);cc.prototype.bBj=function(W){var Ja=
this;this.khc=!1;this.showDialog(this.Im,null);this.Jwa=document.getElementById(this.pi("InsertMediaFrame"));if(!this.Jwa)throw this.Tua(this.Cpb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Eb=document.getElementById(this.pi("WACDialogPanel"));Eb&&Eb.setAttribute(je.a.Rd,je.a.PZa);Eb=document.createElement("div");Eb.id="KeepFocusStartDiv";Eb.tabIndex=0;Eb.className="keep-focus-start";this.Jwa.parentNode.insertBefore(Eb,this.Jwa.parentNode.firstChild);Eb=document.createElement("div");
Eb.id="KeepFocusDiv";Eb.tabIndex=0;Eb.className="keep-focus";this.Jwa.parentNode.appendChild(Eb);$addHandler(this.NIa,"keydown",this.ftd);this.Jwa.src=this.mbf;this.Jwa.frameBorder="0";Eb=document.getElementById(this.pi("WACDialogButtonPanel"));if(!Eb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Eb.className="display-none";Eb=document.getElementById(this.pi("WACDialogTitleText"));if(!Eb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Eb.className="display-none";
2===this.Lqf&&(document.getElementById(this.pi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.pi("WACDialogBodyPanel")).className="padding-zero");yg.FocusManager.instance().iR().scope.XR=!0;this.uS=new nc(this.Jwa.contentWindow,this.mbf);this.uS.osc(yf.a.dCg,function(gc){Ja.PGi(gc,Object(qb.a)(W,W.dpa,"uploadResponseReceived"))});this.uS.osc(yf.a.insert,function(){Ja.eOi(Object(qb.a)(W,W.dpa,"uploadResponseReceived"))});this.uS.osc(yf.a.C_c,this.VHi);2===this.Lqf&&0===
this.xfh&&(this.uS.osc(yf.a.ksi,this.QOi),this.VNa=this.wob.cna("MsoPremiumStockImages",function(gc){Rb.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(gc.isEnabled){var Yc={};Ja.uS.Jj(yf.a.LUj,(Yc.LicenseTier=gc.toString(),Yc))}else Rb.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};cc.prototype.dispose=function(){this.KAa=null;this.wob&&this.VNa&&this.wob.rJd("MsoPremiumStockImages",this.VNa);
this.uS&&(this.uS.dispose(),this.uS=null);Fh.prototype.dispose.call(this)};cc.prototype.hide=function(){Fh.prototype.hide.call(this);Mf.a.Iwc(this.$)};cc.prototype.PGi=function(W,Ja){W=W&&W.Values?(W=W.Values)?Object(Cg.a)(new Pa,{Action:W.action||"",Caption:W.caption||"",ContentType:W.contentType||"",FileExtension:W.extension||"",PageUrl:W.pageUrl||"",SourceUrl:W.sourceUrl||"",ThumbnailUrl:W.thumbnailUrl||"",LicenseUrl:W.licenseUrl||"",LicenseDisplayName:W.licenseDisplayName||"",Height:W.height||
0,Width:W.width||0}):null:null;W&&(this.KAa.push(W),this.khc&&(Rb.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Ja(this.KAa),this.khc=!1,this.Tua(this.Cpb)))};cc.prototype.eOi=function(W){this.KAa&&0<this.KAa.length?this.KAa.length<=this.vqe?(W(this.KAa),this.Tua(this.Cpb)):(this.cA(),Rb.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.KAa)):this.khc=!0};cc.prototype.S7g=function(){var W=
document.createElement("div");W.id="InsertMediaDialog";W.className=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Ja=document.createElement("div");Ja.id="InsertMediaPanel";Ja.className=xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var Eb=document.createElement("iframe");Eb.id=
"InsertMediaFrame";Eb.className="insert-media-frame";W.appendChild(Ja);Ja.appendChild(Eb);return rh.b(W)};cc.prototype.cA=function(){var W=ue.a.gd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");W.Description=String.format(Bf.a.instance.Ab(197),this.vqe.toLocaleString());xd.EwaSettings.Kz()?new He.a(this.$,W):(new Pe.ErrorDialog(this.$,W)).kf()};Ck.Object.defineProperties(cc.prototype,{X4:{configurable:!0,enumerable:!0,get:function(){return Of.a.N6b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(ud.a)(cc,"InsertMediaDialog",Rd.a,[]);var Rh=b(490),se=b(395);Am(ib,pb);ib.prototype.dpa=function(W){var Ja=this;if(W){for(var Eb=Array(W.length),gc=0;gc<W.length;gc++){var Yc=W[gc];Eb[gc]={};Eb[gc].SourceUrl=Yc.SourceUrl;Hb.a.lxa(Yc.LicenseUrl)&&Hb.a.lxa(Yc.PageUrl)&&(Eb[gc].LicenseUrl=Yc.LicenseUrl,Eb[gc].LicenseDisplayName=Yc.LicenseDisplayName,Eb[gc].PageUrl=Yc.PageUrl);Eb[gc].AltText=-2053056795===this.Td.command?Yc.Caption:""}var vd=-2009825598===
this.Td.command?"bing":"M365";gc=$d.g(this.$);var fe=De.o(gc.ha.ta.activeCell,this.$);Hf.a(this.$.userOperationManager,function(re,Oe,Wc){return Vd.M(Ja.$.na.va,fe,Eb,vd,af.b(re,Ja.EQi),af.a(Oe,Ja.DQi),Wc,null)},function(re){return new kg.a(595,0,re)},this.Td);cb.HelperMethods.I_?(gc=new Map,gc.set("MediaProvider",vd),gc.set("ImagesCount",W.length.toString()),gc.set("TimeTakenToOpenDialog",this.kof.toString()),tc.Health.instance.recordKpiUsage(se.a.kdi,1,Rh.a.x9f,gc)):Rb.ULS.sendTraceTag(537155805,
0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.gpc()}else Rb.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};ib.prototype.dispose=function(){this.$=null};ib.prototype.showDialog=function(){var W=this,Ja=null;Ja=this.$.Ob.Hc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Td.command){case -2009825598:this.nAj();break;case -2053056795:this.bre.execute(function(Eb){Eb.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(gc){return Rb.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",gc)}).then(function(gc){W.oAj(gc);return null})})}Ja.stop();this.kof=Ja.zc};ib.prototype.nAj=function(){var W=this.$.ya.BingPictureEndpoint,Ja=oa.a.hK(Vc.AFrameworkApplication.lcid),Eb=Kc.a.create();W?(W=0<W.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(W,1,1):String.format(W,1,Vc.AFrameworkApplication.lcid,
Ja?Ja.name:"en-us",Vc.AFrameworkApplication.buildVersion,Eb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.J4b(W,1,-1,Bf.a.instance.fa(1724))):(Rb.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.t1.setException(Error.create("Failed to access the Bing service endpoint")))};ib.prototype.oAj=function(W){var Ja=this.$.ya.M365PictureEndpoint,Eb=Kc.a.create();if(Ja){var gc=this.$.ya.DocumentHostInfo.UserId;
gc=gc?Hb.a.sw(gc).toString():"0";var Yc=this.bre.instance.isFreemiumUpsellEnabled();W=W?1:Yc?0:-1;Eb=Eb.toString();Yc=oa.a.hK(Vc.AFrameworkApplication.lcid).name;Ja=String.format(Ja,Vc.AFrameworkApplication.lcid,Yc,Vc.AFrameworkApplication.buildVersion,Eb,1,gc,W,1);this.J4b(Ja,2,W,Bf.a.instance.fa(1723))}else Rb.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.t1.setException(Error.create("Failed to access the M365 service endpoint"))};
ib.prototype.J4b=function(W,Ja,Eb,gc){try{(new cc(this.$,W,Bd.a.instance.Lh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ja,Eb,gc)).bBj(this),this.t1.setResult(!0)}catch(Yc){Rb.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",Yc,Ja,Eb),this.t1.setException(Yc)}};Object(ud.a)(ib,"OnlinePictureUploaderWrapper",pb,[2]);eb.prototype.executeCommand=function(W,Ja,Eb){W=Ja.command;
switch(W){case 1403967063:if(Eb&&"dataUrl"in Eb)return Ja=new zg.a,this.uploaderCreator&&this.uploaderCreator.Vai(this.$,pi.a.instance,Vc.AFrameworkApplication.ga,Eb,Eb.dataUrl,Ja),Ja.task;this.uploaderCreator&&this.uploaderCreator.Wbi(this.$,Ja,pi.a.instance,Vc.AFrameworkApplication.ga,Eb);return ic.Task.Ra(!0);case -2053056795:case -2009825598:return W=new zg.a,new ib(this.$,Ja,pi.a.instance,Vc.AFrameworkApplication.ga,Eb,W),W.task;default:return pg.a(W)}};eb.prototype.Kc=function(W,Ja){if(W=this.$.isEditMode)switch(Ja.command){case 1403967063:W=
!0;break;case -2053056795:W=!0;break;case -2009825598:W=xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;default:W=!1}return W};eb.prototype.jd=function(){return!1};eb.prototype.$c=function(){return!1};Object(ud.a)(eb,"PictureCommandHandler",null,[424]);var kh=yh.a;Am(lc,kh);lc.prototype.Nd=function(){var W=this;Nd.TaskExtensions.Ba(Mb.GetServiceTaskFactory.Ua(this.$.da,484,485,1),function(Ja){W.Dd([new eb(W.$,Ja.result)])},this.$.la,3)};lc.ka=function(W){yh.a.he(90,
new lc(W))};Object(ud.a)(lc,"PictureCommandHandlerFactory",yh.a,[]);var jg=b(556),oh=b(438),Mi=b(76),Nh=b(593),Zg=b(637),Df=Nh.a;Am(pc,Df);pc.prototype.FQd=function(W){this.fga!==W&&(this.fga=W,this.hHb())};pc.prototype.dispose=function(){this.gridView.rc.kl(this.Kvf);this.gridView.rc.Zn(this.Jvf);this.gridView=null;Df.prototype.dispose.call(this)};pc.prototype.hHb=function(){this.oHd(this.fga)};pc.prototype.refresh=function(){this.FQd(!this.gridView.isEditing)};Ck.Object.defineProperties(pc.prototype,
{nI:{configurable:!0,enumerable:!0,get:function(){return this.Hlc(this.fga)}},name:{configurable:!0,enumerable:!0,get:function(){return Zg.a.cellEdit}}});Object(ud.a)(pc,"CellEditSafeStatePublisher",Nh.a,[]);Object(ud.a)(Db,"SafeStatePublisherState",null,[]);var Ff=b(706),zh=me.a;Am(Oa,zh);Oa.prototype.YZb=function(W){this.addHandler(Oa.uRa,W)};Oa.prototype.wtc=function(W){this.removeHandler(Oa.uRa,W)};Oa.prototype.eAa=function(W,Ja){function Eb(vd,fe){Yc.nI=fe.nI;gc.jHb()}var gc=this,Yc=new Db(W,
Ja);this.vRa.add(Yc);W.YZb(Eb);Yc.handler=Eb;this.jHb()};Oa.prototype.MYd=function(W){for(var Ja=null,Eb=Cl(this.vRa),gc=Eb.next();!gc.done;gc=Eb.next())if(gc=gc.value,gc.publisher===W){this.Hcg(gc);Ja=gc;break}Ja&&(this.vRa.remove(Ja),this.jHb())};Oa.prototype.dispose=function(){for(var W=Cl(this.vRa),Ja=W.next();!Ja.done;Ja=W.next())this.Hcg(Ja.value);this.vRa.clear();this.lzb&&(this.Ske.Pcj(this.yAf.bind(this)),this.Kma.Rbb(this.Wya.bind(this)));zh.prototype.dispose.call(this)};Oa.prototype.Bac=
function(){var W=ka.Bac(this.vRa.toArray().map(function(Ja){return Ja.nI}));return this.Ijc&&1===W?2:W};Oa.prototype.Hcg=function(W){W.publisher.wtc(W.handler)};Oa.prototype.jHb=function(){var W=this.Bac();W!==this.Ikf&&(this.raiseEvent(Oa.uRa,new Ff.a(W)),this.Ikf=W)};Oa.prototype.yAf=function(){this.Ijc&&Rb.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.Ijc=!0;this.jHb()};Oa.prototype.Wya=function(W,Ja){W=Ja.Dca;
(Ja=!sa(W))||(Ja=this.Cri,Ja=(null===W||void 0===W?void 0:W.SuspensionStartTimestamp)!==(null===Ja||void 0===Ja?void 0:Ja.SuspensionStartTimestamp));Ja&&(this.Ijc=!1);this.Cri=W;this.jHb()};Ck.Object.defineProperties(Oa.prototype,{rQj:{configurable:!0,enumerable:!0,get:function(){return xh.f(xh.c(this.vRa.toArray(),function(W){return 0!=W.nI}),function(W){return W.publisher.name})}}});Oa.uRa="SSC";Object(ud.a)(Oa,"ClientStateMonitor",me.a,[]);var og=b(6),vh=b(66),ij=Nh.a;Am(wb,ij);wb.prototype.FQd=
function(W){W!==this.fga&&(this.fga=W,this.hHb())};wb.prototype.dispose=function(){vh.a(this.$).btc(this.Owf);this.W5a.Xq(this.YN);this.f9d=null;ij.prototype.dispose.call(this)};wb.prototype.hHb=function(){this.oHd(this.fga)};wb.prototype.refresh=function(){this.FQd(1===this.W5a.au||vh.a(this.$).xi===this.W5a)};Ck.Object.defineProperties(wb.prototype,{nI:{configurable:!0,enumerable:!0,get:function(){return this.Hlc(this.fga)}},name:{configurable:!0,enumerable:!0,get:function(){return Zg.a.W5a}},W5a:{configurable:!0,
enumerable:!0,get:function(){return this.f9d}}});Object(ud.a)(wb,"IdleActivitySafeStatePublisher",Nh.a,[]);var k=b(328),G=b(3),d=Mi.a;Am(ob,d);ob.prototype.$c=function(){return!1};ob.prototype.executeCommand=function(){return ic.Task.Ra(!0)};ob.prototype.Kc=function(W,Ja){return 1905775613===Ja.command};ob.prototype.jd=function(){return!1};Object(ud.a)(ob,"ToggleMergeSuspensionSafeState",Mi.a,[424]);var S=me.a;Am(gb,S);gb.prototype.Aq=function(W){this.addHandler(gb.vxd,W)};gb.prototype.Xq=function(W){this.removeHandler(gb.vxd,
W)};gb.prototype.Qz=function(){this.raiseEvent(gb.vxd)};gb.prototype.xn=function(W){return W===gb.v3i&&!!this.mergeSuspensionManager};gb.prototype.fs=function(W,Ja){if(!this.xn(W))return!1;this.mergeSuspensionManager&&(Ja.LabelText=this.pmc,Ja.On=this.Tyd);return!0};gb.prototype.dispose=function(){this.HNb&&(this.Ka.Fbb(this.HNb),this.HNb.dispose(),this.HNb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.Kma.Rbb(this.Wya),this.mergeSuspensionManager.kia.wtc(this.qPa),this.mergeSuspensionManager=
null);this.statusBarManager&&(this.statusBarManager.ZF(this),this.statusBarManager=null);this.pmc=null;S.prototype.dispose.call(this)};gb.vxd="MSMSC";gb.v3i="QueryMergeSuspensionStatus";Object(ud.a)(gb,"MergeSuspensionIndicatorManager",me.a,[543,373,2]);var P=b(1091),ja=Sys.EventArgs;Am(Na,ja);Object(ud.a)(Na,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);Object(ud.a)(ra,"SuspensionState",null,[]);Am(ta,ra);Object(ud.a)(ta,"ReadyForPendingMergeState",ra,[]);var D=new ra,da=new ra,
Ha=new ta(!1),jb=new ta(!0),kc=b(1092),Jb=kc.a;Am(ac,Jb);Object(ud.a)(ac,"ReadyForPendingMergesUpdatedEventArgs",kc.a,[]);var md=me.a;Am(kb,md);kb.prototype.M$h=function(){return Object(oh.a)(Oa,this.kia)?Object(Sb.a)(Oa,this.kia).Bac():1};kb.prototype.c_b=function(W){this.addHandler(kb.XWd,W)};kb.prototype.ytc=function(W){this.removeHandler(kb.XWd,W)};kb.prototype.jHg=function(W){this.addHandler(kb.WHd,W)};kb.prototype.udj=function(W){this.removeHandler(kb.WHd,W)};kb.prototype.rGg=function(W){this.addHandler(kb.qxd,
W)};kb.prototype.Ocj=function(W){this.removeHandler(kb.qxd,W)};kb.prototype.d5i=function(){this.mHd(this.getState()===da)};kb.prototype.dispose=function(){this.kia.wtc(this.qPa);this.kia=null;this.Kma.Rbb(this.Wya);this.Kma=null;md.prototype.dispose.call(this)};kb.prototype.hgd=function(){return Object(Cg.a)(new P.a,{Current:this.Sla.Current,Pending:this.Sla.Pending,SuspensionStartTimestamp:this.Sla.SuspensionStartTimestamp})};kb.prototype.getState=function(){return sa(this.Sla)?0==this.nI?jb:this.lzb&&
1==this.nI?Ha:da:D};kb.prototype.PUe=function(W,Ja){W!==Ja&&(Ja===da?this.mHd(!0):W===da&&this.mHd(!1));Ja instanceof ta&&this.raiseEvent(kb.WHd,new ac(this.Sla,Ja.tqe||!this.lzb))};kb.prototype.uwi=function(W,Ja,Eb){W===D&&Ja!==D?(W=Ja===da,Ja=Ja===Ha,Rb.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2} isBlockingAllMerges: {3}",Ja,Ja||W?this.kia.rQj.join(","):"",Wa(this.Sla),W)):W!==D&&Ja===
D&&Rb.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: {0}",Wa(Eb))};kb.prototype.mHd=function(W){this.raiseEvent(kb.XWd,new Na(W))};kb.XWd="TPMBBC";kb.WHd="RFPMU";kb.qxd="MCC";Object(ud.a)(kb,"MergeSuspensionStateHandler",me.a,[]);var ce=me.a;Am(db,ce);db.prototype.jZa=function(W){this.addHandler("MCU",W)};db.prototype.Rbb=function(W){this.removeHandler("MCU",W)};db.prototype.nPa=function(W,Ja){Ja=void 0===Ja?"":Ja;var Eb=this.u2.Current<
W.Current||this.u2.Pending<W.Pending;if(W.SuspensionStartTimestamp&&this.Hjc!==W.SuspensionStartTimestamp){if(this.Hjc>W.SuspensionStartTimestamp){Eb&&Rb.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ja,db.ZCb(W),db.ZCb(this.u2));return}Eb||Rb.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",db.ZCb(W),
db.ZCb(this.u2))}else if(!Eb)return;this.u2=W;this.JLf(W)};db.prototype.dispose=function(){this.$.ea.Fk(this.hwc);this.$.ea.AS(this.hwc);this.$.na.Dr(this.I8);$d.g(this.$).rc.Zn(this.c$a);var W=this.$.da.Aa(292);W&&W.Rbb(this.$Cb);ce.prototype.dispose.call(this)};db.prototype.JLf=function(W){sa(W)&&W.SuspensionStartTimestamp>this.Hjc&&(Rb.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",Wa(W)),this.Hjc=W.SuspensionStartTimestamp);
this.raiseEvent("MCU",new kc.a(W))};db.prototype.STf=function(){Rb.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",db.ZCb(this.u2));this.u2=Object(Cg.a)(new P.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};db.ZCb=function(W){return W?String.format("({0}/{1} @{2})",W.Current,W.Pending,W.SuspensionStartTimestamp):"null"};Ck.Object.defineProperties(db.prototype,{Sla:{configurable:!0,enumerable:!0,get:function(){return this.u2}}});db.x0d="PMM.RTC";
db.W7c="PMM.EwaResult";Object(ud.a)(db,"PendingMergeMonitor",me.a,[]);Object(ud.a)(sb,"ClientRevisions",null,[]);var qe=me.a;Am(wa,qe);wa.prototype.dispose=function(){this.$.na.Lda(this.J8);this.uzc();this.v6.udj(this.iCf);this.v6.ytc(this.zFb);this.v6.Ocj(this.xAf);this.v6=null;qe.prototype.dispose.call(this)};wa.prototype.vFj=function(){this.uzc();if(this.SIe()){var W=this.v6.hgd();Rb.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",
Wa(W),this.dBb)}else this.eBb=this.YZa.create(this.gYf,this.guc,fh.a.eBb),this.i8a=this.YZa.GC(this.gYf,this.$qi,fh.a.i8a)};wa.prototype.uzc=function(){this.i8a&&(this.eBb.cancel(),this.i8a.cancel(),this.i8a=this.eBb=null)};wa.prototype.AOi=function(W){var Ja=" fail count: "+this.dBb;this.dBb++;this.SIe()&&this.uzc();Rb.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",Wa(W),Ja)};wa.prototype.SIe=function(){return this.dBb>wa.aAi};
wa.aAi=5;Object(ud.a)(wa,"RequestController",me.a,[]);var Ye=b(211),ma=b(28),ab=me.a;Am(qa,ab);qa.prototype.sGg=function(W){this.addHandler(qa.wxd,W)};qa.prototype.Pcj=function(W){this.removeHandler(qa.wxd,W)};qa.prototype.iNg=function(W,Ja){var Eb=this;this.NLb(W,Ja)?(new zg.a).setResult(!0):(Ja=this.JYi(W,Ja),this.CBb=W,this.jDd++,Ja.CWCT(function(){Eb.lKi()},Ye.a.none,0,this.bP))};qa.prototype.JYi=function(W,Ja){this.dDc=this.hh.G8;this.$jf=Ja;Rb.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}. allowSelectionAdjustment: {3}",
W.Current,W.Pending,W.SuspensionStartTimestamp,Ja);this.isDocumentHidden||this.Oy();return this.Cnj(Ja,W)};qa.prototype.NLb=function(W,Ja){if(this.PGe&&this.isDocumentHidden)return this.hh.G8-this.dDc<this.u7h;if(this.LAa&&!Ja&&!this.LAa.coi())return Rb.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.CBb||W.SuspensionStartTimestamp>this.CBb.SuspensionStartTimestamp)return this.kMa&&Rb.ULS.sendTraceTag(523551556,
0,50,"DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",W.Current,W.Pending,W.SuspensionStartTimestamp),!1;if(this.kMa)return!0;if(this.hfg){W=Fa(W,this.CBb);var Eb=this.hh.G8-this.dDc<this.guc;Ja=this.$jf===Ja;return W&&Eb&&Ja}return Fa(W,this.CBb)&&this.hh.G8-this.dDc<this.guc};qa.prototype.Cnj=function(W,Ja){function Eb(){Rb.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeSender.sendDoPendingMergeRequest: request failed {0} / {1} @{2}",
Ja.Current,Ja.Pending,Ja.SuspensionStartTimestamp)}var gc=this.va.hc();return this.LAa?this.LAa.akj(this.NOh(W,Eb,gc)):this.Rwe(null,!0,void 0,Eb,gc)};qa.prototype.NOh=function(W,Ja,Eb){var gc=this;return function(Yc,vd,fe){var re=void 0;gc.hfg&&(Rb.ULS.shipAssertTag(523317955,0,null!=Yc||W,"!allowSelectionAdjustment requires a non-null initialViewportState."),re=gc.mKi.bind(gc));vd&&(re=af.b.call(null,function(Oe){var Wc=Oe.Result,Pf=null===Wc||void 0===Wc?void 0:Wc.AdjustedViewportState;3===(null===
Wc||void 0===Wc?void 0:Wc.MergeResultState)&&(Pf=void 0);vd(Pf,Oe.StateId)},re));fe&&(Ja=af.a.call(null,fe,Ja));return gc.Rwe(Yc,W,re,Ja,Eb)}};qa.prototype.Rwe=function(W,Ja,Eb,gc,Yc){if(this.AUg){var vd=this.va;Yc=vd.Na(1,void 0===Yc?null:Yc);Yc.viewportState=W;Yc.allowViewAdjustment=Ja;W=Vd.i(vd,"DoPendingMerge",Yc,Eb,gc,null,null,0)}else vd=this.va,Yc=vd.Na(1,void 0===Yc?null:Yc),Yc.viewportState=W,Yc.allowViewAdjustment=Ja,W=Vd.i(vd,"DoPendingMergeNew",Yc,Eb,gc,null,null,0);return W};qa.prototype.mKi=
function(W){W=W.Result;void 0!=W&&3===W.MergeResultState&&(Rb.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.H4i())};qa.prototype.H4i=function(){this.raiseEvent(qa.wxd,new Sys.EventArgs)};qa.prototype.lKi=function(){this.jDd--};Ck.Object.defineProperties(qa.prototype,{kMa:{configurable:!0,enumerable:!0,get:function(){return 0<this.jDd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Bi}}});
qa.wxd="MWA";Object(ud.a)(qa,"DoPendingMergeSender",me.a,[720,721]);Ck.Object.defineProperties(Aa.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this.K9h?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}});Object(ud.a)(Aa,"SelectionAdjustSessionEndsReport",null,[476]);va.prototype.zgg=function(W){for(var Ja=Cl(this.v3d),Eb=Ja.next();!Eb.done;Eb=Ja.next()){Eb=Eb.value;if(!Eb)return Rb.ULS.sendTraceTag(525135954,0,10,"Selection.viewportBlocksReadyForAdjust: blockCacheItemGroup undefined"),
!1;Eb=Cl(Eb);for(var gc=Eb.next();!gc.done;gc=Eb.next())if(gc=gc.value,gc.Yj&&gc.je.Revision<W)return!1}return!0};va.prototype.aLj=function(){var W;if(this.cVa||this.pOc){var Ja={SheetName:this.sheetName,ActiveCell:null===(W=this.activeCell)||void 0===W?void 0:W.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0,SelectedRanges:void 0};this.pOc&&(Ja.SelectedRange=void 0,Ja.SelectedRanges=De.r(this.selectedRanges,this.wb));return Ja}};va.prototype.toString=function(){var W,Ja;
return String.format("active cell: {0} selection: {1}",null!==(Ja=null===(W=this.activeCell)||void 0===W?void 0:W.toString())&&void 0!==Ja?Ja:"null",xh.f(this.selectedRanges,function(Eb){var gc;return null!==(gc=null===Eb||void 0===Eb?void 0:Eb.toString())&&void 0!==gc?gc:"null"}).join(","))};va.prototype.equals=function(W){return W?this.activeCell.equals(W.activeCell)&&De.Q(this.selectedRanges,W.selectedRanges)&&this.sheetName===W.sheetName:!1};va.prototype.cSh=function(){for(var W=Cl(this.selectedRanges.entries()),
Ja=W.next();!Ja.done;Ja=W.next()){var Eb=Cl(Ja.value);Ja=Eb.next().value;Eb=Eb.next().value;if(null===Eb||void 0===Eb?0:Eb.contains(this.activeCell))return Ja}return-1};Ck.Object.defineProperties(va.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.CG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.X9}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.PWb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.Rkg}},
cVa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(ud.a)(va,"SelectionState",null,[]);var bc=b(219),Rc;(function(W){W[W.none=0]="none";W[W.waitingForAdjusted=1]="waitingForAdjusted";W[W.invalid=2]="invalid";W[W.nonContinuous=3]="nonContinuous";W[W.noAdjustRequired=4]="noAdjustRequired";W[W.waitingForViewport=5]="waitingForViewport";W[W.adjusted=6]="adjusted";W[W.divergence=7]="divergence";W[W.differentSheetAdjust=8]="differentSheetAdjust";W[W.exception=
9]="exception"})(Rc||(Rc={}));Object(ud.b)("SelectionAdjustState",Rc);var Nc=b(950);xa.prototype.akj=function(W){function Ja(){Eb.RGi()}var Eb=this,gc=null,Yc=null;this.vcf()?(this.cZ.parallel++,Rb.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : {0}",!!this.oC)):(gc=function(vd,fe){Eb.SGi(vd,fe)},Yc=this.Osj());return null===W||void 0===W?void 0:W(Yc,gc,Ja)};xa.prototype.coi=function(){return!this.vcf()&&
this.Bva().cVa};xa.prototype.Osj=function(){Rb.ULS.shipAssertTag(525135961,0,0===this.EF,"SelectionAdjustManager.setPreRequestState: unexpected state");this.oC&&(this.cZ.errors++,Rb.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: {0}",this.oC.toString()));this.oC=null;this.$C=this.Bva();var W=null,Ja=this.$C.aLj();Ja&&(W={ActiveSheetName:this.$C.sheetName,SheetViewportStateChanges:[Ja]});this.EF=1;return W};xa.prototype.RGi=
function(){Rb.ULS.shipAssertTag(525135960,0,1===this.EF,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.cZ.errors++;this.EF=2;this.Vr()};xa.prototype.SGi=function(W,Ja){try{Rb.ULS.shipAssertTag(525135959,0,1===this.EF,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.pzc=Ja,Ja=2,this.$C?W?(this.oC=this.rwj(W))?(Ja=5,this.oDb||this.$C.cVa)?this.$C.equals(this.oC)?(this.cZ.adjustedDidntChange++,Ja=4):this.$C.sheetName!=this.oC.sheetName&&(this.cZ.differentSheetAdjust++,
Ja=8):(this.cZ.nonContinuous++,Ja=3):this.cZ.errors++:(this.cZ.errors++,Rb.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",this.$C.toString())):(this.cZ.errors++,Rb.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===W||void 0===W?void 0:W.ActiveCell,null===W||void 0===W?
void 0:W.SelectedRange)),this.EF=Ja}catch(Eb){this.EF=9,Rb.ULS.sendTraceTag(525135958,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",Eb)}finally{5!=this.EF?this.Vr():this.gYc(!1,!0)}};xa.prototype.dispose=function(){this.gridView.Ea.Fv(this.Qi);this.gridView.Ea.Wq(this.W9a);this.gridView.Ea.GQf(this.W9a);this.gridView.Ea.Kbb(this.W9a)};xa.prototype.vcf=function(){return 1===this.EF||5===this.EF};xa.prototype.rwj=function(W){var Ja=this,Eb,gc;if(!function(){var vd=De.Z(W.ActiveCell,
Ja.$.xa);Eb=vd.range;return vd}().returnValue)return Rb.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",W.ActiveCell),null;var Yc=[];if(this.oDb)if(W.SelectedRanges)Yc=De.g(W.SelectedRanges.Ranges);else return Rb.ULS.sendTraceTag(522826913,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null"),null;else{if(!function(){var vd=De.Z(W.SelectedRange,Ja.$.xa);gc=vd.range;return vd}().returnValue)return Rb.ULS.sendTraceTag(537155410,
0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",W.SelectedRange),null;Yc.push(gc)}return new this.SXf(this.$,Eb,Yc,W.SheetName,this.$C.activeItemName)};xa.prototype.Bva=function(){var W=this.$.qa;if((null===W||void 0===W?0:W.activeCell)&&W.selectedRanges&&W.sheetName)return new this.SXf(this.$,W.activeCell,W.selectedRanges,W.sheetName,this.$.activeItemName);Rb.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",
!W,!(null===W||void 0===W?0:W.activeCell),!(null===W||void 0===W?0:W.selectedRanges),!(null===W||void 0===W?0:W.sheetName));return null};xa.prototype.gYc=function(W,Ja){if(this.umi(W))if(xd.EwaSettings.isChangeGateEnabled("OfficeVSO:6280340_preventRecursionOfAttemptAdjustSelection")&&6===this.EF)Rb.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{Ja&&Rb.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");
try{if(Rb.ULS.shipAssertTag(525135956,0,5===this.EF,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.$C.equals(this.Bva())){W=0;if(this.oDb&&(W=this.oC.cSh(),-1==W)){this.cZ.errors++;Rb.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange");return}this.cZ.adjusted++;this.EF=6;this.gridView.bW(this.oC.selectedRanges,W,this.oC.sheetName,null,this.oC.activeCell,null,null,0,yc.a.Vmj)}else this.cZ.divergence++,this.sfj(),this.EF=
7}catch(Eb){this.EF=9,Rb.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",Eb)}finally{this.Vr()}}};xa.prototype.umi=function(W){if(!this.oC)return!1;if(!this.$C)return Rb.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",this.oC.toString()),!1;if(W||this.iJj){if($d.g(this.$).Ea.vqf<this.pzc)return!1;(this.oDb||this.$C.cVa)&&Rb.ULS.sendTraceTag(528590295,
0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.$C.cVa&&!this.oDb||!this.$C.zgg(this.pzc)||!this.oC.zgg(this.pzc))return!1;return!0};xa.prototype.Vr=function(){var W,Ja,Eb,gc;this.agj&&2!=this.EF&&Rb.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}",null!==(Ja=null===(W=this.$C)||void 0===W?void 0:W.toString())&&void 0!==Ja?Ja:"null",null!==(gc=null===(Eb=
this.oC)||void 0===Eb?void 0:Eb.toString())&&void 0!==gc?gc:"null",Rc[this.EF]);this.$C=this.oC=null;this.EF=0};xa.prototype.sfj=function(){var W=this.Bva();Rb.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.$C.toString(),W?W.toString():"",this.oC.toString(),this.$C.sheetName===this.oC.sheetName,this.$C.sheetName===(W?W.sheetName:null))};Ck.Object.defineProperties(xa.prototype,
{SXf:{configurable:!0,enumerable:!0,get:function(){return va}},cZ:{configurable:!0,enumerable:!0,get:function(){return Nc.a.aD(this.wBi)?this.J2d:this.I2d}}});Object(ud.a)(xa,"SelectionAdjustManager",null,[626,2]);var id=Mi.a;Am(ka,id);ka.prototype.c_b=function(W){this.nga.c_b(W)};ka.prototype.ytc=function(W){this.nga&&this.nga.ytc(W)};ka.prototype.eAa=function(W,Ja){this.lDa.eAa(W,Ja)};ka.prototype.MYd=function(W){this.lDa.MYd(W)};ka.prototype.nPa=function(W,Ja){this.zXa.nPa(W,void 0===Ja?"":Ja)};
ka.prototype.dispose=function(){this.jfc&&(this.jfc.dispose(),this.jfc=null);this.LAa&&this.LAa.dispose();this.Z1a.dispose();this.yLd&&(this.yLd.dispose(),this.yLd=null);this.nga&&(this.nga.dispose(),this.nga=null);this.zXa.dispose();this.zXa=null;this.lDa.dispose();this.lDa=null;this.b0a&&(this.b0a.dispose(),this.b0a=null);this.X5a&&(this.X5a.dispose(),this.X5a=null);this.$=null;id.prototype.dispose.call(this)};ka.prototype.hHb=function(){this.nga.d5i()};ka.Bac=function(W){var Ja=0;W=Cl(W);for(var Eb=
W.next();!Eb.done;Eb=W.next()){Eb=Eb.value;if(2==Eb)return 2;1==Eb&&(Ja=1)}return Ja};ka.prototype.gai=function(W,Ja){this.lDa=new Oa(this.Z1a,this.zXa);Ja?Object(oh.a)(wb,Ja)?this.eAa(Ja,Object(Sb.a)(wb,Ja).nI):Object(oh.a)(pc,Ja)?this.eAa(Ja,Object(Sb.a)(pc,Ja).nI):this.eAa(Ja,0):(this.b0a=new pc(W),this.X5a=new wb(W),this.eAa(this.b0a,this.b0a.nI),this.eAa(this.X5a,this.X5a.nI))};Ck.Object.defineProperties(ka.prototype,{kia:{configurable:!0,enumerable:!0,get:function(){return this.lDa}},Kma:{configurable:!0,
enumerable:!0,get:function(){return this.zXa}},v6:{configurable:!0,enumerable:!0,get:function(){return this.nga}}});Object(ud.a)(ka,"MergeSuspensionManager",Mi.a,[594,2]);var xe=Gg.a;Am(ha,xe);ha.prototype.create=function(){Rb.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Eb(this.Rc.da.Aa(343)||this.Rc.da.Ga(343,new ka(this.Rc,nh.a.instance)))};ha.ka=function(W){Rb.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");W.da.Ga(344,new ha(W))};Object(ud.a)(ha,"MergeSuspensionFactory",
Gg.a,[]);na.uti=3;na.connected=0;Object(ud.a)(na,"ConnectionStateConstants",null,[]);var cf=b(111),ag=b(117),tf=b(43);aa.prototype.RZf=function(){this.durationMs=ag.a(ma.a.Ta,this.startTime)};aa.prototype.lCd=function(W){var Ja=this,Eb;this.RZf();tf.a(W).utc(this.rvf);tf.a(W).tg.vtc(this.Vca);W.da.$a(291,function(gc){gc.Mbb(Ja.PW)});if(null===(Eb=W.ea)||void 0===Eb?0:Eb.sf)W.ea.sf.HKd(this.fDd),this.wasUserActiveOnPIEnd=W.ea.sf.vr};aa.prototype.Ek=function(W){var Ja=this;tf.a(W).UZb(this.rvf);this.isToastShown?
this.toastRaiser="Immediate":tf.a(W).tg.dWc(this.Vca);W.da.$a(291,function(Eb){Ja.hasTabbedOut=Eb.Bi;Eb.fGa(Ja.PW)});this.wasUserActiveOnPIStart&&W.ea.sf.upe(this.fDd)};Object(ud.a)(aa,"PartialInteractivityData",null,[]);var rg=b(1278);Am(fa,aa);fa.prototype.hJi=function(W,Ja){this.swappedByOffline=Ja;this.lCd(W)};fa.prototype.Mqj=function(W){this.errorDataDuringConnectivityIssuesMode=W};fa.prototype.x7i=function(W){10>this.failedRequests.length&&(W=W+"_"+cf.getElapsedSeconds(this.startTime,ma.a.Ta.Wb).toString(),
this.failedRequests.push(W))};Object(ud.a)(fa,"ConnectivityIssuesData",aa,[]);var ch=b(178);U.fjh="DuringWork";U.connectivityIssues="ConnectivityIssues";U.offline="Offline";Object(ud.a)(U,"UnavailabilityTypes",null,[]);L.prototype.dispose=function(){this.$&&(tf.a(this.$).tg.PQf(this.Ewf),this.$.qf&&this.$.qf.OQf(this.Bwf));this.data&&this.$.na.qf.KRf(this.Wn);this.$=null};L.prototype.XTg=function(W){var Ja=this.zad-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Ja-1)+W)/Ja};Object(ud.a)(L,
"ConnectivityIssuesTelemetryManager",null,[2]);var Hg=b(1058),ri=b(1321),wh=b(1277);H.prototype.dispose=function(){this.$&&(this.YRd&&this.$.na&&0<this.A9a.count&&this.$.na.Dr(this.Th),this.ZRd&&(this.RUd("Dispose"),this.$.ea.sf.nAa(this.Uca)))};H.prototype.L$h=function(){xd.EwaSettings.ma(213)&&this.s0i();this.ZRd&&this.t0i()};H.prototype.hai=function(){this.SDb=this.TDb;this.std=0;var W={};if(!this.A9a){this.A9a=new we.a;var Ja=ri.a.sdd(this.$fj,"InitSampleMeasurement",this.$);Ja=Cl(Ja);for(var Eb=
Ja.next();!Eb.done;Eb=Ja.next())Eb=Eb.value,W[Eb.jld]=Eb.baseUrl,this.A9a.add(Eb)}W=Sys.Serialization.JavaScriptSerializer.serialize(W);Rb.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.TDb,this.SDb,W);0<this.A9a.count&&this.$.na.Bq(this.Th)};H.prototype.OFj=function(){for(var W=Cl(this.A9a),Ja=W.next();!Ja.done;Ja=W.next())Ja.value.runTest()};H.prototype.yUd=function(W){this.VSa&&
this.VSa.yp||(Rb.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",W),this.VSa=nh.a.instance.GC(this.xnj,5E3,fh.a.IDj),this.VSa.Rka())};H.prototype.RUd=function(W){this.VSa&&this.VSa.yp&&(Rb.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",W),this.VSa.cancel())};H.prototype.Txj=function(W){return this.SDb>=this.TDb&&W-this.std>this.Fxd};H.prototype.BXg=function(){return H.YUf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};
H.prototype.s0i=function(){this.TDb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.Fxd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var W=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.TDb&&0<this.Fxd&&(this.YRd=H.YUf(W))&&this.hai()};H.prototype.t0i=function(){if(!this.Tyc){this.Tyc=new we.a;var W=ri.a.sdd(this.ofj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[wh.a.AEc]);W=Cl(W);for(var Ja=W.next();!Ja.done;Ja=W.next())this.Tyc.add(Ja.value);this.$.ea.sf.vr&&
this.yUd("PrepareAndInitSlowNetworkTests")}};H.YUf=function(W){return 100*Math.random()<W};Object(ud.a)(H,"NetworkMeasurement",null,[2]);var th=b(993);I.prototype.ERj=function(){this.hV&&this.hV.RZf()};I.prototype.HCg=function(W){this.allOfflinePartialInteractivitiesDataInSession.push(W);this._count++};Ck.Object.defineProperties(I.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},hV:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}}});Object(ud.a)(I,"OfflinePartialInteractivitiesDataForLog",null,[]);Am(ca,aa);ca.prototype.muj=function(W){this.timeFromLastOffline=W};ca.prototype.Nqj=function(W){this._errorDataDuringOfflineMode=W};Object(ud.a)(ca,"OfflinePartialInteractivityData",aa,[]);Z.prototype.dispose=function(){this.$&&tf.a(this.$)&&tf.a(this.$).tg.nKd(this.v$a);Jh.a.Ha(this.Gub);this.$=this.Gub=null};Z.prototype.kQi=function(W){this.hV=new ca(ma.a.Ta.Wb,this.$,0!==W);this.hV.muj(-1!==this.aGd?window.performance.now()-
this.aGd:-1);this.WOa.HCg(this.hV);tf.a(this.$).tg.dWc(this.Vca);this.p3a();this.Gub=nh.a.instance.GC(this.p3a,Z.hEh,fh.a.p3a);ch.a(this.$).LVc(this.eWf)};Z.prototype.lQi=function(){this.hV.lCd(this.$);this.p3a();Jh.a.Ha(this.Gub);this.Gub=null;this.aGd=window.performance.now();tf.a(this.$).tg.vtc(this.Vca);ch.a(this.$).bKd(this.eWf);this.pfj()};Z.prototype.Ukj=function(W,Ja){var Eb=this;this.$?this.Kkf=Nd.TaskExtensions.Ba(this.Kkf,function(){Eb.indexedDB.Kcb(new th.a(W,Ja))},this.$.la):Rb.ULS.sendTraceTag(537155205,
0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};Z.prototype.jfj=function(){var W=this.$.la;Nd.TaskExtensions.Ba(Nd.TaskExtensions.Ba(this.indexedDB.r4a(Z.eEd),this.Qfj,W),this.caj,W)};Z.prototype.pfj=function(){if(this.hV){var W=Sys.Serialization.JavaScriptSerializer.serialize(this.hV);xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Vg.b().oKb(560791645,0,50,U.offline,this.hV.durationMs,
"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",W):Rb.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",W)}xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.hV&&this.hV.isToastShown&&tc.Health.instance.recordQosError(Xc.a.qVj,[Od.a.ekc],!0,!1,!1,!1,null)};Z.lmd="NetworkAvailability";Z.mmd="NetworkAvailabilityData";
Z.eEd="partialInteractivityData";Z.hEh=3E3;Object(ud.a)(Z,"OfflineModeTelemetryManager",null,[2]);ea.prototype.dispose=function(){Jh.a.Ha(this.luf);Jh.a.Ha(this.Gyd);Jh.a.Ha(this.Zla);Jh.a.Ha(this.d2g);this.$=null};Object(ud.a)(ea,"NetworkConnectionTelemetryManager",null,[2]);Am(Q,aa);Q.prototype.v$a=function(){this.wasInteruptedByOfflineMode=!0};Object(ud.a)(Q,"SilentReopenData",aa,[]);R.prototype.dispose=function(){this.tg.mRf(this.sAf);this.tg.Udj(this.ZDf);this.d8=this.tg=this.$=null};R.prototype.WDf=
function(W,Ja){W.WP?this.d8=new Q(ma.a.Ta.Wb,this.$,0!==W.zoa,Ja):(5===W.zoa&&(this.d8.wasInteruptedByOfflineMode=!0),3!==W.zoa&&2!==W.zoa||Rb.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.d8.lCd(this.$),2===Ja?xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Vg.b().pKb(571289604,0,50,U.offline,this.d8.durationMs,
this.d8):Rb.ULS.sendTraceTag(571289604,0,50,ph.a.Lc(this.d8)):xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Vg.b().pKb(542782150,0,50,U.fjh,this.d8.durationMs,this.d8):Rb.ULS.sendTraceTag(542782150,0,50,ph.a.Lc(this.d8)),this.d8=null)};Object(ud.a)(R,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);var hg=me.a;Am(T,hg);T.prototype.dispose=function(){this.qf&&(this.Gxc&&(this.qf.Ucj(this.ZEb),this.qf.xIb(this.ZAf)),this.qf.OQf(this.Cwf),
this.qf.Gbj(this.Dwf));this.qAb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.oIb(this.Qya),this.qAb=!1);this.$&&(this.vsc&&this.IBc(),this.$.ea&&(this.$.ea.BRf(this.YDf),this.$.ea.sf&&this.$.ea.sf.nAa(this.Uca)));xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.x1&&(this.x1.dispose(),this.x1=null);Jh.a.Ha(this.vsf);this.$=null;hg.prototype.dispose.call(this)};T.prototype.Bzi=function(){this.RRd=!0};T.prototype.fle=function(){this.loa||
(this.loa=tf.a(this.$).tg.MYa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};T.prototype.Xfi=function(){if(this.RRd)return this.RRd=!1,!0;var W=this.n8>this.cof||this.emd>this.cof&&10>this.n8;Rb.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",this.n8,this.emd,W);return W};T.prototype.cgj=function(){xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&
(this.x1=nh.a.instance.create(function(){tc.Health.instance.recordQosError(Xc.a.NDj,[Od.a.ekc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};T.prototype.nAg=function(){var W=this;this.loa||this.m1?Rb.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.m1=
nh.a.instance.create(function(){W.$?W.loa?Rb.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):$d.g(W.$).isEditing?(W.zbb||($d.g(W.$).Ac.To(W.Ng),Rb.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),W.Abb=!0,Rb.ULS.sendTraceTag(537155220,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):W.fle():Rb.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.B5f,fh.a.LCj,void 0,!0)};T.prototype.rrf=function(W){this.O2c=this.xwe(2,W,!0);this.Rpe()};T.prototype.Plc=function(W,Ja){this.GWb=this.xwe(W,Ja,!1);
this.Rpe()};T.prototype.xwe=function(W,Ja,Eb){Eb=Eb?this.O2c:this.GWb;return Ja?Eb|W:Eb&~W};T.prototype.WWd=function(){var W=!!this.XOa,Ja=!!this.RSa,Eb=!!this.loa,gc=!!this.S3b;this.xCb&&!W?this.mAg():!this.xCb&&W&&this.Ach();!this.Pkc||Ja||Eb?this.Pkc||(Ja?this.kHe():(Eb||this.m1&&this.m1.yp)&&this.lHe()):this.H2f&&this.dga?this.kAg():!this.zLb||this.dga||xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.m1||this.nAg();this.Wka&&!gc?this.G$f(!0):
!this.Wka&&gc&&this.G$f(!1)};T.prototype.mAg=function(){this.$?this.XOa?Rb.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):$d.g(this.$).isEditing?(this.Abb||($d.g(this.$).Ac.To(this.Ng),Rb.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.zbb=
!0,Rb.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.ile():Rb.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};T.prototype.ile=function(){this.XOa||(this.XOa=tf.a(this.$).tg.MYa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};T.prototype.Ach=function(){this.XOa&&
(Jh.a.Ha(this.XOa),this.XOa=null)};T.prototype.kHe=function(){this.RSa&&(Jh.a.Ha(this.RSa),this.RSa=null);xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.x1&&this.x1.yp&&this.x1.cancel();this.x1=null};T.prototype.lHe=function(){this.loa&&(Jh.a.Ha(this.loa),this.loa=null);this.m1&&(Jh.a.Ha(this.m1),this.m1=null);this.Abb&&!this.zbb&&$d.g(this.$).Ac.Zn(this.Ng);this.Abb=!1};T.prototype.kAg=function(){this.RSa||(this.RSa=tf.a(this.$).tg.MYa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Bf.a.instance.fa(2137)));this.cgj()};T.prototype.G$f=function(W){W?(this.S3b=tf.a(this.$).tg.MYa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.w3i()):(Jh.a.Ha(this.S3b),this.S3b=null)};T.prototype.w3i=function(){if(this.$&&this.$.na){var W=this.$.na.va.hc();Vd.jb(this.$.na.va,null,null,null,W)}};T.prototype.IBc=function(){vh.a(this.$).gR(og.a.BPa).Xq(this.iBf);this.$.Ul(this.zd);this.vsc=!1};T.prototype.Rpe=function(){this.documentVisibilityObserver||Rb.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Bi?this.qAb||(this.documentVisibilityObserver.Tnb(this.Qya),this.qAb=!0,Rb.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.WWd()};Ck.Object.defineProperties(T.prototype,
{Xhi:{configurable:!0,enumerable:!0,get:function(){return this.dga}},xCb:{configurable:!0,enumerable:!0,get:function(){return!(this.GWb&1)}},Pkc:{configurable:!0,enumerable:!0,get:function(){return!(this.GWb&2)}},Wka:{configurable:!0,enumerable:!0,get:function(){return!!(this.O2c&2)}}});Object(ud.a)(T,"NetworkConnectionStateManager",me.a,[595,2]);var li=Gg.a;Am(M,li);M.prototype.create=function(){var W=this;Nd.TaskExtensions.Ba(Mb.GetServiceTaskFactory.Ua(this.$.da,395,396,this.ub),function(Ja){W.Eb(W.$.da.Aa(400)||
new T(W.$,Ja.result))},this.$.la,3)};M.ka=function(W){W.da.Ga(401,new M(W))};Object(ud.a)(M,"NetworkConnectionStateManagerFactory",Gg.a,[]);var Ni=b(1432),Si=b(1234);A.prototype.dispose=function(){this.kcg();this.scg();this.wtd=this.ltd=this.kL=this.ol=this.xr=this.Jrc=this.$=null;this.i0d=0};A.prototype.OOg=function(W){this.kL=W;this.ltd=W.BIg;this.wtd=W.R7i};A.prototype.RIa=function(){if(this.kL){var W=De.K(this.kL.qzh);this.WDj(W);this.hide();this.kcg();this.kL=null}};A.prototype.WDj=function(W){var Ja=
[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993];xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&W&&(Rb.ULS.sendTraceTag(523622037,0,50,"RecoveryUIController.SmartViewOnPaste: RecoveryUI is being dismissed."),null!=this.oBb&&Ja.includes(this.oBb.command)?(Rb.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. Last command was {0}",
Si.a[this.oBb.command]),this.oBb=null):this.documentHidden?(Rb.ULS.sendTraceTag(523833603,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. User clicked outside of document."),this.documentHidden=!1):$d.g(this.$).Rb.W5(W)?Rb.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered."):$d.g(this.$).Rb.fla(W)?Rb.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered."):
(Ja=Sf.d(this.$.xa.qa),W=new Wg.a(W,Ja),this.oNj(W)))};A.prototype.Ami=function(){return!!this.kL&&this.Jrc.Tii};A.prototype.ZBj=function(W){this.kL?this.show(W):Rb.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};A.prototype.YSh=function(){return this.kL?this.kL.Bsi:null};A.prototype.show=function(W){var Ja=this.kL.KOh();Ja?(this.Jrc.showFloatie(Object(Cg.a)(new Ni.a,{x:Ja.x,y:Ja.y}),this.kL.AKa(),W),this.Ek()):Rb.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};
A.prototype.hide=function(){this.Ami()&&this.Jrc.LC();this.scg()};A.prototype.Ek=function(){if(!this.$6b){var W=$d.g(this.$);W.view.Ts(this.oeg);W.kk.sl(this.uJe);this.ol.ka("blur",this.tgh);this.$.Ka.dGa(this.n0);this.$.xa.zg(this.vJe);(W=this.$.da.Aa(65))&&W.P3&&W.P3.registerForCommentEvents(this.tJe);this.$6b=!0}this.qec||(this.xr.wt(Fg.a.Xb,this.$.domElement,this.onKeyDown,!0),this.xr.wt(Fg.a.Sd,this.$.domElement,this.onKeyUp,!0),this.qec=!0)};A.prototype.kcg=function(){if(this.$6b){var W=$d.g(this.$);
W.view.Yq(this.oeg);W.kk.kl(this.uJe);this.ol.detach("blur");this.$.Ka.RQa(this.n0);this.$.xa.Vg(this.vJe);(W=this.$.da.Aa(65))&&W.P3&&W.P3.unregisterForCommentEvents(this.tJe);this.$6b=!1}};A.prototype.scg=function(){this.qec&&(this.xr.Ft(Fg.a.Xb,this.$.domElement,this.onKeyDown,!0),this.xr.Ft(Fg.a.Sd,this.$.domElement,this.onKeyUp,!0),this.qec=this.S_=this.D9b=!1)};A.prototype.wTj=function(){this.kL&&250<=ma.a.Ta.oe.m-this.i0d&&this.show(-1)};A.prototype.oNj=function(W){Nd.TaskExtensions.Ba(Mb.GetServiceTaskFactory.Ua(this.$.da,
426,427,1),function(Ja){Ja.result.Oea(W,"Paste");Rb.ULS.sendTraceTag(523622036,0,50,"RecoveryUIController.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},this.$.la,3)};Object(ud.a)(A,"RecoveryUIController",null,[540,2]);var sj=Gg.a;Am(C,sj);C.prototype.create=function(){var W=this;if(xd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1))this.ODi();else{var Ja=this.$;Ja.WC(function(Eb){Eb.mfc().then(function(gc){W.Eb(W.$.da.Aa(406)||new A(Ja,
gc,ci.KeyInputManager.instance,Ag.a.instance.PE()))})})}};C.prototype.ODi=function(){var W=this,Ja=this.$,Eb=this.$.da.Aa(406);Eb?this.Eb(Eb):Ja.WC(function(gc){gc.mfc().then(function(Yc){Eb=new A(Ja,Yc,ci.KeyInputManager.instance,Ag.a.instance.PE());W.$.da.Ga(406,Eb);W.Eb(Eb)})})};C.ka=function(W){W.da.Ga(405,new C(W))};Object(ud.a)(C,"RecoveryUIControllerFactory",Gg.a,[]);var Bj=b(732),ih=b(611),xi=b(42),uj=b(1251),Cj=Rd.a;Am(v,Cj);v.prototype.validate=function(){this.Lj.dF||Rb.ULS.sendTraceTag(25798091,
322,10,"UploadFrame.FileInputElement is null");return this.Lj.dF.value?!0:(v.cA(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};v.prototype.BLi=function(W){this.swg&&(this.Lj=this.a1f(W,this.TXb))};v.prototype.KUi=function(){this.Lj&&this.Lj.dF&&(this.D7d||(this.Lj.F9i(Object(qb.a)(this,this.jBd,"onFileChosen")),this.D7d=!0),this.Lj.PTe())};v.prototype.jBd=function(W){this.HXa.uploadStatusLabel=W;this.tOb(this.titleText,Object(qb.a)(this,this.Efc,"insertDialogHandler"),this.HXa)};v.prototype.Efc=
function(W){1===W&&this.isEnabled()?v.Hu&&this.Lj.dF&&!this.Lj.dF.value?(this.HXa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.tOb(this.titleText,Object(qb.a)(this,this.Efc,"insertDialogHandler"),this.HXa)):(this.Sxb(),this.TXb.finalizeUpload(this.Lj,Object(qb.a)(this,this.dispose,"dispose"))):0===W&&this.hide()};v.prototype.b1f=function(){this.bJc=!1;this.Lj=this.a1f(document.getElementById("uploadFrameContainer"),this.TXb);Vc.AFrameworkApplication.ga.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.Yga=Object(qb.a)(this,this.dDd,"onUploadFrameLoad"),xi.a.addHandler(this.Lj.iFrame,"load",this.Yga));this.Lj.dF||Rb.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.iKf()};v.prototype.dDd=function(){this.iKf()};v.prototype.iKf=function(){if(this.Lj&&!this.bJc){var W=this.Lj.dF;W&&(xi.a.addHandler(W,Fg.a.Xb,Object(qb.a)(this,this.onKeyDown,"onKeyDown")),W=[W],this.fn=W.concat.apply(W,this.fn),this.Xdg(),this.bJc=!0)}};v.prototype.dispose=function(){if(this.Lj&&!v.Hu){var W=
this.Lj.dF;W&&xi.a.removeHandler(W,Fg.a.Xb,Object(qb.a)(this,this.onKeyDown,"onKeyDown"));this.Yga&&xi.a.removeHandler(this.Lj.iFrame,"load",this.Yga)}this.Lj=null;Cj.prototype.dispose.call(this)};v.prototype.Xdg=function(){if(0<this.fn.length){var W=new uj.a(this.fn),Ja=yg.FocusManager.instance().iR();Ja&&(this.fn[0].focus(),Ja.gf=W,Ja.a0=!0)}};v.prototype.onKeyDown=function(W){4!==yg.FocusManager.instance().kKf(W)&&W.preventDefault()};v.cA=function(W){var Ja=document.getElementById("errorText");
Ja.innerText=W;Ja.style.display="inline-block"};Ck.Object.defineProperties(v.prototype,{RUj:{configurable:!0,enumerable:!0,get:function(){return this.TXb}}});Ck.Object.defineProperties(v,{Hu:{configurable:!0,enumerable:!0,get:function(){return Vc.AFrameworkApplication.sa.Pa.wv&&Vc.AFrameworkApplication.sa.Pa.ahf}}});Object(ud.a)(v,"InsertFileDialog",Rd.a,[]);Ck.Object.defineProperties(B,{gg:{configurable:!0,enumerable:!0,get:function(){return Rd.a.hp(B.yk,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});
B.yk="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(ud.a)(B,"InsertImageDialogHtml",null,[]);Am(u,v);u.prototype.validate=function(){this.Lj.dF||Rb.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var W=Object(Sb.a)(pb,this.RUj),Ja=W.Ufg(this.Lj.dF.value);
return 0!==Ja?(v.cA(W.d_e(Ja)),!1):!0};Ck.Object.defineProperties(u.prototype,{pYb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},wfh:{configurable:!0,enumerable:!0,get:function(){return B.gg}}});Object(ud.a)(u,"InsertImageDialog",v,[]);var Vh=b(617),yj=b(204),yi=b(494);x.prototype.abf=function(){this.ZD=Kc.a.create().toString();this.fra?this.Y8c():
this.yre()};x.prototype.$4g=function(W){this.ho=document.createElement("iframe");this.ho.className=W;this.ho.id=W;this.g8d&&(this.ho.style.visibility="visible",this.ho.style.height="30px",this.ho.setAttribute("frameborder","0"));this.Yga=Object(qb.a)(this,this.dDd,"onUploadFrameLoad");xi.a.addHandler(this.ho,"load",this.Yga)};x.prototype.t7b=function(W){var Ja=this;W=void 0===W?null:W;Vc.AFrameworkApplication.sa.Kqc();if(!this.fr)return Rb.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";
xi.a.addHandler(this.fr,"change",function(){Ja.YAh(W)});t(Object(qb.a)(this,this.PTe,"fileInputClick"),1,"DoFileOpenDialog");return this.fr.value};x.prototype.YAh=function(W){W&&W(this.fr.value)};x.prototype.ZAh=function(){this.OSb&&(this.OSb.innerText=this.p0e())};x.prototype.F9i=function(W){var Ja=this;xi.a.addHandler(this.fr,"change",function(){W(Ja.p0e())})};x.prototype.p0e=function(){var W=null;if(this.fr.value){var Ja=this.fr.value,Eb=Ja.lastIndexOf("\\");0<Eb&&(W=Ja.substring(Eb+1,Ja.length))}return W?
W:""};x.prototype.PTe=function(){try{Rb.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.fr.click()}catch(W){throw Rb.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",W.message),W;}};x.prototype.XGj=function(){this.yni()?this.X7f():(this.XZd(),this.Ks.submit())};x.prototype.yni=function(){return(this.rrg||this.fra)&&!(void 0===window.self.FormData||null===window.self.FormData)};x.prototype.pYf=function(W){if(W){var Ja=
this.NDe();this.Qg=new XMLHttpRequest;this.Qg.open("POST",Ja);this.Qg.setRequestHeader("X-CorrelationId",this.ZD);this.Avi(W);this.Qg.onreadystatechange=Object(qb.a)(this,this.dpa,"uploadResponseReceived");this.Qg.send(W)}};x.prototype.Avi=function(W){if(!ug.a.vB&&W.get){var Ja=W.get("ImageId");W=window.self.navigator;var Eb={};Ja=(Eb.CorrelationId=this.ZD,Eb.Canary=Vc.AFrameworkApplication.canary,Eb.ImageNodeId=Ja,Eb);W&&(W=W.connection?W.connection:W.mozConnection?W.mozConnection:W.webkitConnection?
W.webkitConnection:null)&&(Ja.effectiveType=W.effectiveType,Ja.downlink=W.downlink,Ja.type=W.type,Ja.rtt=W.rtt);Rb.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ja)}};x.prototype.X7f=function(){try{this.XZd();Rb.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var W=new (Type.parse("FormData"))(this.Ks);this.pYf(W)}catch(Ja){Rb.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+
Ja.message),this.H$a(null)}};x.prototype.W7f=function(W){try{if(this.XZd(),Rb.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.aWj(W)){this.PSb=W;this.Ks.contains(this.fr)&&this.Ks.removeChild(this.fr);var Ja=new (Type.parse("FormData"))(this.Ks);Ja.append("applicationfileInput",W.blob,W.filename);this.pYf(Ja)}else this.H$a(null)}catch(Eb){Rb.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Eb.message),
this.H$a(null)}};x.prototype.aWj=function(W){return W&&void 0!==W.blob&&null!==W.blob&&void 0!==W.filename&&null!==W.filename&&""!==W.filename?void 0===window.self.FormData||null===window.self.FormData?(Rb.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(W=W?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===W.blob||null===W.blob,void 0===W.filename||null===W.filename||""===W.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",
Rb.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",W)),!1)};x.prototype.dpa=function(){if(4===this.Qg.readyState)if(200===this.Qg.status){Rb.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.ZD);var W=this.Qg.getResponseHeader("X-NewKey"),Ja=this.Agi(this.Qg),Eb=!1;if(void 0!==W&&null!==W&&Ja&&(Eb=this.SVj(W),!this.pTc&&Eb)){Rb.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",
this.ZD);this.pTc=!0;void 0!==this.PSb&&null!==this.PSb?this.W7f(this.PSb):this.X7f();return}Rb.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.pTc,Ja,!(void 0===W||null===W),Eb,this.ZD);this.H$a(this.Qg.responseText)}else Rb.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Qg.status,this.Qg.responseText?
!1:!0,this.ZD),this.H$a(null)};x.prototype.Agi=function(W){try{var Ja=Af.a(W.responseText).Responses;if(void 0!==Ja&&null!==Ja&&1===Ja.length){var Eb=Ja[0];if(void 0!==Eb&&null!==Eb&&2===Eb.length&&28===Eb[1].StatusCode)return!0}}catch(gc){}return!1};x.prototype.SVj=function(W){yi.a.cdg(W);return Vc.AFrameworkApplication.canary!==W?!1:!0};x.prototype.XZd=function(){this.qTc||(this.qTc=new Date)};x.prototype.dispose=function(){this.Cm||(this.fra?this._parent.removeChild(this.Ks):(this._parent.removeChild(this.ho),
xi.a.removeHandler(this.ho,"load",this.Yga),this.Yga=null),this.aJc&&(xi.a.removeHandler(this.fr,"change",this.aJc),this.aJc=null),this.QTe&&(this.Yib&&(xi.a.removeHandler(this.fr,"change",this.Yib),this.Yib=null),this.OSb=null),this.fr=this.Ks=this._parent=this.ho=null,this.Cm=!0,this.qTc=null,Rb.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};x.prototype.delayedDispose=function(){this.dispose()};x.prototype.D7g=function(W){if(this.Ks){var Ja;(Ja=this.Ks.querySelector("input[name=__REQUESTDIGEST]"))?
Ja.value=W:(Ja=this.v4c(),Ja.type="hidden",Ja.id="__REQUESTDIGEST",Ja.name="__REQUESTDIGEST",Ja.value=W,this.Ks.appendChild(Ja))}};x.prototype.v4c=function(){return this.fra?document.createElement("input"):this.ho.contentWindow.document.createElement("input")};x.prototype.dDd=function(){try{if(!this.ho.contentWindow.document.body)return}catch(gc){this.R5h();return}if(!(this._initialized||this.v9a&&ug.a.CF))this.Y8c();else if(!this.v9a||!ug.a.CF||this.zki){var W=ug.a.xf?this.ho.contentWindow.document.body.innerText:
this.mfg?this.ho.contentWindow.document.body.firstChild.innerText:this.ho.contentWindow.document.body.firstChild.innerHTML;var Ja=this.ho.contentWindow.document.body.innerText.toLowerCase(),Eb=0<=Ja.indexOf("responses")||0<=Ja.indexOf("wopisrc");Ja=0<=Ja.indexOf("http error");!Eb&&Ja&&Rb.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.ho.contentWindow.document.body.innerText);this.H$a(W)}};x.prototype.Y8c=function(){if(!this._initialized){var W=this.fa("uploadForm"),
Ja=this.fa("fileInput"),Eb=this.NDe();this.j7g();this.Ks.id=W;this.Ks.method="post";this.Ks.encoding="multipart/form-data";this.Ks.action=Eb;this.fr.type="file";this.j2d&&(this.fr.accept=this.j2d,this.h4d&&(this.fr.capture=this.h4d));this.fr.id=Ja;this.fr.name=Ja;this.HJg&&(this.fr.multiple=!0);!this.QTe||ug.a.xf||ug.a.$H||(this.Yib=Object(qb.a)(this,this.ZAh,"fileInputChangedHandleAccessibility"),xi.a.addHandler(this.fr,"change",this.Yib),this.OSb=je.a.ure(this.Ks,this.fr,"InputFileDescription"));
this.g8d&&(this.fra||(W=this.ho.contentWindow.document.body,W.style.margin="0",W.style.overflow="hidden"),W=Vc.AFrameworkApplication.sa,this.fr.style.fontFamily=W.B1,this.fr.style.fontSize=W.xBc,this.fr.style.margin="0");(W=document.getElementById("__REQUESTDIGEST"))&&this.D7g(W.value);this.Ks.appendChild(this.fr);this._initialized=!0;this.Yqg(this)}};x.prototype.j7g=function(){if(this.fra)this.Ks=document.createElement("form"),this._parent.appendChild(this.Ks),this.fr=document.createElement("input");
else{this.Ks=this.ho.contentWindow.document.createElement("form");var W=this.ho.contentWindow.document;W.body.appendChild(this.Ks);this.fr=W.createElement("input")}};x.prototype.yre=function(){this._parent.appendChild(this.ho);this.v9a&&ug.a.CF&&this.Y8c()};x.prototype.NDe=function(){var W=new Xf.QueryStringBuilder(this.VTe);Vc.AFrameworkApplication.VYa(W);this.upj(W);W=W.toString();if(ug.a.Hf||ug.a.CF||ug.a.$H)W=Xg.a.xXe(W);return W};x.prototype.ume=function(){var W=new qi.a(2,1,0,Object(qb.a)(this,
this.delayedDispose,"delayedDispose"),4);Vc.AFrameworkApplication.Ri.Yg(W)};Ck.Object.defineProperties(x.prototype,{nUf:{configurable:!0,enumerable:!0,get:function(){return this.Evg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.rRc}},iFrame:{configurable:!0,enumerable:!0,get:function(){return this.ho}},dF:{configurable:!0,enumerable:!0,get:function(){return this.fr}},v9a:{configurable:!0,enumerable:!0,get:function(){return Vc.AFrameworkApplication.ga?Vc.AFrameworkApplication.ga.ra("NativeFileOpenDialogIsEnabled"):
!1}},QTe:{configurable:!0,enumerable:!0,get:function(){return Vc.AFrameworkApplication.ga?Vc.AFrameworkApplication.ga.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},zki:{configurable:!0,enumerable:!0,get:function(){return this.fra?!1:yj.a(this.ho.contentWindow.location.pathname,this.VTe,0)}},HJg:{configurable:!0,enumerable:!0,get:function(){return!ug.a.vB&&Vc.AFrameworkApplication.ga.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(ud.a)(x,"UploadFrame",null,[2]);Am(r,x);r.prototype.fa=
function(W){return W};r.prototype.upj=function(W){Rb.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Kd.a.iXc(W,this.$.ya);W.i$(Ae.a.sessionId,this.sessionId);var Ja=$d.g(this.$).ha;Ja=De.o(Ja.ta.W4,this.$);W.i$(Ae.a.p3i,this.$.xa.qa.name);W.i$(Ae.a.o3i,Ja.FirstRow.toString());W.i$(Ae.a.n3i,Ja.FirstColumn.toString())};r.prototype.R5h=function(){this.nUf("ServerUploadError")};r.prototype.H$a=function(W){this.nUf(W)};r.Fii=function(W){return!W||Xb.a.equals(W,"ServerUploadError",
!1)};Object(ud.a)(r,"UploadFrameWrapper",x,[]);Am(y,u);y.prototype.a1f=function(W,Ja){return new r(W,Object(qb.a)(Ja,Ja.CFb,"onUploadFrameInitialized"),Object(qb.a)(Ja,Ja.dpa,"uploadResponseReceived"),this.ga,!0,this.$)};y.prototype.dispose=function(){this.LBc();this.uR=this.QCc=null;u.prototype.dispose.call(this)};y.prototype.hide=function(){u.prototype.hide.call(this);this.$.zb.Mz=!1};y.prototype.validate=function(){var W=this.QCc.E_d(this.Lj.dF.value,this.QCc.Yag(this.Lj));return 0!==W?(W=this.QCc.Wed(W).Description,
this.iZd(W),this.hVd(),!1):!0};y.prototype.isEnabled=function(){return!0};y.prototype.iZd=function(W){this.AV.innerHTML=W};y.prototype.Mmd=function(){this.AV=document.getElementById("errorText");this.AV.style.display="inline-block";this.wBa=!1;this.iZd("");this.NIa.style.maxWidth=this.NIa.currentStyle.minWidth};y.prototype.hVd=function(){this.uR.pa(Fg.a.click,this.Lj.dF,this.unc);this.uR.pa(Fg.a.Xb,this.Lj.dF,this.unc);this.wBa=!0};y.prototype.LBc=function(){this.wBa&&(this.uR.za(Fg.a.click,this.Lj.dF,
this.unc),this.uR.za(Fg.a.Xb,this.Lj.dF,this.unc),this.wBa=!1)};Object(ud.a)(y,"InsertImageDialogWrapper",u,[]);Am(h,pb);h.prototype.dispose=function(){Jh.a.Ha(this.y0b);this.Lj&&this.Lj.ume();this.Lj=this.y0b=this.wb=null};h.prototype.J6i=function(W){function Ja(){gc.ox(!0)}var Eb=this;if(!this.$)return Rb.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),ic.Task.Ra(!0);if(!this.$.Uba)return ic.Task.Ra(!0);var gc=new zg.a,Yc=new FileReader;W=W.dF.files[0];Yc.onload=
function(){Eb.EEd=Yc.result;gc.ox(!0)};Yc.onerror=Ja;Yc.onabort=Ja;Yc.readAsDataURL(W);return gc.task};h.prototype.Yag=function(W){var Ja=-1;W=W.dF;(null===W||void 0===W?0:W.files)&&0<W.files.length&&(Ja=W.files[0].size);return Ja};h.prototype.E_d=function(W,Ja){var Eb=h.X3g(pb.qCa(W));0===Eb?-1!==Ja&&(Rb.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ja,this.plc,this.$.ea.Gkf),Ja>this.plc?Eb=3:Ja>this.$.ea.Gkf&&(Eb=7)):6===
Eb&&this.yxi(W);Rb.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",Eb);return Eb};h.prototype.qCa=function(W,Ja){W=this.E_d(W,this.Yag(Ja));return 0!==W?(this.T1a||1===W||this.VSd(W),!1):!0};h.prototype.wag=function(W){W.XGj()};h.prototype.Wed=function(W){var Ja=0,Eb=1,gc=-1100324317,Yc="InsertPictureUnknownError",vd=null;switch(W){case 1:Ja=1718;Eb=0;gc=940870981;Yc="InsertPictureNoFileSelected";break;case 3:Eb=0;gc=1250467391;Yc="InsertPicturePictureTooBig";vd=
String.format(Bf.a.instance.Ab(172),this.Mzi.toLocaleString());break;case 6:Ja=1722;Eb=0;gc=1380041209;Yc="InsertPictureUnsupportedFormat";break;case 7:Ja=1719;Eb=0;gc=-903115058;Yc="InsertPictureExceedWorkbookSize";break;case 4:Ja=1720;Eb=0;gc=1218352119;Yc="InsertPictureUploadTimeout";break;case 5:Ja=1721,Eb=0,gc=1979899005,Yc="InsertPictureServiceNonDeterministicError"}W=h.gd(Ja,Eb,gc,Yc);vd&&(W.Description=vd);return W};h.prototype.showDialog=function(){this.bxe()?(this.T1a=!1,this.Lj=new r(this.$.domElement,
this.CFb,this.dpa,this.ga,!1,this.$,!0)):(Rb.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.S7a&&(ug.a.vv||ug.a.CF&&72>ug.a.pze)?(this.T1a=!1,this.Lj=new r(this.$.domElement,this.CFb,this.dpa,this.ga,!1,this.$)):(this.T1a=!0,this.Lj=(new y(this,this.$,this.ga)).Lj))};h.prototype.F5h=function(W){var Ja={};try{if(Ja=ph.a.oi(W),Vg.b().QA(this.v0d.id,Ja.ServerCorrelationId,"actions","ServerActions"),!ue.a.rh(Ja.Errors)&&Ja.Result){this.$.ea.bY(Ja.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");
var Eb=Ja.Result;Ei.a(this.$).Dna(1,Eb);var gc=this.$.da.Aa(277);gc&&gc.cVc(this.$,1,Ja.Result,Ja,"InsertPicture");Rb.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Yc){Rb.ULS.sendTraceTag(526399113,0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",W?W.length:-1,Yc)}this.mBc(Ja,null,"InsertPictureWebMethod")};h.prototype.x6e=function(W){W={Errors:[this.Wed(W)]};this.mBc(W,null,"InsertPictureWebMethod")};
h.prototype.mBc=function(W,Ja,Eb){this.At(W,Ja,Eb)};h.prototype.MXd=function(W,Ja,Eb){this.Paa(W,Ja,Eb)};h.prototype.VSd=function(W){W=this.Wed(W);xd.EwaSettings.Kz()?new He.a(this.$,W):(new Pe.ErrorDialog(this.$,W)).kf()};h.prototype.yxi=function(W){var Ja=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;W=Hb.a.Wl(W);for(var Eb=0;Eb<Ja.length;++Eb)if(W.endsWith(Ja[Eb])){Rb.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: {0}",Ja[Eb]);break}};h.eWj=function(W){return!W||
Xb.a.equals(W,Ae.a.insertPictureUnknownError,!0)?2:Xb.a.equals(W,Ae.a.insertPictureNoFileSelectedError,!0)?1:Xb.a.equals(W,Ae.a.ndi,!0)?3:Xb.a.equals(W,Ae.a.odi,!0)?5:0};h.gd=function(W,Ja,Eb,gc){return ue.a.gd(1,0,0,W,Ja,Eb,gc)};h.X3g=function(W){switch(W){case 1:return 1;case 2:return 6}return 0};h.prototype.bxe=function(){return xd.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&!this.S7a&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:
!1};Ck.Object.defineProperties(h.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Mzi:{configurable:!0,enumerable:!0,get:function(){return this.plc/1024/1024}}});Object(ud.a)(h,"BasePictureUploaderWrapper",pb,[2]);Am(w,h);w.prototype.CAj=function(){this.plc=28E5;this.VSd(3)};w.prototype.nbd=function(W){var Ja=this;Rb.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var Eb=new FileReader;W=W.dF.files;if(0==W.length)Rb.ULS.sendTraceTag(526399110,
0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var gc=W[0];Eb.onload=function(){Ja.c$b.stop();Ja.dBh.CTi(Eb.result,Ja);Rb.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:{0}, Size:{1}",gc.type,gc.size.toString())};Eb.onerror=function(){Ja.c$b.stop();Rb.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:{0}, Size:{1}",gc.type,gc.size.toString())};Eb.onabort=function(){Ja.c$b.stop();
Rb.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:{0}, Size:{1}",gc.type,gc.size.toString())};this.c$b.start();Eb.readAsDataURL(gc)}};w.prototype.finalizeUpload=function(W,Ja){this.nbd(W,Ja)};Object(ud.a)(w,"FileReaderUploaderWrapper",h,[569]);n.prototype.getSheetName=function(){return this.sheetName};Object(ud.a)(n,"MacroRecorderPictureInsertedPayload",null,[447]);Am(m,h);m.prototype.nbd=function(W,Ja){var Eb=this;h.prototype.finalizeUpload.call(this,
W,Ja);Hf.a(this.$.userOperationManager,function(gc,Yc){Eb.At=gc;Eb.Paa=Yc;Eb.v0d.start();Eb.y0b.$q();Eb.LAc=!1;Eb.wag(W);return Eb.J6i(W)},function(gc){function Yc(){return new n(fe,Eb.EEd?Eb.EEd:"")}var vd={};Eb.$.Dj(vd);var fe=vd.SheetName;gc=xd.EwaSettings.qc()?new kg.a(510,0,gc,72,Yc):new Td.a(510,0,gc,8,Yc);gc.Una(function(){return!0});gc.Td=Eb.Td;return gc},this.Td)};m.prototype.finalizeUpload=function(W,Ja){this.nbd(W,Ja)};Object(ud.a)(m,"PictureUploaderWrapper",h,[]);Object(ud.a)(f,"UploadBlobParameters",
null,[]);Am(e,m);e.prototype.MXd=function(W,Ja,Eb){m.prototype.MXd.call(this,W,Ja,Eb);this.t1.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.mBc=function(W,Ja,Eb){m.prototype.mBc.call(this,W,Ja,Eb);ue.a.rh(W.Errors)?this.t1.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",ue.a.Xc(W.Errors)))):this.t1.setResult(!0)};e.prototype.wag=function(W){var Ja=
new f(this.$ec.name,this.$ec);W.W7f(Ja)};e.kHh=function(W){var Ja=W.split(",");W=Ja[0].includes("base64")?window.self.atob(Ja[1]):window.self.decodeURI(Ja[1]);Ja=Ja[0].split(":")[1].split(";")[0];for(var Eb=new Uint8Array(W.length),gc=0;gc<W.length;gc++)Eb[gc]=W.charCodeAt(gc);W=new Blob([Eb],{type:Ja});W.name="Image.png";return W};Object(ud.a)(e,"DataUrlUploaderWrapper",m,[]);c.prototype.Wbi=function(W,Ja,Eb,gc,Yc){new m(W,Ja,Eb,gc,Yc,!0)};c.prototype.Vai=function(W,Ja,Eb,gc,Yc,vd){new e(W,null,
Ja,Eb,gc,Yc,vd)};c.prototype.gbi=function(W,Ja,Eb,gc,Yc){new w(W,Ja,Eb,gc,Yc,!0)};Object(ud.a)(c,"UploaderCreator",null,[541]);var Aj=Gg.a;Am(a,Aj);a.ka=function(W){W.da.Ga(485,new a(W))};a.prototype.create=function(){var W;this.Eb(null!==(W=this.$.da.Aa(484))&&void 0!==W?W:this.$.da.Ga(484,new c))};Object(ud.a)(a,"UploaderCreatorFactory",Gg.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
Ne.main();Type.registerNamespace("Common.App.InProductMessaging");ee.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");ne.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(function(){Xh.a.Fa(function(W){xb.ka(W)})})();(function(){Xh.a.Fa(function(W){Ob.ka(W)})})();(function(){Xh.a.Fa(function(){Xh.a.Fa(ec.ka)})})();(function(){Xh.a.Fa(function(){Xh.a.Fa(Ya.ka)})})();(function(){Xh.a.Fa(function(W){lc.ka(W)})})();jg.a.Li(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Xh.a.Fa(ha.ka);Xh.a.Fa(M.ka);(function(){Xh.a.Fa(function(W){C.ka(W)})})();(function(){Xh.a.Fa(function(W){a.ka(W)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/1267e87fe38f5209f64beb69a8093363/EwaDS.pi.js.map