(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1012:function(z,E,b){function a(sa,Fa,Wa,Db,pc,lc,eb,ib,cc,Pa,nc,pb){this.hSc=!1;this.d9=null;this.OG=new ha.a;this.Zhb=1;this.BP=null;this.It=!1;this.SMc=(new Date(0)).getTime();this.die=0;this._clientId=sa;this.MXb=Fa;this.cM=0;this.Eh=Db;this.wHc=ib;this.awg=eb;this.Nkg=cc;this.qng=pc;this.Kpa=lc;this.Yl=Wa;this.Rp=Pa;this.Ee=nc;this.Wg=pb;this.$wg=1>100*Math.random()}function c(sa){return sa?sa.charAt(0).toLocaleUpperCase()+
sa.substring(1,sa.length):sa}function e(sa,Fa,Wa){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",sa,c(Oa[Wa]),c("browser"),Fa)}function f(sa,Fa,Wa,Db,pc,lc,eb,ib,cc,Pa,nc,pb){cc=void 0===cc?null:cc;Pa=void 0===Pa?null:Pa;nc=void 0===nc?null:nc;pb=void 0===pb?null:pb;var rb=M.createInstance(ka.AFrameworkApplication.ga),Ya=ka.AFrameworkApplication.buildVersion?ka.AFrameworkApplication.buildVersion:"1.0",ec=e(sa,Fa,eb,Ya),yd=rb.uZg?b(1366).RealtimeChannelMetrics.createInstance(ec):
new ea,Ub=qa.a.create(pc);rb.rtcJsClientFrequentlyLogsMetrics&&Ub.xFj(rb.Jjj);var Ob="";Ob=cc&&""!==cc?cc:"/rtc2/";Ub.FUe=xa.a.bN(Ob);var Yb=Ob+"signalr";cc=Ob+"findsession";var xb=R.I8h;Ob=new n;nc=nc||Ta.a.getInstance();U.ULS.shipAssertTag(556867617,500,rb.vVf<=b(1012).RealtimeChannel.pqf,"Client attempting to override max payload size beyond absolute limit");var Sa=Math.min(rb.vVf,b(1012).RealtimeChannel.pqf);Ub.oqf=Sa;Ub=new r(rb,new m(Ob),sa,ec,function(Tb){return new T(Tb.createHubProxy(xb))},
ib,nc,yd,Ub,Sa);Pa||(Pa=b(1298).FindSessionStrategy.createInstance(Fa,pc,cc,ib,Ya,eb,sa,ec,nc,lc,Db,pb));Pa.q$b=rb.q$b;Fa=new Z(ec);Wa=Wa?Wa.split(","):null;sa=new (b(1012).RealtimeChannel)(sa,Wa,ec,ib,function(){return $.hubConnection(Yb)},Pa,Ub,Fa,nc,yd,rb,pc);sa.init();return sa}function m(sa){var Fa=this;this.Ee=null;this.vx=!1;this.Za=new ob.a;this.VNc=new ha.a;this.UNc=new ha.a;this.RSc=sa;this.yWa=this.RSc.bFe(function(Wa){return Wa.send()},"GlobalMaxOustandingThrottler");this.yWa.d_b(function(){Fa.Za.raiseEvent("TMUDM")})}
function n(){}function w(sa,Fa){sa=y.call(this,sa,void 0===Fa?"":Fa)||this;sa.n9a=0;sa.ekb=(new Date(0)).getTime();sa.currentTime=function(){return(new Date).getTime()};return sa}function h(sa,Fa){sa=y.call(this,sa,void 0===Fa?"":Fa)||this;sa.LBa=0;sa.h9a=0;sa.Za=new ob.a;sa.UWa=!1;sa.QSc=0;sa.GRb=0;sa.SRb=0;sa.WUb=0;sa.GXb=[];sa.clearTimeout=h.o6c;return sa}function y(sa,Fa){this.Fib=this.Kmb=0;this.ULc=!1;this.pYa=this.DXb=null;this.VWa=!1;this.nhe=sa;this.a$f=void 0===Fa?"":Fa;this.setTimeout=
y.B6c;this.zFa=this.Kmb=this.Fib=0}function r(sa,Fa,Wa,Db,pc,lc,eb,ib,cc,Pa){eb=A.call(this,eb)||this;eb.Nr=null;eb.Jbe=!1;eb.LP=0;eb.sPc=new db.a;eb.Ee=sa;eb.hde=0;eb.ide=0;eb.Lmb=Fa;eb.Lmb.d_b(Object(fa.a)(eb,eb.rUi,"onTooManyUndeliveredMessages"));eb._clientId=Wa;eb.Pug=pc;eb.ph.nHg(Object(fa.a)(eb,eb.pRi,"onRefreshProxyRequired"));eb.ph.lHg(Object(fa.a)(eb,eb.mRi,"onRefreshAllPersistentStateRequest"));eb.ph.EHg(Object(fa.a)(eb,eb.fea,"sendUpdateNotification"));eb.ph.XFg(Object(fa.a)(eb,eb.pOi,
"onInternalPresenceUpdated"));eb.ph.YFg(Object(fa.a)(eb,eb.qOi,"onInternalUpdateNotificationReceived"));eb.ph.WFg(Object(fa.a)(eb,eb.oOi,"onInternalPersistentStateUpdated"));eb.ph.VFg(Object(fa.a)(eb,eb.nOi,"onInternalPersistentStateCleared"));eb.ph.DHg(Object(fa.a)(eb,eb.FOd,"sendPersistentState"));eb.ph.ZHg(Object(fa.a)(eb,eb.Dfb,"updateClientInfo"));eb.Eh=lc;eb.Yl=Db;eb.Rp=ib;eb.bC=cc;eb.Ckb=Pa;eb.mVa=Object(sb.a)(String,ka.AFrameworkApplication.dc.Application)||"";return eb}function x(){this.iSc=
this.Sp=null}function t(sa,Fa,Wa,Db){var pc=ta.call(this)||this;pc.aLd=sa;pc.reconnectDelay=Fa;pc.reason=Wa;pc.tOd=Db;return pc}function u(){this.qce=new B;this.oce=new B}function B(){this.W3d=this.vHc=!1;this.callback=null}function v(sa,Fa){this.kwg=sa;this.LP=void 0===Fa?"":Fa}function C(){this.Presence=null;this.TimeStamp=0}function A(sa){this.Lmb=null;this.Zda=0;this.IJa=!1;this.ph=sa;this.ph.eGa(Object(fa.a)(this,this.OW,"onConnectionStateChanged"))}function M(){this.$Fc=this.k3d=!1;this.YFc=
0;this.dHc=this.HRc=this.GRc=this.uFc=!1;this.fJc=0;this.Ege=!1;this.Dge=this.Cge=0;this.NQc=!1;this.RQc=this.QQc=this.SQc=this.OQc=0}function T(sa){this.Nr=sa}function R(){}function Q(){}function ea(){this.JNf=this.fId;this.MNf=this.iId;this.LNf=this.hId;this.QNf=this.kId;this.PNf=this.jId;this.qId=this.rId;this.nId=this.oId;this.AQa=this.lId;this.BHb=this.mId;this.KNf=this.gId;this.yDb=this.Fyd;this.nmc=this.Hyd}function Z(sa){this.Y9=!1;this.qYa=0;this.xHc=!1;this.setTimeout=Z.B6c;this.clearTimeout=
Z.o6c;this.Bxi=Object(fa.a)(this,this.Twi,"logRtcConnectingUsageStatement");this.Yl=sa}function ca(sa,Fa){this.data=sa;this.timeStamp=Fa}function I(sa,Fa,Wa){this.C9=null;this.HNc=this.mRc=0;this.Ee=Fa;this.rce=Wa;this.gmb=!1;this.ph=sa;this.ph.lZa(Object(fa.a)(this,this.a7i,"receiveMessage"))}function H(sa){this.messageId=sa;this.moj=(new Date).getTime();this.Ktd=new Aa.a}function L(sa,Fa){this.status=sa;this.x8a=Fa}b.r(E);z=b(0);var U=b(14),fa=b(82),aa=b(161),na=b(1203),ha=b(98),ka=b(4);Object(z.a)(L,
"UserStatusInfo",null,[]);var xa=b(80),va=b(634),Aa=b(201);Object(z.a)(H,"MessageLatencyDetails",null,[]);I.prototype.start=function(){if(this.rce&&!this.gmb){var sa=this.Ee.wVf;this.HNc=this.Ee.uVf;sa<=this.HNc?(U.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Ee.wVf,this.Ee.uVf),this.rce=!1):(this.gmb=!0,this.mRc=window.setInterval(Object(fa.a)(this,
this.Jj,"sendMessage"),sa))}};I.prototype.Jj=function(){var sa=this;if(this.gmb){var Fa=va.a.create().toString();this.C9=new H(Fa);this.ph.pHd(16,Fa,!1,new aa.a);window.setTimeout(function(){sa.fwi(Fa)},this.HNc)}};I.prototype.fwi=function(sa){this.C9&&this.C9.messageId===sa&&(0<this.C9.Ktd.count?(sa=this.C9.Ktd.toArray().join(","),U.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",sa)):U.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.C9=null)};I.prototype.stop=
function(){this.mRc&&(window.clearInterval(this.mRc),this.gmb=!1)};I.prototype.a7i=function(sa,Fa){16===Fa.type?this.ph.pHd(17,Fa.z8,!1,new aa.a):17===Fa.type&&this.gmb&&Fa.z8&&this.p2i(Fa.z8)};I.prototype.p2i=function(sa){sa&&this.C9&&sa.toString()===this.C9.messageId&&(sa=(new Date).getTime()-this.C9.moj,this.C9.Ktd.add(sa))};I.Agd=function(sa,Fa,Wa){return I.instance||(I.Ma=new I(sa,Fa,Wa))};Ck.Object.defineProperties(I,{instance:{configurable:!0,enumerable:!0,get:function(){return I.Ma}}});I.Ma=
null;Object(z.a)(I,"ClientToClientMessageTelemetry",null,[]);var qa=b(1143),wa=b(1090);Object(z.a)(ca,"PresenceData",null,[]);Z.prototype.eJi=function(){var sa=this;this.Y9||(this.qYa=this.setTimeout(function(){sa.Y9=!1;sa.Enf()},8E3),this.Y9=!0,this.xHc=!1)};Z.prototype.eKi=function(){this.HM()};Z.prototype.BTi=function(){this.Enf()};Z.prototype.Enf=function(){this.HM();this.xHc||(this.xHc=!0,this.Bxi())};Z.prototype.Twi=function(){U.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",
this.Yl)};Z.prototype.HM=function(){this.Y9&&this.clearTimeout(this.qYa);this.qYa=0;this.Y9=!1};Z.B6c=function(sa,Fa){return window.setTimeout(sa,Fa)};Z.o6c=function(sa){window.clearTimeout(sa)};Object(z.a)(Z,"ConnectedUsageKpiLogger",null,[324]);ea.prototype.fId=function(){};ea.prototype.iId=function(){};ea.prototype.hId=function(){};ea.prototype.kId=function(){};ea.prototype.jId=function(){};ea.prototype.oId=function(){};ea.prototype.mId=function(){};ea.prototype.lId=function(){};ea.prototype.rId=
function(){};ea.prototype.gId=function(){};ea.prototype.Fyd=function(){};ea.prototype.Hyd=function(){};Object(z.a)(ea,"NoopRealtimeChannelMetrics",null,[309,202]);Q.yOb="presenceUpdated";Q.updateNotification="updateNotification";Q.xHf="persistentStateCleared";Q.updatePersistentState="persistentStateUpdated";Object(z.a)(Q,"RtcClientMethodNames",null,[]);R.I8h="realtimeChannelHub";R.yOb="UpdatePresence";R.fea="SendUpdateNotification";R.sed="GetCompletePersistentStateWithMetadata";R.updatePersistentState=
"UpdatePersistentState";R.Dfb="UpdateClientInfo";Object(z.a)(R,"RtcHubMethodNames",null,[]);T.prototype.O9i=function(sa){this.Nr.on(Q.yOb,sa)};T.prototype.o$i=function(sa){this.Nr.on(Q.updateNotification,sa)};T.prototype.M9i=function(sa){this.Nr.on(Q.updatePersistentState,sa)};T.prototype.L9i=function(sa){this.Nr.on(Q.xHf,sa)};T.prototype.eQj=function(sa){this.Nr.off(Q.yOb,sa)};T.prototype.mQj=function(sa){this.Nr.off(Q.updateNotification,sa)};T.prototype.dQj=function(sa){this.Nr.off(Q.updatePersistentState,
sa)};T.prototype.cQj=function(sa){this.Nr.off(Q.xHf,sa)};T.prototype.yOb=function(sa){return this.Nr.invoke(R.yOb,sa)};T.prototype.Dfb=function(sa){return this.Nr.invoke(R.Dfb,sa)};T.prototype.fea=function(sa,Fa){return this.Nr.invoke(R.fea,sa,Fa)};T.prototype.sed=function(sa){return this.Nr.invoke(R.sed,sa)};T.prototype.updatePersistentState=function(sa,Fa){return this.Nr.invoke(R.updatePersistentState,sa,Fa)};Object(z.a)(T,"RealtimeChannelProxy",null,[321,322,323]);M.createInstance=function(sa){var Fa=
b(1012).RealtimeChannel;return sa?Object.assign(new M,{k3d:sa.ra("AwayStatusManagerIsEnabled"),$Fc:sa.ra("AwayStatusOneMinuteTimeoutIsEnabled"),YFc:sa.Cd("AwayCoauthorThresholdMs",9E5),uFc:sa.ra("RtcAllowCrossDomainAccessEnabled"),GRc:sa.ra("ShouldLogOnContentNotification"),HRc:sa.ra("ShouldLogOnHostSubscriptionNotification"),dHc:sa.ra("RtcClientMetricsEnabled"),fJc:sa.Cd("RtcFindSessionRequestTimeoutInMS",6E4),Ege:sa.ra("RtcJsClientFrequentlyLogsMetrics"),Cge:sa.Cd("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),Dge:sa.Cd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),NQc:sa.ra("RtcClientMessageTelemetryEnabled"),OQc:sa.Cd("RtcClientMessageTelemetrySampleSize",5),SQc:sa.Cd("RtcSendTelemetryMessageIntervalInMS",3E5),QQc:sa.Cd("RtcLogClientMessageMetricsTimeOutInMs",2E4),RQc:sa.Cd("RtcMaxPayloadSizeInCharactersOverride",Fa.Uwd)}):Object.assign(new M,{k3d:!1,$Fc:!1,YFc:9E5,uFc:!1,GRc:!1,HRc:!0,dHc:!1,fJc:9E4,NQc:!1,OQc:5,SQc:3E5,QQc:2E4,RQc:Fa.Uwd})};Ck.Object.defineProperties(M.prototype,{bOg:{configurable:!0,
enumerable:!0,get:function(){return this.$Fc}},aOg:{configurable:!0,enumerable:!0,get:function(){return this.YFc}},BJg:{configurable:!0,enumerable:!0,get:function(){return this.uFc}},Oxj:{configurable:!0,enumerable:!0,get:function(){return this.GRc}},Pxj:{configurable:!0,enumerable:!0,get:function(){return this.HRc}},uZg:{configurable:!0,enumerable:!0,get:function(){return this.dHc}},q$b:{configurable:!0,enumerable:!0,get:function(){return this.fJc}},rtcJsClientFrequentlyLogsMetrics:{configurable:!0,
enumerable:!0,get:function(){return this.Ege}},sVf:{configurable:!0,enumerable:!0,get:function(){return this.Cge}},Jjj:{configurable:!0,enumerable:!0,get:function(){return this.Dge}},rtcClientMessageTelemetryEnabled:{configurable:!0,enumerable:!0,get:function(){return this.NQc}},Ejj:{configurable:!0,enumerable:!0,get:function(){return this.OQc}},wVf:{configurable:!0,enumerable:!0,get:function(){return this.SQc}},uVf:{configurable:!0,enumerable:!0,get:function(){return this.QQc}},vVf:{configurable:!0,
enumerable:!0,get:function(){return this.RQc}}});Object(z.a)(M,"RealtimeChannelSettings",null,[320]);var Ta=b(1294),sb=b(83),db=b(394);A.prototype.OW=function(sa,Fa){this.Zda=Fa.newState};A.prototype.rUi=function(){U.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.ph.Erc()};A.prototype.qai=function(sa){this.Lmb.init(sa)};Object(z.a)(A,"ARtcMessageHandler",null,[]);var kb=b(100);Object(z.a)(C,"PresenceDataEntryForClients",null,[]);var ac=b(112);v.prototype.send=
function(){return this.kwg()};Ck.Object.defineProperties(v.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.LP}}});Object(z.a)(v,"MessageHandler",null,[332]);B.prototype.UN=function(sa){this.callback=sa;this.sag()};B.prototype.Wpf=function(sa){this.vHc||(this.vHc=!0,this.mng=sa,this.sag())};B.prototype.sag=function(){this.vHc&&this.callback&&!this.W3d&&(this.W3d=!0,this.callback(this.mng))};Object(z.a)(B,"CompletionTask",null,[]);u.prototype.eoc=function(sa){this.qce.UN(sa)};
u.prototype.doc=function(sa){this.oce.UN(sa)};u.prototype.QCb=function(sa){this.qce.Wpf(sa)};u.prototype.rya=function(sa){this.oce.Wpf(sa)};u.prototype.Nwd=function(){this.QCb(2);this.rya(2)};Object(z.a)(u,"MessageStatus",null,[331]);var ta=Sys.EventArgs;Am(t,ta);Object(z.a)(t,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ra=b(1204);x.prototype.start=function(){this.Sp=new Date};x.prototype.stop=function(){this.iSc=new Date};Ck.Object.defineProperties(x.prototype,{zc:{configurable:!0,enumerable:!0,
get:function(){return this.Sp?this.iSc?this.iSc.getTime()-this.Sp.getTime():(new Date).getTime()-this.Sp.getTime():0}}});Object(z.a)(x,"SimpleStopwatch",null,[]);var Na=b(1205),gb;(function(sa){sa[sa.contentUpdate=0]="contentUpdate";sa[sa.editorsTableUpdate=1]="editorsTableUpdate";sa[sa.fileNameUpdate=2]="fileNameUpdate";sa[sa.wetContentUpdate=3]="wetContentUpdate";sa[sa.persistedContentUpdate=4]="persistedContentUpdate";sa[sa.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";sa[sa.replicationTelemetry=
6]="replicationTelemetry";sa[sa.lockUpdate=7]="lockUpdate";sa[sa.collabServiceContentUpdate=8]="collabServiceContentUpdate";sa[sa.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";sa[sa.saveTargetUpdate=10]="saveTargetUpdate";sa[sa.uploadToOcsUpdate=11]="uploadToOcsUpdate";sa[sa.labelUpdate=12]="labelUpdate";sa[sa.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";sa[sa.subscribeOrExtend=14]="subscribeOrExtend";sa[sa.elapsedBootTelemetry=15]="elapsedBootTelemetry";sa[sa.clientToClientTelemetryMessage=
16]="clientToClientTelemetryMessage";sa[sa.clientToClientResponseMessage=17]="clientToClientResponseMessage";sa[sa.verifyNotificationPipeline=18]="verifyNotificationPipeline";sa[sa.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";sa[sa.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";sa[sa.last=21]="last"})(gb||(gb={}));Object(z.b)("UpdateNotificationType",gb);Am(r,A);r.prototype.pRi=function(sa,Fa){this.Nr=this.Pug(Fa.hubConnection);this.Lmb.reset();this.Nr.O9i(Object(fa.a)(this,this.Ama,
"onPresenceUpdated"));this.Nr.M9i(Object(fa.a)(this,this.voc,"onPersistentStateUpdated"));this.Nr.L9i(Object(fa.a)(this,this.mCd,"onPersistentStateCleared"));this.Nr.o$i(Object(fa.a)(this,this.Wca,"onUpdateNotificationReceived"))};r.prototype.OW=function(sa,Fa){this.Zda=Fa.newState;2===Fa.newState&&this.$nj()};r.prototype.$nj=function(){for(var sa=Cl(this.sPc),Fa=sa.next();!Fa.done;Fa=sa.next())Fa=Fa.value,this.fea(null,new ra.a(Fa.key,Fa.value,!1,new aa.a));this.sPc=new db.a};r.prototype.mRi=function(sa,
Fa){Fa.$0c();for(sa=0;3>sa;++sa)this.Knj(sa,Fa)};r.prototype.Knj=function(sa,Fa){var Wa=this;try{this.Nr.sed(sa).done(function(Db){Fa.hgb(Fa.P2c,"GetCompletePresenceSuccess")&&(Fa.a2g.BTi(),U.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",Wa.Yl),Wa.ph.W4i(),Wa.CQi(sa,Db),Wa.ph.x4i(Db),Fa.FSe.xb(sa)&&Wa.ph.YLf(sa,Fa.FSe.oa(sa),new aa.a))}).fail(function(Db){var pc=b(926).RtcUtils;Fa.hgb(Fa.P2c,"GetCompletePresenceFail")&&(U.ULS.sendTraceTag(3249541,500,15,
"Failed to retrieve complete session state : {0} for [{1}]",pc.UOa(Db),Wa.Yl),Wa.ph.Erc())}).always(function(){Fa.stopwatch&&Fa.stopwatch.stop()})}catch(Db){U.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Fa.P2c,Db.message)}};r.prototype.FOd=function(sa,Fa){var Wa=this,Db=b(926).RtcUtils;sa=Fa.presence;var pc=Fa.Foa;this.bC.oy(1,0);try{var lc=Db.E0c(sa,
this.Ckb)}catch(ib){this.bC.oy(1,3);U.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",ib.message);pc.setException(ib);return}Db=new ha.a;Db.ia(this._clientId,Object.assign(new C,{Presence:sa,TimeStamp:(new Date).getTime()}));this.ph.fMf(Fa.type,Db);if(2!==this.Zda)this.Rp.AQa(),this.bC.oy(1,2),pc.setResult(null);else{var eb=this.LP.toString();++this.LP;sa=new v(function(){return Wa.boj(Fa.type,lc,eb)},eb);sa=this.$9f(0,Fa.type).add(sa);
sa.eoc(function(ib){2===ib&&Wa.bC.oy(1,6);pc.setResult(null)});sa.doc(function(){})}};r.prototype.boj=function(sa,Fa,Wa){var Db=this,pc=null,lc=new x,eb=new u;U.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Yl);if(2!==this.Zda)return this.Rp.AQa(),this.bC.oy(1,2),U.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Yl),eb.Nwd(),eb;this.Eh&&20>this.hde&&(pc=this.Eh.Hc("WebServiceCall","Send Presence Message"),this.hde++);lc.start();
eb.QCb(1);try{this.Nr.updatePersistentState(sa,Fa).done(function(){Db.Rp.nId();Db.bC.oy(1,1);U.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",Wa,Db.Yl);eb.rya(1);lc&&(lc.stop(),lc.zc>Db.Ee.sVf?Db.bC.oy(1,4):Db.bC.oy(1,5))}).fail(function(ib){var cc=b(926).RtcUtils;Db.IJa||(Db.Rp.AQa(),Db.bC.oy(1,3),U.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Wa,cc.UOa(ib),Db.Yl));eb.rya(2)}).always(function(){pc&&
pc.stop()})}catch(ib){U.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",ib.message),this.bC.oy(1,3),eb.rya(2)}return eb};r.prototype.Dfb=function(sa,Fa){var Wa=this;sa=b(926).RtcUtils;var Db=Fa.tZg,pc=Fa.Foa;try{var lc=sa.E0c(Db,this.Ckb)}catch(eb){U.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",eb.message);pc.setException(eb);return}try{this.Nr.Dfb(lc).done(function(){U.ULS.sendTraceTag(544319E3,
500,50,"Successfully delivered clientInfo.")}).fail(function(eb){var ib=b(926).RtcUtils;Wa.IJa||U.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",ib.UOa(eb));pc.setResult(null)})}catch(eb){U.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",eb.message),pc.setResult(null)}};r.prototype.fea=function(sa,Fa){var Wa=this;sa=b(926).RtcUtils;var Db=Fa.type,pc=Fa.z8,lc=Fa.eeh,eb=Fa.Foa;this.bC.oy(0,0);try{var ib=sa.E0c(pc,
this.Ckb)}catch(Pa){this.bC.oy(0,3);U.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Pa.message);eb.setException(Pa);return}if(2!==this.Zda)lc?this.sPc.ia(Db,pc):(this.Rp.AQa(),this.bC.oy(0,2)),eb.setResult(null);else{var cc=this.LP.toString();++this.LP;Fa=new v(function(){return Wa.voj(Db,ib,cc)},cc);Fa=this.$9f(1,Db).add(Fa);Fa.eoc(function(Pa){2===Pa&&Wa.bC.oy(0,6);eb.setResult(null)});Fa.doc(function(){})}};r.prototype.voj=function(sa,
Fa,Wa){var Db=this,pc=null,lc=new x,eb=new u;U.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Yl);if(2!==this.Zda)return this.Rp.AQa(),this.bC.oy(0,2),U.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Yl),eb.Nwd(),eb;this.Eh&&3===sa&&20>this.ide&&(pc=this.Eh.Hc("WebServiceCall","Send WetContent Update"),this.ide++);lc.start();eb.QCb(1);this.Nr.fea(sa,Fa).done(function(){Db.Rp.nId();Db.bC.oy(0,1);U.ULS.sendTraceTag(3249506,
500,50,"Successfully delivered update notification message [{0}] for [{1}]",Wa,Db.Yl);eb.rya(1);lc&&(lc.stop(),lc.zc>Db.Ee.sVf?Db.bC.oy(0,4):Db.bC.oy(0,5))}).fail(function(ib){var cc=b(926).RtcUtils;Db.IJa||(Db.Rp.AQa(),Db.bC.oy(0,3),U.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Wa,cc.UOa(ib),Db.Yl));eb.rya(2)}).always(function(){pc&&pc.stop()});return eb};r.prototype.Vv=function(){this.Nr.eQj(Object(fa.a)(this,this.Ama,"onPresenceUpdated"));
this.Nr.dQj(Object(fa.a)(this,this.voc,"onPersistentStateUpdated"));this.Nr.cQj(Object(fa.a)(this,this.mCd,"onPersistentStateCleared"));this.Nr.mQj(Object(fa.a)(this,this.Wca,"onUpdateNotificationReceived"))};r.prototype.pOi=function(sa,Fa){this.Ama(Fa.jP,Fa.i4)};r.prototype.Ama=function(sa){this.Rp.BHb();this.voc(0,sa)};r.prototype.oOi=function(sa,Fa){this.voc(Fa.type,Fa.jP)};r.prototype.CQi=function(sa,Fa){var Wa={},Db;for(Db in Fa)Wa[Db]=Fa[Db].Presence;this.zBf(sa,Wa,Fa)};r.prototype.voc=function(sa,
Fa){this.Rp.BHb();this.zBf(sa,Fa)};r.prototype.zBf=function(sa,Fa,Wa){Wa=void 0===Wa?null:Wa;var Db=b(926).RtcUtils;if(U.ULS.nea(500,100))for(var pc in Fa);delete Fa[this._clientId];if(!ac.a.isEmpty(Fa)){for(var lc in Fa)pc=lc,Fa[pc]=Db.deserialize(Fa[lc],"Presence",pc,!1,this.Ckb);Db=new ha.a;lc=(new Date).getTime();for(var eb in Fa){pc=Fa[eb];var ib=eb;if(Wa){var cc=Wa[ib];cc.Presence=pc}else cc=Object.assign(new C,{Presence:pc,TimeStamp:lc});Db.ia(ib,cc)}this.ph.fMf(sa,Db);switch(sa){case 0:this.Jbe||
(U.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Yl),this.Jbe=!0,ka.AFrameworkApplication.ag&&ka.AFrameworkApplication.ag.tzi());this.ph.QLf(Fa,[]);break;default:this.ph.Q4i(sa,Fa)}}};r.prototype.nOi=function(sa,Fa){this.mCd(Fa.u1c)};r.prototype.mCd=function(sa){this.Rp.BHb();if(U.ULS.nea(500,100))for(var Fa=0;Fa<sa.length;++Fa);sa.length&&(this.ph.k5i(sa),this.ph.P4i(sa),this.ph.QLf({},sa))};r.prototype.qOi=function(sa,Fa){this.Wca(Fa.type,Fa.z8)};r.prototype.Wca=
function(sa,Fa){Fa=void 0===Fa?null:Fa;this.Ee.Oxj&&0===sa&&U.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===sa){var Wa=ka.AFrameworkApplication.ga.Va("OwningFeatureCrewForRtcNotificationKpis");if(Wa&&0<Wa.length){var Db=new Map;Db.set("AreaName","RealTimeCoauth");Db.set("FeatureName","RtcNotification");Db.set("SkipAria","True");kb.Health.instance.recordKpiUsage("ContentUpdateNotificationReceived",0,Wa,Db)}}this.Ee.Pxj&&13===sa&&U.ULS.sendTraceTag(575221780,
500,50,String.format("Received HostSubscription notification from the server : {0}",Fa||"<none>"));this.Rp.BHb();5===sa?(Fa=(sa=this.TXi(Fa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",sa.reason,sa.reconnectDelay):"Received client reconnection request from the server without params.",U.ULS.sendTraceTag(18637071,500,50,Fa),this.ph.Erc(sa)):(Fa=b(926).RtcUtils.deserialize(Fa,String.format("UpdateNotification-{0}",gb[sa]),null,!1,this.Ckb),this.ph.j5i(sa,
Fa))};r.prototype.TXi=function(sa){try{if(!sa||""===sa)return null;var Fa=JSON.parse(sa);return new t(Fa[Na.a.aNd],Fa[Na.a.Djj],Fa[Na.a.Fjj],Fa[Na.a.tOd])}catch(Wa){return U.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Wa.message),null}};r.prototype.$9f=function(sa,Fa){return this.Lmb.K_h(this.L_h(sa,Fa))};r.prototype.L_h=function(sa,Fa){return sa+","+Fa};Object(z.a)(r,"RtcMessageHandler",A,[]);var ob=b(97);y.prototype.pId=function(){0<this.zFa&&0<this.Fib&&U.ULS.sendTraceTag(36545635,
500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.a$f,this.Fib,this.zFa);0<this.zFa&&0<this.Kmb&&U.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.a$f,this.Kmb,this.zFa)};y.prototype.exc=function(sa,Fa){this.Kmb++;this.Jqb(!0);this.ULc=!0;this.DXb=sa;this.pYa=Fa};y.prototype.Jqb=function(sa){this.ULc=!1;this.pYa&&sa&&(this.Fib++,this.pYa.Nwd());this.pYa=this.DXb=null};y.B6c=function(sa,Fa){return window.setTimeout(sa,Fa)};Ck.Object.defineProperties(y.prototype,
{f7a:{configurable:!0,enumerable:!0,get:function(){return this.ULc}}});Object(z.a)(y,"ThrottlerBase",null,[]);Am(h,y);h.prototype.add=function(sa){this.VWa||this.init(h.PHe,h.IHe);this.zFa++;var Fa=new u;this.f7a?this.exc(sa,Fa):this.WUb<this.h9a?this.iKb(sa,Fa):(this.exc(sa,Fa),this.UWa=!1);return Fa};h.prototype.iKb=function(sa,Fa){var Wa=this;sa=this.nhe(sa);var Db=this.setTimeout(Object(fa.a)(this,this.zPi,"onMessageWaitTimeExpired"),this.LBa);++this.WUb;Array.add(this.GXb,Db);var pc=this.GRb;
sa.eoc(function(lc){Fa.QCb(lc)});sa.doc(function(lc){Wa.GRb===pc&&(Wa.yPi(pc,Db),Fa.rya(lc))})};h.prototype.yPi=function(sa,Fa){this.GRb===sa&&(--this.WUb,this.clearTimeout(Fa),Array.remove(this.GXb,Fa),this.f7a&&this.koj())};h.prototype.koj=function(){this.f7a&&!this.UWa&&(this.QSc=this.setTimeout(Object(fa.a)(this,this.loj,"sendThrottledMessageFromTimer"),0),this.UWa=!0)};h.prototype.loj=function(){this.UWa=!1;if(this.f7a){var sa=this.DXb,Fa=this.pYa;this.Jqb(!1);this.iKb(sa,Fa)}};h.prototype.zPi=
function(){++this.SRb;this.SRb>Math.floor(this.h9a/2)&&(this.SRb=-1E9,this.Za.raiseEvent("TMUDM"))};h.prototype.d_b=function(sa){this.Za.addHandler("TMUDM",sa)};h.prototype.reset=function(){this.zFa=this.Kmb=this.Fib=this.SRb=0;++this.GRb;for(var sa=Cl(this.GXb),Fa=sa.next();!Fa.done;Fa=sa.next())this.clearTimeout(Fa.value);this.WUb=0;this.GXb=[];this.Jqb(!0);this.UWa&&(this.clearTimeout(this.QSc),this.QSc=0,this.UWa=!1)};h.prototype.init=function(sa,Fa){this.VWa||(this.LBa=sa,this.h9a=Fa,this.VWa=
!0)};h.createInstance=function(sa,Fa){return new h(sa,void 0===Fa?"":Fa)};h.o6c=function(sa){window.clearTimeout(sa)};h.PHe=15E3;h.IHe=5;Object(z.a)(h,"MaxOutstandingThrottler",y,[330,329]);Am(w,y);w.prototype.init=function(sa){this.VWa||(this.n9a=sa,this.VWa=!0)};w.prototype.add=function(sa){this.VWa||this.init(w.yHe);this.zFa++;var Fa=this.currentTime(),Wa=new u;this.ekb>Fa&&(this.ekb=Fa);this.f7a?(this.Jqb(!0),this.exc(sa,Wa)):this.ekb+this.n9a<=Fa?this.iKb(sa,Wa):(this.exc(sa,Wa),this.setTimeout(Object(fa.a)(this,
this.joj,"sendThrottledMessage"),this.ekb+this.n9a-Fa));return Wa};w.prototype.joj=function(){if(this.f7a){var sa=this.DXb,Fa=this.pYa;this.Jqb(!1);this.iKb(sa,Fa)}};w.prototype.iKb=function(sa,Fa){this.ekb=this.currentTime();sa=this.nhe(sa);sa.eoc(function(Wa){Fa.QCb(Wa)});sa.doc(function(Wa){Fa.rya(Wa)})};w.createInstance=function(sa,Fa){return new w(sa,void 0===Fa?"":Fa)};w.yHe=200;Object(z.a)(w,"MaxRateThrottler",y,[328,329]);n.prototype.bFe=function(sa,Fa){return h.createInstance(sa,void 0===
Fa?"":Fa)};n.prototype.n8g=function(sa,Fa){return w.createInstance(sa,void 0===Fa?"":Fa)};Object(z.a)(n,"ThrottlerFactory",null,[317]);var wb=b(1206);m.prototype.init=function(sa){this.vx||(this.Ee=sa,this.yWa.init(this.Ee.LBa,this.Ee.k2h),this.vx=!0)};m.prototype.K_h=function(sa){var Fa=this;this.vx||this.init(new wb.a(w.yHe,h.PHe,h.IHe,m.lAi));if(!function(){var lc=Fa.VNc.Nc(sa);pc=lc.value;return lc}().returnValue){if(!function(){var lc=Fa.UNc.Nc(sa);Db=lc.value;return lc}().returnValue){var Wa=
"MaxOutstandingThrottler-"+sa;var Db=this.RSc.bFe(Object(fa.a)(this.yWa,this.yWa.add,"add"),Wa);Db.init(this.Ee.LBa,this.Ee.kAi);Db.d_b(function(){Fa.Za.raiseEvent("TMUDM")});this.UNc.add(sa,Db)}Wa="MaxRateThrottler-"+sa;var pc=this.RSc.n8g(Object(fa.a)(Db,Db.add,"add"),Wa);pc.init(this.Ee.fBi);this.VNc.add(sa,pc)}return pc};m.prototype.reset=function(){for(var sa=Cl(this.VNc),Fa=sa.next();!Fa.done;Fa=sa.next())Fa.value.value.pId();sa=Cl(this.UNc);for(Fa=sa.next();!Fa.done;Fa=sa.next())Fa=Fa.value,
Fa.value.pId(),Fa.value.reset();this.yWa.pId();this.yWa.reset()};m.prototype.d_b=function(sa){this.Za.addHandler("TMUDM",sa)};m.lAi=1E3;Object(z.a)(m,"ThrottlerManager",null,[316]);var Oa;(function(sa){sa[sa.unspecified=0]="unspecified";sa[sa.word=1]="word";sa[sa.excel=2]="excel";sa[sa.powerPoint=3]="powerPoint";sa[sa.test=4]="test";sa[sa.wacFrontEnd=5]="wacFrontEnd";sa[sa.oneNote=6]="oneNote";sa[sa.visio=7]="visio";sa[sa.officeMobile=8]="officeMobile";sa[sa.cosmosDBChangefeed=9]="cosmosDBChangefeed";
sa[sa.last=10]="last"})(Oa||(Oa={}));Object(z.b)("RtcClientAppName",Oa);b.d(E,"RealtimeChannel",function(){return a});a.prototype.init=function(){var sa=this;this.ph.mHg(Object(fa.a)(this,this.Y6b,"disconnectAndCreateNewConnection"));this.ph.aIg(Object(fa.a)(this,this.FUi,"onUpdatePersistentStateRequestReceivedInternal"));this.ph.$Hg(Object(fa.a)(this,this.EUi,"onUpdatePersistentStateClearedRequestReceived"));this.Wg.hVc(this.Rp);ka.AFrameworkApplication.PMb(function(){sa.Rp.qId();qa.a.instance&&
qa.a.instance.ivd()});this.jFe();this.fgh();this.ph.GHg(Object(fa.a)(this,this.wRj,"updateConnectionQueryString"))};a.prototype.fgh=function(){try{var sa=$.signalR;if(!sa)throw Error.invalidOperation("Failed to retrieve Signalr object");var Fa=sa.version;if(!Fa)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Fa){var Wa=sa.transports;if(!Wa)throw Error.invalidOperation("Failed to retrieve transports object");var Db=Wa.longPolling;if(!Db)throw Error.invalidOperation("Failed to retrieve longPolling object");
if(!Db.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Db.supportsKeepAlive=this.N$g()}}catch(pc){U.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",pc.message)}};a.prototype.N$g=function(){return function(){return!1}};a.prototype.jFe=function(){var sa=this,Fa=++this.Zhb;this.SMc=(new Date(0)).getTime();this.BP=this.qng();this.ph.U4i(this.BP);this.BP.stateChanged(function(Wa){sa.gJi(Wa,Fa)});this.BP.connectionSlow(Object(fa.a)(this,
this.pTi,"onSlowConnection"));this.BP.error(Object(fa.a)(this,this.eTi,"onSignalRError"));this.BP.log=Object(fa.a)(this,this.fTi,"onSignalRLog")};a.prototype.hgb=function(sa,Fa){return sa!==this.Zhb?(U.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",Fa),!1):!0};a.prototype.connect=function(){2!==this.cM&&1!==this.cM&&(U.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Yl),this.wHc.eJi(),wa.a.instance.zFj(),this.OW(1,this.cM),this.y6f())};
a.prototype.y6f=function(){var sa=this.Zhb;this.hSc=!1;this.Rp.JNf();this.Kpa.bYh(Object(fa.a)(this,this.W1g,"connectSignalrConnection"),Object(fa.a)(this,this.Txf,"onFailureToConnect"),Object(fa.a)(this.zAa,this.zAa.qai,"initThrottlerManager"),Object(fa.a)(this,this.hgb,"verifyConnectionToken"),sa)};a.prototype.Txf=function(sa){sa=void 0===sa?null:sa;this.Rp.LNf();var Fa=null;!sa||"documentsessiondeleted"!==(Fa=sa.toLowerCase())&&"documentsessionexpired"!==Fa?this.Y6b():(U.ULS.sendTraceTag(41788292,
500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Yl,sa),this.disconnect())};a.prototype.Y6b=function(sa,Fa){Fa=void 0===Fa?null:Fa;U.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.d9);sa=(sa=2===this.cM||1===this.cM)&&!this.zAa.IJa;var Wa=!0,Db=0;Fa&&Object.getType(Fa)!==Object.getType(Sys.EventArgs.Empty)&&Fa.aLd&&""!==Fa.aLd&&(sa=!0,this.Kpa.stj(Fa.aLd),Wa=Fa.tOd,Db=Fa.reconnectDelay);sa&&
this.OW(1,this.cM);++this.Zhb;this.zAa.Vv();this.zGj(Wa);this.Kpa.fhh();this.jFe();sa&&window.setTimeout(Object(fa.a)(this,this.y6f,"startConnecting"),Math.min(Db,3E4))};a.prototype.wRj=function(){var sa=this.Kpa.p_e();var Fa=sa.correlationId;this.BP.qs=sa.returnValue;U.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Yl,Fa)};a.prototype.W1g=function(sa){var Fa=this;this.SMc=(new Date).getTime();var Wa=null;this.BP.qs=function(){var pc=
Fa.Kpa.p_e();Wa=pc.correlationId;return pc}().returnValue;this.Ee.BJg&&(this.BP.url=sa,qa.a.instance&&(qa.a.instance.uCe=xa.a.bN(sa)));var Db=null;this.Eh&&(Db=this.Eh.Hc("WebServiceCall","ConnectToServer"));U.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Yl);sa={};this.MXb&&(sa.transport=1===this.MXb.length?this.MXb[0]:this.MXb);sa.pingInterval=null;wa.a.instance.AHb(1,0);sa.waitForPageLoad=!1;this.BP.start(sa,null).done(function(pc){Fa.Rp.MNf();wa.a.instance.AHb(1,
1,!0);U.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",pc.id,Wa)}).fail(function(pc){var lc=b(926).RtcUtils;U.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",Fa.Kpa.zC,Wa,lc.UOa(pc),Fa.Yl);Fa.Txf();Fa.Rp.KNf(pc);wa.a.instance.AHb(1,1,!1);lc={};Fa.ph.VLf(0,(lc.CorrelationId=Wa,lc.ErrorDetails=pc,lc.ConnectionState=na.a[Fa.cM],lc))}).always(function(){Db&&
Db.stop();qa.a.instance&&(qa.a.instance.PIc=!1)})};a.prototype.disconnect=function(){0===this.cM?U.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Yl):(this.Rp.PNf(),qa.a.instance&&(qa.a.instance.PIc=!0),U.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Yl),this.zAa.IJa=!0,this.wHc.eKi(),this.OW(0,this.cM),this.Y6b(),this.zAa.IJa=!1)};a.prototype.zGj=function(sa){function Fa(){if(Wa.hSc)U.ULS.sendTraceTag(591692192,
500,15,"Stop connection was called twice, possibly on the same connection.");else try{Wa.hSc=!0,pc.stop(!0,sa)}catch(eb){U.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",eb.message)}}var Wa=this,Db=this.vUg(),pc=this.BP,lc=this.d9;0<Db?(U.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",lc,Db),window.setTimeout(Fa,Db)):(U.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",lc),Fa())};a.prototype.vUg=function(){var sa=0;0===this.BP.state&&
(sa=this.SMc+a.qXj-(new Date).getTime(),0>sa&&(sa=0));return sa};a.prototype.eGa=function(sa){this.ph.eGa(sa)};a.prototype.mIb=function(sa){this.ph.mIb(sa)};a.prototype.qYf=function(sa){this.FOd(0,sa)};a.prototype.FOd=function(sa,Fa){var Wa=new aa.a;this.ph.YLf(sa,Fa,Wa);return Wa.task};a.prototype.lGa=function(sa){this.ph.lGa(sa)};a.prototype.mAa=function(sa){this.ph.mAa(sa)};a.prototype.Rwb=function(sa){return this.O0h(sa)};a.prototype.Odd=function(){return this.KJh()};a.prototype.KJh=function(){for(var sa=
{},Fa=Cl(this.OG),Wa=Fa.next();!Wa.done;Wa=Fa.next())Wa=Wa.value,Wa.value.xb(0)&&(sa[Wa.key]=Wa.value.oa(0).data);return sa};a.prototype.O0h=function(sa){return this.OG.xb(sa)&&this.OG.oa(sa).xb(0)?this.OG.oa(sa).oa(0).data:null};a.prototype.FUi=function(sa,Fa){sa=Cl(Fa.KUj);for(var Wa=sa.next();!Wa.done;Wa=sa.next()){Wa=Wa.value;this.OG.xb(Wa.key)||this.OG.ia(Wa.key,new db.a);var Db=Wa.value;this.OG.oa(Wa.key).ia(Fa.type,new ca(Db.Presence,new Date(Db.TimeStamp)));Wa.key===this._clientId&&0===Fa.type&&
this.ph.I4i(Db.Presence)}};a.prototype.EUi=function(sa,Fa){sa=Cl(Fa.u1c);for(Fa=sa.next();!Fa.done;Fa=sa.next())this.OG.remove(Fa.value)};a.prototype.JJh=function(){var sa=new db.a;if(!this.OG.xb(this._clientId))return sa;for(var Fa=Cl(this.OG.oa(this._clientId)),Wa=Fa.next();!Wa.done;Wa=Fa.next())Wa=Wa.value,sa.ia(Wa.key,Wa.value.data);return sa};a.prototype.fea=function(sa,Fa,Wa){Fa=void 0===Fa?null:Fa;Wa=void 0===Wa?!1:Wa;var Db=new aa.a;this.ph.pHd(sa,Fa,Wa,Db);return Db.task};a.prototype.lZa=
function(sa){this.ph.lZa(sa)};a.prototype.EIb=function(sa){this.ph.EIb(sa)};a.prototype.$va=function(sa){var Fa=this,Wa,Db;return function(){var pc=Fa.OG.Nc(sa);Wa=pc.value;return pc}().returnValue&&function(){var pc=Wa.Nc(0);Db=pc.value;return pc}().returnValue?new L(this.S0h(Db),Db.timeStamp):null};a.prototype.PJh=function(){for(var sa={},Fa={},Wa=Cl(this.OG),Db=Wa.next();!Db.done;Fa={Igb:Fa.Igb,tEc:Fa.tEc},Db=Wa.next())Fa.Igb=Db.value,Fa.tEc=void 0,function(pc){return function(){var lc=pc.Igb.value.Nc(0);
pc.tEc=lc.value;return lc}}(Fa)().returnValue&&(sa[Fa.Igb.key]=this.$va(Fa.Igb.key));return sa};a.prototype.Dfb=function(sa){var Fa=new aa.a;this.ph.i5i(sa,Fa);return Fa.task};a.prototype.dispose=function(){this.It||(this.zAa.Vv(),this.Wg.Daj(this.Rp),this.Rp.qId(),qa.a.instance&&qa.a.instance.ivd(),this.It=!0)};a.prototype.gJi=function(sa,Fa){this.hgb(Fa,"StateChangedSignalR")&&this.OW(this.iDe(sa.newState),this.iDe(sa.oldState))};a.prototype.OW=function(sa,Fa){if((1!==this.cM||0!==Fa||1!==sa)&&
this.cM!==Fa){var Wa=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.cM,Fa,sa]));U.ULS.sendTraceTag(3290053,500,10,Wa)}if(this.cM!==sa){switch(sa){case 2:qa.a.instance&&qa.a.instance.wzi();this.d9=this.BP.id;U.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.d9,this.Yl);this.uxi(this.BP);U.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");
Wa=null;this.Eh&&(Wa=this.Eh.Hc("WebServiceCall","Receive First Presence"));var Db=this.Zhb;this.ph.T4i(Object(fa.a)(this,this.hgb,"verifyConnectionToken"),Db,this.wHc,Object(fa.a)(this,this.$0c,"clearExistingPersistentState"),this.JJh(),Wa);this.Ee.rtcClientMessageTelemetryEnabled&&I.Agd(this.ph,this.Ee,100*Math.random()<=this.Ee.Ejj).start();break;case 1:2===Fa&&U.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.d9);break;case 0:if(I.instance&&
I.instance.stop(),this.zAa.IJa)U.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.d9);else{1===Fa&&(U.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.d9),this.Rp.QNf());2===Fa&&U.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.d9);this.Y6b();return}}this.cM=sa;this.ph.h4i(sa,Fa)}};a.prototype.uxi=function(sa){if(sa&&sa.transport&&sa.transport.name){sa=sa.transport.name;var Fa=sa.toLowerCase();"websockets"===Fa?U.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",sa,this.Yl):"serversentevents"===Fa?U.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",sa,this.Yl):"foreverframe"===Fa?U.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",sa,this.Yl):"longpolling"===Fa?U.ULS.sendTraceTag(4290754,
500,50,"Transport name - {0} for [{1}]",sa,this.Yl):"mocktransport"!==Fa&&U.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",sa)}else U.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.pTi=function(){U.ULS.sendTraceTag(3249544,500,50,"Detected that the connection [{0}] is slow",this.d9)};a.prototype.eTi=function(){U.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.d9)};a.prototype.fTi=function(sa){sa=b(926).RtcUtils.UOa(sa);
this.JCj&&2E3>this.die&&!sa.startsWith("Invok")&&!sa.startsWith("Trigger")&&(U.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",sa),this.die++)};a.prototype.$0c=function(){var sa=[],Fa=this.OG.Nc(this._clientId);var Wa=Fa.value;Fa.returnValue&&this.OG.remove(this._clientId);var Db=Cl(this.OG.keys);for(Fa=Db.next();!Fa.done;Fa=Db.next())Array.add(sa,Fa.value);Db=Cl(sa);for(Fa=Db.next();!Fa.done;Fa=Db.next())this.OG.remove(Fa.value);Wa&&this.OG.ia(this._clientId,Wa);this.ph.D4i(sa)};a.prototype.iDe=
function(sa){switch(sa){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",sa,"Unknown SignalR state");}};a.prototype.S0h=function(sa){return sa&&sa.timeStamp?(new Date).getTime()-sa.timeStamp.getTime()>(this.Ee.bOg?6E4:this.Ee.aOg)?2:1:1};a.createInstance=function(sa,Fa,Wa,Db,pc,lc,eb,ib,cc,Pa,nc,pb,rb){return f(sa,Fa,Wa,void 0===rb?null:rb,Db,pc,lc,eb,void 0===ib?null:ib,void 0===cc?null:cc,void 0===Pa?null:Pa,void 0===pb?null:pb,void 0===
nc?null:nc)};Ck.Object.defineProperties(a.prototype,{llc:{configurable:!0,enumerable:!0,get:function(){return this.Kpa.llc},set:function(sa){this.Kpa.llc=sa}},zAa:{configurable:!0,enumerable:!0,get:function(){return this.awg}},ph:{configurable:!0,enumerable:!0,get:function(){return this.Nkg}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.cM}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},JCj:{configurable:!0,enumerable:!0,get:function(){return this.$wg}}});
a.pqf=31E3;a.Uwd=8E3;a.qXj=15E3;Object(z.a)(a,"RealtimeChannel",null,[271,272])},1090:function(z,E,b){function a(){this.Jie=!1;this.LPc=null;this.v5d=0;this.eJc=this.lGe();this.FRb=this.lGe();this.oDa=this.vWa=0;this.Iw=function(){return new Date}}b.d(E,"a",function(){return a});z=b(0);a.prototype.lGe=function(){for(var c=Array(6),e=0;e<c.length;e++)c[e]=0;return c};a.prototype.gQh=function(){return this.eJc.toString()};a.prototype.UMh=function(){return this.FRb.toString()};a.prototype.zFj=function(){this.LPc=
this.Iw()};a.prototype.AHb=function(c,e,f){if(!this.qHj){if(void 0===f?0:f)this.Jie=!0;f=this.Iw();0===c&&5<this.vWa||1===c&&5<this.oDa||(this.v5d<c?(1===this.vWa%2&&(this.eJc[this.vWa]=-1,this.vWa++),this.v5d=c,1===e&&(this.FRb[this.oDa]=-1,this.oDa++),this.FRb[this.oDa]=this.aVd(f),this.oDa++):0===c?(this.eJc[this.vWa]=this.aVd(f),this.vWa++):(this.FRb[this.oDa]=this.aVd(f),this.oDa++))}};a.prototype.aVd=function(c){var e=c.getTime()-this.LPc.getTime();this.LPc=c;return e};Ck.Object.defineProperties(a.prototype,
{qHj:{configurable:!0,enumerable:!0,get:function(){return this.Jie}}});Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.Ma||(a.Ma=new a);return a.Ma},set:function(c){a.Ma=c}}});a.Ma=null;Object(z.a)(a,"LatencyMetrics",null,[])},1143:function(z,E,b){function a(h){this.uCe=this.FUe=null;this.oqf=this.wWe=0;this.Rp=null;this.Pbe=this.GNc=0;this.Wg=h;this.Nbi();this.PIc=this.P7d=this.dOc=!1;this.ANc=0}z=b(0);var c=b(14),e=b(82),f=b(112),m;(function(h){h[h.SendNotification=
0]="SendNotification";h[h.SendPersistentState=1]="SendPersistentState";h[h.FindSession=2]="FindSession";h[h.Last=3]="Last"})(m||(m={}));Object(z.b)("ApiType",m);var n;(function(h){h[h.AttemptCount=0]="AttemptCount";h[h.SuccessCount=1]="SuccessCount";h[h.DropCount=2]="DropCount";h[h.FailedCount=3]="FailedCount";h[h.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";h[h.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";h[h.ThrottledCount=6]="ThrottledCount";h[h.Last=7]="Last"})(n||(n=
{}));Object(z.b)("EventCountType",n);var w=b(1090);b.d(E,"a",function(){return a});a.prototype.xFj=function(h){this.Pbe=h;window.setInterval(Object(e.a)(this,this.ivd,"logMetricsBatchAndReset"),h);this.GNc=(new Date).getTime()};a.prototype.oy=function(h,y){this.Mwj(h)&&!this.P7d||this.vzh||!window.navigator.onLine||this.Wg.j7a||(this.Rp[h][y]++,this.dOc=!0)};a.prototype.Nbi=function(){this.Rp=Array(3);for(var h=0;3>h;h++){this.Rp[h]=Array(7);for(var y=0;7>y;y++)this.Rp[h][y]=0}};a.prototype.xRg=function(){for(var h=
{},y=0;3>y;y++)for(var r=0;7>r;r++)this.vpi(y,r)&&(h[m[y]+n[r]]=this.Rp[y][r]);h.FSDomain=this.FUe;h.ConnectionDomain=this.uCe;h.FSRetryInterval=this.wWe;h.MaxPayloadSize=this.oqf;h.LogNumber=this.ANc;1===this.ANc&&(h.FSLatencies=w.a.instance.gQh(),h.ConLatencies=w.a.instance.UMh());return h};a.prototype.vpi=function(h,y){return 2===h&&3!==y&&0!==y?!1:!0};a.prototype.Mwj=function(h){return 2===h?!1:!0};a.prototype.ivd=function(){if(this.dOc){this.ANc++;if((new Date).getTime()-this.GNc<5E3+this.Pbe){var h=
f.a.toJSON(this.xRg());c.ULS.sendTraceTag(50644352,500,15,h)}this.GNc=(new Date).getTime();for(h=0;3>h;h++)for(var y=0;7>y;y++)this.Rp[h][y]=0;this.dOc=!1}};a.prototype.wzi=function(){this.P7d=!0};a.create=function(h){a.instance||(a.Ma=new a(h));return a.instance};Ck.Object.defineProperties(a.prototype,{vzh:{configurable:!0,enumerable:!0,get:function(){return this.PIc}}});Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma}}});a.Ma=null;Object(z.a)(a,"FrequentLoggingMetrics",
null,[302])},1204:function(z,E,b){function a(e,f,m,n){var w=c.call(this)||this;w.type=e;w.z8=f;w.eeh=m;w.Foa=n;return w}b.d(E,"a",function(){return a});z=b(0);var c=Sys.EventArgs;Am(a,c);Object(z.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1205:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.aNd="rr";a.Fjj="rd";a.Djj="rbp";a.tOd="sa";Object(z.a)(a,"RtcReconnectParams",null,[])},1206:function(z,E,b){function a(c,e,f,m){this.fBi=c;this.LBa=e;this.kAi=f;this.k2h=
m}b.d(E,"a",function(){return a});z=b(0);Object(z.a)(a,"ThrottlerManagerSettings",null,[])},1294:function(z,E,b){function a(){this.Za=new ha.a}function c(ka,xa){var va=na.call(this)||this;va.type=ka;va.KUj=xa;return va}function e(ka){var xa=aa.call(this)||this;xa.u1c=ka;return xa}function f(ka,xa){var va=fa.call(this)||this;va.w_j=ka;va.j0j=xa;return va}function m(ka,xa,va){var Aa=L.call(this)||this;Aa.type=ka;Aa.presence=xa;Aa.Foa=va;return Aa}function n(ka,xa){var va=H.call(this)||this;va.I_j=ka;
va.errorMessage=xa;return va}function w(ka){var xa=I.call(this)||this;xa.hubConnection=ka;return xa}function h(ka,xa,va,Aa,qa,wa){var Ta=ca.call(this)||this;Ta.hgb=ka;Ta.P2c=xa;Ta.a2g=va;Ta.FSe=qa;Ta.$0c=Aa;Ta.stopwatch=wa;return Ta}function y(ka){var xa=Z.call(this)||this;xa.G0j=ka;return xa}function r(ka,xa){xa=void 0===xa?null:xa;var va=ea.call(this)||this;va.mC=ka;va.Nyg=xa;return va}function x(ka,xa){var va=R.call(this)||this;va.type=ka;va.jP=xa;return va}function t(ka){var xa=T.call(this)||
this;xa.u1c=ka;return xa}function u(ka){var xa=M.call(this)||this;xa.presence=ka;return xa}function B(ka,xa){var va=A.call(this)||this;va.tZg=ka;va.Foa=xa;return va}function v(ka,xa){var va=C.call(this)||this;va.newState=ka;va.oldState=xa;return va}z=b(0);var C=Sys.EventArgs;Am(v,C);Object(z.a)(v,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);var A=Sys.EventArgs;Am(B,A);Object(z.a)(B,"ClientInfoEventArgs",Sys.EventArgs,[]);var M=Sys.EventArgs;Am(u,M);Object(z.a)(u,"MyPresenceUpdatedEventArgs",
Sys.EventArgs,[]);var T=Sys.EventArgs;Am(t,T);Object(z.a)(t,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var R=Sys.EventArgs;Am(x,R);Object(z.a)(x,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var Q=b(1367),ea=Sys.EventArgs;Am(r,ea);Ck.Object.defineProperties(r.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.mC}},z8:{configurable:!0,enumerable:!0,get:function(){return this.Nyg}}});Object(z.a)(r,"UpdateNotificationEventArgs",Sys.EventArgs,[]);var Z=Sys.EventArgs;
Am(y,Z);Object(z.a)(y,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var ca=Sys.EventArgs;Am(h,ca);Object(z.a)(h,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);var I=Sys.EventArgs;Am(w,I);Object(z.a)(w,"RefreshProxyEventArgs",Sys.EventArgs,[]);var H=Sys.EventArgs;Am(n,H);Object(z.a)(n,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);var L=Sys.EventArgs;Am(m,L);Object(z.a)(m,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var U=b(1204),fa=Sys.EventArgs;Am(f,fa);Object(z.a)(f,
"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var aa=Sys.EventArgs;Am(e,aa);Object(z.a)(e,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var na=Sys.EventArgs;Am(c,na);Object(z.a)(c,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var ha=b(97);b.d(E,"a",function(){return a});a.prototype.h4i=function(ka,xa){this.Za.raiseEvent("CSC",new v(ka,xa))};a.prototype.U4i=function(ka){this.Za.raiseEvent("RP",new w(ka))};a.prototype.Erc=function(ka){this.Za.raiseEvent("RC",ka)};
a.prototype.W4i=function(){this.Za.raiseEvent("RMID")};a.prototype.T4i=function(ka,xa,va,Aa,qa,wa){this.Za.raiseEvent("RPS",new h(ka,xa,va,Aa,qa,wa))};a.prototype.fMf=function(ka,xa){this.Za.raiseEvent("UPSR",new c(ka,xa))};a.prototype.QLf=function(ka,xa){this.Za.raiseEvent("PU",new Q.a(ka,xa))};a.prototype.I4i=function(ka){this.Za.raiseEvent("MPU",new u(ka))};a.prototype.pHd=function(ka,xa,va,Aa){this.Za.raiseEvent("SUN",new U.a(ka,xa,va,Aa))};a.prototype.j5i=function(ka,xa){this.Za.raiseEvent("UNR",
new r(ka,xa))};a.prototype.YLf=function(ka,xa,va){this.Za.raiseEvent("SP",new m(ka,xa,va))};a.prototype.Q4i=function(ka,xa){this.Za.raiseEvent("PSU",new x(ka,xa))};a.prototype.P4i=function(ka){this.Za.raiseEvent("PSC",new t(ka))};a.prototype.D4i=function(ka){this.Za.raiseEvent("IPSC",new t(ka))};a.prototype.k5i=function(ka){this.Za.raiseEvent("UPSC",new e(ka))};a.prototype.$4i=function(ka,xa){this.Za.raiseEvent("SPC",new f(ka,xa))};a.prototype.VLf=function(ka,xa){this.Za.raiseEvent("RCF",new n(ka,
xa))};a.prototype.x4i=function(ka){this.Za.raiseEvent("CPSWM",new y(ka))};a.prototype.i5i=function(ka,xa){this.Za.raiseEvent("UCI",new B(ka,xa))};a.prototype.eGa=function(ka){this.Za.addHandler("CSC",ka)};a.prototype.mIb=function(ka){this.Za.removeHandler("CSC",ka)};a.prototype.nHg=function(ka){this.Za.addHandler("RP",ka)};a.prototype.mHg=function(ka){this.Za.addHandler("RC",ka)};a.prototype.rHg=function(ka){this.Za.addHandler("RMID",ka)};a.prototype.lHg=function(ka){this.Za.addHandler("RPS",ka)};
a.prototype.aIg=function(ka){this.Za.addHandler("UPSR",ka)};a.prototype.lGa=function(ka){this.Za.addHandler("PU",ka)};a.prototype.mAa=function(ka){this.Za.removeHandler("PU",ka)};a.prototype.XFg=function(ka){this.Za.addHandler("IPU",ka)};a.prototype.ZHg=function(ka){this.Za.addHandler("UCI",ka)};a.prototype.EHg=function(ka){this.Za.addHandler("SUN",ka)};a.prototype.YFg=function(ka){this.Za.addHandler("IUNR",ka)};a.prototype.lZa=function(ka){this.Za.addHandler("UNR",ka)};a.prototype.EIb=function(ka){this.Za.removeHandler("UNR",
ka)};a.prototype.WFg=function(ka){this.Za.addHandler("IPSU",ka)};a.prototype.VFg=function(ka){this.Za.addHandler("IPSC",ka)};a.prototype.$Hg=function(ka){this.Za.addHandler("UPSC",ka)};a.prototype.DHg=function(ka){this.Za.addHandler("SP",ka)};a.prototype.GHg=function(ka){this.Za.addHandler("SPC",ka)};a.getInstance=function(){return a.Ma||(a.Ma=new a)};a.Ma=null;Object(z.a)(a,"RtcEventHub",null,[318])},1298:function(z,E,b){function a(H,L,U,fa,aa,na,ha,ka,xa,va,Aa,qa,wa){var Ta=this;wa=void 0===wa?
null:wa;this.Oae=(new Date(0)).getTime();this.Vbe=0;this.zUb=!1;this.she=null;this.zId=36E5;this.SVa=a.Daf;this.Sib=0;this.fRa=null;this.Zda=0;this.Ecb=this.vCe=null;this.Cvg=[h.iAb,h.errorMessage,h.y5f,h.zC,h.o7,h.D5e,h.h9a,h.LBa,h.n9a];this.Bvg=[h.iAb,h.errorMessage];this.zC=this.llc=null;this.L7d=new m(Aa?Aa:function(){return u.AFrameworkApplication.oj},aa,na,ha,H,L);this.Fhb=qa;this.Eh=fa;this.Wg=L;this.opg=U;this.Yl=ka;this.ph=xa;this.bjb=wa;this.M7d=!1;this.q$b=9E4;va&&va.execute(function(sb){sb.RZb(function(){y.ULS.sendTraceTag(40768456,
500,50,"Connection parameters refresh requested for client [{0}]",Ta.Yl);Ta.L7d.BOf()})});2>=100*Math.random()&&(this.zId=3E5);Q.a.instance&&(Q.a.instance.wWe=this.zId)}function c(){}function e(){}function f(){}function m(H,L,U,fa,aa,na){this.$Ea=null;var ha=b(1298).FindSessionStrategy;this.Uug=H;H=String.format("{0}={1}",n.clientId,T.a.mf(fa));H=String.format("{0}&{1}={2}",H,n.userSessionId,T.a.mf(aa));H=String.format("{0}&{1}={2}",H,n.eVj,T.a.mf(U.toString()));H=String.format("{0}&{1}={2}",H,n.userType,
T.a.mf("1"));H=String.format("{0}&{1}={2}",H,n.yVj,T.a.mf(L));H=String.format("{0}&{1}={2}",H,n.xZg,T.a.mf(ha.vZg));(L=m.nKh(U,na))&&(H=String.format("{0}&{1}",H,L));this.sng=H}function n(){}function w(){this.E5e=this.mqf=this.nqf=this.rqf=0;this.sic=!1;this.correlationId=this.zC=this.o7=this.Q2c=this.errorMessage=null}function h(){}b.r(E);z=b(0);var y=b(14),r=b(82),x=b(201),t=b(1203);h.n9a="throttling_messageDelay";h.iAb="enabled";h.LBa="throttling_timeToWaitForResponse";h.h9a="throttling_maxNumberOfOutstandingMessages";
h.D5e="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.y5f="url";h.o7="queryString";h.zC="connectionString";Object(z.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[]);var u=b(4),B=b(80),v=b(39),C=b(494),A=b(896),M=b(112),T=b(29),R=b(177);Ck.Object.defineProperties(w.prototype,{f1g:{configurable:!0,enumerable:!0,get:function(){return this.Q2c+"?"+this.o7}}});Object(z.a)(w,"FindSessionResponse",null,[]);n.clientId="ClientId";n.eVj="UserApp";n.userSessionId="usid";
n.userType="UserType";n.yVj="UserVersion";n.urc="qs";n.xZg="clientProtocol";n.iEi="NoAuth";Object(z.a)(n,"RtcFindSessionInputQueryParamConstants",null,[]);m.prototype.BOf=function(){this.$Ea=this.Uug()};m.prototype.jdd=function(){this.$Ea&&""!==this.$Ea||(this.BOf(),y.ULS.sendTraceTag(575784194,500,this.$Ea&&""!==this.$Ea?50:15,"Query signature delegate called for refresh returned: {0} ",this.$Ea));var H=String.format("{0}={1}",n.urc,T.a.mf(this.$Ea));return String.format("{0}&{1}",H,this.sng)};m.nKh=
function(H,L){return 4===H?String.format("{0}={1}",n.iEi,"1"):L?L.W0h():null};Object(z.a)(m,"FindSessionQueryStringGenerator",null,[]);var Q=b(1143),ea=b(1090),Z=b(926),ca=b(1206);f.QCh="FSType";Object(z.a)(f,"RtcFindSessionRequestHeaders",null,[]);e.G6i="polling";Object(z.a)(e,"RtcFindSessionTypes",null,[]);var I=b(1205);c.lWj="RTC-TokenProofkey";c.Npi="RTC-IsWacJsBootFsRequest";Object(z.a)(c,"RtcRequestHeaders",null,[]);b.d(E,"FindSessionStrategy",function(){return a});a.prototype.stj=function(H){this.Ecb=
H};a.prototype.init=function(){this.ph.rHg(Object(r.a)(this,this.Xgj,"resetGetMachineIdDelay"));this.ph.eGa(Object(r.a)(this,this.OW,"onConnectionStateChanged"))};a.prototype.OW=function(H,L){this.Zda=L.newState;2===L.newState&&(this.Sib=0)};a.prototype.p_e=function(){var H=this.fRa.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.fRa.o7,a.BDe,T.a.mf(H)),correlationId:H}};a.prototype.bYh=function(H,L,U,fa,aa){var na=this;this.Inj(function(){fa(aa,"GetMachineIdSuccess")&&(y.ULS.sendTraceTag(17956951,
500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",na.zC,na.Yl),H(na.she),U(na.M_h()))},function(ha){fa(aa,"GetMachineIdFailure")&&(y.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",na.Yl),L(ha))},fa,aa)};a.prototype.fhh=function(){this.Qze();this.V9h()};a.prototype.Inj=function(H,L,U,fa){var aa=this;y.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.zC);if(this.zC)H();else{var na=
this.iUg();window.setTimeout(function(){aa.sendFindSessionRequestToServerInternal(H,L,U,fa)},na)}};a.prototype.sendFindSessionRequestToServerInternal=function(H,L,U,fa){var aa=this;U(fa,"RequestMachineId")&&(this.Oae=(new Date).getTime(),U=v.a.Ae(),this.q_e(function(na){var ha=v.a.Ae();aa.LGf(na);aa.VPd();H();na=v.a.Ae()-ha;y.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",na)},function(na){var ha=v.a.Ae();aa.Qze();Q.a.instance&&Q.a.instance.oy(2,3);L(na);na=v.a.Ae()-ha;y.ULS.sendTraceTag(577356040,
345,50,"SFSRTS Failure - TimeElapsed: {0}",na)},!1),U=v.a.Ae()-U,y.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",U))};a.prototype.V9h=function(){this.SVa+=a.DTh;this.SVa=Math.min(this.SVa,a.Xzi)};a.prototype.iUg=function(){var H=(new Date).getTime();H=this.Oae+this.SVa-H;0>H&&(H=0);return H};a.prototype.LGf=function(H){try{this.fRa=H,this.llc=H.f1g,this.zC=H.zC,this.vCe=H.o7,this.she=H.Q2c}catch(L){y.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",
L.toString())}};a.prototype.Qze=function(){this.zC=null;this.Rze()};a.prototype.VPd=function(){this.Rze();this.zUb=!0;this.Vbe=window.setTimeout(Object(r.a)(this,this.l8i,"refreshMachineId"),this.zId)};a.prototype.Rze=function(){this.zUb&&(window.clearTimeout(this.Vbe),this.zUb=!1)};a.prototype.l8i=function(){var H=this;this.zUb=!1;this.q_e(function(L){var U=H.vCe!==L.o7,fa=H.zC!==L.zC,aa=H.zC;H.LGf(L);0!==H.Zda&&(fa?(y.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",
aa||"null",L.zC),H.ph.Erc()):(H.ph.$4i(U,fa),H.VPd()))},function(){Q.a.instance&&Q.a.instance.oy(2,3);H.VPd()},!0)};a.prototype.Xgj=function(){this.SVa=a.Daf};a.prototype.M_h=function(){return new ca.a(this.fRa.rqf,this.fRa.nqf,this.fRa.mqf,this.fRa.E5e)};a.prototype.IMj=function(H){if(Object.getType(H)!==Object)return null;for(var L in H);return this.a7g(H)};a.prototype.a7g=function(H){if(!(h.iAb in H))return null;for(var L=H[h.iAb],U=Cl(L?this.Cvg:this.Bvg),fa=U.next();!fa.done;fa=U.next())if(!(fa.value in
H))return null;U=Object.assign(new w,{sic:H[h.iAb],errorMessage:H[h.errorMessage],correlationId:R.a.create().toString()});L&&(U.Q2c=H[h.y5f],U.o7=H[h.o7],U.zC=H[h.zC],U.E5e=H[h.D5e],U.mqf=H[h.h9a],U.nqf=H[h.LBa],U.rqf=H[h.n9a]);return U};a.prototype.hQh=function(H,L){var U=this;y.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.bjb.OCh.continueWith(function(){U.bjb.OCh.result?(y.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),
H(U.bjb.PCh)):(y.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),L(U.bjb.PCh))})};a.prototype.wTf=function(H,L,U,fa,aa){var na=this;aa=void 0===aa?!1:aa;return function(ha){ea.a.instance.AHb(0,1);H&&H.stop();na.Ecb=null;na.Fhb=null;na.Dnf(ha.data,!0,L);var ka=Z.RtcUtils.deserialize(ha.data.me,"FindSession",null);if(ka)if(ka=na.IMj(ka)){if(ka.sic&&ka.o7&&ka.zC){y.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",na.Yl);na.kvi(ha.data);
U(ka);return}L.FindSessionFailureReason="FindSessionInvalidResponse";L.IsRtcEnabled=ka.sic;L.IsQueryStringEmpty=!ka.o7;L.IsConnectionStringEmpty=!ka.zC;y.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",na.Yl,ka.sic,!ka.o7,!ka.zC)}else L.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",y.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",
na.Yl);else L.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",y.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",na.Yl);na.WLf(L,aa);fa(null)}};a.prototype.pTf=function(H,L,U,fa){var aa=this;fa=void 0===fa?!1:fa;return function(na){ea.a.instance.AHb(0,1);H&&H.stop();aa.Ecb=null;aa.Fhb=null;aa.Dnf(na.data,!1,L);var ha=null,ka="unknown",xa="unknown";na.data&&((ka=na.data.responseHeaders)&&a.wJb in ka&&(ha=ka[a.wJb].toString()),ka=A.a[na.data.status],
xa=na.data.httpStatus.toString());L.FindSessionFailureReason="FindSessionRequestFailed";L.HttpErrorCode=xa;L.HttpErrorStatus=ka;L[a.wJb]=ha;y.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",ka,xa,aa.Yl,ha,fa);aa.WLf(L,fa);U(xa)}};a.prototype.q_e=function(H,L,U){var fa=this;U=void 0===U?!1:U;var aa=null;y.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Yl);var na={},ha=
this.L7d.jdd();na[C.a.CZ]=R.a.create().toString();this.Ecb&&""!==this.Ecb?ha=String.format("{0}&{1}={2}",ha,I.a.aNd,this.Ecb):this.Fhb&&""!==this.Fhb&&(ha=String.format("{0}&{1}={2}",ha,I.a.aNd,this.Fhb),na[c.lWj]="True",na[c.Npi]="True");ha=this.opg+"?"+ha;U&&(na[f.QCh]=e.G6i);var ka={};ka.IsNetworkOfflineBeforeSendRequest=this.Wg.j7a;ka.HasAvailableConnectionsBeforeSendRequest=this.Wg.I7e;ka.MaxConnectionsAllowed=this.Wg.rlc;ka.IsRefreshMachineId=U;this.bjb&&!this.M7d?(this.hQh(this.wTf(null,ka,
H,L,U),this.pTf(null,ka,L,U)),this.M7d=!0):(this.Eh&&(aa=this.Eh.Hc("WebServiceCall","GetMachineIdFromTheServer")),Q.a.instance&&Q.a.instance.oy(2,0),0>this.Wg.j$(ha,1,null,na,[a.w4b,a.wJb,a.VDb,a.$Md,a.Orf,a.Ytf,a.Xtf],!1,1,this.wTf(aa,ka,H,L,U),this.pTf(aa,ka,L,U),null,null,!1,null,this.q$b,"3",null,!0)&&(5<this.Sib&&200>this.Sib&&y.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.Sib),window.setTimeout(function(){fa.Sib++;
L("-1")},1E3)))};a.prototype.Dnf=function(H,L,U){U||(U={});U.IsNetworkOfflineAfterRequestComplete=this.Wg.j7a;U.IsRequestSucceeded=L;H&&(U.EnqueueTime=H.u8b,U.InvokedTime=H.tF,U.CompletedTime=H.S3,H.responseHeaders&&(a.w4b in H.responseHeaders&&(U.CorrelationId=H.responseHeaders[a.w4b]),a.VDb in H.responseHeaders&&(U[a.VDb]=H.responseHeaders[a.VDb])));y.ULS.sendTraceTag(38633565,500,L?50:15,Z.RtcUtils.UOa(U))};a.prototype.WLf=function(H,L){H||(H={});H.ConnectionState=t.a[this.Zda];L||this.ph.VLf(1,
H)};a.prototype.kvi=function(H){try{var L=!1,U=!1,fa=H.responseHeaders,aa=B.a.bN(H.request.get_url());if(fa&&a.$Md in fa){var na=fa[a.$Md].toString().toLocaleLowerCase();U="true"===na;L="false"===na}fa=!1;var ha=0<=aa.toLocaleLowerCase().indexOf("collab");U&&!ha?fa=!0:L&&ha&&(fa=!0);if(fa){L={HostName:aa};L.Status=A.a[H.status];L.HttpStatus=H.httpStatus.toString();var ka=H.request.get_headers(),xa;for(xa in ka){var va=ka[xa];(U=xa)&&0<U.length&&(aa=0,va&&(aa=va.toString().length),L["r_"+U]=aa)}if(H.responseHeaders){var Aa=
new x.a;Aa.add(a.w4b);Aa.add(a.VDb);Aa.add(a.wJb);Aa.add(a.Ytf);Aa.add(a.Xtf);Aa.add(a.Orf);a.eDg(L,H.responseHeaders,Aa)}a.TCg(H.request.get_url(),L);var qa=M.a.toJSON(L);y.ULS.sendTraceTag(559437006,500,15,qa)}}catch(wa){y.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",wa.toString())}};a.createInstance=function(H,L,U,fa,aa,na,ha,ka,xa,va,Aa,qa){return a.U7g(H,L,U,fa,aa,na,ha,ka,xa,va,Aa,void 0===qa?null:qa)};a.U7g=function(H,L,U,fa,aa,na,ha,ka,xa,va,Aa,qa){qa=void 0===
qa?null:qa;H=H||R.a.create().toString();H=new a(H,L,U,fa,aa,na,ha,ka,xa,va,null,Aa,qa);H.init();return H};a.eDg=function(H,L,U){U=Cl(U);for(var fa=U.next();!fa.done;fa=U.next())fa=fa.value,fa in L&&(H[fa]=L[fa])};a.TCg=function(H,L){if(H){var U=H.indexOf("?");if(-1!==U)for(H=H.substr(U+1).split("&"),U=0;U<H.length;++U){var fa=H[U].split("=");if(2===fa.length){var aa=fa[0];if(aa&&0<aa.length){var na=0;if(fa=fa[1])na=fa.length;L["q_"+aa]=na}}}}};a.DTh=3E3;a.Xzi=3E5;a.vZg="1.0";a.Daf=1E3;a.w4b="X-CorrelationId";
a.BDe="corrid";a.wJb="RtcErrorCode";a.VDb="X-OfficeCluster";a.$Md="X-NewEnv";a.Orf="X-MSEdge-Ref";a.Xtf="X-OFFICEFD";a.Ytf="X-OfficeFE";Object(z.a)(a,"FindSessionStrategy",null,[308])},1366:function(z,E,b){function a(){this.ode=this.pde=this.qde=this.mde=this.lde=this.nde=this.Vkb=this.HOc=0;this.USb=this.gNc=this.gkb=this.$Mc=this.aNc=this.RMc=this.Lqa=this.dkb=this.ZWa=this.QMc=this.SSb=this.nWa=null;this.QNc=this.Bkb=this.qhe=this.y4d=0;this.sce=!1;this.JNf=this.fId;this.MNf=this.iId;this.LNf=
this.hId;this.QNf=this.kId;this.PNf=this.jId;this.qId=this.rId;this.nId=this.oId;this.AQa=this.lId;this.BHb=this.mId;this.KNf=this.gId;this.yDb=this.Fyd;this.nmc=this.Hyd}b.r(E);b.d(E,"RealtimeChannelMetrics",function(){return a});z=b(0);var c=b(14),e=b(243),f=b(112),m=b(926);a.prototype.fId=function(){this.HOc++;this.QMc=new Date;this.nWa||(this.nWa=new Date)};a.prototype.iId=function(){this.Vkb++;this.Lqa=new Date;this.SSb||(this.SSb=this.Lqa);this.gkb=this.Lqa;this.p1g()};a.prototype.hId=function(){this.nde++;
this.RMc=new Date};a.prototype.kId=function(){this.lde++;this.ZWa=new Date};a.prototype.jId=function(){this.mde++;this.dkb=new Date};a.prototype.oId=function(){this.aNc=new Date;this.qde++};a.prototype.mId=function(){this.USb||(this.USb=new Date);this.pde++};a.prototype.lId=function(){this.$Mc=new Date;this.ode++};a.prototype.rId=function(){!this.sce&&this.HOc&&(c.ULS.sendTraceTag(39321871,500,15,f.a.toJSON(this.y_g())),this.sce=!0)};a.prototype.gId=function(n){var w=m.RtcUtils.Qzh(n);n=w.d$e;var h=
w.f$e;w=w.exception;if(n&&n!==e.a.tP){var y={};c.ULS.sendTraceTag(40157596,500,15,f.a.toJSON((y.HttpErrorCode=n,y.HttpErrorStatus=h,y.Exception=w,y)));e.a.edf(n)&&this.y4d++;e.a.Ohf(n)&&this.qhe++}};a.prototype.Fyd=function(){this.gNc=new Date};a.prototype.Hyd=function(){this.ZWa=this.gkb=new Date};a.prototype.y_g=function(){var n={};return n.numberOfConnectionAttempts=this.HOc,n.numberOfSuccessfulConnections=this.Vkb,n.numberOfFailedConnections=this.nde,n.numberOfDisconnectedConnections=this.lde,
n.numberOfExplicitDisconnectedConnections=this.mde,n.numberOfSentMessages=this.qde,n.numberOfReceivedMessages=this.pde,n.numberOfLostMessages=this.ode,n.firstConnectionAttempt=this.nWa?this.nWa:null,n.firstMessageReceived=this.USb?this.USb:null,n.firstConnectionSuccess=this.SSb?this.SSb:null,n.lastConnectionAttempt=this.QMc?this.QMc:null,n.lastConnectionSuccess=this.Lqa?this.Lqa:null,n.lastConnectionFailure=this.RMc?this.RMc:null,n.lastMessageSent=this.aNc?this.aNc:null,n.lastMessageLost=this.$Mc?
this.$Mc:null,n.lastDisconnect=this.ZWa?this.ZWa:null,n.lastExplicitDisconnect=this.dkb?this.dkb:null,n.lastTimeOnline=this.gkb?this.gkb:null,n.lastTimeOffline=this.gNc?this.gNc:null,n.maxDisconnectedTimeMs=this.Bkb,n.maxExplicitDisconnectedTimeMs=this.QNc,n.clientConnectionErrors=this.y4d,n.serverConnectionErrors=this.qhe,n};a.prototype.p1g=function(){this.nWa&&1===this.Vkb&&(this.Bkb=Math.max(this.Bkb,this.Lqa.getTime()-this.nWa.getTime()));this.ZWa&&1<this.Vkb&&(this.Bkb=Math.max(this.Bkb,this.Lqa.getTime()-
this.ZWa.getTime()));this.dkb&&1<this.Vkb&&(this.QNc=Math.max(this.QNc,this.Lqa.getTime()-this.dkb.getTime()))};a.createInstance=function(n){a.Ma||(a.Ma=new a,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",n));return a.Ma};a.Ma=null;Object(z.a)(a,"RealtimeChannelMetrics",null,[309,202])},1367:function(z,E,b){function a(e,f){var m=c.call(this)||this;m.jP=e;m.i4=f;return m}b.d(E,"a",function(){return a});z=b(0);var c=Sys.EventArgs;Am(a,c);Object(z.a)(a,"PresenceUpdatedEventArgs",
Sys.EventArgs,[])},1445:function(z,E,b){function a(Ma){this.$=Ma}function c(Ma,Hb,ic,Lc,td){var pd=bg.call(this)||this;pd.Hj=null;pd.kzd=!1;pd.lld=null;pd.currentUserId=null;pd.Uae=null;pd.qCd=function(Qe,ff){if(ff.jP){Qe=ff.jP;for(var hf in Qe)(Qe=hf)&&Qe!==pd.currentUserId&&!pd.m0a.has(Qe)&&pd.pcc(Qe).fTj()}};pd.tI=function(){pd.SNf()};pd.Wca=function(Qe,ff){pd.kzd=!0;var hf=Object(Yb.a)(Object,ff.z8);if(1===ff.type)if(Qe=Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",
!1),null===hf||void 0===hf?0:hf[rc.a.v8h]){if(!Qe||!Object(Yb.a)(String,hf[rc.a.N9e]))return;Qe=pd.YCe(Object(Yb.a)(String,hf[rc.a.N9e]));Object(Yb.a)(String,hf[rc.a.O9e])===rc.a.t8h?(Qe=[Qe],Qe[0]===pd.currentUserId||pd.m0a.has(Qe[0])||pd.pcc(Qe[0]).cTj(),pd.dSd(Qe)&&pd.lUa(Qe,null)):Object(Yb.a)(String,hf[rc.a.O9e])===rc.a.u8h&&Qe!==pd.currentUserId&&pd.lUa(null,null)}else{ff=Array.isArray(ff.z8)?ff.z8:null;!ff&&hf&&(ff=Array.isArray(hf[rc.a.dLe])?hf[rc.a.dLe]:null);if(ff&&Qe)for(var yg=Cl(ff),
bf=yg.next();!bf.done;bf=yg.next())bf=bf.value,bf===pd.currentUserId||pd.m0a.has(bf)||pd.pcc(bf).eTj();Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5930962_ProcessPeerNotificationAsFallback")?ff&&!pd.dSd(ff)||pd.lUa(ff,null):ff&&(Qe||!pd.dSd(ff))||pd.lUa(ff,null);return}if(hf)if(0===ff.type){var Cg;(function(){var xd=pd.Iob(hf);Cg=xd.ANf;return xd})().returnValue?(pd.nPa(hf),rc.a.af in hf&&(pd.$.ea.bY(hf[rc.a.af],"ContentRefreshManager.OnUpdateNotificationReceived"),pd.Ycg())):Ub.ULS.sendTraceTag(22905367,
0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",Cg,pd.$.ea.O7)}else{if(3===ff.type){if(!(rc.a.pVf in hf)){Ub.ULS.sendTraceTag(537154117,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}ff=hf[rc.a.pVf];ff===rc.a.Mjj?pd.n5h(hf):ff!==rc.a.Kjj&&ff!==rc.a.Ojj&&ff!==rc.a.Pjj&&ff!==rc.a.Njj&&ff!==rc.a.Ljj&&Ub.ULS.sendTraceTag(537154081,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",ff);return}if(4===
ff.type){Qe=!1;rc.a.uHf in hf&&(Qe=hf[rc.a.uHf]);if(pd.Iob(hf).returnValue)return;pd.$.ea.Zgi()&&pd.H0c();if(pd.$.ea.X7a&&Qe)return;yg=hf[rc.a.SYi];pd.$.ea.sc&&yg&&pd.RYi.qHf(new f(yg,Qe,pd.Svf))}else if(8===ff.type){if(pd.Zaj)return;var Gg=0,xg=hf[rc.a.Ijj],wc=hf[rc.a.Gjj],jd=hf[rc.a.Hjj];rc.a.qVf in hf&&(Gg=hf[rc.a.qVf]);pd.$.ea.sc&&xg&&(Qe=Object(dc.a)(new w,{OcsSessionId:xg,ClientId:wc&&Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?wc:"",SeqNum:jd,XrevidSaved:Gg}),
yg=Array(1),yg[0]=Qe,B(pd.$.na.va,yg,pd.Svf,function(){Ub.ULS.sendTraceTag(537154080,0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",xg,wc,jd,Gg)},null,null))}}2===ff.type?hf&&pd.Iob(hf).returnValue||(Ub.ULS.sendTraceTag(537154079,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),u(pd.$.na.va,null,null,null,null)):12!==ff.type||hf&&pd.Iob(hf).returnValue||pd.raiseEvent("LabelUpdateEventKey")};pd.Svf=
function(Qe){var ff=Qe.Errors;kd.a.lr(ff)?(ff=kd.a.$F(ff,[1552731907],"ContentRefreshManager"),kd.a.zha(ff)||pd.$.ea.Hp(ff)):(ff=Qe.StateId+1,Qe.Result&&pd.$.ea.af<ff&&pd.$.ea.bY(rc.a.Re,"ContentRefreshManager.OnCheckForUpdateSuccess"))};pd.Th=function(){pd.Cjj&&pd.kzd&&pd.$.ea.b8b&&pd.Ycg()};pd.Awf=function(){pd.kzd=!1;pd.$.ea.Lna=500;pd.Uae=Ve.a.Ta.Wb};pd.qEb=function(Qe,ff){pd.xUd(ff.Hj)};pd.$=Ma;pd.Dn=Hb;pd.$.na.Bq(pd.Th);pd.Dn.yZb(pd.qEb);pd.Dn.$ne(pd.Awf);pd.v_j=ic;pd.RYi=Lc;pd.zTj=td;pd.MLa=
{};pd.m0a=new Set;pd.Dn.h0a();Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(pd.currentUserId=pd.$.workbookContext.ClientId,pd.SNf(),pd.$.ea.rha(pd.tI));pd.Zaj=Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:6195367_RemoveWebRequestsForCollabServiceContentUpdates");return pd}function e(Ma,Hb,ic){this.bHc={};this.cHc={};this.At=ic;this.U_b(Ma,this.bHc);this.U_b(Hb,this.cHc)}function f(Ma,Hb,ic){this.Qbh=Ma;this.dnc=Hb;this.At=ic}function m(Ma,Hb,ic,Lc){this.ZCc=
this.Nqc=this.bqc=this.Mec=0;this.C$d=this.ycf=!1;this.clientId=Ma;this.ubh=Hb;this.$=Lc;this.sxi=pe.a.Ae()+ic}function n(Ma,Hb,ic,Lc,td){var pd=pf.call(this)||this;pd.jj=Ma;pd.xoj=Hb;pd.woj=ic;pd.O7=Lc;pd.$_g=td;return pd}function w(){}function h(Ma){var Hb=sf.call(this)||this;Hb.Ie=null;Hb.mergeSuspensionManager=null;Hb.sxa=!1;Hb.nEd=null;Hb.Od=!1;Hb.Jzc=!1;Hb.Hzc=!1;Hb.Izc=!1;Hb.zFb=function(ic,Lc){Hb.sxa!==Lc.sxa&&(Hb.sxa=Lc.sxa,Hb.nEd=Hb.sxa?null:Ve.a.Ta.Wb)};Hb.zd=function(){Hb.$.uv&&Hb.hHj()};
Hb.qd=function(ic,Lc){Lc.sc||Hb.Vr(ic,Lc)};Hb.Vr=function(){if(0<Hb.xAa.length||0<Hb.yea.count)Ub.ULS.sendTraceTag(537154128,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",Hb.xAa.length,Hb.yea.count),Hb.xAa=[],Hb.yea=new df.a;Hb.Yob.cancel();Hb.Ecg();Hb.PYd();Hb.xQj()};Hb.rCf=function(ic,Lc){Hb.fHj();Hb.gHj();ic=new r;ic.Xluid=Lc.jj;ic.NotificationReceivedOn=Ve.a.Ta.Wb.toISOString();ic.CurrentPresenceUserCount=Hb.$.ea.Qm.length;ic.OurCollabModeIsUsingOcs=
Hb.$.ea.X7a;ic.SenderCollabMode=Lc.xoj;ic.SenderClientType=Lc.woj;ic.SessionSiteIdentifier=Lc.O7;ic.CommandTimeInMs=Lc.$_g;Ub.ULS.sendTraceTag(537154127,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(ic));Hb.xAa.push(ic)};Hb.Qi=function(){Hb.UDe(Hb.$.ea.af,"OnBlockCacheConsistent")};Hb.vCf=function(ic,Lc){(ic=Object(Yb.a)(470,Lc.tf))&&Hb.UDe(ic.JJ,"OnRenderedContent")};Hb.QUj=function(){if(!Hb.$.ea.sc)Ub.ULS.sendTraceTag(537154122,13,15,
"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");else if(Hb.xAa.length||Hb.yea.count){var ic=null;0<Hb.xAa.length&&(ic=Hb.xAa,Hb.xAa=[]);var Lc=null;if(0<Hb.yea.count){Lc=Array(Hb.yea.count);for(var td=0,pd=Cl(Hb.yea.values),Qe=pd.next();!Qe.done;Qe=pd.next())Qe=Qe.value,Lc[td++]=Qe;Hb.yea=new df.a}Ub.ULS.sendTraceTag(537154120,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",
ic?ic.length:0,Lc?Lc.length:0);td=Hb.$.na.va;pd=Hb.OUi;Qe=td.Na(1,null);Qe.GenerateNotifications=ic;Qe.DownloadNotifications=Lc;Qc.i(td,"UploadLatencyTelemetry",Qe,pd,null,null,null,128)}};Hb.OUi=function(ic){ic.Result&&0<ic.Result&&Hb.Mwd()};Hb.$=Ma;Hb.Ea=vf.g(Hb.$).Ea;Hb.viewport=vf.g(Hb.$).view;Hb.contentRefreshManager=Hb.$.da.Aa(292);Hb.qf=Hb.$.qf;Hb.xAa=[];Hb.yea=new df.a;Hb.Yob=Pd.a.instance.GC(Hb.QUj,3E4,Tc.a.E2g,!1,!1);Hb.$.tl(Hb.zd);Hb.$.ea.gk(Hb.qd);Hb.$.ea.jWc(Hb.Vr);Hb.$.da.$a(291,function(ic){Hb.Ie=
ic});Hb.$.da.$a(343,function(ic){Hb.Od||(Hb.mergeSuspensionManager=ic,Hb.mergeSuspensionManager.c_b(Hb.zFb),Hb.mergeSuspensionManager.hHb())});Ub.ULS.sendTraceTag(537154131,13,50,"ContentLatencyTracker initialized");Hb.zd(Hb.$,null);return Hb}function y(){}function r(){}function x(Ma){this.$=Ma}function t(Ma){this.$=Ma}function u(Ma,Hb,ic,Lc,td,pd){pd=Ma.Na(1,void 0===pd?null:pd);return Qc.i(Ma,"CheckWorkbookFileNameUpdate",pd,Hb,ic,Lc,td,0)}function B(Ma,Hb,ic,Lc,td,pd,Qe){Qe=Ma.Na(1,void 0===Qe?
null:Qe);Qe.updateInfo=Hb;return Qc.i(Ma,"BatchCheckCollabServiceContent",Qe,ic,Lc,td,pd,516)}function v(Ma,Hb,ic){var Lc=we.call(this)||this;Lc.zFd=null;Lc.$Pa=null;Lc.fFb=function(td,pd){if(pd.jP){td=[];var Qe=[],ff=vf.g(Lc.$).ha,hf=!(2===ff.Ue||128===ff.Ue);ff=hf?de.k(ff.ta.selectedRanges,Lc.$):ff.Oa.oc.floatingObject;pd=pd.jP;for(var yg in pd)Lc.presenceView.EIe(ff,hf,td,Qe,yg);yg=Cl(Lc.qIa);for(pd=yg.next();!pd.done;pd=yg.next())pd=pd.value,Array.contains(td,pd)||Array.contains(Qe,pd)||Lc.presenceView.EIe(ff,
hf,td,Qe,pd.UserID);Lc.qIa=[];Array.addRange(Lc.qIa,td);Array.addRange(Lc.qIa,Qe);Lc.zFd&&(dd.a.Ha(Lc.$Pa),Lc.$Pa=null,Lc.zFd=null);var bf=v.Jve(td,Qe);Lc.$Pa=new Hd.a;Lc.zFd=zb.TaskExtensions.Ba(Fb.Task.delay(1),function(){Lc.ariaLiveNotifier.jbb(bf,oe.a.SZa)},Lc.$Pa.token,3)}};Lc.$=Hb;Lc.ariaLiveNotifier=Ma;Lc.presenceView=ic;Lc.qIa=[];ic.kGa(Lc.fFb);Lc.$.da.Ga(231,Lc);return Lc}function C(Ma){var Hb=Id.call(this)||this;Hb.manager=null;Hb.$=Ma;Hb.Tb();return Hb}function A(Ma,Hb){var ic=Kc.call(this)||
this;ic.Hj=null;ic.fieldManagerPane=null;ic.e0=null;ic.uNb=null;ic.U9f=null;ic.messageId=0;ic.Dp=function(){ic.$&&ic.yOd(0,!1)};ic.gj=function(){ic.pWd?ic.uNb(!1):(ic.xc.PresenceType=1,ic.raiseEvent(A.d1),ic.sendPresenceToService(!1))};ic.Ng=function(){ic.pWd?ic.U9f(!1):(ic.Ucb(!1),ic.uOd())};ic.Bnc=function(){ic.ha.Oa.oc?ic.yOd(1,!1):ic.HOd(0,!1)};ic.Ama=function(Lc,td){ic.raiseEvent(A.xFd,td)};ic.kd=function(){ic.HOd(vf.g(ic.$).isEditing?1:0,!1)};ic.qd=function(Lc,td){Xf.a(td)&&(ic.pra={})};ic.YEb=
function(){ic.aYf()};ic.kFf=function(Lc,td){if(td&&td.methodName in A.jqc){Lc=!1;switch(A.jqc[td.methodName]){case 0:td=td.parameters.cell;break;case 1:td=td.parameters.parameters.Location;break;case 2:td=de.v(ic.ha.ta.activeRange,ic.$);Lc=!0;break;default:return}td.LastColumn=td.FirstColumn;td.LastRow=td.FirstRow;td.NamedObjectName=null;ic.xc.SelectedRange=[td];ic.xc.PresenceType=0;if(Lc){td=[];Lc=Cl(ic.$.Hb.pUh());for(var pd=Lc.next();!pd.done;pd=Lc.next()){pd=pd.value;var Qe={};Qe.ObjectType=ic.oba(pd.type);
Qe.ObjectPresenceType=1;Qe.ObjectId=pd.jj;td.push(Qe)}ic.xc.Object=td}else td=wb(td,ic.$,1),Lc=null,td&&(Lc={},Lc.ObjectType=ic.oba(td.type),Lc.ObjectPresenceType=0,Lc.ObjectId=td.jj),ic.xc.Object=[Lc];ic.raiseEvent(A.d1);ic.sendPresenceToService(!1)}};ic.Wn=function(Lc,td){td.context.methodName in A.jqc&&(ic.xc.Object=[null],ic.Ucb(!1))};ic.Th=function(Lc,td){td.context.methodName in A.jqc&&(ic.xc.Object=[null],ic.Ucb(!1))};ic.zd=function(Lc,td){td.uN||(ic.pra={},Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",
!1)&&ic.$.ya.IsMeetingLiveSession&&ic.$.ya.IsMeetingPresenter&&(ic.xc.MeetingInfo=ic.fgd()),ic.$.uv?ic.N5a():ic.hOb())};ic.Zc=function(){ic.uOd()};ic.Wif=function(){ic.aYf();ic.Ptf.Qz()};ic.$=Ma;ic.ha=vf.g(ic.$).ha;ic.NOa=Hb;ic.Phf=Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);ic.$.tl(ic.zd);ic.$.Zk(ic.Zc);ic.pra={};ic.BXa=new Gb.a(null,null,null,null);ic.OAa={};ic.OAa.b=0;ic.OAa.c=0;ic.Ptf=new M(ic.$);Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",
!1)&&ic.$.ya.IsMeetingLiveSession&&ic.$.ya.IsMeetingPresenter&&(ic.xc.MeetingInfo=ic.fgd());ic.pWd=Fc.EwaSettings.Fb();ic.pWd&&(ic.uNb=ug.a(function(Lc){ic.xc.PresenceType=1;ic.raiseEvent(A.d1);ic.sendPresenceToService(Lc)},40,ic.$.la,"SelectionPresenceManager.SendPresenceToService",!0),ic.U9f=ug.a(function(Lc){ic.Ucb(Lc);ic.uOd()},40,ic.$.la,"SelectionPresenceManager.SendCurrentPresence",!0));return ic}function M(Ma){var Hb=Wb.call(this)||this;Hb.statusBarManager=null;Hb.$=Ma;Hb.$.da.$a(29,function(ic){Hb.statusBarManager=
ic;ic.EJ(Hb)});return Hb}function T(Ma,Hb,ic,Lc,td){td=void 0===td?null:td;var pd=jf.call(this)||this;pd.Tu={};pd.A4b=0;pd.z4b=0;pd.isb=null;pd.Jtd=null;pd.Ymf=3E4;pd.Sjd=!1;pd.ERd=!0;pd.vFd=null;pd.wxf=function(){var Qe=pd.Lma,ff;for(ff in Qe)Qe=ff,pd.$me(Qe)?(pd.Ckc(Qe,!0),delete pd.jab[Qe],delete pd.Lma[Qe]):Ub.ULS.sendTraceTag(537154377,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",Qe)};pd.NCd=function(Qe,ff){Qe={};Qe.UpdatedCount=ff.jP?Object.keys(ff.jP).length:
0;Qe.DisconnectedCount=ff.i4?ff.i4.length:0;Qe.Location="canvas";fd.b(pd.$).Vd(sd.a.EFd,Qe);Qe=null;pd.$.Ob&&(Qe=pd.$.Ob.$g("ModelUpdate","PresenceRendering"),Qe.start());var hf={};if(ff.jP){if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var yg=(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(pd.$.da,435,436,1),function(me){me.result.ywi(yg)},pd.$.la,3)}pd.xub||(pd.qvd(!0),pd.xub=!0);var bf=ff.jP;for(jd in bf){var Cg=bf[jd],Gg=jd;pd.hmd[Gg]=
Ve.a.Ta.Wb;if(!Vc.g(pd.$)||null==Cg.NavigationState)if(pd.dBe(Gg,new Date),pd.QIg(Cg),Gg!==pd.isb){var xg=pd.Tu[Gg];xg||(pd.$me(Gg)?pd.Ckc(Gg,!0):(Gg in pd.Lma?Ub.ULS.sendTraceTag(537154376,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",Gg):(pd.jab[Gg]=Ve.a.Ta.Wb,hf[Gg]=1),pd.Lma[Gg]=!0,xg=pd.CVh(Gg),pd.Tu[Gg]=pd.hGe(xg)),xg=pd.Tu[Gg]);xg&&(xg.xc=Cg,Cg.SelectedRange&&1<Cg.SelectedRange.length?pd.A4b++:pd.z4b++,pd.sQf(Gg),pd.j0a(xg))}}if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&
pd.$.ea&&pd.$.ea.E5a){var wc=(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(pd.$.da,435,436,1),function(me){me.result.zwi(wc)},pd.$.la,3)}}if(ff.i4){var jd=0;for(bf=ff.i4.length;jd<bf;jd++)Gg=ff.i4[jd],pd.h7c[Gg]=Ve.a.Ta.Wb,pd.jQf(Gg,!0)}if(ff.i4&&0<ff.i4.length||0<Af.a(hf).length||0<Af.a(pd.Lma).length)jd=[],Array.addRange(jd,Af.a(hf)),Array.addRange(jd,Af.a(pd.Lma)),(hf=pd.$.da.Aa(292))&&hf.lUa(jd,ff.i4);Qe&&Qe.stop();pd.Sjd=!1;Qe=pd.Tu;for(var xd in Qe)if(0===Object(Yb.a)(Ta,
Qe[xd]).xc.CollabMode){pd.Sjd=!0;break}pd.raiseEvent("pcek",ff)};pd.J8=function(Qe,ff){ff&&pd.$.uv&&(ff.AGa.HasAnyNonOcsCoauthor=pd.Sjd)};pd.YEb=function(){var Qe=new vb.a({},null),ff=pd.oCa,hf;for(hf in ff){var yg=hf,bf=ff[hf].xc;bf.SelectedRange=bf.SelectedRangeRaw;Qe.jP[yg]=bf}pd.NCd(pd,Qe)};pd.kd=function(){pd.m7e()};pd.Axi=function(){pd.Jtd&&kf.a(Ve.a.Ta,pd.Jtd)<pd.Ymf||(pd.Jtd=Ve.a.Ta.Wb,pd.Nud(),pd.Bui(),pd.jvi(),pd.xub||pd.qvd(!1))};pd.fza=function(){pd.m7e();var Qe=pd.Tu,ff;for(ff in Qe)pd.j0a(Qe[ff])};
pd.Zc=function(){pd.Nud();pd.xub||pd.qvd(!1);pd.xub=!1};pd.OBf=function(){var Qe=pd.Tu,ff;for(ff in Qe)Qe[ff].dispose();pd.Tu={};pd.Aze();pd.jab={};pd.uPc={};Array.clear(pd.qy);pd.qyc()};pd.qEb=function(Qe,ff){pd.xUd(ff.Hj)};pd.h7c={};pd.hmd={};pd.jab={};pd.uPc={};pd.$=Ma;pd.NOa=Lc;pd.Dn=Hb;pd.lhe=ic;H.ILb=!0;H.goa=!0;pd.N5a();pd.$w=new I(Ma);pd.$.xa&&pd.$.xa.zg(pd.fza);pd.Dn.yZb(pd.qEb);Ma.na&&pd.$.na.n$(pd.J8);pd.qy=[];pd.Dn.h0a();Ma.da.Ga(25,pd);pd.xub=!1;pd.$.Zk(pd.Zc);pd.UXc=Pd.a.instance.GC(pd.Axi,
pd.Ymf/2,Tc.a.d1i,!0,!1);pd.wFd=td;return pd}function R(Ma,Hb,ic){var Lc=Ta.call(this)||this;Lc.uH=new Md.a(!0);Lc.F3c=0;Lc.G3c=0;Lc.countFloatingObjects=0;Lc.Uq=function(){Lc.FPd()};Lc.fza=function(){Lc.FPd()};Lc.hA=new sb(Ma);Lc.w1f(Ma);Lc.$w=ic;Lc.HQd([]);Lc.$=Hb;Lc.$.xa.zg(Lc.fza);vf.g(Lc.$).XP(Lc.Uq);return Lc}function Q(Ma,Hb,ic){var Lc=Se.call(this,Hb,vf.g(Hb),!0,!1,Ma.User.UserID)||this;Lc.Fz=[];Lc.t2d=46;Lc.dMb=!1;Lc.Bhc=!1;Lc.gFb=function(){Lc.Gp.User.UserID===Q.excelLiveManager.yza.JB&&
(Lc.Fz.forEach(function(td){Lc.w9e(td);Lc.peg(td)}),Lc.Fz=[])};Q.S0a||(Q.S0a={});Lc.Gp=Ma;Lc.tu=new Z(Lc.gridView,Lc.Gp.User.UserID,Lc.Gp.User.UserName,Lc.Gp.UserColor,Lc,ic,Lc.$,Lc.Gp.IsAnonymous);Lc.Wef=Vc.h(Lc.$);Lc.Rli=Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:6191577_PresenterPresenceOnTop");Lc.gFb=Lc.gFb.bind(Lc);Lc.Wef&&Lc.sti();return Lc}function ea(Ma,Hb,ic){this.ih=this.objectId=this.TDa=null;this.Gp=Ma;this.$=Hb;this.$w=ic;this.tu=new Z(vf.g(this.$),this.Gp.User.UserID,this.Gp.User.UserName,
this.Gp.UserColor,null,ic,this.$,this.Gp.IsAnonymous)}function Z(Ma,Hb,ic,Lc,td,pd,Qe,ff){var hf=qb.call(this)||this;hf.Jb=null;hf.Pz={};hf.sle=0;hf.asa=null;hf.ih=null;hf.jra=0;hf.MEb=function(yg){hf.asa&&hf.asa!==yg||(hf.asa=null,hf.s5(!1));hf.raiseEvent("hidePresenceTooltip")};hf.qFb=function(yg){hf.asa&&hf.asa!==yg||(hf.asa=null,hf.hoa(!0,!1));hf.raiseEvent("showPresenceTooltip")};hf.pFb=function(yg){hf.asa||hf.raiseEvent("showFullPresenceTooltip");hf.asa=yg};hf.fFb=function(){hf.s5(!1);hf.raiseEvent("presenceChanged")};
ff=ic===of.a.instance.Ab(87)||ff;hf.FPc=new Gb.a(Hb,ic,Lc,new oc.a,null,null,null,null,ff);hf.gridView=Ma;hf.kTc=Hb;hf.highlight=td;hf.$w=pd;hf.$=Qe;return hf}function ca(Ma,Hb,ic,Lc,td){var pd=pa.call(this)||this;pd.qy=[];pd.I_a=null;pd.visible=!1;pd.IBb=null;pd.Wob=null;pd.bva=!1;pd.zje=null;pd.xCj=function(){dd.a.Ha(pd.Wob);pd.Wob=null;pd.visible&&(pd.TMa()?pd.raiseEvent("showPresenceTooltip"):pd.s5(!0))};pd.MBd=function(Qe){pd.Jbb(Qe)};pd.Rz=function(){pd.bdg()};pd.NF=function(){pd.bdg()};pd.domElement=
Ma;pd.gridView=Hb;pd.kTc=Ma.id;pd.jra=Lc;pd.$=td;pd.vic=!1;pd.B9e();pd.FPc=ic;pd.ih=null;pd.xx={};pd.xx.FirstColumn=0;pd.xx.FirstRow=0;pd.xx.LastColumn=0;pd.xx.LastRow=0;return pd}function I(Ma){var Hb=this;this.wic=!1;this.JB=this.cpa=this.DFd=null;this.MEb=function(ic){var Lc=Hb.pba(ic.Vy);Lc&&Hb.Usc(Lc,ic.Hza.clientId,ic.Vy)};this.qFb=function(ic){Hb.QB(!1,ic)};this.pFb=function(ic){Hb.QB(!0,ic)};this.Rz=function(){Hb.Seg()};this.NF=function(){Hb.Seg()};this.fza=function(){Hb.Irb();Hb.clearCache()};
this.h1h=function(ic){ic=zc.DOMElementExtensions.getBounds(ic.element);ic=new vg.a(ic.x,ic.y,ic.width,ic.height);for(var Lc=Cl(L.hLa()),td=Lc.next();!td.done;td=Lc.next())if(td=Hb.gridView.Tf(td.value),td=zc.DOMElementExtensions.getBoundingClientRect(td.domElement),(new vg.a(td.x,td.y,td.width,td.height)).Kd(ic))return td;return null};this.xUj=function(){var ic=Hb.Pz,Lc;for(Lc in ic){var td=ic[Lc];if(td){var pd=td.TMa(),Qe=Hb.pba(td.Vy),ff=pd?Hb.t2e(td.Oqc,td.paneType,td.range):null;if(ff!==Qe){Qe&&
Hb.Usc(Qe,td.Hza.clientId,td.Vy);if(!H.goa)break;ff&&pd&&(ff.bZa(td.Hza),Hb.yUa[td.Vy]=ff,td.OMb(ff),Hb.B7e(ff,td))}else Hb.B7e(Qe,td)}}};this.m$e=qf.a.ouh;this.Awa=20;this.gridView=vf.g(Ma);this.$=Ma;this.KGb={};this.yUa={};this.Pz={};this.xUa={};this.$.xa&&this.$.xa.zg(this.fza);this.Irb()}function H(){}function L(Ma,Hb,ic){var Lc=ud.call(this)||this;Lc.Cza=null;Lc.oIf=null;Lc.INd=!1;Lc.Rz=function(){Lc.cld()};Lc.NF=function(){Lc.cld()};Lc.gridView=Ma;Lc.rtl=Ma.rtl;Lc.dqd=!1;Lc.Uh=new Md.a(!0);
for(var td=0;4>td;td++)if(Lc.gridView.rb.Zqd(ic,L.hLa()[td])||1===L.hLa()[td]){var pd=Hb.U5g(),Qe=Ma.Tf(L.hLa()[td]).domElement;Qe.insertBefore(pd.element,Qe.firstChild);Lc.Uh.add(Enum.toString(ae,L.hLa()[td]),pd)}return Lc}function U(Ma,Hb,ic){if(!Hb)return null;Ma=Ma.Vq;return new Sys.UI.Point(Hb.x+Ma.x*(ic?1:-1),Hb.y+Ma.y*(ic?1:-1))}function fa(Ma){this.Ee=Ma;this.Ee.$Ya(10,ie.a.instance);this.Ee.$Ya(9,Ig.a.instance);this.Ee.$Ya(6,20);this.Ee.$Ya(13,Re.a.instance);this.Ee.$Ya(17,!1)}function aa(Ma,
Hb,ic){Ma=qa.call(this,Ma)||this;Ma.UDa=!1;Ma.zTb=!1;Ma.w9=!1;Ma.LXa=!1;Ma.MA=[];Ma.sTb={};Ma.Ee=ic;Ma.lj=ic.get(8,!1);Ma.T8d=ic.get(15,!1);Ma.cog=ic.get(12,0);Ma.Nsa=ic.get(6,0);Ma.fXb=Hb;Ma.tke=ic.get(16);Ma.tJc=ic.get(17,!1);Ma.SZj=ic.get(19,!1);Ma.Gug=ic.get(20,!1);Ma.nUb=0;Ma.Cug=new ha(Ma.lj,Ma.tJc);Ma.chb=Ma.DZe();Ma.rPc=!1;Ma.qfa=[];Ma.Cjb=[];Ma.element.id=aa.vHh();Ma.element.className=qa.s$g(Ma.lj);Ma.zsb&&(Ma.zIndex=Ma.zsb);Ma.rtl=Ma.lj;Ma.Zpj(Hb);Ma.Tfa=Ma.createElement("div");Ma.Tfa.className=
"prFlyoutContainer";Ma.element.appendChild(Ma.Tfa);Ma.hM=[];Ma.xqa=new na(Ma.dK,Ma.element,Ma.Nsa,4,6,32,Ma.lj);Ma.zA=ic.get(9);Ma.zA.pa(Sd.a.pointerDown,Ma.xqa.element,Object(yd.a)(Ma,Ma.g$a,"onHitTarget"));Ma.zA.pa(Sd.a.pointerOver,Ma.xqa.element,Object(yd.a)(Ma,Ma.g$a,"onHitTarget"));Ma.zA.pa(Sd.a.pointerOut,Ma.xqa.element,Object(yd.a)(Ma,Ma.g$a,"onHitTarget"));return Ma}function na(Ma,Hb,ic,Lc,td,pd,Qe){this.hM=Ma;this._parent=Hb;this.L4d=ic;this.Zmg=Lc;this.Lqg=td;this.mYa=pd;this.vJ=Qe;this._element=
document.createElement("div");this.element.className="prTouchTarget"}function ha(Ma,Hb){this.lj=void 0===Ma?!1:Ma;this.tJc=void 0===Hb?!1:Hb}function ka(Ma,Hb,ic,Lc){this.offsetTop=Ma;this.offsetLeft=Hb;this.rgg=void 0===ic?2:ic;this.F9e=void 0===Lc?4:Lc}function xa(Ma,Hb){var ic=qa.call(this,Ma)||this;ic.Di=null;ic.zA=null;ic.EHc=null;ic.UKc=null;ic.WGc=null;ic.qqa=null;ic.Zje=null;ic.vJ=Hb.get(8,!1);ic.wib=Hb.get(6,0);ic.Syg=Hb.get(15,!1);ic.Ee=Hb;ic.u7d=0;ic.element=Ma;ic.element.className=xa.oEh;
ic.QG=document.createElement("span");ic.element.appendChild(ic.QG);ic.zog=va.XNh(Hb.get(6,0));ic.Ev(Hb);ic._state=5;return ic}function va(){}function Aa(Ma,Hb){var ic=Jf.call(this)||this;ic.type=Ma;ic.Ktb=Hb;return ic}function qa(Ma){var Hb=Le.call(this)||this;Hb._element=null;Hb.element=Ma;return Hb}function wa(){this.GP={}}function Ta(){var Ma=Xd.call(this)||this;Ma.hA=null;Ma.Yee=null;Ma.$ee=null;return Ma}function sb(Ma){var Hb=Ad.call(this)||this;Hb.dke=Ma;Hb.pra=null;Hb.KPc=null;return Hb}function db(Ma){var Hb=
qc.call(this)||this;Hb.$=Ma;Hb.Tb();return Hb}function kb(Ma){var Hb=this;this.YIf=this.AFd=this.$If=this.WIf=this.hHf=this.YMd=this.rVf=this.yVf=this.xVf=!1;this.BFd=this.pEd=this.uJb=this.xJb=this.Ruc=this.bNd=0;this.xhf=!1;this.zyd=this.Vpb=0;this.Aic=!1;this.qd=function(){Hb.Aic=!0;Hb.$.ea.Fk(Hb.qd)};this.$=Ma;ba.a.iQ&&(this.zyd=window.performance.timing.navigationStart);this.zyd||Ub.ULS.sendTraceTag(537154379,0,15,"Navigation start time is zero");this.$.ea.gk(this.qd)}function ac(){var Ma=Sc.call(this)||
this;Ma.qDe=null;Ma.Tb();return Ma}function ta(){}function ra(){}function Na(Ma){var Hb=this;this.Qa=new Ac.a;this.nfg=this.disposed=!1;this.EFb=function(){Ub.ULS.sendTraceTag(537154381,0,50,"PeopleInfoProvider.OnUserListUpdated fired");Hb.Qa.raiseEvent("UU",Hb)};this.$=Ma;this.$.ea.rha(this.EFb);this.nfg=Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:6220406_UseIsAnonymousForNewPresenceUser")}function gb(Ma){var Hb=fc.call(this)||this;Hb.manager=null;Hb.$=Ma;Hb.Tb();return Hb}function ob(Ma){var Hb=
ge.call(this)||this;Hb.wta=null;Hb.Z0a=null;Hb.hua=!1;Hb.ODc=!1;Hb.If=function(){var ic=Hb.$.ea.Rm;if(null===ic||void 0===ic?0:ic.SheetChanges){ic=Cl(ic.SheetChanges);for(var Lc=ic.next();!Lc.done;Lc=ic.next())if(Lc=Lc.value,2===Lc.Type){if(Hb.wta)for(var td=Cl(Hb.wta),pd=td.next();!pd.done;pd=td.next())pd=pd.value,pd.Range.SheetName===Lc.Name&&(pd.Range.SheetName=Lc.NewName);if(Hb.Z0a)for(td=Cl(Hb.Z0a),pd=td.next();!pd.done;pd=td.next())pd=pd.value,pd.Range.SheetName===Lc.Name&&(pd.Range.SheetName=
Lc.NewName)}}};Hb.czf=function(){Ub.ULS.sendTraceTag(537154395,0,50,"NamedSheetViewConversionManager.OnGridLoaded");Hb.ODc=!1;Hb.qnc(Hb,Sys.EventArgs.Empty)};Hb.Zc=function(){Ub.ULS.sendTraceTag(537154394,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");Hb.ODc=!0};Hb.qnc=function(){Ub.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",Hb.$.ea.Bya);if(!Hb.$.isEditMode||!Hb.$.ea.sc||Hb.$.ea.A5a||Hb.ODc||Hb.$.ea.Bya===rc.a.q6b)Ub.ULS.sendTraceTag(537154393,
0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",Hb.$.isEditMode,Hb.$.ea.sc,Hb.$.ea.A5a,Hb.ODc);else{Hb.wta=null;Hb.Z0a=null;var ic=Hb.$.na.va.hc(),Lc=Hb.$.na.va,td=Hb.EMi,pd=Hb.DMi,Qe=Lc.Na(1,null);Qc.i(Lc,"GetNamedSheetViewConversion",Qe,td,pd,null,ic,132)}};Hb.EMi=function(ic){if(kd.a.lr(ic.Errors)){Hb.hua=!0;var Lc=[-1100324317,-1857233882];kd.a.qh(ic.Errors,Lc)&&Ub.ULS.sendTraceTag(537154392,
0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",kd.a.Xc(ic.Errors));ic=kd.a.$F(ic.Errors,Lc,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");Hb.$.ea.Hp(ic)}else Hb.hua=!1,ic=ic.Result,Hb.$.ea.Bya=ic.ConversionVersion,Hb.g2i(ic.NamedSheetViewConversionEntries),Hb.j4i()};Hb.DMi=function(ic){Hb.hua=!0;ic=gd.a.pg(ic.data);Ub.ULS.sendTraceTag(537154391,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",
kd.a.Xc(ic))};Hb.$=Ma;Ub.ULS.shipAssertTag(537154397,0,!!Hb.$.ea,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");Hb.$.Zk(Hb.Zc);Hb.$.ea.xU(Hb.czf);Hb.$.ea.xGg(Hb.qnc);Hb.$.ea.Ot(Hb.If);Hb.$.ea.mu&&Hb.qnc(Hb,Sys.EventArgs.Empty);return Hb}function wb(Ma,Hb,ic){if(!Hb||!Hb.Hb)return null;for(var Lc=0;Lc<Hb.Hb.count;Lc++){var td=Hb.Hb.getItem(Lc);if(td&&td.type===ic&&td.usedRange&&td.usedRange.contains(de.D(Ma))&&Xe.a.equals(td.sheetName,Ma.SheetName,!0))return td}return null}
function Oa(Ma,Hb){return!!Ma&&!!Hb&&Ma.SheetName===Hb.SheetName&&(!!Ma.NamedObjectName&&Ma.NamedObjectName===Hb.NamedObjectName||!Ma.NamedObjectName&&!Hb.NamedObjectName&&de.D(Ma).Kd(de.D(Hb)))}function sa(){}function Fa(Ma,Hb,ic,Lc,td,pd,Qe,ff,hf){hf=void 0===hf?!1:hf;this.Bpa=null;this.nJc=!0;this.EPc=this.jFa=this.ZFc=null;this.Za=new Ac.a;this.ptg=Ma;this.Gge=Hb;this.Zee=ic;this.Xee=Lc;this.l3d=pd;Fa.se=td;this.Mug=Qe;this.cra=ff;this.mvg=hf;Fb.Task.WAA(Hb,ic).continueWith(Object(yd.a)(this,
this.S$h,"initOnTaskReady"))}function Wa(Ma){var Hb=Ca.call(this)||this;Hb.P3b=null;Hb.zVf=null;Hb.A2=null;Hb.a$d=!1;Hb.OW=function(ic,Lc){if(2===Lc.newState){if(Hb.Hj){if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var td=(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(Hb.$.da,435,436,1),function(pd){pd.result.Swi(td)},Hb.$.la,3)}Hb.raiseEvent("connectionCompleted",new Db(Hb.Hj),Lc)}else Ub.ULS.sendTraceTag(537167630,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");
Hb.P3b=Lc}else if(2===Lc.oldState||0===Lc.newState)Hb.P3b=null,Hb.raiseEvent("connectionLostEventKey")};Hb.mpc=function(){if(Hb.Hj){var ic=Object(Yb.a)(271,Hb.Hj);ic&&(Ub.ULS.sendTraceTag(537167629,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),ic.disconnect(),ic.mIb(Hb.OW))}Hb.A2=null};Hb.$=Ma;Hb.$.Zk(Hb.mpc);Hb.$.ea.jWc(Hb.mpc);Ma.da.$a(38,function(ic){ic.Voe(Hb.mpc)});return Hb}function Db(Ma){var Hb=Ib.call(this)||this;Hb.Hj=Ma;return Hb}function pc(){}function lc(Ma,
Hb,ic,Lc,td,pd,Qe,ff,hf){Qe=void 0===Qe?null:Qe;ff=void 0===ff?null:ff;hf=void 0===hf?null:hf;this.mfe={};this.iHc={};this.sae=new hc.a;this.Fjb=this.wx=this.rWb=null;this.tie=this.sie=0;this.IFa=new cd.a(function(){return Qe.lR("PresenceBootLatencyThreshold",1E4)});this.wDa=new cd.a(function(){return Qe.lR("PresenceBootLatencyCutoffThreshold",6E4)});this.kzg=new cd.a(function(){return Qe.lR("PresenceLightupLatencyThreshold",2E3)});this.Png=new cd.a(function(){return Qe.lR("PresenceLightupLatencyCutoffThreshold",
1E4)});this.Bug=Lc;this.I4d=Ma;this.Fge=Hb;this.nra=ic;this.ji=td;this.tXa=ff;this.cDa=pd;this.Md=hf;this.z3d=!1;this.init()}function eb(Ma,Hb,ic){this.f4d=this.G4d=this.oRb=this.zRb=this.jVa=0;this._id=Ma;this.IFa=Hb;this.wDa=ic;this.mVa=Object(Yb.a)(String,xb.AFrameworkApplication.dc.Application)||""}function ib(Ma,Hb,ic,Lc,td,pd,Qe,ff,hf){this.xhe=!1;this._id=Ma;this.Sp=Hb;this.gM=ic;this.tOc=Lc;this.PSc=td;this.IFa=pd;this.wDa=Qe;this.B4d=ff;this.cDa=hf;this.mVa=Object(Yb.a)(String,xb.AFrameworkApplication.dc.Application)||
""}function cc(){this.ct=this.vt=this.d=0}function Pa(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}function nc(Ma,Hb,ic,Lc){this.O9=null;this.wIc=this.sOc=!1;this.olb=Ma;this.ySc=Hb;this.vb=ic;this.tXa=Lc}function pb(Ma){this.wx=null;this.ARb={};this.wVb={};this.Ejb=null;this.nra=Ma}function rb(Ma,Hb,ic,Lc,td,pd,Qe,ff,hf){this.zee=this.J4d=this.wx=null;this.BQb=Ma;this.iXb=new Ob.a;this.vb=ic;this.jHc=Hb;this.nVa=Lc;this.ji=td;this.wPc=pd;this.nra=Qe;this.Clg=ff;
this.H8d=this.E8d=!1;this.EXb=0;this.H4d=1;this.cDa=hf;this.hke=this.vb.ra("PeoplesWellExtraButtonInfoIsEnabled");this.mVa=Object(Yb.a)(String,xb.AFrameworkApplication.dc.Application)||""}function Ya(Ma,Hb){this.O9=null;this.olb=Ma;this.yug=Hb}b.r(E);var ec=b(0),yd=b(82);Ya.prototype.init=function(){var Ma=this;this.olb.continueWith(function(){Ma.O9=Ma.olb.result;Ma.O9.mZa(Object(yd.a)(Ma,Ma.RF,"onUsersUpdated"))})};Ya.prototype.RF=function(){Ya.Lse(this.O9.rva())&&(this.O9.Atc(Object(yd.a)(this,
this.RF,"onUsersUpdated")),this.yug.IsRealCoauthSession=!0)};Ya.Lse=function(Ma){var Hb,ic=null;Ma=Cl(Ma);for(Hb=Ma.next();!Hb.done;Hb=Ma.next())if(Hb=Hb.value)if(Hb=Hb.isAnonymous||!Hb.email?Hb.clientId:Hb.email.toUpperCase(),!ic)ic=Hb;else if(ic!==Hb)return!0;return!1};Object(ec.a)(Ya,"CoauthTelemetry",null,[859]);var Ub=b(14),Ob=b(161),Yb=b(83),xb=b(4),Sa;(function(Ma){Ma[Ma.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Ma[Ma.notImplemented=1]="notImplemented";Ma[Ma.renderHandled=
2]="renderHandled";Ma[Ma.renderHandledWithVeto=3]="renderHandledWithVeto"})(Sa||(Sa={}));Object(ec.b)("CoauthorGalleryTelemetryEndResult",Sa);var Tb=b(100),Cc=b(112),Fb=b(55);rb.prototype.init=function(){var Ma=this;Fb.Task.WAA.call(null,this.nra,this.jHc,this.wPc).continueWith(function(){Ma.wx=Ma.nra.result;Ma.J4d=Ma.jHc.result;Ma.zee=Ma.wPc.result;Fb.Task.WAA.call(null,Ma.jHc.result.P1c,Ma.wPc.result.HAc).continueWith(function(){Ma.H4d=Ma.J4d.P1c.result;Ma.EXb=Ma.zee.HAc.result;Ma.wx.mZa(Object(yd.a)(Ma,
Ma.ipc,"onUsersUpdatedEventListener"));Ma.wx.rva().length&&Ma.RF()})})};rb.prototype.ipc=function(){this.RF()};rb.prototype.RF=function(){this.Clg(this.wx.rva())?(this.wx.Atc(Object(yd.a)(this,this.ipc,"onUsersUpdatedEventListener")),this.fLi(this.E8d)):this.iXb.ox(1);this.E8d=!0};rb.prototype.fLi=function(Ma){var Hb=this;this.H8d?this.Z6f.continueWith(function(){Ub.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Sa[Hb.Z6f.result])}):(this.H8d=!0,this.E2i(0===
this.H4d&&!Ma))};rb.prototype.E2i=function(Ma){Ma?this.nVa.Lk(4,Object(yd.a)(this,this.KBd,"onInteractiveReady")):this.iXb.ox(1)};rb.prototype.KBd=function(){var Ma=this.ji.FH("AppInitStatus_interactivityReady");Ub.ULS.shipAssertTag(42259235,325,!!this.EXb);var Hb=this.EXb-Ma;Ma={InteractiveTime:Ma};Ma.ReactRenderComplete=this.EXb;Ma.HadTabSwitch=this.cDa();Ma.IsModernGallery=this.hke;Ub.ULS.sendTraceTag(594883104,325,50,Cc.a.toJSON(Ma));this.hke?(Ub.ULS.sendTraceTag(42062997,325,15,Hb.toString()),
this.iXb.ox(this.JWj(Hb)?3:2)):Ub.ULS.sendTraceTag(594883103,325,15,Hb.toString())};rb.prototype.JWj=function(Ma){var Hb=Ma>this.vb.Cd("CoauthorGalleryTimeToRenderDurationMs",1E4),ic="Word"===this.mVa;if(this.cDa())return Ub.ULS.sendTraceTag(50455714,325,50,Hb.toString()),!1;ic&&Tb.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Hb&&(ic&&Tb.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,
!0,null),Ub.ULS.sendTraceTag(42062998,325,15,Ma.toString()));return Hb};Ck.Object.defineProperties(rb.prototype,{Z6f:{configurable:!0,enumerable:!0,get:function(){return this.iXb.task}}});Object(ec.a)(rb,"CoauthorGalleryTelemetry",null,[858]);pb.prototype.ucc=function(Ma){var Hb=this,ic=new Ob.a;this.init().continueWith(function(){Ma in Hb.ARb?ic.ox(Hb.ARb[Ma]):Hb.wVb[Ma]=ic});return ic.task};pb.prototype.init=function(){var Ma=this;if(this.Ejb)return this.Ejb.task;this.Ejb=new Ob.a;this.nra.continueWith(function(){Ma.wx=
Ma.nra.result;Ma.wx.mZa(Object(yd.a)(Ma,Ma.RF,"onUsersUpdated"));Ma.meg();Ma.Ejb.setResult(null)});return this.Ejb.task};pb.prototype.meg=function(){var Ma=this.wx.rva();Ma.sort(Object(yd.a)(this,this.Y0g,"comparePresenceUsers"));this.ARb={};for(var Hb=0;Hb<Ma.length&&Ma[Hb]&&Ma[Hb].tla;Hb++)this.PCg(this.ARb,Ma[Hb].clientId,Hb)};pb.prototype.PCg=function(Ma,Hb,ic){Ma[Hb]=ic;Hb in this.wVb&&(this.wVb[Hb].ox(ic),delete this.wVb[Hb])};pb.prototype.RF=function(){this.meg()};pb.prototype.Y0g=function(Ma,
Hb){return Ma.tla>Hb.tla?1:Ma.tla<Hb.tla?-1:0};Object(ec.a)(pb,"CoauthorPositionFinder",null,[857]);var hc=b(201);nc.prototype.init=function(){var Ma=this;this.olb.continueWith(function(){Ma.O9=Ma.olb.result;Ma.O9.mZa(Object(yd.a)(Ma,Ma.RF,"onUsersUpdated"))})};nc.prototype.RF=function(){this.x_g(this.O9.rva());!this.sOc||this.IGe&&!this.wIc||this.O9.Atc(Object(yd.a)(this,this.RF,"onUsersUpdated"))};nc.prototype.x_g=function(Ma){var Hb=new hc.a,ic=0;Ma=Cl(Ma);for(var Lc=Ma.next();!Lc.done;Lc=Ma.next())(Lc=
Lc.value)&&Lc.isAnonymous&&(xb.AFrameworkApplication.Dvd("70eb6120;2gfeb930"),this.IGe&&!this.wIc&&(Hb.contains(Lc.userName)?(Ub.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected"),this.wIc=!0):Hb.add(Lc.userName)),Lc.clientId===this.tXa||this.sOc||(ic++,2<=ic&&this.iwi()))};nc.prototype.iwi=function(){var Ma=this;Ub.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.sOc=!0;this.c3h&&this.ySc&&this.ySc.continueWith(function(){window.setTimeout(function(){Ma.ySc.result.logActivity("MultipleGuestsCoauthoring",
null)},5E3)})};Ck.Object.defineProperties(nc.prototype,{IGe:{configurable:!0,enumerable:!0,get:function(){return this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}},c3h:{configurable:!0,enumerable:!0,get:function(){return this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)}}});Object(ec.a)(nc,"GuestCoauthTelemetry",null,[]);var cd=b(614);Object(ec.a)(Pa,"PL",null,[]);var mb=b(41);cc.yYf=function(Ma,Hb,ic){var Lc=
new cc;Lc.d=Ma;Lc.vt=Hb;Lc.ct=ic;return mb.c(Lc)};Object(ec.a)(cc,"VD",null,[]);var $a=b(356);ib.prototype.veto=function(Ma){var Hb=this;Fb.Task.WAA(this.tOc,this.PSc).continueWith(function(){if(Hb.tOc.result<=Hb.PSc.result)Ma.ox(!1);else{var ic=Hb.gM-Hb.Sp,Lc=new Pa;Lc.id=Hb._id;Lc.et=Hb.gM;Lc.st=Hb.Sp;Lc.d=Hb.gM-Hb.Sp;Lc.mp=Hb.tOc.result;Lc.tp=Hb.PSc.result;Lc.ct=Hb.lMh(Hb.B4d);Lc.vc=Hb.cDa();var td=mb.c(Lc),pd="Word"===Hb.mVa;Ub.ULS.sendTraceTag(42078597,302,15,td);if(pd){var Qe=new Map;Qe.set("data",
td);Tb.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Qe)}ic>Hb.IFa.value&&!Hb.xhe&&!Lc.vc&&(Hb.xhe=!0,Ma.ox(!0),Lc=Object.assign(new $a.a,{inStaging:!0,extendedProperties:new Map}),Lc.extendedProperties.set("data",td),pd&&Tb.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Lc),ic<Hb.wDa.value&&Ub.ULS.sendTraceTag(42078598,302,15,cc.yYf(ic,Hb.IFa.value,Hb.wDa.value)));Ma.task.isCompleted||Ma.ox(!1)}})};ib.prototype.lMh=
function(Ma){switch(Ma){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}};Object(ec.a)(ib,"PresenceLatencyActivityLogger",null,[]);eb.prototype.C0c=function(){!this.SAe&&this.jVa&&this.zRb&&(this.G4d=this.veto(this.zRb,"CoauthGalleryLightupDurationTooLong"));!this.Pxe&&this.jVa&&this.oRb&&(this.f4d=this.veto(this.oRb,"CanvasPresenceLightupDurationTooLong"))};eb.prototype.veto=function(Ma,Hb){var ic=Ma-this.jVa,Lc=new Pa;Lc.id=this._id;Lc.et=Ma;Lc.st=this.jVa;
Lc.d=ic;var td=mb.c(Lc);Ma="Word"===this.mVa;Lc="CanvasPresenceLightupDurationTooLong"===Hb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Hb?Ub.ULS.sendTraceTag(572289499,302,15,td):Ub.ULS.sendTraceTag(571524118,302,15,td);if(Ma){var pd=new Map;pd.set("data",td);Tb.Health.instance.recordKpiUsage(Lc,0,"wordcollabrel",pd)}return ic>this.IFa.value?(pd=Object.assign(new $a.a,{inStaging:!0,extendedProperties:new Map}),pd.extendedProperties.set("data",
td),td=ic<this.wDa.value,pd.extendedProperties.set("cash",td?"true":"false"),Ma&&Tb.Health.instance.recordKpiFailure(Lc,Hb,!1,!0,pd),Ub.ULS.sendTraceTag(572289500,302,15,cc.yYf(ic,this.IFa.value,this.wDa.value)),td?2:1):3};Ck.Object.defineProperties(eb.prototype,{WIg:{configurable:!0,enumerable:!0,get:function(){return this.jVa},set:function(Ma){this.jVa=Ma;this.C0c()}},p_g:{configurable:!0,enumerable:!0,get:function(){return this.zRb},set:function(Ma){this.zRb=Ma;this.C0c()}},HVg:{configurable:!0,
enumerable:!0,get:function(){return this.oRb},set:function(Ma){this.oRb=Ma;this.C0c()}},SAe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.G4d}},Pxe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.f4d}}});Object(ec.a)(eb,"PresenceLightupLatencyLogger",null,[]);var K=b(58),ba=b(333);lc.prototype.ulh=function(Ma,Hb,ic){var Lc=this;ic=void 0===ic?null:ic;var td=void 0===td?0:td;ic&&(Ub.ULS.shipAssertTag(42274970,302,!this.tXa||this.tXa===ic,"_myClientId is already set and you are trying to update it to something different"),
this.tXa=ic);var pd=new Ob.a;this.init().continueWith(function(){Lc.LQi(Ma);Lc.vlh(pd,Ma,Hb,td)})};lc.prototype.init=function(){var Ma=this;if(this.Fjb)return this.Fjb.task;this.Fjb=new Ob.a;this.cDa()&&Ub.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.I4d.continueWith(function(){var Hb=Ma.I4d.result,ic=Hb.P1c,Lc=Hb.gCi;Lc.continueWith(function(){ic.continueWith(function(){Ma.Md&&Ma.Md.addQosPillar("RealTimeCoauth");Ma.RFj(ic.result,Lc.result);Ma.Fjb.setResult(null)})})});this.Fge.continueWith(function(){Ma.rWb=
Ma.Fge.result;Ma.rWb.eGa(Object(yd.a)(Ma,Ma.QRi,"onRtcConnection"));Ma.rWb.lZa(Object(yd.a)(Ma,Ma.UIi,"onCoauthorBootReceived"))});this.nra.continueWith(function(){Ma.wx=Ma.nra.result;Ma.wx.mZa(Object(yd.a)(Ma,Ma.ipc,"onUsersUpdatedEventListener"));0<Ma.wx.rva().length&&Ma.RF()});return this.Fjb.task};lc.prototype.NYe=function(){return this.ji.tta(K.a.vUa)?this.ji.FH(K.a.vUa):ba.a.iQ?window.performance.timing.fetchStart:-1};lc.prototype.QRi=function(Ma,Hb){this.z3d||2!==Hb.newState||(Ma=Date.now()-
this.NYe(),Hb={},Hb.clientId=this.Yrf,Hb.bootTime=Ma,this.z3d=!0,this.rWb.fea(15,Hb))};lc.prototype.UIi=function(Ma,Hb){if(15===Hb.type){Ma=Date.now();Hb=Hb.z8;var ic=Hb.bootTime;this.$fd(Hb.clientId).WIg=Ma-ic}};lc.prototype.ipc=function(){this.RF()};lc.prototype.RF=function(){var Ma=Date.now(),Hb=this.wx.rva(),ic=new hc.a;Hb=Cl(Hb);for(var Lc=Hb.next();!Lc.done;Lc=Hb.next())Lc=Lc.value,this.sae.contains(Lc.clientId)||(this.sae.add(Lc.clientId),ic.add(Lc.clientId));if(0<ic.count)for(ic=Cl(ic),Hb=
ic.next();!Hb.done;Hb=ic.next())Hb=this.$fd(Hb.value),Hb.SAe||(Hb.p_g=Ma)};lc.prototype.LQi=function(Ma){Ma=this.$fd(Ma);Ma.Pxe||(Ma.HVg=Date.now())};lc.prototype.$fd=function(Ma){return Ma in this.iHc?this.iHc[Ma]:this.iHc[Ma]=new eb(Ma,this.kzg,this.Png)};lc.prototype.RFj=function(Ma,Hb){Hb=void 0===Hb?0:Hb;this.sie=Ma;this.tie=Hb?Hb:(new Date).getTime()};lc.prototype.vlh=function(Ma,Hb,ic,Lc){ic=ic?ic.getTime():(new Date).getTime();Hb in this.mfe?Ma.gA():(Lc=new ib(Hb,this.GZh(),ic,this.ucc(this.Yrf),
this.ucc(Hb),this.IFa,this.wDa,Lc,this.cDa),this.mfe[Hb]=Lc,Lc.veto(Ma))};lc.prototype.GZh=function(){return 1===this.sie?this.tie:this.NYe()};lc.prototype.ucc=function(Ma){return this.Bug.ucc(Ma)};Ck.Object.defineProperties(lc.prototype,{Yrf:{configurable:!0,enumerable:!0,get:function(){return this.tXa||"{"+xb.AFrameworkApplication.userSessionId+"}"}}});Object(ec.a)(lc,"PresenceBootTelemetry",null,[775]);var ua=b(140),La=b(255),ub=b(223),Va=b(85),tb=b(566);pc.prototype.fi=function(Ma){var Hb=this;
Ma.register(Ya,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").Ic().Oc(function(){return new Ya(tb.a.dr(Ma.lc("Common.IPeopleInfoProvider")),xb.AFrameworkApplication.ag)});Ma.register(rb,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").Ic().Oc(function(){return new rb(xb.AFrameworkApplication.Ib,tb.a.dr(Ma.lc("Common.ICoauthoringTelemeryInfoProvider")),xb.AFrameworkApplication.ga,ua.a.get_instance(),ub.a.instance,
tb.a.dr(Ma.lc("Common.IPeoplesWell")),tb.a.dr(Ma.lc("Common.IPeopleInfoProvider")),Ya.Lse,function(){return Hb.rve()})});Ma.register(lc,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").Ic().Oc(function(){return new lc(tb.a.dr(Ma.lc("Common.ICoauthoringTelemeryInfoProvider")),tb.a.dr(Ma.lc("Common.IRealtimeChannelBasic")),tb.a.dr(Ma.lc("Common.IPeopleInfoProvider")),Ma.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),ub.a.instance,
function(){return Hb.rve()},xb.AFrameworkApplication.ga,null,Tb.Health.instance)});Ma.register(pb,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").Ic().Oc(function(){return new pb(tb.a.dr(Ma.lc("Common.IPeopleInfoProvider")))});Ma.register(nc,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").Ic().Oc(function(){return new nc(tb.a.dr(Ma.lc("Common.IPeopleInfoProvider")),tb.a.dr(Ma.lc("Common.ISystemInitiatedFeedback")),xb.AFrameworkApplication.ga,
"{"+xb.AFrameworkApplication.userSessionId+"}")})};pc.prototype.init=function(){xb.AFrameworkApplication.ga.tv(function(){Va.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();Va.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();xb.AFrameworkApplication.ga.ra("CoauthorGalleryTelemetryIsEnabled")&&Va.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();xb.AFrameworkApplication.ga.ra("CashTelemetryIsEnabled")&&(Va.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),
Va.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};pc.prototype.dispose=function(){};pc.prototype.rve=function(){return ba.a.iQ&&ub.a.instance.tta(K.a.SOb)?0<ub.a.instance.FH(K.a.SOb)[K.a.Hgg]:!1};pc.main=function(){La.a.instance.hj(new pc)};Ck.Object.defineProperties(pc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});Object(ec.a)(pc,"CoauthTelemetryPackage",null,[4,5]);var Cb=b(1012),nb=b(38),Ib=Sys.EventArgs;Am(Db,
Ib);Object(ec.a)(Db,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var hb=b(51),zb=b(36),Gc=b(54),Fc=b(1),Ed=b(49),Jc=b(1294),Ca=nb.a;Am(Wa,Ca);Wa.prototype.yZb=function(Ma){this.addHandler("connectionCompleted",Ma)};Wa.prototype.ZJd=function(Ma){this.removeHandler("connectionCompleted",Ma)};Wa.prototype.fWc=function(Ma){this.addHandler("rtcInitialized",Ma)};Wa.prototype.AIb=function(Ma){this.removeHandler("rtcInitialized",Ma)};Wa.prototype.$ne=function(Ma){this.addHandler("connectionLostEventKey",
Ma)};Wa.prototype.NQf=function(Ma){this.removeHandler("connectionLostEventKey",Ma)};Wa.prototype.dispose=function(){this.Hj&&this.Hj.mIb(this.OW);this.$&&this.$.sm(this.mpc);this.A2=this.$=null;Ca.prototype.dispose.call(this)};Wa.prototype.IFe=function(Ma){zb.TaskExtensions.Ba(this.e3e().task,function(Hb){Ma(Hb.result)},this.la)};Wa.prototype.tCe=function(Ma,Hb){this.a$d=Hb;this.ePi(Ma)};Wa.prototype.h0a=function(){this.Hj&&(this.raiseEvent("rtcInitialized"),2===this.Hj.connectionState&&this.P3b&&
this.raiseEvent("connectionCompleted",new Db(this.Hj),this.P3b))};Wa.prototype.Yti=function(){Ub.ULS.sendTraceTag(537167633,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5856505_RtcDownloadBreakDownMetrics")){var Ma=(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(this.$.da,435,436,1),function(Lc){Lc.result.Vwi(Ma)},this.$.la,3)}var Hb=[];Hb.push(Gc.a.current.np(43));Hb.push(Gc.a.current.np(44));Hb=Gc.a.vud(Hb,this.$.la);
var ic=Gc.a.loadScript(10,0,1);return Fb.Task.WAA.call(null,Hb,ic)};Wa.prototype.ePi=function(Ma){var Hb=this,ic=this.Yti();zb.TaskExtensions.Ba(ic,function(){Ub.ULS.sendTraceTag(537167632,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===Cb.RealtimeChannel||null===Cb.RealtimeChannel);if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Lc=(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(Hb.$.da,
435,436,1),function(Qe){Qe.result.Wwi(Lc)},Hb.$.la,3)}Hb.A2=Cb.RealtimeChannel.createInstance(Ma,Hb.$.ya.UserSessionId,xb.AFrameworkApplication.AVf,xb.AFrameworkApplication.Jd,null,2,Ed.b().b5e(),Hb.$.workbookContext.RtcEndpointUrl,void 0,new Jc.a,void 0,void 0,Hb.$.workbookContext.RtcBootToken);Ub.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&
(Va.a.instance.register(Cb.RealtimeChannel,"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").Ic().Oc(function(){return Hb.Hj}),Va.a.instance.resolve("Common.IRealtimeChannelBasic"));Hb.e3e().setResult(Hb.Hj);if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var td=(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(Hb.$.da,435,436,1),function(Qe){Qe.result.Uwi(Hb.vod,td)},Hb.$.la,
3)}Hb.raiseEvent("rtcInitialized");Ub.ULS.sendTraceTag(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var pd=Object(Yb.a)(271,Hb.Hj);pd&&(Ub.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),pd.eGa(Hb.OW),pd.connect())},this.la,3)};Wa.prototype.e3e=function(){return this.zVf||(this.zVf=new Ob.a)};Wa.ka=function(Ma){Ma.da.Ga(26,new Wa(Ma))};Ck.Object.defineProperties(Wa.prototype,
{Hj:{configurable:!0,enumerable:!0,get:function(){return this.A2}},vod:{configurable:!0,enumerable:!0,get:function(){return this.a$d}}});Object(ec.a)(Wa,"RealTimeChannelController",nb.a,[8,9]);var bb=b(11),dc=b(7),Ac=b(97),nd=b(108),qd=b(27);Fa.prototype.hMf=function(){this.Za.raiseEvent("u",null,this)};Fa.prototype.S$h=function(){this.Gge.result&&this.Zee.result&&(this.jFa=this.Gge.result,this.EPc=this.Zee.result,this.jFa.lGa(Object(yd.a)(this,this.Ama,"onPresenceUpdated")),this.ZFc=new nd.a(2,2,
this.l3d,Object(yd.a)(this,this.XQj,"updateAwayClientsTask"),88),Fa.se.Yg(this.ZFc))};Fa.prototype.Ama=function(Ma,Hb){(this.nJc||this.d7i(Hb.jP))&&Fa.se.pna(this.ZFc,0)};Fa.prototype.d7i=function(Ma){for(var Hb in Ma){var ic=this.Xee.u2e({key:Hb,value:Ma[Hb]});if(ic&&ic.clientId&&(ic=ic.clientId.toLowerCase(),(ic=this.Bpa[ic]||this.Bpa[ic.toUpperCase()])&&2===ic.status))return!0}return!1};Fa.prototype.XQj=function(Ma){var Hb=this.jFa.PJh();if(Hb){var ic=new Date,Lc=!1;if(this.nJc){this.Bpa=Hb;this.nJc=
!1;Hb=this.Bpa;for(var td in Hb){var pd=td,Qe=Hb[td];Qe.x8a<ic&&(ic=Qe.x8a);2===Qe.status&&(Lc=!0,this.EPc.uQf(pd))}Lc&&this.hMf();Fa.se.pna(Ma,this.w1e(ic))}else{Qe=new hc.a;td=!1;var ff=this.Bpa;for(pd in ff)if(ff=pd,ff in this.Bpa&&this.ptg.clientId!==ff){var hf=this.Bpa[ff],yg=Hb[ff];if(hf&&yg){hf=hf.status;var bf=yg.status;2===hf&&1===bf?(Qe.add(ff),Ub.ULS.sendTraceTag(38052609,392,50,ff+" returned from away")):1===hf&&2===bf&&(td=Lc=!0,this.EPc.uQf(ff),Ub.ULS.sendTraceTag(38052610,392,50,ff+
" went away"));1===bf&&yg.x8a<ic&&(ic=yg.x8a)}}this.Bpa=Hb;Fa.se.pna(Ma,this.w1e(ic));(0<Qe.count||Lc)&&this.hMf();0<Qe.count&&!this.mvg?(Ma=this.rMh(Qe),this.eLj(Ma)):Ma=new hc.a;(td||0<Ma.count)&&this.Mug(qd.a.O1c,2)}}};Fa.prototype.eLj=function(Ma){if(Ma.count){Ma=Cl(Ma);for(var Hb=Ma.next();!Hb.done;Hb=Ma.next())Hb=this.cra.laa(String.format(CommonUIStrings.l_EditorsToastArriving,Hb.value),!1),Hb.image=5,Hb.Cka="CoAuth_AuthorStatus_16x16x32",this.cra.oE(Hb)}};Fa.prototype.rMh=function(Ma){var Hb=
this.jFa.Odd(),ic=new hc.a,Lc;for(Lc in Hb){var td={key:Lc,value:Hb[Lc]};if(Ma.contains(td.key)){var pd=this.Xee.u2e(td);pd&&(ic.add(pd.userName),Ma.remove(td.key))}}ic.count||Ub.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return ic};Fa.prototype.w1e=function(Ma){var Hb=new Date;return Math.max(Ma.getTime()+this.l3d-Hb.getTime(),0)};Fa.se=null;Object(ec.a)(Fa,"AwayManager",null,[]);var Gb=b(1368),Oc=b(103),he=b(303),Wd=b(226);Object(ec.a)(sa,"NamedSheetViewConversionEntry",
null,[]);var rc=b(9),gd=b(119),kd=b(30),Qc=b(84),de=b(45),Xe=b(22),ge=nb.a;Am(ob,ge);ob.prototype.Joe=function(Ma){this.addHandler("SVCU",Ma)};ob.prototype.oRf=function(Ma){this.removeHandler("SVCU",Ma)};ob.prototype.dispose=function(){this.Z0a=this.wta=null;this.$&&this.$.sm(this.Zc);this.$.ea&&(this.$.ea.zS(this.czf),this.$.ea.Tcj(this.qnc),this.$.ea.Gv(this.If));this.$=null;ge.prototype.dispose.call(this)};ob.prototype.I3g=function(Ma){return this.hua?null:this.gDe(Ma,this.Z0a,"ConvertPresencePublicToPrivate")};
ob.prototype.H3g=function(Ma){return this.hua?null:this.gDe(Ma,this.wta,"ConvertPresencePrivateToPublic")};ob.prototype.g2i=function(Ma){Ma?(this.Ich(Ma),this.wta=Ma,this.Z0a=this.W7g(this.wta)):Ub.ULS.sendTraceTag(537154396,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};ob.prototype.j4i=function(){Ub.ULS.sendTraceTag(537154390,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");
this.raiseEvent("SVCU")};ob.prototype.gDe=function(Ma,Hb,ic){if(!Hb||!Hb.length)return Ub.ULS.sendTraceTag(537154389,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",ic,Hb?"empty":"null"),Ma;ic=Cl(Ma);for(var Lc=ic.next();!Lc.done;Lc=ic.next()){Lc=Lc.value;for(var td=Cl(Hb),pd=td.next();!pd.done;pd=td.next())if(pd=pd.value,pd.IsRow&&Oa(pd.Range,Lc)&&!(Lc.FirstRow<=pd.Range.FirstRow&&Lc.LastRow>=pd.Range.LastRow)){var Qe={};Qe.SheetName=Lc.SheetName;Qe.FirstRow=
Qe.LastRow=Lc.FirstRow;Qe.FirstColumn=Qe.LastColumn=Lc.FirstColumn;Oa(pd.Range,Qe)?(Qe=Lc.FirstRow-pd.Range.FirstRow,0>Qe||Qe>=pd.ConversionMap.length?Ub.ULS.sendTraceTag(537154388,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",Qe,pd.ConversionMap.length):(Qe=pd.ConversionMap[Qe]-Qe,Lc.FirstRow+=Qe,Lc.LastRow=Lc.FirstRow,Lc.LastColumn=Math.min(Lc.LastColumn,pd.Range.LastColumn))):Lc.FirstRow<pd.Range.FirstRow&&Lc.LastRow>=
pd.Range.FirstRow?Lc.LastRow=pd.Range.FirstRow-1:Lc.LastColumn>=pd.Range.FirstColumn&&(Lc.LastColumn=pd.Range.FirstColumn-1)}if(0>Lc.FirstRow||Lc.FirstRow>rc.a.zy)Lc.FirstRow=Math.max(Math.min(Lc.FirstRow,rc.a.zy),0);if(0>Lc.LastRow||Lc.LastRow>rc.a.zy)Lc.LastRow=Math.max(Math.min(Lc.LastRow,rc.a.zy),0);if(0>Lc.FirstColumn||Lc.FirstColumn>rc.a.yv)Lc.FirstColumn=Math.max(Math.min(Lc.FirstColumn,rc.a.yv),0);if(0>Lc.LastColumn||Lc.LastColumn>rc.a.yv)Lc.LastColumn=Math.max(Math.min(Lc.LastColumn,rc.a.yv),
0)}return Ma};ob.prototype.W7g=function(Ma){if(!Ma||!Ma.length)return Ub.ULS.sendTraceTag(537154387,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.wta?"empty":"null"),Ma;for(var Hb=Array(Ma.length),ic=0;ic<Ma.length;++ic){var Lc=new sa;Lc.Range=Ma[ic].Range;Lc.IsRow=Ma[ic].IsRow;Lc.ConversionMap=Array(Ma[ic].ConversionMap.length);Lc.IsRow||(this.hua=!0,Ub.ULS.sendTraceTag(537154386,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));
for(var td=0;td<Ma[ic].ConversionMap.length;++td)Lc.ConversionMap[Ma[ic].ConversionMap[td]]=td;Hb[Ma.length-ic-1]=Lc}return Hb};ob.prototype.Ich=function(Ma){if(Ma&&Ma.length){Ma=Cl(Ma);for(var Hb=Ma.next();!Hb.done;Hb=Ma.next()){Hb=Hb.value;this.Hch(Hb);var ic=Hb.IsRow?Hb.Range.LastRow-Hb.Range.FirstRow+1:Hb.Range.LastColumn-Hb.Range.FirstColumn+1;Hb.ConversionMap.length!==ic&&(Ub.ULS.shipAssertTag(537154385,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",
ic,Hb.ConversionMap.length),this.hua=!0)}}};ob.prototype.Hch=function(Ma){var Hb=Ma.ConversionMap;if(Hb&&Hb.length)if(0>Hb[0])Ub.ULS.shipAssertTag(537154384,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.hua=!0;else{for(var ic=[],Lc=0;Lc<Hb.length;++Lc)if(0>Hb[Lc])for(var td=Hb[Lc-1],pd=-1*Hb[Lc],Qe=1;Qe<=pd;++Qe)ic.push(td+Qe);else ic.push(Hb[Lc]);Ma.ConversionMap=ic}};Object(ec.a)(ob,"NamedSheetViewConversionManager",nb.a,[882,2]);
var fc=Wd.a;Am(gb,fc);gb.prototype.create=function(){this.Eb(this.manager||(this.manager=new ob(this.$)))};Object(ec.a)(gb,"NamedSheetViewConversionManagerFactory",Wd.a,[]);var dd=b(90),oc=b(1207);Na.prototype.dispose=function(){this.disposed||(this.$&&this.$.ea&&this.$.ea.Kda(this.EFb),dd.a.yc([this.Qa]),this.$=this.Qa=null,this.disposed=!0)};Na.prototype.mZa=function(Ma){this.Qa.addHandler("UU",Ma)};Na.prototype.Atc=function(Ma){this.Qa.removeHandler("UU",Ma)};Na.prototype.rva=function(){for(var Ma=
[],Hb=Cl(this.$.ea.Qm),ic=Hb.next();!ic.done;ic=Hb.next())Ma.push(this.fWh(ic.value));Ub.ULS.sendTraceTag(537154383,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",Ma.length);return Ma};Na.prototype.fWh=function(Ma){return new Gb.a(Ma.User.UserID,Ma.User.UserName,Ma.UserColor,new oc.a(1),null,Ma.UserEmail,void 0,void 0,this.nfg?Ma.IsAnonymous:void 0,void 0,void 0,Ma.JoinCoauthTime)};Object(ec.a)(Na,"PeopleInfoProvider",null,[131,2]);var Zb=b(734);ra.prototype.oE=function(){Ub.ULS.sendTraceTag(537154380,
0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};ra.prototype.removeEntry=function(){};ra.prototype.laa=function(Ma,Hb){return new Zb.a(Ma,Hb)};ra.prototype.dispose=function(){};Ck.Object.defineProperties(ra.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ck.Object.defineProperties(ra,{instance:{configurable:!0,enumerable:!0,get:function(){ra.Ma||(ra.Ma=new ra);return ra.Ma}}});ra.Ma=null;Object(ec.a)(ra,"NoOpNotificationBar",
null,[367,2]);ta.prototype.u2e=function(Ma){var Hb=Ma.key;Ma=Ma.value;if(!Ma)return null;var ic=Ma.SupportsChat?4:0;return Object(dc.a)(new Gb.a,{clientId:Hb,B0c:Ma.ChatThreadId,A0c:Ma.ChatThreadDiscoveryUri,myb:Ma.InChat,email:Ma.Cid,capabilities:new oc.a(ic)})};Object(ec.a)(ta,"PresenceConverter",null,[880]);var Sc=Wd.a;Am(ac,Sc);ac.prototype.create=function(){this.Eb(this.qDe||(this.qDe=new ta))};ac.ka=function(Ma){Ma.da.Ga(159,new ac)};Object(ec.a)(ac,"PresenceConverterFactory",Wd.a,[]);var sd=
b(131),fd=b(132);kb.prototype.Vwi=function(Ma){this.xVf||(this.bNd=Ma,this.xVf=!0)};kb.prototype.Wwi=function(Ma){this.yVf||(this.Ruc=Ma,this.yVf=!0)};kb.prototype.Uwi=function(Ma,Hb){this.rVf||(this.xJb=Hb,this.xhf=Ma,this.rVf=!0)};kb.prototype.Swi=function(Ma){this.YMd||(this.uJb=Ma,this.YMd=!0)};kb.prototype.ywi=function(Ma){!this.AFd&&this.YMd&&(this.BFd=Ma,this.AFd=!0)};kb.prototype.vwi=function(Ma){this.hHf||(this.pEd=Ma,this.hHf=!0)};kb.prototype.xwi=function(Ma){if(!this.WIf&&this.yha&&!this.Aic){this.WIf=
!0;var Hb=this.qed();Hb.RtcIntializeToPeopleWellServiceCreate=this.pEd-this.xJb;Hb.PeopleWellServiceCreateToPresenceGalleryRender=Ma-this.pEd;Hb.PresenceGalleryRenderTotalTime=Ma-this.yha;fd.b(this.$).Vd(sd.a.XIf,Hb,void 0,!0)}};kb.prototype.Awi=function(Ma){if(!this.$If&&this.yha&&!this.Aic){this.$If=!0;var Hb=this.qed();Hb.RtcIntializeToRtcConnect=this.uJb-this.xJb;Hb.RtcConnectToPresenceSent=Ma-this.uJb;Hb.PresenceSentTotalTime=Ma-this.yha;fd.b(this.$).Vd(sd.a.aJf,Hb,void 0,!0)}};kb.prototype.zwi=
function(Ma){if(!this.YIf&&this.AFd&&this.yha&&!this.Aic){this.YIf=!0;var Hb=this.qed();Hb.RtcIntializeToRtcConnect=this.uJb-this.xJb;Hb.RtcConnectToPresenceRenderInitiate=this.BFd-this.uJb;Hb.PresenceRenderInitiateToPresenceRenderFinish=Ma-this.BFd;Hb.PresenceRenderTotalTime=Ma-this.yha;fd.b(this.$).Vd(sd.a.ZIf,Hb,void 0,!0)}};kb.prototype.dispose=function(){this.$=null};kb.prototype.qed=function(){var Ma={};Ma.CoAuthorCountsOnBoot=this.$.ea.Qm.length;Ma.RtcConnectedLaterInSession=this.xhf;Ma.BrowserVisibilityChanged=
this.kQg();Ma.AppInteractiveAbsTime=this.yha;Ma.NavigationStartTime=this.zyd;Ma.AppInteractiveToRtcSliceDownloadInitialize=this.bNd-this.yha;Ma.RtcSliceDownloadInitializeToRtcSliceLoad=this.Ruc-this.bNd;Ma.AppInteractiveToRtcSliceLoad=this.Ruc-this.yha;Ma.RtcSliceLoadToRtcInitialize=this.xJb-this.Ruc;return Ma};kb.prototype.kQg=function(){return ba.a.iQ&&ub.a.instance.tta(K.a.SOb)?0<ub.a.instance.FH(K.a.SOb)[K.a.Hgg]:!1};Ck.Object.defineProperties(kb.prototype,{yha:{configurable:!0,enumerable:!0,
get:function(){if(this.Vpb)return this.Vpb;ub.a.instance.tta("AppInitStatus_interactivityReady")&&(this.Vpb=ub.a.instance.FH("AppInitStatus_interactivityReady"));this.Vpb||Ub.ULS.sendTraceTag(537154378,0,15,"App interactive time is zero");return this.Vpb}}});Object(ec.a)(kb,"PresenceTelemetry",null,[881,2]);var qc=Wd.a;Am(db,qc);db.prototype.create=function(){this.Eb(this.$.da.Aa(435)||this.$.da.Ga(435,new kb(this.$)))};db.ka=function(Ma){Ma.da.Ga(436,new db(Ma))};Object(ec.a)(db,"PresenceTelemetryFactory",
Wd.a,[]);var vb=b(1367),Pd=b(47),Tc=b(44),Ve=b(28),kf=b(117),of=b(15),vf=b(21),ne=b(76),Ad=nb.a;Am(sb,Ad);sb.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");this.raiseEvent("userLeft");this.KPc=this.pra=this.dke=null;Ad.prototype.dispose.call(this)};Ck.Object.defineProperties(sb.prototype,{XOb:{configurable:!0,enumerable:!0,get:function(){return this.dke}},xc:{configurable:!0,enumerable:!0,get:function(){return this.pra||{}},set:function(Ma){this.KPc=this.pra;this.pra=Ma;this.raiseEvent("userPresenceChanged")}},
bGd:{configurable:!0,enumerable:!0,get:function(){return this.KPc}}});Object(ec.a)(sb,"UserPresence",nb.a,[]);var Xd=ne.a;Am(Ta,Xd);Ta.prototype.HQd=function(Ma){this.Yee=Ma};Ta.prototype.w1f=function(Ma){this.$ee=Ma};Ta.prototype.j0a=function(){};Ta.prototype.I4a=function(){return null};Ta.prototype.mfd=function(){return null};Ta.prototype.o5f=function(){};Ta.prototype.p5f=function(){};Ta.prototype.jeg=function(){};Ta.prototype.nyc=function(){};Ta.prototype.sec=function(){};Ta.rTj=function(Ma,Hb){var ic=
Ma.hA.xc;dd.a.yc(Ma.Jy);dd.a.yc([Ma.hA]);Ma.hA=null;Ma.hA=new sb(Hb);Ma.HQd([]);Ma.w1f(Hb);Ma.xc=ic};Ck.Object.defineProperties(Ta.prototype,{Jy:{configurable:!0,enumerable:!0,get:function(){return this.Yee}},Gp:{configurable:!0,enumerable:!0,get:function(){return this.$ee}},xc:{configurable:!0,enumerable:!0,get:function(){return this.hA.xc},set:function(Ma){this.hA.xc=Ma}}});Object(ec.a)(Ta,"IUserGridPresence",ne.a,[]);var ee;(function(Ma){Ma[Ma.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";
Ma[Ma.peopleImageClassName=1]="peopleImageClassName";Ma[Ma.peopleImageClusterPath=4]="peopleImageClusterPath";Ma[Ma.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";Ma[Ma.imageDimension=6]="imageDimension";Ma[Ma.rtl=8]="rtl";Ma[Ma.pointerInputManager=9]="pointerInputManager";Ma[Ma.clickInputManager=10]="clickInputManager";Ma[Ma.vertical=11]="vertical";Ma[Ma.zIndex=12]="zIndex";Ma[Ma.contextMenuInputManager=13]="contextMenuInputManager";Ma[Ma.imageDomElement=14]="imageDomElement";
Ma[Ma.useIdleTooltip=15]="useIdleTooltip";Ma[Ma.viewportBoundsCallback=16]="viewportBoundsCallback";Ma[Ma.flipHorizontalDirection=17]="flipHorizontalDirection";Ma[Ma.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";Ma[Ma.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";Ma[Ma.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(ee||(ee={}));Object(ec.b)("PresenceTooltipSettingKeys",ee);wa.prototype.get=function(Ma,Hb){Ma=ee[Ma];return"number"===typeof(void 0===Hb?null:
Hb)?(Hb=this.GP[Ma])?Number.parseInvariant(Hb.toString()):0:this.GP[Ma]};wa.prototype.add=function(Ma,Hb){this.GP[ee[Ma]]=Hb};wa.prototype.$Ya=function(Ma,Hb){ee[Ma]in this.GP||(this.GP[ee[Ma]]=Hb)};wa.prototype.remove=function(Ma){delete this.GP[ee[Ma]]};Object(ec.a)(wa,"PresenceTooltipSettings",null,[]);var Le=Ac.a;Am(qa,Le);qa.prototype.dispose=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;Le.prototype.dispose.call(this)};
qa.prototype.createElement=function(Ma){return this.element.ownerDocument.createElement(Ma)};qa.prototype.vzc=function(){return!0};qa.s$g=function(Ma){return"prControl"+(Ma?"Rtl":"")};Ck.Object.defineProperties(qa.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(Ma){this._element=Ma}},visible:{configurable:!0,enumerable:!0,get:function(){return"visible"===this.element.style.visibility},set:function(Ma){this.element.style.visibility=Ma?"visible":"hidden"}},
rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(Ma){this.element.dir=Ma?"rtl":"ltr"}},zIndex:{configurable:!0,enumerable:!0,get:function(){return this.element.style.zIndex},set:function(Ma){this.element.style.zIndex=String(Ma)}}});Object(ec.a)(qa,"BasePresenceControl",Ac.a,[2,45]);var Jf=Sys.EventArgs;Am(Aa,Jf);Aa.Nka="InteractivityChanged";Object(ec.a)(Aa,"InteractivityChangedEventArgs",Sys.EventArgs,[]);va.XNh=function(Ma){return va.YNh(Ma)};
va.YNh=function(Ma){var Hb=document.createElementNS(va.O0d,"svg");Hb.setAttribute("viewBox",String.format(va.Fbh,va.ugg,va.tgg));Hb.appendChild(va.k_h(Ma));return Hb};va.k_h=function(Ma){var Hb=va.ugg/Ma,ic=2*Hb,Lc=va.tgg/2;Ma=(Ma-12-8)*Hb/2;var td=document.createElementNS(va.O0d,"g");Sys.UI.DomElement.addCssClass(td,va.Ebh);for(var pd=1;3>=pd;pd++)td.appendChild(va.iMh(pd,ic,Ma+(6*pd-2)*Hb,Lc));return td};va.iMh=function(Ma,Hb,ic,Lc){var td=document.createElementNS(va.O0d,"circle");Sys.UI.DomElement.addCssClass(td,
String.format("{0}-{1}",va.gYg,Ma));td.setAttribute("cx",String.format("{0}",ic));td.setAttribute("cy",String.format("{0}",Lc));td.setAttribute("r",String.format("{0}",Hb));return td};va.O0d="http://www.w3.org/2000/svg";va.Ebh="prDancingDots";va.gYg="prAnimateCircle";va.Fbh="0 0 {0} {1}";va.tgg=40;va.ugg=120;Object(ec.a)(va,"ModernPresenceTooltipDancingDots",null,[]);var $f=b(118),Dc=b(156),Sd=b(13),te=b(91),rd=b(122),Ue=b(57),ef=b(29);Am(xa,qa);xa.prototype.QVc=function(Ma){this.addHandler(Aa.Nka,
Ma)};xa.prototype.ltc=function(Ma){this.removeHandler(Aa.Nka,Ma)};xa.prototype.dispose=function(){this.element&&(this.Di.za(Sd.a.click,this.element,Object(yd.a)(this,this.vd,"onClick")),this.Di.za(Sd.a.jk,this.element,Object(yd.a)(this,this.vzc,"stopPropagationAndPreventDefaultBehavior")),this.zA.za(Sd.a.pointerDown,this.element,Object(yd.a)(this,this.onPointerDown,"onPointerDown")),this.zA.za(Sd.a.pointerOut,this.element,Object(yd.a)(this,this.dO,"onPointerOut")),this.zA.za(Sd.a.pointerOver,this.element,
Object(yd.a)(this,this.Vw,"onPointerOver")),this.EHc.za(this.element,Object(yd.a)(this,this.vzc,"stopPropagationAndPreventDefaultBehavior")));qa.prototype.dispose.call(this)};xa.prototype.Ev=function(Ma){this.Di=Ma.get(10);this.Di.pa(Sd.a.click,this.element,Object(yd.a)(this,this.vd,"onClick"));this.Di.pa(Sd.a.jk,this.element,Object(yd.a)(this,this.vzc,"stopPropagationAndPreventDefaultBehavior"));this.zA=Ma.get(9);this.zA.pa(Sd.a.pointerOver,this.element,Object(yd.a)(this,this.Vw,"onPointerOver"));
this.zA.pa(Sd.a.pointerOut,this.element,Object(yd.a)(this,this.dO,"onPointerOut"));this.zA.pa(Sd.a.pointerDown,this.element,Object(yd.a)(this,this.onPointerDown,"onPointerDown"));this.EHc=Ma.get(13);this.EHc.pa(this.element,Object(yd.a)(this,this.vzc,"stopPropagationAndPreventDefaultBehavior"))};xa.prototype.hide=function(Ma,Hb,ic){Ma=void 0===Ma?null:Ma;Hb=void 0===Hb?0:Hb;ic=void 0===ic?0:ic;this.Syg&&Ma?this.aBj(Ma,Hb,ic):(3===this.state&&this.TPf(),this.visible=!1,this._state=5)};xa.prototype.aBj=
function(Ma,Hb,ic){this.show(Ma,Hb,15,4,void 0,void 0===ic?0:ic)};xa.prototype.S3f=function(Ma,Hb,ic,Lc,td,pd){this.show(Ma,Hb,20,(void 0===ic?0:ic)?2:(void 0===Lc?0:Lc)?1:0,void 0===td?!1:td,void 0===pd?0:pd)};xa.prototype.yAj=function(Ma,Hb,ic,Lc,td){this.show(Ma,Hb,ic+20,3,void 0===Lc?!1:Lc,void 0===td?0:td)};xa.prototype.show=function(Ma,Hb,ic,Lc,td,pd){Lc=void 0===Lc?3:Lc;pd=void 0===pd?0:pd;!Ma||Lc===this.state&&this.I6h(Hb,ic)||(this.jBg(Lc,void 0===td?!1:td,pd),this.bZa(Ma,Lc,pd),this._state=
Lc,4===pd||0===pd&&!this.vJ?this.element.style.left=Hb+"px":this.element.style.right=Hb+"px",this.element.style.top=ic+"px",this.visible=!0)};xa.prototype.bZa=function(Ma,Hb,ic){this.Zje=Ma;Ue.a.Eqb(this.QG);rd.a.gZg(this.QG);this.QG.id="fly_"+Ma.clientId;this.QG.style.backgroundColor=Ma.color;4!==Hb?(this.QG.style.height=this.wib+"px",this.QG.style.lineHeight=this.wib+"px",rd.a.kSa(this.QG,"border-radius",this.wib+"px")):4===ic||0===ic&&!this.vJ?this.QG.style.left="0px":this.QG.style.right="0px";
2!==Hb&&(4===Hb?Ue.a.Cwc(this.QG,""):1===Hb?this.QG.appendChild(this.zog):(this.QG.setAttribute("dir","auto"),ic=ef.a.gSh(Ma.userName),(!Ma.isAnonymous||xb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ic||0!==Hb?(Ma=Ma.userName,0===Hb&&(Ma=ic,rd.a.kSa(this.QG,"text-align","center")),Ue.a.Cwc(this.QG,Ma)):(this.UKc||(this.UKc=this.k5g()),this.QG.appendChild(this.UKc),rd.a.kSa(this.QG,"text-align","start"))))};xa.prototype.vd=function(Ma){if(0===
this.state)return this.raiseEvent(Aa.Nka,new Aa(1,Ma)),!0;3===this.state&&Ub.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1};xa.prototype.dO=function(Ma){3===this.state&&this.raiseEvent(Aa.Nka,new Aa(3,Ma));return!1};xa.prototype.Vw=function(Ma){3!==Ma.yb&&this.raiseEvent(Aa.Nka,new Aa(2,Ma));return!1};xa.prototype.onPointerDown=function(Ma){if(3!==Ma.yb)return!0;this.raiseEvent(Aa.Nka,new Aa(4,Ma));return!1};xa.prototype.k5g=function(){var Ma=document.createElement("img");
Ma.src=$f.a.pta("doughperson_white_glyph.svg");Ma.setAttribute("Unselectable","on");te.a.dh(Ma,te.a.Rd,te.a.Sr);return Dc.createClusteredImageFromClusterWithImageClass(this.wib,this.wib,null,null,xa.rEh,"",!1,"",this.element.ownerDocument,Ma)};xa.prototype.jBg=function(Ma,Hb,ic){Hb=void 0===Hb?!1:Hb;ic=void 0===ic?0:ic;if(!this.bzb(this.state)||!this.bzb(Ma))switch(Sys.UI.DomElement.removeCssClass(this.element,this.WGc),this.state){case 4:3===Ma?this.jha(xa.Ybd,xa.CVe):this.bzb(Ma)&&this.jha(xa.Wbd,
xa.CVe);break;case 3:4===Ma?this.jha(xa.acd,xa.BVe):this.bzb(Ma)&&(Hb&&this.TPf(),this.jha(xa.Wbd,xa.BVe,Hb?xa.qEh:""));break;case 0:case 1:case 2:4===Ma?this.jha(xa.acd,xa.Zbd):3===Ma&&(Hb&&this.IBg(),this.jha(xa.Ybd,xa.Zbd,Hb?xa.DVe:"",3===ic?xa.uEh:xa.sEh));break;default:4===Ma?this.jha(xa.acd):3===Ma?this.jha(xa.Ybd):this.bzb(Ma)&&this.jha(xa.Wbd)}};xa.prototype.jha=function(Ma){for(var Hb=[],ic=0;ic<arguments.length;++ic)Hb[ic-0]=arguments[ic];this.WGc=Hb.join(" ");Sys.UI.DomElement.addCssClass(this.element,
this.WGc)};xa.prototype.IBg=function(){var Ma=this;this.u7d=window.setTimeout(function(){Ma.element&&(Ma.qqa=Ma.element.cloneNode(!0),Ma.element.parentNode.appendChild(Ma.qqa),Ma.element.style.zIndex="2",Ma.qqa.style.zIndex="1")},300)};xa.prototype.TPf=function(){var Ma=this;window.clearTimeout(this.u7d);this.qqa&&(Sys.UI.DomElement.removeCssClass(this.qqa,xa.Zbd+" "+xa.DVe),Sys.UI.DomElement.addCssClass(this.qqa,xa.pEh),Fb.Task.delay(300).continueWith(function(){Ma.element&&Ma.element.parentNode===
Ma.qqa.parentNode&&Ma.element.parentNode.removeChild(Ma.qqa)}),rd.a.eIb(this.element,"z-index"))};xa.prototype.bzb=function(Ma){return 0===Ma||1===Ma||2===Ma};xa.prototype.I6h=function(Ma,Hb){var ic=rd.a.sD(this.element.style.top);return rd.a.sD(this.element.style.left)===Ma&&ic===Hb};xa.prototype.HLd=function(Ma){3===Ma&&rd.a.D3(this.element,"left")?(Ma=rd.a.sD(this.element.style.left),rd.a.eIb(this.element,"left"),this.element.style.right=-1*Ma+"px"):4===Ma&&rd.a.D3(this.element,"right")&&(Ma=rd.a.sD(this.element.style.right),
rd.a.eIb(this.element,"right"),this.element.style.left=-1*Ma+"px")};Ck.Object.defineProperties(xa.prototype,{user:{configurable:!0,enumerable:!0,get:function(){return this.Zje}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});xa.oEh="prModernFlyout UIFont";xa.acd="flyoutIdle";xa.Ybd="flyoutExpanded";xa.Wbd="flyoutCollapsed";xa.CVe="flyoutFromIdle";xa.BVe="flyoutFromExpanded";xa.Zbd="flyoutFromCollapsed";xa.DVe="flyoutStacked";xa.qEh="flyoutFromStacked";xa.pEh="flyoutFadeOut";
xa.rEh="cui-img-cont-float cui-img-20by20";xa.sEh="flyoutLtrDir";xa.uEh="flyoutRtlDir";Object(ec.a)(xa,"ModernPresenceTooltipFlyoutControl",qa,[]);Object(ec.a)(ka,"FlyoutsPositioningInfo",null,[]);var pe=b(39);ha.prototype.VSh=function(Ma,Hb,ic,Lc,td){var pd=td.y,Qe=td.height,ff=this.aLh(Lc),hf=ff+Hb,yg=Ma*ic+2*(Ma-1);ic=null;1===Ma||this.VUg(ff,yg,pd,Qe)?Ma=new ka(0,0,2):(Ma=this.Mbd(hf,yg,pd,Qe),Ma.offsetTop-=ff);this.tJc?ic=new ka(0,0,void 0,this.lj?4:3):(Lc=this.$Kh(Lc,td),ff=Math.max(0,td.x),
td=td.width,Hb=Lc+Hb,this.WUg(Lc,ff,td)?ic=new ka(0,0,void 0,this.lj?3:4):this.XUg(Hb,ff)&&(ic=new ka(0,0,void 0,this.lj?4:3)),ic||(ic=this.yDh(Lc,Hb,ff,td)));return new ka(Ma.offsetTop,ic.offsetLeft,Ma.rgg,ic.F9e)};ha.prototype.aLh=function(Ma){return pe.a.ZKh(Ma)};ha.prototype.$Kh=function(Ma,Hb){return this.lj?Hb.width-pe.a.YKh(Ma):pe.a.XKh(Ma)};ha.prototype.VUg=function(Ma,Hb,ic,Lc){return Ma+Hb<=ic+Lc};ha.prototype.Mbd=function(Ma,Hb,ic,Lc){var td=1,pd=Math.max(ic,Ma-Hb);Hb>Ma-ic&&(td=2,pd=Hb<
Lc?Lc-Hb:ic);return new ka(pd,0,td)};ha.prototype.WUg=function(Ma,Hb,ic){return Ma+150<=Hb+ic};ha.prototype.XUg=function(Ma,Hb){return 150<=Ma-Hb};ha.prototype.yDh=function(Ma,Hb,ic,Lc){Lc-Hb>=Ma-ic?Ma=4:(Hb=Ma,Ma=3);return new ka(0,Hb,void 0,Ma)};Object(ec.a)(ha,"ModernPresenceTooltipPositioner",null,[]);na.prototype.update=function(Ma,Hb){if(3!==Ma)if(5!==Ma&&this.hM&&this.hM.length){if(4===Ma){var ic=this.Lqg;var Lc=(this.mYa-ic)/2;this.element.style.height=this.mYa+"px";this.element.style.width=
this.mYa+"px";Ma=rd.a.sD(this.hM[0].element.style.top);Hb=rd.a.sD(this.vJ?this.hM[0].element.style.right:this.hM[0].element.style.left)}else ic=this.L4d,Lc=(this.mYa-ic)/2,this.element.style.height=this.mYa+"px",this.element.style.width=this.tMh()+2*Lc+"px",Ma=rd.a.sD(this.hM[this.hM.length-1].element.style.top),Hb=this.tUg(this.hM[this.hM.length-1].element,ic,Hb);rd.a.kSa(this.element,"border-radius",this.mYa+"px");this.element.style.top=Ma-Lc-ic+"px";this.vJ?this.element.style.right=Hb-Lc+"px":
this.element.style.left=Hb-Lc+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)};na.prototype.tUg=function(Ma,Hb,ic){return this.vJ&&!ic?rd.a.sD(Ma.style.right):this.vJ||ic?this.vJ&&ic?-rd.a.sD(Ma.style.left)-Hb:-rd.a.sD(Ma.style.right)-Hb:rd.a.sD(Ma.style.left)};na.prototype.tMh=function(){return this.hM&&this.hM.length?this.L4d+Math.min(this.hM.length-1,2)*this.Zmg:0};Ck.Object.defineProperties(na.prototype,
{element:{configurable:!0,enumerable:!0,get:function(){return this._element}}});Object(ec.a)(na,"ModernPresenceTooltipTarget",null,[]);var Ne=b(176),gg=b(276);Am(aa,qa);aa.prototype.QVc=function(Ma){this.addHandler(Aa.Nka,Ma)};aa.prototype.ltc=function(Ma){this.removeHandler(Aa.Nka,Ma)};aa.prototype.dispose=function(){if(this.fef)this.rPc=!0;else{if(this.dK)for(var Ma=Cl(this.dK),Hb=Ma.next();!Hb.done;Hb=Ma.next())Hb=Hb.value,Hb.ltc(Object(yd.a)(this,this.j$a,"onInteractivityChanged")),dd.a.Ha(Hb);
this.hM=null;this.zA.za(Sd.a.pointerDown,this.xqa.element,Object(yd.a)(this,this.g$a,"onHitTarget"));this.zA.za(Sd.a.pointerOver,this.xqa.element,Object(yd.a)(this,this.g$a,"onHitTarget"));this.zA.za(Sd.a.pointerOut,this.xqa.element,Object(yd.a)(this,this.g$a,"onHitTarget"));qa.prototype.dispose.call(this)}};aa.prototype.LX=function(){this.AHa();this.visible=!0};aa.prototype.pea=function(){this.visible=!0;this.JSe();this.UDa=!0};aa.prototype.hide=function(){this.hQf();this.X8e();this.xqa.update(this.RBa,
this.LXa)};aa.prototype.bZa=function(Ma){var Hb=this.RBa,ic=this.UDa;Ma.clientId||(Ma.clientId=(aa.E9d++).toString());if(Ma.clientId in this.sTb){var Lc=this.rub(Ma.clientId);if(0<=Lc){Lc=this.MA[Lc];if(Lc.color===Ma.color&&Lc.userName===Ma.userName)return;this.Jbb(Ma.clientId)}}this.hide();Lc=new xa(this.createElement("div"),this.Ee);Lc.QVc(Object(yd.a)(this,this.j$a,"onInteractivityChanged"));this.Tfa.insertBefore(Lc.element,this.Tfa.firstChild);this.sTb[Ma.clientId]=Lc;Array.add(this.MA,Ma);Array.add(this.dK,
Lc);this.Reg(Hb,ic);this.visible=!0};aa.prototype.Jbb=function(Ma){if(this.fef)Array.add(this.Cjb,Ma);else{var Hb=this.RBa,ic=this.UDa;this.hide();this.tQf(Ma);this.Reg(Hb,ic)}};aa.prototype.s9a=function(Ma){var Hb=this.rub(Ma);if(!(0>=Hb)){var ic=this.MA[Hb];Ma=this.sTb[Ma];Array.removeAt(this.MA,Hb);Array.insert(this.MA,0,ic);Array.removeAt(this.dK,Hb);Array.insert(this.dK,0,Ma);this.Tfa.removeChild(Ma.element);this.Tfa.appendChild(Ma.element);this.AHa()}};aa.prototype.Reg=function(Ma,Hb){0>=this.MA.length?
this.hide():3===Ma&&Hb?this.pea():this.LX()};aa.prototype.bLb=function(Ma,Hb){Hb?this.HAg(Ma):this.yPf(Ma)};aa.prototype.Sna=function(Ma){Ma!==this.zTb&&(this.zTb=Ma,this.jQd(Ma))};aa.prototype.position=function(Ma,Hb){this.element.style.top=Hb+"px";this.element.style.left=Ma+"px"};aa.prototype.AHa=function(Ma){if(void 0===Ma||!Ma||this.w9){this.zTb&&this.jQd(!0);var Hb=Math.min(3,this.yja)-1;Ma=0;var ic=1,Lc=0;this.LXa&&(Ma=this.chb,ic=-1,Lc=-this.Nsa);for(var td=this.yja-1;td>Hb;td--)this.dK[td].S3f(this.MA[td],
-4*Hb*ic+Lc,!0,!1,!0,Ma);for(;0<=Hb;Hb--)this.dK[Hb].S3f(this.MA[Hb],-4*Hb*ic+Lc,0<Hb,Array.contains(this.qfa,this.MA[Hb].clientId),Hb!==this.nUb,Ma);this.nUb=0;this.xqa.update(0,this.LXa);this.zIndex=this.zsb;this.UDa=!1;this.hQf(0);this.rPc&&this.dispose()}};aa.prototype.JSe=function(){this.zTb&&this.jQd(!1);this.zIndex=this.zsb+1;var Ma=this.Urj();var Hb=Ma.offsetX;var ic=Ma.offsetY;Ma=Ma.E9e;for(var Lc=0;Lc<this.yja;Lc++)this.dK[Lc].yAj(this.MA[Lc],Hb,ic+(this.Nsa+2)*Lc,Lc!==this.nUb,Ma)};aa.prototype.X8e=
function(){var Ma=0,Hb=0;this.LXa&&(Ma=this.chb,Hb=-6);for(var ic=0;ic<this.yja;ic++)this.dK[ic].hide(this.MA[ic],Hb,Ma);this.zIndex=this.zsb;this.visible=this.UDa=!1;this.rPc&&this.dispose()};aa.prototype.U1c=function(Ma){var Hb=this;(Ma=void 0===Ma?0:Ma)?(this.w9=!0,Fb.Task.delay(Ma).continueWith(function(){Hb.T8d?Hb.Y7h():Hb.AHa(!0);Hb.w9=!1})):this.T8d?this.hide():this.AHa()};aa.prototype.Y7h=function(){this.w9&&this.hide()};aa.prototype.YOg=function(){if(xb.AFrameworkApplication.sa&&xb.AFrameworkApplication.sa.Pa.Lz&&
Ne.c()){var Ma=appChrome.selectors.getShyState();return Ma.isActive&&0!==Ma.state}return!1};aa.prototype.j$a=function(Ma,Hb){var ic=this;Ma=this.RBa;this.YOg()||2!==Hb.type&&(4!==Hb.type||3===Ma)?4===Hb.type&&3===Ma?(this.w9&&(this.w9=!1),this.U1c()):3!==Hb.type||3!==Ma||this.UDa||(1<this.yja?(this.w9=!0,Fb.Task.delay(250).continueWith(function(){ic.AHa(!0);ic.w9=!1})):this.U1c()):(this.w9&&(this.w9=!1),3!==Ma&&(this.JSe(),3===Hb.Ktb.yb&&this.U1c(2E3)));this.raiseEvent(Aa.Nka,Hb)};aa.prototype.g$a=
function(Ma){3===Ma.yb?this.j$a(this,new Aa(4,Ma)):Ma.eventName===Sd.a.pointerOver?this.j$a(this,new Aa(2,Ma)):Ma.eventName===Sd.a.pointerOut&&this.j$a(this,new Aa(3,Ma));return!1};aa.prototype.Zpj=function(Ma){this.element.style.width=Ma+"px";this.element.style.height=this.Nsa+"px"};aa.prototype.tQf=function(Ma){this.yPf(Ma);Ma=this.rub(Ma);if(!(0>Ma)){var Hb=this.MA[Ma];Array.removeAt(this.MA,Ma);delete this.sTb[Hb.clientId];Hb=this.dK[Ma];this.Tfa.removeChild(Hb.element);this.Ee.get(18,!1)&&Hb.ltc(Object(yd.a)(this,
this.j$a,"onInteractivityChanged"));Array.removeAt(this.dK,Ma);Hb.dispose()}};aa.prototype.hQf=function(Ma){Ma=void 0===Ma?5:Ma;if(this.Cjb.length){this.visible&&this.X8e();for(var Hb=0;Hb<this.Cjb.length;Hb++)this.tQf(this.Cjb[Hb]);Array.clear(this.Cjb);0>=this.MA.length||5===Ma?this.hide():0===Ma&&this.LX()}};aa.prototype.rub=function(Ma){for(var Hb=0;Hb<this.MA.length;Hb++)if(this.MA[Hb].clientId===Ma)return Hb;return-1};aa.prototype.HAg=function(Ma){if(-1===this.rub(Ma))Ub.ULS.sendTraceTag(41706451,
302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.qfa,Ma)){if(this.MA[0].clientId===Ma)return;Array.remove(this.qfa,Ma)}Array.add(this.qfa,Ma);this.s9a(Ma);1!==this.RBa&&this.AHa()}};aa.prototype.yPf=function(Ma){-1===this.rub(Ma)?Ub.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.qfa,Ma)&&(Array.remove(this.qfa,Ma),this.MA[0].clientId===Ma&&0<this.qfa.length&&this.s9a(this.qfa[this.qfa.length-
1]),this.MA[0].clientId===Ma&&1===this.RBa&&this.AHa())};aa.prototype.jQd=function(Ma){Ma?Sys.UI.DomElement.addCssClass(this.Tfa,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Tfa,"prBackgroundSelection")};aa.prototype.Urj=function(){var Ma;var Hb=Ma=0;var ic=this.chb;if(this.tke){var Lc=this.tke(this);if(!Lc)return{offsetX:Ma,offsetY:Hb,E9e:ic};var td=4===this.RBa;ic=this.Cug.VSh(this.yja,td?6:this.Nsa,this.Nsa,this.element,Lc);Hb=ic.offsetTop;this.nUb=this.dSh(ic.rgg,ic.offsetTop);
ic=ic.F9e;ic!==this.chb&&(this.HLd(ic),this.element.dir=3===ic?"rtl":"ltr",this.chb=ic);ic!==this.DZe()?(Ma=this.Gug?-2:td?-6:-this.Nsa,this.LXa=!0):this.LXa=!1}return{offsetX:Ma,offsetY:Hb,E9e:ic}};aa.prototype.dSh=function(Ma,Hb){if(1===Ma)return this.yja-1;Ma=Math.abs(Hb);return 0<Ma?Ma/(this.Nsa+2):0};aa.prototype.HLd=function(Ma){for(var Hb=0;Hb<this.yja;Hb++)this.dK[Hb].HLd(Ma)};aa.prototype.DZe=function(){return this.lj?3:4};aa.vHh=function(){return String.format("{0}-{1}","presencetooltip",
aa.E9d++)};Ck.Object.defineProperties(aa.prototype,{Pqc:{configurable:!0,enumerable:!0,get:function(){return gg.a.clone(this.MA)}},dK:{configurable:!0,enumerable:!0,get:function(){return this.hM}},zsb:{configurable:!0,enumerable:!0,get:function(){return this.cog}},yja:{configurable:!0,enumerable:!0,get:function(){return this.dK?this.dK.length:0}},RBa:{configurable:!0,enumerable:!0,get:function(){return 0<this.yja?this.dK[0].state:5}},fef:{configurable:!0,enumerable:!0,get:function(){return 3===this.RBa&&
!this.UDa}}});aa.E9d=0;Object(ec.a)(aa,"ModernPresenceTooltipControl",qa,[35,2]);var ie=b(228),Re=b(366),Ig=b(179);fa.prototype.U5g=function(){var Ma=document.createElement("div");this.Ee.$Ya(15,!1);return new aa(Ma,20,this.Ee)};Object(ec.a)(fa,"ModernPresenceTooltipFactory",null,[44]);var Lf=b(262),qf=b(19),vg=b(60),jc=b(188),zc=b(12),Md=b(35),Ce=b(360),ae;(function(Ma){Ma[Ma.none=0]="none";Ma[Ma.master=1]="master";Ma[Ma.fixed=2]="fixed";Ma[Ma.horizontal=3]="horizontal";Ma[Ma.vertical=4]="vertical";
Ma[Ma.first=1]="first";Ma[Ma.last=4]="last"})(ae||(ae={}));Object(ec.b)("PaneType",ae);var ud=nb.a;Am(L,ud);L.prototype.QVc=function(Ma){this.addHandler("interactivityChanged",Ma)};L.prototype.ltc=function(Ma){this.removeHandler("interactivityChanged",Ma)};L.prototype.dispose=function(){if(0<this.Uh.count){this.hide();var Ma=this.Uh.nu,Hb;for(Hb in Ma)Ma[Hb].dispose()}this.gridView=null;this.Uh.clear();ud.prototype.dispose.call(this)};L.prototype.Nsj=function(Ma){this.oIf=Ma};L.prototype.LX=function(){var Ma=
this.Uh.nu,Hb;for(Hb in Ma)Ma[Hb].LX()};L.prototype.pea=function(){this.cld();var Ma=this.Uh.nu,Hb;for(Hb in Ma)Ma[Hb].pea()};L.prototype.hide=function(){this.cUa();var Ma=this.Uh.nu,Hb;for(Hb in Ma)Ma[Hb].hide()};L.prototype.bZa=function(Ma){var Hb=this.Uh.nu,ic;for(ic in Hb)Hb[ic].bZa(Ma)};L.prototype.s9a=function(Ma){var Hb=this.Uh.nu,ic;for(ic in Hb)Hb[ic].s9a(Ma)};L.prototype.Jbb=function(Ma){var Hb=this.Uh.nu,ic;for(ic in Hb)Hb[ic].Jbb(Ma)};L.prototype.bLb=function(Ma,Hb){var ic=this.Uh.nu,
Lc;for(Lc in ic)ic[Lc].bLb(Ma,Hb)};L.prototype.Sna=function(Ma){this.dqd!==Ma&&(this.dqd=Ma,Ma=Md.a.Nc(this.Uh.nu,Enum.toString(ae,L.hLa()[0])),this.Cza&&Ma&&(Ma=zc.DOMElementExtensions.getWidth(Ma.element)/2,this.position(this.dqd?this.Cza.x+14+Ma:this.Cza.x-14-Ma,this.Cza.y)))};L.prototype.position=function(Ma,Hb){var ic=this.Uh.nu,Lc;for(Lc in ic){var td=ic[Lc],pd=Enum.parse(ae,Lc);pd=this.gridView.Tf(pd);var Qe=U(pd,new Sys.UI.Point(Ma,Hb),!1);this.Cza=new Sys.UI.Point(Ma,Hb);0>Qe.x&&(Qe.x+=pd.domElement.scrollLeft);
zc.DOMElementExtensions.updatePosition(td.element,Qe.x,Qe.y,!1,this.rtl)}};L.prototype.cld=function(){this.Cza&&(this.position(this.Cza.x,this.Cza.y),this.INd||(this.INd=!0,this.gridView.Ea.UG(this.Rz),this.gridView.Ea.Ss(this.Rz),this.gridView.view.Ts(this.NF)))};L.prototype.cUa=function(){this.INd&&(this.gridView.Ea.wI(this.Rz),this.gridView.Ea.Wq(this.Rz),this.gridView.view.Yq(this.NF))};L.hLa=function(){return L.s$||(L.s$=[1,3,2,4])};Ck.Object.defineProperties(L.prototype,{element:{configurable:!0,
enumerable:!0,get:function(){return null}},Pqc:{configurable:!0,enumerable:!0,get:function(){var Ma=Md.a.Nc(this.Uh.nu,Enum.toString(ae,L.hLa()[0]));return Ma?Ma.Pqc:null}},M_i:{configurable:!0,enumerable:!0,get:function(){return this.oIf}}});L.s$=null;Object(ec.a)(L,"PaneInvariantTooltip",nb.a,[35,2]);H.ILb=!1;H.goa=!1;Object(ec.a)(H,"PresenceViewSettings",null,[]);I.prototype.dispose=function(){this.cUa();this.clearCache();this.$&&this.$.xa&&this.$.xa.Vg(this.fza);this.gridView=null};I.prototype.cUa=
function(){this.wic&&(this.gridView.Ea.wI(this.Rz),this.gridView.Ea.Wq(this.Rz),this.gridView.view.Yq(this.NF),this.wic=!1)};I.prototype.xPj=function(Ma){var Hb=this.Pz[Ma],ic=this.pba(Ma);Hb&&this.SPf(Hb);ic&&this.Usc(ic,Hb.Hza.clientId,Hb.Vy);delete this.yUa[Ma];delete this.Pz[Ma];delete this.xUa[Ma]};I.prototype.YZd=function(Ma){var Hb=Ma.Vy;this.Pz[Hb]||(this.N5a(Ma),this.Pz[Hb]=Ma)};I.prototype.GZd=function(Ma){this.JB=Ma;this.MQi(Ma)};I.prototype.AUj=function(Ma){var Hb=Ma.Vy,ic=this.t2e(Ma.Oqc,
Ma.paneType,Ma.range),Lc=this.pba(Hb);ic&&ic!==Lc&&(Ma.OMb(ic),this.yUa[Hb]=ic,this.Pz[Hb]=Ma,this.xUa[Hb]&&ic.Sna(this.xUa[Hb]));Lc!==ic&&Lc&&this.Usc(Lc,Ma.Hza.clientId,Ma.Vy);!this.wic&&this.gridView&&(this.gridView.Ea.UG(this.Rz),this.gridView.Ea.Ss(this.Rz),this.gridView.view.Ts(this.NF),this.wic=!0)};I.prototype.Usc=function(Ma,Hb,ic){Ma.Jbb(Hb);Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&this.pba(ic)===Ma&&delete this.yUa[ic];Ma.Pqc&&Ma.Pqc.length||((Hb=Ma.M_i)&&
delete this.KGb[Hb],Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||this.pba(ic)===Ma&&delete this.yUa[ic],Ma.dispose())};I.prototype.SPf=function(Ma){Ma&&(Ma.eKd(this.MEb),Ma.EKd(this.qFb),Ma.DKd(this.pFb),Ma.OMb(null))};I.prototype.N5a=function(Ma){Ma.PVc(this.MEb);Ma.nWc(this.qFb);Ma.mWc(this.pFb)};I.prototype.QB=function(Ma,Hb){if(H.goa){Hb.bva||this.YZd(Hb);this.AUj(Hb);var ic=this.pba(Hb.Vy);ic&&(ic.bZa(Hb.Hza),this.JB===Hb.Vy&&ic.s9a(Hb.Vy),Hb.TMa()?Ma?ic.pea():
ic.LX():ic.hide())}};I.prototype.MQi=function(Ma){var Hb=this.pba(Ma);Lf.a(function(){null===Hb||void 0===Hb?void 0:Hb.s9a(Ma)},this.$.la)};I.prototype.pba=function(Ma){return this.yUa[Ma]};I.prototype.t2e=function(Ma,Hb,ic){if(!Ma)return null;Ma=this.Nfd(Ma,Hb,ic);var Lc=this.gridView.Tf(Hb).Vq;Hb=I.YVh(Ma,Hb,Lc).toString();Lc=Md.a.Nc(this.KGb,Hb);Lc||(Lc=new L(this.gridView,this.DFd,ic),Lc.position(Ma.x,Ma.y),Lc.Nsj(Hb),this.KGb[Hb]=Lc);return Lc};I.prototype.Nfd=function(Ma,Hb,ic){var Lc=this.gridView.Tf(Hb).Bn,
td=this.gridView.Tf(Hb).Vq;Hb=Ce.a.cN(Hb,Lc.topLeft);var pd=Math.max(td.x,Ma.x-this.Awa/2-2);pd=Math.min(Math.max(Hb.x+td.x,pd),Hb.x+td.x+Lc.width-this.Awa);Ma=Math.max(td.y,Ma.y-this.Awa/2+1);Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&(Hb.y+td.y>Ma||this.ELj(ic))&&(pd=Math.min(pd+this.Awa/4,Hb.x+td.x+Lc.width-this.Awa));Ma=Math.min(Math.max(Hb.y+td.y,Ma),Hb.y+td.y+Lc.height-this.Awa);return new Sys.UI.Point(pd,Ma)};I.prototype.clearCache=function(){var Ma=
this.Pz,Hb;for(Hb in Ma)this.SPf(Ma[Hb]);Ma=this.KGb;for(var ic in Ma)Ma[ic].dispose();this.yUa={};this.Pz={};this.KGb={};this.xUa={};dd.a.Ha(this.cpa);this.cpa=null};I.prototype.Irb=function(){var Ma=new wa;Ma.add(0,qf.a.n$c);Ma.add(1,this.m$e);Ma.add(12,49);Ma.add(6,this.Awa);this.gridView&&(Ma.add(4,Gc.a.Se(3)),Ma.add(5,Gc.a.Se(3)),Ma.add(8,this.gridView.rtl));Ma.add(18,!0);this.DFd=new fa(Ma);Ma.add(16,this.h1h)};I.prototype.yTj=function(Ma){var Hb=new wa;Hb.add(0,qf.a.n$c);Hb.add(1,this.m$e);
Hb.add(12,Number.parseInvariant(Ma.toString()));Hb.add(6,this.Awa);this.gridView&&(Hb.add(4,Gc.a.Se(3)),Hb.add(5,Gc.a.Se(3)),Hb.add(8,this.gridView.rtl));this.DFd=new fa(Hb)};I.prototype.FUj=function(Ma){this.yTj(Ma)};I.prototype.Seg=function(){H.goa&&(this.cpa=jc.AsyncMethodContext.av(this.xUj,100,Tc.a.c1i,this.cpa))};I.prototype.B7e=function(Ma,Hb){H.goa&&(this.xUa[Hb.Vy]&&Ma.Sna(this.xUa[Hb.Vy]),Hb.TMa()?Hb.hoa(!0,!0):Hb.hoa(!1,!0))};I.prototype.Sna=function(Ma,Hb){this.xUa[Ma]=Hb;(Ma=this.pba(Ma))&&
Ma.Sna(Hb)};I.prototype.bLb=function(Ma,Hb){var ic=this.pba(Ma);ic&&ic.bLb(Ma,Hb)};I.YVh=function(Ma,Hb,ic){return Ma.x.toString()+"-"+Ma.y.toString()+"-"+Hb.toString()+"-"+ic.x.toString()+"-"+ic.y.toString()};I.prototype.ELj=function(Ma){var Hb;Ma=vf.g(this.$).Ea.pva(Ma.topRight);return null===(Hb=null===Ma||void 0===Ma?void 0:Ma[0])||void 0===Hb?void 0:Hb.jwa};Object(ec.a)(I,"PresenceTooltipManager",null,[2]);var Rb=b(104),Ie=b(115),pa=nb.a;Am(ca,pa);ca.prototype.PVc=function(Ma){this.addHandler("hidePresenceTooltip",
Ma)};ca.prototype.eKd=function(Ma){this.removeHandler("hidePresenceTooltip",Ma)};ca.prototype.nWc=function(Ma){this.addHandler("showPresenceTooltip",Ma)};ca.prototype.EKd=function(Ma){this.removeHandler("showPresenceTooltip",Ma)};ca.prototype.mWc=function(Ma){this.addHandler("showFullPresenceTooltip",Ma)};ca.prototype.DKd=function(Ma){this.removeHandler("showFullPresenceTooltip",Ma)};ca.prototype.kGa=function(Ma){this.addHandler("presenceChanged",Ma)};ca.prototype.lAa=function(Ma){this.removeHandler("presenceChanged",
Ma)};ca.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.Zze();this.cUa();dd.a.Ha(this.Wob);this.zje=this.domElement=this.gridView=null;pa.prototype.dispose.call(this)};ca.prototype.CTd=function(Ma,Hb){var ic=!!Ma&&!de.D(Ma).equals(de.D(this.xx)),Lc=!!Hb&&(!this.ih||this.ih.get_id()!==Hb.get_id());if(ic||Lc)this.raiseEvent("presenceChanged"),this.Zze(),this.bva=!1,this.xx=Ma,this.ih=Hb,this.IBb=null};ca.prototype.s5=function(Ma){this.visible=
this.bva=!1;Ma&&this.raiseEvent("hidePresenceTooltip")};ca.prototype.mha=function(Ma){this.qy.push(Ma);this.B9e();Ma.kGa(this.MBd)};ca.prototype.hoa=function(Ma,Hb){Ma?(this.visible=!0,Hb&&(this.Wob=jc.AsyncMethodContext.av(this.xCj,this.$.ya.ShowTooltipDelayInMs,Tc.a.JLj,this.Wob))):this.s5(Hb)};ca.prototype.OMb=function(Ma){this.zje=Ma};ca.prototype.Bfb=function(){if(this.domElement&&this.visible){this.I_a=zc.DOMElementExtensions.getBoundingClientRect(this.domElement);var Ma=Math.floor(this.I_a.x);
this.I_a.x=Ma===this.I_a.x?Ma:Ma+1;this.I_a.y=Math.floor(this.I_a.y)}};ca.prototype.TMa=function(){if(!this.xx)return!1;if(Fc.EwaSettings.ma(691)){var Ma=this.eWh();return Ma?this.gridView.lmi(Ma,this.paneType):!1}Ma=this.gridView.Tf(this.paneType).Bn;var Hb=this.gridView.qg(this.range,this.paneType);return Ma.Kd(Hb)};ca.prototype.eWh=function(){if(this.range.isSingle){var Ma=this.gridView.Ea.Jva(this.range,this.$.activeItemName);return Ma?(Ma=Ma.ks(this.range))?Ma.jF:null:null}return this.range};
ca.prototype.Zze=function(){for(var Ma=0,Hb=this.qy.length;Ma<Hb;Ma++)this.qy[Ma].lAa(this.MBd);Array.clear(this.qy);this.cUa()};ca.prototype.B9e=function(){!this.vic&&1<=this.qy.length&&(this.vic=!0,this.gridView.Ea.UG(this.Rz),this.gridView.Ea.Ss(this.Rz),this.gridView.view.Ts(this.NF))};ca.prototype.cUa=function(){this.vic&&!this.qy.length&&(this.vic=!1,this.gridView&&(this.gridView.Ea.wI(this.Rz),this.gridView.Ea.Wq(this.Rz),this.gridView.view.Yq(this.NF)))};ca.prototype.Jbb=function(Ma){Ma.lAa(this.MBd);
Array.remove(this.qy,Ma);this.cUa()};ca.prototype.bdg=function(){this.Bfb();for(var Ma=0,Hb=this.qy.length;Ma<Hb;Ma++)this.qy[Ma].Bfb()};Ck.Object.defineProperties(ca.prototype,{Vy:{configurable:!0,enumerable:!0,get:function(){return this.kTc}},Hza:{configurable:!0,enumerable:!0,get:function(){return this.FPc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.jra}},Oqc:{configurable:!0,enumerable:!0,get:function(){if(!this.domElement)return null;var Ma=this.gridView.Tf(this.paneType).Bn,
Hb=this.gridView.rtl,ic=this.domElement.offsetWidth;if(!this.ih&&4>=ic){if(this.xx){ic=this.gridView.Hh;var Lc=this.xx.FirstRow;Hb=Hb?this.xx.FirstColumn:this.xx.LastColumn;if(ic&&!(Lc>=ic.top&&Lc<=ic.bottom&&Hb>=ic.left&&Hb<=ic.right))return Lc=Lc<=ic.top?Ma.y:Ma.y+(Lc>=ic.bottom?Ma.height:Ma.height/2),Hb=Hb<=ic.left?Ma.x:Ma.x+(Hb>=ic.right?Ma.width:Ma.width/2),this.IBb=new Sys.UI.Point(Hb,Lc)}return this.IBb}if(this.ih){Ma=this.domElement.offsetTop-2;Lc=parseInt(this.domElement.style.left,10);var td=
0;Hb&&(td=parseInt(this.domElement.parentNode.style.width,10)-ic-Lc,td-=this.gridView.SS.Hxa&&this.gridView.SS.ysd?Ie.a.zu:0);return this.IBb=new Sys.UI.Point((Hb?td:Lc)+ic+4,Ma)}return this.IBb=new Sys.UI.Point(parseInt(Hb?this.domElement.style.right:this.domElement.style.left,10)+ic,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return de.D(this.xx)}}});Object(ec.a)(ca,"TooltipNotificationUnit",nb.a,[912,2]);var qb=nb.a;Am(Z,qb);Z.prototype.PVc=function(Ma){this.addHandler("hidePresenceTooltip",
Ma)};Z.prototype.eKd=function(Ma){this.removeHandler("hidePresenceTooltip",Ma)};Z.prototype.nWc=function(Ma){this.addHandler("showPresenceTooltip",Ma)};Z.prototype.EKd=function(Ma){this.removeHandler("showPresenceTooltip",Ma)};Z.prototype.mWc=function(Ma){this.addHandler("showFullPresenceTooltip",Ma)};Z.prototype.DKd=function(Ma){this.removeHandler("showFullPresenceTooltip",Ma)};Z.prototype.kGa=function(Ma){this.addHandler("presenceChanged",Ma)};Z.prototype.lAa=function(Ma){this.removeHandler("presenceChanged",
Ma)};Z.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.$w&&this.$w.xPj(this.Vy);var Ma=this.Pz,Hb;for(Hb in Ma){var ic=Ma[Hb];ic.eKd(this.MEb);ic.EKd(this.qFb);ic.DKd(this.pFb);ic.lAa(this.fFb);ic.dispose()}this.$w=this.Jb=this.highlight=this.gridView=this.Pz=null;qb.prototype.dispose.call(this)};Z.prototype.w5f=function(Ma,Hb,ic){ic=void 0===ic?null:ic;Ma?(this.Jb=de.D(Ma),this.jra=this.gridView.rb.rj(this.Jb.topRight)):ic?(this.ih=ic,this.jra=
ic.mg.paneType):this.jra=1;this.sle=Hb;this.Pva(this.paneType);this.CTd(Ma,ic)};Z.prototype.CTd=function(Ma,Hb){var ic=this.Pz,Lc;for(Lc in ic)ic[Lc].CTd(Ma,Hb)};Z.prototype.s5=function(Ma){this.Pva(this.paneType).s5(Ma);Ma=this.Pz;for(var Hb in Ma)Ma[Hb].s5(!1)};Z.prototype.cne=function(Ma){var Hb=this.Pz,ic;for(ic in Hb){var Lc=Hb[ic];Lc.mha(Ma.Pva(Lc.paneType))}};Z.prototype.mha=function(Ma){this.Pva(Ma.paneType).mha(Ma)};Z.prototype.TMa=function(){var Ma=this.Pva(this.paneType).TMa(),Hb=this.Pz,
ic;for(ic in Hb)Ma=Hb[ic].TMa()||Ma;return Ma};Z.prototype.hoa=function(Ma,Hb){this.$w.YZd(this);this.Pva(this.paneType).hoa(Ma,Hb);Hb=this.Pz;for(var ic in Hb)Hb[ic].hoa(Ma,!1)};Z.prototype.OMb=function(Ma){var Hb=this.Pz,ic;for(ic in Hb)Hb[ic].OMb(Ma)};Z.prototype.Bfb=function(){var Ma=this.Pz,Hb;for(Hb in Ma)Ma[Hb].Bfb();this.$w.YZd(this)};Z.prototype.Pva=function(Ma){return this.hVh(Ma,this.sle)};Z.prototype.GZd=function(Ma){this.$w.GZd(Ma)};Z.prototype.hVh=function(Ma,Hb){var ic=this.highlight?
this.highlight.Jw(Hb,Ma).Of:this.ih?this.ih.get_element():null;Hb=Z.y0h(Hb,Ma);var Lc=Md.a.Nc(this.Pz,Hb);Lc||(Lc=new ca(ic,this.gridView,this.Hza,Ma,this.$),this.Pz[Hb]=Lc,Lc.PVc(this.MEb),Lc.nWc(this.qFb),Lc.mWc(this.pFb),Lc.kGa(this.fFb));return Lc};Z.y0h=function(Ma,Hb){return Ma.toString()+Hb.toString()};Ck.Object.defineProperties(Z.prototype,{Vy:{configurable:!0,enumerable:!0,get:function(){return this.kTc}},Hza:{configurable:!0,enumerable:!0,get:function(){return this.FPc}},paneType:{configurable:!0,
enumerable:!0,get:function(){return this.jra}},range:{configurable:!0,enumerable:!0,get:function(){return this.Jb}},Oqc:{configurable:!0,enumerable:!0,get:function(){return this.Jb||this.ih?U(this.gridView.Tf(this.paneType),this.Pva(this.paneType).Oqc,!0):null}},bva:{configurable:!0,enumerable:!0,get:function(){return this.Pva(this.paneType).bva},set:function(Ma){var Hb=this.Pz,ic;for(ic in Hb)Hb[ic].bva=Ma}}});Object(ec.a)(Z,"PaneInvariantTooltipNotificationUnit",nb.a,[912,2]);ea.prototype.dispose=
function(){this.Rxb();dd.a.Ha(this.tu);this.objectId=this.$=this.Gp=this.ih=null};ea.prototype.mha=function(Ma){this.tu.cne(Ma.tu)};ea.prototype.Rxb=function(){this.ih&&this.Gp&&this.Gp.User&&(this.ih.cCc(!1,this.Gp.User.UserID,null),this.tu.s5(!0))};ea.prototype.aMb=function(){H.ILb&&this.ih&&this.Gp&&this.Gp.User&&(this.ih.cCc(!0,this.Gp.User.UserID,this.Gp.UserColor),this.tu.Bfb())};ea.prototype.QB=function(Ma){H.goa&&(this.tu.bva=Ma,this.tu.hoa(Ma,!0))};ea.prototype.iMb=function(Ma,Hb){this.tu.w5f(null,
0===Hb?46:47,Ma)};Ck.Object.defineProperties(ea.prototype,{ih:{configurable:!0,enumerable:!0,get:function(){return this.TDa},set:function(Ma){this.TDa=Ma;!this.TDa||Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:6032771_PresenceToolTipZIndexCheck")&&!this.TDa.Xy||this.$w.FUj(this.TDa.Xy)}}});Object(ec.a)(ea,"FloatingObjectPresenceHighlight",null,[888,2]);var Sb=b(721),$b=b(71),tc=b(10),ld=b(259),Vc=b(162),Se=Sb.a;Am(Q,Se);Q.prototype.dispose=function(){var Ma;dd.a.Ha(this.tu);Se.prototype.dispose.call(this);
var Hb=Q.S0a,ic;for(ic in Hb){var Lc=ic,td=Hb[ic];td&&!td.children.length&&(zc.DOMElementExtensions.Af(td),Q.S0a[Lc]=null)}null===(Ma=Q.excelLiveManager)||void 0===Ma?void 0:Ma.uKd(this.gFb);this.Fz=null};Q.prototype.mha=function(Ma){this.tu.cne(Ma.tu)};Q.prototype.QB=function(Ma){H.goa&&(this.Bhc||(this.tu.bva=Ma,this.tu.hoa(Ma,!0)),this.dMb=Ma&&this.Bhc)};Q.prototype.iMb=function(Ma,Hb){this.tu.w5f(Ma,0===Hb?46:47);this.dMb=!1};Q.prototype.aMb=function(Ma){H.ILb&&(this.tu.hoa(!0,!0),this.t2d=Ma,
this.Gn([Ma]))};Q.prototype.Rxb=function(Ma){this.s5();this.Xh(Ma)};Q.prototype.VFe=function(Ma,Hb,ic){ic.className=$b.a.ewh;ic.style.borderColor=this.Gp.UserColor;var Lc=document.createElement("div");46!==Ma&&47!==Ma&&(Lc.style.backgroundColor=this.Gp.UserColor);ic.appendChild(Lc);Lc.className=[$b.a.gwh,$b.a.fwh][Ma-46];Ma=Md.a.Nc(Q.S0a,Hb.toString());if(!Ma){var td=this.gridView.Tf(Hb).domElement;Ma=document.createElement("div");td.insertBefore(Ma,td.firstChild);Q.S0a[Hb.toString()]=Ma}Ma.appendChild(ic);
this.Wef&&this.i9h(Lc)};Q.prototype.Oxb=function(){};Q.prototype.z_f=function(Ma,Hb,ic,Lc){var td=this.IIg(Lc,Ma,Hb);ld.c(ic,this.gridView.rtl,tc.HelperMethods.nc(td.x));ic.width=tc.HelperMethods.nc(td.width);ic.top=tc.HelperMethods.nc(td.y);ic.height=tc.HelperMethods.nc(td.height);Hb=Hb.Of;ic=Hb.parentNode;47===Ma?Q.YHd(ic,Hb,!1):46===Ma&&(td=this.Jw(47),Lc.equals(td.xjc)?Q.YHd(ic,Hb,!1):Q.YHd(ic,Hb,!0));this.V_i(Ma)};Q.prototype.f3f=function(){return!1};Q.prototype.IIg=function(Ma,Hb,ic){var Lc=
Ma.y+this.Yvb(ic,!1);ic=Ma.x+this.Yvb(ic,!0)+Ie.a.ydd(ic.Of.parentNode.parentNode,this.gridView.rtl);var td=Ma.width;Ma=Ma.height+1;1>ic&&-1<=ic&&46===Hb&&(td-=1-ic,ic=1);1>Lc&&-1<=Lc&&46===Hb&&(Ma-=1-Lc,Lc=1);td=Math.max(0,td-1);Ma=Math.max(0,Ma-2);return new vg.a(ic,Lc,td,Ma)};Q.prototype.V_i=function(Ma){this.tu.Bfb();this.t2d=Ma;this.Bhc=!1;this.dMb&&this.QB(!0);this.dMb=!1};Q.prototype.s5=function(){this.Bhc||(this.tu.s5(!0),this.dMb=!1)};Q.YHd=function(Ma,Hb,ic){ic?Hb!==Ma.firstChild&&(Ma.removeChild(Hb),
Ma.insertBefore(Hb,Ma.firstChild)):Hb!==Ma.lastChild&&(Ma.removeChild(Hb),Ma.appendChild(Hb))};Q.prototype.i9h=function(Ma){var Hb;(null===(Hb=Q.excelLiveManager)||void 0===Hb?0:Hb.yza.JB)?this.j9h(Ma):this.Fz.push(Ma)};Q.prototype.j9h=function(Ma){this.Gp.User.UserID===Q.excelLiveManager.yza.JB&&(this.w9e(Ma),this.peg(Ma))};Q.prototype.sti=function(){var Ma=this;Q.excelLiveManager?Q.excelLiveManager.XZb(this.gFb):this.$.da.$a(473,function(Hb){Q.excelLiveManager=Hb;Q.excelLiveManager.XZb(Ma.gFb)})};
Q.prototype.w9e=function(Ma){var Hb=this;Lf.a(function(){Ma.style.backgroundColor=Hb.Gp.UserColor;Ma.classList.add($b.a.lwh)},this.$.la)};Q.prototype.peg=function(Ma){this.Rli&&(this.tu.GZd(Q.excelLiveManager.yza.JB),Lf.a(function(){Ma.parentElement.classList.add($b.a.kwh)},this.$.la))};Q.S0a=null;Object(ec.a)(Q,"PresenceHighlight",Sb.a,[]);Am(R,Ta);R.prototype.nyc=function(){for(var Ma=1===this.xc.PresenceType?47:46,Hb=0;Hb<this.Jy.length;Hb++)this.Jy[Hb].aMb(Ma);for(Ma=0;Ma<this.uH.count;Ma++)this.uH.hg(Ma).aMb()};
R.prototype.sec=function(){for(var Ma=1===this.xc.PresenceType?47:46,Hb=0;Hb<this.Jy.length;Hb++)this.Jy[Hb].Rxb([Ma]);for(Ma=0;Ma<this.uH.count;Ma++)this.uH.hg(Ma).Rxb()};R.prototype.dispose=function(){this.$&&(this.$.xa&&this.$.xa.Vg(this.fza),vf.g(this.$).mL(this.Uq));this.JJe();dd.a.yc(this.Jy);dd.a.yc([this.hA]);this.hA=this.$=null;this.HQd(null);this.uH=null;Ta.prototype.dispose.call(this)};R.prototype.JJe=function(){if(this.uH){for(var Ma=0;Ma<this.uH.count;Ma++)this.uH.hg(Ma).dispose();this.uH.clear()}};
R.prototype.j0a=function(Ma){1===this.xc.Version?this.CXg(Ma):this.DXg(Ma)};R.prototype.CXg=function(Ma){if(Ma.xc.SelectedRange&&this.xc.SelectedRange)for(var Hb=this.xc.SelectedRange.length,ic=Ma.xc.SelectedRange.length,Lc=0;Lc<Hb;Lc++)for(var td=0;td<ic;td++)if(Oa(this.xc.SelectedRange[Lc],Ma.xc.SelectedRange[td])){this.Jy[Lc].mha(Ma.I4a(td));return}};R.prototype.DXg=function(Ma){var Hb,ic=0,Lc=0;if(this.xc&&this.xc.Object&&(null===(Hb=Ma.xc)||void 0===Hb?0:Hb.Object)){Hb=this.xc.Object.length;
for(var td=Ma.xc.Object.length,pd=0;pd<Hb;pd++)if(this.xc.Object[pd]&&this.vhd(this.xc.Object[pd])){ic++;for(var Qe=0;Qe<td;Qe++)if(Ma.xc.Object[Qe]&&this.vhd(Ma.xc.Object[Qe])&&(Lc++,this.zXc(this.xc.Object[pd],Ma.xc.Object[Qe]))){var ff=this.I4a(ic),hf=Ma.I4a(Lc);if(ff&&hf){ff.mha(hf);return}}}else if(this.xc.Object[pd]&&Ma.xc.Object[pd]&&(0===this.xc.Object[pd].ObjectType||2===this.xc.Object[pd].ObjectType))for(Qe=0;Qe<td;Qe++)if(Ma.xc.Object[Qe]&&(0===Ma.xc.Object[pd].ObjectType||2===Ma.xc.Object[pd].ObjectType)&&
this.xc.Object[pd].ObjectId===Ma.xc.Object[Qe].ObjectId&&(ff=this.mfd(this.xc.Object[pd].ObjectId),hf=Ma.mfd(this.xc.Object[pd].ObjectId),ff&&hf)){ff.mha(hf);return}}if(Ma.xc.SelectedRange&&this.xc.SelectedRange)for(Hb=this.xc.SelectedRange.length,td=Ma.xc.SelectedRange.length,pd=0;pd<Hb;pd++)for(Qe=0;Qe<td;Qe++)if(Oa(this.xc.SelectedRange[pd],Ma.xc.SelectedRange[Qe])&&(ff=this.I4a(ic+pd),hf=Ma.I4a(Lc+Qe),ff&&hf)){ff.mha(hf);return}};R.prototype.zXc=function(Ma,Hb){return!!Ma&&!!Hb&&Hb.ObjectType===
Ma.ObjectType&&(1===Ma.ObjectType||3===Ma.ObjectType)&&!Ma.ObjectId.localeCompare(Hb.ObjectId)};R.prototype.I4a=function(Ma){return 0<=Ma&&this.Jy.length>Ma?this.Jy[Ma]:null};R.prototype.o5f=function(Ma){for(var Hb=0,ic=this.Jy.length;Hb<ic;Hb++)this.Jy[Hb].QB(Ma)};R.prototype.mfd=function(Ma){return Ma&&this.uH.xb(Ma)?this.uH.getItem(Ma):null};R.prototype.p5f=function(Ma,Hb){Hb=void 0===Hb?null:Hb;if(Ma)(Ma=this.uH.getItem(Hb))&&Ma.QB(!0);else for(Ma=0;Ma<this.uH.count;Ma++)(Hb=this.uH.hg(Ma))&&
Hb.QB(!1)};R.prototype.jeg=function(Ma){Ta.rTj(this,Ma)};R.prototype.H4c=function(Ma,Hb){if(Ma<Hb)return this.Jy[Ma];if(!this.Gp||!this.$||!this.$w)return null;Ma=new Q(this.Gp,this.$,this.$w);this.Jy.push(Ma);return Ma};R.prototype.srj=function(){for(var Ma=this.Jy.length,Hb=this.xc.SelectedRange?this.xc.SelectedRange.length:0,ic=this.$.xa.qa,Lc=0;Lc<Hb;Lc++){var td=this.H4c(Lc,Ma);td&&this.xc.SelectedRange[Lc]&&(this.xc.SelectedRange[Lc].NamedObjectName?td.Xh([47,46]):(td.iMb(this.xc.SelectedRange[Lc],
this.xc.PresenceType),R.FZd(this.xc.PresenceType,td,this.xc.SelectedRange[Lc],ic,this.Gp,this.$w)))}for(Hb=this.hA&&this.hA.bGd&&this.hA.bGd.PresenceType!==this.hA.xc.PresenceType?0:Hb;Hb<Ma;Hb++)this.Jy[Hb].Xh([1===this.hA.bGd.PresenceType?47:46])};R.prototype.vhd=function(Ma){return(null===Ma||void 0===Ma?0:Ma.ObjectId)&&(1===this.l1e(Ma.ObjectType)||2===this.l1e(Ma.ObjectType))&&(Ma=this.$.Hb.mgd(Ma.ObjectId))?de.w(Ma):null};R.prototype.trj=function(){for(var Ma=this.Jy.length,Hb=this.$.xa.qa,
ic=this.xc.SelectedRange?this.xc.SelectedRange.length:0,Lc=this.xc.Object?this.xc.Object.length:0,td=0;td<Ma;td++)this.Jy[td].Xh([47,46]);this.MYg();for(var pd=this.G3c=this.F3c=td=0;pd<Lc;pd++){var Qe=this.xc.Object[pd],ff=this.vhd(Qe);if(ff){var hf=this.H4c(td,Ma);1===Qe.ObjectType?this.F3c++:3===Qe.ObjectType&&this.G3c++;td++;hf.iMb(ff,Qe.ObjectPresenceType);R.FZd(Qe.ObjectPresenceType,hf,ff,Hb,this.Gp,this.$w)}}for(Lc=0;Lc<ic;Lc++)this.xc&&this.xc.SelectedRange&&(pd=this.xc.SelectedRange[Lc],
pd.NamedObjectName||(Qe=!!Hb&&pd.SheetName===Hb.name,ff=!!wb(pd,this.$,1),Qe&&ff||(Qe=this.H4c(td+Lc,Ma),Qe.iMb(pd,this.xc.PresenceType),R.FZd(this.xc.PresenceType,Qe,pd,Hb,this.Gp,this.$w))));0<(this.countFloatingObjects=this.SYf())&&Ub.ULS.sendTraceTag(537154370,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};R.prototype.MYg=function(){this.SYf();this.JJe()};R.prototype.SYf=function(){var Ma=0;if(this.xc&&this.xc.Object)for(var Hb=0;Hb<this.xc.Object.length;Hb++)this.bSj(this.xc.Object[Hb])&&
Ma++;return Ma};R.prototype.$8g=function(Ma,Hb){if(this.uH.xb(Hb))return Hb=this.uH.getItem(Hb),Hb.ih=Ma,Hb;if(!this.Gp||!this.$||!this.$w)return null;var ic=new ea(this.Gp,this.$,this.$w);ic.ih=Ma;this.uH.add(Hb,ic);return ic};R.prototype.bSj=function(Ma){var Hb=!1;if((null===Ma||void 0===Ma?0:Ma.ObjectId)&&(0===Ma.ObjectType||2===Ma.ObjectType))try{var ic=this.uQh(Ma);if(ic){var Lc=this.$8g(ic,Ma.ObjectId);Lc.iMb(ic,Ma.ObjectPresenceType);Lc.aMb();Hb=!0}}catch(td){throw Ub.ULS.sendTraceTag(537154369,
0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',td.stack),td;}return Hb};R.prototype.uQh=function(Ma){if(!Ma)return null;var Hb=null;2===Ma.ObjectType?Hb=Rb.a(this.$).GKa(Ma.ObjectId):0===Ma.ObjectType&&(Ma=this.$.Hb.mgd(Ma.ObjectId),null===Ma||void 0===Ma?0:Ma.VLa)&&(Hb=Rb.a(this.$).iSh(Ma.VLa));return Hb};R.prototype.FPd=function(){try{1===this.xc.Version?(this.srj(),Ub.ULS.sendTraceTag(537154368,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.trj(),Ub.ULS.sendTraceTag(537154339,
0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.countFloatingObjects,this.F3c,this.G3c))}catch(Ma){throw Ub.ULS.sendTraceTag(537154338,0,10,'{{"SetGridHighlight Exception":"{0}"}',Ma.stack),Ma;}};R.prototype.l1e=function(Ma){switch(Ma){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}};R.FZd=function(Ma,Hb,ic,Lc,td,pd){var Qe=1===Ma?47:46;Lc&&ic&&Lc.name===ic.SheetName?(Hb.vj(de.D(ic),[Qe]),Hb.aMb(Qe),Ub.ULS.shipAssertTag(537154337,0,
Hb.tu.Vy===td.User.UserID,"UserID and UnitID should match"),pd.bLb(Hb.tu.Vy,1===Ma)):Hb.Rxb([Qe])};Ck.Object.defineProperties(R.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return this.hA.xc},set:function(Ma){this.hA.xc=Ma;this.FPd()}}});Object(ec.a)(R,"UserGridPresence",Ta,[]);var Ge=b(46),Af=b(1003),jf=nb.a;Am(T,jf);T.prototype.kGa=function(Ma){this.addHandler("pcek",Ma)};T.prototype.lAa=function(Ma){this.removeHandler("pcek",Ma)};T.prototype.uQf=function(Ma){this.oCa[Ma]&&this.jQf(Ma,
!1)};T.prototype.xUd=function(Ma){this.isb&&this.isb!==Ma.clientId&&(this.ERd=!1);!Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||this.$.ea.E5a&&Ge.PageLoadTrackingInfo.instance.cpj||(this.ERd=!1);this.xL.Z1g(Ma);this.isb=Ma.clientId};T.prototype.pSh=function(Ma,Hb){var ic=[];var Lc=[];var td=this.oCa,pd;for(pd in td){var Qe=td[pd];if(Hb){var ff=de.k(Ma,this.$);this.Q4e(ff,ic,Lc,Qe)}else this.P4e(Ma,ic,Lc,Qe)}return{Mdi:ic,Djh:Lc}};T.prototype.EIe=function(Ma,
Hb,ic,Lc,td){(td=this.oCa[td])&&(Hb?this.Q4e(Ma,ic,Lc,td):this.P4e(Ma,ic,Lc,td))};T.prototype.p1h=function(){var Ma=[],Hb=this.oCa,ic;for(ic in Hb){var Lc=Hb[ic],td=Lc.xc.SelectedRange;if(void 0!==td&&null!==td&&Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){td=Cl(td);for(var pd=td.next();!pd.done;pd=td.next()){pd=pd.value;var Qe=de.D(pd),ff=vf.g(this.$).ha.ta.W4;if(this.$.xa.qa.sheetName===pd.SheetName&&Qe.right===ff.right&&Qe.top===ff.top){Lc=Lc.Gp;Lc=
new Gb.a(Lc.User.UserID,Lc.User.UserName,Lc.UserColor,new oc.a(1),null,Lc.UserEmail,void 0,void 0,void 0,void 0,void 0,Lc.JoinCoauthTime);Ma.push(Lc);break}}}}return Ma};T.prototype.nyc=function(){H.ILb=!0;H.goa=!0;var Ma=this.Tu,Hb;for(Hb in Ma)Ma[Hb].nyc()};T.prototype.sec=function(){H.ILb=!1;H.goa=!1;var Ma=this.Tu,Hb;for(Hb in Ma)Ma[Hb].sec()};T.prototype.dispose=function(){this.hOb();this.$&&(this.$.xa&&this.$.xa.Vg(this.fza),this.$.na&&this.$.na.Lda(this.J8),this.$.sm(this.Zc));this.Dn&&this.Dn.ZJd(this.qEb);
this.UXc&&(this.UXc.dispose(),this.UXc=null);if(this.Tu){var Ma=this.Tu,Hb;for(Hb in Ma)Ma[Hb].dispose()}dd.a.yc([this.xL,this.$w]);this.Aze();this.Tu=this.$=this.lhe=null;Array.clear(this.qy);jf.prototype.dispose.call(this)};T.prototype.hOb=function(){this.xL&&(this.xL.lAa(this.NCd),this.xL.Tbj(this.wxf),this.xL.sdj(this.OBf),this.xL.Jda(this.kd));this.NOa.oRf(this.YEb)};T.prototype.hGe=function(Ma){return new R(Ma,this.$,this.$w)};T.prototype.$me=function(Ma){var Hb=this.$.ea.iid(Ma);if(Hb)if(Ma in
this.Tu)this.Tu[Ma].jeg(Hb);else{var ic=this.hGe(Hb);this.Tu[Ma]=ic;this.j0a(ic)}return!!Hb};T.prototype.Q4e=function(Ma,Hb,ic,Lc){if(Ma){Ma=Cl(Ma);for(var td=Ma.next();!td.done;td=Ma.next()){if(td=td.value){var pd=wb(td,this.$,1);if(pd&&T.kid(pd.jj,Hb,ic,Lc))break;if((pd=wb(td,this.$,2))&&T.kid(pd.jj,Hb,ic,Lc))break}if(Lc.xc.SelectedRange){pd=Cl(Lc.xc.SelectedRange);for(var Qe=pd.next();!Qe.done;Qe=pd.next())if((Qe=Qe.value)&&td&&Oa(td,Qe)){Array.add(1===Lc.xc.PresenceType?ic:Hb,Lc.hA.XOb.User);
return}}}}};T.prototype.P4e=function(Ma,Hb,ic,Lc){Ma&&T.kid(this.AQh(Ma),Hb,ic,Lc)};T.prototype.QIg=function(Ma){Ma.SelectedRange&&(Ma.SelectedRangeRaw=this.Nch(Ma.SelectedRange),Ma.SelectedRange=this.NOa.I3g(Ma.SelectedRange))};T.prototype.Nch=function(Ma){for(var Hb=Array(Ma.length),ic=0;ic<Ma.length;ic++){var Lc=ic,td=Ma[ic],pd={};pd.SheetName=td.SheetName;pd.FirstColumn=td.FirstColumn;pd.FirstRow=td.FirstRow;pd.LastRow=td.LastRow;pd.LastColumn=td.LastColumn;pd.NamedObjectName=td.NamedObjectName;
Hb[Lc]=pd}return Hb};T.prototype.AQh=function(Ma){if(Ma)switch(Ma.type){case 0:return(Ma=this.$.Hb.k1e(Ma.id))?Ma.jj:null;case 2:return Ma.jj}return null};T.prototype.N5a=function(){this.xL.kGa(this.NCd);this.xL.hHg(this.OBf);this.xL.lFg(this.wxf);this.xL.j3(this.kd);this.NOa.Joe(this.YEb)};T.prototype.tnf=function(Ma,Hb,ic,Lc){var td={};td.a=this.$.ya.UserSessionId;td.b=Ma;td.c=ic?"PendingUserRemoved":"Non-PendingUserRemoved";td.d=Lc?"Disconnected":"Inactivity";td.e=Hb;Ed.b().Pe(22,td,!0)};T.prototype.jQf=
function(Ma,Hb){Ma in this.Tu&&(this.sQf(Ma),this.Tu[Ma].dispose(),delete this.Tu[Ma],Ub.ULS.sendTraceTag(537154375,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",Ma),this.tnf(Ma,Ve.a.Ta.Wb,!1,Hb));Ma in this.Lma&&(this.Ckc(Ma,!1),delete this.jab[Ma],delete this.Lma[Ma],Ub.ULS.sendTraceTag(537154374,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",Ma),this.tnf(Ma,Ve.a.Ta.Wb,!0,Hb))};T.prototype.sQf=function(Ma){for(var Hb=
this.qy.length-1;0<=Hb;Hb--)if(this.qy[Hb].User.UserID===Ma){Array.removeAt(this.qy,Hb);for(var ic=Cl(this.Tu[Ma].Jy),Lc=ic.next();!Lc.done;Lc=ic.next())this.$w.Sna(Lc.value.tu.Vy,!1);this.qyc()}};T.prototype.jvi=function(){if(this.z4b||this.A4b)this.$.Zd(-70383382,-1,0,null),Ub.ULS.sendTraceTag(537154373,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.A4b,this.z4b);this.A4b=this.z4b=0};T.prototype.Aze=
function(){this.Nud();this.uPc=this.jab=null};T.prototype.Nud=function(){var Ma=this.Lma,Hb;for(Hb in Ma)this.Ckc(Hb,!1)};T.prototype.Bui=function(){var Ma=this.h7c,Hb;for(Hb in Ma)this.dnf(Hb,!0,Ma[Hb]);Ma=this.hmd;for(var ic in Ma)this.dnf(ic,!1,Ma[ic]);this.h7c={};this.hmd={}};T.prototype.Ckc=function(Ma,Hb){if(this.$.uv&&this.$.ea.sc){var ic={};ic.a=this.$.ya.UserSessionId;ic.b=Ma;ic.c=Hb;ic.e=!1;ic.d=-1;ic.f=Ve.a.Ta.Wb;this.$.ea&&(ic.e=this.$.ea.RM);if(Ma=this.jab[Ma])ic.d=kf.a(Ve.a.Ta,Ma);Ed.b().Pe(20,
ic,!0)}};T.prototype.qvd=function(Ma){if(this.$.uv){var Hb={e:-1,f:-1,c:!1,d:!1};Hb.b=Ma;Hb.a=this.$.ya.UserSessionId;this.$.ea&&(Hb.c=this.$.ea.E5a,Hb.d=this.$.ea.RM,Hb.e=this.$.ea.Qm.length,this.$.ea.BCa&&(Hb.f=kf.a(Ve.a.Ta,this.$.ea.sYj)));Ed.b().Pe(21,Hb,!0)}};T.prototype.dnf=function(Ma,Hb,ic){if(this.$.uv){var Lc={};Lc.a=this.$.ya.UserSessionId;Lc.b=Ma;Lc.c=Hb;Lc.d=ic;Ed.b().Pe(19,Lc,!0)}};T.prototype.m7e=function(){var Ma=[],Hb=this.Tu,ic;for(ic in Hb){var Lc=Hb[ic];if(this.xL.TXf(Lc.xc)){this.Mne(Ma,
Lc);Array.remove(this.qy,Lc.hA.XOb);if(1===this.xL.xc.PresenceType){var td={};td.a=1===Lc.xc.PresenceType?"Editing":"Non-Editing";td.b=this.$.ya.UserSessionId;td.c=Ve.a.Ta.Wb;Ed.b().Pe(18,td)}td=Cl(Lc.Jy);for(Lc=td.next();!Lc.done;Lc=td.next())this.$w.Sna(Lc.value.tu.Vy,!0)}else for(td=Cl(Lc.Jy),Lc=td.next();!Lc.done;Lc=td.next())this.$w.Sna(Lc.value.tu.Vy,!1)}Array.clear(this.qy);this.qy=Ma;this.qyc()};T.prototype.Mne=function(Ma,Hb){var ic=Hb.hA.XOb;if(0===Hb.xc.PresenceType){Hb=Ma.length;var Lc;
for(Lc=0;Lc<Hb&&0===this.Tu[Ma[Lc].User.UserID].xc.PresenceType;Lc++);Array.insert(Ma,Lc,ic)}else Ma.push(ic)};T.prototype.j0a=function(Ma){this.xL.TXf(Ma.xc)&&(this.Mne(this.qy,Ma),this.qyc());var Hb=Ma.hA.XOb.User.UserID,ic=this.Tu,Lc;for(Lc in ic){var td=ic[Lc];Lc!==Hb&&Ma.j0a(td)}};T.prototype.qyc=function(){0<this.qy.length&&this.yCj()};T.prototype.yCj=function(){for(var Ma=0,Hb=this.qy.length;Ma<Hb;Ma++){var ic=this.Tu[this.qy[Ma].User.UserID];if(ic)if(this.xL.nMf(ic.xc)){ic.o5f(!0);ic=Cl(ic.Jy);
for(var Lc=ic.next();!Lc.done;Lc=ic.next())this.$w.Sna(Lc.value.tu.Vy,!0)}else(Lc=this.xL.t0e(ic.xc))&&ic.p5f(!0,Lc)}};T.prototype.CVh=function(Ma){var Hb={User:{}};Hb.User.UserID=Ma;Hb.User.UserName=of.a.instance.Ab(87);Hb.UserColor="#AAAAAA";return Hb};T.prototype.dBe=function(Ma,Hb){var ic=this;this.ERd&&this.wFd&&(Ma&&Hb?this.vFd?this.vFd.ulh(Ma,Hb,this.isb):this.wFd.continueWith(function(){ic.vFd=ic.wFd.result;ic.dBe(Ma,Hb)}):Ub.ULS.sendTraceTag(537154372,0,15,"userId: [{0}], endTime: [{1}]",
Ma,Hb))};T.kid=function(Ma,Hb,ic,Lc){if(!Lc||!Lc.xc||!Lc.xc.Object)return!1;for(var td=Cl(Lc.xc.Object),pd=td.next();!pd.done;pd=td.next())if(pd=pd.value,Ma&&pd&&pd.ObjectId&&!pd.ObjectId.localeCompare(Ma))return Array.add(1===pd.ObjectPresenceType?ic:Hb,Lc.hA.XOb.User),!0;return!1};Ck.Object.defineProperties(T.prototype,{xL:{configurable:!0,enumerable:!0,get:function(){return this.lhe}},oCa:{configurable:!0,enumerable:!0,get:function(){return this.Tu}},Lma:{configurable:!0,enumerable:!0,get:function(){return this.uPc}}});
Object(ec.a)(T,"PresenceView",nb.a,[871,872]);var Ef=b(211),Xf=b(229),ug=b(329),Wb=nb.a;Am(M,Wb);M.prototype.Aq=function(Ma){this.addHandler("OSC",Ma)};M.prototype.Xq=function(Ma){this.removeHandler("OSC",Ma)};M.prototype.Qz=function(){this.raiseEvent("OSC")};M.prototype.fs=function(Ma,Hb){if("QueryOcsConnectionStatus"===Ma)Hb.Value=this.$.ea.X7a?of.a.instance.fa(903):of.a.instance.fa(904);else return!1;return!0};M.prototype.xn=function(){return!0};M.prototype.dispose=function(){this.statusBarManager&&
(this.statusBarManager.ZF(this),this.statusBarManager=null);this.$=null;Wb.prototype.dispose.call(this)};Object(ec.a)(M,"OcsStatusBarManager",nb.a,[2,543,373]);var Kc=nb.a;Am(A,Kc);A.prototype.fgd=function(){this.e0||(this.e0={},this.e0.IsPresenter=this.$.ya.IsMeetingPresenter,this.e0.MeetingId=this.$.ya.MeetingId);this.e0.MessageId=++this.messageId;Ub.ULS.sendTraceTag(524940883,0,50,"SelectionPresenceManager::getMeetingInfo: Sending presence with messageId: "+this.messageId);return this.e0};A.prototype.kGa=
function(Ma){this.addHandler(A.xFd,Ma)};A.prototype.lAa=function(Ma){this.removeHandler(A.xFd,Ma)};A.prototype.lFg=function(Ma){this.$.ea.rha(Ma)};A.prototype.Tbj=function(Ma){this.$.ea.Kda(Ma)};A.prototype.j3=function(Ma){this.addHandler(A.d1,Ma)};A.prototype.Jda=function(Ma){this.removeHandler(A.d1,Ma)};A.prototype.hHg=function(Ma){this.addHandler(A.yFd,Ma)};A.prototype.sdj=function(Ma){this.removeHandler(A.yFd,Ma)};A.prototype.dispose=function(){this.$&&(this.hOb(),this.$.Ul(this.zd),this.$.sm(this.Zc));
this.Hj&&this.Hj.mAa(this.Ama);dd.a.Ha(this.Ptf);this.$=this.Hj=this.e0=null;Kc.prototype.dispose.call(this)};A.prototype.Z1g=function(Ma){this.Hj?this.Hj.mAa(this.Ama):this.N5a();(this.Hj=Ma)?(this.Hj.lGa(this.Ama),this.Ucb(!0)):this.hOb()};A.prototype.N5a=function(){var Ma=this;this.ha.WG(this.kd);vf.g(this.$).rE(this.Dp);var Hb=vf.g(this.$).rc;Hb.To(this.Ng);Hb.sl(this.gj);this.$.ea.gk(this.qd);this.$.ea.woe(this.Wif);this.NOa.Joe(this.YEb);Hb=this.$.na.va;Hb.mGa(this.kFf);Hb.Bq(this.Th);Hb.iz(this.Wn);
this.Phf?this.$.da.$a(16,function(ic){ic.moe(Ma.Bnc);ic.loe(Ma.Ng)}):(Hb=hb.GetServiceTaskFactory.Ua(this.$.da,16,74,1),zb.TaskExtensions.Ba(Hb,function(ic){Ma.fieldManagerPane=ic.result;Ma.fieldManagerPane.moe(Ma.Bnc);Ma.fieldManagerPane.loe(Ma.Ng)},Ef.a.none,3))};A.prototype.hOb=function(){var Ma=this;this.ha.cG(this.kd);vf.g(this.$).aG(this.Dp);var Hb=vf.g(this.$).rc;Hb.Zn(this.Ng);Hb.kl(this.gj);this.$.ea.Fk(this.qd);this.$.ea.eRf(this.Wif);this.NOa.oRf(this.YEb);this.$.na.va.UQa(this.kFf);this.$.na.va.Dr(this.Th);
this.$.na.va.Yz(this.Wn);this.Phf?this.$.da.$a(16,function(ic){ic.WQf(Ma.Bnc);ic.VQf(Ma.Ng)}):this.fieldManagerPane&&(this.fieldManagerPane.WQf(this.Bnc),this.fieldManagerPane.VQf(this.Ng));this.raiseEvent(A.yFd)};A.prototype.TXf=function(Ma){return this.nMf(Ma)||!!this.t0e(Ma)};A.prototype.nMf=function(Ma){if(2===this.xc.Version&&this.xc.Object&&2===Ma.Version&&Ma.Object&&0<this.xc.Object.length&&0<Ma.Object.length)for(var Hb=this.xc.Object.length,ic=Ma.Object.length,Lc=0;Lc<Hb;Lc++)for(var td=0;td<
ic;td++)if(this.zXc(this.xc.Object[Lc],Ma.Object[td]))return!0;if(this.xc.SelectedRange&&Ma.SelectedRange)for(Hb=this.xc.SelectedRange.length,ic=Ma.SelectedRange.length,Lc=0;Lc<Hb;Lc++)for(td=0;td<ic;td++)if(A.MLg(this.xc.SelectedRange[Lc],Ma.SelectedRange[td]))return!0;return!1};A.prototype.t0e=function(Ma){if(2===this.xc.Version&&this.xc.Object&&2===Ma.Version&&Ma.Object&&0<this.xc.Object.length&&0<Ma.Object.length)for(var Hb=this.xc.Object.length,ic=Ma.Object.length,Lc=0;Lc<Hb;Lc++)for(var td=
0;td<ic;td++)if(A.ZFi(this.xc.Object[Lc],Ma.Object[td]))return this.xc.Object[Lc].ObjectId;return null};A.prototype.zXc=function(Ma,Hb){return!!Ma&&!!Hb&&Ma.ObjectType===Hb.ObjectType&&(1===Ma.ObjectType||3===Ma.ObjectType)&&!!Ma.ObjectId&&!!Hb.ObjectId&&!Ma.ObjectId.localeCompare(Hb.ObjectId)};A.prototype.aYf=function(){this.Ucb(!1)};A.prototype.Ucb=function(Ma){this.ha.Oa.oc?this.yOd(0,Ma):this.HOd(vf.g(this.$).rc.isEditing?1:0,Ma)};A.prototype.yOd=function(Ma,Hb){var ic={};this.$.Dj(ic);if(this.ha.Oa.oc){var Lc=
this.ha.Oa.oc.floatingObject;ic.FirstColumn=-1;ic.FirstRow=-1;ic.LastColumn=-1;ic.LastRow=-1;ic.NamedObjectName=Lc?Lc.Tg():null;this.xc.SelectedRange=[ic];this.xc.PresenceType=0;ic=null;if(Lc)switch(Lc.type){case 0:if(Lc=this.$.Hb.k1e(Lc.id))ic={},ic.ObjectType=this.oba(0),ic.ObjectPresenceType=Ma,ic.ObjectId=Lc.jj;break;case 2:Lc.id&&(ic={},ic.ObjectType=this.oba(9),ic.ObjectPresenceType=Ma,ic.ObjectId=Lc.jj)}this.xc.Object=[ic]}this.raiseEvent(A.d1);this.sendPresenceToService(Hb)};A.prototype.HOd=
function(Ma,Hb){if(!vf.g(this.$).isEditing&&!vf.g(this.$).Ni){var ic=this.$.Ob.$g("ModelUpdate","SendRangePresence");ic.start();var Lc=de.k(this.ha.ta.selectedRanges,this.$);this.xc.SelectedRange=this.NOa.H3g(Lc);this.xc.Object=[];Lc=Cl(Lc);for(var td=Lc.next();!td.done;td=Lc.next())if(td=wb(td.value,this.$,1)){var pd={};pd.ObjectType=this.oba(td.type);pd.ObjectPresenceType=0;pd.ObjectId=td.jj;this.xc.Object.push(pd)}this.xc.PresenceType=Ma;this.raiseEvent(A.d1);this.xc.SelectedRange||this.xc.Object?
this.sendPresenceToService(Hb):Ub.ULS.sendTraceTag(537154371,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.Hj.clientId);ic.stop()}};A.prototype.sendPresenceToService=function(Ma){if(this.$.ea.b8b||!this.$.ea.O3b||Ma)if(this.amIAlone||++this.OAa.b,this.Hj){this.xc.Version=2;this.xc.ClientType=1;this.xc.ChatThreadId=this.BXa.B0c;this.xc.ChatThreadDiscoveryUri=this.BXa.A0c;this.xc.InChat=this.BXa.myb;this.xc.Cid=
this.BXa.email;this.xc.SupportsChat=!!this.BXa.capabilities&&this.BXa.capabilities.tLa(4);this.xc.CollabMode=this.$.ea.X7a?2:0;this.xc.OcsCapable=this.$.ea.ocsCapable;this.$.ya.IsMeetingLiveSession&&this.$.ya.IsMeetingPresenter&&Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&(this.xc.MeetingInfo=this.fgd());this.Hj.qYf(this.xc);if(Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.$.ea&&this.$.ea.E5a){var Hb=
(new Date).getTime();zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(this.$.da,435,436,1),function(ic){ic.result.Awi(Hb)},this.$.la,3)}this.amIAlone||++this.OAa.c}};A.prototype.uOd=function(){this.$.uv&&(this.OAa.a=this.$.ya.UserSessionId,Ed.b().Pe(26,this.OAa,!0));this.OAa.b=0;this.OAa.c=0};A.prototype.oba=function(Ma){switch(Ma){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};A.ZFi=function(Ma,Hb){return!!Ma&&!!Ma.ObjectId&&!!Hb&&!!Hb.ObjectId&&(0===Ma.ObjectType||
2===Ma.ObjectType)&&Ma.ObjectType===Hb.ObjectType&&!Ma.ObjectId.localeCompare(Hb.ObjectId)};A.MLg=function(Ma,Hb){return!Ma.NamedObjectName&&Oa(Ma,Hb)};Ck.Object.defineProperties(A.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return this.pra}},amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.ea||this.$.ea.amIAlone}}});Ck.Object.defineProperties(A,{jqc:{configurable:!0,enumerable:!0,get:function(){var Ma={};return A.Lee||(A.Lee=(Ma.ApplyFilter=1,Ma.ApplyPivot=0,Ma.ApplyPivotSort=
0,Ma.ApplyPivotSortByValue=1,Ma.ApplyWellKnownPivotFilter=0,Ma.RemovePivotFilter=0,Ma.SetCustomFilter=1,Ma.SetTop10Filter=1,Ma.TogglePivotDrill=0,Ma.RefreshAll=2,Ma))}}});A.xFd="presenceChanged";A.yFd="presenceDisabled";A.d1="selectionChanged";A.Lee=null;Object(ec.a)(A,"SelectionPresenceManager",nb.a,[883,2,884]);var Id=Wd.a;Am(C,Id);C.prototype.create=function(){var Ma=this;this.manager?this.Eb(this.manager):zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.create(this.$.da,28,this.la,this.ub),function(Hb){Ma.Eb(Ma.manager||
(Ma.manager=new A(Ma.$,Hb.result)))},this.la,3)};Object(ec.a)(C,"SelectionPresenceManagerFactory",Wd.a,[]);var Bd=b(1315),oe=b(5),Hd=b(196),we=ne.a;Am(v,we);v.prototype.u0e=function(Ma,Hb){this.qIa=[];Hb=this.presenceView.pSh(Ma,Hb);Ma=Hb.Mdi;Hb=Hb.Djh;Array.addRange(this.qIa,Ma);Array.addRange(this.qIa,Hb);return v.Jve(Ma,Hb)};v.prototype.dispose=function(){this.presenceView.lAa(this.fFb);this.$Pa&&(dd.a.Ha(this.$Pa),this.$Pa=null);we.prototype.dispose.call(this)};v.Jve=function(Ma,Hb){if(!Ma.length&&
!Hb.length)return"";if(Hb.length){if(1===Hb.length)return Ma=of.a.instance.Ab(83),String.format(Ma,Hb[0].UserName);Ma=of.a.instance.Ab(84);return String.format(Ma,Hb.length)}if(1===Ma.length)return Hb=of.a.instance.Ab(85),String.format(Hb,Ma[0].UserName);Hb=of.a.instance.Ab(86);return String.format(Hb,Ma.length)};Object(ec.a)(v,"PresenceReadoutHandlerService",ne.a,[873]);t.prototype.Cdd=function(Ma){return Ma};t.prototype.wEd=function(Ma){for(var Hb=Array(Ma.vHa.count),ic=0,Lc=Cl(Ma.vHa.values),td=
Lc.next();!td.done;td=Lc.next())Hb[ic]=td.value,ic++;return B(this.$.na.va,Hb,Ma.At,Ma.Qaa,null,null)};t.prototype.MWc=function(Ma,Hb){if(!Hb)return Ma;if(!Ma)return Ub.ULS.shipAssertTag(537154136,0,!!Ma,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Hb;Ub.ULS.shipAssertTag(537154135,0,1===Ma.vHa.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");for(var ic=
{},Lc=Cl(Ma.vHa),td=Lc.next();!td.done;ic={qP:ic.qP,nfa:ic.nfa},td=Lc.next())ic.qP=td.value,ic.nfa=void 0,function(pd){return function(){var Qe=Hb.vHa.Nc(pd.qP.key);pd.nfa=Qe.value;return Qe}}(ic)().returnValue?ic.nfa.OcsSessionId!==ic.qP.value.OcsSessionId?(Ub.ULS.sendTraceTag(537154134,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",ic.qP.value.SeqNum,ic.nfa.SeqNum),Hb.vHa.ia(ic.qP.key,ic.qP.value.SeqNum<
ic.nfa.SeqNum?ic.qP.value:ic.nfa),Hb.At=ic.qP.value.SeqNum<ic.nfa.SeqNum?Ma.At:Hb.At):(ic.qP.value.SeqNum>ic.nfa.SeqNum&&Hb.vHa.ia(ic.qP.key,ic.qP.value),Hb.At=Ma.At):(Hb.vHa.add(ic.qP.key,ic.qP.value),Hb.At=Ma.At);return Hb};Object(ec.a)(t,"CheckCollabServiceActionAggregationPerformer",null,[869,870]);x.prototype.Cdd=function(Ma){return Ma};x.prototype.wEd=function(Ma){var Hb=this.$.na.va,ic=Ma.Qbh,Lc=Ma.dnc;Ma=Ma.At;var td=Hb.Na(1,null);td.Id=ic;td.OnBehalfOfOcs=Lc;return Qc.i(Hb,"CheckPersistedContentUpdate",
td,Ma,null,null,null,516)};x.prototype.MWc=function(Ma,Hb){if(!Hb)return Ma;if(!Ma)return Ub.ULS.shipAssertTag(537154133,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Hb;Ma.dnc=Hb.dnc&&Ma.dnc;return Ma};Object(ec.a)(x,"CheckPersistedActionAggregationPerformer",null,[869,870]);Object(ec.a)(r,"RevisionGeneratedNotification",null,[]);Object(ec.a)(y,"StateDownloadedNotification",null,[]);var df=b(170),sf=ne.a;Am(h,sf);h.prototype.dispose=
function(){this.Od=!0;this.Yob&&(this.Yob.dispose(),this.Yob=null);this.contentRefreshManager&&(this.Ecg(),this.contentRefreshManager=null);this.Ea&&(this.PYd(),this.Ea=null);this.viewport&&(this.PYd(),this.viewport=null);this.qf&&(this.qf=null);this.$&&(this.$.Ul(this.zd),this.$.ea.Fk(this.qd),this.$.ea.zRf(this.Vr),this.$=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.ytc(this.zFb),this.mergeSuspensionManager=null);sf.prototype.dispose.call(this)};h.prototype.hHj=function(){this.Jzc||
(this.contentRefreshManager.pHg(this.rCf),this.Jzc=!0,this.Yob.$q())};h.prototype.Ecg=function(){this.Jzc&&(this.contentRefreshManager.ydj(this.rCf),this.Jzc=!1)};h.prototype.fHj=function(){this.Hzc||(this.Ea.Ix(this.Qi),this.Hzc=!0)};h.prototype.PYd=function(){this.Hzc&&(this.Ea.Fv(this.Qi),this.Hzc=!1)};h.prototype.gHj=function(){this.Izc||(this.viewport.qHg(this.vCf),this.Izc=!0)};h.prototype.xQj=function(){this.Izc&&(this.viewport.Bdj(this.vCf),this.Izc=!1)};h.prototype.UDe=function(Ma,Hb){if(Ma!==
rc.a.Re&&!this.yea.xb(Ma)){var ic=Ve.a.Ta.Wb.toISOString();ic=Object(dc.a)(new y,{StateId:Ma,DownloadedOn:ic,IsHidden:this.Ie?this.Ie.Bi:"visible"!==window.document.visibilityState,DocumentLastUnhidden:this.Ie&&this.Ie.Bjc?this.Ie.Bjc.toISOString():null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.ukf?this.contentRefreshManager.ukf.toISOString():null,LastOffline:this.qf&&this.qf.Sxa?this.qf.Sxa.toISOString():null});this.mergeSuspensionManager&&(ic.IsPendingMergeBlockedByClient=
this.sxa,this.nEd&&(ic.PendingMergeBlockedByClientLastEnded=this.nEd.toISOString()));Ub.ULS.sendTraceTag(537154124,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",Hb,JSON.stringify(ic));this.yea.add(Ma,ic)}};h.prototype.Mwd=function(){xb.AFrameworkApplication.ag&&xb.AFrameworkApplication.ag.Mwd()};Object(ec.a)(h,"ContentLatencyTracker",ne.a,[]);var wf=b(1091);Object(ec.a)(w,"UpdateInfo",null,[]);var $e=b(1092),pf=Sys.EventArgs;Am(n,pf);
Object(ec.a)(n,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);m.prototype.fTj=function(){this.Nqc||(this.Nqc=pe.a.Ae(),this.sCb())};m.prototype.cTj=function(){this.Mec||(this.Mec=pe.a.Ae(),this.sCb())};m.prototype.eTj=function(){this.bqc||(this.bqc=pe.a.Ae(),this.sCb())};m.prototype.gTj=function(Ma){this.ZCc||(this.ZCc=pe.a.Ae(),this.ycf=Ma,this.sCb())};m.prototype.sCb=function(Ma){Ma=void 0===Ma?0:Ma;this.Gff||(Ma&&Ma>this.sxi?this.dya(!0):this.Nqc&&this.bqc&&this.Mec&&this.ZCc&&this.dya(!1))};m.prototype.dispose=
function(){this.$=null};m.prototype.dya=function(Ma){var Hb={};Hb.CoAuthorsCount=this.$.ea.Qm.length;Hb.HostNotificationTime=this.Mec;Hb.PeerNotificationTime=this.bqc;Hb.PresenceNotificationTime=this.Nqc;Hb.UserFetchTime=this.ZCc;Hb.IsAlreadyFetchedFromServer=this.ycf;Hb.IsTimeout=Ma;Hb.ClientId=this.clientId;Hb.CurrentUserClientId=this.ubh;Ub.ULS.sendTraceTag(541388879,0,50,"Host Notification Latency Entry: {0}",Hb);this.C$d=!0};Ck.Object.defineProperties(m.prototype,{Gff:{configurable:!0,enumerable:!0,
get:function(){return this.C$d}}});Object(ec.a)(m,"HostNotificationLatencyEntry",null,[2]);Object(ec.a)(f,"PersistedContentUpdateActionParameters",null,[]);e.prototype.BPj=function(Ma){this.U_b(Ma.r1c,this.bHc);this.U_b(Ma.s1c,this.cHc)};e.prototype.U_b=function(Ma,Hb){if(Ma){Ma=Cl(Ma);for(var ic=Ma.next();!ic.done;ic=Ma.next())Hb[ic.value]=!0}};Ck.Object.defineProperties(e.prototype,{r1c:{configurable:!0,enumerable:!0,get:function(){return Af.a(this.bHc)}},s1c:{configurable:!0,enumerable:!0,get:function(){return Af.a(this.cHc)}},
Fef:{configurable:!0,enumerable:!0,get:function(){return!this.r1c.length&&!this.s1c.length}}});Object(ec.a)(e,"UpdatePresenceUsersActionParameters",null,[]);var bg=nb.a;Am(c,bg);c.prototype.pHg=function(Ma){this.addHandler("ekcrmrrg",Ma)};c.prototype.ydj=function(Ma){this.removeHandler("ekcrmrrg",Ma)};c.prototype.jZa=function(Ma){this.addHandler("ekcrmmcu",Ma)};c.prototype.Rbb=function(Ma){this.removeHandler("ekcrmmcu",Ma)};c.prototype.gGg=function(Ma){this.addHandler("LabelUpdateEventKey",Ma)};c.prototype.Dcj=
function(Ma){this.removeHandler("LabelUpdateEventKey",Ma)};c.prototype.lUa=function(Ma,Hb){this.$.ea.sc&&(Ub.ULS.sendTraceTag(537154119,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",Ma?Ma.join(","):"null",Hb?Hb.join(","):"null"),this.zTj.qHf(new e(Ma,Hb,null)))};c.prototype.dispose=function(){this.Hj&&(this.Hj.EIb(this.Wca),this.Hj.mAa(this.qCd));this.$&&(this.$.na.Dr(this.Th),this.$.ea.Kda(this.tI));this.Dn&&(this.Dn.ZJd(this.qEb),this.Dn.NQf(this.Awf));
this.$=this.Hj=this.m0a=this.MLa=null;bg.prototype.dispose.call(this)};c.prototype.xUd=function(Ma){this.Hj&&(this.Hj.EIb(this.Wca),this.Hj.mAa(this.qCd));this.Hj=Object(Yb.a)(271,Ma);this.Hj.lZa(this.Wca);Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&this.Hj.lGa(this.qCd);this.currentUserId=this.Hj.clientId};c.prototype.SNf=function(){for(var Ma=!this.Hj,Hb=Cl(this.$.ea.Qm),ic=Hb.next();!ic.done;ic=Hb.next())(ic=ic.value.User.UserID)&&ic!==this.currentUserId&&
!this.m0a.has(ic)&&this.pcc(ic).gTj(Ma)};c.prototype.n5h=function(Ma){if(rc.a.oVf in Ma&&rc.a.nVf in Ma&&rc.a.mVf in Ma){var Hb=Ma[rc.a.mVf];1!==Hb||rc.a.O7 in Ma&&rc.a.Quc in Ma||Ub.ULS.sendTraceTag(537154076,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",rc.a.O7 in Ma,rc.a.Quc in Ma);var ic=this.Iob(Ma);var Lc=ic.ANf;ic.returnValue||(Ma=new n(Ma[rc.a.oVf],Ma[rc.a.nVf],Hb,Lc,rc.a.Quc in Ma?Ma[rc.a.Quc]:
0),this.raiseEvent("ekcrmrrg",Ma,this))}else Ub.ULS.sendTraceTag(537154077,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};c.prototype.Iob=function(Ma){Ma=rc.a.O7 in Ma?Ma[rc.a.O7]:null;return{returnValue:this.$.ea.O7===Ma,ANf:Ma}};c.prototype.Ycg=function(){this.$.ea.Lna=Math.max(c.fOg,this.$.ea.Lna)};c.prototype.dSd=function(Ma){Ma=Cl(Ma);for(var Hb=Ma.next();!Hb.done;Hb=Ma.next())if(!this.$.ea.iid(Hb.value))return!0;return!1};c.prototype.H0c=function(){this.$.Zd(1562177611,
-1,0,null)};c.prototype.nPa=function(Ma){rc.a.Xqf in Ma&&rc.a.Yqf in Ma&&rc.a.Zqf in Ma&&(Ma=Object(dc.a)(new wf.a,{Pending:Ma[rc.a.Yqf],Current:Ma[rc.a.Xqf],SuspensionStartTimestamp:Ma[rc.a.Zqf]}),this.raiseEvent("ekcrmmcu",new $e.a(Ma),this))};c.prototype.pcc=function(Ma){Ma=this.YCe(Ma);if(!this.MLa[Ma]){var Hb=new m(Ma,this.currentUserId,4E4,this.$);this.MLa[Ma]=Hb}this.SWf();return Object(Yb.a)(m,this.MLa[Ma])};c.prototype.YCe=function(Ma){if(!Ma)return Ma;var Hb=Ma.toLocaleLowerCase();Hb.startsWith("{")||
(Hb="{"+Ma+"}");return Hb};c.prototype.SWf=function(){var Ma=this;this.lld||Cc.a.isEmpty(this.MLa)||!Fc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.lld=Fb.Task.delay(2E4).continueWith(function(){Ma.s8h()}))};c.prototype.s8h=function(){var Ma=[],Hb=pe.a.Ae(),ic=this.MLa,Lc;for(Lc in ic){var td=Lc,pd=Object(Yb.a)(m,ic[Lc]);pd.sCb(Hb);pd.Gff&&(pd.dispose(),Ma.push(td))}Ma=Cl(Ma);for(Hb=Ma.next();!Hb.done;Hb=Ma.next())Hb=Hb.value,delete this.MLa[Hb],
this.m0a.add(Hb);this.lld=null;this.SWf()};Ck.Object.defineProperties(c.prototype,{ukf:{configurable:!0,enumerable:!0,get:function(){return this.Uae}},Cjj:{configurable:!0,enumerable:!0,get:function(){return!!this.Hj&&2===this.Hj.connectionState}}});c.fOg=3E4;Object(ec.a)(c,"ContentRefreshManager",nb.a,[874]);var Zd=b(61);a.prototype.Cdd=function(Ma){return Ma+5E3};a.prototype.wEd=function(Ma){var Hb=this;return this.$.ea.sc?zb.TaskExtensions.ts(zb.TaskExtensions.ts(Fb.Task.delay(0),function(){var ic=
Hb.$.na.va,Lc=Ma.r1c,td=Ma.s1c,pd=Ma.At,Qe=ic.Na(1,null);Qe.clientIdsToAdd=Lc;Qe.clientIdsToRemove=td;return Qc.i(ic,"UpdatePresenceUsers",Qe,pd,null,null,null,0)},Ef.a.none,0,Zd.a.current),function(){return Fb.Task.delay(5E3)},Ef.a.none,0,Zd.a.current):Fb.Task.Ra(!0)};a.prototype.MWc=function(Ma,Hb){if(!Hb)return Ma;if(!Ma)return Ub.ULS.shipAssertTag(537154073,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),Hb;if(Hb.Fef)return Hb;
if(Ma.Fef)return Ma;Hb.BPj(Ma);return Hb};Object(ec.a)(a,"UpdatePresenceUsersActionAggregationPerformer",null,[869,870]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");pc.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");Type.registerNamespace("RealtimePresenceUI");bb.a.Fa(Wa.ka);(function(){bb.a.Fa(function(Ma){Fc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&db.ka(Ma);
var Hb=Ma.da;Hb.Ga(28,new gb(Ma));Hb.Ga(158,new C(Ma));bb.a.Fa(ac.ka);var ic=hb.GetServiceTaskFactory.create(Ma.da,158,Hb.la,1),Lc=hb.GetServiceTaskFactory.create(Ma.da,28,Hb.la,1);zb.TaskExtensions.Ba(zb.TaskExtensions.xe([ic,Lc],Hb.la),function(){var td=new Ob.a,pd=Hb.Aa(26);pd.IFe(Object(yd.a)(td,td.setResult,"setResult"));var Qe=new T(Ma,pd,ic.result,Lc.result,tb.a.dr(Va.a.instance.lc("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));he.a.getInstance(Ma.da).add(Qe);Hb.Ga(159,new ac);zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.create(Hb,
159,Hb.la,1),function(ff){var hf=new Ob.a;hf.setResult(Qe);new Fa(Object(dc.a)(new Gb.a,{clientId:Ma.workbookContext.ClientId}),td.task,hf.task,ff.result,Oc.a.instance,xb.AFrameworkApplication.ga.ra("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:xb.AFrameworkApplication.ga.Cd("AwayCoauthorThresholdMs",9E5),Object(yd.a)(xb.AFrameworkApplication.Ib,xb.AFrameworkApplication.Ib.processAction,"processAction"),ra.instance)},Hb.la)},Hb.la,3);Va.a.instance.register(865,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").Ic().Oc(function(){return Ma.ea});
Va.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");Va.a.instance.register(Na,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").Ic().Oc(function(){return new Na(Ma)});Va.a.instance.resolve("Common.IPeopleInfoProvider")})})();bb.a.Fa(Bd.a.ka);bb.a.Fa(function(Ma){var Hb=Ma.da,ic=hb.GetServiceTaskFactory.Ua(Ma.da,211,212,1);Hb.$a(25,function(Lc){zb.TaskExtensions.Ba(ic,function(td){Hb.Aa(231)||new v(td.result,Ma,Lc)},Hb.la,3)})});(function(){bb.a.Fa(function(Ma){zb.TaskExtensions.Ba(hb.GetServiceTaskFactory.Ua(Ma.da,
12,477,0),function(Hb){var ic=new t(Ma),Lc=Ma.da.Aa(291);ic=Hb.result.K3c(ic,ic,Lc,"collabService");var td=new x(Ma);Lc=Hb.result.K3c(td,td,Lc,"persisted");td=new a(Ma);Hb=Hb.result.K3c(td,td,null,"updatePresence");Ma.da.Ga(292,new c(Ma,Ma.da.Aa(26),ic,Lc,Hb));he.a.getInstance(Ma.da).add(new h(Ma));he.a.getInstance(Ma.da).add(ic);he.a.getInstance(Ma.da).add(Lc)},Ma.la)})})()},926:function(z,E,b){function a(){}b.r(E);b.d(E,"RtcUtils",function(){return a});z=b(0);var c=b(14),e=b(1012),f=b(41);a.E0c=
function(m,n){n=void 0===n?e.RealtimeChannel.Uwd:n;try{var w=f.c(m)}catch(h){throw m=String.format("Failed to JSON-serialize payload : {0}",h),c.ULS.sendTraceTag(18637072,500,10,m),Error.argument("payload",m);}if(w.length>n)throw m=String.format("Payload exceeds maximum length: {0} > {1}.",w.length,n),c.ULS.sendTraceTag(18637074,500,10,m),Error.argument("payload",m);return w};a.deserialize=function(m,n,w){if(!m)return null;if(Object.getType(m)!==String){var h=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",
n,Object.getType(m).getName(),w);c.ULS.sendTraceTag(18637075,500,10,h);return null}h=null;try{h=f.a(m)}catch(y){m=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",n,y,w),c.ULS.sendTraceTag(18637077,500,10,m)}return h};a.UOa=function(m){if(!m)return"";if("string"===typeof m)return m.toString();try{return f.c(m)}catch(n){return m.toString()}};a.Qzh=function(m){var n;var w=0;var h=n=null;if(!m)return{d$e:w,f$e:n,exception:h};try{var y=m.source;
y&&Object.getType(y)===String&&(h=y);var r=m.context;r&&(m=r,w=m.status?m.status:0,n=m.statusText?m.statusText:null)}catch(x){}return{d$e:w,f$e:n,exception:h}};Object(z.a)(a,"RtcUtils",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.cl.js.map/4f84e2be4c21620f8c54f27fae1e8e81/EwaDS.cl.js.map