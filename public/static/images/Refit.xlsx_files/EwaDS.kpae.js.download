(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1016:function(z,E,b){function a(fa,aa,na){this.cRb=null;this.XF={};this.URb=this.Bx=null;n.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=fa;this.w5d=a.m6c;this.x5d=a.borderStyleSolidLine;this.Sg=aa;this.Sa=na;B.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.sV=new c(this.$,this.Sg);this.cD=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);n.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(fa,aa){var na=this;this.OGb=this.ribbonCommandInfo=this.cellFormat=this.Tr=this.Cb=this.ha=null;this.qsc=!1;this.rJf=this.cMa=this.zJf=this.h9d=this.Lza=this.Sma=null;this.e1b=this.wua=this.yJf=0;this.borderStyle=this.u_a=this.borderColor=null;this.wB=!1;this.P5b=this.Gab=null;this.S0=function(){if(!na.wB||L.g(na.$).Gz)na.wB=!1,L.g(na.$).Gz=!1,na.wua=0,L.g(na.$).rg.No(y.a.k5),
1===na.$.Ka.BH()&&(L.g(na.$).bW(C.a.clone(na.zJf),na.yJf,na.$.qa?na.$.qa.sheetName:null,null,na.rJf.clone(),null,null,0,H.a.Lih,!0),L.g(na.$).MSa(!0)),na.Vv(),na.DYd(),na.wm(),na.qsc=!1,na.Sma=null,na.Lza=null,na.Tr&&(na.Tr.cancel(),na.Tr.dispose()),n.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ha){try{if(ha=na.qe(ha),L.g(na.$).Gz=!0,na.Sma={},na.Lza={},na.Gab=null,na.Epb(na.e1b),2===ha.yb){var ka=L.g(na.$).ha.Xn(ha.clientPoint,
ha.Mb,5,void 0,void 0,!1);ka&&(na.cMa=ka,na.P5b=ka,na.P8i())}}catch(xa){L.g(na.$).Gz=!1}return!0};this.Sh=function(ha){try{ha=na.qe(ha);var ka=L.g(na.$).ha.Xn(ha.clientPoint,ha.Mb,5,void 0,void 0,!1),xa=L.g(na.$).Ea.hs(ka);if(!na.OGb||xa&&(xa.vK!==na.OGb.vK||xa.uK!==na.OGb.uK))if(na.wB=!0,na.OGb=xa,ka){var va=new Q.Range(na.cMa.top,na.cMa.left,na.cMa.top,na.cMa.left,!0,!1);va.union(ka);va=L.g(na.$).ha.MWh(va);na.i1b(ka);na.sUf(na.Gab,va);if(na.bottomRightCorner(va.bottom,va.right))return n.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var Aa=new Q.Range(va.top,va.left,va.bottom+1,va.right+1,!0,!1),qa=L.g(na.$).naa("DrawBorderBehavior.OnPointerMove",[Aa]);if(na.Sma&&na.Lza)for(;qa.$$mn();){var wa=qa.$$cu(),Ta=wa.cell.getRange().toString();Ta in na.Sma&&1!==na.wua||(na.Sma[Ta]=wa,na.Lza[Ta]=wa.cell.$M())}na.Gab=Aa;na.P5b=va;L.g(na.$).bW([va],0,na.$.qa.sheetName,null,va.topLeft,null,null,0,H.a.Iih,!0);na.Sg.qea(L.g(na.$),-1690267012,
na.cellFormat,!0,null,[va])}return!0}catch(sb){return L.g(na.$).Gz=!1}};this.Pf=function(ha){ha=na.qe(ha);(ha=L.g(na.$).ha.Xn(ha.clientPoint,ha.Mb,5,void 0,void 0,!1))?na.wB&&(na.i1b(ha),na.cMa.union(ha),3===na.wua?na.Epb(0):na.Epb(na.e1b),L.g(na.$).bW([na.cMa],0,na.$.qa.sheetName,null,null,null,null,0,H.a.Jih,!0),na.Sg.formatCells(-1690267012,na.cellFormat,na.ribbonCommandInfo)):(3===na.wua?na.Epb(0):na.Epb(na.e1b),L.g(na.$).bW([na.P5b],0,na.$.qa.sheetName,null,null,null,null,0,H.a.Kih,!0),na.Sg.formatCells(-1690267012,
na.cellFormat,na.ribbonCommandInfo));na.wB=!1;na.DYd();na.Sma=null;na.Lza=null;return!0};this.onKeyDown=function(ha){ha=na.qe(ha);if(na.wB||Array.contains([17,16,18,20],ha.Ca.keyCode))return!0;na.S0();return!1};this.onKeyUp=function(ha){ha=na.qe(ha);if(ha.Ca.keyCode===A.a.UL&&na.wB)return na.wB=!1,na.sUf(na.Gab,na.P5b,!0),na.DYd(),!0;if(na.wB||ha.Ca.keyCode===A.a.H8||ha.Ca.keyCode===A.a.c2d||ha.Ca.keyCode===A.a.b2d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ha.Ca.keyCode)||ha.Ca.keyCode===
A.a.Hkg||ha.Ca.keyCode===A.a.Dkg||ha.Ca.keyCode===A.a.zkg)return!0;na.S0();return!1};this.n0=function(ha,ka){L.g(na.$).Gz&&!Array.contains(na.o9h,ka.Td.command)&&(n.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",ka.Td),na.S0())};this.$=fa;this.Sg=aa}function e(fa){fa.cPf()}function f(){this.iconName=this.title=this.key=null}function m(fa,aa,na,ha,ka,xa,va,Aa){this.gmg=fa;this.hmg=aa;this.fmg=na;this.aha=ha;this.xxg=ka;this.Gtg=xa;this.kkb=
va;this.Csg=Aa}b.r(E);z=b(0);var n=b(14),w=b(1023),h=b(933),y=b(5),r=b(79),x=b(54),t=b(227),u=b(35),B=b(1),v=b(15);m.AQg=function(){return new m("BorderStyleSolidLine",1913,1,"1","",1,8,0)};m.wQg=function(){return new m("BorderStyleDashedLine",1914,3,"1","5,3",1,8,0)};m.xQg=function(){return new m("BorderStyleDottedLine",1915,4,"1","1,1",1,8,0)};m.zQg=function(){return new m("BorderStyleMediumLine",1916,2,"2","",1,8,0)};m.BQg=function(){return new m("BorderStyleThickLine",1917,5,"3","",1,8,0)};m.yQg=
function(){return new m("BorderStyleDoubleLine",1918,6,"1","",2,8,3)};Ck.Object.defineProperties(m.prototype,{Zue:{configurable:!0,enumerable:!0,get:function(){return this.gmg}},c1b:{configurable:!0,enumerable:!0,get:function(){return this.hmg}},Yue:{configurable:!0,enumerable:!0,get:function(){return this.fmg}},width:{configurable:!0,enumerable:!0,get:function(){return this.aha}},SGj:{configurable:!0,enumerable:!0,get:function(){return this.xxg}},QFi:{configurable:!0,enumerable:!0,get:function(){return this.Gtg}},
lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.kkb}},gti:{configurable:!0,enumerable:!0,get:function(){return this.Csg}}});Object(z.a)(m,"BorderLineStyleProperties",null,[]);Object(z.a)(f,"BorderLineStyleProps",null,[]);e.prototype.getBorderLineStyleProps=function(){var fa=b(1016).BorderFormatManager.t_a,aa=Array(Object.keys(fa).length),na=0,ha;for(ha in fa){var ka=ha,xa=fa[ha];aa[na]=new f;aa[na].key=ka;ka=xa;aa[na].title=v.a.instance.fa(ka.c1b);aa[na].iconName=ka.Zue;na++}return aa};
Object(z.a)(e,"BorderMenuController",null,[687]);var C=b(276),A=b(86),M=b(179),T=b(13),R=b(109),Q=b(25),ea=b(47),Z=b(44),ca=b(213),I=b(10),H=b(107),L=b(21),U=b(33);c.prototype.cAg=function(fa){n.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=L.g(this.$).ha;this.Cb=L.g(this.$).Cb;this.ribbonCommandInfo=fa;this.zJf=C.a.clone(this.ha.ta.selectedRanges);this.yJf=this.ha.ta.sB;this.rJf=this.ha.ta.activeCell.clone();this.Cb&&this.Cb.Okd();this.Ev();
this.Ek()};c.prototype.dispose=function(){this.S0();this.OGb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.Epb=function(fa){var aa=b(1016).BorderFormatManager;this.cellFormat={};var na={};this.borderColor=this.borderColor||aa.m6c;var ha=t.a.xH(this.borderColor,!1);na.Color=[ha,ha,ha,ha];B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.u_a&&(na.ThemeBorderColor=[this.u_a,this.u_a,this.u_a,this.u_a],na.ColorTypeOption=1);ha=b(1016).BorderFormatManager.t_a;
this.borderStyle=this.borderStyle||aa.borderStyleSolidLine;aa=ha[this.borderStyle].Yue;na.LineStyle=[aa,aa,aa,aa];this.cellFormat.BorderFormat=na;this.cellFormat.ValidMembers=128;this.cellFormat.Border=fa};c.prototype.Ev=function(){for(var fa=Cl(L.g(this.$).An),aa=fa.next();!aa.done;aa=fa.next())M.a.instance.pa(T.a.pointerDown,aa.value.domElement,this.onPointerDown);R.KeyInputManager.instance.pa(T.a.Xb,document.documentElement,this.onKeyDown);R.KeyInputManager.instance.pa(T.a.Sd,document.documentElement,
this.onKeyUp)};c.prototype.P8i=function(){for(var fa=Cl(L.g(this.$).An),aa=fa.next();!aa.done;aa=fa.next())aa=aa.value,M.a.instance.pa(T.a.yh,aa.domElement,this.Sh),M.a.instance.pa(T.a.$d,aa.domElement,this.Pf);M.a.instance.pa(T.a.$d,document.documentElement,this.Pf);M.a.instance.pa(T.a.Iy,document.documentElement,this.Pf);this.qsc=!0};c.prototype.Vv=function(){try{for(var fa=Cl(L.g(this.$).An),aa=fa.next();!aa.done;aa=fa.next())M.a.instance.za(T.a.pointerDown,aa.value.domElement,this.onPointerDown);
R.KeyInputManager.instance.za(T.a.Xb,document.documentElement,this.onKeyDown);R.KeyInputManager.instance.za(T.a.Sd,document.documentElement,this.onKeyUp)}catch(na){L.g(this.$).Gz=!1,n.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",na)}};c.prototype.DYd=function(){if(this.qsc)try{this.qsc=!1;for(var fa=Cl(L.g(this.$).An),aa=fa.next();!aa.done;aa=fa.next()){var na=aa.value;M.a.instance.za(T.a.yh,na.domElement,this.Sh);M.a.instance.za(T.a.$d,
na.domElement,this.Pf)}M.a.instance.za(T.a.$d,document.documentElement,this.Pf);M.a.instance.za(T.a.Iy,document.documentElement,this.Pf)}catch(ha){L.g(this.$).Gz=!1,n.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ha)}};c.prototype.Ek=function(){this.$.xa.zg(this.S0);L.g(this.$).rc.sl(this.S0);L.g(this.$).rE(this.S0);this.$.Ka.dGa(this.n0)};c.prototype.wm=function(){this.$.xa.Vg(this.S0);L.g(this.$).rc.kl(this.S0);
L.g(this.$).aG(this.S0);this.$.Ka.RQa(this.n0)};c.prototype.sUf=function(fa,aa,na){na=void 0===na?!1:na;if(fa&&this.Sma&&this.Lza)for(fa=L.g(this.$).naa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[fa]);fa.$$mn();){var ha=fa.$$cu().cell.getRange();if(na||!aa.contains(ha)||1===this.wua){ha=ha.toString();var ka=u.a.Nc(this.Sma,ha);if(ka){var xa=u.a.Nc(this.Lza,ha);this.setBorders(ka,xa);delete this.Sma[ha];delete this.Lza[ha]}}}};c.prototype.setBorders=function(fa,aa){var na=fa.cell,ha=na.getRange();
na.Gsc();ha.right!==this.Gab.right&&(na=new Q.Range(ha.top,ha.left-1,ha.bottom,ha.left-1,!0,!1),L.g(this.$).Ea.hs(na).KQa(3));ha.bottom!==this.Gab.bottom&&(na=new Q.Range(ha.top-1,ha.left,ha.top-1,ha.right,!0,!1),L.g(this.$).Ea.hs(na).KQa(1));if(null===aa||void 0===aa?0:aa.Borders.length){var ka={};na=0;for(var xa=Array(4),va=Array(4),Aa=0;4>Aa;Aa++)xa[Aa]=1,va[Aa]=0;aa=Cl(aa.Borders);for(Aa=aa.next();!Aa.done;Aa=aa.next()){Aa=Aa.value;var qa=Aa.BorderPosition;xa[qa]=Aa.BorderLineStyle;var wa=new ca.a(Aa.Color.Red,
Aa.Color.Green,Aa.Color.Blue);va[qa]=wa.XX();na|=I.HelperMethods.Y3a(Aa.BorderPosition)}ka.LineStyle=xa;ka.Color=va;ka={BorderFormat:ka};ka.Border=na;this.Sg.Psj(fa,ka,ha)}};c.prototype.i1b=function(fa){var aa=this,na=new Q.Range(Math.max(1,fa.top-1),Math.max(1,fa.left-1),fa.bottom+1,fa.right+1,!1,!1);L.g(this.$).U5(na)||this.Tr&&this.Tr.yp||(this.Tr=ea.a.instance.create(function(){L.g(aa.$).eu(na,60,H.a.Gih)},40,Z.a.Hih))};c.prototype.bottomRightCorner=function(fa,aa){return 1048576<=fa||16384<=
aa?!0:!1};c.prototype.qe=function(fa){return U.a(this.$).qe(fa)};Ck.Object.defineProperties(c.prototype,{o9h:{configurable:!0,enumerable:!0,get:function(){return this.h9d||(this.h9d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(z.a)(c,"DrawBorderBehavior",null,[2]);b.d(E,"BorderFormatManager",function(){return a});a.prototype.i6e=function(fa,
aa){n.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",aa.command.toString());var na={},ha={};var ka=t.a.xH(this.Z3,!1);ha.Color=[ka,ka,ka,ka];this.cD&&this.Pta&&(ha.ThemeBorderColor=[this.Pta,this.Pta,this.Pta,this.Pta],ha.ColorTypeOption=1);fa=-600086683===aa.command?"OutsideBorders":fa[r.a.ld];ha.LineStyle=u.a.Nc(a.EIf,fa);ha.LineStyle?n.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",
fa):(ka=a.t_a[this.kIa].Yue,ha.LineStyle=[ka,ka,ka,ka],n.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.kIa));ka=u.a.fo(a.yPg,fa,0);n.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",fa,this.Z3);na.BorderFormat=ha;4!==ka&&8!==ka||!this.$.qa.displayRtl||(ka=4===ka?8:4);na.ValidMembers=128;na.Border=
ka;this.Sg.formatCells(-1690267012,na,aa);n.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",aa.command.toString());return!0};a.prototype.cjd=function(fa,aa,na){n.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",fa.toString(),this.Z3);if(this.cD){if((aa.SqmControlId||"").includes("ThemeColorPicker")){var ha=this.themesManager.getThemeColor(aa.Color);var ka=ha.themeIndex;var xa=ha.JBa;ha.returnValue?
(this.URb={},this.Pta.ThemeColorIndex=ka,this.Pta.ThemeColorRow=xa):this.URb=null}else this.URb=null;this.sV.u_a=this.Pta}this.w5d=-1803452024===fa?a.m6c:aa.Color;this.sV.borderColor=this.Z3;this.XLe(na);this.$.Bf();n.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",fa.toString(),this.Z3);return!0};a.prototype.P4h=function(fa){n.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var aa=this.Sa.Zp(),na=this.Sa.Pc();
aa.Dc.push(na);var ha=this.Sa.fB("StyleDashGallery",1,"Size120by20");na.buttons.push(ha);na=a.t_a;for(var ka in na){var xa=ka,va=na[ka],Aa=v.a.instance.fa(va.c1b);ha.Mt(xa,-2118943501,"QueryBorderStyle",va.c1b,xa,xa,void 0,void 0,Aa)}n.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");fa.MenuItems=aa.sC();n.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.r3h=function(fa,aa){n.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",
this.kIa);fa=fa[r.a.ld];if(a.opi(fa))this.x5d=fa,n.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.kIa);else return n.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",fa),!0;this.sV.borderStyle=this.kIa;this.XLe(aa);this.$.Bf();n.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.kIa);return!0};a.prototype.hjd=function(fa){n.ULS.sendTraceTag(537159552,
0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.hUc(fa,64,this.Z3,86,1);return!0};a.prototype.ijd=function(fa){n.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.hUc(fa,112,this.Z3,87,2);return!0};a.prototype.v6e=function(fa){n.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.hUc(fa,
112,"white",88,3);return!0};a.prototype.S4h=function(fa){this.wrj(this.APg,fa,fa.MenuItemId?fa.MenuItemId:a.borderStyleSolidLine)};a.prototype.wrj=function(fa,aa,na){na in fa?(fa=fa[na],n.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",na),this.yrj(aa,fa)):n.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",na)};a.prototype.c5h=function(fa,aa){var na=fa[r.a.ld];return"DrawBorder"===na?
this.hjd(aa):"DrawBorderGrid"===na?this.ijd(aa):"EraseBorder"===na?this.v6e(aa):this.i6e(fa,aa)};a.prototype.cPf=function(){this.cRb||this.CQg()};a.prototype.TKh=function(){return new e(this)};a.prototype.CQg=function(){this.cRb={};var fa=0,aa=a.t_a,na={},ha;for(ha in aa){na.gfa=aa[ha];var ka=na.gfa.Zue;v.a.instance.fa(na.gfa.c1b);var xa=function(va){return function(){return appChrome.buildBorderStyleIconNew(va.gfa.SGj,va.gfa.width,va.gfa.QFi,va.gfa.lineHeight,va.gfa.gti)}}(na);this.cRb[ka]=ka;this.ybb(ka,
xa);fa++;na={gfa:na.gfa}}};a.prototype.ybb=function(fa,aa){if(!(fa in this.XF)){var na={};aa=aa();na[fa]=aa;appChrome.api.registerIconProvider(function(){return na});this.XF[fa]=!0}return fa};a.prototype.yrj=function(fa,aa){fa.MenuItemId&&(fa[w.a.On]=fa.MenuItemId===this.kIa,fa[h.a.Icon]=aa)};a.prototype.hUc=function(fa,aa,na,ha,ka){n.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.tXg(fa,ka)?(n.ULS.sendTraceTag(537159518,
0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.sV.S0()):(L.g(this.$).Gz&&this.sV.S0(),x.a.current&&(ha=String.format(y.a.Uta,x.a.current.np(ha)),L.g(this.$).rg.No(ha)),this.sV.e1b=aa,this.sV.borderColor=na,L.g(this.$).Gz=!0,this.sV.cAg(fa),this.sV.wua=ka)};a.prototype.XLe=function(fa){if(fa)switch(this.sV.wua){case 2:this.ijd(fa);break;default:this.hjd(fa)}};a.prototype.tXg=function(fa,aa){return this.sV.wua===aa&&-236759591!==fa.command&&-2118943501!==
fa.command?!0:!1};a.opi=function(fa){return fa?fa in a.EIf||fa in a.t_a:!1};Ck.Object.defineProperties(a.prototype,{kIa:{configurable:!0,enumerable:!0,get:function(){return this.x5d}},Z3:{configurable:!0,enumerable:!0,get:function(){return this.w5d}},Pta:{configurable:!0,enumerable:!0,get:function(){return this.URb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.Bx||(this.Bx=this.$.da.Aa(422));return this.Bx}},APg:{configurable:!0,enumerable:!0,get:function(){this.cPf();return this.cRb}}});
Ck.Object.defineProperties(a,{t_a:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.D3d||(a.D3d=(fa.BorderStyleSolidLine=m.AQg(),fa.BorderStyleDashedLine=m.wQg(),fa.BorderStyleDottedLine=m.xQg(),fa.BorderStyleMediumLine=m.zQg(),fa.BorderStyleThickLine=m.BQg(),fa.BorderStyleDoubleLine=m.yQg(),fa))}},yPg:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.C3d||(a.C3d=(fa.NoBorder=0,fa.BottomBorder=1,fa.TopBorder=2,fa.LeftBorder=4,fa.RightBorder=8,fa.OutsideBorders=64,fa.AllBorders=
112,fa.ThickOutsideBorders=64,fa.InsideBorders=48,fa.InsideHorizontalBorders=16,fa.InsideVerticalBorders=32,fa.BottomDoubleBorder=1,fa.ThickBottomBorder=1,fa.TopBottomBorder=3,fa.TopThickBottomBorder=3,fa.TopDoubleBottomBorder=3,fa))}},EIf:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.Wee||(a.Wee=(fa.ThickOutsideBorders=[2,2,2,2],fa.BottomDoubleBorder=[1,6,1,1],fa.ThickBottomBorder=[1,2,1,1],fa.TopBottomBorder=a.ddh,fa.TopThickBottomBorder=[1,2,1,1],fa.TopDoubleBottomBorder=[1,
6,1,1],fa))}}});a.C3d=null;a.D3d=null;a.Wee=null;a.m6c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.ddh=[1,1,1,1];Object(z.a)(a,"BorderFormatManager",null,[656])},1045:function(z,E,b){function a(C,A,M){window.performance.measure(C,A,M);A=window.performance.getEntriesByName(C);A.length||y.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",C);return A[A.length-1]?A[A.length-1].duration:-1}function c(){if(r.a.Bpb){var C=a("OnContextMenuHandling",
"ContextMenuPerf.A","ContextMenuPerf.B"),A=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),M=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");y.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",C,A,M)}}function e(C,A){B.HelperMethods.sZc&&window.performance.mark(A)}function f(C){C=v.g(C).ha.ta;return C.Lg&&(C.ud.isRow||C.ud.ff)}function m(C){return C.Rb.fla(C.ha.ta.activeCell)}
function n(C,A,M,T,R){C=T.wk("ContextMenuHelper.FindFirstCellInViewportArea",C,A,M);try{for(C.$$rst();C.$$mn();){var Q=C.$$cu();if(Q&&w(Q,T,R))return Q.cell}}finally{C&&C.dispose()}return null}function w(C,A,M){var T=A.rtl,R=M.isChromeRtl;C=C.cell;return(M=v.g(M).fK(C))?(M=M.topLeft,T=M.x+=T===R?C.offsetWidth:0,R=M.y+=C.offsetHeight,A.view.visibleArea.contains(new t.a(T,R,0,0))):!1}function h(C,A){var M=C.mc(null);if((null===M||void 0===M?0:M.cell.Yj)&&w(M,C,A))return C.getCellBounds(M.cell);M=C.ha.ta.activeCell;
return(A=n(new u.Range(M.top,M.left,x.a.Ih,M.left,!1,!1),2,!0,C,A)||n(new u.Range(1,M.left,M.top,M.left,!1,!1),2,!1,C,A)||n(new u.Range(M.top,M.right,M.top,x.a.Qh,!1,!1),1,!0,C,A)||n(new u.Range(M.top,1,M.top,M.right,!1,!1),1,!1,C,A)||null)&&A.Yj?C.getCellBounds(A):Sys.UI.DomElement.getBounds(C.G5a.uc)}b.d(E,"i",function(){return"ContextMenuPerf.A"});b.d(E,"b",function(){return"ContextMenuPerf.B"});b.d(E,"d",function(){return"ContextMenuPerf.C1"});b.d(E,"a",function(){return"ContextMenuPerf.C2"});
b.d(E,"c",function(){return"ContextMenuPerf.D"});b.d(E,"e",function(){return h});b.d(E,"f",function(){return m});b.d(E,"g",function(){return f});b.d(E,"h",function(){return e});b.d(E,"j",function(){return c});var y=b(14),r=b(333),x=b(9),t=b(60),u=b(25),B=b(10),v=b(21)},1046:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.ANg="AutoFill";a.yjj="RowOperations";a.K_g="ColumnOperations";a.RWj="ViewModeRowOperations";
a.QWj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.Evj="ShapeStyle";a.ODh="FloatingObjectClipboard";a.GHf="PivotTableCopyDelete";a.IHf="PivotTableFieldListActions";a.hye="CellFloatie";a.Avj="ShapeFloatie";a.contextMenu="ContextMenu";a.C2h="GridContextMenu";a.jZi="PivotTableContextMenu";a.PDh="FloatingObjectContextMenu";a.wWg="CellRTEFloatie";a.J1f="ShapeRTEFloatie";Object(z.a)(a,"FloatieGroupIdentifiers",null,[])},1047:function(z,E,b){function a(x,t,u){var B=
r.call(this,t)||this;B.ZR=!1;B.nkc=!1;B.YNa=null;B._selectedRowListBox=null;B.Un=null;B.Jzf=function(v){return B.onItemClick(v)};B.NBd=function(v){h.g(v.Ca);B.raiseEvent(a.b5a);B.raiseEvent(a.jPd);return!0};B.onScroll=function(v){h.g(v);B.iHd();B.raiseEvent(a.b5a)};B.onBlur=function(v){h.g(v);B.iHd()};B.onPointerDown=function(){B.iHd();B.raiseEvent(a.b5a);B.raiseEvent(a.WPa);return!1};B.OEb=function(v){var C=v.Ca;if(C.button===Sys.UI.MouseButton.leftButton||C.button===Sys.UI.MouseButton.rightButton||
n.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&C.type.includes("touch"))B.Vk=B.Vac(C),B.onPointerDown(v);B.raiseEvent(a.Lsd);return!1};B.wb=x;B.ZBb=u;B.uBa(!0);return B}b.d(E,"a",function(){return a});z=b(0);var c=b(90),e=b(228),f=b(13),m=b(179);E=b(242);var n=b(1),w=b(12),h=b(72),y=b(21),r=E.a;Am(a,r);a.prototype.l$=function(x){this.get_events().addHandler(a.b5a,x)};a.prototype.Ida=function(x){this.get_events().removeHandler(a.b5a,x)};a.prototype.JZb=function(x){this.get_events().addHandler(a.Gld,
x)};a.prototype.ktc=function(x){this.get_events().removeHandler(a.Gld,x)};a.prototype.gob=function(x){this.get_events().addHandler(a.jPd,x)};a.prototype.CIb=function(x){this.get_events().removeHandler(a.jPd,x)};a.prototype.kZa=function(x){this.get_events().addHandler(a.WPa,x)};a.prototype.Ubb=function(x){this.get_events().removeHandler(a.WPa,x)};a.prototype.SVc=function(x){this.get_events().addHandler(a.Lsd,x)};a.prototype.hKd=function(x){this.get_events().removeHandler(a.Lsd,x)};a.prototype.dispose=
function(){this.j8(!1);this.uBa(!1);c.a.yc([this.YNa]);this.YNa=null;r.prototype.dispose.call(this)};a.prototype.Vac=function(x){return w.DOMElementExtensions.ifd(x.target,"tr",!0)};a.prototype.CB=function(x){if(x){if(!this.Vk){var t=this.Un;if(!t||!t.rows.length)return;this.Vk=t.rows[0];0<x?x--:x++}t=this.Vk;for(var u=0,B=Math.abs(x);u<B;u++)if(0>x){if(!t.previousSibling)break;t=t.previousSibling}else{if(!t.nextSibling)break;t=t.nextSibling}t&&(this.Vk=t)}};a.prototype.Knb=function(x,t){w.DOMElementExtensions.toggleCssClass(x,
this.ZBb.ListTableClassInTouch,t)};a.prototype.j8=function(x){var t=this.Un;t&&(x&&!this.nkc?(e.a.instance.pa(f.a.click,t,this.Jzf),e.a.instance.pa(f.a.jk,t,this.NBd),m.a.instance.pa(f.a.pointerDown,t,this.OEb),this.nkc=!0):this.nkc&&(e.a.instance.za(f.a.click,t,this.Jzf),e.a.instance.za(f.a.jk,t,this.NBd),m.a.instance.za(f.a.pointerDown,t,this.OEb),this.nkc=!1))};a.prototype.PBa=function(x){var t=null;x&&(t=w.DOMElementExtensions.Cj(x,this.ZBb.ListCellClass))&&t.classList.toggle(this.ZBb.ListCellSelectedClass);
return t};a.prototype.uBa=function(x){this.dg&&(x&&!this.ZR?(this.YNa=this.de.Wd(this.dg),this.YNa.ka("scroll",this.onScroll),this.YNa.ka("blur",this.onBlur),m.a.instance.pa(f.a.pointerDown,this.domElement,this.onPointerDown),this.ZR=!0):this.ZR&&(c.a.Ha(this.YNa),this.YNa=null,m.a.instance.za(f.a.pointerDown,this.domElement,this.onPointerDown),this.ZR=!1))};a.prototype.onItemClick=function(x){return this.NBd(x)};a.prototype.rvc=function(x){if(x){var t=x.offsetTop,u=this.dg.scrollTop;t<u?this.lXf(!0):
t+x.offsetHeight>u+this.dg.clientHeight&&this.lXf(!1)}};a.prototype.lXf=function(x){this.dg.scrollTop=x?this.Vk.offsetTop:this.Vk.offsetTop+this.Vk.offsetHeight-this.dg.clientHeight};a.prototype.iHd=function(){y.g(this.$).isEditing&&this.raiseEvent(a.Gld)};Ck.Object.defineProperties(a.prototype,{Vk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(x){this.PBa(this._selectedRowListBox);x?(this._selectedRowListBox=x,this.PBa(this._selectedRowListBox),this.rvc(x)):
this._selectedRowListBox=null}},W_:{configurable:!0,enumerable:!0,get:function(){return this.ZBb.ListCellClass}},rca:{configurable:!0,enumerable:!0,get:function(){return this.ZBb.ListTableClass}},kI:{configurable:!0,enumerable:!0,get:function(){return 8}},SCb:{configurable:!0,enumerable:!0,get:function(){return 5}},lkc:{configurable:!0,enumerable:!0,get:function(){return 24}},kkc:{configurable:!0,enumerable:!0,get:function(){return 35}},dg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.b5a="GotFocus";a.Gld="IgnoreBlur";a.jPd="SetCell";a.WPa="PointerDown";a.Lsd="ItemPointerDown";Object(z.a)(a,"ListBox",E.a,[692,2])},1114:function(z,E,b){function a(w,h){var y=n.call(this,h.textBox.domElement)||this;y.nYc=null;y.tHi=function(){y.nAd()};y.zxf=function(r,x){y.Ng(r,x)};y.Exf=function(r,x){y.gj(r,x)};y.wb=w;y.iJ=h;h.iZ&&(h.iZ.add(y),h.sl(y.Exf),h.To(y.zxf));return y}b.d(E,"a",function(){return a});z=b(0);var c=b(90);
E=b(88);var e=b(47),f=b(44),m=b(72),n=E.a;Am(a,n);a.prototype.dispose=function(){var w=this.iJ;if(null===w||void 0===w?0:w.iZ)w.iZ.remove(this),w.kl(this.Exf),w.Zn(this.zxf);c.a.Ha(this.nYc);this.iJ=null;n.prototype.dispose.call(this)};a.prototype.Wh=function(w,h){switch(h){case -1470715894:case -1231471547:this.VU(!1);break;default:if(this.NGd(w,h))return m.g(w),!0;a.dli(h)||this.VU(!1)}return!1};a.prototype.VU=function(){c.a.Ha(this.nYc);this.nYc=e.a.instance.create(this.tHi,10,f.a.nti)};a.prototype.gj=
function(){this.VU(!1)};a.dli=function(w){switch(w){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Ck.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.iJ}}});Object(z.a)(a,"ListAutoCompleteBehavior",E.a,[698,2])},1256:function(z,E,b){function a(r){var x=y.call(this,document.createElement("div"))||this;x.OIa=!1;x.PIa=!1;x.gua=!1;x.eua=!1;x.fua=!1;x.ZR=
!1;x.iJ=null;x.visible=void 0;x.Jnc=function(t,u){x.ot(t,u)};x.ULa=function(){x.Ya.textBox.tK=!0};x.eza=function(){x.kz(!0)};x.dvf=function(){x.Ya.textBox.focus()};x.Rh=function(){n.g(x.$).inRangePicker||(x.isListVisible=!1)};x.$=r;n.g(r)&&n.g(r).ha&&n.g(x.$).ha.FJ(x.Rh);x.$k=e.a.D5();x.O6a=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return x}b.d(E,"a",function(){return a});z=b(0);E=b(242);var c=b(5),e=b(37),f=b(1),m=b(10),n=b(21),w=b(33),h=
b(4),y=E.a;Am(a,y);a.prototype.get_visible=function(){return this.O6a?void 0!==this.visible?this.visible:this.visible=y.prototype.get_visible.call(this):y.prototype.get_visible.call(this)};a.prototype.set_visible=function(r){if(!this.O6a)return y.prototype.set_visible.call(this,r);if(this.visible===r)return r;this.visible=r;return y.prototype.set_visible.call(this,r)};a.prototype.ot=function(){this.fCa(!1);this.St.ot()};a.prototype.dispose=function(){this.$&&n.g(this.$)&&n.g(this.$).ha&&n.g(this.$).ha.tO(this.Rh);
this.$=null;y.prototype.dispose.call(this)};a.prototype.Wh=function(r,x,t){r=!1;if((this.p1a||(void 0===t?0:t))&&!this.kxa()&&this.get_visible()&&this.isListVisible)switch(this.$k&&this.XBc(x),x){case 1872288872:this.isListVisible=!1;r=!0;break;case -798660877:this.St.CB(1);r=!0;break;case 137938150:this.St.CB(-1);r=!0;break;case 2091832999:this.St.CB(this.kI-1);r=!0;break;case 742457698:this.St.CB(-(this.kI-1));r=!0;break;case 125627505:r=this.kz(!1);break;case 267796030:e.a.D5()&&(r=this.kz(!1))}return r};
a.prototype.fCa=function(r){if(this.isListVisible||r){var x=n.g(this.$);r=x.domElement;var t=this.iJ.textBox.domElement,u=w.a(this.$).Fi(t.offsetHeight),B=w.a(this.$).Fi(t.offsetTop),v=w.a(this.$).Fi(t.offsetWidth);t=w.a(this.$).Fi(t.offsetLeft);x=x.Fj;var C=h.AFrameworkApplication.sa&&h.AFrameworkApplication.sa.Pa.Ug,A=$get(this.$.Lb+c.a.s0a,this.$.domElement);C&&(A=document.getElementById("EditorContainer"));var M=new Sys.UI.Point(x?this.St.aac:0,x?this.BFh:a.Y2h);u=A.offsetTop+M.y+(e.a.qN(this.$)&&
x?0:u+B);this.$.Qba||(B=$get(c.a.HGa,this.$.domElement),u+=B&&!C?B.offsetHeight:0);B=this.domElement;B.style.top=m.HelperMethods.nc(u);t=A.offsetLeft+t+M.x;!e.a.qN(this.$)&&this.$.isChromeRtl?B.style.right=m.HelperMethods.nc(x?this.St.aac:r.offsetLeft+r.offsetWidth-t-v):B.style.left=m.HelperMethods.nc(t)}};a.prototype.oTa=function(r){this.St&&(r&&!this.ZR?(this.St.l$(this.dvf),this.St.JZb(this.ULa),this.St.gob(this.eza),this.ZR=!0):this.ZR&&(this.St.Ida(this.dvf),this.St.ktc(this.ULa),this.St.CIb(this.eza),
this.ZR=!1))};a.prototype.XBc=function(r){switch(r){case -798660877:case 137938150:case 2091832999:case 742457698:this.OIa=!0;break;case 125627505:this.gua=!0;break;case 267796030:e.a.D5()&&(this.eua=!0)}};Ck.Object.defineProperties(a.prototype,{kI:{configurable:!0,enumerable:!0,get:function(){return this.St.kI}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.St.isListVisible},set:function(r){this.St.isListVisible=r}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.iJ},
set:function(r){(this.iJ=r)&&this.iJ.g0d.add(this)}},BFh:{configurable:!0,enumerable:!0,get:function(){return e.a.qN(this.$)?-5:-40}}});a.aac=0;a.Y2h=1;Object(z.a)(a,"AutoCompleteControl",E.a,[660])},1257:function(z,E,b){function a(e,f,m,n){f=void 0===f?0:f;m=void 0===m?"":m;n=void 0===n?"":n;var w=c.call(this)||this;w.length=e;w.selectedIndex=f;w.iG=m;w.description=n;return w}b.d(E,"a",function(){return a});z=b(0);var c=Sys.EventArgs;Am(a,c);Object(z.a)(a,"ListEventArgs",Sys.EventArgs,[])},1258:function(z,
E,b){function a(B,v){B=u.call(this,B,v,new t.a(f.a.listItem,f.a.$Bb,f.a.eCb,f.a.fCb))||this;B.vdc=!1;B.Gq=null;B.emb=null;B.lWe=!1;B.visible=void 0;B.uBa(!0);B.lWe=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");B.O6a=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return B}b.d(E,"a",function(){return a});z=b(0);var c=b(14),e=b(24);E=b(1047);var f=b(983),m=b(5),n=b(79),w=b(37),h=b(12),y=b(1),r=b(115),x=b(21),t=b(1113),
u=E.a;Am(a,u);a.prototype.wya=function(){var B=460,v=x.g(this.$),C=v.domElement,A=this.MTa.style,M=this.dg.offsetTop+this.Vk.offsetHeight*this.Vk.sectionRowIndex-this.dg.scrollTop;A.width="auto";A.whiteSpace="nowrap";A.position=e.a.ohc?"relative":"absolute";var T=C.offsetLeft+C.offsetWidth-(this.domElement.offsetLeft+this.dg.offsetLeft+this.dg.offsetWidth+3);C=this.domElement.offsetLeft-3-(C.offsetLeft+this.aac);B=Math.min(this.MTa.offsetWidth,B,Math.max(T,C));h.DOMElementExtensions.Jr(this.MTa,B);
A.whiteSpace="";A.position="absolute";M+3>this.dg.offsetTop+this.dg.offsetHeight||M<this.dg.offsetTop||(B=this.dg.offsetLeft-3-this.MTa.offsetWidth,A=this.dg.offsetLeft+this.dg.offsetWidth+3,h.DOMElementExtensions.updatePosition(this.MTa,C>T!==v.rtl?B:A,M,!1))};a.prototype.CB=function(B){u.prototype.CB.call(this,B);this.wya()};a.prototype.ot=function(){this.wya()};a.prototype.osa=function(){var B=this.Un,v=this.dg,C=3===n.a.Vb||e.a.xp,A=C?this.SCb:this.kI;this.isListVisible=!0;v.style.height="auto";
this.PGa.set_visible(!0);this.Knb(B,C);this.Gq.length>A?(h.DOMElementExtensions.bJ(v,Math.floor(v.offsetHeight*A/this.Gq.length)),v.style.overflowY="auto"):(v.style.height="auto",v.style.overflowY="hidden");h.DOMElementExtensions.Jr(v,B.offsetWidth+(this.Gq.length>A?r.a.zu:0))};Ck.Object.defineProperties(a.prototype,{aac:{configurable:!0,enumerable:!0,get:function(){if(w.a.qN(this.$)){var B=document.getElementById(this.$.Lb+m.a.kWe);return!this.lWe||B?h.DOMElementExtensions.getBoundingClientRect(B).x:
0}B=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(m.a.hyd):document.getElementById(this.$.Lb+m.a.hyd+"-"+m.a.Zrf);c.ULS.shipAssertTag(537170323,0,!!B||this.$.rN,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return B?B.offsetWidth:0}},we:{configurable:!0,enumerable:!0,get:function(){return this.emb},set:function(B){this.emb=B}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.O6a?
void 0!==this.visible?this.visible&&0<this.Gq.length:(this.visible=h.DOMElementExtensions.isVisible(this.dg))&&0<this.Gq.length:h.DOMElementExtensions.isVisible(this.dg)&&0<this.Gq.length},set:function(B){this.O6a&&this.visible===B||(h.DOMElementExtensions.setVisible(this.dg,B),h.DOMElementExtensions.setVisible(this.MTa,B),this.O6a&&(this.visible=B));var v=x.g(this.$).view;B?this.vdc||(v.Ts(this.PGa.Jnc),this.vdc=!0):(Array.clear(this.Gq),this.vdc&&(v.Yq(this.PGa.Jnc),this.vdc=!1))}}});Object(z.a)(a,
"AutoCompleteListBox",E.a,[])},1305:function(z,E,b){function a(Ub,Ob,Yb,xb){var Sa=yd.call(this,Ub,"PopulateGridContextMenu",1247109494,-2064931494,a.L2h,!0,!1,a.pJb,Ob,Yb,!0,xb)||this;Sa.gBa=!1;Sa.rwa=!1;Sa.TZ=!1;Sa.refresh=!1;Sa.expandCollapse=!1;Sa.Sic=!1;Sa.cFe=!0;Sa.grid=sb.g(Ub);Sa.zlc=!0;Sa.ugc=wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(Sa.ugc){var Tb=ac.GetServiceTaskFactory.Ua(Sa.$.da,309,310,3),Cc=ac.GetServiceTaskFactory.create(Sa.$.da,
18,Sa.la,3);va.TaskExtensions.Ba(va.TaskExtensions.xe([Tb,Cc],Sa.la),function(){Sa.$.da.$a(268,function(Fb){Sa.e5a=new c(Ub,Tb.result,Cc.result,Fb)})},Sa.la,3)}return Sa}function c(Ub,Ob,Yb,xb){this.oXc=this.Xeb=this.Zeb=0;this.$=Ub;this.gridView=sb.g(this.$);this.namedSheetViewPublic=Ob;this.Sg=Yb;this.instantaneousSupportInformationManager=xb;this.cNa=Pa.a.$nd()}function e(Ub){this.ranges=null;this.ranges=Ub}function f(Ub,Ob,Yb,xb,Sa,Tb,Cc,Fb){this.$=Ob;this.Sa=Yb;this.Bl=xb;this.selectedRanges=
Sa;this.grid=Tb;this.Sy=Fb;this.Jba=Cc;this.ssa=y.a.all(Sa,function(hc){return hc.isRow});this.vha=y.a.all(Sa,function(hc){return hc.ff});this.HDb=y.a.all(Sa,function(hc){return!hc.isRow&&!hc.ff});Ob=Tb.Rb.Nhd(Sa);this.b5b=!!Ob;this.uSf=!!Ob&&Ob.hasActiveFilter;this.menuSection=Yb.Pc();Ub.Dc.push(this.menuSection);this.Kka=this.ssa||this.vha?this.menuSection:Yb.Pc();this.cua=this.ssa||this.vha?this.menuSection:Yb.Pc()}b.r(E);z=b(0);var m=b(14),n=b(288),w=b(93),h=b(39),y=b(276),r=b(610),x=b(4),t=b(83),
u=b(438),B=b(927),v=b(9),C=b(31),A=b(19),M=b(60),T=b(5),R=b(1E3),Q=b(1238),ea=b(1046),Z=b(15),ca=b(37);f.prototype.jdd=function(){this.zHh();this.dHh();var Ub=this.Sy.E7a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Sa.Bb(Ub?149:148))};f.prototype.EHh=function(){var Ub=0;this.b5b?this.Jba.Om(942362098)?Ub=this.Sy.Om(this.Bl,942362098,this.selectedRanges,this.grid)?161:169:this.uSf&&(Ub=this.Sy.Om(this.Bl,-1113896058,this.selectedRanges,this.grid)?177:181):this.Jba.Om(-1113896058)&&
(Ub=this.ssa?this.Sy.Om(this.Bl,-1113896058,this.selectedRanges,this.grid)?49:116:this.Sy.Om(this.Bl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Ub&&this.Kka.buttons.push(this.Sa.Bb(Ub))};f.prototype.AHh=function(){var Ub=0;this.b5b?this.Jba.Om(622604322)&&(Ub=this.grid.rtl?this.Sy.Om(this.Bl,622604322,this.selectedRanges,this.grid)?191:192:this.Sy.Om(this.Bl,622604322,this.selectedRanges,this.grid)?162:170):this.Jba.Om(1415868706)&&(Ub=ca.a.aAb()&&this.grid.rtl?this.vha?this.Sy.Om(this.Bl,
1415868706,this.selectedRanges,this.grid)?288:289:this.Sy.Om(this.Bl,1415868706,this.selectedRanges,this.grid)?290:291:this.vha?this.Sy.Om(this.Bl,1415868706,this.selectedRanges,this.grid)?50:117:this.Sy.Om(this.Bl,1415868706,this.selectedRanges,this.grid)?178:182);0!==Ub&&this.Kka.buttons.push(this.Sa.Bb(Ub))};f.prototype.yHh=function(){this.Jba.Om(1035996630)&&(this.Sy.Om(this.Bl,1035996630,this.selectedRanges,this.grid)?(this.Kka.buttons.push(this.Sa.Bb(this.grid.rtl?187:165)),this.Kka.buttons.push(this.Sa.Bb(166))):
(this.Kka.buttons.push(this.Sa.Bb(this.grid.rtl?188:173)),this.Kka.buttons.push(this.Sa.Bb(174))))};f.prototype.zHh=function(){var Ub=b(1305).GridContextMenu,Ob=null;this.HDb&&(Ob=this.Sa.zw("ContextMenu.InsertCells",null,Z.a.instance.fa(346),1896159024),Ob.menu.Dc.push(this.Kka));Ub.BHh(this.Kka,this.Sa,this.$);this.EHh();this.AHh();this.yHh();Ob&&0<this.Kka.buttons.length&&this.menuSection.buttons.push(Ob)};f.prototype.fHh=function(){var Ub=0;this.b5b?this.Jba.Om(1405456548)?Ub=this.Sy.Om(this.Bl,
1405456548,this.selectedRanges,this.grid)?163:171:this.uSf&&(Ub=this.Sy.Om(this.Bl,1554436520,this.selectedRanges,this.grid)?179:183):this.Jba.Om(1554436520)&&(Ub=this.ssa?this.Sy.Om(this.Bl,1554436520,this.selectedRanges,this.grid)?51:118:this.Sy.Om(this.Bl,1554436520,this.selectedRanges,this.grid)?179:183);0!==Ub&&this.cua.buttons.push(this.Sa.Bb(Ub))};f.prototype.eHh=function(){var Ub=0;this.b5b?this.Jba.Om(284490184)&&(Ub=this.Sy.Om(this.Bl,284490184,this.selectedRanges,this.grid)?164:172):this.Jba.Om(674605324)&&
(Ub=this.vha?this.Sy.Om(this.Bl,674605324,this.selectedRanges,this.grid)?52:119:this.Sy.Om(this.Bl,674605324,this.selectedRanges,this.grid)?180:184);0!==Ub&&this.cua.buttons.push(this.Sa.Bb(Ub))};f.prototype.cHh=function(){this.Jba.Om(1035996630)&&(this.Sy.Om(this.Bl,1035996630,this.selectedRanges,this.grid)?(this.cua.buttons.push(this.Sa.Bb(this.grid.rtl?189:167)),this.cua.buttons.push(this.Sa.Bb(168))):(this.cua.buttons.push(this.Sa.Bb(this.grid.rtl?190:175)),this.cua.buttons.push(this.Sa.Bb(176))))};
f.prototype.dHh=function(){var Ub=null;this.HDb&&(Ub=this.Sa.zw("ContextMenu.DeleteCells",null,Z.a.instance.fa(409),-1554384558),Ub.menu.Dc.push(this.cua));this.fHh();this.eHh();this.cHh();Ub&&0<this.cua.buttons.length&&this.menuSection.buttons.push(Ub)};Object(z.a)(f,"CellsContextMenuGenerator",null,[]);Object(z.a)(e,"MacroRecorderRangeHyperlinkRemovedPayload",null,[447]);var I=b(590),H=b(25),L=b(102),U=b(79),fa=b(75),aa=b(45),na=b(175),ha=b(84),ka=b(700),xa=b(150),va=b(36),Aa=b(616),qa=b(618),wa=
b(1),Ta=b(186),sb=b(21),db=b(389),kb=b(33),ac=b(51),ta=b(248),ra=b(22),Na=b(29),gb=b(1249),ob=b(1112),wb=b(131),Oa=b(561),sa=b(387),Fa=b(166),Wa=b(158),Db=b(357),pc=b(95),lc=b(30),eb=b(293),ib=b(292),cc=b(132),Pa=b(981),nc=b(982),pb=b(145),rb=b(41),Ya=b(55),ec;(function(Ub){Ub[Ub.none=0]="none";Ub[Ub.once=1]="once";Ub[Ub.twice=2]="twice"})(ec||(ec={}));Object(z.b)("ToggleState",ec);c.prototype.Chh=function(){var Ub=this.QV(),Ob={};Ub=(Ob.CommandValueId=rb.c(Ub),Ob);Ob=new pc.a(-2058042992,2,this.$.fd,
19,null);m.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.$b(Ob,Ub)};c.prototype.Shh=function(){var Ub=new pc.a(644342024,2,this.$.fd,19,null);m.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.$b(Ub)};c.prototype.Hhh=function(){var Ub=this.gridView.ha.ta.activeCell,Ob=this.$.da.Aa(66).Cg,Yb=this.$.da.Aa(66).qvb(Ub);return Ob||
Yb?this.Jhh(Ob,Yb,Ub):this.Ihh(Ub)};c.prototype.Jhh=function(Ub,Ob,Yb){if(this.iXg(Ub,Ob,Yb))return m.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Ya.Task.Ra(!1);if(null!=Ub&&Ub.hasAutoFilter||null!=Ob&&Ob.G_a.every(function(xb){return 0!=xb.length}))return this.Zeb=ec.none,this.mXc();this.Zeb=ec.once;return this.y7b(ec.once)};c.prototype.Ihh=function(Ub){var Ob=aa.v(this.gridView.ha.ta.ud,this.$);Ob=this.gridView.$.xa.getItemByName(Ob.SheetName);
var Yb=aa.D(Ob.j1);if(this.hXg(Yb,Ub))return m.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Ya.Task.Ra(!1);if(Ob.hasAutoFilter){if(Yb&&Yb.contains(this.gridView.ha.ta.activeCell))return this.Zeb=ec.none,this.mXc();this.Zeb=ec.twice;return this.y7b(ec.twice)}this.Zeb=ec.once;return this.y7b(ec.once)};c.prototype.y7b=function(Ub){function Ob(Fb){eb.a(Fb)?m.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",
lc.a.Xc(Fb.Errors)):(m.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Ub===ec.twice?xb.y7b(ec.once):xb.mXc())}function Yb(){return new gb.a(Sa)}var xb=this,Sa=aa.v(this.gridView.ha.ta.ud,this.$);if(!Sa)return Ya.Task.Ra(!1);this.Xeb||(this.Xeb=Date.now());var Tb=new pc.a(368460465,2,this.$.fd,19,null),Cc=this.$.na.va.hc();return wa.EwaSettings.qc()?sa.a(this.$.userOperationManager,function(Fb,hc,cd){return ha.kb(xb.$.na.va,Sa,ib.b(Fb,Ob),hc,cd,null,Cc)},
function(Fb){return new na.a(516,0,Fb,64,Yb)},Tb):sa.a(this.$.userOperationManager,function(Fb,hc,cd){return ha.kb(xb.$.na.va,Sa,ib.b(Fb,Ob),hc,cd,null,Cc)},function(Fb){return new Oa.a(516,0,Fb,void 0,Yb)},Tb)};c.prototype.iXg=function(Ub,Ob,Yb){return null!=Ub&&Fa.d(Ub)&&Yb.top===Ub.usedRange.top||null!=Ob&&Ob.yba&&Yb.top===Ob.top?(this.yrc(this.$,224),!0):null!=Ub&&Fa.g(Ub)&&Yb.top===Ub.usedRange.bottom?(this.yrc(this.$,225),!0):!1};c.prototype.hXg=function(Ub,Ob){if(Ub&&Ub.contains(Ob)&&Ob.top===
Ub.top||!Ub&&this.hWg(Ob.top,Ob.left))return this.yrc(this.$,226),!0;Ub=new H.Range(Ob.top,Ob.left,Ob.top+1,Ob.left+1,!1,!1);return this.gridView.Rb.s7a(Ub)?(this.yrc(this.$,227),!0):!1};c.prototype.yrc=function(Ub,Ob){Ob=lc.a.gd(1,1,748,Ob,0,147079615,"ContextMenuFilterByCellValueError");wa.EwaSettings.Kz()?new Db.a(Ub,Ob):(Ub=new Wa.ErrorDialog(Ub,Ob),Ub.initialize(),Ub.kf())};c.prototype.mXc=function(){function Ub(Fb){var hc={};hc=(hc.ToggleFilterOperationCount=Ob.Zeb,hc.ApplyFilterTime=Ob.oXc?
Date.now()-Ob.oXc:-1,hc.ToggleAndApplyFilterTime=Ob.Xeb?Date.now()-Ob.Xeb:-1,hc.FilterByValueType=xb.AutoFilterType,hc);m.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(hc));Ob.Xeb&&(Ob.Xeb=0);Pa.a.Rxc(Fb)&&(hc=Pa.a.Fac(Fb),Ob.cNa?Pa.a.XQa(nc.a.filterByCellValue,hc.MessageIdName,pb.a.Gsa,!0,Pa.a.isSessionEndingError(hc.MessageId)):m.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",
hc.MessageIdName));eb.a(Fb)?m.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",lc.a.Xc(Fb.Errors)):(m.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),cc.b(Ob.$).Vd(wb.a.Ayf,Ob.nm(),void 0,!0),Fb={},Fb.FirstRow=Ob.bQh(),Fb.FirstColumn=xb.Column,-1!==Fb.FirstRow&&(Fb=aa.C(Fb),Ob.QL(Fb)))}var Ob=this;this.oXc=Date.now();var Yb=this.d1h();if(!Yb)return m.ULS.sendTraceTag(527500296,0,50,
"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Ya.Task.Ra(!1);var xb=this.QV(),Sa={FirstRow:0};Sa.FirstColumn=xb.Column;Sa.SheetName=xb.SheetName;cc.b(this.$).Vd(wb.a.Tuf,this.nm(),void 0,!0);var Tb=this.R3c(xb,Sa),Cc=new na.a(208,0,function(Fb,hc,cd){return ha.a(Ob.$.na.va,Tb,Yb,ib.b(Fb,Ub),hc,cd,null,null)},6,function(){return new ob.a(Yb,Tb)});this.namedSheetViewPublic?this.namedSheetViewPublic.jBa().continueWith(function(Fb){Fb.result&&Ob.$.userOperationManager.ic(Cc,
null)}):this.$.userOperationManager.ic(Cc,null);return Ya.Task.Ra(!0)};c.prototype.QL=function(Ub){ca.a.$ba(this.$)&&va.TaskExtensions.Ba(ac.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(Ob){Ob.result.Oea(Ub);m.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)};c.prototype.nm=function(){var Ub={};return Ub.Location="contextMenu",Ub};c.prototype.QV=function(){var Ub=0,Ob=this.gridView.ha.ta.activeCell;
var Yb=this.$.da.Aa(66).Cg;var xb=this.$.da.Aa(66).qvb(Ob);if(Yb){var Sa="Table";Ub=Yb.objectId}else xb?(Sa="Table",Ub=xb.id):Sa="Sheet";Yb=Ob.left;Ob={};Ob.AutoFilterType=Sa;Ob.Column=Yb;Ob.Id=Ub;Sa={};this.$.Dj(Sa);Sa.FirstRow=0;Sa.FirstColumn=Ob.Column;Ub=this.$.ea.isNamedObjectViewMode;Ob.NamedObjectView=Ub;Ob.SheetName=Ub?Sa.NamedObjectName:Sa.SheetName;Ob.ItemListOptions=null;return Ob};c.prototype.hWg=function(Ub,Ob){Ub=H.Range.hd(Ub,Ob);return this.gridView.Ea.I$(Ub,this.$.qa.name)&&(Ub=this.gridView.Ea.z4a(Ub))&&
Ub.autoFilterMenu?!0:!1};c.prototype.d1h=function(){var Ub=null,Ob=this.gridView.mc(this.gridView.ha.ta.activeCell);if(!Ob)return null;var Yb=Ob.cell.tUd;var xb=this.instantaneousSupportInformationManager.rfb(Yb,!1).category;if(1===Ob.Ju.type)if(3===xb){if(!Ob.cell.M9a)return m.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",xb),null;Ub=(Ob.cell.M9a.Start+Ob.cell.M9a.End).trim()}else if(!xb&&(ra.a.V0a(Ob.Ju.value,"E")||ra.a.V0a(Ob.originalText,
"E"))){Ub=this.Sg.aWe(Ob.Ju.value,Yb,1,Number.POSITIVE_INFINITY,Ob.cell.oaa);if(!Ub.success)return m.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",xb),null;Ub=Ub.Bz}Ub||(Ub=Ob.originalText);return Na.a.N0c(Ub)?["[Blanks]"]:["i"+Ub.trim()]};c.prototype.bQh=function(){var Ub=this.gridView.ha.ta.activeCell,Ob=this.$.da.Aa(66).Cg,Yb=this.$.da.Aa(66).qvb(Ub);if(Ob)return Ob.usedRange.top;if(null!=Yb)return Yb.top;Ob=this.$.xa.getItemByName(this.$.qa.sheetName);
return(Ob=aa.D(Ob.j1))&&Ob.contains(Ub)?Ob.top:-1};c.prototype.R3c=function(Ub,Ob){var Yb={};Yb.Location=Ob;Yb.FieldId=Ub.Id.toString();Yb.DataSourceIndex=-1;Yb.FilterType=Ub.AutoFilterType;Yb.AnchorType=0;Yb.ChartId=null;Yb.AnchorValue1=-1;Yb.AnchorValue2=-1;Yb.Property=Ub.RichProperty;return Yb};Object(z.a)(c,"GridContextMenuFilter",null,[]);b.d(E,"GridContextMenu",function(){return a});var yd=B.a;Am(a,yd);a.prototype.dispose=function(){yd.prototype.dispose.call(this);this.grid=null};a.prototype.$c=
function(Ub,Ob){Ub=!this.lrd(Ub,Ob);if(!Ub)switch(Ob){case -1977666927:Ub=null==this.e5a||this.exj();break;case 1549396389:Ub=null==this.e5a||!this.Cgi();break;case 2045563128:case 1803952894:Ub=null==this.e5a||!this.$.isEditMode&&!this.Dgi()}return Ub};a.prototype.lrd=function(Ub,Ob){var Yb=this.grid.ha.ta.selectedRanges;return(new xa.a(this.$.xa)).Om(Ub,Ob,Yb,this.grid)};a.prototype.executeCommand=function(Ub,Ob,Yb){var xb=Ob.command;Ub=null;switch(xb){case -1396319072:if(Ob=this.grid.mc(null))n.a.instance.D_c(!0),
w.EventHandlerManager.instance.vcd(),a.EVi(Ob);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ta.selectedRanges,Ob);break;case 324156914:Ub=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Yb);break;case -1977666927:Ub=this.e5a.Chh();break;case 1549396389:Ub=this.e5a.Shh();break;case 1803952894:Ub=this.e5a.Hhh();break;default:Ub=Ta.a(xb)}return Ub||va.TaskExtensions.h5()};a.prototype.Kc=function(Ub,Ob,Yb){Ub=!1;switch(Ob.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Ub=
!0;break;case 1441131127:Ub=!!Yb}return Ub};a.prototype.DZ=function(Ub){Ub=void 0===Ub?!1:Ub;var Ob=!1,Yb=!1,xb=0;wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(xb=h.a.Ae());var Sa=this.Sa.Zp(this.menuId),Tb=this.grid.ha.ta,Cc=Tb.Lg,Fb=Cc&&Tb.ud.ff,hc=Cc&&Tb.ud.isRow;Tb=Tb.selectedRanges;var cd=y.a.all(Tb,function(ba){return ba.ff}),mb=y.a.all(Tb,function(ba){return ba.isRow}),$a=aa.O(Tb),K=aa.P(Tb);this.Hgf(Fb,hc)?(Ob=!0,this.gIh(Sa)):this.$.isEditMode?
db.a(this.$)?this.hIh(Sa,Fb,hc):(this.gHh(Sa,!(hc||Fb||!this.Sic)),this.CHh(Sa,Tb,Ub),this.sHh(Sa,cd,mb,$a,K),this.pXe(Sa,Cc,Fb,hc),this.zIh(Sa),this.UWe(Sa,Fb,hc),this.YHh(Sa,Cc,Fb,hc,Tb),this.jHh(Sa),this.hHh(Sa,Tb),this.JHh(Sa),this.uIh(Sa,Cc),wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.wHh(Sa)):(Yb=!0,db.a(this.$)?this.jXe(Sa):this.PIh(Sa,Cc,Fb,hc,Tb));wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ub=
h.a.Ae()-xb,m.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",Ub,Ob,Yb,this.cFe));this.cFe=!1;return Sa};a.prototype.FKa=function(Ub){var Ob=[];if(db.a(this.$))return Ob;if(3===Ub){Ub=this.grid.ha.ta;var Yb=Ub.Lg,xb=Yb&&Ub.ud.ff,Sa=Yb&&Ub.ud.isRow,Tb=!1,Cc=!1,Fb=!1;this.$.isMobileMode&&(Cc=Ub.selectedRanges,Tb=aa.O(Cc),Cc=aa.P(Cc));if(Yb){var hc=sb.e(this.grid);hc&&hc.range.contains(Ub.ud)&&this.nW(hc)&&
(Fb=!0)}this.$.isEditMode?this.Hgf(xb,Sa)?Array.addRange(Ob,[ea.a.GHf,ea.a.IHf]):xb||Sa?(Ob.push(ea.a.clipboard),Sa?Ob.push(ea.a.yjj):xb&&Ob.push(ea.a.K_g)):(Array.addRange(Ob,[ea.a.edit,ea.a.clipboard]),Fb?Ob.push(ea.a.hyperlink):Ob.push(ea.a.color),Yb&&Ob.push(ea.a.ANg)):(Ob.push(ea.a.copy),Fb&&Ob.push(ea.a.openHyperlink),!Sa||this.$.isMobileMode&&Cc?!xb||this.$.isMobileMode&&Tb||Ob.push(ea.a.QWj):Ob.push(ea.a.RWj));Ob.push(ea.a.C2h)}else 2===Ub&&Ob.push(ea.a.hye);return Ob};a.prototype.Hgf=function(Ub,
Ob){return(this.gBa||this.rwa||this.TZ||this.refresh||this.expandCollapse)&&!(Ub||Ob)};a.prototype.showGridContextMenu=function(Ub){this.expandCollapse=this.refresh=this.TZ=this.rwa=this.gBa=!1;var Ob=this.$,Yb=Aa.a(Ob).TKa(),xb=this.grid.ha.ta,Sa=xb.Lg,Tb=Sa&&xb.ud.ff;xb=Sa&&xb.ud.isRow;if(Yb&&!Tb&&!xb){Tb=qa.a(Ob);if(null===Tb||void 0===Tb?0:Tb.LRd)this.gBa=Tb=L.f(Ob.kg),this.rwa=!Tb;Tb=Ob.wc;this.TZ=Yb.supportsBIExplore&&!!R.a(Ob)&&Tb.o3(32768);Tb.allowInteractivity&&(Ob=this.grid.mc(null),(null===
Ob||void 0===Ob?0:Ob.cell)&&(Ob.cell.s_c||Ob.cell.p3f)&&(this.expandCollapse=!0),Tb.allowManualDataRefresh&&(this.refresh=!0))}Ob=null;Yb=1;Tb=Object(t.a)(r.a,Ub.eventArgs);Ub=Object(t.a)(Q.a,Ub.creationParams);xb=this.dNh();Ub?(Ob=Ub.clientPoint,Yb=Ub.inputMethod):Tb&&1!==Tb.yb?(Ob=new Sys.UI.Point(Tb.clientPoint.x,Tb.clientPoint.y),Yb=Tb.yb):xb&&(Ob=new Sys.UI.Point(xb.x+(this.$.isChromeRtl?0:xb.width),xb.y+xb.height));U.a.Vb=Yb;this.Sic=3===Yb;Ub=C.a.Wtb;this.Jp(Ob,!Tb||Tb.Ca.target.className!==
Ub,Yb)};a.prototype.removeHyperlinksFromRange=function(Ub,Ob){var Yb=this;if(!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Dq(Ub,!0)){var xb=aa.r(Ub,this.$),Sa=this.$.na.va.hc();this.$.userOperationManager.ic(new na.a(125,0,function(Tb,Cc,Fb){Yb.$.Oy();return ha.c(Yb.$.na.va,xb,"","",!0,!1,127,Tb,Cc,Fb,null,Sa)},void 0,function(){return new e(xb)}),Ob);this.grid.rg.iH(!1)}};a.prototype.dNh=function(){var Ub=this.grid.mc(null);
if((null===Ub||void 0===Ub?0:Ub.cell.Yj)&&this.Mff(Ub))return this.grid.getCellBounds(Ub.cell);Ub=this.grid.ha.ta.activeCell;return(Ub=this.p$b(new H.Range(Ub.top,Ub.left,v.a.Ih,Ub.left,!1,!1),2,!0)||this.p$b(new H.Range(1,Ub.left,Ub.top,Ub.left,!1,!1),2,!1)||this.p$b(new H.Range(Ub.top,Ub.right,Ub.top,v.a.Qh,!1,!1),1,!0)||this.p$b(new H.Range(Ub.top,1,Ub.top,Ub.right,!1,!1),1,!1)||null)&&Ub.Yj?this.grid.getCellBounds(Ub):Sys.UI.DomElement.getBounds(this.grid.G5a.uc)};a.prototype.Mff=function(Ub){var Ob=
this.grid.rtl,Yb=this.$.isChromeRtl;Ub=Ub.cell;var xb=sb.g(this.$).fK(Ub);return xb?(xb=xb.topLeft,Ob=xb.x+=Ob===Yb?Ub.offsetWidth:0,Yb=xb.y+=Ub.offsetHeight,this.grid.view.visibleArea.contains(new M.a(Ob,Yb,0,0))):!1};a.prototype.p$b=function(Ub,Ob,Yb){Ub=this.grid.wk("GridContextMenu.FindFirstCellInViewportArea",Ub,Ob,Yb);try{for(Ub.$$rst();Ub.$$mn();){var xb=Ub.$$cu();if(xb&&this.Mff(xb))return xb.cell}}finally{Ub&&Ub.dispose()}return null};a.prototype.gIh=function(Ub){var Ob=this.Sa,Yb=Ob.Pc();
this.refresh&&Yb.buttons.push(Ob.Bb(100));this.TZ&&Yb.buttons.push(Ob.Bb(99));this.gBa?Yb.buttons.push(Ob.Bb(59)):this.rwa&&Yb.buttons.push(Ob.Bb(58));if(this.expandCollapse){var xb=Ob.zw("ContextMenu.PivotExpandCollapse",null,Z.a.instance.fa(1130),589118293);var Sa=Ob.Pc();Sa.buttons.push(Ob.Bb(243));Sa.buttons.push(Ob.Bb(244));Sa.buttons.push(Ob.Bb(245));Sa.buttons.push(Ob.Bb(246));xb.menu.Dc.push(Sa);xb&&0<Sa.buttons.length&&Yb.buttons.push(xb)}Ub.Dc.push(Yb)};a.prototype.pXe=function(Ub,Ob,Yb,
xb){if(Ob&&!Yb&&!xb){Ob=this.Sa.Pc();this.ugc&&!this.$.rN&&this.pdd(Ob);this.wdd(Ob);this.DIh(Ob);if(wa.EwaSettings.ma(485)&&sb.g(this.$).ha.ta.wK()&&sb.g(this.$).ha.ta.L_)switch(wa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Ob.buttons.push(this.Sa.Bb(237));break;case 2:Ob.buttons.push(this.Sa.Bb(238));break;default:Ob.buttons.push(this.Sa.Bb(236))}Ub.Dc.push(Ob)}};a.prototype.wdd=function(Ub){if(!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||
this.$.wc.allowSorting)if(!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new xa.a(this.$.xa)).ke(2048)){var Ob=this.Sa.Pc();Ob.buttons.push(this.Sa.Bb(223));Ob.buttons.push(this.Sa.Bb(224));this.$.isMobileMode||Ob.buttons.push(this.Sa.Bb(225));var Yb=this.Sa.zw("ContextMenu.sort",null,Z.a.instance.fa(228),-864298118);Yb.menu.Dc.push(Ob);Ub.buttons.push(Yb)}};a.prototype.pdd=function(Ub){var Ob=this.Sa.zw("ContextMenu.filter",null,
Z.a.instance.fa(1920),2045563128),Yb=this.Sa.Pc(),xb=this.ERh(),Sa=this.Sa.Bb(234);Sa.label=xb;Yb.buttons.push(Sa);Yb.buttons.push(this.Sa.Bb(235));xb=this.Sa.Pc();xb.buttons.push(this.Sa.Bb(233));Ob.menu.Dc.push(Yb);Ob.menu.Dc.push(xb);Ub.buttons.push(Ob)};a.prototype.DIh=function(Ub){if(sb.g(this.$).ha.ta.wK()){var Ob=this.Sa.Pc();Ob.buttons.push(this.Sa.Bb(232));wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Ob.buttons.push(this.Sa.Bb(285)),Ob.buttons.push(this.Sa.Bb(286)));
var Yb=this.Sa.zw("ContextMenu.table",null,Z.a.instance.fa(1919),-697806646);Yb.menu.Dc.push(Ob);Ub.buttons.push(Yb)}};a.prototype.eXe=function(Ub,Ob,Yb,xb,Sa){if(Ob){var Tb=aa.K(Sa),Cc=sb.e(this.grid);if(Cc&&!Yb&&!xb){Yb=new xa.a(this.$.xa);if(Cc.range.contains(Tb)&&this.nW(Cc)){(Ob=!Cc.RMa&&!Yb.tj)&&this.$.isEditMode&&Ub.buttons.push(this.Sa.Bb(45));Cc.wba&&Ub.buttons.push(this.Sa.Bb(53));Ob&&this.$.isEditMode&&Ub.buttons.push(this.Sa.Bb(47));return}!Cc.RMa&&this.$.isEditMode&&(Cc=Yb.ke(128),Ub.buttons.push(this.Sa.Bb(Cc?
46:121)))}}this.x5i(Sa)&&Ub.buttons.push(this.Sa.Bb(48));(Cc=this.$.xa.qa)&&Cc.Yd&&(Cc=Cc.Yd.ty||Cc.Yd.CK,!Ob||this.$.rN||!wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||Cc||(Ob=aa.K(Sa),this.w5i(Ob)?Ub.buttons.push(this.Sa.Bb(276)):Ob.ff||Ob.isRow||Ub.buttons.push(this.Sa.Bb(275))))};a.prototype.x5i=function(Ub){Ub=Cl(Ub);for(var Ob=Ub.next();!Ob.done;Ob=Ub.next()){Ob=this.grid.getRangeInformation(Ob.value);
for(var Yb=0;Yb<Ob.length;Yb++)if(Object(u.a)(I.HyperlinkRange,Ob[Yb])){var xb=this.grid.mc(Ob[Yb]);if(xb&&this.nW(xb)&&!xb.RMa)return!0}}return!1};a.prototype.w5i=function(Ub){if(sb.g(this.$).ha.ta.wK()){var Ob=sb.g(this.$).Rb.Qj(Ub);if(Ob&&Ob.usedRange.equals(Ub))return!0}return!1};a.prototype.UWe=function(Ub,Ob,Yb){var xb,Sa;if(1===sb.g(this.$).ha.Ue&&!Ob&&!Yb){Ob=db.a(this.$);Yb=this.Sa;var Tb=Yb.Pc(),Cc=this.$.da.Aa(65);(null===(xb=null===Cc||void 0===Cc?void 0:Cc.Sm)||void 0===xb?0:xb.oF)&&
!Ob&&Tb.buttons.push(Yb.Bb(227));Cc&&Cc.isCommentOperationEnabled(3)&&Tb.buttons.push(Yb.Bb(221));(null===(Sa=null===Cc||void 0===Cc?void 0:Cc.Sm)||void 0===Sa?0:Sa.jkd)&&!Ob&&Tb.buttons.push(Yb.Bb(228));(null===Cc||void 0===Cc?0:Cc.hasCommentAtActiveCell)?Cc.xC.isResolved||Tb.buttons.push(Yb.Bb(159)):Cc&&Cc.hasCommentAtActiveCell||(Cc&&Cc.Sm&&Cc.Sm.oF?Ob||(Tb.buttons.push(Yb.Bb(229)),Tb.buttons.push(Yb.Bb(230))):(Tb.buttons.push(Yb.Bb(160)),Ob||Tb.buttons.push(Yb.Bb(226))));Ub.Dc.push(Tb)}};a.prototype.zIh=
function(Ub){if(wa.EwaSettings.ma(135)){var Ob=this.Sa,Yb=Ob.Pc();Yb.buttons.push(Ob.Bb(250));Ub.Dc.push(Yb)}};a.prototype.CHh=function(Ub,Ob,Yb){if(!Yb){Yb=this.$.Ka.BH();var xb=new xa.a(this.$.xa),Sa=new ka.a(Yb,Ob,this.grid);(new f(Ub,this.$,this.Sa,Yb,Ob,this.grid,Sa,xb)).jdd()}};a.prototype.sHh=function(Ub,Ob,Yb,xb,Sa){var Tb=(new xa.a(this.$.xa)).ke(8),Cc=this.Sa,Fb=Cc.Pc();Ob&&Fb.buttons.push(Cc.Bb(Tb?152:153));Yb&&Fb.buttons.push(Cc.Bb(Tb?150:151));Ob&&(xb||Fb.buttons.push(Cc.Bb(Tb?109:155)),
Fb.buttons.push(Cc.Bb(Tb?111:157)));Yb&&(Sa||Fb.buttons.push(Cc.Bb(Tb?108:154)),Fb.buttons.push(Cc.Bb(Tb?110:156)));Ub.Dc.push(Fb)};a.prototype.gHh=function(Ub,Ob){var Yb=this.Sa,xb=Yb.Pc();Ub.Dc.push(xb);Ob&&xb.buttons.push(Yb.Bb(102));xb.buttons.push(Yb.Bb(42));xb.buttons.push(Yb.Bb(43));Ob=this.dIh(Yb);Ub.Dc.push(Ob)};a.prototype.dIh=function(Ub){var Ob=Ub.Pc();Ob.title=Z.a.instance.fa(1110);Ob.n5f=!1;Ob.m5f=!1;Ob.u$f=!1;var Yb=5,xb=ca.a.Dsd(this.$);xb&&(Yb=6);Ub=Ub.fB("PasteOptionsGallery",Yb,
"Size24by24",Ob.title);Ob.buttons.push(Ub);Ub.Mt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1111,void 0,"Paste_24",1,A.a.Fuh);Ub.Mt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1112,void 0,"PasteValues_24",1,A.a.Kuh);Ub.Mt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1113,void 0,"PasteFormulas_24",1,A.a.Huh);Ub.Mt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",
1114,void 0,"PasteTranspose_24",1,A.a.Juh);Ub.Mt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1115,void 0,"PasteFormatting_24",1,A.a.Guh);xb&&Ub.Mt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1116,void 0,"PasteLink_24",1,A.a.Iuh);return Ob};a.prototype.PIh=function(Ub,Ob,Yb,xb,Sa){var Tb,Cc=this.Sa,Fb=Cc.Pc();Fb.buttons.push(Cc.Bb(43));Ub.Dc.push(Fb);this.ugc&&!this.$.rN&&(Fb=this.Sa.Pc(),this.pdd(Fb),Ub.Dc.push(Fb));wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",
!1)&&this.$.ea.wc.isMobileMode&&this.$.ea.wc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(Fb=this.Sa.Pc(),this.wdd(Fb),Ub.Dc.push(Fb),m.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Fb=this.$.da.Aa(65);if(null===(Tb=null===Fb||void 0===Fb?void 0:Fb.Sm)||void 0===Tb?0:Tb.oF)Tb=this.Sa.Pc(),Tb.buttons.push(Cc.Bb(229)),Ub.Dc.push(Tb);Tb=this.Sa.Pc();this.eXe(Tb,
Ob,Yb,xb,Sa);Ub.Dc.push(Tb);x.AFrameworkApplication.isMobileMode&&!fa.a(this.$.ya,30)&&(Ob=Cc.Pc(),Ob.buttons.push(Cc.Bb(272)),Ub.Dc.push(Ob))};a.prototype.YHh=function(Ub,Ob,Yb,xb,Sa){var Tb=this.Sa.Pc();this.ZHh(Tb);this.eXe(Tb,Ob,Yb,xb,Sa);0<Tb.buttons.length&&Ub.Dc.push(Tb)};a.prototype.ZHh=function(Ub){Ub.buttons.push(this.Sa.Bb(135))};a.prototype.wHh=function(Ub){var Ob=this.Sa.Pc();Ob.buttons.push(this.Sa.Bb(185));Ub.Dc.push(Ob)};a.prototype.uIh=function(Ub,Ob){wa.EwaSettings.ma(486)&&Ob&&
(Ob=this.Sa.Pc(),Ob.buttons.push(this.Sa.Bb(262)),Ub.Dc.push(Ob))};a.prototype.JHh=function(Ub){var Ob=this.grid.ha.ta.selectedRanges;if(Ob&&Ob.length){for(var Yb=!1,xb=0;xb<Ob.length;xb++)if(this.grid.Rb.hNa(Ob[xb])){Yb=!0;break}if(Yb){var Sa=this.Sa;Yb=Sa.Pc();xb=Sa.Pc();for(var Tb=1===Ob.length&&(Ob[0].isSingle||this.grid.Rb.CAb(Ob[0])),Cc=!1,Fb=!1,hc=!1,cd=!1,mb=0;mb<Ob.length&&!(Cc&&hc&&Fb&&cd);mb++)!Cc&&this.grid.Rb.hli(Ob[mb])&&(Cc=!0),!hc&&this.grid.Rb.Eff(Ob[mb],!1)&&(hc=!0),!Fb&&this.grid.Rb.crd(Ob[mb])&&
(Fb=!0),!cd&&this.grid.Rb.Fgi(Ob[mb])&&(cd=!0);wa.EwaSettings.ma(105)&&Tb&&!this.grid.Rb.Xfc(Ob[0])&&(cd?Yb.buttons.push(Sa.Bb(217)):Yb.buttons.push(Sa.Bb(216)));cd=Cc;cd=!(new xa.a(this.$.xa)).tj&&cd;hc&&(wa.EwaSettings.ma(131)&&L.l(this.$.kg)&&(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?xb.buttons.push(Sa.Bb(220)):xb.buttons.push(Sa.Bb(cd?220:271))),Fb&&xb.buttons.push(Sa.Bb(cd?
218:269)),Tb&&(this.grid.Rb.crd(Ob[0])||this.grid.Rb.Xfc(Ob[0]))&&xb.buttons.push(Sa.Bb(cd?219:270))),xb.buttons.push(Sa.Bb(cd?215:268)));0<xb.buttons.length&&(Ob=Sa.zw(Cc?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,Z.a.instance.fa(1743),798637440),Ob.menu.Dc.push(xb),Yb.buttons.push(Ob));0<Yb.buttons.length&&Ub.Dc.push(Yb)}}};a.prototype.hHh=function(Ub,Ob){this.grid.Rb.$df(Ob)&&(Ob=this.Sa.Pc(),this.grid.ha.ta.dca()?(Ob.buttons.push(this.Sa.Bb(241)),
Ob.buttons.push(this.Sa.Bb(239))):Ob.buttons.push(this.Sa.Bb(240)),Ub.Dc.push(Ob))};a.prototype.nW=function(Ub){return Ub.cell.hasHyperlink};a.prototype.jXe=function(Ub){this.iIh(Ub);var Ob=this.Sa.Pc();this.wdd(Ob);Ub.Dc.push(Ob);this.ugc&&(Ob=this.Sa.Pc(),this.pdd(Ob),Ub.Dc.push(Ob))};a.prototype.hIh=function(Ub,Ob,Yb){this.jXe(Ub);this.UWe(Ub,Ob,Yb)};a.prototype.iIh=function(Ub){if(this.grid.ha.ta.Lg&&!this.grid.rb.dj){var Ob=this.Sa,Yb=Ob.Pc();kb.a(this.$).pSd()?Yb.buttons.push(Ob.Bb(265)):Yb.buttons.push(Ob.Bb(264));
Ub.Dc.push(Yb)}};a.EVi=function(Ub){var Ob=Ub.LKa(a.zld);Ob&&Ob.und&a.zld&&Ub.invoke(a.zld,null)};a.BHh=function(Ub,Ob,Yb){if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(Yb=Yb.da.Aa(254),!Yb){m.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(Yb=Yb.da.Aa(254,!0),!Yb)return;Yb.Tpd()&&Yb.Akf()&&Ub.buttons.push(Ob.Bb(212));Yb.Tpd()&&Yb.Ljc()&&
Ub.buttons.push(Ob.Bb(213))};a.prototype.exj=function(){var Ub=this.$.da.Aa(66).Cg,Ob=this.grid.ha.ta.activeCell;return null!=Ub&&!Ub.hasActiveFilter||ta.c(this.$,Ob)||!this.Egi(Ob)};a.prototype.Egi=function(Ub){var Ob=Ub.left,Yb=this.Pcc();if(null!=Yb&&null!=Yb.g$b&&Array.contains(Yb.g$b,Ob-1))return!0;Yb=this.Hcc();return null!=Yb&&aa.D(Yb).contains(Ub)&&null!=Yb.FilteredColumns&&Array.contains(Yb.FilteredColumns,Ob-1)?!0:!1};a.prototype.Cgi=function(){var Ub=this.$.da.Aa(66).Cg,Ob=this.Pcc();if(null!=
Ub)return Ub.hasAutoFilter&&Ub.hasActiveFilter;if(null!=Ob)return null!=Ob.g$b&&0<Ob.g$b.length;Ub=this.Hcc();return null!=Ub&&null!=Ub.FilteredColumns&&0<Ub.FilteredColumns.length};a.prototype.Dgi=function(){var Ub=this.$.da.Aa(66).Cg,Ob=this.Pcc();if(null!=Ub&&Ub.hasAutoFilter||null!=Ob&&Ob.G_a.every(function(Yb){return 0!=Yb.length}))return!0;Ub=aa.D(this.Hcc());return null!=Ub&&Ub.contains(this.grid.ha.ta.activeCell)?!0:!1};a.prototype.Pcc=function(){var Ub=this.$.da.Aa(66);Ub.tn(this.grid.ha.ta.activeCell);
return Ub.qvb(this.grid.ha.ta.activeCell)};a.prototype.Hcc=function(){return this.$.xa.getItemByName(this.$.qa.sheetName).j1};a.prototype.ERh=function(){var Ub=this.grid.ha.ta.activeCell,Ob=0,Yb=!1,xb=this.$.da.Aa(66),Sa=this.Pcc();xb=xb.Cg;null!=xb?(Ob=xb.usedRange.top,Yb=!0):null!=Sa?(Ob=Sa.top,Yb=!0):(Sa=this.Hcc(),null!=Sa&&aa.D(Sa).contains(Ub)&&(Ob=Sa.FirstRow+1,Yb=!0));return Yb?(Ub=Ub.left,Ob=H.Range.hd(Ob,Ub),Ob=this.grid.mc(Ob),Yb="",null!=Ob&&(Yb=Ob.text),this.MQg(Yb,Ub)):Z.a.instance.fa(221)};
a.prototype.MQg=function(Ub,Ob){null==Ub||ra.a.Gh(Ub.trim())?Ub=String.format(Z.a.instance.Ab(157),H.Range.XU(Ob)):Ub.length>a.R1d?(Ub=Ub.substring(0,a.R1d),Ub=String.format(Z.a.instance.Ab(155),Ub)):Ub=String.format(Z.a.instance.Ab(156),Ub);return Ub};Ck.Object.defineProperties(a.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return T.a.FMf}}});a.pJb="GridContextMenuRootName";a.L2h=T.a.OCe;a.zld=192;a.R1d=
26;Object(z.a)(a,"GridContextMenu",B.a,[])},1306:function(z,E,b){function a(qa,wa){var Ta=Aa.call(this,qa)||this;Ta.sDa=null;Ta.g0c=[];Ta.P5d=null;Ta.vwa=!1;Ta.Eec=!1;Ta.tq=null;Ta.vbe=null;Ta.GKe=function(){Ta.rZ.PJa(Ta.items,Ta.sDa);Ta.raiseEvent("ACLBUpdated",new t.a(Ta.items.length));Ta.show()};Ta.tableManager=wa;Ta.domElement.className=r.a.ANe;Ta.domElement.innerHTML=va;Z.DOMElementExtensions.setVisible(Ta.domElement,!1);xa.d(Ta.style,Ta.$.isChromeRtl);Ta.wef=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",
!1);Ta.cye=$get(m.n8f,Ta.domElement);Ta.rZ=new c(Ta.$,Ta.cye,Ta);Ta.oTa(!0);Ta.$.domElement.appendChild(Ta.domElement);Ta.$ob(qa,aa.a(qa));Ta.$ob(qa,R.g(qa).rc);Ta.wef||Ta.$.da.Ga(1,Ta);Ta.Kgi=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);return Ta}function c(qa,wa,Ta){qa=L.call(this,qa,wa)||this;qa.cellAutoCompleteControl=null;qa.Gra=null;qa.Yyb=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);qa.Yyb&&(qa.cellAutoCompleteControl=
Ta);qa.Gq=[];return qa}function e(qa,wa,Ta){var sb=Q.call(this,qa,wa)||this;sb.qRb=null;sb.Gjc=0;sb.y8a=null;sb.u1=null;sb.K6=function(db,kb){if(db=sb.cellAutoCompleteControl.items)if(1===db.length&&sb.cellAutoCompleteControl.p1a.length<db[0].Fsa.length&&sb.cellAutoCompleteControl.vwa&&T.a.FL(db[0].Fsa,sb.cellAutoCompleteControl.p1a)&&(kb.newValue=db[0].Fsa),sb.Ya&&M.EwaSettings.ma(136)){var ac=-1;1<db.length?ac=sb.cellAutoCompleteControl.Mcc(sb.Ya.text,!0):1===db.length&&(sb.cellAutoCompleteControl.vwa||
sb.cellAutoCompleteControl.Eec)&&(ac=0);if(0<=ac&&db.length>ac&&db[ac].mYc){var ta=A.C(db[ac].mYc);ta&&R.g(sb.$).Rb.hNa(ta)&&(kb.Vcf=!0,kb.dye=db[ac].mYc)}}};sb.wFb=function(){sb.cellAutoCompleteControl.vwa=!1};sb.Ya.eZa(sb.K6);sb.Yyb=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);sb.Yyb&&(sb.qRb=Ta);sb.u1=sb.de.Wd(sb.Ya.textBox.domElement);sb.u1.ka("mousedown",sb.wFb);return sb}function f(qa,wa){this.Slg=qa;this.Rlg=wa}function m(){}b.r(E);z=b(0);var n=b(14),w=b(90),
h=b(1256),y=b(9),r=b(983);m.n8f="suggested_cells_list_box";Object(z.a)(m,"CssElementIds",null,[]);var x=b(5),t=b(1257);Ck.Object.defineProperties(f.prototype,{Fsa:{configurable:!0,enumerable:!0,get:function(){return this.Slg}},mYc:{configurable:!0,enumerable:!0,get:function(){return this.Rlg}}});Object(z.a)(f,"CellAutoCompleteItem",null,[684]);var u=b(4),B=b(83),v=b(1114),C=b(406),A=b(45),M=b(1),T=b(22),R=b(21),Q=v.a;Am(e,Q);e.prototype.dispose=function(){this.Ya.lIb(this.K6);Q.prototype.dispose.call(this)};
e.prototype.VU=function(qa){qa&&!this.cellAutoCompleteControl.isListVisible||Q.prototype.VU.call(this,qa)};e.prototype.Wh=function(qa,wa){this.cellAutoCompleteControl.Ya=this.Ya;this.Gjc=qa.keyCode;if(this.Ya.isEditing){var Ta=this.Ya.text;T.a.equals(this.y8a,Ta,!1)||(this.y8a=Ta)}else this.y8a=null;if(237279923===wa)return this.cellAutoCompleteControl.isListVisible=!1;M.EwaSettings.ma(136)&&17===this.Gjc&&this.cellAutoCompleteControl.vwa&&(this.cellAutoCompleteControl.Eec=!0);return Q.prototype.Wh.call(this,
qa,wa)};e.prototype.nAd=function(){var qa;if(!M.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!u.AFrameworkApplication.Kg)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.vwa=!1,this.Ya.isEditing){var wa=!T.a.equals(this.y8a,this.Ya.text,!0),Ta=this.Ya.Xod;Ta||!wa&&229!==this.Gjc?Ta&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(qa=this.cellAutoCompleteControl.ZNa)||
void 0===qa?void 0:qa.cancel()):this.cellAutoCompleteControl.pMg(this.Gjc)}else this.y8a=null};e.prototype.gj=function(){};e.prototype.Ng=function(){this.qW=!1;this.cellAutoCompleteControl.set_visible(!1);this.y8a=null;this.cellAutoCompleteControl.vwa=!1;this.cellAutoCompleteControl.Eec=!1;this.cellAutoCompleteControl.ZNa&&this.cellAutoCompleteControl.ZNa.cancel()};e.prototype.NGd=function(qa,wa){return this.cellAutoCompleteControl.Wh(qa,wa)};Ck.Object.defineProperties(e.prototype,{kzb:{configurable:!0,
enumerable:!0,get:function(){return!1}},qW:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(qa){this.cellAutoCompleteControl.isListVisible=qa}},f6a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return C.a.h0c}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.Yyb)return this.qRb;var qa=b(1306).CellAutoCompleteControl;return this.qRb||(this.qRb=Object(B.a)(qa,
this.$.da.Aa(1)))}}});Object(z.a)(e,"CellAutoCompleteListAutoCompleteBehavior",v.a,[]);var ea=b(29);v=b(1258);var Z=b(12),ca=b(10),I=b(115),H=b(67),L=v.a;Am(c,L);c.prototype.dispose=function(){L.prototype.dispose.call(this);this.Gra=null};c.prototype.Tzc=function(qa){this.j8(!1);var wa=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.rca);for(var Ta=0,sb=this.Gq.length;Ta<sb;Ta++){var db=ea.a.Sf(qa[this.Gq[Ta]].Fsa);db=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.W_,c.i0c,x.a.Bqe,db,ea.a.n8b(db));wa+=db}this.dg.innerHTML=wa+"</tbody></table>";this.Un=Z.DOMElementExtensions.Cj(this.domElement,this.rca);this.j8(!0);this.osa()};c.prototype.PJa=function(qa,wa){if(qa&&qa.length){var Ta=[];if(wa)for(var sb=0,db=qa.length;sb<db;sb++)T.a.FL(qa[sb].Fsa,wa)&&Ta.push(sb);this.Gq=Ta;this.Tzc(qa)}else this.isListVisible=!1,this.Gra=null};c.prototype.wya=function(){};c.prototype.WTg=function(qa,wa,Ta){var sb=Math.min(qa,Math.max(200,Ta));wa&&qa<Ta&&(sb+=I.a.zu);Z.DOMElementExtensions.Jr(this.dg,
sb);wa&&(sb-=I.a.zu);return sb};c.prototype.osa=function(){L.prototype.osa.call(this);var qa=Z.DOMElementExtensions.Cj(this.get_element(),this.rca),wa=this.Gq.length>this.kI,Ta=R.g(this.$);if(Ta=Ta.mc(Ta.ha.ta.activeCell))for(qa=this.WTg(qa.offsetWidth,wa,Ta.width),wa=this.dg.getElementsByClassName(c.i0c),Ta=0;Ta<wa.length;Ta++)wa[Ta].style.maxWidth=ca.HelperMethods.nc(qa);else n.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
c.prototype.onItemClick=function(qa){if(qa=L.prototype.onItemClick.call(this,qa)){var wa=R.g(this.$);wa.Kp(!1);wa.focus()}return qa};Ck.Object.defineProperties(c.prototype,{Vk:{configurable:!0,enumerable:!0,get:function(){return this.Gra},set:function(qa){this.PBa(this.Vk);this.Gra=qa;var wa=this.PBa(this.Vk);this.we=qa?wa.innerText:null;this.rvc(qa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(H.a)(c.prototype,this,"isListVisible")},set:function(qa){Object(H.b)(c.prototype,
this,"isListVisible",qa);qa||(this.Vk=null)}},MTa:{configurable:!0,enumerable:!0,get:function(){return null}},PGa:{configurable:!0,enumerable:!0,get:function(){return this.Yyb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});c.i0c=r.a.Qth;Object(z.a)(c,"CellAutoCompleteListBox",v.a,[]);var U=b(25),fa=b(63),aa=b(121),na=b(188),ha=b(44),ka=b(35),xa=b(259);v=b(19);b.d(E,"CellAutoCompleteControl",function(){return a});var va="<div id='"+m.n8f+
"' class='"+r.a.V9c+" "+v.a.lm+"' ></div>",Aa=h.a;Am(a,Aa);a.prototype.NZb=function(qa){this.addHandler("ACLBUpdated",qa)};a.prototype.ntc=function(qa){this.removeHandler("ACLBUpdated",qa)};a.prototype.j3=function(qa){this.addHandler("ACLBSelectionChanged",qa)};a.prototype.Jda=function(qa){this.removeHandler("ACLBSelectionChanged",qa)};a.prototype.aGg=function(qa){this.addHandler("ACLBMatchedItem",qa)};a.prototype.wcj=function(qa){this.removeHandler("ACLBMatchedItem",qa)};a.prototype.C7f=function(qa){for(var wa=
0;wa<qa.length;wa++){var Ta=qa.charCodeAt(wa);if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?T.a.isLetter(Ta):T.a.aqd(Ta))return!0}return!1};a.prototype.kxa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.oTa(!1);var qa=R.g(this.$);qa&&qa.view.Yq(this.Jnc)}w.a.yc([this.rZ,this.ZNa]);w.a.yc(this.g0c);this.g0c=this.cye=this.rZ=this.Ya=null;Aa.prototype.dispose.call(this)};a.prototype.Wh=function(qa,wa){var Ta=
!1;if(this.Bxj())switch(wa){case -798660877:if(1===this.items.length&&this.we)break;this.St.CB(1);this.raiseEvent("ACLBSelectionChanged",new t.a(this.items.length,this.Mcc(this.we),this.we));Ta=this.kz(!1);break;case 137938150:if(1===this.items.length&&this.we)break;this.St.CB(-1);this.raiseEvent("ACLBSelectionChanged",new t.a(this.items.length,this.Mcc(this.we),this.we));Ta=this.kz(!1);break;case 2091832999:this.St.CB(this.kI-1);Ta=this.kz(!1);break;case 742457698:this.St.CB(-(this.kI-1));Ta=this.kz(!1);
break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;Ta=!0;break;case 267796030:this.kz(!0);break;default:Ta=Aa.prototype.Wh.call(this,qa,wa)}return Ta};a.prototype.show=function(){this.items&&this.items.length&&(this.rZ.Vk=this.we?this.St.Un.rows[this.Mcc(this.we)]:null,this.isListVisible=0<this.rZ.Gq.length,this.fCa(!0),this.rZ.wya())};a.prototype.pMg=function(qa){var wa=!!this.Ya&&!fa.f(this.$.qa);this.Eec=this.vwa=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):
wa&&!this.dch(this.activeCell)&&this.hBj(qa)};a.prototype.dch=function(qa){return!!this.dataValidationControl&&this.dataValidationControl.E7c(qa)};a.prototype.kz=function(qa){if(!this.Ya||!this.isListVisible)return!1;var wa=this.sDa;if(this.we){var Ta=Z.DOMElementExtensions.d_(Z.DOMElementExtensions.Cj(this.rZ.Vk,c.i0c),x.a.Bqe,""),sb=Ta.substring(wa.length,Ta.length);qa?this.Ya.text=Ta:this.Ya.insertTextAt(sb,wa.length,this.Ya.text.length)}Ta=R.g(this.$);Ta.Fj&&(Ta=Ta.rc,Ta.text=this.Ya.text,Ta.setCaretPosition(this.Ya.textBox.caretPosition));
qa?this.isListVisible=!1:this.Ya.textBox.selectRange(wa.length,this.Ya.text.length);return!0};a.prototype.Mcc=function(qa,wa){wa=void 0===wa?!1:wa;if(!this.rZ.Un)return-1;for(var Ta=this.rZ.Un.children[0],sb=Ta.children.length,db,kb=0;kb<sb;++kb)if(db=Ta.children[kb],T.a.equals(db.innerText.trim(),qa,wa))return kb;return-1};a.prototype.hBg=function(qa,wa,Ta,sb,db,kb,ac){var ta=Ta.originalText.replace(a.Usf,String.fromCharCode(32)),ra=new U.Range(qa.top-1,qa.left,qa.bottom-1,qa.right,!1,!1),Na=ac?
ac.tn(Ta.range):null;(!Ta.wF||Ta.range.left===qa.left)&&1<ta.length&&!sb.xb(ta.toUpperCase())&&T.a.FL(ta,wa)&&!T.a.equals(ta,wa,!0)&&!a.WUe(wa)&&this.C7f(ta)&&(!db&&!Na||!db&&Na.equals(ac.tn(ra))||db&&Ta.range.Kd(kb)&&Ta.range.top!==kb.top)&&(qa=Ta.formulaBarText,T.a.equals(qa,Ta.text,!1)||!qa)&&(qa={},qa.FirstRow=Ta.range.top-1,qa.FirstColumn=Ta.range.left-1,Ta=new f(ta,qa),sb.add(ta.toUpperCase(),Ta))};a.prototype.hBj=function(qa){this.tq=this.c_h();this.ZNa&&this.ZNa.cancel();0<this.Ya.text.length&&
0!==qa?this.items&&((1<this.items.length||this.isListVisible)&&this.Qih(),8!==qa&&127!==qa&&46!==qa&&(1===this.items.length?this.Yld(!1):this.rZ.Vk&&this.kz(!1))):this.isListVisible=!1};a.prototype.Qih=function(){this.isListVisible?this.GKe():this.vbe=na.AsyncMethodContext.av(this.GKe,500,ha.a.fWg,this.ZNa)};a.prototype.Yld=function(qa){n.ULS.shipAssertTag(537167966,0,!this.kxa()&&1===this.items.length,"Invalid Items");var wa=this.items[0].Fsa,Ta=this.Ya.text,sb=wa.substring(Ta.length,wa.length);
if(qa&&!sb.length)this.Ya.text=wa;else if(!qa&&0<sb.length)this.Ya.appendText(sb),this.Ya.textBox.selectRange(Ta.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new t.a(this.items.length,0,wa));this.vwa=!0};a.prototype.c_h=function(){this.tq=null;var qa=new ka.a(!1),wa=this.activeCell;this.sDa=this.Ya.text.replace(a.Usf,String.fromCharCode(32));var Ta=this.tableManager.tn(wa),sb=wa.Kd(Ta);if(a.WUe(this.sDa)||!this.C7f(this.sDa))return this.items;var db=new U.Range(1,wa.left,
wa.top-1,wa.left,!1,!1),kb=new U.Range(wa.top+1,wa.left,y.a.Ih,wa.left,!1,!1),ac=R.g(this.$);kb=ac.wk("CellAutoCompleteControl.GetSuggestedCells",kb);try{var ta=ac.wk("CellAutoCompleteControl.GetSuggestedCells2",db);try{for(var ra=Cl([ta,kb]),Na=ra.next();!Na.done;Na=ra.next())for(var gb=Na.value;gb.$$mn();){var ob=gb.$$cu();this.hBg(wa,this.sDa,ob,qa,sb,Ta,this.tableManager)}}finally{ta&&ta.dispose()}}finally{kb&&kb.dispose()}this.tq=Array(qa.values.length);for(wa=0;wa<this.items.length;wa++)this.items[wa]=
qa.values[wa];this.items.sort(function(wb,Oa){return wb.Fsa.localeCompare(Oa.Fsa)});return this.items};a.prototype.$ob=function(qa,wa){qa&&wa&&this.g0c.push(new e(qa,wa,this.wef?this:void 0))};a.prototype.Bxj=function(){return this.Kgi?this.p1a&&!this.kxa()&&this.isListVisible?this.get_visible():!1:this.p1a&&!this.kxa()&&this.get_visible()&&this.isListVisible};a.WUe=function(qa){qa=0<qa.length?qa.charCodeAt(0):-1;return 35===qa||61===qa||43===qa||45===qa||64===qa};Ck.Object.defineProperties(a.prototype,
{St:{configurable:!0,enumerable:!0,get:function(){return this.rZ}},p1a:{configurable:!0,enumerable:!0,get:function(){return this.sDa}},we:{configurable:!0,enumerable:!0,get:function(){return this.rZ.we}},items:{configurable:!0,enumerable:!0,get:function(){return this.tq}},ZNa:{configurable:!0,enumerable:!0,get:function(){return this.vbe}},activeCell:{configurable:!0,enumerable:!0,get:function(){return R.g(this.$).ha.ta.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.P5d||
(this.P5d=this.$.da.Aa(14))}}});Ck.Object.defineProperties(a,{Usf:{configurable:!0,enumerable:!0,get:function(){return a.ade||(a.ade=new RegExp(String.fromCharCode(160),"g"))}}});a.ade=null;Object(z.a)(a,"CellAutoCompleteControl",h.a,[659,660,661,2])},1436:function(z,E,b){function a(){this.tb=null;this.vx=!1}function c(l,J){var Y=vi.call(this)||this;Y.Bqa=rf.a.SIh;Y.DPc=!!window.PointerEvent;Y.Bje=window.hasOwnProperty("ontouchstart");Y.Ykb=null;Y.xWa=null;Y.s9=!1;Y.aU=new Ec.a;Y.slb=new Ec.a;Y.Npg=
new P.a;Y.Ypa=null;Y.Tmb=!1;Y.v4d=!1;Y.Yfe=!1;Y.zNc=!1;Y.RGc=!1;Y.p4d=!1;Y.WJc=!1;Y.BVa=!1;Y.Akb=-1;Y.kSc=null;Y.session=null;Y.handlers=null;Y.element=null;Y.curRecognizer=null;Y.Xd=si.EventHandlerManager.instance;Y.DPc?(Cd.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),Y.Ykb=Object(ci.a)(Y,Y.xoc,"onPointerEvent"),Y.xWa=Bg.a.UIh):Y.Bje?(Cd.ULS.sendTraceTag(593893140,310,50,"Using touch events"),Y.Ykb=Object(ci.a)(Y,Y.iza,"onTouchEvent"),Y.xWa=Bg.a.touchEvents):(Cd.ULS.sendTraceTag(593893139,
310,50,"Using mouse events"),Y.Ykb=Object(ci.a)(Y,Y.hoc,"onMouseEvent"),Y.xWa=Bg.a.TIh);Y.Eh=J;Y.Lfa=l;Fg.AFrameworkApplication.ga&&(Y.Tmb=Fg.AFrameworkApplication.ga.ra("UsePointerCaptureIsEnabled"),Y.v4d=Fg.AFrameworkApplication.ga.ra("ClearCacheOnPrimaryPointerIsEnabled"),Y.Yfe=Fg.AFrameworkApplication.ga.ra("ResetHandledBeforeInputHandlerIsEnabled"),Y.zNc=Fg.AFrameworkApplication.ga.ra("LogCoalescedEventsIsEnabled"),Y.RGc=Fg.AFrameworkApplication.ga.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),
Y.p4d=Fg.AFrameworkApplication.ga.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),Y.WJc=Fg.AFrameworkApplication.ga.ra("HammerJsPerformanceTimersIsEnabled"),Y.BVa=Y.Tmb&&Fg.AFrameworkApplication.ga.ra("CancelDragFromGestureInputManagerIsEnabled")&&Fg.AFrameworkApplication.ga.ra("UseGestureInputManagerPointerCacheIsEnabled"));return Y}function e(){}function f(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=
this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function m(l,J,Y,za,Ua,Qb,uc,ed,Dd){l=uh.call(this,l,Y,za,Qb)||this;l.Phb=J;l.Mga=uc;l.qY=ed;l.UZj=Dd;l.Mpg=Ua;return l}function n(){this.gIc=null}function w(){this.xda=this.wXe=null}function h(l){return Te.call(this,l)||this}function y(l){this.$=l}function r(l){var J=
ye.call(this)||this;J.$=l;J.Tb();return J}function x(l){var J=this;this.$=l;this.B$=Object.assign({},zl);this.gKa=Object.assign({},wl);this.kZ=Object.assign({},tl);this.jpb=Object.assign({},vl);this.Jna=Object.assign({},ia);this.vYc=Object.assign({},Qa);this.Zcd=Object.assign(Object.assign({},dl),{isReactDialog:og.a.egf(this.$)});this.Zc=function(){J.Mtj();J.$.sendBeaconTraceTag(88392384,50,!1,"{0}",J.getJsonForLogging())};this.lab=new Ec.a;l.Zk(this.Zc)}function t(l){var J=this;this.hrf=l;this.x0=
Object.assign({},F);this.U7b=[];this.xlc=-1;(this.grf=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&l&&(this.x0.countAboveThresholds={},l.forEach(function(Y){return J.x0.countAboveThresholds[Y]=0}))}function u(l){var J=Yk.call(this)||this;J.$=l;J.Tb();return J}function B(l,J,Y,za,Ua){var Qb=sl.call(this)||this;Qb.kP=null;Qb.V0=null;Qb.RFa=null;Qb.wvc=null;Qb.BOc=null;Qb.bYa=null;Qb.ofe=0;Qb.rFc=!1;Qb.wh=function(){Qb.Rwa&&(Qb.gridView?1===Qb.gridView.ha.Ue?
(Qb.gridView.ha.ta.activeCell.equals(Qb.RFa)||Qb.vN||Qb.ny(),Qb.Vob.$q()):Qb.ny():Cd.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};Qb.gj=function(){Qb.ny()};Qb.zd=function(){Qb.MX()};Qb.Zc=function(){Qb.ny()};Qb.vd=function(){Qb.showCallout()};Qb.Rya=function(){if(Qb.uh.Mk&&Qb.uh.Mk.length)if(Qb.LZc)Qb.uh.jui||(Qb.rFc=Qb.uh.Mk[0].BlockingDataForExpand),Qb.uh.RPh&&Cd.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),
Qb.ofe=Qb.uh.x5c&&Qb.uh.yWe<Qb.uh.x5c.left-1?Qb.uh.x5c.left-1-Qb.uh.yWe:-1,Qb.showCallout();else if(Qb.gridView.ha.ta.Lg){var uc=Qb.gridView.ha.ta.activeCell;if(uc&&Qb.V0){var ed=Qb.tableManager.tn(uc);Qb.pMc=!!ed;var Dd=Qb.gridView.ha.ta.ud;ed=Qb.vN&&Qb.V0.Kd(ed);var hd=Qb.Tid&&!Qb.vN&&Dd.equals(Qb.selectedRange);ed||hd?(Cd.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),Qb.W9b=!0,We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!Qb.vN&&Qb.tableManager.Sva(uc)?
Cd.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?Qb.vN?Qb.Zh.fBa(Qb.V0,Qb.vN):Qb.Zh.fBa(Dd,Qb.vN):Qb.Zh.fBa(Qb.V0,Qb.vN),Qb.huc())):Cd.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};Qb.fj=function(){Qb.i7a()&&Qb.Zh.hide();1===Qb.gridView.ha.Ue&&Qb.MX()};Qb.jS=function(){var uc=
Qb.gridView.ha.Ue;Qb.gridView.ha.ta.activeCell&&1===uc&&Qb.MX()};Qb.ot=function(){if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(Qb.vN){if(Qb.V0&&Qb.RFa){var uc=Qb.tableManager.tn(Qb.RFa);uc&&1<uc.bottom-uc.top&&(--uc.bottom,Qb.gridView.V5(uc)&&Qb.Vob.$q())}}else Qb.gridView.ha.ta.Lg&&Qb.gridView.V5(Qb.gridView.ha.ta.ud)&&Qb.Vob.$q();else Qb.V0&&Qb.RFa&&Qb.vN&&(uc=Qb.tableManager.tn(Qb.RFa))&&1<uc.bottom-uc.top&&(--uc.bottom,Qb.gridView.V5(uc)&&
Qb.Vob.$q())};Qb.MX=function(){if(Qb.$&&Qb.gridView){if(Qb.W9b&&Qb.vN){var uc=Qb.gridView.ha.ta.activeCell;Qb.V0=Qb.EUe();var ed=!!Qb.wvc&&Qb.wvc.contains(uc);if(Qb.V0&&(uc.equals(Qb.RFa)||ed)){Qb.Zh.fBa(Qb.V0,Qb.vN);return}}Qb.W9b=!1;Qb.V0=Qb.EUe();Qb.V0&&Qb.Eya&&Qb.gridView&&Qb.gridView.Ea.hs(Qb.Eya)?(Qb.LZc=!1,Qb.f_()):(Qb.uh.F_c(),Qb.uh.W1b());Qb.W9b||Qb.Zh.hide()}};Qb.$=l;Qb.tableManager=Y;Qb.contextMenuManager=za;Qb.Zh=new v(l,Qb.vd,J,Ua);Qb.uh=J.d4c(l,Y);Qb.LZc=!1;Qb.W9b=!1;Qb.Tid=We.EwaSettings.ma(136);
Qb.pMc=!0;Qb.gridView=Je.g(Qb.$);Qb.gridView.rc.sl(Qb.gj);Qb.gridView.Nt(Qb.jS);Qb.$.tl(Qb.zd);Qb.$.Zk(Qb.Zc);Qb.$.RA(Qb.fj);Qb.gridView.view.Ts(Qb.ot);Qb.gridView.ha.bZ(Qb.wh);Qb.Vob=pj.a.instance.create(Qb.MX,250,mh.a.c3i);Cd.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");Qb.uh.EZb(Qb.Rya);Qb.MX();l.da.Ga(261,Qb);return Qb}function v(l,J,Y,za){var Ua=ql.call(this)||this;Ua.isMac=Jj.a.isMac;Ua.$=l;Ua.ariaLiveNotifier=za;Ua.Xp=Y.e5b(l,null,J,D.a.Suh,Hg.a.Se(9),se.a.instance.fa(1701),
"PulloutPointerDown");return Ua}function C(l){var J=ul.call(this)||this;J.g5b=null;J.$=l;J.Tb();return J}function A(l){var J=pl.call(this)||this;J.$=l;We.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&J.Tb();return J}function M(){}function T(l,J,Y,za,Ua){Y=void 0===Y?null:Y;za=void 0===za?null:za;Ua=void 0===Ua?0:Ua;l=Q.call(this,l,J)||this;l.dOa=null;l.cfc=Y||Hg.a.current.np(82);l.omf=Ua;l.A5c=za;l.hCg();return l}function R(l,J,Y,za){l=Q.call(this,l,J)||this;l.kCb=null;
l.nog=Y;l.v7h=za;l.iCg();return l}function Q(l,J){l=ol.call(this,l)||this;l.lCb=null;l.j$h=Math.max(1,J);return l}function ea(l,J,Y,za,Ua,Qb,uc,ed){ed=void 0===ed?"":ed;var Dd=kl.call(this)||this;Dd.Hwa=null;Dd.W9e=!1;Dd.Ulc=null;Dd.Tlc=null;Dd.buttons={};Dd.qNe={};Dd.$=l;Dd.svgIconProvider=J;Dd.HIi=Y;Dd.Tld=za;Dd.Sld=Ua;Dd.altText=Qb;Dd.xGb=uc;Dd.buttonText=ed;return Dd}function Z(l,J,Y,za,Ua,Qb,uc,ed){function Dd(Ke){Fh.g(Ke)}var hd=nk.call(this,document.createElement("div"))||this;hd.zkf=null;
hd.ATd=!1;hd.PSa=null;hd.nNb=null;hd.bO=function(){hd.raiseEvent("OnObjectButtonMouseOver")};hd.aO=function(){hd.raiseEvent("OnObjectButtonMouseOut")};hd.ICj=function(){hd.lle()};hd.vd=function(Ke){hd.raiseEvent(hd.xGb,Ke);hd.vGb();return!0};hd.pKi=function(Ke){100<gh.a(Pf.a.Ta,hd.zkf)&&hd.ujd(new Sys.UI.Point(Math.round(Ke.clientX),Math.round(Ke.clientY)))};hd.VN=function(Ke){Fh.g(Ke.Ca,!1);return!1};hd.MZ=hd.de.Gta();hd.set_visible(!1);hd.Eic=Ua;hd.xGb=Qb;hd.wmc=l;hd.V2b=J;hd.Eic&&(hd.PSa=pj.a.instance.create(hd.ICj,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));l&&hd.domElement.classList.add(l);hd.E_a=document.createElement("div");hd.domElement.appendChild(hd.E_a);Y&&hd.E_a.classList.add(Y);za&&(hd.E_a.innerHTML=za);uc&&(hd.nNb=document.createElement("div"),hd.domElement.appendChild(hd.nNb),hd.nNb.classList.add(ed),hd.nNb.innerText=uc,hd.domElement.style.padding="3px",ik.a.instance.pa(Bg.a.pointerDown,hd.domElement,hd.VN));hd.w_a=new Ej.a(hd.domElement,7);zi.a.instance.pa(Bg.a.click,hd.domElement,hd.vd);We.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&
ik.a.instance.pa(Bg.a.pointerDown,hd.domElement,hd.VN);hd.Fc.ka("mouseup",Dd);hd.Fc.ka("click",Dd);hd.Fc.ka("dblclick",Dd);return hd}function ca(){}function I(l,J,Y,za){var Ua=H.call(this,l,J)||this;Ua.p2a=null;Ua.Xxf=function(){Ua.etc(Ua.Xxf);if(Ua.Mk&&Ua.Mk.length&&Ua.contextMenuManager){var Qb=Ua.contextMenuManager.ved("autoFilterRichFieldList"),uc=window.document.getElementById(Ua.p2a);Qb.k1(null,uc,Ua,null,!0)}};Ua.Tlg=Y;Ua.contextMenuManager=za;return Ua}function H(l,J){var Y=Mj.call(this)||
this;Y.IP=null;Y.Svb=null;Y.cfd=null;Y.fJb=null;Y.rUb=!1;Y.C5d=null;Y.dMi=function(za,Ua,Qb){Cd.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Qb);Y.fJb&&Y.fJb.stop();Y.IP=null;Y.raiseEvent("GetFieldInfoListContextOperationFailed")};Y.eMi=function(za){Bh.a(za)||(Y.fJb&&Y.fJb.stop(),Y.rUb=!1,Y.IP=za.Result,Y.IP&&0<Y.IP.length&&Cd.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",Y.IP.length),Y.Mjb=!0,Y.fHd())};Y.Mjb=
!1;Y.wb=l;Y.bTb=-1;Y.tableManager=J;return Y}function L(l){var J=Hj.call(this)||this;J.firstElement=null;J.Rw=null;J.KMa=!1;J.Hs=null;J.Gwj=Jj.a.Hf||Jj.a.vB;J.Yzf=function(Y){var za=Y.Ca.keyCode;return za===Aj.a.ei?J.JKi():za===Aj.a.QD&&Y.Ca.shiftKey?J.kzh(J.firstElement):!1};J.rFf=function(Y){if(!J.KMa||Y.Ca.keyCode!==Aj.a.UL)return!1;L.t9e();ig.Task.delay(1).CWRCC(function(){J.Rw.focus();return!0},J.la);return!0};J.lVi=function(){document.activeElement&&document.activeElement.id===J.Rw.id||(L.t9e(),
ig.Task.delay(1).CWRCC(function(){J.Rw.focus();return!0},J.la))};J.cyf=function(){J.jag(J.Rw)};J.Xzf=function(Y){Y.stopPropagation();Y.preventDefault();J.KMa&&(J.KMa=!1)};J.$=l;(l=J.$.ea.wc)&&Cd.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",l.rta,l.inWebPart?"Classic":"Non Classic",l.inEmbedView?"True (+Modern)":"False (not Modern)");l&&(l.inWebPart||l.inEmbedView)?Cd.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",
l.inWebPart?"Classic":"Non Classic",l.inEmbedView?"True (+Modern)":"False (not Modern)"):(J.b7g(),J.$7g(),Bk.KeyInputManager.instance.pa(Bg.a.Xb,J.$.domElement,J.rFf));J.$.da.Ga(238,J);return J}function U(l,J,Y,za,Ua){Ua=void 0===Ua?null:Ua;var Qb=Wh.call(this)||this;Qb.nob=null;Qb.yPa=null;Qb.PZc=0;Qb.qpc=null;Qb.RRi=function(){var uc=Qb.yPa.XZe();Cd.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",Qb.Ila,uc);Qb.qpc=pj.a.instance.create(Qb.X6,
Math.max(Qb.iwe-uc,0),mh.a.$ke)};Qb.X6=function(){Cd.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",Qb.Ila,Qb.yPa.XZe(),Qb.t6a);Qb.PZc++;Qb.PZc>Qb.hwe&&Cd.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",Qb.Ila);Qb.yPa.Ox.C();Qb.NUe()};Qb.Qya=function(){Qb.t6a&&Cd.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
Qb.Ila,Qb.kMa,Qb.t6a);Qb.xnd()};Qb.Wzg=l;Qb.Xzg=J;Qb.documentVisibilityObserver=Y;Qb.Ila=za;Qb.bP=Ua;Y&&Qb.documentVisibilityObserver.Tnb(Qb.Qya);Qb.OZc=!!Y&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);Qb.hwe=We.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);J=We.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Qb.iwe=l.Cdd(J);l=We.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",
1E3);Qb.jTg=Math.max(Qb.iwe-J,0)+l;return Qb}function fa(){this.startTime=Pf.a.Ta.Wb;this.Ox=new gi.a}function aa(l){var J=ve.call(this)||this;J.$=l;J.Tb();return J}function na(l,J,Y,za,Ua,Qb,uc){var ed=this;this.$=l;this.functionInfoManager=J;this.calcManager=Y;this.pluginScheduler=za;this.formulaAssistanceUIControl=Ua;this.formulaAssistanceTelemetryManager=Qb;this.uh=uc;this.zSa=!0;this.KNa=null;this.JNa=-1;this.cda=0;this.Rh=function(Dd,hd){Je.g(ed.$).isEditing||Je.g(ed.$).Ni||ed.KDb(null===hd||
void 0===hd?void 0:hd.cell)};this.onFunctionInfoLoaded=function(){ed.functionInfoManager.Nbb(ed.onFunctionInfoLoaded);ed.MTj();ed.Pda()};this.Vuf=function(){ed.zSa=!1};this.cvf=function(Dd,hd){var Ke=ed.Ya;Dd=Ke.text;Ke=Ke.textBox.caretPosition;0<ed.cda&&ed.formulaAssistanceTelemetryManager.kZ.commitWhileRequestPending++;ed.formulaAssistanceTelemetryManager.RI(["argumentAssistanceComputation"]);hd.shouldRequestAutocompleteOnCommit?ed.ZXf(Dd,Ke):ed.xLd(Dd,Ke)};this.Ng=function(){ed.zSa=!0;We.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&
ed.j7c()};this.K6=function(Dd,hd){ed.eNd(hd.newValue)};this.Qi=function(){ed.tdg()};this.tdg=function(){ed.pluginScheduler.notifier().setDefinedNamesInfo(ed.w6b.VHe)};this.functionInfoManager=J;this.formulaAssistanceUIControl=Ua;this.pluginScheduler=za;this.cgf=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.Mba=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.pzd=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
this.cgf&&(this.w6b=new Ub(l),Je.g(this.$).Ea.Ix(this.Qi),this.tdg());this.vqa=new va(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.Wfa=new xa(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);l.da.Ga(464,this);this.calcManager=Y;og.a.IR()&&this.Vmd();this.Mba&&(Je.g(this.$).Ac.To(this.Ng),this.vqa.iFg(this.Vuf));this.Dod=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1)}function ha(l,J){var Y=
this;this.uh=l;this.$=J;this.Rya=function(){Y.V9b.resolve(Y.uh.Mk);Y.Nbg();Y.Axf||(Je.g(Y.$).Ac.To(Y.Ng),Y.Axf=!0)};this.Fyf=function(){Y.V9b.reject(null);Y.Nbg()};this.Ng=function(){Y.uh.mcb();Je.g(Y.$).Ac.Zn(Y.Ng);Y.Axf=!1}}function ka(){var l=this;this.promise=new Promise(function(J,Y){l.Dvg=J;l.lvg=Y})}function xa(l,J,Y){var za=Fd.call(this,xa.oKa())||this;za.$=l;za.formulaAssistanceUIControl=J;za.formulaAssistanceTelemetryManager=Y;za.Ya=null;za.rr=null;za.OIa=!1;za.PIa=!1;za.gua=!1;za.eua=!1;
za.fua=!1;za.Rt=null;za.FX=0;za.Zq=null;za.lw=!1;za.ega=!1;za.nBa=!1;za.XSa=!1;za.sMb=!1;za.dOb=ad.Dismissed;za.onRestoreFocus=function(){};za.dismiss=function(){za.lw=!1;za.Qud();za.AK&&za.Ya.isEditing&&za.hna();za.Zq=null;za.formulaAssistanceUIControl&&(za.formulaAssistanceUIControl.dismiss(za.domElement),za.rr.canReceiveFocus=!1,za.dOb=ad.Dismissed)};za.ajd=function(){za.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};za.iKi=function(){za.dismiss();Je.g(za.$).kk.textBox.focus()};za.LRa=function(){var Ua=
{};za.CFf?Ua[oa.a.HV]="SmartSuggestionsCard":Ua[oa.a.HV]="FunctionAndSmartSuggestionsCard";za.$.Zd(802602464,0,8,Ua)};za.Ng=function(){za.Fzb&&za.kJg()};za.OAd=function(Ua,Qb){za.Sfb(Qb);za.PIa=!0};za.kd=function(){za.visible=!1};za.NAd=function(Ua){za.fua=!0;za.arb(Ua)};za.ii=function(){za.dismiss()};za.ot=function(){void 0!==za.Zq&&null!==za.Zq&&za.Zq()};za.rr=new rb(za.$,za.formulaAssistanceUIControl,1,Xi.a.Fcd,za.ajd);Je.g(za.$).view.Ts(za.ot);Je.g(za.$).ha.WG(za.kd);za.$.xa.zg(za.ii);za.Fzb=
We.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");za.Fzb&&Je.g(za.$).Ac.To(za.Ng);We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&za.$.domElement.appendChild(za.domElement);za.yki=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents");return za}function va(l,J,Y){var za=vc.call(this,va.oKa())||this;za.$=l;za.formulaAssistanceUIControl=J;za.formulaAssistanceTelemetryManager=Y;za.q3=
0;za.rr=null;za.Zq=null;za.xla=null;za.lw=!1;za.CR=!1;za.kd=function(){za.visible=!1};za.onCardModeChange=function(Ua){za.oOb(Ua);1===Ua?za.formulaAssistanceTelemetryManager.B$.argumentAssistanceCollapseCounter++:za.formulaAssistanceTelemetryManager.B$.argumentAssistanceExpandCounter++};za.LRa=function(Ua){var Qb={};Qb[oa.a.HV]="ArgumentAssistanceCard";var uc={};uc.FunctionName=Ua.functionName;Qb[oa.a.Dad]=uc;za.$.Zd(802602464,0,8,Qb)};za.ot=function(){void 0!==za.Zq&&null!==za.Zq&&za.Zq()};za.onDismissClick=
function(){za.formulaAssistanceTelemetryManager.B$.argumentAssistanceDismissCounter++;za.dismiss();za.raiseEvent("DC");za.CR&&za.pH.clear();0===za.q3&&za.oOb(1)};za.Ng=function(){za.CR&&za.pH.clear()};za.Mba=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);za.KPd();za.rr=new rb(za.$,za.formulaAssistanceUIControl,0,Xi.a.Ccd);Je.g(za.$).view.Ts(za.ot);Je.g(za.$).ha.WG(za.kd);za.CR=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",
!1)&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);za.CR&&(za.pH=new pc(za.formulaAssistanceUIControl,za.formulaAssistanceTelemetryManager),Je.g(za.$).Ac.To(za.Ng));We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&za.$.domElement.appendChild(za.domElement);return za}function Aa(l,J,Y,za,Ua,Qb,uc,ed,Dd){var hd=Pb.call(this,l)||this;hd.functionInfoManager=J;hd.calcManager=za;hd.instantaneousSupportInformationManager=
Ua;hd.formulaAssistanceUIControl=uc;hd.formulaAssistanceTelemetryManager=ed;hd.pluginScheduler=Dd;hd.kec=!1;hd.rr=null;hd.QGa=null;hd.Cg=null;hd.yW=null;hd.Ksd=null;hd.d6=null;hd.I3a=0;hd.iac=0;hd.p4=0;hd.jKe=0;hd.Vsb=0;hd.Feb=0;hd.K5b=0;hd.Pxc=!1;hd.nja=null;hd.Vpc=null;hd.columnName="";hd.F6c=!1;hd.yxe=!1;hd.cKa=[];hd.HQ=null;hd.WSa=[];hd.Zq=null;hd.fdd=null;hd.U8=null;hd.ega=!1;hd.nBa=!1;hd.XSa=!1;hd.sMb=!1;hd.KNa=null;hd.JNa=0;hd.c3d=null;hd.fDb=0;hd.Znd=!1;hd.onRestoreFocus=function(){};hd.ajd=
function(){hd.$k&&hd.raiseEvent(Aa.hcd,null)};hd.YTe=function(){hd.nja=!1;hd.yW=hd.Ya.text;hd.Ef.PJa(hd.Rt,hd.yW,!0,hd.columnName,void 0,!1);1===hd.Ef.Gq.length&&1===hd.Ef.fX.length?(hd.set_visible(!1),hd.yxe||hd.Yld()):hd.show()};hd.mNi=function(Ke){if(Bh.a(Ke))-315732528!==Ke.Errors[0].MessageId&&Cd.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",wg.a.Xc(Ke.Errors));else if((Ke=Ke.Result)&&Ke.length){hd.Cg.$O||
(hd.Cg.$O={},hd.Cg.$O.HeadersList=[]);hd.Cg.$O.IsFullTableHeaders=!0;for(var zf=0;zf<Ke.length;++zf)hd.Cg.$O.HeadersList[zf]={},hd.Cg.$O.HeadersList[zf].Index=zf,hd.Cg.$O.HeadersList[zf].Name=Ke[zf];hd.kIf(!0);hd.yW=hd.g4e();hd.Ef.PJa(hd.Rt,hd.yW,!0,void 0,void 0,!0);hd.show()}else Cd.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};hd.lNi=function(Ke){Ke=Xg.a.pg(Ke.data);Cd.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",
wg.a.Xc(Ke))};hd.wuf=function(Ke,zf){Je.g(hd.$).isEditing||Je.g(hd.$).Ni||hd.KDb(null===zf||void 0===zf?void 0:zf.cell)};hd.K6=function(Ke,zf){hd.eNd(zf.newValue)};hd.kd=function(){(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||hd.$k)&&hd.set_visible(!1)};hd.xyf=function(){hd.QGa=null;hd.U8=null};hd.ii=function(){hd.$k&&hd.Ksb()};hd.onFunctionInfoLoaded=function(){hd.Sob()};hd.Rya=function(){hd.Dka?(hd.U8=null,hd.QGa=null,hd.Sob()):hd.uh.Mk&&hd.gte()};
hd.Qca=function(){hd.HQ&&tb(hd.$,hd.HQ.HelpId,hd.HQ.IsDynamicUdf);return!0};hd.Ksb=function(){hd.$k&&hd.Qud();hd.AK&&hd.Ya.isEditing&&hd.hna();hd.Zq=null;hd.formulaAssistanceUIControl&&(hd.formulaAssistanceUIControl.dismiss(hd.I0b),hd.rr.canReceiveFocus=!1);hd.Znd=!1};hd.oDf=function(){hd.AK&&hd.hna();hd.T4f();1===hd.jOd.type&&We.EwaSettings.Fb()&&!hd.Ya.text.includes("\n")&&hd.KFd(hd.jOd)};hd.onDismiss=function(){hd.isListVisible=!1;Je.g(hd.$).kk.textBox.focus()};hd.LRa=function(){var Ke={};hd.Ef.Dic?
Ke[oa.a.HV]="SmartSuggestionsCard":Ke[oa.a.HV]="FunctionAndSmartSuggestionsCard";hd.$.Zd(802602464,0,8,Ke)};hd.OAd=function(Ke,zf){hd.Ef.zeg(zf);hd.$k&&(hd.PIa=!0)};hd.NAd=function(Ke){hd.$k&&(hd.fua=!0);hd.AK?(hd.JBe(),Je.g(hd.$).kk.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Ke.textEdit?hd.arb(Ke.textEdit):hd.kz(!0)};hd.gridView=Je.g(l);hd.domElement.className=Ji.a.ANe;hd.uh=Qb.d4c(l,Y);hd.w6b=new Ub(l);hd.Pxg=Y;Aa.uld||(Aa.uld=Aa.oKa());hd.domElement.innerHTML=Aa.uld;hd.Ozd=
RegExp("\\d+");Sg.d(hd.style,hd.$.isChromeRtl);hd.Aja=new Db(hd.$,hd.domElement,hd.functionInfoManager,hd.formulaAssistanceUIControl,hd.formulaAssistanceTelemetryManager,hd.pluginScheduler);J=$get(Cb.cdd,hd.domElement);Y=$get(Cb.Xcd,hd.domElement);za=$get(Cb.edd,hd.domElement);hd.Cpg=new Na(hd.$,J,za,Y,hd);hd.uh.EZb(hd.Rya);hd.functionInfoManager.fZa(hd.onFunctionInfoLoaded);hd.functionInfoManager.EFg(hd.xyf);hd.I0b=hd.domElement;hd.$k&&(hd.$.xa.zg(hd.ii),hd.Ef.hWc(hd.oDf),We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&(hd.I0b=document.createElement("div")));hd.oTa(!0);hd.d8f(!0);hd.$.domElement.appendChild(hd.I0b);hd.iRc=0;(Y=Rk.a(l))&&hd.cKa.push(new Fa(l,Y,hd,hd.formulaAssistanceTelemetryManager));hd.cKa.push(new Fa(l,hd.gridView.rc,hd,hd.formulaAssistanceTelemetryManager));hd.Uub=hd.cKa[0];hd.nqb=hd.cKa[hd.cKa.length-1];l.da.Ga(221,hd);hd.instantaneousSupportInformationManager||hd.$.da.$a(268,function(Ke){hd.instantaneousSupportInformationManager=Ke});hd.hTe=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1);We.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===hd.formulaAssistanceTelemetryManager.Jna.anyPluginInitialized?Cd.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):hd.formulaAssistanceTelemetryManager.Jna.anyPluginInitialized||(hd.fDb=We.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));hd.mBa=og.a.NMa(hd.$);hd.Uyc=og.a.Srd();
hd.pzd=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");og.a.IR()&&hd.Vmd();og.a.qN(hd.$)&&J.classList.add("ewa-fb-refactor");hd.$k?Je.g(hd.$).ha.WG(hd.kd):Je.g(hd.$).ha.bZ(hd.kd);hd.rr=new rb(hd.$,hd.formulaAssistanceUIControl,1,Xi.a.Fcd,hd.ajd);hd.Dod=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);hd.ief=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");return hd}function qa(){}function wa(){this.caretPosition=
this.content=null}function Ta(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function sb(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function db(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function kb(){this.b$=this._name=null}function ac(){this._name=null}function ta(){this._name=null}function ra(){this.b$=this._name=null}function Na(l,J,
Y,za,Ua){l=N.call(this,l,J)||this;l.Gra=null;l.Hvc=0;l.rMb=0;l.I3b=null;l.HWe=Y;l.avb=za;l.formulaAssistanceControl=Ua;l.Gq=[];l.fX=[];l.$k=og.a.D5();l.fgf=l.$k&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return l}function gb(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=this.isPrefixed=this.detail=this.type=null}function ob(l,J){this.$=l;this.items=J;this.NMa=og.a.NMa(this.$)}function wb(l,J){this.m1i=l;this.Bsf=J}function Oa(){}
function sa(l){this.index=l}function Fa(l,J,Y,za){l=xj.call(this,l,J)||this;l.formulaAssistanceControl=Y;l.formulaAssistanceTelemetryManager=za;l.BFf=!1;l.DSa=null;l.dmd=0;l.GGc=null;l.vIa=null;l.IQ=0;l.dpb=J.textBox;l.$k=og.a.D5();l.saj=We.EwaSettings.Fb();return l}function Wa(){this.oia=this.lta=this.mta=!1;this.PFf=40;this.FAe=41;this.w0a=this.DDd=this.EDd=this.aGb=0;this.Pwf=!0;this.hCd=!1;this.XUe=this.VNd=-1}function Db(l,J,Y,za,Ua,Qb){var uc=jl.call(this,Db.oKa(og.a.D5()))||this;uc.$=l;uc.Oj=
J;uc.functionInfoManager=Y;uc.formulaAssistanceUIControl=za;uc.formulaAssistanceTelemetryManager=Ua;uc.pluginScheduler=Qb;uc.j2a=null;uc.q3=0;uc.rr=null;uc.BXc=!1;uc.Zq=null;uc.xla=null;uc.zSa=!0;uc.CR=!1;uc.onCardModeChange=function(ed){uc.oOb(ed);1===ed?uc.formulaAssistanceTelemetryManager.B$.argumentAssistanceCollapseCounter++:uc.formulaAssistanceTelemetryManager.B$.argumentAssistanceExpandCounter++};uc.LRa=function(ed){var Dd={};Dd[oa.a.HV]="ArgumentAssistanceCard";var hd={};hd.FunctionName=ed.functionName;
Dd[oa.a.Dad]=hd;uc.$.Zd(802602464,0,8,Dd)};uc.onDismissClick=function(){uc.formulaAssistanceTelemetryManager.B$.argumentAssistanceDismissCounter++;uc.zSa=!1;uc.Jsb();uc.CR&&uc.pH.clear();0===uc.q3&&uc.oOb(1)};uc.Ng=function(){uc.zSa=!0;uc.CR&&uc.pH.clear()};uc.ELi=function(ed){ed.button===Sys.UI.MouseButton.leftButton&&ed.target&&(Fh.g(ed),uc.j2a&&uc.j2a.roa(ed))};uc.ot=function(){void 0!==uc.Zq&&null!==uc.Zq&&uc.Zq()};uc.$k=og.a.D5();uc.Mba=uc.$k&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",
!1);uc.$k?(uc.KPd(),uc.rr=new rb(uc.$,uc.formulaAssistanceUIControl,0,Xi.a.Ccd),uc.Mba&&Je.g(uc.$).Ac.To(uc.Ng),uc.CR=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!uc.formulaAssistanceUIControl,uc.CR&&(uc.pH=new pc(uc.formulaAssistanceUIControl,uc.formulaAssistanceTelemetryManager)),We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",
!1)&&uc.$.domElement.appendChild(uc.domElement)):(uc.j2a=new nc(uc.domElement,uc.$.FE,void 0,og.a.qN(uc.$)),uc.Fc.ka("mousedown",uc.ELi),l=$get(Cb.cdd,uc.Oj),uc.Oj.insertBefore(uc.domElement,l));Je.g(uc.$).view.Ts(uc.ot);return uc}function pc(l,J){this.Z$b=l;this.formulaAssistanceTelemetryManager=J;this.wn=!1;l={};this.usageCount=(l[ak.Drag]=0,l[ak.Move]=0,l);this.JDc=this.Z$b.getWindowEdgeBuffer()+1;this.zrf=new eb(this);this.xKe=new lc(this)}function lc(l){this.pH=l;this.wn=!1}function eb(l){var J=
this;this.pH=l;this.r_=this.PRd=this.wn=!1;this.onKeyDown=function(Y){return!J.r_&&Y.keyCode===Aj.a.hpa&&Y.altKey&&Y.ctrlKey?(J.E8b(),Y.stopPropagation(),Y.preventDefault(),!0):!1};this.zNa=function(Y){if(!J.r_)return!1;if(Y.eventName===Bg.a.Xb){var za=Y.Ca.ctrlKey?1:Y.Ca.shiftKey?50:10;switch(Y.Ca.keyCode){case Aj.a.AUa:J.w6(0,-za);break;case Aj.a.fpa:J.w6(0,za);break;case Aj.a.gpa:J.w6(-za,0);break;case Aj.a.cgb:J.w6(za,0);break;case Aj.a.UL:case Aj.a.ei:J.PRd=!0;break;default:return!1}}Y.eventName===
Bg.a.Sd&&J.PRd&&J.J4(!0);Y.Ca.preventDefault();return!0};this.wGb=function(Y){if(!J.r_)return!1;Y.Ca.preventDefault();J.J4();return!0};this.onBlur=function(){if(!J.r_)return!1;J.J4();return!0};this.xr=Bk.KeyInputManager.instance;this.pointerInputManager=ik.a.instance}function ib(){this.content=null;this.caretPosition=0}function cc(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function Pa(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function nc(l,
J,Y,za){za=void 0===za?!1:za;J=Dh.call(this,l,J,!1,void 0===Y?null:Y)||this;J.kSa(za);J.lj=da.a.equals("rtl",l.dir,!0);return J}function pb(l,J){var Y=oi.call(this)||this;Y.Hpg=[];Y.gdd={};Y.KWe={};Y.VT=null;Y.r9=[];Y.lKa={};Y.Myf=function(za,Ua){Cd.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");Y.yyf(za,!!Ua&&1!==Ua.FilterType,!0)};Y.Lyf=function(){Cd.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");
Y.VT=null};Y.vyf=function(za){Cd.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");Y.xId(za.Hja,!0,!1)};Y.Kyf=function(za){Cd.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");Y.yyf(za,!0,!1)};Y.MLc=!1;Y.KLc=!1;Y.wb=l;Y.pluginScheduler=J;Y.$.da.Ga(19,Y);return Y}function rb(l,J,Y,za,Ua){this.v_c=!1;this.$=l;this.formulaAssistanceUIControl=J;this.gWe=Y;this.zmj=za;this.G6e=void 0===Ua?null:Ua}function Ya(l,J,Y){var za=
Yi.call(this)||this;za.ddd=l;za.kOd=J;za.oXi=Y;return za}function ec(l){var J=Th.call(this)||this;J.kOd=l;return J}function yd(l,J){var Y=Lh.call(this)||this;Y.functionName=l;Y.ddd=J;return Y}function Ub(l){this.WHe={};this.$=l}function Ob(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function Yb(l){this.ZT=0;this.c$d=!1;this.wWa=this.yae=null;this.Zrg=void 0===l?!1:l;this.textEdit=null}function xb(l){var J=this;this.$rb=this.Yha=this.calcManager=this.Ya=null;this.c$a=function(){J.L5a(!1,
!1)};this.$=l;this.Tub=new Tb(l);this.X$b=new Fb(l);this.Y$b=new Sa(this);Je.g(l).rc.To(this.c$a);this.$.da.Ga(317,this)}function Sa(l){this.p8=0;this.Dcd=l}function Tb(l){this.Qqa=this.qTa=this.J2a=this.yQ=this.haa=this.Ya=null;this.dkd=!1;this.Rc=l}function Cc(){}function Fb(l){var J=this;this.bAi=30;this.calcManager=null;this.Od=!1;this.zPa=this.mGb=this.kab=null;this.mD=function(){J.$ha.v_()};this.$=l;this.$ha=new cd;this.vTf=-1;this.$.ea.VG(this.mD)}function hc(l,J,Y,za,Ua,Qb,uc){uc=l.Na(1,void 0===
uc?null:uc);uc.getPartialCalcResultsParameters=J;return Td.i(l,"GetPartialCalcResults",uc,Y,za,Ua,Qb,4)}function cd(){this.iRa={}}function mb(l){var J=Oi.call(this)||this;J.$=l;J.Tb();return J}function $a(l,J){var Y=this;this.kKa=this.gva=this.Bja=null;this.eCf=function(za,Ua){Y.A6i(Ua.functionName,Ua.ddd)};this.gCf=function(za,Ua){Y.z6i(Ua.ddd,Ua.kOd,Ua.oXi)};this.fCf=function(za,Ua){za=[];Ua=Cl(Ua.kOd);for(var Qb=Ua.next();!Qb.done;Qb=Ua.next())Qb=Qb.value,(!Y.Swa||void 0!==Qb&&null!==Qb)&&(Qb=
Qb.trim())&&za.push(Qb);if(!Y.Swa||za.length){Ua="";for(Qb=0;Qb<za.length;Qb++){var uc=Y.FZc(za[Qb]),ed=$a.bFd(Qb,za.length);Ua+=uc+ed;ed&&(Ua+=Y.ariaLiveNotifier.eya)}Y.ariaLiveNotifier.readText(Ua)}};this.hCf=function(za,Ua){Y.ariaLiveNotifier.C6i(Ua.iG,Ua.description,Ua.selectedIndex.toString(),Ua.length.toString())};this.aCf=function(za,Ua){Y.ariaLiveNotifier.WMf(Ua.description,Ua.length)};this.ryf=function(){Y.ariaLiveNotifier.jbb(se.a.instance.fa(875),oa.a.SZa)};this.kyf=function(){Y.ariaLiveNotifier.readText(se.a.instance.fa(876))};
this.nyf=function(){Y.ariaLiveNotifier.readText(se.a.instance.fa(877))};this.$=J;this.ariaLiveNotifier=l;this.$.da.Ga(219,this);this.Swa=og.a.D5()}function K(l){return fj.call(this,l)||this}function ba(l,J,Y){var za=this;this.$=l;this.Sa=J;this.functionInfoManager=Y;this.qGh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){za.menuId&&Array.contains(za.qGh,
za.menuId)&&za.frame.Wv(za.menuId)};if(this.uB=og.a.uB(this.$))this.formulaAssistanceManager=this.$.da.Aa(464);this.CM={};this.frame=this.$.frame;this.functionInfoManager.fZa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=l.da.Aa(491)}function ua(l,J){var Y=Ih.call(this,l,se.a.instance.fa(1013),void 0,void 0,void 0,We.EwaSettings.ma(399))||this;Y.jKa=null;Y.Gja=null;Y.iKa=null;Y.cvb=null;Y.EWe=null;Y.Fja=null;Y.FWe=null;Y.IWe=null;Y.qmf=null;Y.bvb=null;Y.tkd=!1;Y.e2b=null;Y.y6=
null;Y.Jxb=null;Y.onFunctionInfoLoaded=function(){if(!Y.iKa.count){for(var za=Y.functionInfoManager.Wcd,Ua=0,Qb=za.length;Ua<Qb;++Ua)Y.iKa.tM(za[Ua],za[Ua],!1).className=$c.a.Koh;Y.iKa.selectedIndex=0;hh.a.yc([Y.e2b,Y.y6,Y.Jxb]);Y.e2b=Y.de.Wd(Y.jKa);Y.y6=Y.de.Wd(Y.Gja);Y.Jxb=Y.de.Wd(Y.bvb);Y.e2b.ka("change",Y.wyf);Y.y6.ka("change",Y.FLi);Y.y6.ka("dblclick",Y.GLi);Y.Jxb.ka("click",Y.Qca);Y.Jxb.ka("keyup",Y.HNi);id.DOMElementExtensions.setVisible(Y.Gja,!0);id.DOMElementExtensions.setVisible(Y.EWe,!1);
Y.$.S5c&&id.DOMElementExtensions.setVisible(Y.qmf,!0)}Y.wyf(null);Y.getButton(0).get_element().disabled=!1;Y.jKa.disabled=!1;Y.cSa();Y.tkd=!0};Y.Qca=function(){Y.qaa&&tb(Y.$,Y.qaa.HelpId,Y.qaa.IsDynamicUdf)};Y.HNi=function(za){13!==za.keyCode&&32!==za.keyCode||Y.Qca(za)};Y.wyf=function(){var za=Y.functionInfoManager.Fbc(Y.iKa.we.value);Y.mva(za);Y.Gja.scrollTop=0;Y.DZf()};Y.FLi=function(){Y.DZf()};Y.GLi=function(za){Y.qaa&&(Fh.g(za),Y.close(0))};Y.qd=function(za,Ua){Pc.b(Ua)&&Y.Ut()};Y.functionInfoManager=
l.da.Aa(19);Y.formulaAssistanceControl=l.da.Aa(221);Y.Ecd=og.a.uB(Y.$);Y.Ecd&&(Y.formulaAssistanceManager=l.da.Aa(464));Y.eJa=J;Y.a0c=J.textBox.caretPosition;return Y}function La(l){var J=bd.call(this,l)||this;J.BWe=function(Y,za){if(1===Y){J.hide();Y=new rh.a(-433697611,0,J.$.fd,8,null);var Ua={};za=(Ua[kg.a.ld]=za.functionName,Ua);J.$.Ka.$b(Y,za)}};J.onFunctionInfoLoaded=function(){J.functionInfoManager.Nbb(J.onFunctionInfoLoaded);J.yaf()};J.dwb=function(Y){Va(J.$,Y,!1)};J.jgf=function(Y){return!J.functionInfoManager.$gc(Y)};
J.Im=se.a.instance.fa(1013);J.functionInfoManager=l.da.Aa(19);J.jh();return J}function ub(l){var J=ze.a.l0,Y=l.da.Aa(368);Y&&!Je.g(l).Fj&&(J=Y.zoom);return J}function Va(l,J,Y){if(Y){if(J&&(!J||J.startsWith("http://")||J.startsWith("https://"))){if(l.ma(157)&&(l=l.da.Aa(269))&&l.YBa(J))return;md.HelperMethods.rf(J,"_blank",Vb.a)}}else md.HelperMethods.b7(l.xG,"XLWAEndUser_"+J,l.nT)}function tb(l,J,Y){if(l){var za=l.da.Aa(491);za?za.B$.argumentAssistanceLearnMoreCounter++:Cd.ULS.sendTraceTag(523551513,
0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");Y?Va(l,J,Y):(Y=new rh.a(-859308420,kg.a.Vb,l.fd,0,null),za={},J=(za[kg.a.ld]=oa.a.fW,za[kg.a.Ag]="HelpID="+J,za),l.Ka.$b(Y,J))}}function Cb(){}function nb(l){var J=fb.call(this)||this;J.$=l;J.Tb();return J}function Ib(l){var J=Ba.call(this,document.createElement("div"))||this;J.ZR=!1;J.qR=!1;J.u1b=!1;J.Ph=null;J.$h=null;J.Ihi=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");
J.Jhi=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");J.cqd=!1;J.Uqd=!1;J.iod=!1;J.h6b=[];J.Rh=function(){J.$3f(!1)};J.mPa=function(za,Ua){J.show(J.NR,!J.isListVisible,!0,Jj.a.xp||3===Ua.yb||3===kg.a.Vb);J.TAd(null,null)};J.TAd=function(){J.gridView.setFocus()};J.ULa=function(){J.Ya.textBox.tK=!0};J.ot=function(){J.eeg()};J.onContentReady=function(){J.$3f(J.isListVisible)};J.Zc=function(){J.ny()};J.eza=function(){J.WRa()};J.xxf=function(){J.eeg()};J.$=l;J.gridView=
Je.g(J.$);J.iJ=J.gridView.rc;var Y="<div id='dv_reader_description' class='"+tk.a.OOe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+Jc.Yoh+" "+D.a.gq+"'></div>\r\n<div id='dv_list_box' class='"+Jc.eoh+" "+D.a.lm+" "+D.a.gq+"'></div>\r\n<div id='dv_prompt_box' class='"+Jc.Woh+" "+D.a.gq+"'></div>";J.domElement.className=Jc.Xoh;J.domElement.innerHTML=Y;Sg.d(J.style,J.isGridRtl);J.dg=$get("dv_list_box",J.domElement);J.C0=$get("dv_prompt_box",J.domElement);J.Qsa=$get("dv_list_button",
J.domElement);J.dCb=$get("dv_reader_description",J.domElement);(Y=Rk.a(l))&&J.h6b.push(new Gc(l,Y,J));J.h6b.push(new Gc(l,J.gridView.rc,J));J.gridView.ha.FJ(J.Rh);J.gridView.Nt(J.onContentReady);J.gridView.Ac.mFg(J.xxf);J.$.Zk(J.Zc);Y=J.gridView.Oj;Y.insertBefore(J.domElement,Y.firstChild);J.onContentReady(null,null);l.da.Ga(14,J);return J}function hb(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd){var Ke=Wk.call(this,document.createElement("a"))||this;Ke.El=!1;Ke.vd=function(zf){Ke.raiseEvent("ClickButton",zf);return!0};
Ke.onKeyDown=function(zf){Ke.raiseEvent("KeyDown",zf);return!1};Ke.Vw=function(){Ke.hovered=!0;Ke.raiseEvent("PointerOver");return!1};Ke.dO=function(){Ke.hovered=!1;Ke.raiseEvent("PointerOut");return!1};Ke.onBlur=function(zf){Fh.g(zf);Ke.focused=!1;Ke.raiseEvent("Blur")};Ke.onFocus=function(zf){Fh.g(zf);Ke.focused=!0;Ke.raiseEvent("Focus")};Ke.glh=ed;Ke.jgh=Dd;Ke.oJ=hb.Bb(Ke.domElement,J,Y,za,Ua,Qb,uc,hd);Ke.Fc.ka("contextmenu",function(zf){Fh.g(zf)});Ke.enable();Ke.hovered=!1;Ke.focused=!1;l.appendChild(Ke.domElement);
return Ke}function zb(l,J,Y){l=al.call(this,l,J,new Vk.a(Jc.listItem,Jc.$Bb,Jc.eCb,Jc.fCb))||this;l.fmb=null;l.we=null;l.bea=null;l.FW=null;l.zIa=null;l.aOa=0;l.PFb=[];l.SRj=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");l.dCb=Y;return l}function Gc(l,J,Y){l=vk.call(this,l,J)||this;l.dataValidationControl=Y;return l}function Fc(l,J,Y){var za=wj.call(this,l)||this;za.MQ=null;za.zV=null;za.phf=!1;za.errorMessage=null;za.T8e=null;za.Gm=null;za.zea=null;za.bHe=
function(Ua){var Qb=za.$,uc=za.phf;za.hide();var ed=Je.g(Qb);ed.isEditing&&ed.rc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Ua&&uc&&Pg.TaskExtensions.Ba(ed.startEdit(!1,1),function(){var hd=ed.rc.textBox;hd.text&&hd.selectRange(0,hd.text.length)},za.la,11,Cf.a.current);if(1===Ua&&!uc){if(uc=ed.mc(null)){ed.Ea.mW();var Dd=Object(tg.a)(new Fi.a,{Text:uc.cell.userInput});ed.setCell(Dd,uc.range,0,63,null)}Qb.Zd(-798660877,kg.a.Vb,8,null)}2===Ua&&Pg.TaskExtensions.Ba(ed.startEdit(!1,
0),function(){var hd=ed.rc.textBox;hd.text&&hd.selectRange(0,hd.text.length)},za.la,11,Cf.a.current)};za.f$a=function(){md.HelperMethods.b7(za.$.xG,za.error.HelpTopicId,za.$.nT)};za.yNi=function(){za.Sxb();za.$.Zd(802602464,2,8,za.zV)};za.XLi=function(){Cd.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};za.YLi=function(Ua){!Ua||Bh.a(Ua)?Cd.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(Ua=za.eYh(Ua.Result),za.MQ.errorInformation=Ua,za.tOb(za.pJa,za.Ccc(za.bHe),za.MQ))};za.iBd=function(){za.show(za.nSb)};za.gNe=Y;za.sqmManager=hl.a(za.$);za.error=Fc.jR(J,l,Y);za.zb.$p=za;l=l.da.Aa(14);za.dv=l.e4a(za.gNe);za.pJa=za.dv&&za.dv.pJa?za.dv.pJa:se.a.instance.fa(1697);za.uqj();za.initializeAndShow(za.pJa,za.bHe,za.MQ);return za}function Ed(l,J,Y){var za=ek.call(this,l,Ed.jR(J,l,Y))||this;za.kd=function(){za.setFocus()};Je.g(za.$).ha.WG(za.kd);We.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&
(l=l.da.Aa(14).e4a(Y))&&l.options&1&&Cd.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return za}function Jc(){}function Ca(l){var J=tj.call(this)||this;J.$=l;J.Tb();return J}function bb(l,J){var Y=this;this.f_a=null;this.bCf=function(za,Ua){1<Ua.length&&(za=se.a.instance.fa(850),Y.ariaLiveNotifier.WMf(za,Ua.length))};this.cCf=function(za,Ua){Cd.ULS.shipAssertTag(537167961,0,0<=Ua.selectedIndex&&
0<=Ua.length&&Ua.selectedIndex<Ua.length,"Invalid ListEventArgs: SelectedIndex/Length");Cd.ULS.shipAssertTag(537167960,0,!!Ua.iG,"ListEventArgs: SelectedValue should not be null");Y.ariaLiveNotifier.B6i(Ua.iG,Ua.selectedIndex+1,Ua.length)};this.dCf=function(za,Ua){Y.ariaLiveNotifier.tQa(Ua.iG)};this.ariaLiveNotifier=l;We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)||J.Ga(213,this)}function dc(l){var J=gl.call(this)||this;J.$=l;J.Tb();return J}function Ac(l){var J=Mk.call(this)||
this;J.$=l;J.Tb();return J}function nd(l,J){var Y=this;this.MNa=1;this.dha=[];this.active=!1;this.Ww=function(){var za=Y.gridView.bid();if(!(0>=za||za===Y.MNa||Y.gridView.pq)){for(var Ua=!1,Qb=[],uc=[],ed=Y.dha.length-1;0<=ed;ed--){var Dd=Y.dha[ed];if(Y.aid(Dd)>za||Dd.bottom<za)Qb.push(Dd),Array.removeAt(Y.dha,ed),Ua=!0}for(ed=Y.tableManager.rangeList.length-1;0<=ed;ed--){Dd=Y.tableManager.rangeList[ed];var hd=Y.aid(Dd);hd<=za&&Dd.bottom>=za&&!(hd<=Y.MNa&&Dd.bottom>=Y.MNa)&&Dd.yba&&(uc.push(Dd),Ua=
!0)}if(Ua)for(Dd=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?Y.gridView.Lpc:[Y.gridView.L3],ed=Cl(Dd),Dd=ed.next();!Dd.done;Dd=ed.next())for(hd=Cl(Dd.value),Dd=hd.next();!Dd.done;Dd=hd.next()){var Ke=Cl(Dd.value);for(Dd=Ke.next();!Dd.done;Dd=Ke.next()){for(var zf=Dd.value,Dg=zf.Sn,Tg=Uk.a(zf.q5),Rg=Qb.length-1;0<=Rg;Rg--)Dd=Qb[Rg],Y.OAc(Dd,!1,Tg,Dg)&&Array.removeAt(Qb,Rg);for(Rg=uc.length-1;0<=Rg;Rg--)Dd=uc[Rg],Y.OAc(Dd,!0,Tg,Dg)&&Y.dha.push(Dd);
Ua&&zf.IPd(Tg)}}else Cd.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");Y.MNa=za}};this.nzf=function(za,Ua){Ua.isRow||Ua.rWc(Y.zLa)};this.ozf=function(za,Ua){Ua.isRow||(Y.tableManager.rangeList.length||Y.deactivate(),Ua.GKd(Y.zLa))};this.zLa=function(za,Ua){if(Y.ke())Y.activate();else if(za=Y.active,Y.deactivate(),!za){Cd.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");
return}(Ua=Ua.gu)&&Y.c6f(Ua.Sn[0],Ua.Sn[Ua.Sn.length-1],Ua.q5,Ua.Sn)};this.WBf=function(za,Ua){!Y.gridView.pq&&(Y.ke()?Y.activate():(za=Y.active,Y.deactivate(),za||Cd.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Ua=Ua.gu)&&(za=Uk.a(Ua.q5),Y.c6f(Ua.Sn[0],Ua.Sn[Ua.Sn.length-1],za,Ua.Sn)&&Ua.IPd(za))};this.He=function(){Y.gridView.rb.o5?Y.deactivate():Y.activate()};this.tableManager=l;this.gridView=J;this.$=J.$;l.Yoe(this.WBf);
J.KFg(this.nzf);J.LFg(this.ozf);this.$.xa.zg(this.He);this.$.Hb.zg(this.He);this.wse(function(za){za.rWc(Y.zLa)});this.ke()&&(this.activate(),this.Ww(this,null));this.$.da.Ga(68,this)}function qd(l){return Eg.call(this,l)||this}function Gb(l,J,Y,za,Ua,Qb,uc){var ed=this;this.$=l;this.gridView=J;this.Sg=Y;this.IB=za;this.borderFormatManager=Ua;this.moreColorsHelper=Qb;this.lcd=uc;this.$A=null;this.M_a=1461300262;this.Bx=this.J_a=this.m9a=this.W$b=null;this.fOi=function(Dd,hd){if(!Bh.a(Dd)&&hd){var Ke=
!!Dd&&!!Dd.RequestTelemetryData;Je.g(ed.$).Ki.Ola(hd,Dd.StateId,Ke?Dd.RequestTelemetryData.EcsOperationDuration:0,Ke?Dd.RequestTelemetryData.EcsRequestDuration:0,Ke?Dd.RequestTelemetryData.WfeRequestDuration:0)}};this.Gqb=function(){if(ed.gridView.R6a){var Dd=ed.$.da.Aa(254,!0);Dd&&Dd.fdj(ed.Gqb);ed.gridView.R6a=!1;ed.gridView.rg.No(oa.a.k5);ed.gridView.ha.qX(ed.Bcd);Je.g(ed.$).$.Bf()}};this.Bcd=function(){var Dd=ed.W$b;ed.W$b=tf.d(ed.$.xa.qa);if(Dd===ed.W$b)if(ed.gridView.ha.qX(ed.Bcd),(Dd=ed.$.da.Aa(254,
!0))&&Dd.u_c(36,Je.g(ed.$).ha.ta.selectedRanges)){Dd=new rh.a(1804571062,2,2,0,null);var hd={};ed.$.Ka.$b(Dd,(hd[oa.a.skipClipboardAccess]=!0,hd[oa.a.W0c]=!0,hd[oa.a.isFormatPainter]=!0,hd)).continueWith(function(){ed.Gqb()})}else ed.gridView.rg.iH(!1)};this.Fb=We.EwaSettings.Fb();this.Glc=new Oc(this.$,Y);this.cD=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Pm=We.EwaSettings.Pm();this.lu=og.a.lu()}function Oc(l,J){this.$=l;this.Sg=J;this.ZA=new ne(Je.g(this.$).Ea,
this.$);this.Wgf=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.fzb=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.hqd=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.yhc=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Uef=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");
this.yhi=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.Pif=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.hic=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.Wzb=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.zhc=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",
!1);this.Kki=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix")}function he(){this.scenario=0;this.cR=null}function Wd(){this.oRa=this.XGa=this.UNa=this.OTa=0}function rc(l,J,Y,za){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=l;this.targetSheetRange=J;this.fillRangeType=Y;this.fillRangeDirection=za}function gd(l,J,Y){var za=el.call(this,l)||this;za.Im=null;za.$6c=0;za.ddi=function(Ua,Qb){if(0===
Ua)Cd.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Ua={};var uc="",ed=1035996630;switch(Qb.selectedKey){case 0:uc=1896159024===za.Er?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:uc=1896159024===za.Er?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===za.Er?(uc="InsertRows",ed=-1113896058):(uc="DeleteRows",ed=1554436520);break;case 3:1896159024===za.Er?(uc="InsertColumns",ed=1415868706):(uc="DeleteColumns",
ed=674605324)}Cd.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",uc);Qb=new rh.a(ed,1,2,8,null);Ua[kg.a.ld]=uc;za.$.Ka.$b(Qb,Ua)}};za.Er=J;za.selectedRanges=Y;l=Object(S.a)(Kb.a,za.$.xa.qa);za.isRtl=l.displayRtl;return za}function kd(l,J,Y,za,Ua,Qb){var uc=this;this.o1d=!1;this.p1d=null;this.mEc=0;this.kj=null;this._state=0;this.moveNext=function(){try{for(uc._state=1;1===uc._state;)uc.Ru=uc.Ru()}catch(ed){uc.dispose(),
uc._state=3}};this.Cf=l;this.ICa=J;this.HCa=this.c1d=Ua;this.LPb=Qb;this.Ru=this.ZL;this.moveNext()}function Qc(l,J,Y,za,Ua,Qb,uc,ed){var Dd=this;this.jEc=0;this.r1d=this.nEc=!1;this.kj=this.t1d=null;this._state=0;this.moveNext=function(){try{for(Dd._state=1;1===Dd._state;)Dd.Ru=Dd.Ru()}catch(hd){Dd.dispose(),Dd._state=3}};this.Cf=l;this.ICa=J;this.Vhg=Ua;this.HCa=this.c1d=Qb;this.LPb=uc;this.b1d=ed;this.Ru=this.ZL;this.moveNext()}function de(l,J,Y,za,Ua){this.PVe=0;this.Apg=l;this.Bpg=J;this.Axg=
Y;this.fXb=za;this.PVe=void 0===Ua?0:Ua}function Xe(l){var J=this;this.menuId=null;this.Qub=0;this.DBi="+mn-lt";this.Iyi="+mj-lt";this.NQi=function(Y){J.Kgf=!0;J.STg=null;J.$.WC(function(za){za.ZPa("FontName_New")});Cd.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",Y))};this.wLi=function(Y,za,Ua){Cd.ULS.sendTraceTag(524042310,1,50,"FontDropdownHelper.onFontPreviewRequestComplete: Attempt to request FontUrl method: {0} has succeeded.",Ua);J.F0i(Y);J.Qub=2;J.oOf()};this.xLi=
function(Y,za,Ua){Cd.ULS.sendTraceTag(524042309,1,10,"FontDropdownHelper.onFontPreviewRequestFailed: Encountered errors for {0}.",Ua);J.Qub=3;J.oOf()};this.$=l;this.frame=this.$.frame;this.ngi=!!String.fromCodePoint&&!Jj.a.xf&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Kgf=!1;this.STg=null;this.Pm=We.EwaSettings.Pm();(this.lu=og.a.lu())&&this.pgj()}function ge(l){this.lv=l}function fc(){}function dd(l){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=
l}function oc(l){var J=Ek.call(this)||this;J.$=l;J.Tb();return J}function Zb(l){return Gi.call(this,l)||this}function Sc(l,J){var Y=this;this.dac=this.KGd=null;this.syf=function(){We.EwaSettings.ma(670)||Y.juc();if(Y.dac){var za=Hk.a(Pf.a.Ta.oe,Y.dac);Cd.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",za);Y.dac=null}Y.TFf()};this.$=l;this.gridView=Je.g(l);this.JF=J.i1a(this.$.domElement,500,
null,null);this.oLa=this.nLa=-1}function sd(l){this.freezeOptions=null;this.freezeOptions=l}function fd(){}function qc(l){var J=dk.call(this)||this;J.Jlj="formulaAssistance";J.$=l;J.Tb();return J}function vb(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function Pd(l){var J=ck.call(this)||this;J.$=l;J.Tb();return J}function Tc(l){var J=this;this.ZA=this.calcManager=this.Nl=this.SSa=null;this.yLi=function(Y,za){if(Y&&!Bh.a(Y)&&za){var Ua=!!Y&&!!Y.RequestTelemetryData;Je.g(J.$).Ki.Ola(za.toString(),
Y.StateId,Ua?Y.RequestTelemetryData.EcsOperationDuration:0,Ua?Y.RequestTelemetryData.EcsRequestDuration:0,Ua?Y.RequestTelemetryData.WfeRequestDuration:0)}};this.$=l;this.$.da.$a(268,function(Y){J.Nl=Y});this.aFh=new vf(Je.g(this.$).Ea,this.$);this.w3=new Xd(this.$,Je.g(this.$),this);this.$.da.$a(266,function(Y){J.calcManager=Y});this.Fb=We.EwaSettings.Fb();this.Pm=We.EwaSettings.Pm();this.PAb=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Hsd=
We.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.zK=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6247869_getNumberFormatRefactor");this.U7a=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.cqi=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function Ve(l,J){this.success=l;this.Bz=J}function kf(){this.cgg=this.xXj=!1;this.source=0;this.Lwa=this.eic=!1}
function of(l,J,Y,za,Ua){Y=void 0===Y?null:Y;za=void 0===za?null:za;Ua=void 0===Ua?null:Ua;Cd.ULS.shipAssertTag(537162128,0,!!(!!(null!=Y^!(void 0===za||null===za))^!(void 0===Ua||null===Ua))&&!(null!=Y&&void 0!==za&&null!==za&&void 0!==Ua&&null!==Ua),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=Y&&0>Y&&(Cd.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),Y=null);this.Nl=l;this.Eo=J;this.zpg=Y;this.Hya=za;this.dra=
Ua}function vf(l,J){this.ZA=null;this.Ea=l;this.a3a=J}function ne(l,J){this.Ea=l;this.a3a=J}function Ad(l,J,Y){this.success=l;this.TOa=void 0===J?null:J;this.reason=void 0===Y?"":Y}function Xd(l,J,Y){var za=this;this.vda=[];this.calcManager=this.Mzc=this.lastSetCellInstantaneousOperation=null;this.$=l;this.grid=J;this.Sg=Y;this.pda=Xd.JHe;this.$.da.$a(268,function(Ua){za.Mzc=Ua});this.$.da.$a(266,function(Ua){za.calcManager=Ua});this.PAb=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",
!1);this.Hsd=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.bqi=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function ee(l,J,Y,za){this.rangeDelta=l;this.stateId=J;this.isFinished=Y;this.priorityGroup=za}function Le(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd,Ke,zf,Dg,Tg,Rg,Yh,Li,Mh,Uj,zj,Nf,jh,ei,Uh,Ri){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=
this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;
this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===l?0:l;this.numberOfNonUpdatedCells=void 0===J?0:J;this.numberOfUpdatedCells=void 0===Y?0:Y;this.numberOfCellsUpdatedAlreadyByServer=void 0===za?0:za;this.numberOfCellsSkippedDueToTimeout=void 0===Ua?
0:Ua;this.numberOfCellsWithNoFormattedCell=void 0===Qb?0:Qb;this.numberOfUnsupportedErrorCellTypes=void 0===uc?0:uc;this.numberOfUnsupportedBlankCellTypes=void 0===ed?0:ed;this.numberOfUnsupportedRichCellTypes=void 0===Dd?0:Dd;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===hd?0:hd;this.totalExecutionTime=void 0===Ke?0:Ke;this.originalProcessingTimeLimit=void 0===zf?0:zf;this.newProcessingTimeLimit=void 0===Dg?0:Dg;this.numberOfEditedRecalcedCellsInBatch=void 0===Tg?0:Tg;this.numberOfDependentRecalcedCellsInBatch=
void 0===Rg?0:Rg;this.isNewTask=void 0===Yh?!1:Yh;this.lastSetCellInstantaneousOperation=void 0===Li?"":Li;this.taskId=void 0===Mh?0:Mh;this.isNewNumberFormatter=void 0===Uj?null:Uj;this.numberOfRecalcedCellsWithFormattedValue=void 0===zj?null:zj;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===Nf?null:Nf;this.totalNumberFormatterTime=void 0===jh?null:jh;this.newNumberFormatterFinalizeFailures=void 0===ei?null:ei;this.numberOfMeasureTextWidthCalls=void 0===Uh?null:Uh;this.numberOfHashFormattedValues=
void 0===Ri?null:Ri}function Jf(){}function $f(l,J,Y,za,Ua){this.oQ=void 0===l?0:l;this.cellValue=void 0===J?"":J;this.ifmt=void 0===Y?0:Y;this.priorityGroup=void 0===za?"":za;this.Bz=void 0===Ua?"":Ua}function Dc(l){l=Sd(l);if(0===l)return 1;if(1===l)return 2;Cd.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function Sd(l){if(l.priorityGroup===gg.editCell)return 0;if(l.priorityGroup===gg.dependentCell)return 1;Cd.ULS.sendTraceTag(537162183,
0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function te(l,J){var Y=Sd(J),za=!(void 0===J.rangeDelta.data.format||null===J.rangeDelta.data.format);Cd.ULS.shipAssertTag(537162187,0,0===Y||!za,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",J.priorityGroup);l=Math.max(l.cell.Ck,0);za&&(za=excelOnlineCalc.calc.getCellFormatKind(J.rangeDelta.data.format.format),"number"===za?l=J.rangeDelta.data.format.format:"string"===
za?Cd.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===za?Cd.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Cd.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return l}function rd(l){var J=l.value;switch(l.type){case 2:return void 0===J||null===J?"":J;case 1:return l=parseFloat(J),isNaN(l)?null:l;case 3:return l=parseFloat(J),
isNaN(l)?null:1===l;case 4:return l=parseFloat(J),isNaN(l)?null:excelOnlineCalc.calc.errorValue(l);default:return excelOnlineCalc.calc.blankValue}}function Ue(l){l=excelOnlineCalc.calc.getCellValueKind(l.rangeDelta.data.value);var J=0;switch(l){case "number":J=1;break;case "string":J=2;break;case "boolean":J=3;break;case "Error":J=4;break;case "Blank":J=0;break;default:Cd.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",l)}return J}function ef(l,
J){l=excelOnlineCalc.calc.getCellValueKind(l.rangeDelta.data.value);switch(l){case "number":case "string":case "boolean":return!0;case "Blank":if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;J.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;J.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return J.numberOfUnsupportedRichCellTypes++,
!1;default:return Cd.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",l),!1}}function pe(l){if(l=l.color){if("String"===Object.getType(l).getName())return Gd.a.iq(l);if("Number"===Object.getType(l).getName())return null}else return null;Cd.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function Ne(l){switch(l.alignment){case "Center":return 2;case "Left":return 1;
case "Right":return 3;default:return Cd.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function gg(){}function ie(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd,Ke,zf,Dg){zf=void 0===zf?null:zf;Dg=void 0===Dg?null:Dg;ed=Zc.call(this,11,0,ed,Ke)||this;ed.$Eh=l;ed.Acd=J;ed.format=za;ed.activeCell=Y;ed.pse=Ua;ed.MHf=Qb;ed.HHf=uc;ed.EFa=Dd;ed.clientCorrelationId=hd;ed.Amb=zf;ed.Vib=Dg;return ed}function Re(){}function Ig(l){var J=Wf.call(this)||
this;J.NSb=null;J.$=l;J.Tb();return J}function Lf(l){var J=xk.call(this)||this;J.uJf=0;J.sH=null;J.w_g=function(Y,za){if(1===Y&&J.sH.FileCollectionErrorStateId){Y=J.$.na.va;var Ua=J.sH.MessageId,Qb=J.sH.OriginalEcsServerId,uc=J.sH.FileCollectionErrorStateId,ed=Y.Na(0);ed.errorMessageId=Ua;ed.ecsServerId=Qb;ed.fileCollectionErrorStateId=uc;ed.userComment=za;Y.o_c("CollectFile",ed,null,null,null,null,0)}J.raiseEvent("fileCollectionComplete",null,J)};J.$=l;return J}function qf(l){var J=qk.call(this,
!1,!1,qf.Hu)||this;J.mwd=!1;J.zpf=!0;J.Hof=0;J.jc=1;J.Bc(1,CommonUIStrings.l_Send);J.Bc(0,CommonUIStrings.l_NoThanks);J.gg=vg.wjg;J.Aof=l;J.Oe=qf.tTg;return J}function vg(){}function jc(l){return mj.call(this,l)||this}function zc(){}function Md(l,J,Y,za){var Ua=Qj.call(this,l)||this;Ua.tDb=null;Ua.Jlc=null;Ua.Cfc=null;Ua.T3=null;Ua.Tka=!1;Ua.disposed=!1;Ua.wNa=!1;Ua.mh=null;Ua.SAd=function(Qb){Cd.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(Ua.disposed)Cd.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(Bh.a(Qb)){Cd.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Qb?wg.a.Xc(Qb.Errors):null);if(Qb.Errors&&1===Qb.Errors.length){var uc=Qb.Errors[0].MessageId,ed=Ua.Ged(uc);if(ed){Ua.nzj(uc)?Ua.Auj(ed):Ua.Bs(ed);Ua.Ela("OkInvalidByServer",
Qb.Errors[0].MessageIdName);return}}Cd.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",wg.a.Xc(Qb.Errors))}Ua.Ela("OkValid","None");Ua.hide()}};Ua.T5c=function(Qb){Ua.sX(Qb);2!==Qb&&(Ua.mh=Ua.$.Ob.Hc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Qb?Ua.w$a():2===Qb?Ua.Oya():Ua.mma()};Ua.Rca=function(){Ua.pRj();Ua.wNa?Ua.$ze():Ua.X0c();return Ua.Tka=!1};Ua.selectedRanges=J;Ua.mSb=Y;Ua.command=
za;3===za&&(Ua.Tka=!0);Ua.jc=2;Ua.dw=!1;Ua.gg=Sb.gg;return Ua}function Ce(l,J){this.options=this.cellRange=null;this.cellRange=l;this.options=J}function ae(l,J){var Y=Dj.call(this,l)||this;Y.p$=null;Y.Nha=null;Y.KUa=null;Y.r$=null;Y.q$=null;Y.Pnc=function(){Y.p$.checked?(Y.Nha.disabled=!1,Y.KUa.disabled=!1,Y.r$.disabled=!1,Y.q$.disabled=!1):(Y.Nha.disabled=!0,Y.KUa.disabled=!0,Y.r$.disabled=!0,Y.q$.disabled=!0);return!1};Y.get_visible=Y.kka;Y.set_visible=Y.Xna;Y.Dk=J;Y.Fka();return Y}function ud(l,
J){var Y=kk.call(this,l)||this;Y.Fba=null;Y.ibf=null;Y.Hba=null;Y.Gba=null;Y.Qnc=function(){Y.Fba.checked?(Y.Hba.disabled=!1,Y.Gba.disabled=!1):(Y.Hba.disabled=!0,Y.Gba.disabled=!0);return!1};Y.get_visible=Y.kka;Y.set_visible=Y.Xna;Y.Dk=J;Y.Fka();return Y}function Rb(){}function Ie(l,J,Y,za){var Ua=Pj.call(this,l)||this;Ua.wub=null;Ua.XNd=null;Ua.Tka=!1;Ua.disposed=!1;Ua.wNa=!1;Ua.mh=null;Ua.YVj=function(Qb,uc){Ua.pbc(Qb);var ed=Ua.D_d();Qb=ed.errorString;var Dd=ed.Fq;if(ed.returnValue)return Ua.fMa(121,
Ua.aOh(Ua.$,uc),0,Ua.Q5,!1),"";Ua.Ela("OkInvalidByClient",Dd);return Qb};Ua.T5c=function(Qb){Ua.sX(Qb);Ua.mh=Ua.$.Ob.Hc("UserAction","DataValidationEditTimeToDialogTryClose");0===Qb&&Ua.mma()};Ua.selectedRanges=J;Ua.mSb=Y;Ua.command=za;3===za&&(Ua.Tka=!0);Ua.jc=2;Ua.dw=!1;return Ua}function pa(l,J,Y,za,Ua,Qb,uc,ed){ed=l.Na(9,void 0===ed?null:ed);ed.selectedRanges=J;ed.ruleOptions=Y;return Td.i(l,"CreateOrEditDataValidation",ed,za,Ua,Qb,uc,0)}function qb(l,J,Y){var za=vj.call(this,J)||this;za.Cwa=
null;za.dfc=null;za.BU=null;za.bL=null;za.nza=null;za.oza=null;za.d6a=null;za.$Na=null;za.Q$a=null;za.FPa=null;za.tpc=null;za.xDd=null;za.pDh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];za.pmj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];za.Onc=function(Ua){var Qb=!1;(null===Ua||void 0===Ua?0:Ua.Ca)&&(Ua.Ca.keyCode===Aj.a.hpa||Ua.Ca.keyCode===Aj.a.ei)&&(Qb=za.Rca(Ua),za.BU.blur(),
za.bL.blur());return Qb};za.Rca=function(){var Ua=za.BU.selectedIndex,Qb=za.bL.selectedIndex;za.tpc.innerText=za.Tvb(Ua,Qb);za.xDd.innerText=za.ohd(Ua,Qb);switch(Ua){case 0:return za.bL.disabled=!0,id.DOMElementExtensions.setVisible(za.Q$a,!1),id.DOMElementExtensions.setVisible(za.FPa,!1),id.DOMElementExtensions.setVisible(za.d6a,!1),id.DOMElementExtensions.setVisible(za.$Na,!1),za.Cwa.disabled=!0,!1;case 3:return za.bL.disabled=!0,id.DOMElementExtensions.setVisible(za.Q$a,!0),id.DOMElementExtensions.setVisible(za.FPa,
!1),id.DOMElementExtensions.setVisible(za.d6a,!0),id.DOMElementExtensions.setVisible(za.$Na,!0),za.Cwa.disabled=!1;case 7:return za.bL.disabled=!0,id.DOMElementExtensions.setVisible(za.Q$a,!0),id.DOMElementExtensions.setVisible(za.FPa,!1),id.DOMElementExtensions.setVisible(za.d6a,!1),id.DOMElementExtensions.setVisible(za.$Na,!1),za.Cwa.disabled=!1;default:za.Cwa.disabled=!1,id.DOMElementExtensions.setVisible(za.Q$a,!0),id.DOMElementExtensions.setVisible(za.$Na,!1)}switch(Qb){case 0:case 1:id.DOMElementExtensions.setVisible(za.FPa,
!0);break;default:id.DOMElementExtensions.setVisible(za.FPa,!1)}za.bL.disabled=!1;za.tpc.disabled=!1;id.DOMElementExtensions.setVisible(za.d6a,!1);id.DOMElementExtensions.setVisible(za.$Na,!1);return!1};za.get_visible=za.kka;za.set_visible=za.Xna;za.YR=new P.a;za.YR.add(se.a.instance.fa(1637));za.YR.add(se.a.instance.fa(1638));za.YR.add(se.a.instance.fa(1641));za.YR.add(se.a.instance.fa(1639));za.YR.add(se.a.instance.fa(1640));za.YR.add(se.a.instance.fa(1642));za.YR.add(se.a.instance.fa(1643));za.YR.add(se.a.instance.fa(1644));
za.YR.add(se.a.instance.fa(1645));za.YR.add(se.a.instance.fa(1646));za.YR.add(se.a.instance.fa(1647));za.YR.add(se.a.instance.fa(1648));za.YR.add("");za.$=l;za.Dk=Y;za.Fka();return za}function Sb(){}function $b(l,J){var Y=this;this.VB=this.C1a=this.selectedRanges=null;this.OKe=!1;this.mh=null;this.WLi=function(za){Cd.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!za||Bh.a(za)?Cd.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(Y.C1a=za.Result,Y.Y0i())};this.ozh=function(za){Y.sX("DataValidationEdit.ExpandExisitngDialog",za);Y.VB.c=$b.Mia(za);1===za?Y.bIa(new tc(Y.C1a)):2===za?Y.bIa(new tc):Y.Tnf()};this.UWi=function(za){Y.sX("DataValidationEdit.OverrideExisitngDialog",za);Y.VB.c=$b.Mia(za);1===za?Y.bIa(new tc):Y.Tnf()};this.$=l;this.U5c=J}function tc(l){this.L5=(l=void 0===l?null:l)?l.IsIgnoreBlank:!0;this.N5=l?l.IsInCellDropDown:!0;this.fO=l?l.LowerBoundary:"";this.gO=l?l.UpperBoundary:"";this.MB=l?l.ConditionType:0;
this.ruleType=l?l.RuleType:0;this.x_=l?l.IsAlertBlocking:!0;this.AU=l?l.AlertTitle:"";this.zU=l?l.AlertMessage:"";this.jW=l?l.InputMessage:"";this.rF=l?l.InputTitle:"";this.a6=l?l.IsShowErrorAlert:!0;this.b6=l?l.IsShowInputMessage:!0}function ld(l){switch(l){case 0:l="AnyValue";break;case 1:l="WholeNumber";break;case 2:l="Decimal";break;case 3:l="List";break;case 4:l="Date";break;case 5:l="Time";break;case 6:l="TextLength";break;case 7:l="Custom";break;default:l="Unknown"}return l}function Vc(l){switch(l){case 0:l=
"Between";break;case 1:l="NotBetween";break;case 2:l="Equal";break;case 3:l="NotEqual";break;case 4:l="GreaterThan";break;case 5:l="LessThan";break;case 6:l="GreaterThanOrEqual";break;case 7:l="LessThanOrEqual";break;default:l="Unknown"}return l}function Se(l){var J=pk.call(this)||this;J.$=l;J.Tb();return J}function Ge(l,J,Y){var za=this;this.Lyc={};this.Od=!1;this.il=function(Ua,Qb){za.showContextMenu(void 0===Qb?null:Qb)};this.Lwf=function(Ua,Qb){Qb.TAi===Ge.D2h&&Je.g(za.$).focus()};this.n0=function(Ua,
Qb){Ua=za.$.Ka.hba(Qb.Td.command);(null===Ua||void 0===Ua?0:Ua.dismissesContextualUI)&&za.j4()};this.J6=function(){za.$.da.oV(342);Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.create(za.$.da,338,za.$.la,3),function(Ua){Ua=Ua.result;for(var Qb=Cl(za.Lyc),uc=Qb.next();!uc.done;uc=Qb.next())uc.value.NOf(Ua)},za.$.la)};this.$=l;this.contextMenuController=Y;this.E7d=new Af(this.$);l.da.Ga(8,this);for(Y=0;Y<J.length;Y++)this.Lyc[Ge.a3g[Y]]=J[Y];this.ha=Je.g(l).ha;this.ha.AZb(this.il);this.$.Ka.hGa(this.Lwf);
Ti.a.instance.Rtj();We.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.dGa(this.n0);We.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.g3(this.J6)}function Af(l){this.cUe=null;this.$=l;this.k9a=new Xf;We.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.cUe=new jf(this.$))}function jf(l){var J=
this;this.g_a=null;this.bSd=!1;this.RBb=0;this.D9c=1;this.tNe=0;this.JEb=function(Y){J.lLf(Y.domElement,Y.hashCode)};this.bPf=function(Y){for(var za=0;window.performance.now()-Y<J.Ymh&&0<J.g_a.length;)J.dne(J.g_a.shift()),za++;Cd.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",J.D9c,za,J.g_a.length);0<J.g_a.length?J.RBb=window.requestAnimationFrame(J.bPf):(Cd.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",J.D9c,window.performance.now()-J.tNe),J.D9c++,J.RBb=0)};this.onPointerDown=function(Y){Wc.a.slim(Y.Ca.rawEvent);return!1};this.$=l;this.gridView=Je.g(this.$);this.C$h();this.Ymh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function Ef(){this.ae=this.Vte=this.cell=null}function Xf(){this.gec={}}function ug(){this.menuModel=null;this.mGe=0}function Wb(){this.dictionary=this.Td=null}function Kc(l){var J=
mg.call(this)||this;J.xaf=!1;J.wmd=function(){var Y;(Y=J.$.da.Aa(342))?J.Eb(Y):J.$.WC(function(za){za.mfc().then(function(Ua){(Y=J.$.da.Aa(342))?J.Eb(Y):(Y=new Id(J.$,Ua),J.Eb(J.$.da.Ga(342,Y)))})})};J.$=l;J.Tb();return J}function Id(l,J){this.srb=J;this.$=l}function Bd(l){return Kg.call(this,l)||this}function oe(l,J,Y,za){l=ke.call(this,l,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,oe.kKj,!0,!1,oe.pJb,J,Y,!1,za)||this;l.t1a=0;l.ata=null;l.NKa=null;l.gLe=null;return l}function Hd(l,J,Y){this.type=
l;this.W2g=J;this.Er=Y}function we(l,J,Y,za){return Yd.call(this,l,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",J,Y,!0,za)||this}function df(l,J,Y,za){l=Xa.call(this,l,"PopulateSheetOpsContextMenu",274207288,-1497523576,Lb,!0,!1,"SheetTabContextMenuRootName",J,Y,!1,za)||this;l.ghc=!1;l.Fic=!1;return l}function sf(l,J,Y,za){J=lb.call(this,l,"PopulateRichTextContextMenu",679816325,1151222423,ya,!0,!1,ya,J,Y,!0,za)||this;J.grid=Je.g(l);return J}
function wf(l,J,Y,za){J=V.call(this,l,"PopulateTableFieldListContextMenu",-751848458,-1085236154,di,!0,!1,"TableFieldListContextMenuRoot",J,Y,!1,za)||this;J.H5b=null;J.Fzd=0;J.IVb=null;J.grid=Je.g(l);return J}function $e(){}function pf(l,J,Y,za){var Ua=$h.call(this,l,"PopulatePivotTableContextMenu",-1475408662,1114549926,nf,!0,!1,"PivotTableContextMenuRootName",J,Y,!0,za)||this;Ua.Gc=null;Ua.activeCell=null;Ua.w0d=null;Ua.Sic=!1;Ua.qpd=!1;Ua.expandCollapse=!1;Ua.refresh=!1;Ua.TZ=!1;Ua.$f=null;Ua.iA=
null;Ua.X0a=null;Ua.Db=null;Ua.Cab=null;Ua.Wba=!1;Ua.OMi=function(Qb){Qb&&!wg.a.rh(Qb.Errors)&&Ua.Gc&&(Ua.Gc.Yo=Qb.Result,Ua.DKb());Ua.showPivotTableContextMenu()};Ua.NMi=function(){};Ua.zQi=function(){Ua.lcb()};Ua.yQi=function(){Ua.lcb()};Ua.sHi=function(){Ua.lcb()};Ua.rHi=function(){Ua.lcb()};Ua.su=function(){Ua.OYd();Ua.Wba=!1};Ua.Uq=function(){if(Ua.Wba){Cd.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var Qb=Ua.Gc;Ua.grid.Rb.lp(Ua.grid.ha.ta.activeCell)!==Qb&&(Ua.lcb(),Ua.M7h())}};Ua.mih=new DOMParser;Ua.Xwj=!0;Ua.grid=Je.g(l);Ua.zlc=!0;return Ua}function bg(l,J,Y,za){return wc.call(this,l,"PopulatePivotContextMenu",2123758504,912277356,J,Y,za)||this}function Zd(l,J,Y,za){l=vd.call(this,l,"PopulateFieldWellContextMenu",1374696078,495005930,Yc,!0,!1,Yc,J,Y,!1,za)||this;l.cell=null;l.yo=null;l.Jo=null;l.externalSourceIndex=-1;l.R0d=-1;l.aTa=0;l.Zyc=-1;l.VL=null;l.isOlap=!1;l.cI=!1;l.c3a=!1;return l}
function Ma(l,J,Y,za,Ua,Qb,uc,ed,Dd){var hd=gc.call(this,Ua,se.a.instance.Ab(61),!0,2,!0)||this;hd.F3f=!0;hd.mke=null;hd.OSa=null;hd.oga=null;hd.psb=null;hd.P5c=null;hd.tSc=null;hd.mHi=function(Ke){xh.a.any(Ke.Errors,function(zf){return-103190598===zf.MessageId})&&hd.sTa.gij()};hd.wNi=function(Ke){Ke&&!Bh.a(Ke)&&(Ke=Ke.Result,hd.P5c.innerHTML=se.a.instance.fa(1064)+hg.a.Sf(Ke.ValueFieldSourceName),hd.isOlap&&!hd.cI?(hd.sTa.enabled=!1,hd.oga.activeTab=hd.oga.Wzc-1):(hd.sTa.enabled=!0,hd.oga.activeTab=
0),hd.sTa.Isj(Ke.PivotValueFieldSettingsSummarizeValueByInfo),hd.OSa.Jsj(Ke.PivotValueFieldShowValueAsInitialInfo),hd.kf())};hd.cell=l;hd.Jo=J;hd.externalSourceIndex=Y;hd.Zfg=za;hd.Td=Qb;hd.zia=uc;hd.isOlap=ed;hd.cI=Dd;return hd}function Hb(l,J,Y){Y=void 0===Y?null:Y;this.Dmb=this.Mmb=null;this.T1=-1;this.fk=l;this.QY=(void 0===J?null:J)||new P.a;this.Nxg=Y||new td;this.vFa=new P.a;l=0;J=Cl(this.QY);for(Y=J.next();!Y.done;Y=J.next()){Y=Y.value;this.vsd(this.T1)||(this.T1=l);var za=l++;this.vFa.add(new ic(document.createElement("li"),
Y.title,this.Q6g(za)))}}function ic(l,J,Y){this.fk=l;this.Tp=J;this.ZGc=Y;this.cga=document.createElement("a");Ja.a.Cwc(this.cga,this.Tp);Sys.UI.DomElement.addCssClass(this.cga,Lc.pIj);Sys.UI.DomElement.addCssClass(this.fk,Lc.oIj);this.fk.appendChild(this.cga);this.cga.tabIndex=0;this.WBc();yi.a.addHandler(this.fk,"click",this.ZGc);yi.a.addHandler(this.fk,"keyup",Object(ci.a)(this,this.E$a,"onTitleKeyUp"))}function Lc(){}function td(){}function pd(l){l=Cj.call(this,l)||this;l.Kee=null;l.get_visible=
l.kka;l.set_visible=l.Xna;l.Fka();return l}function Qe(){}function ff(l,J,Y,za,Ua,Qb,uc,ed){var Dd=xi.call(this,l)||this;Dd.JF=null;Dd.f6b=null;Dd.Q0b=null;Dd.o3d=null;Dd.p3d=null;Dd.M5d=null;Dd.Swf=function(){var hd=parseInt(Dd.f4.we.value,10);Dd.hVg(hd)?(Dd.IU.ao.disabled=!0,Dd.dQ.ao.disabled=!0,Dd.dQ.clear(),ff.Jcf(hd)?(Dd.IU.ao.disabled=!1,Dd.mOb(!0)):ff.Kcf(hd)?(Dd.IU.ao.disabled=!1,Dd.dQ.ao.disabled=!1,Dd.mOb(!0),Dd.Qlf()):Dd.mOb(!1)):(hd=wg.a.gd(1,0,0,1094,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Bj.a(Dd.$).Bs([hd]),Dd.f4.kij())};Dd.xHi=function(){0>Dd.IU.selectedIndex||Dd.dQ.ao.disabled||(Dd.mOb(!0),Dd.Qlf())};Dd.xNi=function(hd){Dd.JF.kTa();Dd.dQ.ao.style.overflowY="scroll";if(hd&&!Bh.a(hd)){hd=hd.Result;Dd.dQ.clear();for(var Ke=Cl(hd.BaseItems),zf=Ke.next();!zf.done;zf=Ke.next())zf=zf.value,Dd.dQ.tM(zf.DisplayString,zf.Id.toString(),zf.Id===hd.SelectedBaseItem);Dd.mOb(!1)}};Dd.get_visible=Dd.kka;Dd.set_visible=Dd.Xna;Dd.$=J;Dd.cell=Y;Dd.Jo=za;Dd.externalSourceIndex=Ua;Dd.Td=Qb;Dd.zia=uc;
Dd.cli=ed;Dd.aTj=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Dd.Fka();return Dd}function hf(){}function yg(l,J,Y,za,Ua){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=l;this.activeCell=J;this.pivotFieldTitle=Y;this.summarizeBy=za;this.showAsValueParameters=Ua}function bf(l,J,Y){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=
l;this.baseFieldIndex=J;this.baseItemIndex=Y}function Cg(){}function Gg(){}function xg(l,J,Y,za){return wc.call(this,l,"PopulateFieldListPivotMenu",-1793121409,1378457149,J,Y,za,th)||this}function wc(l,J,Y,za,Ua,Qb,uc,ed){ed=void 0===ed?ri:ed;var Dd=wh.call(this,l,J,Y,za,ed,!0,!1,"PivotFilterMenuRootName",Ua,Qb,!1,uc)||this;Dd.C5b=null;Dd.jkf=null;Dd.$mb=null;Dd.pivotData=null;Dd.Qzd=null;Dd.Pmc=null;Dd.UDb=0;Dd.v2b=0;Dd.eZ=0;Dd.csb=null;Dd.CMi=function(hd,Ke){if(Ke)if(Bh.a(hd))Dd.Owd(Ke,!1);else if(hd=
hd.Result){Dd.Nsb=xd.ggd(Ke,Dd.$,Dd.pivotData.cell,Dd.eZ);var zf=Dd.Oqf(hd.MenuModel.Sections);Dd.csb=zf;wc.DN.set(Dd.pivotData.cell,Ke,zf,Dd.eZ);ch.a(Dd.$).GGj(hd);Dd.Owd(Ke,!0)}};Dd.BMi=function(hd,Ke){Dd.Owd(Ke,!1)};Dd.zf=function(hd,Ke){wc.DN.Q7b(Ke.nd.hash)};Dd.Tm=function(hd,Ke){wc.DN.Q7b(Ke.nd.hash)};Dd.uda=null;Dd.Rzd=Dd.UDb=-1;Dd.Gye=Dd.v2b=-1;Dd.Gqe=Dd.eZ=0;Dd.ry=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");wc.DN||(wc.DN=new xd(Dd.$),Je.g(Dd.$).Ea.Ss(Dd.zf),Je.g(Dd.$).Ea.UG(Dd.Tm),
Je.g(Dd.$).Ea.oha(Dd.zf));return Dd}function jd(){this.cell=null;this.dataSourceIndex=0;this.Jo=this.pivotName=null}function xd(l){this.$=l;this.DN={}}function me(l,J,Y,za){l=cf.call(this,l,"PopulateFieldListContextMenu",-1045020714,-170383950,xe,!0,!1,xe,J,Y,!1,za)||this;l.yo=null;l.VL=null;l.z_=!1;l.cI=!1;l.isOlap=!1;l.vVd=!1;return l}function Ae(l,J,Y,za){l=Ze.call(this,l,J,Y,za,"PopulateChartContextMenu",-498523270,1640762262,Nc)||this;l.gBa=!1;l.rwa=!1;l.TZ=!1;l.refresh=!1;l.isPivotChart=!1;
return l}function Ze(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd){ed=void 0===ed?oa.a.U2g:ed;l=Ye.call(this,l,void 0===Ua?"PopulateFloatingObjectContextMenu":Ua,void 0===Qb?-2017893763:Qb,void 0===uc?1350204367:uc,ed,void 0===Dd?!0:Dd,void 0===hd?!1:hd,ed,J,Y,!0,za)||this;l.floatingObject=null;l.yb=0;l.zlc=!0;return l}function Bf(l,J,Y,za){l=jb.call(this,l,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Bf.EAh,!0,!1,Bf.pJb,J,Y,!1,za)||this;l.mm=null;return l}function Qf(){}function Vg(){}function Rf(l,
J){l=De.call(this,l,2,0,null)||this;l.Ute=J;return l}function De(l,J,Y,za){this.gtg=l;this.Kng=J;this.Ong=Y;this.Gxg=za}function Lg(){}function $d(l,J,Y,za){var Ua=G.call(this,l,"PopulateAutoFilterContextMenu",1675506831,1651433993,k,!0,!1,"AutoFilterContextMenuRoot",J,Y,!1,za)||this;Ua.csb=null;Ua.sheetName=null;Ua.PTa=null;Ua.nXc=null;Ua.lmf=!1;Ua.f3a=!1;Ua.fFd=null;Ua.uMb=null;Ua.T$c=null;Ua.qcc=null;Ua.PPa=null;Ua.DGe=null;Ua.gab=null;Ua.l5c=null;Ua.RN=function(){Ua.Xyc();Ua.$.ea.Yn(Ua.RN)};Ua.kMi=
function(Qb){function uc(Tg,Rg,Yh){Ua.l5c=Td.t(Ua.$.na.va,hd,lf.b(Tg,Ke),Ua.f3a?lf.a(Rg,zf):Rg,Yh,null,Dg);return Ua.l5c}Ua.f3a||jg.b(Ua.$).Vd(Of.a.Gyf,Ua.nm(),void 0,!0);var ed={};Ua.$.Dj(ed);var Dd=Ua.$.ea.isNamedObjectViewMode,hd=je.a.oi(Ua.nXc);hd.SheetName=Dd?ed.NamedObjectName:ed.SheetName;hd.NamedObjectView=Dd;ed=!!Qb.searchText;Dd=586;Ua.f3a&&(ed&&(hd.ItemListOptions=Ua.y5g(Qb.searchText),Dd=597),Qb={},jg.b(Ua.$).Vd(Of.a.Gyf,(Qb.UserOperation=Dd.toString(),Qb),void 0,!0));var Ke=Ua.uBd(ed),
zf=Ua.lMi(),Dg=Ua.$.na.va.hc();Ua.DGe=Dg.RequestId;Ua.f3a&&Ua.qcc&&!Ua.qcc.dequeueUtcTime&&(Ua.$.userOperationManager.JIa(Ua.qcc),Ua.tVg());Qb=We.EwaSettings.qc()?new Wg.a(Dd,0,uc,80):new Kd.a(Dd,0,uc,16);Ua.qcc=Ua.$.userOperationManager.ic(Qb,null);Ua.gab=Ua.l5c;Ua.PPa=Ua.DGe};Ua.onMenuItemClick=function(Qb,uc,ed){jg.b(Ua.$).Vd(Of.a.dRi,Ua.nm(),void 0,!0);var Dd={};uc=(Dd.CommandValueId=uc,Dd.MenuItemId=uc,Dd.InputMethod=ed,Dd.TopCellAddress=Ua.PTa,Dd);Dd=new rh.a(Qb,ed,Ua.$.isEditMode?2:1,19,null);
Ua.$.Ka.$b(Dd,uc);Cd.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",Qb,ed)};Ua.iHi=function(Qb){if(Qb.checkedItems&&Qb.checkedItems.length){jg.b(Ua.$).Vd(Of.a.Tuf,Ua.nm(),void 0,!0);var uc=je.a.oi(Ua.nXc),ed={};Ua.$.Dj(ed);ed.FirstRow=0;ed.FirstColumn=uc.Column;var Dd=Ua.$.ea.isNamedObjectViewMode;uc.NamedObjectView=Dd;uc.SheetName=Dd?ed.NamedObjectName:ed.SheetName;var hd=function(Dg){if(oh.a.Rxc(Dg)){var Tg=oh.a.Fac(Dg);Ua.cNa?oh.a.XQa(Mi.a.applyItemFilter,Tg.MessageIdName,
Nh.a.Gsa,!0,oh.a.isSessionEndingError(Tg.MessageId)):Cd.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Tg.MessageIdName)}Bh.a(Dg)||(Cd.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),jg.b(Ua.$).Vd(Of.a.Ayf,Ua.nm(),void 0,!0),Dg=Object(tg.a)(new Bc,{isSuccess:!0}),Ua.uMb.onApplyFilterByValueFinish(Dg),Ua.QL(Ua.PTa))},Ke=Ua.R3c(uc,ed),zf=new Wg.a(208,0,function(Dg,Tg,Rg){return Td.a(Ua.$.na.va,
Ke,Qb.checkedItems,lf.b(Dg,hd),Tg,Rg,null,null)},6,function(){return new yf.a(Qb.checkedItems,Ke)});Ua.C4f(function(){Ua.$.userOperationManager.ic(zf,null)})}else Cd.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Ua.oLg=function(Qb){var uc=Gf.o(Ua.PTa,Ua.$),ed=Gf.v(Ua.PTa,Ua.$),Dd=Object(tg.a)(new ue,{SortConditionType:Qb.type,RowColOffset:uc.FirstColumn-ed.FirstColumn,SortColor:Qb.color,SortIconSet:Qb.icon.IconSet,SortIcon:Qb.icon.Icon,
IsAscending:!0}),hd={SortOptions:Object(tg.a)(new He,{OperationType:1,ActiveCell:uc,SelectedRange:ed,SortConditions:[Dd],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:ed,OriginalActiveCell:uc,ShouldRestoreSelection:!1};hd.ShouldPromptNamedSheetViewTeachingDialog=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");Cd.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",Qb.type);We.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?
(Qb={},Ua.$.Zd(-1089513346,kg.a.Vb,19,(Qb.CustomSortCommandData=hd,Qb))):Ua.C4f(function(){var Ke={};Ua.$.Zd(1659552324,kg.a.Vb,19,(Ke.CustomSortCommandData=hd,Ke))})};Ua.cNa=oh.a.$nd();Ua.ry=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return Ua}function le(){this.top=this.left=0}function lh(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function Kf(){this.autoFilterMenu=
this.targetPoint=null}function Ph(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Da(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function Mb(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function Bc(){this.isSuccess=!1}function wd(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Nd(){this.Disabled=
!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function Pe(){this.Sections=this.Id=null}function He(){this.ActiveCell=this.SelectedRange=null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function ue(){this.RowColOffset=
0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function Ia(){}function cb(l,J,Y,za){var Ua=this;this.L3d=this.Y1=this.Xi=this.aE=this.X8=null;this.dXb=l;this.Lwg=za;this.dXb.rMa&&(this.Xi=new Ch.a(3,2,5E3,Object(ci.a)(this,this.sNg,"authenticationCheckTask"),2),Fg.AFrameworkApplication.Ri.Yg(this.Xi),this.Og(J,Y));this.dXb.Onb(function(){Ua.avf()});this.dXb.cZa(function(){Ua.bvf()})}
function Xb(){}function yc(l){return fh.call(this,l)||this}function Xc(l,J,Y){var za=nh.call(this)||this;za.AIi=function(Ua,Qb){if(!Bh.a(Ua)&&Qb){var uc=!!Ua&&!!Ua.RequestTelemetryData;Je.g(za.$).Ki.Ola(Qb.toString(),Ua.StateId,uc?Ua.RequestTelemetryData.EcsOperationDuration:0,uc?Ua.RequestTelemetryData.EcsRequestDuration:0,uc?Ua.RequestTelemetryData.WfeRequestDuration:0)}};za.$=l;za.tableManager=J;za.Sg=Y;return za}function Od(l,J){this.command=0;this.selectedRanges=null;this.command=l;this.selectedRanges=
J}function Ud(l){return Ei.call(this,l)||this}function Fe(l){var J=Zf.call(this)||this;J.evf=function(Y){var za=Je.g(J.$);if(Y=Y.Result){var Ua=Gf.D(Y.NewSelection),Qb=Gf.D(Y.NewActiveCell);if(Ua&&Qb)if(!Y.Committed&&Y.AutoSumFormula){var uc=za.mc(Qb);uc&&(za.ha.updateSelection(Ua,Qb,60),Ua=Qb=Gf.D(Y.MarkedArea),za.YJ=2,uf(za.Ac,uc,Y.AutoSumFormula,!!Ua,Y.FormulaMarkStart,Y.FormulaMarkEnd),Ua&&Qb&&za.ha.updateSelection(Ua,Qb,0),za.Ac.Tqd=!1,Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.create(J.$.da,
153,J.la,0),function(ed){ed.result.A2a(null)},J.la,3))}else za.ha.updateSelection(Ua,Qb,60)}};J.$=l;return J}function gf(l,J){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=l;this.type=J}function uf(l,J,Y,za,Ua,Qb){if(J){var uc=l.textBox;l.isEditing||l.startEdit(J,!0);l.Tqd=!0;l.text=Y;uc.caretPosition=Ua;Ua<Qb&&(za&&l.qBa(),uc.selectRange(0,Qb+1),uc.selectRange(Ua,Qb))}}function Ee(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd){hd=l.Na(9,hd);hd.selectedRange=J;hd.activeCell=Y;hd.autoSumType=za;hd.topLeftCell=
Ua;return Td.i(l,"AutoSum",hd,Qb,uc,ed,Dd,0)}function mc(l,J,Y,za,Ua,Qb){if(0===za)return Object(qg.a)(eh.UnsupportedZeroResize);if(0>za||0===Y.length)return Object(qg.a)(eh.InvalidInput);if(l.K6h())return Object(qg.a)(eh.UnsupportedSkeletonInView);var uc=l.Df;if(!uc)return Object(qg.a)(eh.NullSPD);var ed=uc.$_e(Y);if(ed&&0<ed.length)return Object(qg.a)(ed.length.toString()+" "+eh.UnsupportedHiddenInRange);a:{ed=Cl(Y);for(var Dd=ed.next();!Dd.done;Dd=ed.next())Dd=Dd.value,Ua?Dd.right=ze.a.Qh:Dd.bottom=
ze.a.Ih;ed=l.naa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Y);try{for(ed.$$rst();ed.$$mn();)if(ed.uo.uEj){var hd=!0;break a}}finally{ed&&ed.dispose()}hd=!1}if(hd)return Object(qg.a)(eh.UnsupportedMergeCell);if(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Ua&&"undefined"!==typeof gridRenderer)for(hd=Cl(Y),ed=hd.next();!ed.done;ed=hd.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(ed.value.left);l=l.Ea;hd=ji.a.create().toString();
uc.weg(Y,za,Ua);Qb=l.$cg(Ua,Qb);J.V7i(Y,Ua);l.tLf(Qb,hd,Ua?"row":"column");return Object(qg.d)(za)}b.r(E);var Uc=b(556),Vd=b(0),Sf=b(904),Cd=b(14),Uf=b(206),Td=b(84),kg=b(79);gf.prototype.Q4a=function(){return this.sharedSheetRange};Object(Vd.a)(gf,"MacroRecorderAutoSumPayload",null,[447]);var Gf=b(45),Kd=b(561),af=b(387),Wg=b(175),Hf=b(51),Pg=b(36),be=b(158),$g=b(357),wg=b(30),We=b(1),eg=b(186),lf=b(292),Je=b(21),Di=b(168),kj=b(626),ig=b(55),Zf=Uf.a;Am(Fe,Zf);Fe.prototype.$c=function(){return!1};
Fe.prototype.executeCommand=function(l,J,Y){l=J.command;switch(l){case 1220954656:J=this.QJe(0,J);break;case -1537138325:J=this.QJe(parseInt(Y[kg.a.ld].toString(),10),J);break;default:J=eg.a(l)}return J};Fe.prototype.Kc=function(l,J){if(l=1===l)switch(J.command){case 1220954656:case -1537138325:break;default:l=!1}return l};Fe.prototype.jd=function(){return!1};Fe.prototype.QJe=function(l,J){function Y(){return new gf(uc,l)}var za=this,Ua=Je.g(this.$);Ua.rg.iH(!1);if(!Je.g(this.$).ha.ta.Lg)return Cd.ULS.sendTraceTag(537170308,
0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",l,Je.g(this.$).ha.ta.YK),this.Fza(),ig.Task.Ra(!1);var Qb=Ua.nK();if(!Qb)return null;var uc=Gf.v(Ua.ha.ta.ud,this.$),ed=Gf.o(Ua.ha.ta.activeCell,this.$),Dd=Gf.o(Qb,this.$),hd=this.$.na.va.hc();return this.$.Dq(Ua.ha.ta.selectedRanges,!0)?We.EwaSettings.qc()?af.a(this.$.userOperationManager,function(Ke,zf,Dg){return Ee(za.$.na.va,uc,ed,l,Dd,lf.b(Ke,za.evf),zf,Dg,l,
hd)},function(Ke){return new Wg.a(502,0,Ke,64,Y)},J):af.a(this.$.userOperationManager,function(Ke,zf,Dg){return Ee(za.$.na.va,uc,ed,l,Dd,lf.b(Ke,za.evf),zf,Dg,l,hd)},function(Ke){return new Kd.a(502,0,Ke,void 0,Y)},J):ig.Task.Ra(!1)};Fe.prototype.Fza=function(){kj.a(Di.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var l=wg.a.gd(1,1,748,2139,0,371863010,"DiscontinuousSelectionBlocking");We.EwaSettings.Kz()?new $g.a(this.$,l):(l=new be.ErrorDialog(this.$,l),l.initialize(),l.kf())};
Object(Vd.a)(Fe,"AutoSumCommandHandler",Uf.a,[424]);var Ei=Sf.a;Am(Ud,Ei);Ud.prototype.Nd=function(){this.Dd([new Fe(this.$)])};Ud.ka=function(l){Sf.a.he(96,new Ud(l))};Object(Vd.a)(Ud,"AutoSumCommandHandlerFactory",Sf.a,[]);var ph=b(11),ji=b(177),xh=b(276),zg=b(38),wi=b(338);Od.prototype.du=function(){return this.command};Object(Vd.a)(Od,"MacroRecorderRangeOperationAppliedPayload",null,[447]);var Bh=b(293),Jh=b(70),nh=zg.a;Am(Xc,nh);Xc.prototype.LEg=function(l){this.addHandler("ekcvc",l)};Xc.prototype.ubj=
function(l){this.removeHandler("ekcvc",l)};Xc.prototype.$c=function(){return!1};Xc.prototype.executeCommand=function(l,J){l=J.command;switch(l){case -730106152:J=this.ejd(J,3);break;case -1228228458:J=this.ejd(J,4);break;case -848953656:case 2045211913:if(this.Tli()){J=ig.Task.Ra(!0);break}J=this.ejd(J,1);break;default:J=eg.a(l)}return J};Xc.prototype.Kc=function(l,J){if(l=1===l)switch(J.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:l=!1}return l};Xc.prototype.jd=
function(){return!1};Xc.prototype.ejd=function(l,J){function Y(){return new Od(J,hd)}function za(zf,Dg,Tg){Ua.$.Oy();return Td.f(Ua.$.na.va,J,hd,!1,lf.b(zf,Ua.AIi),Dg,Tg,Dd,Ke)}var Ua=this,Qb=Je.g(this.$),uc=Qb.ha.ta.selectedRanges,ed=l.command,Dd=ji.a.create().toString();if(!this.$.Dq(uc,!0)&&-730106152!==ed)return ig.Task.Ra(!0);var hd=Gf.r(uc,this.$);this.cBj(ed,Qb,uc,Dd);We.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.f4i();var Ke=this.$.na.va.hc({Lla:!0,
Lka:1});return We.EwaSettings.qc()?af.a(this.$.userOperationManager,za,function(zf){return new Wg.a(508,0,zf,67,Y)},l):af.a(this.$.userOperationManager,za,function(zf){return new Kd.a(508,0,zf,3,Y)},l)};Xc.prototype.cBj=function(l,J,Y,za){var Ua=this;if(-848953656!==l&&2045211913!==l&&-730106152!==l&&-1228228458!==l)Cd.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",l);else if(!xh.a.any(Y,function(uc){return 0<J.getRangeInformation(uc).length})){var Qb=
xh.a.any(Y,function(uc){return Ua.tableManager.bsd(uc)});if(-730106152!==l&&-1228228458!==l||!Qb)this.bFj(J,l,za,Y),-730106152!==l&&-1228228458!==l||this.Sg.qea(J,-730106152,{}),-1228228458!==l&&2045211913!==l&&-848953656!==l||this.Sg.dZg(Y,za),J.Ki.o1(za,Jh.BasicTelemetryCalculator.wR)}};Xc.prototype.bFj=function(l,J,Y,za){var Ua="";switch(J){case -1228228458:Ua="ClearAll";break;case 2045211913:case -848953656:Ua="ClearContent";break;case -730106152:Ua="ClearFormat";break;default:Cd.ULS.sendTraceTag(537167937,
0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",J)}J=za.length;za=Gf.b(za);l.Ki.e8(15,Y,Ua+(", ranges to clear: "+J+", cells to clear: "+za))};Xc.prototype.f4i=function(){this.raiseEvent("ekcvc",new wi.a)};Xc.prototype.Tli=function(){if(Je.g(this.$).Gz){var l=this.$.da.Aa(296);return!!l&&l.sV.wB}return!1};Object(Vd.a)(Xc,"ClearCommandHandler",zg.a,[424,753]);var fh=Sf.a;Am(yc,fh);yc.prototype.Nd=function(){var l=this,J=Hf.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.ub),Y=Hf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([J,Y],this.la),function(){var za=new Xc(l.$,J.result,Y.result);l.Dd([za]);l.$.da.Ga(313,za)},this.la,3)};yc.ka=function(l){Sf.a.he(101,new yc(l))};Object(Vd.a)(yc,"ClearCommandHandlerFactory",Sf.a,[]);var rj=b(630),Qh=b(623),bh=b(621),Xh=b(1215);Xb.prototype.H9g=function(l,J){if(l&&!(1>l.length)&&J){var Y=Object.assign(new bh.a,{ExternalId:"msPresenceOuter",ControlList:[]});
this.f7g(l,Y.ControlList);J.push(Y)}};Xb.prototype.f7g=function(l,J){var Y=Object.assign(new rj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Qh.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(J,Y);J=Object.assign(new bh.a,{Title:"",ControlList:[]});Array.add(Y.Menu.MenuSectionList,J);this.n9g(l,J.ControlList)};Xb.prototype.n9g=function(l,J){for(var Y=0;Y<l.length;Y++){var za=Object.assign(new Xh.a,
{ExternalId:String.format("CoauthorPersona_{0}",Y),Command:"336231556",DisplayName:l[Y].userName,LabelText:l[Y].userName,ImageBackColor:l[Y].color,PersonaId:l[Y].email,IsAnonymous:l[Y].isAnonymous});Array.add(J,za)}};Object(Vd.a)(Xb,"PresenceContextMenuSectionBuilder",null,[307]);var ci=b(82),Fg=b(4),ki=b(180),Ag=b(622),Ch=b(108),Yg=b(133),hh=b(90),Ug=b(85),yh=b(106),pi=b(27);cb.prototype.Og=function(l,J){var Y=Fg.AFrameworkApplication.Ib;Y.Ze(pi.a.authenticationLost,yh.a.frame,l,96);Y.Ze(pi.a.Nte,
yh.a.frame,J,96);Y.fc(pi.a.Ixe,yh.a.frame,ki.ActionManager.y7c);Y.fc(pi.a.Jxe,yh.a.frame,ki.ActionManager.y7c);Y.fc(pi.a.Ttd,yh.a.frame,ki.ActionManager.y7c)};cb.prototype.avf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);Fg.AFrameworkApplication.Ib.processAction(pi.a.authenticationLost,2)};cb.prototype.bvf=function(){this.TIj();Fg.AFrameworkApplication.Ib.processAction(pi.a.Nte,2)};cb.prototype.sNg=function(){this.dXb.authenticationCheck()};cb.prototype.TIj=function(){this.aE&&
(this.aE.hide(),this.aE.dispose(),this.aE=null);this.X8&&this.businessBar&&(Fg.AFrameworkApplication.Kg||this.businessBar.removeEntry(this.X8),this.X8.dispose(),this.X8=null)};cb.prototype.showDialog=function(l){hh.a.Ha(this.aE);this.aE=new Yg.StandardDialog;this.Lwg||(this.aE.rv=!1,this.aE.jc=0);this.aE.Bc(1,CommonUIStrings.l_SignIn);this.aE.OX(CommonUIStrings.l_DefaultDialogTitle,l,Object(ci.a)(this,this.Dw,"dialogHandler"))};cb.prototype.Dw=function(l){1===l?(Ag.a.e7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),
Fg.AFrameworkApplication.Ib.processAction(pi.a.Ttd,2)):(this.CSd(),Fg.AFrameworkApplication.Ib.processAction(pi.a.Jxe,2))};cb.prototype.CSd=function(){this.businessBar&&this.Wve&&(this.X8=this.Wve.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.X8.closeable=!0,this.X8.addButton(CommonUIStrings.l_SignIn,cb.RSg,""),this.X8.Y$=Object(ci.a)(this,this.USg,"businessBarEntryCloseHandler"),this.businessBar.oE(this.X8,!1))};cb.prototype.USg=function(){this.hgh();
Fg.AFrameworkApplication.Ib.processAction(pi.a.Ixe,2)};cb.prototype.hgh=function(){this.Xi&&(Fg.AFrameworkApplication.Ri.aq(this.Xi),this.Xi=null)};cb.prototype.dispose=function(){this.Xi=this.aE=this.X8=null};cb.RSg=function(){Ag.a.e7();Fg.AFrameworkApplication.Ib.processAction(pi.a.Ttd,2)};Ck.Object.defineProperties(cb.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.Y1||(this.Y1=Ug.a.instance.Lh("CommonUI.IBusinessBar"))}},Wve:{configurable:!0,enumerable:!0,get:function(){return this.L3d||
(this.L3d=Ug.a.instance.Lh("CommonUI.IBusinessBarEntryFactory"))}}});Object(Vd.a)(cb,"SignOutResponseUI",null,[2]);var pg=b(255);Ia.prototype.fi=function(l){l.register(Xb,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Ic()};Ia.prototype.init=function(){};Ia.prototype.dispose=function(){hh.a.Ha(Ia.E2);Ia.E2=null};Ia.main=function(){pg.a.instance.hj(new Ia)};Ck.Object.defineProperties(Ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});
Ia.E2=null;Object(Vd.a)(Ia,"CommonAppUIPackage",null,[4,5]);var qi=b(153),tg=b(7),Zh=b(161);Object(Vd.a)(ue,"SharedSortCondition",null,[]);Object(Vd.a)(He,"SharedSortOptions",null,[]);var Ga=b(927),oa=b(5),Bb=b(493),Rd=b(624),je=b(56),yf=b(1112),Of=b(131),Mf=b(959),ah=b(150),Xg=b(119),Eh=b(213),rh=b(95),Fh=b(72),Rh=b(35),se=b(15),kh=b(64),jg=b(132),oh=b(981),Mi=b(982),Nh=b(145),Zg=b(49),Df=b(33),Ff=b(443);Object(Vd.a)(Pe,"AutoFilterMenu",null,[]);Object(Vd.a)(Nd,"MenuItem",null,[]);Object(Vd.a)(wd,
"MenuSection",null,[]);Object(Vd.a)(Bc,"ApplyFilterByValueResponse",null,[]);Object(Vd.a)(Mb,"FilterByValueItem",null,[]);Object(Vd.a)(Da,"GetColorsAndIconsResponse",null,[]);Object(Vd.a)(Ph,"GetFilterByValueItemsResponse",null,[]);Object(Vd.a)(Kf,"ShowSortFilterMenuParams",null,[]);Object(Vd.a)(lh,"SortFilterControllerFactoryParams",null,[]);Object(Vd.a)(le,"TargetPoint",null,[]);var zh=b(256),og=b(37),vh=b(162),ij=b(230),k=oa.a.O2g,G=Ga.a;Am($d,G);$d.prototype.executeCommand=function(l,J,Y){var za=
this;l=J.command;switch(l){case 1701016594:return Ga.a.Qyh(Y),ig.Task.Ra(!0);case 966232027:if(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)){var Ua=new Zh.a;Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(this.$.da,8,9,0),function(Qb){za.r7e(J,Y,Qb.result);Ua.setResult(!0)},this.la,3).CWCT(function(){Ua.setResult(!1)},this.la,5,ij.a.instance);return Ua.task}this.r7e(J,Y);return ig.Task.Ra(!0);default:return eg.a(l)}};$d.prototype.r7e=function(l,J,Y){var za=this,Ua=
J.domEvent;if(Fh.e(Ua.rawEvent)&&(Fh.g(Ua),Ua.target)){var Qb=new ah.a(this.$.xa);if(Qb.ke(4096)||Qb.ke(2048)){var uc=je.a.oi(J[kg.a.Ag]);this.e3f(uc)&&(this.lmf?this.Itc(Ua,Ua.target,uc,l,Y):(this.fFd=function(){za.e3f(uc)&&(za.oci(),za.Itc(Ua,Ua.target,uc,l,Y),za.f3a=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),za.lmf=!0)},this.Xyc()))}}};$d.prototype.Kc=function(l,J,Y){if(l=!!Y)switch(J.command){case 1701016594:case 966232027:We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",
!1)||Bb.a(this.$)||(l=!1,Cd.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",Zg.b().ti(J.command)));break;default:l=!1}return l};$d.prototype.SEd=function(l){Array.addRange(l.MenuSectionList,this.csb)};$d.prototype.oci=function(){var l=this;Ff.a(function(){l.uMb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(tg.a)(new lh,{getFilterByValueItemsRequest:l.kMi,applyFilterByValueRequest:l.iHi,
onMenuItemClick:l.onMenuItemClick,autoFilterMenuWidth:$d.Tte,applySortByColorOrIconRequest:l.oLg}))});this.T$c=Ug.a.instance.Lh("Common.IExternalUICommandDefinitionMapping")||new Rd.a(this.$.Lb,this.$)};$d.prototype.Itc=function(l,J,Y,za,Ua){jg.b(this.$).Vd(Of.a.Itc,this.nm(),void 0,!0);Cd.ULS.shipAssertTag(537167135,0,!!Y,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");l=this.sKh(Y,Ua);Ua=Sys.UI.DomElement.getBounds(J);za=Ua.x+Ua.width;Ua=Ua.y;if(this.ry&&!Y.IsHeaderSnapped){if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&
!Ga.a.Bod(this.$,Y.Cell))return;Y=Ga.a.wed(this.$,Y.Cell,!0);za=Y.x;Ua=Y.y}Y=Je.g(this.$).rtl?new Sys.UI.Point(za-Df.a(this.$).wGa($d.Tte),Ua):new Sys.UI.Point(za,Ua);this.iUa(Y,J);Y=Df.a(this.$).aka(Y);J=Object(tg.a)(new Kf,{targetPoint:Object(tg.a)(new le,{left:Y.x,top:Y.y}),autoFilterMenu:l});this.uMb.showSortFilterMenu(J);this.$.Zd(-544117314,-1,0,null)};$d.prototype.e3f=function(l){return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&l.Cell.SheetName?
Je.g(this.$).R5?l.Cell.SheetName===this.$.qa.name:l.Cell.SheetName===this.$.qa.sheetName:!0};$d.prototype.sKh=function(l,J){return(l=this.tKh(l,J))?this.dKf(l):null};$d.prototype.dKf=function(l){for(var J=[],Y=Cl(l.Sections),za=Y.next();!za.done;za=Y.next())za=za.value,Object(vh.e)(this.$)&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&za.Title===se.a.instance.fa(1909)||(za=this.c2i(za),J.push(za));return Object(tg.a)(new Pe,{Id:l.Id,Sections:J})};$d.prototype.c2i=function(l){for(var J=
[],Y=Cl(l.MenuItems),za=Y.next();!za.done;za=Y.next())if(za=za.value,2===za.Identifier)this.nXc=za.CommandData;else switch(za.Type){case 3:case 2:J.push(this.a2i(za,2===za.Type));break;case 1:J.push(this.b2i(za))}return Object(tg.a)(new wd,{MenuItems:J,DisplayType:l.DisplayType,Id:this.SHh(l)})};$d.prototype.b2i=function(l){var J=this.kXe(l);var Y=J.label;var za=J.RLa;J=this.dKf(l.SubMenu);var Ua=this.aXe(l);za=this.T$c.Abc(za);Y=Y||l.Label;return Object(tg.a)(new Nd,{Disabled:l.Disabled,Type:l.Type,
Identifier:l.Identifier,Id:Ua,CommandData:l.CommandData,Label:Y,SubMenu:J,IsChecked:l.IsChecked,IconName:"MissingIcon_20"===za?null:za})};$d.prototype.a2i=function(l,J){var Y=this.qac(l,J&&l.IsChecked);J=Y.label;var za=Y.RLa;Y=Y.Er;var Ua=this.rdd(l,J);za=this.T$c.Abc(za);return Object(tg.a)(new Nd,{Disabled:l.Disabled,Type:l.Type,Identifier:l.Identifier,Id:Ua,RibbonCommand:Y,CommandData:l.CommandData,Label:J||l.Label,SubMenu:null,IsChecked:l.IsChecked,IconName:"MissingIcon_20"===za?null:za})};$d.prototype.tKh=
function(l,J){var Y;this.PTa=Y=Gf.C(l.Cell);this.sheetName=this.$.qa.sheetName;J=J||Bb.a(this.$);if(l.IsHeaderSnapped)Y=J.f$b.GRh(Y);else{J=Je.g(this.$).Ea.z4a(Y);if(!J)return this.cNa?oh.a.XQa(Mi.a.wMf,Di.a.M2h,Nh.a.h_a,!0,!1):Cd.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",Y,Je.g(this.$).view.visibleArea),null;Y=J.autoFilterMenu}if(!Y)return this.cNa?oh.a.XQa(Mi.a.wMf,
Di.a.OAi,Nh.a.h_a,!0,!1):Cd.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.Nsb=l.Cell.FirstRow+"_"+l.Cell.FirstColumn;return Y};$d.prototype.Xyc=function(){var l=this;if(this.$.ea.vh){var J=Hf.GetServiceTaskFactory.Ua(this.$.da,283,284,1);Pg.TaskExtensions.Ba(J,function(){l.cNa?J.result.Jn.loadScript("sortFilter").then(function(){l.fFd()},function(Y){kh.a.ll(Y,"AutoFilterContextMenu.SortFilterScriptLoad");
oh.a.XQa(Mi.a.Xyc,Di.a.cEj,Nh.a.h_a,!1,!1)}):Pg.TaskExtensions.Ba(zh.c(J.result.Jn.loadScript("sortFilter")),function(){l.fFd()},l.$.la,3)},this.$.la,3)}else this.$.ea.Hl(this.RN)};$d.prototype.y5g=function(l){var J={};J.SearchText=l;J.Page=1;J.DateNodeType=-1;return J};$d.prototype.tVg=function(){this.PPa&&(Cd.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.PPa),Td.j(this.$.na.va,this.PPa,
null,null,null),this.PPa=null);this.gab&&(Fg.AFrameworkApplication.Jd.Fu(this.gab.Qt),this.gab=null)};$d.prototype.uBd=function(l){var J=this;return function(Y){J.PPa=null;J.gab=null;if(oh.a.Rxc(Y)){var za=oh.a.Fac(Y);J.cNa?oh.a.XQa(l?Mi.a.searchAutoFilterItemList:Mi.a.getAutoFilterItemList,za.MessageIdName,Nh.a.h_a,!0,!0):Cd.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",za.MessageIdName)}if(!Bh.a(Y)){Cd.ULS.sendTraceTag(537167126,
0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");Y=Y.Result;za=new Rh.a(!0);var Ua=Y.AutoFilterDateNodes?!0:!1;Y.AutoFilterItems&&za.add("AutoFilterItemsCount",Y.AutoFilterItems.length);Ua&&za.add("AutoFilterDateItemsCount",Y.AutoFilterDateNodes.length);za.add("Location","contextMenu");jg.b(J.$).Vd(Of.a.uBd,za.nu,void 0,!0);za=J.f3a?Object(tg.a)(new Ph,{filterByValueItems:J.bDe(Y),hasMoreRecords:Y.ItemListMaxExceeded,searchText:Y.SearchText}):Object(tg.a)(new Ph,{filterByValueItems:J.bDe(Y),
hasMoreRecords:Y.ItemListMaxExceeded});J.uMb.onGetFilterByValueItemsFinish(za);!l&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:6266750_SortByColor")&&(Cd.ULS.shipAssertTag(529063959,0,null!==Y.FontColors&&null!==Y.CellColors&&null!==Y.Icons&&null!==Y.SelectedSortFontColors&&null!==Y.SelectedSortCellColors&&null!==Y.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Y=Object(tg.a)(new Da,{fontColors:Y.FontColors,cellColors:Y.CellColors,
icons:Y.Icons,selectedSortFontColor:0<Y.SelectedSortFontColors.length?Y.SelectedSortFontColors[0]:null,selectedSortCellColor:0<Y.SelectedSortCellColors.length?Y.SelectedSortCellColors[0]:null,selectedSortIcon:0<Y.SelectedSortIcons.length?Y.SelectedSortIcons[0]:null,getColorName:J.getColorName}),J.uMb.onGetColorsAndIconsFinish(Y))}}};$d.prototype.lMi=function(){var l=this;return function(J){l.PPa=null;l.gab=null;J=Xg.a.pg(J.data);Cd.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",
wg.a.Xc(J))}};$d.prototype.bDe=function(l){var J=this.q3g(l),Y=this.x3g(l.AutoFilterItems),za=[],Ua=0;l.HasBlanks&&(l=$d.e4c(se.a.instance.fa(775),l.IsBlanksSelected?1:0,oa.a.Ste),za[Ua++]=l);J=Cl(J);for(l=J.next();!l.done;l=J.next())l=l.value,za[Ua++]=l;Y=Cl(Y);for(l=Y.next();!l.done;l=Y.next())J=l.value,za[Ua++]=J;return za};$d.prototype.q3g=function(l){var J=[];if(!l.AutoFilterDateNodes||!l.AutoFilterDateNodes.length)return J;for(var Y=[this.w4a(l.YearKeys,l.YearValues),this.w4a(l.MonthKeys,l.MonthValues),
this.w4a(l.DayKeys,l.DayValues),this.w4a(l.HourKeys,l.HourValues),this.w4a(l.MinuteKeys,l.MinuteValues),this.w4a(l.SecondKeys,l.SecondValues)],za=!1,Ua=!1,Qb=0,uc=null,ed=Array(6),Dd=null,hd=Cl(l.AutoFilterDateNodes),Ke=hd.next();!Ke.done;Ke=hd.next()){Ke=Ke.value;ed[0]&&(Dd.Year!==Ke.Year?(za=!0,Qb=0,uc=null):Dd.Month!==Ke.Month?(Ua=!0,Qb=1,uc=ed[0]):Dd.Day!==Ke.Day?(Qb=2,uc=ed[1]):l.ShowTime&&(Dd.Hour!==Ke.Hour?(Qb=3,uc=ed[2]):Dd.Minute!==Ke.Minute?(Qb=4,uc=ed[3]):(Qb=5,uc=ed[4])));for(;6>Qb;){switch(Qb){case 0:var zf=
Ke.Year;Dd=Y[0].getItem(zf.toString());break;case 1:zf=Ke.Month;Dd=Y[1].getItem(zf.toString());break;case 2:zf=Ke.Day;Dd=Y[2].getItem(zf.toString());break;case 3:zf=Ke.Hour;Dd=Y[3].getItem(zf.toString());break;case 4:zf=Ke.Minute;Dd=Y[4].getItem(zf.toString());break;case 5:zf=Ke.Second;Dd=Y[5].getItem(zf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Dd=$d.e4c(Dd,-1!==Ke.NodeType&&Qb>=Ke.NodeType?1:0,uc?uc.key+";"+zf:oa.a.qYc+zf,!1,[]);uc=uc?uc.children:
J;uc=uc[uc.length]=Dd;ed[Qb]=Dd;switch(Qb){case 5:Qb=6;break;case 2:Qb=l.ShowTime?Qb+1:6;break;default:Qb++}}Dd=Ke}za||(ed[0].expanded=!0,Ua||(ed[1].expanded=!0));return J};$d.prototype.x3g=function(l){var J=[];if(!l)return J;var Y=0;l=Cl(l);for(var za=l.next();!za.done;za=l.next())za=za.value,J[Y++]=$d.e4c(za.DisplayString,za.Selected?1:0,oa.a.rYc+za.DisplayString);return J};$d.prototype.w4a=function(l,J){var Y=new Rh.a(!0);if(!l||!J)return Y;for(var za=l.length<J.length?l.length:J.length,Ua=0;Ua<
za;Ua++)Y.add(l[Ua].toString(),J[Ua]);return Y};$d.prototype.R3c=function(l,J){var Y={};Y.Location=J;Y.FieldId=l.Id.toString();Y.DataSourceIndex=-1;Y.FilterType=l.AutoFilterType;Y.AnchorType=0;Y.ChartId=null;Y.AnchorValue1=-1;Y.AnchorValue2=-1;Y.Property=l.RichProperty;return Y};$d.prototype.QL=function(l){og.a.$ba(this.$)&&Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(J){J.result.Oea(l);Cd.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.la,3)};$d.prototype.nm=function(){var l={};return l.Location="contextMenu",l};$d.prototype.getColorName=function(l){return Mf.a.OKa(Eh.a.wH(l))};$d.prototype.C4f=function(l){Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(this.$.da,309,310,3),function(J){J.result.jBa().continueWith(function(Y){Y.result&&l()})},this.$.la,3)};$d.e4c=function(l,J,Y,za,Ua){l=void 0===l?null:l;J=void 0===J?0:J;Y=void 0===Y?null:Y;za=void 0===za?!1:za;Ua=void 0===Ua?null:Ua;return Object(tg.a)(new Mb,{displayText:l?
Ga.a.fg(l):l,state:J,key:Y,parent:null,children:Ua,indentationLevel:0,expanded:za})};Ck.Object.defineProperties($d.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.uMf}}});$d.Tte=268;Object(Vd.a)($d,"AutoFilterContextMenu",Ga.a,[]);var d=b(933),S=b(83),P=b(201),ja=b(65),D=b(19);Lg.ZTe=26;Lg.hbd=[229,230,0,98,0,94,93];Object(Vd.a)(Lg,"Constants",null,[]);Ck.Object.defineProperties(De.prototype,
{Jki:{configurable:!0,enumerable:!0,get:function(){return 3===this.r5b}},joi:{configurable:!0,enumerable:!0,get:function(){return 4===this.r5b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.Gxg}},Sqf:{configurable:!0,enumerable:!0,get:function(){return this.gtg}},r5b:{configurable:!0,enumerable:!0,get:function(){return this.Kng}},B5c:{configurable:!0,enumerable:!0,get:function(){return this.Ong}}});Object(Vd.a)(De,"FiltersMenuData",null,[]);Am(Rf,De);Object(Vd.a)(Rf,
"AutoFilterFiltersMenuData",De,[]);Vg.jJj=[new De(99,2,0,null),new De(100,2,1,null),new De(0,3,0,null),new De(171,2,2,null),new De(173,2,4,null),new De(0,3,0,null),new De(175,2,6,null),new De(176,2,7,null),new De(0,3,0,null),new De(107,0,0,null)];Vg.DFi=[new De(99,2,0,null),new De(100,2,1,null),new De(0,3,0,null),new De(101,2,8,null),new De(102,2,10,null),new De(103,2,12,null),new De(0,3,0,null),new De(104,1,0,null),new Rf(105,1),new Rf(106,2),new De(0,3,0,null),new De(107,0,0,null)];Vg.ich=[new De(99,
2,0,null),new De(0,3,0,null),new De(111,2,10,null),new De(112,2,8,null),new De(103,2,12,null),new De(0,3,0,null),new Rf(109,8),new Rf(108,9),new Rf(110,10),new De(0,3,0,null),new Rf(114,11),new Rf(113,12),new Rf(115,13),new De(0,3,0,null),new Rf(116,14),new Rf(117,15),new Rf(118,16),new De(0,3,0,null),new Rf(119,17),new Rf(120,18),new Rf(121,19),new De(0,3,0,null),new Rf(122,20),new Rf(123,21),new Rf(124,22),new De(0,3,0,null),new Rf(125,23),new De(126,2,12,[new Rf(127,24),new Rf(128,25),new Rf(129,
26),new Rf(130,27),new De(0,3,0,null),new Rf(131,28),new Rf(132,29),new Rf(133,30),new Rf(134,31),new Rf(135,32),new Rf(136,33),new Rf(137,34),new Rf(138,35),new Rf(139,36),new Rf(140,37),new Rf(141,38),new Rf(142,39)]),new De(0,3,0,null),new De(107,0,0,null)];Object(Vd.a)(Vg,"Constants",null,[]);var da=b(22);Qf.prototype.compare=function(l,J){return da.a.compare(l,J,!0)};Object(Vd.a)(Qf,"IgnoreCaseComparer",null,[680]);var Ha=b(74),jb=Ga.a;Am(Bf,jb);Bf.prototype.executeCommand=function(l,J,Y){l=
J.command;switch(l){case -699941697:this.applyAutoFilterFieldList(J,Y);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return eg.a(l)}return ig.Task.Ra(!0)};Bf.prototype.led=function(l,J){return!l||l.length<=J?(Cd.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(l[J],10)};Bf.prototype.wGd=function(l,J,Y,za,Ua,Qb){var uc=this.led(Ua,Qb);0>uc&&Cd.ULS.sendTraceTag(537167116,
0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Lg.hbd[uc]){case 98:l=new rh.a(-2058042992,J.method,J.mode,J.Xe,J.tabName);this.mm.ZG.$tb(this.$,za,0,l);break;case 229:l=new rh.a(504133448,J.method,J.mode,J.Xe,J.tabName);this.mm.ZG.$tb(this.$,za,0,l);break;case 230:l=new rh.a(-798968736,J.method,J.mode,J.Xe,J.tabName);this.mm.ZG.$tb(this.$,za,0,l);break;case 231:l=new rh.a(-1677817820,J.method,J.mode,J.Xe,J.tabName);this.mm.ZG.$tb(this.$,za,0,l);break;case 94:this.sKf(l,
J,za,Y,Ua,Qb+1);break;case 93:this.mm.ZG.esi(this.$,za)}};Bf.prototype.sKf=function(l,J,Y,za,Ua,Qb){var uc=this.led(Ua,Qb);0>uc&&Cd.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!za||uc>=za.length)Cd.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(za=za[uc],za.r5b){case 1:this.mm.ZG.xsi(this.$,Y);break;case 2:(Ua=Object(S.a)(Rf,za))?(l=new rh.a(-2058042992,J.method,
J.mode,J.Xe,J.tabName),this.mm.ZG.$tb(this.$,Y,Ua.Ute,l)):this.mm.ZG.alf(this.$,l,Y,za.B5c);break;case 0:this.mm.ZG.alf(this.$,l,Y,za.B5c);break;case 4:this.sKf(l,J,Y,za.subMenu,Ua,Qb+1)}};Bf.prototype.applyAutoFilterFieldList=function(l,J){var Y=J[d.a.nG];if(Y)if(Y=Y.split(ja.a.rV),3>Y.length)Cd.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var za=this.led(Y,1),Ua=this.DKa(za),Qb=this.Nqf(za).returnValue;Qb?
this.wGd(J,l,Qb,Ua,Y,2):Cd.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+za.toString()+ja.a.rV)}else Cd.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};Bf.prototype.Kc=function(l,J){if(l=this.$.isEditMode)switch(J.command){case 216058793:break;case -699941697:break;case -1494291901:l=!0;break;default:l=!1}return l};Bf.prototype.k1=function(l,
J,Y){this.$.isEditMode&&((this.mm=Object(S.a)(693,Y))||Cd.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.DZ(),jb.prototype.k1.call(this,l,J,null,null,!0))};Bf.prototype.Z3c=function(){if(!this.mm||!this.mm.Mk||1!==this.mm.Mk.length)return Cd.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var l=this.mm.Mk[0],J=new P.a;J.add(se.a.instance.fa(247));J=Ha.OBc(Ha.concat(J,
Ha.select(Ha.asEnumerable(l.FieldInfoDataList),function(Y){return Y.Name})),function(Y){return Y},new Qf);return Ha.toArray(J)};Bf.prototype.fieldIndex=function(l){if(!this.mm||!this.mm.Mk||1!==this.mm.Mk.length||!this.mm.Mk[0].FieldInfoDataList)return-1;for(var J=0;J<this.mm.Mk[0].FieldInfoDataList.length;++J)if(this.mm.Mk[0].FieldInfoDataList[J].Name===l)return J;return-1};Bf.prototype.DKa=function(l){return 0>l||!this.mm||!this.mm.Mk||1!==this.mm.Mk.length||!this.mm.Mk[0].FieldInfoDataList||this.mm.Mk[0].FieldInfoDataList.length<
l?null:this.mm.Mk[0].FieldInfoDataList[l].Name};Bf.prototype.DZ=function(){var l=this,J=this.Z3c();if(!J||!J.length)return null;for(var Y=this.Sa,za=Y.Pc(),Ua={},Qb=0;Qb<J.length;Ua={Hgb:Ua.Hgb},++Qb){var uc=J[Qb];Ua.Hgb=0<Qb?this.fieldIndex(uc):-1;for(var ed=Bf.g6f+Ua.Hgb.toString()+ja.a.rV,Dd=null,hd=this.mm.ZG.p6h(0<Qb?uc:null),Ke=this.h4c(Y,hd,Bf.g6f+Ua.Hgb.toString(),uc),zf={},Dg=0;Dg<Lg.hbd.length;zf={VPb:zf.VPb,Ggb:zf.Ggb},++Dg){var Tg=Lg.hbd[Dg],Rg=ed+Dg.toString();Dd||(Dd=Y.Pc());switch(Tg){case 229:Dd.buttons.push(Y.ed(223,
Rg,-699941697,this.mm.ZG.Vni(0<Qb?uc:null)?D.a.g9b:D.a.wJa,8,229,!1,null));break;case 230:Dd.buttons.push(Y.ed(224,Rg,-699941697,this.mm.ZG.Wni(0<Qb?uc:null)?D.a.h9b:D.a.xJa,8,230,!1,null));break;case 231:Dd.buttons.push(Y.ed(225,Rg,-699941697,D.a.e9b,1,231,!1,null));break;case 98:Tg=this.SRg(uc);Rg=Y.aIa(Rg+(hd?".enabled":".disabled"),Tg,-699941697,null,"None",null,!hd,void 0,!0);Rg.YS("Image16by16",8,D.a.R2a);Dd.buttons.push(Rg);break;case 94:zf.VPb=void 0;zf.Ggb=void 0;var Yh=function(Li,Mh){return function(){var Uj=
l.Nqf(Li.Hgb);Mh.VPb=Uj.hUe;Mh.Ggb=Uj.isChecked;return Uj}}(Ua,zf)().returnValue;if(!Yh)return null;Tg=this.h4c(Y,zf.Ggb&&hd,Rg,zf.VPb);Rg=this.qXe(Tg.menu,Y,Rg+ja.a.rV,Yh,zf.Ggb&&hd);Tg.menu.Dc.push(Rg);Dd.buttons.push(Tg);break;case 0:Dd&&(Ke.menu.Dc.push(Dd),Dd=null);break;default:Rg=Y.aIa(Rg,se.a.instance.fa(Tg),-699941697,null,"None",null,!1,void 0,!0),this.oZf(Rg,hd&&93===Tg&&this.mm.ZG.filter(),se.a.instance.fa(Tg)),Dd.buttons.push(Rg)}}Ke.menu.Dc.push(Dd);za.buttons.push(Ke)}J=Y.Zp(this.menuId);
J.Dc.push(za);return J};Bf.prototype.qXe=function(l,J,Y,za,Ua){for(var Qb=null,uc=0;uc<za.length;++uc){var ed=za[uc],Dd=Y+uc.toString(),hd=!1;switch(ed.r5b){case 1:hd=Ua&&this.mm.ZG.Vh.IsTop10;break;case 2:hd=Object(S.a)(Rf,ed);hd=Ua&&this.mm.ZG.vhi(hd?hd.Ute:0,ed.B5c);break;case 0:hd=Ua&&this.mm.ZG.Vh.IsCustomSupportedAndNotPresent}Qb||(Qb=J.Pc());if(ed.Jki)Qb&&(l.Dc.push(Qb),Qb=null);else if(ed.joi){var Ke=se.a.instance.fa(ed.Sqf);Ke=this.h4c(J,hd,Dd,Ke);Ke.menu.Dc.push(this.qXe(Ke.menu,J,Dd+ja.a.rV,
ed.subMenu,hd));Qb.buttons.push(Ke)}else ed=se.a.instance.fa(ed.Sqf),Dd=J.aIa(Dd,ed,-699941697,null,"None",null,!1,void 0,!0),this.oZf(Dd,hd,ed),Qb.buttons.push(Dd)}return Qb};Bf.prototype.oZf=function(l,J,Y){J?l.YS("Image16by16",8,D.a.Qua):l.YS("None",0,null);l.WS(Y);l.label=Y};Bf.prototype.h4c=function(l,J,Y,za){return J?l.$3c(Y,this.menuId,za,798637440,8,D.a.Qua):l.zw(Y,this.menuId,za,798637440)};Bf.prototype.Gh=function(l){return!l||!l.length};Bf.prototype.Nqf=function(l){var J=0>l?0:this.mm.Mk[0].FieldInfoDataList[l].MajorityDataTypeForField;
var Y=null;l=this.mm.ZG.o6h(J);switch(J){case 0:Y=95;J=Vg.jJj;break;case 1:Y=94;J=Vg.DFi;break;case 2:Y=96;J=Vg.ich;break;default:return Cd.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,hUe:Y,isChecked:l}}Y=se.a.instance.fa(Y);return{returnValue:J,hUe:Y,isChecked:l}};Bf.prototype.SRg=function(l){!l||this.Gh(l.trim())?l=se.a.instance.fa(97):l.length>Lg.ZTe?(l=l.substring(0,Lg.ZTe),l=String.format(se.a.instance.Ab(155),
l)):l=String.format(se.a.instance.Ab(156),l);return l};Ck.Object.defineProperties(Bf.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.vMf}}});Bf.EAh=oa.a.N2g;Bf.pJb="AutoFilterFieldListContextMenuRoot";Bf.g6f="ApplyAutoFilterFieldList.";Object(Vd.a)(Bf,"AutoFilterFieldListContextMenu",Ga.a,[]);var kc=b(610),Jb=b(1046),md=b(10),ce=b(120),qe=b(389),Ye=Ga.a;Am(Ze,Ye);Ze.prototype.executeCommand=
function(l,J,Y){l=Object(S.a)(kc.a,Y.eventArgs);switch(J.command){case -1372040782:Y=Je.g(this.$).ha.Oa.oc;Cd.ULS.shipAssertTag(537167048,0,!!Y);Y&&(this.floatingObject=Y.floatingObject,this.yb=J.method,J=this.hbc(l),this.Jp(J,!0,l.yb));break;case 848910589:l&&(J=[Jb.a.J1f],l=new Sys.UI.Point(l.Ca.clientX,l.Ca.clientY),this.showFloatie(J,new Sys.UI.Bounds(l.x,l.y,0,0),2))}return ig.Task.Ra(!0)};Ze.prototype.Kc=function(l,J,Y){switch(J.command){case -1372040782:return!!Y&&this.oif(l);case 848910589:return l=
Je.g(this.$).ha.Oa.oc,!!Y&&!!l&&l.isEditing;default:return!1}};Ze.prototype.oif=function(l){switch(l){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};Ze.prototype.SUc=function(l,J,Y){qe.a(this.$)?Je.g(this.$).rb.dj||(Df.a(this.$).pSd()?Y.buttons.push(l.Bb(265)):Y.buttons.push(l.Bb(264))):(this.$.isEditMode&&3===this.yb&&!this.J$b()&&Y.buttons.push(l.Bb(101)),5!==this.floatingObject.type||ce.a.YH(this.floatingObject.Kb)||this.floatingObject.Kb.IsGroup||(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
this.wrd()?Y.buttons.push(l.Bb(186)):Y.buttons.push(l.Bb(147))),this.J$b()||this.wrd()||Y.buttons.push(l.Bb(146)),We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.TGh(Y),this.sIh(Y)),We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Y.buttons.push(l.Bb(287)),We.EwaSettings.ma(167)&&0===this.floatingObject.type&&Y.buttons.push(l.Bb(249)),5===this.floatingObject.type&&Je.g(this.$).ha.Oa.oc.Y5()&&
this.$.dla&&this.$.Cha&&Y.buttons.push(l.Bb(273)))};Ze.prototype.FKa=function(l){var J=[];if(qe.a(this.$))return J;3===l?(l=!!this.$.Yf.get(5)&&this.floatingObject.tVd(),this.J$b()||(this.$.isEditMode?(l&&J.push(Jb.a.ODh),5===Je.g(this.$).ha.Oa.IC.floatingObject.type&&J.push(Jb.a.Evj)):l&&J.push(Jb.a.copy)),J.push(Jb.a.PDh)):2===l&&(We.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Je.g(this.$).ha.Oa.oc&&this.d1e(Je.g(this.$).ha.Oa.oc,J):this.d1e(Je.g(this.$).ha.Oa.IC,
J));return J};Ze.prototype.DZ=function(){var l=this.Sa,J=l.Zp(this.menuId),Y=qe.a(this.$);if(this.$.isEditMode){var za=l.Pc();this.SUc(l,J,za);J.Dc.push(za)}this.$.Yf.get(5)&&this.floatingObject.tVd()&&!this.J$b()&&!Y&&(za=l.Pc(),this.vBg(l,za),J.Dc.push(za));(za=this.$.xa.qa)&&za.Yd&&(za=za.Yd.ty||za.Yd.CK,!We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||Y||this.$.isMobileMode||za||(Y=l.Pc(),this.pDg(l,
Y),J.Dc.push(Y)));return J};Ze.prototype.hbc=function(l){var J=Je.g(this.$).ha.Oa.oc;l=l&&1!==l.yb&&l.clientPoint?l.clientPoint:Sys.UI.DomElement.getLocation(J.domElement);var Y=this.$.domElement,za=Je.g(this.$).rtl;(J=md.HelperMethods.VC(J.mg.domElement,Y,za))?(l.y=Math.max(l.y,J.y),l.x=Math.max(l.x,J.x)):Cd.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Fg.AFrameworkApplication.Kg);
return l};Ze.prototype.wrd=function(){var l=Je.g(this.$).ha.Oa.oc;return!!l&&l.isEditing};Ze.prototype.vBg=function(l,J){if(this.$.isEditMode){J.buttons.push(l.Bb(42));J.buttons.push(l.Bb(43));var Y=this.$.da.Aa(254,!0);(Y&&2===Y.EBb()||We.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.wrd())&&J.buttons.push(l.Bb(44))}else J.buttons.push(l.Bb(43))};Ze.prototype.pDg=function(l,J){J.buttons.push(l.Bb(274))};Ze.prototype.J$b=function(){return We.EwaSettings.ma(471)&&
!!Je.g(this.$).ha.Oa.Oo};Ze.prototype.d1e=function(l,J){5===l.floatingObject.type?We.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&l.isEditing?J.push(Jb.a.J1f):J.push(Jb.a.Avj):J.push(Ga.a.nVe)};Ze.prototype.TGh=function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(282));J.buttons.push(this.Sa.Bb(281));var Y=this.Sa.zw("BringToFront","BringToFrontMenuId",se.a.instance.fa(815),-1777747317);Y.menu.Dc.push(J);l.buttons.push(Y)};Ze.prototype.sIh=function(l){var J=this.Sa.Pc();
J.buttons.push(this.Sa.Bb(284));J.buttons.push(this.Sa.Bb(283));var Y=this.Sa.zw("SendToBack","SendToBackMenuId",se.a.instance.fa(816),-1777747317);Y.menu.Dc.push(J);l.buttons.push(Y)};Ck.Object.defineProperties(Ze.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.DMf}}});Object(Vd.a)(Ze,"FloatingObjectContextMenu",Ga.a,[]);var ma=b(1E3),ab=b(102),bc=b(618),Rc=b(562),Nc=oa.a.Q2g;Am(Ae,
Ze);Ae.prototype.executeCommand=function(l,J,Y){var za=this.$;this.yb=J.method;J=Y[Ae.y0c];if(!(l&68)){if(!J){if(8===l)J=Rc.a(za).dd;else{var Ua=Je.g(za).ha.Oa.oc;if(null===Ua||void 0===Ua?0:Ua.floatingObject)J=Ua.floatingObject.dd}if(!J)return ig.Task.Ra(!0)}this.isPivotChart=!!(J.Attributes&4)}if(this.isPivotChart||za.isEditMode)if(this.refresh=this.TZ=this.rwa=this.gBa=!1,Ua=Je.g(this.$).ha.Oa.oc,Cd.ULS.shipAssertTag(537167107,0,!!Ua),Ua){this.floatingObject=Ua.floatingObject;Ua=bc.a(za);if(null===
Ua||void 0===Ua?0:Ua.LRd)this.gBa=Ua=ab.f(za.kg),this.rwa=!Ua;Ua=za.wc;this.TZ=!!ma.a(za)&&!!J&&!!(J.Attributes&512)&&!(l&8)&&Ua.o3(32768);Ua.allowManualDataRefresh&&Ua.allowInteractivity&&(this.refresh=!0);l=this.hbc(Object(S.a)(kc.a,Y.eventArgs));this.Jp(l,!0)}return ig.Task.Ra(!0)};Ae.prototype.Kc=function(l,J,Y){return-149612405===J.command&&!!Y&&this.oif(l)};Ae.prototype.SUc=function(l,J,Y){this.isPivotChart&&(this.refresh&&Y.buttons.push(l.Bb(100)),this.TZ&&Y.buttons.push(l.Bb(99)),this.gBa?
Y.buttons.push(l.Bb(59)):this.rwa&&Y.buttons.push(l.Bb(58)));Ze.prototype.SUc.call(this,l,J,Y)};Ck.Object.defineProperties(Ae.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.xMf}}});Ck.Object.defineProperties(Ae,{y0c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(Vd.a)(Ae,"ChartContextMenu",Ze,[]);var id=b(12),xe=oa.a.S2g,cf=Ga.a;Am(me,cf);me.prototype.executeCommand=
function(l,J,Y){l=J.command;switch(l){case 330754562:J=Y.domElement;this.isOlap=Y.isOlap;this.VL=Y.versionkey;this.yo=Y.fieldItem;this.z_=Y.isChart;this.cI=Y.isPpm;this.vVd="supportsImplicitMeasures"in Y?Y.supportsImplicitMeasures:!1;Je.g(this.$).Kp(!0);l=id.DOMElementExtensions.getBounds(J);l=new Sys.UI.Point(l.x+l.width,l.y+l.height/2);this.iUa(l,J);"isKeyboardInput"in Y&&Y.isKeyboardInput?this.Jp(l,!1,1):this.Jp(l,!1);break;case 926905850:this.vVd&&this.yo&&5===this.yo.TypeTag&&!this.yo.IsCollapsible&&
Cd.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");bc.a(this.$).qH(this.yo,8,-1,this.VL,J);break;case -67292059:bc.a(this.$).qH(this.yo,1,-1,this.VL,J);break;case 745182485:bc.a(this.$).qH(this.yo,2,-1,this.VL,J);break;case 359279088:bc.a(this.$).qH(this.yo,4,-1,this.VL,J);break;case 547535945:bc.a(this.$).R5i(this.yo);break;default:return eg.a(l)}return ig.Task.Ra(!0)};me.prototype.Kc=function(l,J,Y){l=!1;switch(J.command){case 330754562:l=!!Y;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:l=
!0}return l};me.prototype.DZ=function(){var l=this.Sa.Zp(this.menuId);this.t_i(l);this.z_||this.isOlap||this.s_i(l);return l};me.prototype.t_i=function(l){var J=this.Sa,Y=J.Pc(),za=!1;We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(za=this.isOlap&&!this.cI&&this.vVd&&5===this.yo.TypeTag&&!this.yo.IsCollapsible);3!==this.yo.TypeTag&&37!==this.yo.TypeTag||this.yo.IsSet?17===this.yo.TypeTag||this.cI?(Y.buttons.push(J.Bb(79)),Y.buttons.push(J.Bb(this.z_?91:80)),
Y.buttons.push(J.Bb(this.z_?92:81)),Y.buttons.push(J.Bb(82))):13===this.yo.TypeTag||this.yo.IsSet?(Y.buttons.push(J.Bb(83)),Y.buttons.push(J.Bb(this.z_?91:80)),Y.buttons.push(J.Bb(this.z_?92:81)),Y.buttons.push(J.Bb(86))):(Y.buttons.push(J.Bb(79)),Y.buttons.push(J.Bb(this.z_?91:80)),Y.buttons.push(J.Bb(this.z_?92:81)),Y.buttons.push(J.Bb(za?82:86))):(Y.buttons.push(J.Bb(83)),Y.buttons.push(J.Bb(this.z_?93:84)),Y.buttons.push(J.Bb(this.z_?94:85)),Y.buttons.push(J.Bb(82)));l.Dc.push(Y)};me.prototype.s_i=
function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(78));l.Dc.push(J)};Ck.Object.defineProperties(me.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.EHd}}});Object(Vd.a)(me,"FieldListContextMenu",Ga.a,[]);var ag=b(438),tf=b(63);xd.prototype.get=function(l,J,Y){var za=this.Vag(l,"PivotFilterContextMenuCache.Get");return za&&this.DN[za]?this.DN[za][xd.ggd(J,this.$,l,Y)]:null};xd.prototype.set=
function(l,J,Y,za){var Ua=this.Vag(l,"PivotFilterContextMenuCache.Set");Ua&&(this.DN[Ua]||(this.DN[Ua]={}),this.DN[Ua][xd.ggd(J,this.$,l,za)]=Y)};xd.prototype.Q7b=function(l){l in this.DN&&this.DN[l]&&(this.DN[l]=null)};xd.prototype.Vag=function(l,J){return tf.f(this.$.qa)?this.$.activeItemName:(l=this.SNj(l,J))?l.ae:null};xd.prototype.SNj=function(l,J){l=Gf.C(l);l=Je.g(this.$).Ea.Jva(l,this.$.activeItemName);Cd.ULS.shipAssertTag(537167008,0,!!l,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",
J);return l};xd.ggd=function(l,J,Y,za){return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===za?J.qa.index+"_"+l.id+"_"+Y.FirstRow.toString()+"_"+Y.FirstColumn.toString():J.qa.index+"_"+l.id};Object(Vd.a)(xd,"PivotFilterContextMenuCache",null,[]);Object(Vd.a)(jd,"ShowPivotFilterData",null,[]);var rg=b(616),ch=b(1342),Hg=b(54),ri=oa.a.PCe,wh=Ga.a;Am(wc,wh);wc.prototype.bad=function(l,J){var Y=this,za=l.rawEvent,Ua=l.cell,Qb=l.requiresConfirmation;rg.a(this.$).Vx(Qb,function(uc){if(uc){uc=
za?new Sys.UI.DomEvent(za):null;Y.pivotData=new jd;Y.pivotData.pivotName=l.pivotName;Y.pivotData.dataSourceIndex=l.dataSourceIndex;Y.pivotData.cell=Ua;Y.pivotData.Jo=l.optionalPivotMenuAnchorParameter;if(Y.pivotData.Jo&&0<Y.pivotData.Jo.AnchorType){Y.Pmc=l.objectId;Y.UDb=l.objectVersion;var ed=Y.pivotData.Jo.AnchorType;if(4===ed||5===ed||6===ed||11===ed||9===ed||10===ed||8===ed)Y.$mb=l.location}else Y.Qzd=Y.Pmc=null,Y.Rzd=Y.UDb=-1;Je.g(Y.$).Kp(!0);Y.$.Dj(Ua);Y.k1(uc,uc?uc.target:l.domElement,Y.pivotData,
J,Y.AMa())}});return!0};wc.prototype.k1=function(l,J,Y,za){var Ua=this;if(Object(ag.a)(jd,Y)){this.pivotData=Y;this.C5b=J;this.jkf=l;this.v2b=this.pivotData.Jo?this.pivotData.Jo.AnchorValue1:-1;this.eZ=this.pivotData.Jo?this.pivotData.Jo.AnchorType:0;var Qb=!1,uc=null;uc=wc.DN.get(this.pivotData.cell,J,this.eZ);Qb=!!uc;var ed=!0;switch(this.eZ){case 4:case 5:case 6:this.uda=new Sys.UI.Point(this.$mb.x,this.$mb.y);ed=!1;break;case 7:var Dd=Sys.UI.DomElement.getBounds(J);ed=Dd.x+(0<=Dd.x?0:Dd.width);
Dd=Dd.y+(0<=Dd.y?0:Dd.height);this.uda=new Sys.UI.Point(0<=ed?ed:0,0<=Dd?Dd:0);ed=!1;break;case 8:case 10:case 9:case 11:this.uda=new Sys.UI.Point(this.$mb.x,this.$mb.y);break;default:this.uda=null}Qb&&this.Pmc===this.Qzd&&this.UDb===this.Rzd&&this.v2b===this.Gye&&this.eZ===this.Gqe?(Cd.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.csb=uc,this.uda?(this.iUa(this.uda,J),this.Jp(this.uda,this.AMa())):this.ry?(!We.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||
Ga.a.Bod(this.$,this.pivotData.cell))&&this.Jp(Ga.a.wed(this.$,this.pivotData.cell,!1),this.AMa()):wh.prototype.k1.call(this,l,J,Y,za,this.AMa())):1!==wc.QPh(J)&&(ed&&(J.parentNode.menuFetchStates=1,this.fqj(J),this.XYf(!0)),this.$.userOperationManager.ic(new Wg.a(126,0,function(hd,Ke,zf){var Dg=Ua.$;return Td.A(Dg.na.va,Ua.pivotData.cell,Ua.pivotData.dataSourceIndex,Ua.pivotData.pivotName,Dg.domElement.id,Dg.isChromeRtl,Dg.workbookContext.NovMode,lf.b(hd,Ua.CMi),lf.a(Ke,Ua.BMi),zf,J,Ua.pivotData.Jo)},
16),za))}};wc.prototype.SEd=function(l){Array.addRange(l.MenuSectionList,this.csb)};wc.prototype.Owd=function(l,J){l.parentNode.menuFetchStates=2;this.XYf(!1);if(J){if(this.C5b!==l||this.PAi())this.iUa(this.uda,l),this.Jp(this.uda,this.AMa());else if(this.ry&&!this.uda){if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!Ga.a.Bod(this.$,this.pivotData.cell))return;this.Jp(Ga.a.wed(this.$,this.pivotData.cell,!1),this.AMa())}else wh.prototype.k1.call(this,this.jkf,
l,null,null,this.AMa());this.Qzd=this.Pmc;this.Rzd=this.UDb;this.Gqe=this.eZ;this.Gye=this.v2b}};wc.prototype.AMa=function(){return 8!==this.eZ&&9!==this.eZ&&10!==this.eZ&&11!==this.eZ};wc.prototype.PAi=function(){switch(this.pivotData.Jo?this.pivotData.Jo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};wc.prototype.XYf=function(l){var J=this.C5b;if(J){if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var Y=id.DOMElementExtensions.d_(J,
"ewaprevsrc","");Y=!!Y&&"null"!==Y}else Y=!!id.DOMElementExtensions.d_(J,"ewaprevsrc","");l&&Y||!l&&!Y||(l?(J.setAttribute("ewaprevsrc",J.src),J.src=Hg.a.current.np(77)):(l=id.DOMElementExtensions.d_(J,"ewaprevsrc",""),J.src=l,J.setAttribute("ewaprevsrc",null)))}};wc.prototype.fqj=function(l){this.C5b=l};wc.QPh=function(l){var J=l.parentNode.menuFetchStates;void 0===J&&(l.parentNode.menuFetchStates=0);return J};wc.DN=null;Object(Vd.a)(wc,"PivotFilterContextMenuBase",Ga.a,[]);var th="FieldList"+oa.a.PCe;
Am(xg,wc);xg.prototype.executeCommand=function(l,J,Y){return this.bad(Y,J)?ig.Task.Ra(!0):eg.a(J.command)};xg.prototype.Kc=function(l,J,Y){return-1065117584===J.command&&!!Y};Ck.Object.defineProperties(xg.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.BMf}}});Object(Vd.a)(xg,"FieldListPivotContextMenu",wc,[]);var hg=b(29),li=b(935);Object(Vd.a)(Gg,"PivotValueFieldSettingsApplyData",null,
[]);Cg.Pbh="dataFieldCustomLabel";Cg.UGe="dataFieldSourceLabel";Cg.zTd="showValueAsSelect";Cg.xTd="showValueAsBaseFieldSelect";Cg.yTd="showValueAsBaseItemSelect";Cg.I_d="valueFieldsSettingsFieldName";Cg.$fg="valueFieldSettingTabs";Object(Vd.a)(Cg,"CssElementIds",null,[]);var Ni=b(116);Object(Vd.a)(bf,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);yg.prototype.getActiveCell=function(){return this.activeCell};Object(Vd.a)(yg,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[447]);var Si=
b(242);Object(Vd.a)(hf,"PivotValueFieldShowValueAsApplyData",null,[]);var sj=b(936),Bj=b(43),ih="<div id='showValueAsControlBody'><label for='"+Cg.zTd+"' class='"+Ni.a.wo+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+Cg.zTd+"' class='"+Ni.a.QC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+Cg.xTd+"'>{1}</label><div><select size=6 id='"+Cg.xTd+"' class='"+Ni.a.QC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+
Cg.yTd+"'>{2}</label><div><select size=6 id='"+Cg.yTd+"' class='"+Ni.a.QC+"'></select></div></div></div>",xi=Si.a;Am(ff,xi);ff.prototype.kka=function(){return this.isVisible};ff.prototype.Xna=function(l){return this.isVisible=l};ff.prototype.setFocus=function(){id.DOMElementExtensions.setFocus(this.f4.ao)};ff.prototype.render=function(l){l.appendChild(this.domElement)};ff.prototype.dispose=function(){hh.a.yc([this.f4,this.IU,this.dQ,this.f6b,this.Q0b]);xi.prototype.dispose.call(this)};ff.prototype.Jsj=
function(l){hh.a.yc([this.f6b,this.Q0b]);this.f4.clear();for(var J=Cl(l.DataFormatTypes),Y=J.next();!Y.done;Y=J.next())Y=Y.value,this.f4.tM(ff.$Nh(Y),Y.toString(),Y===l.SelectedDataFormat);this.f6b=this.de.Wd(this.f4.domElement);this.f6b.ka("change",this.Swf);this.IU.clear();J=Cl(l.BaseFieldList);for(Y=J.next();!Y.done;Y=J.next())Y=Y.value,this.IU.tM(Y.DisplayString,Y.Id.toString(),Y.Id===l.SelectedBaseField);this.Q0b=this.de.Wd(this.f4.domElement);this.Q0b.ka("change",this.xHi);this.JF=this.zia.i1a(this.dQ.ao.parentNode,
1E3,null,"",733);this.Swf(null)};ff.prototype.tR=function(l){this.f4.tR(l);this.IU.tR(l);this.dQ.tR(l)};ff.prototype.Fka=function(){this.domElement.innerHTML=String.format(ih,se.a.instance.fa(1083),se.a.instance.fa(1084),se.a.instance.fa(1085));this.M5d=new sj.a(id.DOMElementExtensions.getElementById(this.domElement,Cg.zTd),!1);this.o3d=new sj.a(id.DOMElementExtensions.getElementById(this.domElement,Cg.xTd),!1);this.p3d=new sj.a(id.DOMElementExtensions.getElementById(this.domElement,Cg.yTd),!1)};
ff.prototype.hVg=function(l){return this.cli||!ff.Jcf(l)&&!ff.Kcf(l)?!0:!!this.IU.count};ff.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var l=this;this.$.userOperationManager.ic(new Wg.a(108,0,function(J,Y,za){var Ua=l.$.na.va,Qb=parseInt(l.IU.we.value,10);J=lf.b.call(null,J,l.xNi);var uc=Td.nb(Ua,l.cell,l.externalSourceIndex,l.Jo);uc.selectedBaseField=Qb;return Td.i(Ua,"GetPivotValueFieldSettingsShowValueAsBaseItems",uc,J,Y,za,null,4)},16),this.Td)};ff.prototype.Qlf=function(){this.dQ.clear();
this.IU.we&&(this.JF.pBa(),this.dQ.ao.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};ff.prototype.mOb=function(l){var J=document.getElementById("WACDialogActionButton");this.aTj&&J&&(J.disabled=l)};ff.$Nh=function(l){switch(l){case 0:return se.a.instance.fa(1086);case 1:return se.a.instance.fa(1087);case 2:return se.a.instance.fa(1088);case 3:return se.a.instance.fa(1089);case 4:return se.a.instance.fa(1090);case 5:return se.a.instance.fa(1091);case 6:return se.a.instance.fa(1092);
case 7:return se.a.instance.fa(1093);case 8:return se.a.instance.fa(1095);case 9:return se.a.instance.fa(1096);case 10:return se.a.instance.fa(1097);case 11:return se.a.instance.fa(1098);case 12:return se.a.instance.fa(1099);case 13:return se.a.instance.fa(1100);case 14:return se.a.instance.fa(1101);default:return""}};ff.Jcf=function(l){return 11===l||12===l||14===l||13===l||4===l};ff.Kcf=function(l){return 1===l||3===l||2===l};Ck.Object.defineProperties(ff.prototype,{title:{configurable:!0,enumerable:!0,
get:function(){return se.a.instance.fa(1082)}},ywb:{configurable:!0,enumerable:!0,get:function(){var l=this.f4.we?parseInt(this.f4.we.value,10):-1,J=this.IU.we?parseInt(this.IU.we.value,10):-1,Y=this.dQ.we?parseInt(this.dQ.we.value,10):-1;return Object(tg.a)(new hf,{SelectedDataFormat:0<=l?l:-1,SelectedBaseField:J,SelectedBaseItem:Y})}},IU:{configurable:!0,enumerable:!0,get:function(){return this.o3d}},dQ:{configurable:!0,enumerable:!0,get:function(){return this.p3d}},f4:{configurable:!0,enumerable:!0,
get:function(){return this.M5d}}});Object(Vd.a)(ff,"ShowValueAsControl",Si.a,[806,2]);Object(Vd.a)(Qe,"PivotValueFieldSummarizeValueByApplyData",null,[]);var uj="<div id='summarizeValuesByControlBody'><label class='"+(Ni.a.wo+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(Ni.a.wo+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(Ni.a.QC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+oa.a.XG+
"='pivotDataFieldSelectDescription'></select></div></div>"),Cj=Si.a;Am(pd,Cj);pd.prototype.kka=function(){return this.isVisible};pd.prototype.Xna=function(l){return this.isVisible=l};pd.prototype.setFocus=function(){id.DOMElementExtensions.setFocus(this.jl.ao)};pd.prototype.render=function(l){l.appendChild(this.domElement)};pd.prototype.dispose=function(){hh.a.Ha(this.jl);Cj.prototype.dispose.call(this)};pd.prototype.focus=function(){id.DOMElementExtensions.setFocus(this.jl.ao)};pd.prototype.Isj=
function(l){this.jl.wUd();for(var J=Cl(l.AggregationTypes),Y=J.next();!Y.done;Y=J.next()){Y=Y.value;var za=Y===l.SelectedAggregation;this.jl.PUc(pd.EJh(Y),Y.toString(),za,"")}this.jl.G8c();this.jl.ao.disabled=l.AggregationsDisabled};pd.prototype.gij=function(){this.jl.hij()};pd.prototype.Fka=function(){this.domElement.innerHTML=String.format(uj,se.a.instance.fa(1066),se.a.instance.fa(1067));this.Kee=new sj.a(id.DOMElementExtensions.getElementById(this.domElement,pd.CHf),!1)};pd.EJh=function(l){switch(l){case 0:return se.a.instance.fa(1069);
case 1:return se.a.instance.fa(1070);case 2:return se.a.instance.fa(1071);case 3:return se.a.instance.fa(1072);case 4:return se.a.instance.fa(1073);case 5:return se.a.instance.fa(1074);case 6:return se.a.instance.fa(1075);case 7:return se.a.instance.fa(1076);case 8:return se.a.instance.fa(1077);case 9:return se.a.instance.fa(1078);case 10:return se.a.instance.fa(1079);case 11:return se.a.instance.fa(1080);default:return""}};Ck.Object.defineProperties(pd.prototype,{ywb:{configurable:!0,enumerable:!0,
get:function(){var l=this.jl.we?parseInt(this.jl.we.value,10):-1;return Object(tg.a)(new Qe,{Aggregation:0<=l?l:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return se.a.instance.fa(1081)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.jl.ao.disabled},set:function(l){this.jl.ao.disabled=!l}},jl:{configurable:!0,enumerable:!0,get:function(){return this.Kee}}});pd.CHf="pivotDataFieldSelect";Object(Vd.a)(pd,"SummarizeValuesByControl",Si.a,[806,2]);var Vh=b(214),yj=b(491);
td.prototype.VHj=function(l,J){l.set_visible(!1);J.set_visible(!0)};Object(Vd.a)(td,"DefaultTabSwitchBehaviour",null,[825]);Lc.GIj="TabsContainer";Lc.qIj="TabTitlesContainer";Lc.oIj="TabTitle";Lc.pIj="TabTitleText";Lc.SVd="TabTitleActive";Object(Vd.a)(Lc,"MultitabControlStyles",null,[]);var yi=b(42),Aj=b(86),W=b(91),Ja=b(57);ic.prototype.dispose=function(){yi.a.removeHandler(this.fk,"keyup",Object(ci.a)(this,this.E$a,"onTitleKeyUp"));yi.a.removeHandler(this.fk,"click",this.ZGc);this.fk=this.cga=null};
ic.prototype.setActive=function(l){l?Sys.UI.DomElement.addCssClass(this.fk,Lc.SVd):Sys.UI.DomElement.removeCssClass(this.fk,Lc.SVd);this.cga&&this.cga.setAttribute(W.a.Eha,l)};ic.prototype.E$a=function(l){l.keyCode!==Aj.a.ei&&l.keyCode!==Aj.a.hpa||this.ZGc(l)};ic.prototype.WBc=function(){this.fk.setAttribute(W.a.Rd,W.a.Sr);this.cga.setAttribute(W.a.Pt,this.Tp);this.cga.setAttribute(W.a.Rd,W.a.Nob)};Ck.Object.defineProperties(ic.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.fk}},
title:{configurable:!0,enumerable:!0,get:function(){return this.Tp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.fk,Lc.SVd)},set:function(l){this.setActive(l)}}});Object(Vd.a)(ic,"TabTitleControl",null,[2]);var Eb=b(39);Hb.prototype.QRf=function(){this.Mmb=document.createElement("ul");this.Mmb.className=Lc.qIj;this.Dmb=document.createElement("div");this.Dmb.className=Lc.GIj;for(var l=0;l<this.Wzc;++l){var J=this.QY.oa(l),Y=this.vFa.oa(l);J.set_visible(!1);
Y.isActive=!1;var za=document.createElement("div");J.render(za);this.Dmb.appendChild(za);this.Mmb.appendChild(Y.uc)}this.uc.appendChild(this.Mmb);this.uc.appendChild(this.Dmb);this.vsd(this.T1)&&(this.vFa.oa(this.T1).isActive=!0,this.QY.oa(this.T1).set_visible(!0))};Hb.prototype.dispose=function(){for(var l=0;l<this.Wzc;++l)this.QY.oa(l).dispose(),this.vFa.oa(l).dispose();this.vFa=this.QY=this.fk=this.Dmb=this.Mmb=null};Hb.prototype.setFocus=function(){this.QY.oa(this.T1).setFocus()};Hb.prototype.vsd=
function(l){return 0<=l&&l<this.Wzc};Hb.prototype.L8f=function(l){this.T1!==l&&this.vsd(l)&&(this.Nxg.VHj(this.QY.oa(this.T1),this.QY.oa(l)),this.vFa.oa(this.T1).isActive=!1,this.vFa.oa(l).isActive=!0,this.T1=l,this.setFocus())};Hb.prototype.Q6g=function(l){var J=this;return function(){J.L8f(l)}};Ck.Object.defineProperties(Hb.prototype,{Wzc:{configurable:!0,enumerable:!0,get:function(){return this.QY.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.T1},set:function(l){this.L8f(l)}},
uc:{configurable:!0,enumerable:!0,get:function(){return this.fk}},visible:{configurable:!0,enumerable:!0,get:function(){return Eb.a.isVisible(this.fk)},set:function(l){this.fk.style.visibility=l?"visible":"hidden"}}});Object(Vd.a)(Hb,"MultitabControl",null,[803,2]);var gc=li.a;Am(Ma,gc);Ma.prototype.dispose=function(){this.P5c=this.psb=this.OSa=this.tSc=null;hh.a.Ha(this.oga);this.oga=null;gc.prototype.dispose.call(this)};Ma.prototype.initialize=function(){var l="<div id='"+Cg.UGe+"' class='"+Ni.a.wo+
"'></div><div id='"+Cg.Pbh+"' class='"+Ni.a.wo+"'><label for='"+Cg.I_d+"'>{0}</label><input type='text' id='"+Cg.I_d+"' value='{1}' class='"+Ni.a.QC+" UIFont' /></div><div id='"+Cg.$fg+"'></div>";l=String.format(l,se.a.instance.fa(1065),hg.a.Sf(this.Zfg));this.Qb.innerHTML=l;this.Ne||(this.e3(),this.fl());this.mke=[-103190598];this.c1h();gc.prototype.initialize.call(this)};Ma.prototype.close=function(l){1===l&&(this.F3f=!1);gc.prototype.close.call(this,l)};Ma.prototype.ZIe=function(l){this.BR=l;this.domElement.disabled=
l;for(var J=["input","option","select"],Y=0,za=J.length;Y<za;++Y)for(var Ua=this.domElement.getElementsByTagName(J[Y]),Qb=0;Qb<Ua.length;++Qb)Ua[Qb].disabled=l};Ma.prototype.fl=function(){this.psb=document.getElementById(Cg.I_d);this.P5c=id.DOMElementExtensions.getElementById(this.Qb,Cg.UGe);var l=id.DOMElementExtensions.getElementById(this.Qb,Cg.$fg);this.tSc=new pd(document.createElement("div"));this.OSa=new ff(document.createElement("div"),this.$,this.cell,this.Jo,this.externalSourceIndex,this.Td,
this.zia,!this.isOlap);var J;this.oga=new Hb(l,(J=new P.a,J.add(this.sTa),J.add(this.OSa),J));this.oga.QRf()};Ma.prototype.zqc=function(){var l=new Ma(this.cell,this.Jo,this.externalSourceIndex,this.Zfg,this.$,this.Td,this.zia,this.isOlap,this.cI);l.initialize();l.kf()};Ma.prototype.BUa=function(){var l=new yj.a;if(!this.F3f)return l.isValid=!0,l;this.psb.value.length?l.isValid=!0:(this.ZIe(!0),l.error=wg.a.gd(1,0,748,763,0,1783218700,"PivotTableValueFieldNoBlank"),this.BR=!0,this.Ne||(this.Tx.disabled=
!0),l.isValid=!1);return l};Ma.prototype.w6e=function(){this.BR=!1;this.Ne||(this.Tx.disabled=!1);this.ZIe(!1)};Ma.prototype.Oya=function(l){var J=new rh.a(2105621672,0,this.$.fd,30,null);this.$.Ka.$b(J);this.sX(5,l.yb,"Number Format");return!0};Ma.prototype.um=function(){this.OBa=String.format(se.a.instance.Ab(61),null);gc.prototype.um.call(this)};Ma.prototype.setFocus=function(){if(this.Ne){var l=id.DOMElementExtensions.getElementById(this.Qb,pd.CHf);Vh.a.vBc(l)}else this.oga.setFocus()};Ma.prototype.vk=
function(){var l=this,J=this.OSa.ywb,Y=new bf(J.SelectedDataFormat,J.SelectedBaseField,J.SelectedBaseItem);return function(){return new yg(l.externalSourceIndex,l.cell,l.psb.value,l.sTa.ywb.Aggregation,Y)}};Ma.prototype.Nx=function(){var l=this,J=Object(tg.a)(new Gg,{PivotValueFieldSummarizeValueByApplyData:this.sTa.ywb,PivotValueFieldShowValueAsApplyData:this.OSa.ywb,PivotValueFieldTitle:this.psb.value});return function(Y,za,Ua){var Qb=l.$.na.va;Y=lf.b(Y,l.mHi);var uc=Td.nb(Qb,l.cell,l.externalSourceIndex,
l.Jo);uc.pivotValueFieldSettingsApplyData=J;return Td.i(Qb,"ApplyPivotValueFieldSettings",uc,Y,za,Ua,null,0)}};Ma.prototype.tR=function(l){var J=this;this.$.da.$a(40,function(){J.OSa.tR(l)})};Ma.prototype.c1h=function(){var l=this;this.$.userOperationManager.ic(new Wg.a(123,0,function(J,Y,za){var Ua=l.$.na.va;J=lf.b.call(null,J,l.wNi);var Qb=Td.nb(Ua,l.cell,l.externalSourceIndex,l.Jo);return Td.i(Ua,"GetPivotValueFieldSettingsInitial",Qb,J,Y,za,null,4)},16),this.Td)};Ck.Object.defineProperties(Ma.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},bfa:{configurable:!0,enumerable:!0,get:function(){return this.mke}},tDb:{configurable:!0,enumerable:!0,get:function(){return this.oga}},sTa:{configurable:!0,enumerable:!0,get:function(){return this.tSc}},Iu:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(Vd.a)(Ma,"ValueFieldSettingsDialog",li.a,[]);var Yc=oa.a.T2g,vd=Ga.a;Am(Zd,vd);Zd.prototype.executeCommand=function(l,J,Y,za){var Ua=this;l=J.command;
switch(l){case -1453503574:za=Y.domElement;this.yo=Y.fieldItem;this.R0d=Y.zoneCount;this.aTa=Y.sourceAxis;this.Zyc=Y.sourceAxisPos;this.Jo=Y.optionalPivotMenuAnchorParameter;this.VL=Y.versionkey;this.isOlap=Y.isOlap;this.cI=Y.isPpm;this.c3a="fieldItemsupportsImplicitMeasures"in Y?Y.fieldItemsupportsImplicitMeasures:!1;this.cell=Y.cell;this.externalSourceIndex=Y.externalSourceIndex;Je.g(this.$).Kp(!0);l=id.DOMElementExtensions.getBounds(za);var Qb=new Sys.UI.Point(l.x,l.y+l.height);this.$.isChromeRtl&&
(Qb.x+=l.width);this.iUa(Qb,za);"isKeyboardInput"in Y&&Y.isKeyboardInput?this.Jp(Qb,!1,1):this.Jp(Qb,!1);break;case 495005930:bc.a(this.$).Xfh();break;case -1170196828:bc.a(this.$).qH(this.yo,this.aTa,this.Zyc-1,this.VL,J);break;case -889576107:bc.a(this.$).qH(this.yo,this.aTa,this.Zyc+2,this.VL,J);break;case 2033235475:bc.a(this.$).qH(this.yo,this.aTa,this.R0d,this.VL,J);break;case 389774337:bc.a(this.$).qH(this.yo,this.aTa,0,this.VL,J);break;case -96230454:bc.a(this.$).qH(this.yo,4,-1,this.VL,J);
break;case 74086617:bc.a(this.$).qH(this.yo,1,-1,this.VL,J);break;case 1529312473:bc.a(this.$).qH(this.yo,2,-1,this.VL,J);break;case 563292088:this.c3a&&Cd.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");bc.a(this.$).qH(this.yo,8,-1,this.VL,J);break;case -1092351914:bc.a(this.$).qH(this.yo,0,-1,this.VL,J);break;case -2141589616:var uc=Hf.GetServiceTaskFactory.Ua(this.$.da,12,477,za.dka());return Pg.TaskExtensions.Ba(uc,function(){(new Ma(Ua.cell,Ua.Jo,Ua.externalSourceIndex,
Ua.yo.Name,Ua.$,J,uc.result,Ua.isOlap,Ua.cI)).initialize()},this.la);default:return eg.a(l)}return ig.Task.Ra(!0)};Zd.prototype.Kc=function(l,J,Y){l=!1;switch(J.command){case -1453503574:l=!!Y;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:l=!0}return l};Zd.prototype.DZ=function(){var l=this.Sa.Zp(this.menuId);this.A_i(l,this.Zyc,this.R0d);this.B_i(l,this.aTa);this.C_i(l);
8===this.aTa&&this.y_i(l);return l};Zd.prototype.A_i=function(l,J,Y){var za=this.Sa,Ua=za.Pc();J||J!==Y-1?!J&&J<Y-1?(Ua.buttons.push(za.Bb(64)),Ua.buttons.push(za.Bb(61)),Ua.buttons.push(za.Bb(66)),Ua.buttons.push(za.Bb(63))):0<J&&J<Y-1?(Ua.buttons.push(za.Bb(60)),Ua.buttons.push(za.Bb(61)),Ua.buttons.push(za.Bb(62)),Ua.buttons.push(za.Bb(63))):0<J&&J===Y-1&&(Ua.buttons.push(za.Bb(60)),Ua.buttons.push(za.Bb(65)),Ua.buttons.push(za.Bb(62)),Ua.buttons.push(za.Bb(67))):(Ua.buttons.push(za.Bb(64)),Ua.buttons.push(za.Bb(65)),
Ua.buttons.push(za.Bb(66)),Ua.buttons.push(za.Bb(67)));l.Dc.push(Ua)};Zd.prototype.B_i=function(l,J){var Y=this.Sa,za=Y.Pc(),Ua=1!==J&&(!this.isOlap||this.cI||8!==J||this.c3a),Qb=2!==J&&(!this.isOlap||this.cI||8!==J||this.c3a),uc=8!==J&&-2!==this.yo.PivotTableIndex&&(!this.isOlap||this.cI||this.c3a);za.buttons.push(Y.Bb(4===J||this.yo.IsSet||-2===this.yo.PivotTableIndex||this.isOlap&&!this.cI&&8===J&&!this.c3a?72:68));8===this.Jo.AnchorType||10===this.Jo.AnchorType?(za.buttons.push(Y.Bb(Ua?95:97)),
za.buttons.push(Y.Bb(Qb?96:98))):(za.buttons.push(Y.Bb(Ua?69:73)),za.buttons.push(Y.Bb(Qb?70:74)));za.buttons.push(Y.Bb(uc?71:75));l.Dc.push(za)};Zd.prototype.C_i=function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(76));l.Dc.push(J)};Zd.prototype.y_i=function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(77));l.Dc.push(J)};Ck.Object.defineProperties(Zd.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.FHd}}});
Object(Vd.a)(Zd,"FieldWellContextMenu",Ga.a,[]);var fe=b(1305);Am(bg,wc);bg.prototype.executeCommand=function(l,J,Y){var za=!1,Ua=J.command;switch(Ua){case 37023044:za=this.bad(Y,J);break;case 541421805:case -569786022:za=this.Ojd(l,J)}return za?ig.Task.Ra(!0):eg.a(Ua)};bg.prototype.Kc=function(l,J,Y){l=!1;switch(J.command){case 37023044:l=!!Y;break;case 541421805:case -569786022:l=!0}return l};bg.prototype.Ojd=function(l,J){var Y=8===l,za=this.$,Ua=Rc.a(za),Qb=Je.g(za).ha.Oa.oc,uc=l=null;Y&&Ua?(l=
Ua.chartId,uc=Ua.dd):!Y&&Qb&&(l=Qb.floatingObject.id,uc=Qb.floatingObject.dd);return bg.Fse(uc,260)?(Y={},za.Dj(Y),Y.FirstColumn=Y.FirstRow=-1,za={},uc=(za.rawEvent=null,za.pivotName=null,za.cell=Y,za.requiresConfirmation=bg.Fse(uc,64),za.dataSourceIndex=uc.ExternalSourceIndex,za),Qb?(Ua=Qb.floatingObject,uc.domElement=Qb.domElement,uc.objectId=Ua.id,uc.objectVersion=Ua.version):Ua&&(uc.domElement=Ua.yl,uc.objectId=Ua.chartId,uc.objectVersion=Ua.Iye),Qb={AnchorType:7},Qb.ChartId=l,Qb.AnchorValue1=
-1,Qb.AnchorValue2=-1,uc.optionalPivotMenuAnchorParameter=Qb,this.bad(uc,J)):!1};bg.Fse=function(l,J){return(l.Attributes&J)===J};Ck.Object.defineProperties(bg.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.HMf}}});Object(Vd.a)(bg,"PivotFilterContextMenu",wc,[]);var re=b(1340),Oe=b(1045),Wc=b(159),Pf=b(28),nf=oa.a.X2g,Qg=nf+".RemoveField",Ng=nf+".Subtotal",ti=nf+".ClearFilter",qh=nf+".LayoutSameColumn",
fi=nf+".LayoutNextColumn",$h=Ga.a;Am(pf,$h);pf.prototype.executeCommand=function(l,J,Y){J=J.command;l=null;this.grid=Je.g(this.$);this.activeCell=Gf.o(this.grid.ha.ta.activeCell,this.$);if(this.$.isEditMode&&(this.Gc=this.grid.Rb.lp(this.grid.ha.ta.activeCell),!this.Gc))return Cd.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),Pg.TaskExtensions.h5();this.w0d=this.$.na.va;this.X0a=Object(S.a)(kc.a,Y.eventArgs);switch(J){case 671488277:this.Kyj()?this.JVh():(this.lcb(),this.showPivotTableContextMenu());
break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,
5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.mSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.mSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.mSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.mSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);
break;case 282586693:this.mSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.mSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:Y=Number.parseInvariant(Y.MenuItemId.split(".")[2]);this.mSa(11,Y);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Zd(-1556797033,kg.a.Vb,8,null);break;case 1514686611:this.lsi();
break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:Y=Number.parseInvariant(Y.MenuItemId);this.aZg(Y);break;case 1778578888:Y=Number.parseInvariant(Y.MenuItemId);this.aLg(Y);break;default:l=eg.a(J)}return l||Pg.TaskExtensions.h5()};pf.prototype.Kc=function(l,J){l=!1;switch(J.command){case 671488277:l=Oe.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:l=!0;break;case 1600778266:l=!0;break;case -556893687:l=!0;break;case -1966978671:l=
!0;break;case -1951357930:l=!0;break;case -1390365353:case -1457478532:l=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:l=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:l=!0;break;case -1007663920:case 234234584:case 1194992911:l=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:l=
!0}return l};pf.prototype.Kyj=function(){if(!this.$.isEditMode||this.Gc.Pgc)return!1;var l=this.F2f(!1);return We.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.Gc.isOlap||l:!this.Gc.xqd()||l};pf.prototype.$c=function(l,J){var Y=!1;switch(J){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:Y=this.$S();break;case -1007663920:case 234234584:Y=
this.mxj()||this.$S();break;case 1194992911:Y=this.nxj()||this.$S();break;case 1217404289:Y=!re.j(this.Db.LabelOrDateFilterType)||this.$S();break;case -743135194:Y=!re.m(this.Db.ValueFilterType)&&!re.l(this.Db.ValueFilterType)||this.$S();break;case 771421327:Y=0===this.Db.LabelOrDateFilterType&&0===this.Db.ValueFilterType&&!this.Db.HasManualFilter||this.$S();break;case 1015867427:Y=!re.i(this.Db.LabelOrDateFilterType)||this.$S();break;case 1105960559:Y=!re.k(this.Db.LabelOrDateFilterType)||this.$S()}return Y||
$h.prototype.$c.call(this,l,J)};pf.prototype.lcb=function(){this.Cab=this.Db=this.$f=null};pf.prototype.gVd=function(){this.grid.XP(this.Uq);this.$.Ka.hGa(this.su)};pf.prototype.OYd=function(){this.grid.mL(this.Uq);this.$.Ka.Qbb(this.su)};pf.prototype.DKb=function(){if(this.Gc&&this.Gc.Yo){this.$f=this.Gc.Yo;this.Db=this.Gc.lbc();if(this.s3f()){var l=this.Gc.uL[4===this.$f.CellType?this.Gc.R5c-1:this.$f.CurrentFieldIndex-1];l&&(this.Cab=-2===l.Index?this.Gc.ZGe:l.Caption)}this.uai();this.Db&&8===
this.$f.CellArea&&(this.iA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Db.DataFieldAggregationType,this.iA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Db.DataFieldFormatType,this.iA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Db.BaseFieldIndex,this.iA.PivotValueFieldTitle=this.Db.Caption)}};pf.prototype.F2f=function(l){return this.Gc?this.Gc.isOlap&&!this.Gc.W7a(!l):!1};pf.prototype.uxj=function(){var l=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",
!1);return 1!==this.Db.MeasureType&&(!this.Gc.ghf||l&&2===this.Db.MeasureType)};pf.prototype.DZ=function(){var l=this.Sa.Zp(this.menuId),J=this.Sa.Pc();if(this.Gc)this.$f&&this.Gc.Yo&&this.$f!==this.Gc.Yo&&Cd.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Db&&this.Db!==this.Gc.lbc()&&Cd.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return l;this.XGh(l);if(this.$.isEditMode){this.refresh&&
this.lIh(l);if(this.$f&&this.Db){var Y=this.Sa.Pc();this.AIh(Y);this.lHh(Y);l.Dc.push(Y)}this.TZ&&J.buttons.push(this.Sa.Bb(99));this.$f&&this.Db&&this.IHh(l);if(this.expandCollapse){Y=this.Sa.zw("ContextMenu.PivotExpandCollapse",null,se.a.instance.fa(1130),589118293);var za=this.Sa.Pc();za.buttons.push(this.Sa.Bb(243));za.buttons.push(this.Sa.Bb(244));za.buttons.push(this.Sa.Bb(245));za.buttons.push(this.Sa.Bb(246));Y.menu.Dc.push(za);Y&&0<za.buttons.length&&J.buttons.push(Y)}this.$f&&this.mIh(l);
this.$f&&this.Db&&8===this.$f.CellArea&&8!==this.$f.CellType&&(Y=this.Sa.Pc(),this.uxj()&&this.CIh(Y),3!==this.$f.CellType&&this.xIh(Y),l.Dc.push(Y));!this.Gc.isOlap&&this.$f&&0===this.$f.CellType&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.wIh(l);this.Kli()?J.buttons.push(this.Sa.Bb(257)):J.buttons.push(this.Sa.Bb(258));this.qpd?J.buttons.push(this.Sa.Bb(59)):J.buttons.push(this.Sa.Bb(58))}l.Dc.push(J);return l};pf.prototype.tSd=function(){return this.Db&&
this.Db.Caption?20<this.Db.Caption.length:!1};pf.prototype.dfd=function(l){return this.Db&&this.Db.Caption?l?this.Db.Caption.substring(0,20)+"...":this.Db.Caption:""};pf.prototype.Kva=function(l){return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?da.a.hashCode(l).toString():l};pf.prototype.AIh=function(l){if(this.$f&&this.Db&&4!==this.$f.CellArea){var J=this.lva(this.AH("PivotTableContextMenu.Sort",this.Kva(this.Db.Caption)),-1777747317,0,0!==this.Db.SortInfo,
se.a.instance.fa(228)),Y=this.Sa.Pc();Y.buttons.push(this.ie("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Db.SortInfo,se.a.instance.fa(229)));Y.buttons.push(this.ie("PivotTableContextMenu.SortDescending",234234584,0,2===this.Db.SortInfo,se.a.instance.fa(230)));1!==this.$f.CellArea&&2!==this.$f.CellArea||Y.buttons.push(this.ie("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Db.SortInfo||4===this.Db.SortInfo,se.a.instance.fa(155)));J.menu.Dc.push(Y);J&&0<Y.buttons.length&&
l.buttons.push(J)}};pf.prototype.lHh=function(l){if(this.$f&&this.Db&&(1===this.$f.CellArea||2===this.$f.CellArea)){var J=this.Jyj(),Y=this.lva(this.AH("PivotTableContextMenu.Filter",this.Kva(this.Db.Caption)),-1777747317,0,J,se.a.instance.fa(650)),za=this.Sa.Pc(),Ua="",Qb=this.tSd(),uc=String.format(se.a.instance.Ab(156),this.dfd(Qb));Qb&&(Ua=String.format(se.a.instance.Ab(156),this.Db.Caption));J=this.Kva(this.Db.Caption)+"."+(J?"enabled":"disabled");Ua=this.ie(this.AH(ti,J),771421327,0,!1,uc,"0",
Ua,8,D.a.R2a);J=this.Kva(this.Db.Caption)+"."+this.Db.LabelOrDateFilterType.toString();this.Db.IsDateField?(uc=this.lva(this.AH("PivotTableContextMenu.DateFilter",J),-1777747317,0,0!==this.Db.LabelOrDateFilterType,se.a.instance.fa(96)),this.$Gh(uc.menu)):(uc=this.lva(this.AH("PivotTableContextMenu.LabelFilter",J),-1777747317,0,0!==this.Db.LabelOrDateFilterType,se.a.instance.fa(648)),this.HHh(uc.menu));J=this.Kva(this.Db.Caption)+"."+this.Db.ValueFilterType.toString();J=this.lva(this.AH("PivotTableContextMenu.ValueFilter",
J),-1777747317,0,0!==this.Db.ValueFilterType,se.a.instance.fa(649));this.OIh(J.menu);Qb=this.Sa.Pc();Qb.buttons.push(this.ie("PivotTableContextMenu.ManualFilter",1514686611,0,this.Db.HasManualFilter,se.a.instance.fa(93)));za.buttons.push(Ua);za.buttons.push(uc);za.buttons.push(J);Y.menu.Dc.push(za);Y.menu.Dc.push(Qb);Y&&0<za.buttons.length&&l.buttons.push(Y)}};pf.prototype.$Gh=function(l){l.Dc.push(this.Gbc(!0,!1));l.Dc.push(this.dOh());l.Dc.push(this.cOh());l.Dc.push(this.VPh());l.Dc.push(this.YPh());
l.Dc.push(this.WPh());l.Dc.push(this.XPh());l.Dc.push(this.ZPh());l.Dc.push(this.$Ph());l.Dc.push(this.RNh())};pf.prototype.PGh=function(l){l.Dc.push(this.Gbc(!0,!0));l.Dc.push(this.FWh());l.Dc.push(this.YTh())};pf.prototype.HHh=function(l){l.Dc.push(this.Gbc(!0,!1));l.Dc.push(this.c_e(!0));l.Dc.push(this.yKh());l.Dc.push(this.$Mh());l.Dc.push(this.dZe(!0));l.Dc.push(this.kYe(!0))};pf.prototype.OIh=function(l){l.Dc.push(this.Gbc(!1,!1));l.Dc.push(this.c_e(!1));l.Dc.push(this.dZe(!1));l.Dc.push(this.kYe(!1));
l.Dc.push(this.$_h())};pf.prototype.$_h=function(){var l=this.Sa.Pc();l.buttons.push(this.ie("PivotTableContextMenu.Top10",-1611233597,0,re.l(this.Db.ValueFilterType),se.a.instance.fa(104)));return l};pf.prototype.$Mh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.Contains",786260386,0,10===this.Db.LabelOrDateFilterType,se.a.instance.fa(651),"10")),l.buttons.push(this.ie("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Db.LabelOrDateFilterType,se.a.instance.fa(652),
"11")));return l};pf.prototype.yKh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Db.LabelOrDateFilterType,se.a.instance.fa(653),"6")),l.buttons.push(this.ie("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Db.LabelOrDateFilterType,se.a.instance.fa(654),"7")),l.buttons.push(this.ie("PivotTableContextMenu.EndsWith",786260386,0,8===this.Db.LabelOrDateFilterType,se.a.instance.fa(655),"8")),l.buttons.push(this.ie("PivotTableContextMenu.DoesNotEndWith",
786260386,0,9===this.Db.LabelOrDateFilterType,se.a.instance.fa(656),"9")));return l};pf.prototype.c_e=function(l){var J=this.Sa.Pc();if(this.Db){var Y=l?re.c:re.f;J.buttons.push(this.ie(this.AH("PivotTableContextMenu.Equals",Y),786260386,0,l?4===this.Db.LabelOrDateFilterType:18===this.Db.ValueFilterType,se.a.instance.fa(99),l?"4":"18"));J.buttons.push(this.ie(this.AH("PivotTableContextMenu.DoesNotEqual",Y),786260386,0,l?5===this.Db.LabelOrDateFilterType:19===this.Db.ValueFilterType,se.a.instance.fa(100),
l?"5":"19"))}return J};pf.prototype.dZe=function(l){var J=this.Sa.Pc();if(this.Db){var Y=l?re.c:re.f;J.buttons.push(this.ie(this.AH("PivotTableContextMenu.GreaterThan",Y),786260386,0,l?12===this.Db.LabelOrDateFilterType:20===this.Db.ValueFilterType,se.a.instance.fa(101),l?"12":"20"));J.buttons.push(this.ie(this.AH("PivotTableContextMenu.GreaterThanOrEqualTo",Y),786260386,0,l?13===this.Db.LabelOrDateFilterType:21===this.Db.ValueFilterType,se.a.instance.fa(657),l?"13":"21"));J.buttons.push(this.ie(this.AH("PivotTableContextMenu.LessThan",
Y),786260386,0,l?14===this.Db.LabelOrDateFilterType:22===this.Db.ValueFilterType,se.a.instance.fa(102),l?"14":"22"));J.buttons.push(this.ie(this.AH("PivotTableContextMenu.LessThanOrEqualTo",Y),786260386,0,l?15===this.Db.LabelOrDateFilterType:23===this.Db.ValueFilterType,se.a.instance.fa(658),l?"15":"23"))}return J};pf.prototype.kYe=function(l){var J=this.Sa.Pc();if(this.Db){var Y=l?re.c:re.f;J.buttons.push(this.ie(this.AH("PivotTableContextMenu.Between",Y),786260386,0,l?16===this.Db.LabelOrDateFilterType:
24===this.Db.ValueFilterType,se.a.instance.fa(103),l?"16":"24"));J.buttons.push(this.ie(this.AH("PivotTableContextMenu.NotBetween",Y),786260386,0,l?17===this.Db.LabelOrDateFilterType:25===this.Db.ValueFilterType,se.a.instance.fa(659),l?"17":"25"))}return J};pf.prototype.Gbc=function(l,J){var Y=this.Sa.Pc();if(this.Db){var za=se.a.instance.fa(97),Ua=l?this.Db.LabelOrDateFilterType.toString():this.Db.ValueFilterType.toString(),Qb=["PivotTableContextMenu.ClearFilter",this.Kva(this.Db.Caption),Ua];l=
l?this.Db.IsDateField?J?1015867427:1105960559:1217404289:-743135194;Qb.push(l.toString());Qb=Qb.join(".");za=this.ie(Qb,l,0,!1,za,Ua,za,8,D.a.R2a);Y.buttons.push(za)}return Y};pf.prototype.dOh=function(){var l=this.Sa.Pc();this.Db&&l.buttons.push(this.ie(this.AH("PivotTableContextMenu.Equals",re.d),786260386,0,26===this.Db.LabelOrDateFilterType,se.a.instance.fa(99),"26"));return l};pf.prototype.cOh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.Before",786260386,
0,27===this.Db.LabelOrDateFilterType,se.a.instance.fa(111),"27")),l.buttons.push(this.ie("PivotTableContextMenu.After",786260386,0,28===this.Db.LabelOrDateFilterType,se.a.instance.fa(112),"28")),l.buttons.push(this.ie("PivotTableContextMenu.Between",786260386,0,29===this.Db.LabelOrDateFilterType,se.a.instance.fa(103),"29")));return l};pf.prototype.VPh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Db.LabelOrDateFilterType,se.a.instance.fa(109),
"30")),l.buttons.push(this.ie("PivotTableContextMenu.Today",1778578888,0,31===this.Db.LabelOrDateFilterType,se.a.instance.fa(108),"31")),l.buttons.push(this.ie("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Db.LabelOrDateFilterType,se.a.instance.fa(110),"32")));return l};pf.prototype.YPh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Db.LabelOrDateFilterType,se.a.instance.fa(114),"33")),l.buttons.push(this.ie("PivotTableContextMenu.ThisWeek",
1778578888,0,34===this.Db.LabelOrDateFilterType,se.a.instance.fa(113),"34")),l.buttons.push(this.ie("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Db.LabelOrDateFilterType,se.a.instance.fa(115),"35")));return l};pf.prototype.WPh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Db.LabelOrDateFilterType,se.a.instance.fa(116),"36")),l.buttons.push(this.ie("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Db.LabelOrDateFilterType,
se.a.instance.fa(117),"37")),l.buttons.push(this.ie("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Db.LabelOrDateFilterType,se.a.instance.fa(118),"38")));return l};pf.prototype.XPh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Db.LabelOrDateFilterType,se.a.instance.fa(119),"39")),l.buttons.push(this.ie("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.Db.LabelOrDateFilterType,se.a.instance.fa(120),"40")),
l.buttons.push(this.ie("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Db.LabelOrDateFilterType,se.a.instance.fa(121),"41")));return l};pf.prototype.ZPh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.NextYear",1778578888,0,42===this.Db.LabelOrDateFilterType,se.a.instance.fa(122),"42")),l.buttons.push(this.ie("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Db.LabelOrDateFilterType,se.a.instance.fa(123),"43")),l.buttons.push(this.ie("PivotTableContextMenu.LastYear",
1778578888,0,44===this.Db.LabelOrDateFilterType,se.a.instance.fa(124),"44")));return l};pf.prototype.$Ph=function(){var l=this.Sa.Pc();if(this.Db){l.buttons.push(this.ie("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Db.LabelOrDateFilterType,se.a.instance.fa(125),"45"));var J=this.lva("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,re.i(this.Db.LabelOrDateFilterType),se.a.instance.fa(126));this.PGh(J.menu);l.buttons.push(J)}return l};pf.prototype.RNh=function(){var l=this.Sa.Pc();
this.Db&&l.buttons.push(this.ie("PivotTableContextMenu.CustomFilter",786260386,0,this.Gyj(this.Db.LabelOrDateFilterType),se.a.instance.fa(107),"26"));return l};pf.prototype.FWh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Db.LabelOrDateFilterType,se.a.instance.fa(127),"46")),l.buttons.push(this.ie("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Db.LabelOrDateFilterType,se.a.instance.fa(128),"47")),l.buttons.push(this.ie("PivotTableContextMenu.Quarter3",
1778578888,0,48===this.Db.LabelOrDateFilterType,se.a.instance.fa(129),"48")),l.buttons.push(this.ie("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Db.LabelOrDateFilterType,se.a.instance.fa(130),"49")));return l};pf.prototype.YTh=function(){var l=this.Sa.Pc();this.Db&&(l.buttons.push(this.ie("PivotTableContextMenu.January",1778578888,0,50===this.Db.LabelOrDateFilterType,se.a.instance.fa(131),"50")),l.buttons.push(this.ie("PivotTableContextMenu.February",1778578888,0,51===this.Db.LabelOrDateFilterType,
se.a.instance.fa(132),"51")),l.buttons.push(this.ie("PivotTableContextMenu.March",1778578888,0,52===this.Db.LabelOrDateFilterType,se.a.instance.fa(133),"52")),l.buttons.push(this.ie("PivotTableContextMenu.April",1778578888,0,53===this.Db.LabelOrDateFilterType,se.a.instance.fa(134),"53")),l.buttons.push(this.ie("PivotTableContextMenu.May",1778578888,0,54===this.Db.LabelOrDateFilterType,se.a.instance.fa(135),"54")),l.buttons.push(this.ie("PivotTableContextMenu.June",1778578888,0,55===this.Db.LabelOrDateFilterType,
se.a.instance.fa(136),"55")),l.buttons.push(this.ie("PivotTableContextMenu.July",1778578888,0,56===this.Db.LabelOrDateFilterType,se.a.instance.fa(137),"56")),l.buttons.push(this.ie("PivotTableContextMenu.August",1778578888,0,57===this.Db.LabelOrDateFilterType,se.a.instance.fa(138),"57")),l.buttons.push(this.ie("PivotTableContextMenu.September",1778578888,0,58===this.Db.LabelOrDateFilterType,se.a.instance.fa(139),"58")),l.buttons.push(this.ie("PivotTableContextMenu.October",1778578888,0,59===this.Db.LabelOrDateFilterType,
se.a.instance.fa(140),"59")),l.buttons.push(this.ie("PivotTableContextMenu.November",1778578888,0,60===this.Db.LabelOrDateFilterType,se.a.instance.fa(141),"60")),l.buttons.push(this.ie("PivotTableContextMenu.December",1778578888,0,61===this.Db.LabelOrDateFilterType,se.a.instance.fa(142),"61")));return l};pf.prototype.IHh=function(l){var J=this.Sa.Pc();if(this.s3f()){var Y=this.Gc.uL[4===this.$f.CellType?this.Gc.R5c-1:this.$f.CurrentFieldIndex-1];if(Y&&this.Cab){var za=this.Sa.zw("ContextMenu.PivotTableLayout",
null,se.a.instance.fa(646),-1777747317);var Ua=this.Sa.Pc(),Qb=String.format(se.a.instance.Ab(161),this.Cab),uc=String.format(se.a.instance.Ab(162),this.Cab);Ua.buttons.push(this.ie(fi,-1457478532,0,!Y.IsCompactLayout,Qb));Ua.buttons.push(this.ie(qh,-1390365353,0,Y.IsCompactLayout,uc));za.menu.Dc.push(Ua);za&&J.buttons.push(za)}}if(1===this.$f.CellArea||2===this.$f.CellArea)this.Db.Caption&&(Y="",Ua=this.tSd(),za=String.format(se.a.instance.Ab(159),this.dfd(Ua)),Ua&&(Y=String.format(se.a.instance.Ab(159),
this.Db.Caption)),1===this.$f.CellArea?(Y=this.lva("ContextMenu.PivotTableSubtotal",1801458190,0,this.Db.ShowSubtotal,za),za=this.Sa.Pc(),za.buttons.push(this.Sa.Bb(259)),za.buttons.push(this.ie("ContextMenu.PivotTableSubtotalOnTop",671485366,638,this.Db.ShowSubtotal&&this.Db.ShowSubtotalAtTop)),za.buttons.push(this.ie("ContextMenu.PivotTableSubtotalOnBottom",772221736,639,this.Db.ShowSubtotal&&!this.Db.ShowSubtotalAtTop)),Y.menu.Dc.push(za),Y&&0<za.buttons.length&&J.buttons.push(Y)):(Ua=Ua?this.AH(Ng,
this.Kva(za)):Ng,J.buttons.push(this.ie(Ua,1801458190,0,this.Db.ShowSubtotal,za,null,Y)))),J.buttons.push(this.ie("ContextMenu.RepeatItemLabels",-556893687,641,this.Db.RepeatItemLabels));1===this.$f.CellArea&&J.buttons.push(this.ie("ContextMenu.PivotBlankLineAfterEachItem",1600778266,640,this.Db.ShowBlankLineAfterEachItem));l.Dc.push(J)};pf.prototype.wIh=function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(247));l.Dc.push(J)};pf.prototype.mIh=function(l){var J="",Y="",za=!1;3===this.$f.CellType?
J=se.a.instance.fa(643):8===this.$f.CellType?this.Gc&&(J=String.format(se.a.instance.Ab(160),this.Gc.ZGe)):this.Db&&((za=this.tSd())&&(Y=String.format(se.a.instance.Ab(160),this.Db.Caption)),J=String.format(se.a.instance.Ab(160),this.dfd(za)));if(J){var Ua=this.Sa.Pc();za=za?this.AH(Qg,this.Kva(J)):Qg;J=this.ie(za,-1951357930,0,!1,J,null,Y,8,D.a.v$c);Ua.buttons.push(J);l.Dc.push(Ua)}};pf.prototype.XGh=function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(43));this.Db&&this.$f&&this.$.isEditMode&&
(0===this.$f.CellType||4===this.$f.CellType)&&J.buttons.push(this.Sa.Bb(136));l.Dc.push(J)};pf.prototype.lIh=function(l){var J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(100));l.Dc.push(J)};pf.prototype.CIh=function(l){var J=2===this.Db.MeasureType&&!this.Db.IsNumeric,Y=this.Sa.zw("ContextMenu.SummarizeValuesBy",null,se.a.instance.fa(644),-249874296),za=this.Sa.Pc();za.buttons.push(this.ie("ContextMenu.SummarizeValuesBySum",-1255320719,1069,0===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,
void 0,J));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByCount",1746132849,1070,1===this.Db.DataFieldAggregationType));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByAverage",-771066011,1071,2===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,J));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByMax",835007294,1072,3===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,J));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByMin",929115636,
1073,4===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,J));za.buttons.push(this.ie("ContextMenu.SummarizeValuesByProduct",1935475057,1074,5===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.F2f(!0)||J));2!==this.Db.MeasureType&&(za.buttons.push(this.ie("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1075,6===this.Db.DataFieldAggregationType)),za.buttons.push(this.ie("ContextMenu.SummarizeValuesByStdDeviation",588680636,1076,7===this.Db.DataFieldAggregationType)),
za.buttons.push(this.ie("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1077,8===this.Db.DataFieldAggregationType)),za.buttons.push(this.ie("ContextMenu.SummarizeValuesByVariant",1668427539,1078,9===this.Db.DataFieldAggregationType)),za.buttons.push(this.ie("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1079,10===this.Db.DataFieldAggregationType)));this.Gc&&this.Gc.xqd()&&za.buttons.push(this.ie("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1080,11===this.Db.DataFieldAggregationType));
Y.menu.Dc.push(za);l.buttons.push(Y)};pf.prototype.xIh=function(l){var J=this.Sa.zw("ContextMenu.ShowValuesAs",null,se.a.instance.fa(645),-1128612833),Y=this.Sa.Pc();Y.buttons.push(this.ie("ContextMenu.ShowValuesAsNoCalculation",-841863025,1086,0===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1093,7===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1092,6===this.Db.DataFieldFormatType));
Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1091,5===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1096,9===this.Db.DataFieldFormatType));Y.buttons.push(this.ie("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1097,10===this.Db.DataFieldFormatType));if(this.Gc&&this.Gc.uL&&0<this.Gc.uL.length||this.Gc.caa&&0<this.Gc.caa.length){for(var za=this.lva("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1098,11===this.Db.DataFieldFormatType),Ua=this.Sa.Pc(),Qb=this.BIh(),uc=0;uc<Qb.length;uc++){var ed=Qb[uc];Ua.buttons.push(this.ie("ContextMenu.ShowValuesAsPercentOfParentTotal."+ed.Caption,-2031744961,1098,11===this.Db.DataFieldFormatType&&this.Db.BaseFieldIndex===ed.Index,ed.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+ed.Index))}za.menu.Dc.push(Ua);Y.buttons.push(za)}J.menu.Dc.push(Y);l.buttons.push(J)};pf.prototype.showPivotTableContextMenu=function(){this.qpd=!0;this.expandCollapse=
this.TZ=this.refresh=!1;var l=this.$,J=Je.g(l),Y=rg.a(l).TKa();if(Y){var za=bc.a(l);if(null===za||void 0===za?0:za.LRd)this.qpd=ab.f(l.kg);za=l.wc;this.TZ=Y.supportsBIExplore&&!!ma.a(l)&&za.o3(32768);za.allowInteractivity&&(l=J.mc(null),(null===l||void 0===l?0:l.cell)&&(l.cell.s_c||l.cell.p3f)&&(this.expandCollapse=!0),za.allowManualDataRefresh&&(this.refresh=!0))}l=null;Y=1;this.X0a&&1!==this.X0a.yb?(l=new Sys.UI.Point(this.X0a.clientPoint.x,this.X0a.clientPoint.y),Y=this.X0a.yb):(J=Oe.e(J,this.$))&&
(l=new Sys.UI.Point(J.x+(this.$.isChromeRtl?0:J.width),J.y+J.height));kg.a.Vb=Y;this.Sic=3===Y;this.Jp(l,!0,Y);this.Wba=!0;this.gVd()};pf.prototype.M7h=function(){var l=new rh.a(1114549926,0,this.$.fd,19,null);this.$.Ka.$b(l)};pf.prototype.JVh=function(){var l=this;if(this.Gc&&this.Gc.Yo){var J=this.Gc.Yo.CurrentCol;if(this.Gc.Yo.CurrentRow===this.activeCell.FirstRow&&J===this.activeCell.FirstColumn){this.DKb();this.showPivotTableContextMenu();return}}J=new Wg.a(228,0,function(Y,za,Ua){return Td.C(l.$.na.va,
l.activeCell,lf.b(Y,l.OMi),lf.a(za,l.NMi),Ua,null)},16);this.$.userOperationManager.ic(J,null)};pf.prototype.Kli=function(){if(og.a.Ld(this.$)){var l=this.$.da.Aa(441);if(l)return l.es}else if(l=this.$.da.Aa(346))return l.es;return!1};pf.prototype.AH=function(l,J){return l+"."+J};pf.prototype.performPivotTableOperation=function(l,J){var Y=this,za=Pf.a.Ta.Wb;if(!this.Gc||!this.Db&&this.$f&&3!==this.$f.CellType)this.ui();else{var Ua=this.Gc.isOlap;rg.a(this.$).Vx(Ua,function(Qb){Qb&&Y.$.ic(l,function(uc,
ed,Dd){var hd=Y.w0d,Ke=Y.activeCell,zf=Y.Db?Y.Db.Caption:null,Dg=Y.Cab;uc=lf.b(uc,Y.zQi);ed=lf.a(ed,Y.yQi);var Tg=Y.$.na.va.hc();Tg=hd.Na(41,void 0===Tg?null:Tg);Tg.activeCell=Ke;Tg.operationType=J;Tg.fieldCaption=zf;Tg.prevFieldCaption=Dg;return Td.i(hd,"ExecutePivotTableOperation",Tg,uc,ed,Dd,null,0)},za,0,4,229)})}};pf.prototype.applyValueFieldSettingsToPivotTable=function(l,J){var Y=this;J=void 0===J?!1:J;var za=Pf.a.Ta.Wb;this.Gc&&this.Db?(J&&2===this.Db.MeasureType&&Cd.ULS.sendTraceTag(537167002,
0,50,"change aggregation type for an implicit measure from right click context menu."),J=this.Gc.isOlap,rg.a(this.$).Vx(J,function(Ua){Ua&&Y.$.ic(l,function(Qb,uc,ed){var Dd=Y.w0d,hd=Y.activeCell,Ke=Y.iA;Qb=lf.b(Qb,Y.sHi);uc=lf.a(uc,Y.rHi);var zf=Y.$.na.va.hc();zf=Dd.Na(41,void 0===zf?null:zf);zf.activeCell=hd;zf.pivotValueFieldSettingsApplyData=Ke;return Td.i(Dd,"ApplyValueFieldSettingsToPivotTable",zf,Qb,uc,ed,null,0)},za,0,4,231)})):this.ui()};pf.prototype.ie=function(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd){Ua=
void 0===Ua?null:Ua;Qb=void 0===Qb?null:Qb;uc=void 0===uc?null:uc;ed=void 0===ed?8:ed;Dd=void 0===Dd?null:Dd;hd=void 0===hd?!1:hd;za&&(l+=".Checked");hd&&(l+=".Disabled");this.Sa.hod(l)&&this.Sa.oJd(l);Y=Ua||se.a.instance.fa(Y);l=this.Sa.aIa(l,Y,J,null,"None",Qb,hd,null);l.wwc(null);uc&&l.WS(uc);za?l.YS("Image16by16",3,D.a.Jaa):Dd?l.YS("Image16by16",ed,Dd):l.N2b();return l};pf.prototype.lva=function(l,J,Y,za,Ua){Y=(void 0===Ua?null:Ua)||se.a.instance.fa(Y);this.Sa.hod(l)?this.Sa.oJd(l):this.Sa.oJd(l+
".Checked");za&&(l+=".Checked");this.Xwj&&(Y=this.mih.parseFromString(Y,"text/html").body.innerText);l=this.Sa.$3c(l,null,Y,J,3,D.a.Jaa);l.J$e=za;!za&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&l.N2b();return l};pf.prototype.uai=function(){this.iA=Object(tg.a)(new Gg,{PivotValueFieldSummarizeValueByApplyData:Object(tg.a)(new Qe,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(tg.a)(new hf,{SelectedDataFormat:-1,SelectedBaseField:-1,
SelectedBaseItem:-1}),PivotValueFieldTitle:null})};pf.prototype.mSa=function(l,J){this.iA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=l;this.iA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=J;this.iA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};pf.prototype.BIh=function(){var l=[];if(this.Gc&&this.Gc.caa&&0<this.Gc.caa.length)for(var J=Cl(this.Gc.caa),Y=J.next();!Y.done;Y=J.next())(Y=Y.value)&&l.push(Y);if(this.Gc&&this.Gc.uL&&0<this.Gc.uL.length)for(J=Cl(this.Gc.uL),
Y=J.next();!Y.done;Y=J.next())(Y=Y.value)&&l.push(Y);l.sort(function(za,Ua){return za.Index-Ua.Index});return l};pf.prototype.s3f=function(){if(!this.$f||!this.Gc||!this.Gc.uL)return!1;var l=1===this.$f.CellArea||4===this.$f.CellType&&this.$f.IsRowAxis,J=4===this.$f.CellType?0<this.Gc.R5c:0<this.$f.CurrentFieldIndex;return 1<this.Gc.uL.length&&l&&J};pf.prototype.FKa=function(l){var J=[];3===l?this.$.isEditMode?Array.addRange(J,[Jb.a.GHf,Jb.a.IHf,Jb.a.jZi]):Array.addRange(J,[Jb.a.copy]):2===l&&J.push(Jb.a.hye);
return J};pf.prototype.ui=function(){var l=wg.a.gd(1,0,0,647,0,104573951,"PivotTableContextMenuOperationFailure");Bj.a(this.$).ui(l)};pf.prototype.Jyj=function(){return this.Db?0!==this.Db.LabelOrDateFilterType||0!==this.Db.ValueFilterType||this.Db.HasManualFilter:!1};pf.prototype.Gyj=function(l){return 62<=l&&65>=l};pf.prototype.lsi=function(){if(this.activeCell&&this.Db&&this.Gc){var l={};l.cell=this.activeCell;l.dataSourceIndex=this.Gc.externalSourceIndex;l.fieldId=this.Db.Index.toString();l.isOlap=
this.Gc.isOlap;l.confirmationRequired=this.Gc.confirmationRequiredForDataOps;this.$.Zd(492140419,kg.a.Vb,19,{showPivotFilterDialogCommandData:l})}};pf.prototype.aZg=function(l){var J=this;this.activeCell&&this.Db&&this.Gc&&this.$.userOperationManager.ic(new Wg.a(153,0,function(Y,za,Ua){return Td.X(J.$.na.va,J.activeCell,J.Gc.externalSourceIndex,J.Db.Index.toString(),l,Y,za,Ua,null,null)}),null)};pf.prototype.aLg=function(l){var J=this;!(30>l||61<l)&&this.activeCell&&this.Db&&this.Gc&&this.$.userOperationManager.ic(new Wg.a(152,
0,function(Y,za,Ua){return Td.g(J.$.na.va,J.activeCell,J.Gc.externalSourceIndex,J.Db.Index.toString(),l,Y,za,Ua,null,null)}),null)};pf.prototype.applyPivotSort=function(l){var J=this;if(this.Gc&&this.Db&&this.activeCell&&this.$f){var Y=1===this.$f.CellArea||2===this.$f.CellArea;8===this.$f.CellArea?af.a(this.$.userOperationManager,function(za,Ua,Qb){return Td.e(J.$.na.va,J.activeCell,l,J.Db.Caption,za,Ua,Qb,null)},function(za){return new Wg.a(1015,0,za,void 0,null)},null):Y&&(Y=1===this.$f.CellArea?
1:2,this.$.ma(705)?Wc.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Gc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Gc.isOlap?"":this.Db.Caption,Y,1===l):Wc.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Gc.externalSourceIndex,this.Db.Index.toString(),1===l))}};pf.prototype.$S=function(){return!this.Gc||!this.Gc.isActionable&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadOnlyPivotTable",
!1)};pf.prototype.mxj=function(){return(this.$f||this.Gc)&&4!==this.$f.CellType&&(0!==this.$f.CellType||8!==this.$f.CellArea||this.Gc.caa&&this.Gc.caa.length||this.Gc.uL&&this.Gc.uL.length)?!1:!0};pf.prototype.nxj=function(){return this.$f&&this.Gc&&(1===this.$f.CellArea||2===this.$f.CellArea)&&this.Gc.fPb&&this.Gc.fPb.length?!1:!0};Ck.Object.defineProperties(pf.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.IMf}}});
Object(Vd.a)(pf,"PivotTableContextMenu",Ga.a,[]);$e.prototype.compare=function(l,J){return(l||"").localeCompare(J||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(Vd.a)($e,"DigitsAsNumberComparer",null,[680]);var Fi=b(273),di=oa.a.Z2g,V=Ga.a;Am(wf,V);wf.prototype.executeCommand=function(l,J,Y){l=J.command;switch(l){case 639960842:this.applyTableFieldList(Y);this.nO.Sda();break;case -1085236154:Y=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Fzd);
Cd.ULS.sendTraceTag(537166999,0,50,Y);this.nO.Sda();break;case 1833782813:this.nO.showCallout();break;default:return eg.a(l)}return ig.Task.Ra(!0)};wf.prototype.applyTableFieldList=function(l){var J=l.MenuItemId.toString();We.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(J=J.replace("'","''"),J=J.replace("[","'["),J=J.replace("]","']"));var Y=Object(S.a)(String,l.SourceControlId),za={};za.PulloutField=J;za.PulloutCardPath=l.SourceCardKeyPath;za.PulloutCardSourceRow=
l.SourceCardRow;za.PulloutCardSourceColumn=l.SourceCardColumn;if(this.nO.vN){Cd.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");za.ParameterType=2;l=l.ColumnIndex;if(void 0===l||null===l){if(void 0===Y||null===Y){Cd.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}l=0<=this.nO.LKf?this.nO.LKf:parseInt(Y.substring(20+J.length+1,Y.length),10);if(isNaN(l)){J=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",
Y);Cd.ULS.shipAssertTag(537166997,0,!1,J);return}}za.PulloutRichColumnSourceIndex=l;if(this.IVb.DIg){this.rJg(J,za);return}}else Cd.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),za.ParameterType=4,Y=this.nO.selectedRange.right,void 0!==za.PulloutCardSourceColumn&&null!==za.PulloutCardSourceColumn&&(Y=za.PulloutCardSourceColumn+1),za.PulloutRichColumnSourceIndex=Y;this.wPd(J,za)};wf.prototype.wPd=function(l,J,Y){Y=void 0===Y?0:Y;var za=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",
this.Fzd,J.PulloutRichColumnSourceIndex);Cd.ULS.sendTraceTag(537166996,0,50,za);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",J.ParameterType,J.PulloutRichColumnSourceIndex);l=Object(tg.a)(new Fi.a,{Text:l});this.grid.setCell(l,this.nO.Eya,0,127,J,Y);this.grid.focus();this.H5b=null;this.nO.Sda();this.nO.ihj()};wf.prototype.Kc=function(l,J,Y){if(l=this.$.isEditMode&&We.EwaSettings.ma(136)&&!!this.nO)switch(J.command){case -1085236154:break;
case 639960842:l=!!Y;break;case 1833782813:l=this.nO.Rwa&&this.nO.QBb;break;default:l=!1}return l};wf.prototype.k1=function(l,J,Y){this.$.isEditMode&&(this.H5b=this.QHh(Object(S.a)(694,Y)),V.prototype.k1.call(this,l,J,null,null,!1))};wf.prototype.DZ=function(){return this.H5b};wf.prototype.Z3c=function(l){if(!this.nO||!l||!l.Mk)return Cd.ULS.shipAssertTag(537166994,0,!!this.nO,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Cd.ULS.shipAssertTag(537166993,0,!!l,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),
l&&Cd.ULS.shipAssertTag(537166992,0,!!l.Mk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var J=new P.a;l=Cl(l.Mk);for(var Y=l.next();!Y.done;Y=l.next()){var za=Y.value;Y=new P.a;Y.add(za.ColumnName);Y.add(za.ColumnIndex.toString());var Ua=new P.a,Qb=null;Qb=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new $e:new Qf;Ua=Ha.OBc(Ha.concat(Ua,Ha.select(Ha.asEnumerable(za.FieldInfoDataList),function(uc){return uc.Name})),
function(uc){return uc},Qb);za=new P.a;za.add(Ha.toArray(Ha.concat(Y,Ua)));J=Ha.toList(Ha.concat(J,za))}return Ha.toArray(J)};wf.prototype.QHh=function(l){var J=this.Z3c(l);if(!J||!J.length)return this.H5b=null;var Y=this.Sa;l=Y.Pc();var za=1<J.length;this.Fzd=J.length;J=Cl(J);for(var Ua=J.next();!Ua.done;Ua=J.next()){var Qb=Ua.value;za||(l.title=Qb[0]);Ua=Y.Pc();for(var uc=2,ed=Qb.length;uc<ed;++uc)(za?Ua.buttons:l.buttons).push(Y.aIa("ApplyTableFieldList."+Qb[uc]+"."+Qb[1],Qb[uc],639960842,null,
"None",Qb[uc],!1,void 0,!0));za&&(Qb=Y.zw("ApplyTableFieldList."+Qb[0],this.menuId,Qb[0],798637440),Qb.menu.Dc.push(Ua),l.buttons.push(Qb))}Y=Y.Zp(this.menuId);Y.Dc.push(l);return Y};wf.prototype.rJg=function(l,J){var Y=this,za=wg.a.gd(12,1,0,891,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(We.EwaSettings.Kz()){var Ua=new $g.a(this.$,za);Ua.YP(function(){2===Ua.returnValue&&Y.wPd(l,J,8)})}else{var Qb=new be.ErrorDialog(this.$,za);Qb.YP(function(){2===Qb.returnValue&&Y.wPd(l,J,8)});Qb.kf()}};
Ck.Object.defineProperties(wf.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.KMf}},nO:{configurable:!0,enumerable:!0,get:function(){this.IVb||(this.IVb=this.$.da.Aa(261));return this.IVb}}});Object(Vd.a)(wf,"PulloutFieldListContextMenu",Ga.a,[]);var ya=oa.a.MMf,lb=Ga.a;Am(sf,lb);sf.prototype.Kc=function(l,J,Y){return-1687037502===J.command&&!!Y&&this.grid.isEditing};sf.prototype.executeCommand=
function(l,J,Y){this.showRichTextFloatie(Y);return ig.Task.Ra(!0)};sf.prototype.FKa=function(){return[Jb.a.wWg]};sf.prototype.showRichTextFloatie=function(l){var J=Object(S.a)(kc.a,l.eventArgs);J&&(l=this.FKa(J.yb),J=new Sys.UI.Point(J.Ca.clientX,J.Ca.clientY),this.showFloatie(l,new Sys.UI.Bounds(J.x,J.y,0,0),2))};Ck.Object.defineProperties(sf.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.MMf}}});
Object(Vd.a)(sf,"RichTextContextMenu",Ga.a,[]);var Kb=b(99),Lb=oa.a.Y2g,Xa=Ga.a;Am(df,Xa);df.prototype.executeCommand=function(l,J,Y){if(qe.a(this.$))return ig.Task.Ra(!0);this.$.isEditMode&&(l=Y[oa.a.g2f],l=l.x&&l.y?new Sys.UI.Point(l.x+(this.$.isChromeRtl?10:-10),l.y):id.DOMElementExtensions.getLocation(Y[oa.a.h2f]),this.Jp(l,!1));return ig.Task.Ra(!0)};df.prototype.Kc=function(l,J,Y){return-1075099431===J.command&&!!Y};df.prototype.DZ=function(){var l=this.Sa.Zp(this.menuId),J=this.$.isEditMode;
this.XTj();this.DHh(l,J);this.tHh(l);this.vIh(l);return l};df.prototype.kZb=function(l,J,Y,za){l.push(this.Sa.Bb(J?Y:za))};df.prototype.DHh=function(l,J){var Y=this.Sa,za=Y.Pc();za.buttons.push(Y.Bb(54));this.kZb(za.buttons,this.Fic,127,56);za.buttons.push(Y.Bb(55));J&&this.kZb(za.buttons,this.Fic,126,125);za.buttons.push(Y.Bb(158));this.$.ea.nLb&&(J=Object(S.a)(Kb.a,this.$.qa))&&tf.p(J)&&this.$.isEditMode&&(za.buttons.push(Y.Bb(277)),J.isLockPausedInSession?za.buttons.push(Y.Bb(279)):J.tj&&za.buttons.push(Y.Bb(278)));
J=Y.zw("ContextMenu.TabColor",null,se.a.instance.fa(517),1841703919);Y=Y.W3c(467002767,1549407384,540,-221093529,this.KB);J.menu.Dc.push(Y);za.buttons.push(J);l.Dc.push(za)};df.prototype.tHh=function(l){var J=this.Sa.Pc();this.kZb(J.buttons,this.Fic,114,112);this.kZb(J.buttons,!this.ghc,115,113);l.Dc.push(J)};df.prototype.vIh=function(l){if(We.EwaSettings.ma(486)&&!tf.e(this.$.xa.qa)){var J=this.Sa,Y=J.Pc();Y.buttons.push(J.Bb(263));l.Dc.push(Y)}};df.prototype.XTj=function(){var l=this.$.H3c();var J=
l.I3c;l=l.JDe;this.Fic=1===J;this.ghc=0<l};Ck.Object.defineProperties(df.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.NMf}}});Object(Vd.a)(df,"SheetOpsContextMenu",Ga.a,[]);var od=b(565),Yd=Ga.a;Am(we,Yd);we.prototype.$c=function(l,J){var Y=!0;switch(J){case -231711729:Y=!1;break;case -1909381757:Y=this.Icc();Y=!!Y&&Y.Nii;break;case 1312363469:Y=!0}return!Y||Yd.prototype.$c.call(this,
l,J)};we.prototype.executeCommand=function(l,J,Y){if(!this.$.isEditMode)return Pg.TaskExtensions.h5();l=J.command;J=this.Icc();var za=null;switch(l){case 2108047455:J&&J.fAe();break;case -231711729:Cd.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:J&&J.W2b();break;case 1312363469:this.showSlicerContextMenu(Y);break;default:za=eg.a(l)}return za||Pg.TaskExtensions.h5()};we.prototype.Kc=function(l,J,Y){l=!1;switch(J.command){case -231711729:case 2108047455:case -1909381757:l=
!0;break;case 1312363469:l=!!Y}return l};we.prototype.DZ=function(){var l=this.Sa.Zp(this.menuId),J=this.Sa.Pc();J.buttons.push(this.Sa.Bb(252));J.buttons.push(this.Sa.Bb(253));J.buttons.push(this.Sa.Bb(254));l.Dc.push(J);J=this.Sa.Pc();this.Tni()?J.buttons.push(this.Sa.Bb(266)):J.buttons.push(this.Sa.Bb(267));l.Dc.push(J);return l};we.prototype.Tni=function(){if(og.a.Ld(this.$)){var l=this.$.da.Aa(439);if(l)return l.es}else if(l=this.$.da.Aa(371))return l.es;return!1};we.prototype.showSlicerContextMenu=
function(l){var J=Object(S.a)(kc.a,l.eventArgs);l=this.hbc(Object(S.a)(kc.a,l.eventArgs));J=J.yb;kg.a.Vb=J;this.Jp(l,!1,J)};we.prototype.pXe=function(l){var J=this.Sa.Pc(),Y=this.Sa.Pc();Y.buttons.push(this.Sa.Bb(255));Y.buttons.push(this.Sa.Bb(256));var za=this.Sa.$3c("ContextMenu.SlicerSort",null,se.a.instance.fa(2126),-814639094,0,D.a.kQe);za.menu.Dc.push(Y);J.buttons.push(za);l.Dc.push(J)};we.prototype.$yj=function(l){return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
l.Mb.className===D.a.d$c||We.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===l.yb};we.prototype.hbc=function(l){var J=Je.g(this.$).ha.Oa.oc,Y=l&&1!==l.yb&&l.clientPoint?l.clientPoint:Sys.UI.DomElement.getLocation(J.domElement);if(this.$yj(l)){var za=this.Icc();za&&(l.Mb.className===D.a.d$c&&(Y=md.HelperMethods.Cvb(l.Ca)),1===l.yb&&(Y=Df.a(this.$).aka(id.DOMElementExtensions.getLocation(za.frame))))}else if(l=this.Icc())l=this.VQh(l.frame),(za=md.HelperMethods.VC(this.$.Mf,
this.$.domElement,Je.g(this.$).rtl,!1))?(l.x=Df.a(this.$).Fi(l.x-za.x)+za.x,l.y=Df.a(this.$).Fi(l.y-za.y)+za.y):Cd.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),Y.y+=l.y,Y.x+=l.x;l=this.$.domElement;za=Je.g(this.$).rtl;J=md.HelperMethods.VC(J.mg.domElement,l,za);Y.y=Math.max(Y.y,J.y);Y.x=Math.max(Y.x,J.x);return Y};we.prototype.Icc=function(){var l=Je.g(this.$).ha.Oa.oc;Cd.ULS.shipAssertTag(537166988,0,!!l);return od.a(this.$).HH(l.floatingObject.id)};we.prototype.VQh=function(l){var J=
new Sys.UI.Point(l.offsetParent.offsetLeft,l.offsetParent.offsetTop),Y=Je.g(this.$);if(!Y)return J;var za=Je.g(this.$).rtl;J=md.HelperMethods.VC(l,this.$.kr.ownerDocument.body,za);Y.ADe(J);J.x=za?this.$.kr.clientWidth-J.x-l.clientWidth:J.x;l=Y.view.Apb;Y=za?-Y.SS.Hca(l.x):l.x;J.x-=Y;J.y-=l.y;return J};Ck.Object.defineProperties(we.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},KB:{configurable:!0,enumerable:!0,get:function(){return oa.a.OMf}}});Object(Vd.a)(we,
"SlicerContextMenu",Ga.a,[]);Object(Vd.a)(Hd,"TimeSlicerRibbonButtonParameter",null,[]);var ke=Ga.a;Am(oe,ke);oe.prototype.executeCommand=function(l,J,Y){l=J.command;switch(l){case 2000085697:l=Y.DOMElement;this.ata=Y.ChangeLevelCallback;this.NKa=Y.GetLevelLabelCallback;this.t1a=Y.CurrentLevel;var za=Y.DomEvent;Fh.g(za);var Ua=Y.location;Y=Y.levelLabelText;this.gLe=id.DOMElementExtensions.Hz(document.activeElement,"iframe")&&Y?Y.parentNode:null;Y=Sys.UI.DomElement.getBounds(Y);Y.x=Ua.x;Y.y=Ua.y;this.k1(za,
l,Y,J,!0);break;case -649826274:this.ata(0);break;case 149600865:this.ata(1);break;case -2012435159:this.ata(2);break;case -1979934975:this.ata(3);break;case 1634477200:id.DOMElementExtensions.setFocus(this.gLe);break;default:return eg.a(l)}return ig.Task.Ra(!0)};oe.prototype.Kc=function(l,J,Y){l=!1;switch(J.command){case 2000085697:l=!!Y;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:l=!0}return l};oe.prototype.k1=function(l,J,Y){l=Sys.UI.DomElement.getBounds(J);
Y.x=Df.a(this.$).Fi(Y.x);Y.y=Df.a(this.$).Fi(Y.y);l.x=Df.a(this.$).Fi(l.x);l.y=Df.a(this.$).Fi(l.y);l=new Sys.UI.Point(l.x+Y.x,l.y+Y.y);this.iUa(l,J);this.showContextMenu(new Sys.UI.Bounds(l.x,l.y-Y.height,Y.width,Y.height))};oe.prototype.DZ=function(){for(var l=this.Sa,J=l.Zp(this.menuId),Y=l.Pc(),za=0;3>=za;za++){var Ua=this.NKa(za),Qb=oe.kLh(za);Qb=l.W4g(Qb.W2g,Qb.Er,this.t1a===za,oe.jze);Qb.label=Ua;Qb.WS(Ua);this.t1a===za?Qb.YS("Image16by16",8,oe.jze):Qb.N2b();Y.buttons.push(Qb)}J.Dc.push(Y);
return J};oe.kLh=function(l){var J=null;switch(l){case 0:J=new Hd(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:J=new Hd(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:J=new Hd(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:J=new Hd(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return J};Ck.Object.defineProperties(oe.prototype,{qt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},KB:{configurable:!0,enumerable:!0,
get:function(){return oa.a.RMf}}});oe.kKj=oa.a.$2g;oe.pJb="TimeSlicerLevelMenuRootName";oe.jze=D.a.Qua;Object(Vd.a)(oe,"TimeSlicerLevelMenu",Ga.a,[]);var Yf=b(328),Tf=b(3),Kg=Sf.a;Am(Bd,Kg);Bd.prototype.Nd=function(){var l=this,J=this.$,Y=ij.a.l1a(Zg.b(),this.la,"Task","IRootUser"),za=qi.a(J),Ua=null;Ua=function(ed,Dd){za.qRf(Ua);Y.setResult(Dd.j4b)};za.Ooe(Ua);za.S1e();var Qb=Hf.GetServiceTaskFactory.create(J.da,102,J.la,this.ub),uc=Hf.GetServiceTaskFactory.Ua(J.da,342,338,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([Y.task,
Qb,uc],this.la),function(){var ed=Qb.result,Dd=Y.task.result,hd=uc.result;l.Dd([new $d(J,Dd,ed,hd),new Ae(J,Dd,ed,hd),new me(J,Dd,ed,hd),new xg(J,Dd,ed,hd),new Zd(J,Dd,ed,hd),new Ze(J,Dd,ed,hd),new fe.GridContextMenu(J,Dd,ed,hd),new bg(J,Dd,ed,hd),new df(J,Dd,ed,hd),new oe(J,Dd,ed,hd),new wf(J,Dd,ed,hd),new Bf(J,Dd,ed,hd),new pf(J,Dd,ed,hd),new we(J,Dd,ed,hd),new sf(J,Dd,ed,hd)])},J.la,3)};Bd.initData=function(){var l=Yf.a.Z2;l(2000085697,20479,0,0);l(-227942804,Tf.a.Mc|24576,0,0);l(1634477200,Tf.a.Mc|
131072,0,0);l(-649826274,4095,0,0);l(149600865,4095,0,0);l(-2012435159,4095,0,0);l(-1979934975,4095,0,0);l(1247109494,Tf.a.Mc|24576,0,0);l(-2064931494,Tf.a.Mc|131072,0,0);l(-1396319072,Tf.a.Ia,128,0);l(-425234874,Tf.a.Ia,128,0);l(-1253126584,Tf.a.Ia,0,0);l(274207288,Tf.a.Mc|24576,0,0);l(-1497523576,Tf.a.Mc|131072,0,0);l(-498523270,Tf.a.Mc|24576,64,0);l(1640762262,Tf.a.Mc|131072,64,0);l(-2017893763,Tf.a.Mc|24576,0,0);l(1350204367,Tf.a.Mc|131072,0,0);l(-889576107,Tf.a.uw,128,0);l(-1170196828,Tf.a.uw,
128,0);l(389774337,Tf.a.uw,128,0);l(1529312473,Tf.a.uw,128,0);l(2033235475,Tf.a.uw,128,0);l(-96230454,Tf.a.uw,128,0);l(74086617,Tf.a.uw,128,0);l(563292088,Tf.a.uw,128,0);l(-1092351914,Tf.a.uw,128,0);l(-2141589616,Tf.a.uw|16384,128,0);l(745182485,Tf.a.uw,0,0);l(359279088,Tf.a.uw,128,0);l(-67292059,Tf.a.uw,128,0);l(926905850,Tf.a.uw,128,0);l(547535945,Tf.a.uw,128,0);l(1374696078,Tf.a.Mc|24576,0,0);l(495005930,Tf.a.Mc|212992,0,0);l(-1045020714,Tf.a.Mc|24576,0,0);l(-170383950,Tf.a.Mc|212992,0,0);l(324156914,
Tf.a.Ia,0,0);l(-1085236154,Tf.a.Zu,0,0);l(-751848458,Tf.a.ul|16384,0,0);l(216058793,Tf.a.Zu,0,0);l(474690375,Tf.a.ul|16384,0,0);l(-1920954846,Tf.a.Mc|24576,0,0);l(723126814,Tf.a.Mc|131072,0,0);l(2108047455,128,128,0);l(-231711729,128,128,0);l(-1909381757,128,128,0);l(-814639094,128,128,0);l(1701016594,Tf.a.Mc|3072,128,0);l(-1475408662,Tf.a.Mc|24576,0,0);l(1114549926,Tf.a.Mc|131072,32,0)};Bd.ka=function(l){Sf.a.he(10,new Bd(l))};Object(Vd.a)(Bd,"ContextMenuCommandHandlerFactory",Sf.a,[]);var Og=b(226),
Hh=b(1432),si=b(93),Vj=b(262);Id.prototype.dispose=function(){};Id.prototype.yaa=function(){this.srb.j4()};Id.prototype.LC=function(){this.srb.LC()};Id.prototype.LSd=function(l,J,Y){Oe.h(this.$,Oe.b);this.srb.showContextMenu(Object(tg.a)(new Hh.a,{x:J.x,y:J.y}),Y,l);si.EventHandlerManager.instance.vcd()};Id.prototype.lyc=function(l,J,Y){Oe.h(this.$,Oe.b);this.srb.showFloatie(Object(tg.a)(new Hh.a,{x:J.x,y:J.y}),l,Y);Vj.a(function(){si.EventHandlerManager.instance.vcd()},this.$.la)};Id.prototype.KSd=
function(l,J,Y,za){Oe.h(this.$,Oe.b);this.srb.KSd(Object(tg.a)(new Hh.a,{x:J.x,y:J.y}),l,Y,za)};Object(Vd.a)(Id,"ReactContextMenuController",null,[751,2]);var mg=Og.a;Am(Kc,mg);Kc.prototype.dispose=function(){this.xaf&&this.$&&this.$.ea.Yn(this.wmd);mg.prototype.dispose.call(this)};Kc.prototype.create=function(){this.$.ea.vh?(Cd.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.vh),this.wmd(null,null)):(this.xaf=!0,
this.$.ea.Hl(this.wmd))};Kc.ka=function(l){l.da.Ga(338,new Kc(l))};Object(Vd.a)(Kc,"ContextMenuControllerFactory",Og.a,[]);var Ti=b(160);Object(Vd.a)(Wb,"RibbonCommandParams",null,[]);Object(Vd.a)(ug,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);Xf.prototype.wLh=function(l){return(l=this.gec[l.toString()])?l.menuModel:null};Xf.prototype.HTg=function(l,J){this.gec[J.toString()]=Object(tg.a)(new ug,{menuModel:l,mGe:md.HelperMethods.Zb()})};Xf.prototype.Q7b=function(l){this.gec[l.toString()]=null};
Xf.prototype.R_h=function(l){return(l=this.gec[l.toString()])?l.mGe:-1};Object(Vd.a)(Xf,"FilterMenuCache",null,[]);var Bg=b(13),Zj=b(194),zi=b(228);Object(Vd.a)(Ef,"AutoFilterEventRegistrationArgs",null,[]);var sg=b(25);jf.prototype.dispose=function(){window.cancelAnimationFrame(this.RBb);this.gridView&&this.gridView.itc(this.JEb);this.gridView=null};jf.prototype.C$h=function(){if(this.bSd=md.HelperMethods.p7a)this.g_a=[];this.OCg();this.gridView.HZb(this.JEb)};jf.prototype.OCg=function(){for(var l=
Cl(this.gridView.An),J=l.next();!J.done;J=l.next()){J=J.value.tCa;for(var Y in J){var za=J[Y];this.lLf(za.domElement,za.hashCode)}}};jf.prototype.lLf=function(l,J){if(Je.g(this.$).Ea.tm.b2a(J))if(l){l=l.querySelectorAll('[id^="'+oa.a.gbd+'"]');for(var Y=0;Y<l.length;Y++){var za=l[Y],Ua=za.getAttribute(oa.a.NBh),Qb=za.getAttribute(oa.a.FBh);Cd.ULS.shipAssertTag(537167053,0,!!Ua&&!!Qb,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
za.id,J);Ua=sg.Range.hd(parseInt(Ua,10),parseInt(Qb,10));za=Object(tg.a)(new Ef,{cell:Ua,Vte:za,ae:J});this.bSd?(this.g_a.push(za),this.RBb||(this.tNe=window.performance.now(),this.RBb=window.requestAnimationFrame(this.bPf))):this.dne(za)}}else Cd.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",J);else Cd.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
J)};jf.prototype.dne=function(l){var J=this.gridView.Ea.z4a(l.cell,l.ae);J?this.NCg(l.Vte,J):Cd.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",l.ae,l.cell)};jf.prototype.NCg=function(l,J){J.hasAutoFilter?this.RAg(l,J.ebd):J.p5?this.LCg(l,J.ebd,J.Ggf):Cd.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
Ti.a.instance.pa(Bg.a.Lf,l,this.onPointerDown);Zj.a.instance.pa(Bg.a.zya,l,this.onPointerDown)};jf.prototype.RAg=function(l,J){zi.a.instance.pa(Bg.a.click,l,function(Y){J&&Wc.a.hrc(Y.Ca.rawEvent,966232027,J,null);return!0})};jf.prototype.LCg=function(l,J,Y){var za=je.a.oi(J);zi.a.instance.pa(Bg.a.click,l,function(Ua){Y?Wc.a.spf(document.getElementById(za.EwaElementId),za.Cell,za.DataSourceIndex,za.FieldId,za.IsOlap,za.RequiresConfirmation,Ua.Ca.rawEvent,za.OptionalPivotMenuAnchor):Wc.a.spfm(Ua.Ca.rawEvent,
za.RequiresConfirmation,za.Cell,za.DataSourceIndex,za.PivotName,za.OptionalPivotMenuAnchor);return!1})};Object(Vd.a)(jf,"FilterMenuPointerEventsManager",null,[2]);Af.prototype.dispose=function(){We.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.cUe.dispose();this.$=null};Af.prototype.GRh=function(l){var J=Je.g(this.$).Ea.I$(l,this.$.activeItemName);return J&&J.blockPresentInViewportTimeStamp>this.k9a.R_h(l.left)?
J.ks(l).autoFilterMenu:this.k9a.wLh(l.left)};Af.prototype.FNi=function(l,J,Y){this.k9a&&this.k9a.HTg(l.menuModel[J],Y)};Af.prototype.GNi=function(l){this.k9a&&this.k9a.Q7b(l)};Object(Vd.a)(Af,"FilterMenuManager",null,[752,2]);var bk=b(234),lj=b(183);Ge.prototype.ved=function(l){return Rh.a.Nc(this.Lyc,l)};Ge.prototype.dispose=function(){this.Od?Cd.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Od=!0,this.$&&(this.$.Ul(Ge.zd),this.$.da.oV(8),
this.ha&&this.ha.atc(this.il),this.$.Ka.Qbb(this.Lwf),We.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.RQa(this.n0),We.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.Q0(this.J6)),this.$=this.ha=null,this.f$b.dispose(),this.Lyc=this.E7d=null)};Ge.prototype.showContextMenu=function(l,J,Y){J=void 0===J?null:J;Y=void 0===Y?null:Y;this.Fyj(l)&&(Oe.h(this.$,Oe.i),l=this.f6g(l,
J,Y),this.$.Ka.$b(l.Td,l.dictionary))};Ge.prototype.j4=function(){this.contextMenuController?this.contextMenuController.yaa():Cd.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Ge.prototype.Fyj=function(l){return Bj.a(this.$).Oq()?(Cd.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Bj.a(this.$).H0(lj.a.grid,bk.a.showContextMenu),!1):!this.$.Ka.hzh&&
(!l||l.Mb!==Je.g(this.$).domElement&&!da.a.equals(l.Mb.tagName,"INPUT",!0))};Ge.prototype.f6g=function(l,J,Y){J=void 0===J?null:J;var za={};Y=(za.eventArgs=l,za.creationParams=void 0===Y?null:Y,za);l=l?l.yb:-1;za=this.ha.Oa.oc;var Ua=1441131127;za?(J=za.floatingObject,Cd.ULS.shipAssertTag(537167059,0,!!J,"floatingObj shouldn't be null."),Ge.Rrd(J)?Ua=1312363469:Ge.isPivotChart(J)?(Y[Ae.y0c]=J?J.dd:null,Ua=-149612405):Ua=-1372040782):Ge.Fgf(J)?(Y[Ae.y0c]=J,Ua=-149612405):!Oe.g(this.$)&&Oe.f(Je.g(this.$))&&
(Ua=671488277);J=new rh.a(Ua,l,this.$.fd,30,null);return Object(tg.a)(new Wb,{Td:J,dictionary:Y})};Ge.ka=function(l){l.tl(Ge.zd)};Ge.isPivotChart=function(l){return!!l&&0===l.type&&Ge.Fgf(l.dd)};Ge.Rrd=function(l){return!!l&&2===l.type};Ge.Fgf=function(l){return!!l&&!!(l.Attributes&4)};Ck.Object.defineProperties(Ge.prototype,{f$b:{configurable:!0,enumerable:!0,get:function(){return this.E7d}}});Ge.a3g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Ge.D2h="GridContextMenu";Ge.zd=function(l){(l=Object(S.a)(6,l))&&Hf.GetServiceTaskFactory.create(l.da,9,l.la,0)};Object(Vd.a)(Ge,"ContextMenuManager",null,[742,2]);var pk=Og.a;Am(Se,pk);Se.prototype.create=function(){var l=this,J=this.$,Y=J.wc;if(Y.allowSelection||Y.allowEdits||Y.allowFiltering||Y.allowSorting||Y.allowPivotSpecificOperations){var za=Hf.GetServiceTaskFactory.create(J.da,10,J.la,this.ub),Ua=Hf.GetServiceTaskFactory.Ua(J.da,342,338,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([za,
Ua],this.la),function(){l.Eb(Bb.a(J)||new Ge(J,za.result,Ua.result))},this.$.la,3)}else Cd.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),J.da.oV(8),this.Eb(null)};Se.ka=function(l){l.da.Ga(9,new Se(l))};Object(Vd.a)(Se,"ContextMenuManagerFactory",Og.a,[]);tc.prototype.isEqual=function(l){return l?this.L5===l.L5&&this.N5===l.N5&&this.fO===l.fO&&this.gO===l.gO&&this.MB===l.MB&&this.ruleType===l.ruleType&&
this.x_===l.x_&&this.AU===l.AU&&this.zU===l.zU&&this.jW===l.jW&&this.rF===l.rF&&this.a6===l.a6&&this.b6===l.b6:(Cd.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(Vd.a)(tc,"DataValidationEditDialogState",null,[]);$b.prototype.$c=function(){return!1};$b.prototype.executeCommand=function(l,J){-1728432249!==J.command&&eg.a(J.command);this.selectedRanges=Gf.r(Je.g(this.$).ha.ta.selectedRanges,this.$);Je.g(this.$).MSa(!0);this.getDataValidationInitialState();
this.mh=this.$.Ob.Hc("UserAction","DataValidationEditTimeToDialogOpen");this.OKe?Cd.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(Cd.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.OKe=!0);return ig.Task.Ra(!0)};$b.prototype.Kc=function(l,J){return-1728432249===J.command};$b.prototype.jd=function(){return!1};$b.prototype.getDataValidationInitialState=function(){var l=this,J=this.$.na.va.hc();af.a(this.$.userOperationManager,
function(Y,za,Ua){return Td.u(l.$.na.va,l.selectedRanges,lf.b(Y,l.WLi),lf.a(za),Ua,J)},function(Y){return new Wg.a(120,0,Y,16)},null)};$b.prototype.Y0i=function(){var l=this.VB={};switch(this.C1a.Command){case 0:var J="CreateNew";break;case 1:J="CreateNewFromRule";break;case 2:J="ExpandExisitng";break;case 3:J="OverrideExisitng";break;default:J="Unknown"}l.a=J;this.mh&&(this.mh.stop(),this.VB.r=this.mh.id);switch(this.C1a.Command){case 0:this.VB.b=!1;this.VB.c="None";this.bIa(new tc);break;case 1:this.VB.b=
!1;this.VB.c="None";this.bIa(new tc(this.C1a));break;case 2:this.VB.b=!0;this.U5c.e5g(this.$,this.ozh);break;case 3:this.VB.b=!0;this.U5c.g5g(this.$,this.UWi);break;default:Cd.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};$b.prototype.bIa=function(l){this.U5c.bIa(this.$,this.selectedRanges,l,this.C1a.Command);this.zxi(l)};$b.prototype.zxi=function(l){$b.Gsb(l,this.VB);this.VB.d=!0;Zg.b().Pe(48,this.VB,!0)};$b.prototype.Tnf=function(){this.VB.d=
!1;Zg.b().Pe(48,this.VB,!0)};$b.prototype.sX=function(l,J){var Y={};l=(Y.ButtonType=$b.Mia(J),Y.DialogName=l,Y.Location="dialog",Y.NumberOfSelectedRanges=Je.g(this.$).ha.ta.YK,Y);jg.b(this.$).Vd(Of.a.L6b,l)};$b.Gsb=function(l,J){J.e=ld(l.ruleType);J.f=Vc(l.MB);J.g=!!l.fO;J.h=!!l.gO;J.i=l.L5;J.j=l.N5;J.k=l.b6;J.l=!!l.rF;J.m=!!l.jW;J.n=l.a6;J.o=l.x_;J.p=!!l.AU;J.q=!!l.zU};$b.Mia=function(l){switch(l){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Cd.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(Vd.a)($b,"DataValidationEditCommandHandler",null,[424]);var wk=b(1005),cg;(function(l){l[l.between=0]="between";l[l.notBetween=1]="notBetween";l[l.equal=2]="equal";l[l.notEqual=3]="notEqual";l[l.greaterThan=4]="greaterThan";l[l.lessThan=5]="lessThan";l[l.greaterThanOrEqual=6]="greaterThanOrEqual";l[l.lessThanOrEqual=7]="lessThanOrEqual"})(cg||(cg={}));Object(Vd.b)("DataValidationRuleConditionType",
cg);var Wj;(function(l){l[l.anyValue=0]="anyValue";l[l.wholeNumber=1]="wholeNumber";l[l.decimal=2]="decimal";l[l.list=3]="list";l[l.date=4]="date";l[l.time=5]="time";l[l.textLength=6]="textLength";l[l.custom=7]="custom"})(Wj||(Wj={}));Object(Vd.b)("DataValidationRuleType",Wj);var dj=b(149),Oh=b(169);Ck.Object.defineProperties(Sb,{gg:{configurable:!0,enumerable:!0,get:function(){return dj.a.hp(Sb.yk,"")}},ofh:{configurable:!0,enumerable:!0,get:function(){return dj.a.hp(Sb.sfh,Oh.a.fa(1635),Oh.a.fa(1650),
Oh.a.fa(1651),Oh.a.fa(1652),Oh.a.fa(1653),Oh.a.fa(1654),Oh.a.fa(1655),Oh.a.fa(1656),Oh.a.fa(1657),Oh.a.fa(1636),Oh.a.fa(1660),Oh.a.fa(1661),Oh.a.fa(1662),Oh.a.fa(1663),Oh.a.fa(1664),Oh.a.fa(1665),Oh.a.fa(1666),Oh.a.fa(1667),Oh.a.fa(1637),Oh.a.fa(1638),Oh.a.fa(1658),Oh.a.fa(1659),Oh.a.fa(1649),"255")}},vfh:{configurable:!0,enumerable:!0,get:function(){return dj.a.hp(Sb.tfh,Oh.a.fa(1672),Oh.a.fa(1676),Oh.a.fa(1677),"255","32")}},zfh:{configurable:!0,enumerable:!0,get:function(){return dj.a.hp(Sb.ufh,
Oh.a.fa(1671),Oh.a.fa(1674),Oh.a.fa(1673),Oh.a.fa(1675),Oh.a.fa(1676),Oh.a.fa(1677),"255","32")}}});Sb.J9f=255;Sb.yk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";Sb.sfh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
Sb.tfh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
Sb.ufh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(Vd.a)(Sb,"DataValidationEditDialogHtml",null,[]);var Mg=b(617),vj=Si.a;Am(qb,vj);qb.prototype.UAa=function(l){this.BU.selectedIndex=l.ruleType;this.bL.selectedIndex=l.MB;this.dfc.checked=l.N5;this.Cwa.checked=l.L5;this.nza.value=l.fO;this.oza.value=l.gO;this.Rca(null)};qb.prototype.Spb=function(l){l.L5=this.Cwa.checked;l.N5=this.dfc.checked;l.MB=this.bL.selectedIndex;l.ruleType=this.BU.selectedIndex;l.fO=this.nza.value;l.gO=this.oza.value};qb.prototype.dispose=function(){this.wm();this.Dk=
this.xDd=this.tpc=this.FPa=this.Q$a=this.$Na=this.d6a=this.dfc=this.oza=this.nza=this.bL=this.BU=this.Cwa=null;vj.prototype.dispose.call(this)};qb.prototype.render=function(l){l.appendChild(this.domElement)};qb.prototype.kka=function(){return this.isVisible};qb.prototype.Xna=function(l){return this.isVisible=l};qb.prototype.setFocus=function(){};qb.prototype.Tvb=function(l,J){return this.O1e(l,J,this.pDh)};qb.prototype.ohd=function(l,J){return 0!==J&&1!==J?"":this.O1e(l,J,this.pmj)};qb.prototype.Fka=
function(){this.domElement.innerHTML=Sb.ofh;this.Cwa=id.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.BU=id.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.bL=id.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.nza=id.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.oza=id.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.tpc=id.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.xDd=id.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.d6a=id.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.$Na=id.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.Q$a=id.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.FPa=id.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.dfc=id.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.Ek()};qb.prototype.O1e=function(l,J,Y){return Y.length<l||Y[l].length<J?(Cd.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",l,J),""):this.YR.oa(Y[l][J])};qb.prototype.Ek=function(){Mg.a.instance.pa(Bg.a.Xb,this.BU,this.Onc);Mg.a.instance.pa(Bg.a.Xb,this.bL,this.Onc);Mg.a.instance.pa(Bg.a.change,this.BU,this.Rca);Mg.a.instance.pa(Bg.a.change,this.bL,this.Rca);Mg.a.instance.pa(Bg.a.change,
this.bL,this.Dk);Mg.a.instance.pa(Bg.a.change,this.BU,this.Dk);Mg.a.instance.pa(Bg.a.change,this.nza,this.Dk);Mg.a.instance.pa(Bg.a.Xb,this.nza,this.Dk);Mg.a.instance.pa(Bg.a.change,this.oza,this.Dk);Mg.a.instance.pa(Bg.a.Xb,this.oza,this.Dk)};qb.prototype.wm=function(){Mg.a.instance.za(Bg.a.Xb,this.BU,this.Onc);Mg.a.instance.za(Bg.a.Xb,this.bL,this.Onc);Mg.a.instance.za(Bg.a.change,this.BU,this.Rca);Mg.a.instance.za(Bg.a.change,this.bL,this.Rca);Mg.a.instance.za(Bg.a.change,this.bL,this.Dk);Mg.a.instance.za(Bg.a.change,
this.BU,this.Dk);Mg.a.instance.za(Bg.a.change,this.nza,this.Dk);Mg.a.instance.za(Bg.a.Xb,this.nza,this.Dk);Mg.a.instance.za(Bg.a.change,this.oza,this.Dk);Mg.a.instance.za(Bg.a.Xb,this.oza,this.Dk)};qb.Ija=function(){var l;return l=new P.a,l.add("operatorInputId1"),l.add("operatorInputId2"),l};Ck.Object.defineProperties(qb.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return se.a.instance.fa(1668)}},w1g:{configurable:!0,enumerable:!0,get:function(){return this.BU.selectedIndex}}});
Object(Vd.a)(qb,"DataValidationEditConditionsControl",Si.a,[806,2,807]);var Hi=b(205),Pj=wk.a;Am(Ie,Pj);Ie.prototype.wTd=function(){var l={};l=(l.RuleType=this.Gd.ruleType,l.RuleOperatorType=this.Gd.MB,l.OperatorInput1=this.Gd.fO,l.OperatorInput2=this.Gd.gO,l.IsIgnoreBlank=this.Gd.L5,l.IsInCellDropDown=this.Gd.N5,l.IsAlertBlocking=this.Gd.x_,l.AlertTitle=this.Gd.AU,l.AlertMessage=this.Gd.zU,l.InputTitle=this.Gd.rF,l.InputMessage=this.Gd.jW,l.IsShowErrorAlert=this.Gd.a6,l.IsShowInputMessage=this.Gd.b6,
l);this.Bc(2,se.a.instance.fa(1634));var J={};l=(J[Ie.ay]=this.Cc,J.validateDialogValues=this.YVj,J.RangePickerController=Je.g(this.$).rg.xcc(),J.isModal=!1,J.bodyProps=l,J);this.initializeAndShow(se.a.instance.fa(1633),this.T5c,l);Cd.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};Ie.prototype.dispose=function(){this.disposed||(Pj.prototype.dispose.call(this),this.disposed=!0)};Ie.prototype.Ija=function(){return qb.Ija()};Ie.prototype.aOh=function(l,J){var Y=this;return function(za,
Ua,Qb){var uc=l.na.va.hc();return pa(Y.$.na.va,Y.selectedRanges,Y.JRg(),Y.e0a(za,Y.SAd(J)),lf.a(Ua),Qb,uc)}};Ie.prototype.SAd=function(l){var J=this;return function(Y){Cd.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var za;Bh.a(Y)?(Cd.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Y?wg.a.Xc(Y.Errors):null),Y.Errors&&1===Y.Errors.length&&((za=J.Ged(Y.Errors[0].MessageId))?
J.Ela("OkInvalidByServer",Y.Errors[0].MessageIdName):(J.Ela("OkValid","None"),J.hide()),l(za)),Cd.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",wg.a.Xc(Y.Errors))):J.hide()}};Ie.prototype.JRg=function(){var l={};l.Command=this.command;l.RuleType=this.Gd.ruleType;l.ConditionType=this.Gd.MB;l.IsIgnoreBlank=this.Gd.L5;l.IsInCellDropDown=this.Gd.N5;l.LowerBoundary=this.Gd.fO;l.UpperBoundary=this.Gd.gO;l.IsAlertBlocking=
this.Gd.x_;l.IsShowErrorAlert=this.Gd.a6;l.IsShowInputMessage=this.Gd.b6;l.AlertTitle=this.Gd.AU;l.AlertMessage=this.Gd.zU;l.InputTitle=this.Gd.rF;l.InputMessage=this.Gd.jW;l.ShouldIgnoreFormulaError=this.wNa;return l};Ie.prototype.Ged=function(l){switch(l){case 1173235830:return se.a.instance.fa(1683);case 43935303:return se.a.instance.fa(1684);case -1323438439:return se.a.instance.fa(1686);case 2112020473:return se.a.instance.fa(1680);case -219503282:return se.a.instance.fa(1681);case 1689335445:return se.a.instance.fa(1682);
case 2146493810:return se.a.instance.fa(1685);case -2104909922:return String.format(se.a.instance.Ab(105),this.wub,this.XNd);case -869372599:return String.format(se.a.instance.Ab(104),this.wub);case -1181828368:return se.a.instance.fa(1688);case -758480861:return se.a.instance.fa(1689);case -13729088:return se.a.instance.fa(1690);case -846654055:return se.a.instance.fa(1691);case 751854001:return se.a.instance.fa(1692);case -453846397:return se.a.instance.fa(1693);case 1102013489:return se.a.instance.fa(1694);
case 835813260:return se.a.instance.fa(1695);case 1577787509:return se.a.instance.fa(1696);case 2083564019:return se.a.instance.fa(1687);default:Cd.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",l.toString())}return null};Ie.prototype.mma=function(){this.Ela("Cancel","None")};Ie.prototype.sX=function(l){Cd.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===l?"Ok":"Cancel");var J={};l=(J.ButtonType=
Ie.Mia(l),J.DialogName=this.Cc,J.Location="dialog",J.NumberOfSelectedRanges=Je.g(this.$).ha.ta.YK,J);jg.b(this.$).Vd(Of.a.L6b,l)};Ie.prototype.Ela=function(l,J){var Y={};Ie.Gsb(this.Gd,Y);Y.o=l;Y.p=J;Y.n=this.Tka;this.mh&&(this.mh.stop(),Y.q=this.mh.id);Zg.b().Pe(49,Y,!0)};Ie.prototype.pbc=function(l){this.Gd.ruleType=l.RuleType;this.Gd.MB=l.RuleOperatorType;this.Gd.fO=l.OperatorInput1;this.Gd.gO=l.OperatorInput2;this.Gd.x_=l.IsAlertBlocking;this.Gd.a6=l.IsShowErrorAlert;this.Gd.AU=l.AlertTitle;this.Gd.zU=
l.AlertMessage;this.Gd.b6=l.IsShowInputMessage;this.Gd.rF=l.InputTitle;this.Gd.jW=l.InputMessage;this.Gd.L5=l.IsIgnoreBlank;this.Gd.N5=l.IsInCellDropDown;this.wub=l.firstOperatorLabel;this.XNd=l.secondOperatorLabel};Ie.prototype.cPb=function(l,J,Y){var za;var Ua=za=null;if(!l)return Y?(za=String.format(se.a.instance.Ab(105),this.wub,this.XNd),Ua="DataValidationEditNoMinMaxError"):(za=String.format(se.a.instance.Ab(104),this.wub),Ua="DataValidationEditNoValueError"),{returnValue:!1,errorString:za,
Fq:Ua};if(l.length>Sb.J9f)return za=se.a.instance.fa(1687),{returnValue:!1,errorString:za,Fq:Ua};if(Hi.d(l))return{returnValue:!0,errorString:za,Fq:Ua};if(1===J||2===J||6===J){if(!da.a.S5(l))return za=se.a.instance.fa(1680),{returnValue:!1,errorString:za,Fq:Ua};if(1===J&&!da.a.isInteger(l))return za=se.a.instance.fa(1681),{returnValue:!1,errorString:za,Fq:Ua};if(6===J){if(!da.a.isInteger(l))return za=se.a.instance.fa(1681),{returnValue:!1,errorString:za,Fq:Ua};if(0>parseInt(l,10))return za=se.a.instance.fa(1682),
{returnValue:!1,errorString:za,Fq:Ua}}}return{returnValue:!0,errorString:za,Fq:Ua}};Ie.prototype.D_d=function(){var l=this,J;var Y=J=null;var za=this.Gd.fO,Ua=this.Gd.gO,Qb=Wj[this.Gd.ruleType],uc=cg[this.Gd.MB];if(0===Qb)return{returnValue:!0,errorString:J,Fq:Y};var ed=(0===uc||1===uc)&&3!==Qb&&7!==Qb;return!function(){var Dd=l.cPb(za,Qb,ed);J=Dd.errorString;Y=Dd.Fq;return Dd}().returnValue||ed&&!function(){var Dd=l.cPb(Ua,Qb,ed);J=Dd.errorString;Y=Dd.Fq;return Dd}().returnValue?{returnValue:!1,
errorString:J,Fq:Y}:ed&&(1===Qb||2===Qb||6===Qb)&&!Hi.d(za)&&!Hi.d(Ua)&&parseFloat(za)>parseFloat(Ua)?(J=se.a.instance.fa(1685),Y="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:J,Fq:Y}):{returnValue:!0,errorString:J,Fq:Y}};Ie.Mia=function(l){switch(l){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Cd.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Ie.Gsb=function(l,J){J.a=ld(l.ruleType);
J.b=Vc(l.MB);J.c=!!l.fO;J.d=!!l.gO;J.e=l.L5;J.f=l.N5;J.g=l.b6;J.h=!!l.rF;J.i=!!l.jW;J.j=l.a6;J.k=l.x_;J.l=!!l.AU;J.m=!!l.zU};Ck.Object.defineProperties(Ie.prototype,{Gd:{configurable:!0,enumerable:!0,get:function(){return this.mSb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},j2b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Gd.ruleType}}});Object(Vd.a)(Ie,"DataValidationEditDialog",wk.a,[]);var Xj=b(323);Rb.cch="DataValidationDialogPanel";Rb.bch=
"DataValidationButtonPanel";Rb.ach="DataValidationButtonClearAll";Object(Vd.a)(Rb,"CssClassNames",null,[]);var kk=Si.a;Am(ud,kk);ud.prototype.render=function(l){l.appendChild(this.domElement)};ud.prototype.kka=function(){return this.isVisible};ud.prototype.Xna=function(l){return this.isVisible=l};ud.prototype.setFocus=function(){};ud.prototype.dispose=function(){this.wm();this.Dk=this.Hba=this.Gba=this.ibf=this.Fba=null;kk.prototype.dispose.call(this)};ud.prototype.Fka=function(){this.domElement.innerHTML=
Sb.vfh;this.Fba=id.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.ibf=id.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Hba=id.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Gba=id.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Fba.checked=!0;this.Ek();this.Qnc(null)};ud.prototype.UAa=function(l){this.Hba.value=void 0===l.rF||null===l.rF?"":l.rF;this.Gba.value=void 0===
l.jW||null===l.jW?"":l.jW;this.Fba.checked=l.b6;this.Qnc(null)};ud.prototype.Spb=function(l){l.rF=this.Hba.value;l.jW=this.Gba.value;l.b6=this.Fba.checked};ud.prototype.Ek=function(){Mg.a.instance.pa(Bg.a.change,this.Fba,this.Qnc);Mg.a.instance.pa(Bg.a.change,this.Fba,this.Dk);Mg.a.instance.pa(Bg.a.change,this.Hba,this.Dk);Mg.a.instance.pa(Bg.a.Xb,this.Hba,this.Dk);Mg.a.instance.pa(Bg.a.change,this.Gba,this.Dk);Mg.a.instance.pa(Bg.a.Xb,this.Gba,this.Dk)};ud.prototype.wm=function(){Mg.a.instance.za(Bg.a.change,
this.Fba,this.Qnc);Mg.a.instance.za(Bg.a.change,this.Fba,this.Dk);Mg.a.instance.za(Bg.a.change,this.Hba,this.Dk);Mg.a.instance.za(Bg.a.Xb,this.Hba,this.Dk);Mg.a.instance.za(Bg.a.change,this.Gba,this.Dk);Mg.a.instance.za(Bg.a.Xb,this.Gba,this.Dk)};Ck.Object.defineProperties(ud.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return se.a.instance.fa(1670)}}});Object(Vd.a)(ud,"DataValidationEditInputControl",Si.a,[806,2,809]);var Dj=Si.a;Am(ae,Dj);ae.prototype.render=function(l){l.appendChild(this.domElement)};
ae.prototype.kka=function(){return this.isVisible};ae.prototype.Xna=function(l){return this.isVisible=l};ae.prototype.setFocus=function(){};ae.prototype.dispose=function(){this.wm();this.Dk=this.r$=this.q$=this.KUa=this.Nha=this.p$=null;Dj.prototype.dispose.call(this)};ae.prototype.Fka=function(){this.domElement.innerHTML=Sb.zfh;this.p$=id.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.Nha=id.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.KUa=
id.DOMElementExtensions.getElementById(this.domElement,"warningId");this.r$=id.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.q$=id.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.p$.checked=!0;this.Nha.checked=!0;this.Ek();this.Pnc(null)};ae.prototype.UAa=function(l){this.Nha.checked=l.x_;this.KUa.checked=!l.x_;this.r$.value=void 0===l.AU||null===l.AU?"":l.AU;this.q$.value=void 0===l.zU||null===l.zU?"":l.zU;this.p$.checked=l.a6;this.Pnc(null)};
ae.prototype.Spb=function(l){l.AU=this.r$.value;l.zU=this.q$.value;l.x_=this.Nha.checked;l.a6=this.p$.checked};ae.prototype.Ek=function(){Mg.a.instance.pa(Bg.a.change,this.p$,this.Pnc);Mg.a.instance.pa(Bg.a.change,this.p$,this.Dk);Mg.a.instance.pa(Bg.a.change,this.Nha,this.Dk);Mg.a.instance.pa(Bg.a.change,this.KUa,this.Dk);Mg.a.instance.pa(Bg.a.change,this.r$,this.Dk);Mg.a.instance.pa(Bg.a.Xb,this.r$,this.Dk);Mg.a.instance.pa(Bg.a.change,this.q$,this.Dk);Mg.a.instance.pa(Bg.a.Xb,this.q$,this.Dk)};
ae.prototype.wm=function(){Mg.a.instance.za(Bg.a.change,this.p$,this.Pnc);Mg.a.instance.za(Bg.a.change,this.p$,this.Dk);Mg.a.instance.pa(Bg.a.change,this.Nha,this.Dk);Mg.a.instance.pa(Bg.a.change,this.KUa,this.Dk);Mg.a.instance.za(Bg.a.change,this.r$,this.Dk);Mg.a.instance.za(Bg.a.Xb,this.r$,this.Dk);Mg.a.instance.za(Bg.a.change,this.q$,this.Dk);Mg.a.instance.za(Bg.a.Xb,this.q$,this.Dk)};Ck.Object.defineProperties(ae.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return se.a.instance.fa(1669)}}});
Object(Vd.a)(ae,"DataValidationEditMessagesControl",Si.a,[806,2,808]);Object(Vd.a)(Ce,"MacroRecorderRangeDataValidationChangedPayload",null,[447]);var Fj=b(67),Qj=Xj.a;Am(Md,Qj);Md.prototype.wTd=function(){var l={};l=(l.key=this.Gd,l);this.initializeAndShow(se.a.instance.fa(1633),this.T5c,l);Cd.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};Md.prototype.dispose=function(){this.disposed||(this.Cfc=this.Jlc=this.T3=null,hh.a.Ha(this.tDb),this.tDb=null,jg.b(this.$)&&
jg.b(this.$).TUd("DataValidationDialogCorellation"),Qj.prototype.dispose.call(this),this.disposed=!0)};Md.prototype.Kv=function(l){Qj.prototype.Kv.call(this,l);this.Bc(2,se.a.instance.fa(1634));l=this.RV(2);var J=this.RV(1),Y=this.RV(0),za=J.parentNode;za.appendChild(l);za.appendChild(J);za.appendChild(Y);l.parentNode.classList.add(Rb.bch);l.classList.add(Rb.ach);l=document.getElementById("dataValidationTabsId");J=new qb(this.$,document.createElement("div"),this.Rca);Y=new ud(document.createElement("div"),
this.Rca);za=new ae(document.createElement("div"),this.Rca);this.vci(J,Y,za);var Ua;this.tDb=new Hb(l,(Ua=new P.a,Ua.add(J),Ua.add(Y),Ua.add(za),Ua));this.tDb.QRf();this.AV=document.getElementById("validationErrorMessageId");this.UAa();jg.b(this.$)&&jg.b(this.$).FUd("DataValidationDialogCorellation")};Md.prototype.UO=function(){Qj.prototype.UO.call(this);document.getElementById(this.pi("WACDialogPanel")).classList.add(Rb.cch)};Md.prototype.Ija=function(){return qb.Ija()};Md.prototype.Ved=function(){return"validationErrorMessageId"};
Md.prototype.vci=function(l,J,Y){this.T3=l;this.Cfc=J;this.Jlc=Y};Md.prototype.wnj=function(){function l(){return new Ce(J.selectedRanges,Y)}var J=this,Y={};Y.IsClearAll=this.Tka;Y.Command=this.command;Y.RuleType=this.Gd.ruleType;Y.ConditionType=this.Gd.MB;Y.IsIgnoreBlank=this.Gd.L5;Y.IsInCellDropDown=this.Gd.N5;Y.LowerBoundary=this.Gd.fO;Y.UpperBoundary=this.Gd.gO;Y.IsAlertBlocking=this.Gd.x_;Y.IsShowErrorAlert=this.Gd.a6;Y.IsShowInputMessage=this.Gd.b6;Y.AlertTitle=this.Gd.AU;Y.AlertMessage=this.Gd.zU;
Y.InputTitle=this.Gd.rF;Y.InputMessage=this.Gd.jW;Y.ShouldIgnoreFormulaError=this.wNa;var za=this.$.na.va.hc();af.a(this.$.userOperationManager,function(Ua,Qb,uc){return pa(J.$.na.va,J.selectedRanges,Y,lf.b(Ua,J.SAd),lf.a(Qb),uc,za)},function(Ua){return new Wg.a(121,0,Ua,void 0,l)},null)};Md.prototype.nzj=function(l){return 1577787509===l};Md.prototype.Auj=function(l){this.AV.innerText=l;this.aA(this.RV(0));this.wNa=!0};Md.prototype.$ze=function(){this.wNa=!1;this.AV.innerText=""};Md.prototype.Ged=
function(l){switch(l){case 1173235830:return se.a.instance.fa(1683);case 43935303:return se.a.instance.fa(1684);case -1323438439:return se.a.instance.fa(1686);case 2112020473:return se.a.instance.fa(1680);case -219503282:return se.a.instance.fa(1681);case 1689335445:return se.a.instance.fa(1682);case 2146493810:return se.a.instance.fa(1685);case -2104909922:return String.format(se.a.instance.Ab(105),this.T3.Tvb(this.Gd.ruleType,this.Gd.MB),this.T3.ohd(this.Gd.ruleType,this.Gd.MB));case -869372599:return String.format(se.a.instance.Ab(104),
this.T3.Tvb(this.Gd.ruleType,this.Gd.MB));case -1181828368:return se.a.instance.fa(1688);case -758480861:return se.a.instance.fa(1689);case -13729088:return se.a.instance.fa(1690);case -846654055:return se.a.instance.fa(1691);case 751854001:return se.a.instance.fa(1692);case -453846397:return se.a.instance.fa(1693);case 1102013489:return se.a.instance.fa(1694);case 835813260:return se.a.instance.fa(1695);case 1577787509:return se.a.instance.fa(1696);case 2083564019:return se.a.instance.fa(1687);default:Cd.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",l.toString())}return null};Md.prototype.w$a=function(){Cd.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.pbc();var l=this.D_d();var J=l.errorString;var Y=l.Fq;if(!l.returnValue)return this.Bs(J),this.Ela("OkInvalidByClient",Y),!1;this.wnj();return!0};Md.prototype.mma=function(){this.pbc();this.Ela("Cancel","None");this.hide()};Md.prototype.Oya=function(){Cd.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.wNa?this.$ze():this.X0c();this.Qgj();this.Tka=!0};Md.prototype.sX=function(l){var J={};l=(J.ButtonType=Md.Mia(l),J.DialogName=this.Cc,J.Location="dialog",J.NumberOfSelectedRanges=Je.g(this.$).ha.ta.YK,J);jg.b(this.$).Vd(Of.a.L6b,l)};Md.prototype.Qgj=function(){this.mSb=new tc;this.UAa()};Md.prototype.UAa=function(){this.Jlc.UAa(this.Gd);this.Cfc.UAa(this.Gd);this.T3.UAa(this.Gd)};Md.prototype.pbc=function(){this.T3.Spb(this.Gd);
this.Jlc.Spb(this.Gd);this.Cfc.Spb(this.Gd)};Md.prototype.Ela=function(l,J){var Y={};Md.Gsb(this.Gd,Y);Y.o=l;Y.p=J;Y.n=this.Tka;this.mh&&(this.mh.stop(),Y.q=this.mh.id);Zg.b().Pe(49,Y,!0)};Md.prototype.cPb=function(l,J){var Y;var za=Y=null;if(!l)return J?(Y=String.format(se.a.instance.Ab(105),this.T3.Tvb(this.Gd.ruleType,this.Gd.MB),this.T3.ohd(this.Gd.ruleType,this.Gd.MB)),za="DataValidationEditNoMinMaxError"):(Y=String.format(se.a.instance.Ab(104),this.T3.Tvb(this.Gd.ruleType,this.Gd.MB)),za="DataValidationEditNoValueError"),
{returnValue:!1,errorString:Y,Fq:za};if(l.length>Sb.J9f)return Y=se.a.instance.fa(1687),{returnValue:!1,errorString:Y,Fq:za};if(Hi.d(l))return{returnValue:!0,errorString:Y,Fq:za};if(1===this.Gd.ruleType||2===this.Gd.ruleType||6===this.Gd.ruleType){if(!da.a.S5(l))return Y=se.a.instance.fa(1680),{returnValue:!1,errorString:Y,Fq:za};if(1===this.Gd.ruleType&&!da.a.isInteger(l))return Y=se.a.instance.fa(1681),{returnValue:!1,errorString:Y,Fq:za};if(6===this.Gd.ruleType){if(!da.a.isInteger(l))return Y=
se.a.instance.fa(1681),{returnValue:!1,errorString:Y,Fq:za};if(0>parseInt(l,10))return Y=se.a.instance.fa(1682),{returnValue:!1,errorString:Y,Fq:za}}}return{returnValue:!0,errorString:Y,Fq:za}};Md.prototype.D_d=function(){var l=this,J;var Y=J=null;if(this.Tka||0===this.Gd.ruleType)return{returnValue:!0,errorString:J,Fq:Y};var za=(0===this.Gd.MB||1===this.Gd.MB)&&3!==this.Gd.ruleType&&7!==this.Gd.ruleType;return!function(){var Ua=l.cPb(l.Gd.fO,za);J=Ua.errorString;Y=Ua.Fq;return Ua}().returnValue||
za&&!function(){var Ua=l.cPb(l.Gd.gO,za);J=Ua.errorString;Y=Ua.Fq;return Ua}().returnValue?{returnValue:!1,errorString:J,Fq:Y}:za&&(1===this.Gd.ruleType||2===this.Gd.ruleType||6===this.Gd.ruleType)&&!Hi.d(this.Gd.fO)&&!Hi.d(this.Gd.gO)&&parseFloat(this.Gd.fO)>parseFloat(this.Gd.gO)?(J=se.a.instance.fa(1685),Y="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:J,Fq:Y}):{returnValue:!0,errorString:J,Fq:Y}};Md.Mia=function(l){switch(l){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";
default:return Cd.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Md.Gsb=function(l,J){J.a=ld(l.ruleType);J.b=Vc(l.MB);J.c=!!l.fO;J.d=!!l.gO;J.e=l.L5;J.f=l.N5;J.g=l.b6;J.h=!!l.rF;J.i=!!l.jW;J.j=l.a6;J.k=l.x_;J.l=!!l.AU;J.m=!!l.zU};Ck.Object.defineProperties(Md.prototype,{Gd:{configurable:!0,enumerable:!0,get:function(){return this.mSb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},
onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var l=this;return function(){l.sX(1);l.w$a()}},set:function(l){Object(Fj.b)(Md.prototype,this,"onCommitDialogHandler",l)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},j2b:{configurable:!0,enumerable:!0,get:function(){return 3===this.T3.w1g}}});Object(Vd.a)(Md,"DataValidationEditDialogDeprecated",Xj.a,[]);zc.prototype.bIa=function(l,J,Y,za){We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",
!1)?(new Ie(l,J,Y,za)).wTd():(new Md(l,J,Y,za)).wTd()};zc.prototype.e5g=function(l,J){var Y=new Yg.StandardDialog;Y.jc=3;Y.hBa(l.zb.c_,se.a.instance.fa(1678),J)};zc.prototype.g5g=function(l,J){var Y=new Yg.StandardDialog;Y.jc=1;Y.OX(l.zb.c_,se.a.instance.fa(1679),J)};Object(Vd.a)(zc,"DataValidationEditDialogFactory",null,[754]);var mj=Sf.a;Am(jc,mj);jc.prototype.Nd=function(){this.Dd([new $b(this.$,new zc)])};jc.ka=function(l){Sf.a.he(245,new jc(l))};Object(Vd.a)(jc,"DataValidationEditCommandHandlerFactory",
Sf.a,[]);vg.wjg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(Vd.a)(vg,"FileUploadDialogHTML",null,[]);var mi=b(156),qk=dj.a;Am(qf,qk);qf.prototype.ui=function(l,J,Y,za,Ua){Ua=void 0===Ua?!0:Ua;this.mwd=void 0===za?!1:za;this.pAj(J);this.Hof=l;Ua&&Fg.AFrameworkApplication.fG(l)};qf.prototype.pAj=function(l){if(qf.Hu)this.XBj(l);else{var J={};J[qf.pTg]=l;J[qf.vTg]=CommonUIStrings.l_SendFileErrorReportMessage;J[qf.wTg]=CommonUIStrings.l_SendFileErrorReportTextCaption;J[qf.YZc]="";J[qf.sTg]=CommonUIStrings.l_UserReportLinkText;J[qf.z1b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(ci.a)(this,this.Msi,"legacyDialogHandler"),J);this.IX(qf.BTg)}};qf.prototype.XBj=function(l){var J={},Y={},za={},Ua={},Qb={};l=(Qb.id=this.Oe,Qb.bodyControls=(Ua.reportErrorCheckboxProps=this.mwd?(J.label=CommonUIStrings.l_UserReportLinkText,J):null,Ua.textAreaProps=this.zpf?{}:null,Ua.privacyStatementLinkProps=(za.text=CommonUIStrings.l_PrivacyStatement,za.handler=(Y.href=Fg.AFrameworkApplication.Wma,Y.target="_blank",Y),za),Ua),Qb.errorMessage=l,Qb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
Qb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,Qb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ci.a)(this,this.DHd,"reactDialogHandler"),l)};qf.prototype.h$a=function(){if(!qf.Hu){var l=document.getElementById(qf.yTg);l&&(l.className=qf.xTg,l.appendChild(mi.createClusteredImage(32,32,qf.uTg,null,!0,CommonUIStrings.l_DialogError)));if(l=document.getElementById(qf.zTg))l.innerText=CommonUIStrings.l_PrivacyStatement,l.href=Fg.AFrameworkApplication.Wma,yi.a.addHandler(l,
"click",Object(ci.a)(this,this.QQi,"onPrivacyClickHandler"));this.zpf||(l=document.getElementById(qf.YZc))&&l.parentNode&&l.parentNode.removeChild(l);this.mwd||(l=document.getElementById(qf.rTg))&&l.parentNode&&l.parentNode.removeChild(l)}};qf.prototype.UO=function(){qf.Hu||(qk.prototype.UO.call(this),document.getElementById(this.pi("WACDialogPanel")).style.width=String.format("{0}px",400))};qf.prototype.Msi=function(l,J){var Y=J[qf.YZc]||"",za=!0;void 0!==J[qf.z1b]&&null!==J[qf.z1b]&&(za=J[qf.z1b]);
this.Dw(l,Y,za)};qf.prototype.DHd=function(l,J){this.Dw(l,J.text||"",J.reportErrorChecked)};qf.prototype.Dw=function(l,J,Y){this.Aof&&(Y&&Cd.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Hof),this.Aof(l,J,Y))};qf.prototype.QQi=function(l){Fg.AFrameworkApplication.Ib.Be(pi.a.Oza,2,l)};Ck.Object.defineProperties(qf.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ck.Object.defineProperties(qf,{Hu:{configurable:!0,enumerable:!0,get:function(){return Fg.AFrameworkApplication.sa.Pa.wv&&
Fg.AFrameworkApplication.sa.Pa.rmi}}});qf.pTg="WACDialogErrorMessage";qf.vTg="WACDialogErrorReportMessage";qf.wTg="WACDialogErrorTextPrompt";qf.YZc="WACDialogInput";qf.zTg="WACDialogPrivacyText";qf.yTg="WACDialogIconPanel";qf.uTg="CancelRequest_32x32x32";qf.xTg="WACDialogIcon";qf.BTg="WACDialogTextPanel";qf.z1b="WACDialogSendFileCheckbox";qf.rTg="WACDialogSendFileCheckboxContainer";qf.sTg="WACDialogSendFileCheckboxText";qf.tTg="FileUploadErrorDialog";Object(Vd.a)(qf,"FileUploadErrorDialog",dj.a,[]);
var xk=zg.a;Am(Lf,xk);Lf.prototype.XEg=function(l){this.addHandler("fileCollectionComplete",l)};Lf.prototype.Ebj=function(l){this.removeHandler("fileCollectionComplete",l)};Lf.prototype.v_g=function(l,J,Y){this.uJf=J;this.sH=l;this.XEg(Y);Fg.AFrameworkApplication.Wma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;l=new qf(this.w_g);Fg.AFrameworkApplication.Ib.fc(pi.a.Oza,yh.a.frame,Lf.X1i);l.ui(0,"",null,!1,!1)};Lf.prototype.oaj=function(l){this.Ebj(l)};Lf.X1i=function(l,J,Y,za,Ua){yi.a.Tt(Ua);
Fg.AFrameworkApplication.Wma&&md.HelperMethods.rf(Fg.AFrameworkApplication.Wma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(Vd.a)(Lf,"FileCollectionOperation",zg.a,[749,2]);var Wf=Og.a;Am(Ig,Wf);Ig.prototype.create=function(){var l=this;Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){l.Eb(l.QAh)},this.la,3)};Ig.prototype.dispose=function(){hh.a.Ha(this.NSb);this.NSb=null;Wf.prototype.dispose.call(this)};Ig.ka=function(l){l.da.Ga(125,
new Ig(l))};Ck.Object.defineProperties(Ig.prototype,{QAh:{configurable:!0,enumerable:!0,get:function(){return this.NSb||(this.NSb=new Lf(this.$))}}});Object(Vd.a)(Ig,"FileCollectionCommandHandlerFactory",Og.a,[]);var If=b(1007),Ui=b(190),Qi=b(279),ai=b(1088);Re.EGh="GalleryGeneral";Re.GGh="GalleryNumber";Re.CGh="GalleryCurrency";Re.AGh="GalleryAccounting";Re.JGh="GalleryShortDate";Re.FGh="GalleryLongDate";Re.LGh="GalleryTime";Re.HGh="GalleryPercentage";Re.DGh="GalleryFraction";Re.IGh="GalleryScientific";
Re.KGh="GalleryText";Re.YSg="ButtonComma";Re.buttonPercentage="ButtonPercentage";Re.keyboardNumber="KeyboardNumber";Re.keyboardCurrency="KeyboardCurrency";Re.keyboardDate="KeyboardDate";Re.keyboardTime="KeyboardTime";Re.keyboardPercentage="KeyboardPercentage";Object(Vd.a)(Re,"RibbonFormatKind",null,[]);var O=b(308),Ea=b(715),Nb=b(714),sc=b(713),Zc=O.a;Am(ie,Zc);ie.prototype.u3=function(l){return Zc.prototype.u3.call(this,l)||this.$Eh.u3(this.Acd,this.activeCell,this.format,this.pse,this.MHf,this.HHf,
this.C_b,this.EFa,this.clientCorrelationId,this.Amb,this.Vib)};ie.prototype.vk=function(){var l=[];if(this.udc)for(var J=Cl(this.udc),Y=J.next();!Y.done;Y=J.next())l.push(sc.a(Y.value));else l.push(new Nb.a(this.format,this.Acd,this.activeCell));return function(){return new Ea.a(l)}};ie.prototype.Web=function(){var l={OperationType:0};l.FormatCellsMultiRange=this.Acd;l.ActiveCell=this.activeCell;l.Format=this.format;l.ApplyFormatOnPivotTableValueField=this.pse;l.PivotTableXluid=this.MHf;l.PivotTableFieldCaption=
this.HHf;return l};Ck.Object.defineProperties(ie.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return We.EwaSettings.qc()?Object(Fj.a)(ie.prototype,this,"operationWorkingState"):0}},At:{configurable:!0,enumerable:!0,get:function(){return this.Amb}},Qaa:{configurable:!0,enumerable:!0,get:function(){return this.Vib}},WCc:{configurable:!0,enumerable:!0,get:function(){return this.EFa}}});Object(Vd.a)(ie,"FormatCellsBatchOperation",O.a,[]);var Ic=b(212);gg.editCell="Edited";
gg.dependentCell="Dependents";Object(Vd.a)(gg,"RecalcPriorityGroupType",null,[]);var Gd=b(227),ze=b(9);Object(Vd.a)($f,"RecalcAccuracyObject",null,[]);Jf.string="String";Jf.blank="Blank";Jf.general="General";Jf.FDh="Flexible";Object(Vd.a)(Jf,"FormattedUnitKind",null,[]);Object(Vd.a)(Le,"RecalcResultProcessingStatistics",null,[]);Object(Vd.a)(ee,"RecalcedCellInfo",null,[]);var Vf=b(110),Cf=b(61),qg=b(567);Xd.prototype.dispose=function(){this.calcManager=this.Mzc=this.Sg=this.grid=this.$=null};Xd.prototype.pKf=
function(l){var J;if(l&&l.rangeDeltas){for(var Y=this.vda.length,za=0;za<l.rangeDeltas.length;za++)(null===(J=l.rangeDeltas[za])||void 0===J?0:J.data)&&void 0!==l.rangeDeltas[za].data.value&&null!==l.rangeDeltas[za].data.value&&void 0!==l.rangeDeltas[za].range&&null!==l.rangeDeltas[za].range&&this.vda.push(new ee(l.rangeDeltas[za],l.stateId,l.isFinished,l.priorityGroup));Cd.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
l.stateId,l.priorityGroup,l.isFinished,l.rangeDeltas.length,Y,this.vda.length,this.lastSetCellInstantaneousOperation);!Y&&this.vda.length&&this.kCf(!1,0)}};Xd.prototype.kbd=function(l,J,Y,za,Ua,Qb,uc){if(!J)return Object(qg.a)("Null");var ed=excelOnlineCalc.numfmt.renderCallback(za,function(hd){return gridRenderer.CanvasRendererGlobals.measureTextWidth(hd,Ua,!0,We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},uc),Dd=l.renderValue(J,ed);if(!excelOnlineCalc.util.isSuccess(Dd))return Object(qg.a)("Finalize");
za=null;if(uc=excelOnlineCalc.numfmt.isHashesValue(Dd.value)){if(Dd=l.renderHashesValue(Dd.value,ed),!excelOnlineCalc.util.isSuccess(Dd))return Object(qg.a)("Hashes")}else za=Xd.lFh(J,Dd.value);ed=Dd.value;l=excelOnlineCalc.numfmt.renderedValueToString(ed);J=Ne(ed);ed=pe(ed);return Object(qg.d)({text:l,valueType:Y,fontColor:ed,Ck:Qb,M9a:za,horizontalAlignment:J,isHashesValue:uc})};Xd.prototype.kCf=function(l,J){var Y=this;this.$&&this.grid&&this.calcManager&&this.Mzc&&this.calcManager.Eo?(l&&(this.pda=
this.Mzc.Abf),this.z2i(this.grid,this.calcManager.Eo,l,J),!this.pda&&this.vda.length?ig.Task.delay(0).CWRCT(function(za){Y.kCf(!0,za.id);return!0},null,0,Cf.a.current):ig.Task.Ra(!0)):(Cd.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),ig.Task.Ra(!1))};Xd.prototype.z2i=function(l,J,Y,za){var Ua=md.HelperMethods.Zb();for(Y=new Le(this.vda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.pda,void 0,void 0,void 0,Y,void 0,za,!0,0,0,0,0,0,0);0<this.vda.length;){za=md.HelperMethods.Zb()-Ua;if(!this.pda||za>this.pda){Y.numberOfCellsSkippedDueToTimeout=this.vda.length;break}za=Array.dequeue(this.vda);if(ef(za,Y)){var Qb=sg.Range.hd(za.rangeDelta.range.row+1,za.rangeDelta.range.column+1);(Qb=l.mc(Qb))?Xd.RUg(za.stateId,Qb.cell)?(Xd.Emc(l,Qb,za,Y),this.lLg(J,Qb,za,Y)):Y.numberOfCellsUpdatedAlreadyByServer++:Y.numberOfCellsWithNoFormattedCell++}}za=Math.round(md.HelperMethods.Zb()-
Ua);this.tUj(za);this.uHj(Y,za);this.Yfj(Y)};Xd.prototype.lLg=function(l,J,Y,za){var Ua,Qb,uc,ed,Dd=te(J,Y),hd=Y.rangeDelta.data.formatted,Ke=Ue(Y),zf=Sd(Y);l=this.kbd(l,hd,Ke,J.cell.EBa,J.cell.oaa,Dd,!1);Dd=J.cell.L1d;if(Object(qg.c)(l))if(this.PAb&&this.Hsd){if(0===zf||J.text!==l.value.text)this.bqi&&0===zf&&this.$Rd(Dd,l.value)&&(J.cell.formattedText=Dd),this.Sg.LZa(J,l.value),Y=Dc(Y),this.Sg.I8c(J,this.lastSetCellInstantaneousOperation,2,Y,!0,!0),za.numberOfUpdatedCells++}else J.text!==l.value.text&&
(this.Sg.LZa(J,l.value),Y=Dc(Y),this.Sg.I8c(J,this.lastSetCellInstantaneousOperation,2,Y,!0,!0),za.numberOfUpdatedCells++);else switch(l.reason){case "Null":We.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?za.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Ua=za.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Ua?Ua:0)+1:za.numberOfRecalcedCellsWithoutFormattedValue=null==za.numberOfRecalcedCellsWithoutFormattedValue?0:za.numberOfRecalcedCellsWithoutFormattedValue+
1;break;case "Hashes":We.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?za.numberOfHashFormattedValues=(null!==(Qb=za.numberOfHashFormattedValues)&&void 0!==Qb?Qb:0)+1:za.numberOfHashFormattedValues=null==za.numberOfHashFormattedValues?0:za.numberOfHashFormattedValues+1;break;case "Finalize":We.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?za.newNumberFormatterFinalizeFailures=(null!==(uc=za.newNumberFormatterFinalizeFailures)&&
void 0!==uc?uc:0)+1:za.newNumberFormatterFinalizeFailures=null==za.newNumberFormatterFinalizeFailures?0:za.newNumberFormatterFinalizeFailures+1}Object(qg.b)(l)&&"Null"!==l.reason&&(We.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?za.numberOfRecalcedCellsWithFormattedValue=(null!==(ed=za.numberOfRecalcedCellsWithFormattedValue)&&void 0!==ed?ed:0)+1:za.numberOfRecalcedCellsWithFormattedValue=null==za.numberOfRecalcedCellsWithFormattedValue?0:za.numberOfRecalcedCellsWithFormattedValue+
1);za=0===zf?J.cell.userInput:J.formulaBarText;ed=Object(qg.c)(l)?l.value.text:"";Y=Object(qg.b)(l)?l.reason:"";Cd.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",J.range.top,J.range.left,l.success,Y,zf,J.cell.Ck,za?da.a.HJ(za):"null",ed?da.a.HJ(ed):"null")};Xd.prototype.tUj=function(l){this.pda=Math.max(this.pda-Math.max(l,1),0)};Xd.prototype.uHj=function(l,
J){l.numberOfNonUpdatedCells=this.vda.length;l.totalExecutionTime=J;l.newProcessingTimeLimit=this.pda;l.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};Xd.prototype.Yfj=function(l){l=Sys.Serialization.JavaScriptSerializer.serialize(l);Cd.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",l)};Xd.lFh=function(l,J){l=l.units;var Y=J.units;if(l.length!==Y.length)return Cd.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;J=[];for(var za=-1,Ua=0;Ua<l.length;Ua++)switch(l[Ua].kind){case Jf.blank:J.push.apply(J,Vf.h(" ",Y[Ua].str.length));break;case Jf.string:J.push(l[Ua].str);break;case Jf.FDh:J.push("");za=Ua;break;case Jf.general:J.push(Y[Ua].str);break;default:Cd.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=za||""===Y[za].str)return null;Y={};Y.Start=J.slice(0,za).join("");Y.Separator=l[za].str;Y.End=J.slice(za+1,J.length).join("");return Y};
Xd.MLh=function(l){return l&&l&&l.fu?l.fu.JJ:ze.a.Re};Xd.RUg=function(l,J){if(!J)return!1;J=Xd.MLh(J);return J===ze.a.Re||J===l};Xd.Emc=function(l,J,Y,za){var Ua=Y.rangeDelta.data.value.toString(),Qb=Ue(Y),uc=te(J,Y);Ua=new $f(Qb,Ua,uc,Y.priorityGroup);J.cell.Emc(Ua,l.Ea.l6);1===Sd(Y)?za.numberOfDependentRecalcedCellsInBatch++:za.numberOfEditedRecalcedCellsInBatch++};Xd.prototype.$Rd=function(l,J){return null==l?!1:!!l.TextRuns&&!!l.Fonts&&l.Text===J.text&&2===J.valueType};Xd.JHe=20;Object(Vd.a)(Xd,
"CalcResultProcessor",null,[767,2]);Object(Vd.a)(Ad,"GetRibbonNumberFormatResult",null,[]);ne.prototype.AKb=function(l,J,Y){var za=J.Border;J=J.BorderFormat;var Ua=0,Qb=!1;if(0===za)l.cell.Gsc(),this.jJd(l.cell.getRange());else{for(var uc=0;3>=uc;uc++)ne.Owj(l,Y,uc,za)&&(Ua|=md.HelperMethods.Y3a(uc),this.ZYd(l.cell.getRange(),uc,J),Qb=!0);md.HelperMethods.GR(za,16)&&!Hi.c(l,0,Y)&&(Ua|=2,this.ZYd(l.cell.getRange(),0,J),Qb=!0);md.HelperMethods.GR(za,32)&&!Hi.c(l,2,Y)&&(Ua|=4,this.ZYd(l.cell.getRange(),
2,J),Qb=!0);Qb&&(Y=l.cell.fu.uf,md.HelperMethods.GR(Ua,2)&&this.d3f(l,Y,0)&&(Ua&=-3),md.HelperMethods.GR(Ua,1)&&this.c3f(l,Y,1)&&(Ua&=-2),md.HelperMethods.GR(Ua,4)&&this.d3f(l,Y,2)&&(Ua&=-5),md.HelperMethods.GR(Ua,8)&&this.c3f(l,Y,3)&&(Ua&=-9),l.cell.setBorders(J,Ua,!1))}};ne.prototype.hR=function(l,J){l=ne.IXe(l,J);return l.isValidRange?(l=this.Ea.pva(l))&&l.length?l:null:null};ne.prototype.jJd=function(l){for(var J=0;3>=J;J++){var Y=ne.IXe(l,J);if(Y.isValidRange&&(Y=this.Ea.pva(Y))&&Y.length)for(var za=
ne.P1e(J),Ua=0;Ua<Y.length;Ua++)Y[Ua].KQa(za)}};ne.prototype.ZYd=function(l,J,Y){if(l=this.hR(l,J))for(var za=ne.P1e(J),Ua=md.HelperMethods.Y3a(za),Qb=0;Qb<l.length;Qb++){var uc=l[Qb];this.jgi(uc,za)&&ne.setBorders(uc,Y,Ua,J,za)}};ne.prototype.jgi=function(l,J){var Y=l.fu.uf,za=l.getRange();za=this.hR(za,J);var Ua=!1,Qb=!1,uc=!1,ed=!1;za&&(Ua=ne.d7a(za,!0),Qb=ne.d7a(za,!1),ed=ne.iqd(za),uc=1===za.length?!0:!1);switch(J){case 0:return ne.Afi(l,Y,ed,Qb,uc);case 1:return ne.xfi(l,Y,ed,Ua,uc);case 2:return ne.yfi(l,
Y,ed,Ua,uc);case 3:return ne.zfi(l,Y,ed,Qb,uc)}return!1};ne.prototype.d3f=function(l,J,Y){if(!l.cell.pN)return!1;var za=l.range,Ua=this.hR(za,Y),Qb=Hi.c(l,Y,J),uc=!1;J=0===Y?za.top<J.top:za.left<J.left;!ne.Xzb(l.cell)&&Ua&&1!==Ua.length&&(uc=(0===Y?ne.d7a(Ua,!0):ne.d7a(Ua,!1))?!1:!0);return!Qb&&uc||J?!0:!1};ne.prototype.c3f=function(l,J,Y){var za=l.cell,Ua=this.hR(za.getRange(),Y);l=Hi.c(l,Y,J);J=!1;if(Ua){var Qb=ne.d7a(Ua,!0),uc=ne.d7a(Ua,!1),ed=Qb&&!uc;uc=uc&&!Qb;1!==Y||ne.RAb(za)?3!==Y||ne.Lzb(za)||
ne.Vwj(za,Ua,uc,ed)&&(J=!0):ne.Uwj(za,Ua,Qb,uc)&&(J=!0)}return!l&&J||ne.Xzb(za)?!0:!1};ne.vQg=function(l,J,Y){var za={};za.LineStyle=Array(4);za.LineStyle[Y]=l.LineStyle[J];za.Color=Array(4);za.Color[Y]=l.Color[J];return za};ne.Mcf=function(l,J,Y,za,Ua){return md.HelperMethods.GR(l,Ua)&&Hi.c(J,Y,za)};ne.Owj=function(l,J,Y,za){return ne.Mcf(za,l,Y,J,md.HelperMethods.Y3a(Y))||ne.Mcf(za,l,Y,J,64)||112===za};ne.setBorders=function(l,J,Y,za,Ua){J=ne.vQg(J,za,Ua);l.setBorders(J,Y,!1)};ne.IXe=function(l,
J){switch(J){case 0:return new sg.Range(l.top-1,l.left,l.top-1,l.right,!1,!1);case 2:return new sg.Range(l.top,l.left-1,l.bottom,l.left-1,!1,!1);case 1:return new sg.Range(l.bottom+1,l.left,l.bottom+1,l.right,!1,!1);case 3:return new sg.Range(l.top,l.right+1,l.bottom,l.right+1,!1,!1)}return l};ne.P1e=function(l){switch(l){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};ne.d7a=function(l,J){for(var Y=0;Y<l.length;Y++){var za=l[Y];if(za.pN)return J?ne.Lzb(za):ne.RAb(za)}return!1};
ne.Xzb=function(l){var J=l.fu.uf,Y=l.getRange();return l.pN&&(Y.top<J.top||Y.bottom>J.bottom||Y.left<J.left||Y.right>J.right)?!0:!1};ne.iqd=function(l){for(var J=0;J<l.length;J++)if(ne.Xzb(l[J]))return!0;return!1};ne.Uwj=function(l,J,Y,za){if(!l.pN){if(!Y||ne.iqd(J))return!0}else if(ne.Lzb(l)&&(1===J.length&&ne.GLg(l,J[0])||!Y))return!0;return za};ne.Vwj=function(l,J,Y,za){if(!l.pN){if(!Y||ne.iqd(J))return!0}else if(ne.RAb(l)&&(1===J.length&&ne.HLg(l,J[0])||!Y))return!0;return l.kla||za};ne.Afi=function(l,
J,Y,za,Ua){var Qb=l.getRange();return ne.Lzb(l)?ne.Xzb(l)||Ua:J.top===Qb.top||!za||Y};ne.xfi=function(l,J,Y,za,Ua){var Qb=l.getRange();return ne.Lzb(l)?J.bottom===Qb.bottom&&Ua:za&&!Y||J.bottom===Qb.bottom};ne.yfi=function(l,J,Y,za,Ua){var Qb=l.getRange();return ne.RAb(l)?ne.Xzb(l)||Ua:J.left===Qb.left||!za||Y};ne.zfi=function(l,J,Y,za,Ua){var Qb=l.getRange();return l.kla?!1:ne.RAb(l)?J.right===Qb.right&&Ua:za&&!Y||J.right===Qb.right};ne.Lzb=function(l){return 0<l.getRange().right-l.getRange().left};
ne.RAb=function(l){return 0<l.getRange().bottom-l.getRange().top};ne.HLg=function(l,J){l=l.getRange();J=J.getRange();return l.top===J.top&&l.bottom===J.bottom};ne.GLg=function(l,J){l=l.getRange();J=J.getRange();return l.left===J.left&&l.right===J.right};Object(Vd.a)(ne,"BorderModelAccessorHelper",null,[]);vf.prototype.gdb=function(l,J,Y,za,Ua,Qb){l&&(l.R7(J,Y,void 0===Ua?!1:Ua,void 0===Qb?!1:Qb),l.verticalAlignment=za)};vf.prototype.AKb=function(l,J,Y){this.ZA||(this.ZA=new ne(this.Ea,this.a3a));
this.ZA.AKb(l,J,Y)};Object(Vd.a)(vf,"FormatCellsActionModelAccessor",null,[766]);of.prototype.isValid=function(){return this.Nl&&this.Eo?!(void 0===this.formatString||null===this.formatString):!1};of.prototype.XRh=function(){return null!=this.eR?this.eR:this.formatString};Ck.Object.defineProperties(of.prototype,{eR:{configurable:!0,enumerable:!0,get:function(){return this.zpg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.Hya)return this.Hya;if(this.dra)return this.dra.formatString;
if(!this.Nl)return null;if(null!=this.eR){var l=this.eR;return 0>l?(Cd.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(l=this.Nl.Kca[l])?this.Hya=l.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.dra?this.dra:this.Eo&&this.formatString?this.dra=this.Eo.createFormat(this.formatString,this.QSg).value:null}},QSg:{configurable:!0,enumerable:!0,get:function(){if(!this.Nl||null==this.eR||0>this.eR)return!1;
var l=this.Nl.Kca[this.eR];return l?l.Builtin:!1}}});Object(Vd.a)(of,"NumberFormatHolder",null,[765]);var Sg=b(259);Object(Vd.a)(kf,"FormatCellInstantaneousResult",null,[]);Object(Vd.a)(Ve,"FormatStringResult",null,[]);var Sh=b(1254),ii=b(568),ui=b(204),eh;(function(l){l.InvalidInput="invalid input";l.UnsupportedZeroResize="resizing to 0 - ignore";l.UnsupportedSkeletonInView="skeleton in view - ignore";l.NullSPD="ActiveSheetProcessedData is null";l.UnsupportedHiddenInRange="hiddens in resizeRanges";
l.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(eh||(eh={}));Object(Vd.b)("InstantaneousRowColumnResizeFailureReason",eh);var Kj=b(327);Tc.prototype.dispose=function(){hh.a.yc([this.SSa,this.w3]);this.$=this.w3=this.SSa=null};Tc.prototype.iBa=function(l,J,Y,za,Ua,Qb,uc,ed,Dd){return this.dBj(l,J,Y,void 0===Ua?!1:Ua,void 0===ed?0:ed,void 0===Qb?"":Qb,void 0===Dd?null:Dd)};Tc.prototype.I8c=function(l,J,Y,za,Ua,Qb){l.cell.fu.DQ|=za;Tc.j1g(Je.g(this.$),l,Y,Ua);this.w3.lastSetCellInstantaneousOperation=
J;Qb&&Je.g(this.$).Ki.o1(J,Jh.BasicTelemetryCalculator.wR)};Tc.prototype.qea=function(l,J,Y,za,Ua,Qb){za=void 0===za?!1:za;Ua=void 0===Ua?null:Ua;var uc=void 0===uc?null:uc;Qb=(void 0===Qb?null:Qb)||l.ha.ta.selectedRanges;if(!(-1690267012===J&&1<Qb.length)){-1690267012===J&&Cd.ULS.shipAssertTag(537162176,0,1===Qb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",Qb.length);var ed=l.naa("FormatCellsAction.ShowInstantaneousFormatting",Qb);try{ed.$$rst();for(var Dd=!1;ed.$$mn();){var hd=
void 0,Ke=ed.$$cu().wF?l.ZJb(ed.$$cu().range):(hd=new P.a,hd.add(ed.$$cu()),hd);hd={};for(var zf=Cl(Ke),Dg=zf.next();!Dg.done;hd={Agb:hd.Agb},Dg=zf.next()){var Tg=Dg.value;if(Je.g(this.$).Gz&&Tg&&uc&&-1690267012===J&&(hd.Agb=Tg.range,hd.Agb&&uc.contains(hd.Agb)&&xh.a.all(Qb,function(Rg){return function(Yh){return!Gf.c(Yh,Rg.Agb)}}(hd))))continue;if(!Tg||ed.Jb.contains(Tg.range))if(this.u4f(J,Tg,Y,za,Ua,ed.$$cu().wF),Dd||(l.Ea.mW(),Dd=!0),Ua)break}}}finally{ed&&ed.dispose()}}};Tc.prototype.LZa=function(l,
J,Y){if(Y=void 0===Y?null:Y)Y.Lwa=!0;Y=!J.text;var za=da.a.pgf(J.text),Ua,Qb=l.wF?Je.g(this.$).ZJb(l.range):(Ua=new P.a,Ua.add(l),Ua);Ua=Cl(Qb);for(Qb=Ua.next();!Qb.done;Qb=Ua.next())this.jLg(this.$,Qb.value,J.text,J.horizontalAlignment,J.fontColor,J.Ck,l.cell.Ck,Y,za,J.valueType,J.M9a);l.cell.KCc()};Tc.prototype.sYi=function(l,J,Y,za,Ua){Ua=void 0===Ua?null:Ua;try{var Qb=Gf.D(J),uc=Gf.D(Y);if(l.Rb.e7a(Qb)||l.Rb.e7a(uc))return 8;if(-185374993!==za&&this.Xni(l,Qb,uc))return 9;if(-185374993!==za&&(l.Rb.W5(uc)||
l.Rb.mAb(Qb)))return 10;if(1804571062!==za&&l.Rb.fla(uc))return 11;if(this.iih(uc))return 12;if(this.Ooi(Qb,uc))return 13;var ed=this.$.Ob.Hc("UserAction","PasteInstantaneous");ed.start();ii.a(ed);Ua&&Zg.b().QA(ed.id,Ua.id,"actions","actions");!Qb.isSingle&&uc.isSingle&&(uc=Tc.expandRange(Qb,uc),l.ha.updateSelection(uc,uc,0));switch(za){case 237279923:case 808159687:if(!this.KYi(Qb,uc))return 14;this.x3c(l,Qb,uc,!0,!1);break;case 1804571062:this.x3c(l,Qb,uc,!0,!1);break;case -185374993:this.x3c(l,
Qb,uc,!1,!0);break;default:return 2}Cd.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Dd){return Cd.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Dd)),15}};Tc.prototype.dZg=function(l,J){l=Cl(l);for(var Y=l.next();!Y.done;Y=l.next())this.f1c(Y.value,!0,J)};Tc.prototype.f1c=function(l,J,Y){Y=void 0===Y?"":Y;if(l){var za=Je.g(this.$);if(J){if(J=za.wk("FormatCellsAction.ClearRangeInstantaneous",
l),l=l.isSingle?null:l,J.$$mn()&&void 0!==J.$$cu()&&null!==J.$$cu())for(za=Object(tg.a)(new Fi.a,{Text:""}),this.iBa(J.$$cu(),za,!1,void 0,og.a.lhc(this.$),Y,void 0,void 0,l);J.$$mn();)void 0!==J.$$cu()&&null!==J.$$cu()&&this.iBa(J.$$cu(),za,!1,void 0,!1,Y)}else this.qea(za,-1228228458,{},void 0,void 0,[l])}else Cd.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};Tc.prototype.V7i=function(l,J){if(!J){J=md.HelperMethods.Zb();var Y=Je.g(this.$),
za=Y.naa("FormatCellsAction.ReformatCells",l);try{za.$$rst();for(var Ua=!1;za.$$mn();){var Qb=za.$$cu().cell;if(0===Qb.oQ||2===Qb.oQ)this.updateSpillInformation(Qb,l),Ua||(Y.Ea.mW(),Ua=!0)}}finally{za&&za.dispose()}Cd.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",md.HelperMethods.Zb()-J)}};Tc.prototype.Vdc=function(l,J){if(this.Fb){if(l.formulaBarText)return!da.a.equals(J.Text,l.formulaBarText,!1);var Y=l.cell.formattedText;
Y=Sg.a(Y,l.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Y,J).isEqual}return!da.a.equals(J.Text,l.text,!1)};Tc.prototype.gFh=function(l){if(void 0===l||null===l||!this.zK&&(l=new of(this.Nl,this.Eo,void 0,l),!l.isValid()))return new Ve(!1,"1234.56");l=this.w3a({value:"1234.56",type:1},l,244,"12px sans-serif");return Object(qg.b)(l)?new Ve(!1,"1234.56"):new Ve(!0,l.value.text)};Tc.prototype.eBj=function(l,J,Y,za){return mc(l,this,J,Y,za,!0)};Tc.prototype.t4f=function(l,
J,Y){if(!this.Vdc(J,Y))return Object(qg.d)("Skip unchanged cell content");J=J.cell;var za=this.zK?J.Ck:new of(this.Nl,this.Eo,J.Ck);Y=this.cWe(Y.Text,za,J.EBa,J.oaa,!0);if(Object(qg.b)(Y))l=Y;else{Y=Y.value;za=Y.text;var Ua=Y.valueType;za=J.hasRichValueIcon?"Unsupported rich value icon":J.sT?We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==Ua&&'normal 11pt "calibri"'===J.oaa&&J.GCe(za)>=J.offsetWidth*Math.floor(J.offsetHeight/ze.a.xsb)?"Unsupported wrapped text with long input":
"Unsupported wrapped text":J.TAb||null!=J.Goa&&0!==J.Goa?"Unsupported rotated text":!0;!0!==za?l=Object(qg.a)(za):(J.isCellWidthFixed?za="Skip fixed width cell":(za=Y.valueType,za=0===za?"Skip empty cell value":2===za?"Skip string cell value":J.pN&&!J.Rni?"Skip merged cell":J.Dyc?"Skip shrunk to fit":Y.isHashesValue?"Skip hashes cell value":!0),!0!==za?l=Object(qg.d)(za):(Y=J.GCe(Y.text),Y>J.offsetWidth?(J=[J.getRange().clone()],l=mc(l,this,J,Y,!1,!1),l=Object(qg.b)(l)?l:Object(qg.d)(Y)):l=Object(qg.d)("Column is wide enough")))}return l};
Tc.prototype.aWe=function(l,J,Y,za,Ua){if(!this.zK&&(J=new of(this.Nl,this.Eo,J),!J.isValid()))return new Ve(!1,l);var Qb={};Qb.value=l;Qb.type=Y;Y=this.w3a(Qb,J,za,Ua);return Object(qg.b)(Y)?new Ve(!1,l):new Ve(!0,Y.value.text)};Tc.prototype.updateSpillInformation=function(l,J){var Y=l.getRange(),za=!1;J=Cl(J);for(var Ua=J.next();!Ua.done;Ua=J.next())if(Y.left===Ua.value.left){za=!0;break}l.oRj(za)};Tc.prototype.dBj=function(l,J,Y,za,Ua,Qb,uc){var ed=void 0;Qb=void 0===Qb?"":Qb;ed=void 0===ed?1:
ed;uc=void 0===uc?null:uc;this.PAb&&this.cqi&&(l.cell.L1d=J);var Dd=new kf;Dd.source=0;Dd.Lwa=!1;l.cell.xpc=l.cell.Ck;var hd=J.Text,Ke=!hd,zf=da.a.pgf(hd);da.a.Tn(hd)&&(Cd.ULS.shipAssertTag(537162142,0,!((void 0===hd||null===hd)&&void 0!==J.TextRuns&&null!==J.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),J=Object(tg.a)(new Fi.a,{Text:""}),hd="");l.cell.userInput=hd;if(!this.Vdc(l,J))return this.yWg(l,Ua,Ke,zf,Dd);Y?this.qWg(l,hd,this.$.workbookContext.DefaultHyperlinkStyle,
Dd):this.kWg(l,J,hd,Ke,zf,za,Dd,uc);this.I8c(l,Qb,Ua,ed,Dd.eic,Dd.Lwa);return Dd};Tc.prototype.yWg=function(l,J,Y,za,Ua){Ua.cgg=!0;Ua.eic=!0;Ua.Lwa=!1;0===J&&Je.g(this.$).Ea.mW();0===l.cell.qza&&(Y?l.cell.R7(0,!1):za&&l.cell.R7(1,!1));return Ua};Tc.prototype.qWg=function(l,J,Y,za){za.Lwa=!0;l.insertHyperlink(J,Ic.a.Pbd(J),Y)};Tc.prototype.kWg=function(l,J,Y,za,Ua,Qb,uc,ed){ed=void 0===ed?null:ed;uc.Lwa=!1;var Dd=l.cell;this.Nl||(this.Nl=this.$.da.Aa(268));this.lNj(this.Nl,Dd.Ck);za||Ua?this.mWg(l,
za,Ua,uc):(za=this.zK?Dd.Ck:new of(this.Nl,this.Eo,Dd.Ck),za=this.cWe(Y,za,Dd.EBa,Dd.oaa,!1),Object(qg.c)(za)?(this.$Rd(J.TextRuns,J.Fonts)&&this.oWg(l,J,za.value),this.LZa(l,za.value,uc)):this.PAb&&this.Hsd?this.uWg(l,J.Text,uc):this.vWg(l,J.Text),J=Object(qg.c)(za)?za.value.text:"",Ua=Object(qg.b)(za)?za.reason:"",Cd.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",l.range.top,
l.range.left,za.success,Ua,Dd.Ck,da.a.xha(Dd.userInput),da.a.xha(J)));Dd.formulaBarText=Y;Qb&&this.PMj(this.Nl,l,Y,ed);uc.eic=!0};Tc.prototype.mWg=function(l,J,Y,za){za.Lwa=!0;l.text="";l.formulaBarText="";l.cell.userInput="";this.f2b(l,null,null,J,Y)};Tc.prototype.oWg=function(l,J,Y){J.Text===Y.text&&2===Y.valueType&&(l.cell.formattedText=J)};Tc.prototype.uWg=function(l,J,Y){Y&&(Y.Lwa=!0);l.text=J;l.formulaBarText=J;this.f2b(l,1)};Tc.prototype.vWg=function(l,J){l.text=J;l.formulaBarText=J;this.f2b(l,
1)};Tc.prototype.f2b=function(l,J,Y,za,Ua,Qb){Y=void 0===Y?null:Y;za=void 0===za?!1:za;Ua=void 0===Ua?!1:Ua;Qb=void 0===Qb?!1:Qb;var uc=l.horizontalAlignment;Y=null!=Y?Y:l.verticalAlignment;0===l.cell.qza&&(null!=J||za||Ua||Qb)&&(za?uc=0:Ua||Qb?uc=1:null!=J&&(uc=J),this.fva.gdb(l,uc,!1,Y,!0))};Tc.prototype.lNj=function(l,J){(null===l||void 0===l?0:l.Kca)&&J>=Tc.mDh&&J>l.Kca.length-1&&(Cd.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",
J),l.UVe())};Tc.prototype.PMj=function(l,J,Y,za){za=void 0===za?null:za;if(void 0!==l&&null!==l)if(this.Nl.pnd)Cd.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Ua=this.$.da.Aa(266);Ua&&(this.w3.pda=Xd.JHe,l&&(this.w3.pda=l.Abf),Ua.gUg(J,Y,Object(ci.a)(this.w3,this.w3.pKf,"processResults"),za))}};Tc.prototype.w3a=function(l,J,Y,za){var Ua=this.$.da.Aa(266);if(!Ua)return Object(qg.a)("calcManager is null");if(!Ua.Eo)return Object(qg.a)("calcManager.NumberFormatter is null");
if(!this.Nl)return Object(qg.a)("instantaneousManager is null");if(this.zK)if("number"===typeof J||"string"===typeof J){var Qb=Ua.jcc(J);if(!Object(qg.c)(Qb))return Qb;var uc=Qb.value}else uc=J;else{if(!J||!J.isValid())return Object(qg.a)("numberFormatHolder is invalid or null");uc=Ua.sgd(J);if(null==uc)return Object(qg.a)("cellFormat is null")}Qb=Ua.Eo;var ed=rd(l);if(void 0===ed||null===ed)return Object(qg.a)("cellValue is null");Ua=excelOnlineCalc.calc.cellValueToReadOper(Ua.config.mathpack,ed);
if(void 0===Ua||null===Ua)return Object(qg.a)("readOper is null");Ua=Qb.applyFormat(uc,Ua,We.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Ua)?this.w3.kbd(Qb,Ua.value,l.type,Y,za,"number"===typeof J?J:-1,!1):Object(qg.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Ua.reason.kind))};Tc.prototype.cWe=function(l,J,Y,za,Ua){var Qb=this.$.da.Aa(266);if(void 0===Qb||null===Qb)return Object(qg.a)("calcManager is null");if(void 0===
Qb.Eo||null===Qb.Eo)return Object(qg.a)("calcManager.NumberFormatter is null");if(void 0===this.Nl||null===this.Nl)return Object(qg.a)("instantaneousManager is null");if(this.PAb)return Object(qg.a)("No main thread number formatter");if("number"===typeof J||"string"===typeof J){var uc=Qb.jcc(J);if(!Object(qg.c)(uc))return uc;var ed=uc.value}else{if(void 0===J||null===J||!J.isValid())return Object(qg.a)("numberFormatHolder is invalid or null");uc=Qb.sgd(J);if(void 0===uc||null===uc)return Object(qg.a)("cellFormat is null")}uc=
Qb.Eo;l=uc.parseEdit(l,ed);if(!excelOnlineCalc.util.isSuccess(l))return Object(qg.a)("ParseEdit failure: reason="+l.reason.kind+", features="+l.reason.features);if(l.value.kind===ai.a.formula)return Object(qg.a)("Main thread - skipping formula edit");Qb=excelOnlineCalc.numfmt.applyValueEdit(uc,Qb.localeInfo,ed,l.value);if(!excelOnlineCalc.util.isSuccess(Qb))return Object(qg.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Qb.reason.kind));l=l.value;Cd.ULS.shipAssertTag(537162190,0,l.kind!==ai.a.formula,
"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");l=excelOnlineCalc.numfmt.getValueEditOperKind(l);ed=0;switch(l){case 0:case 128:ed=0;break;case 1:ed=1;break;case 2:ed=2;break;case 4:ed=3;break;case 8:ed=4;break;case 16:case 32:case 64:case 256:Cd.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",l);break;default:Cd.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",
l)}return this.w3.kbd(uc,Qb.value,ed,Y,za,"number"===typeof J?J:-1,Ua)};Tc.prototype.Xni=function(l,J,Y){if(J.width<Y.width)for(var za=l.wk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new sg.Range(J.top,J.left,J.bottom,J.left,!0,!0));za.$$mn();){var Ua=za.$$cu();if(Ua&&Ua.uLa())return Cd.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}if(J.height<Y.height)for(l=l.wk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new sg.Range(J.top,
J.left,J.top,J.right,!0,!0));l.$$mn();)if((J=l.$$cu())&&J.yLa())return Cd.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};Tc.prototype.x3c=function(l,J,Y,za,Ua){for(var Qb=J.iT().FirstRow,uc=J.iT().LastRow,ed=Y.iT().LastRow,Dd=Qb,hd=Y.iT().FirstRow;hd<=ed;hd++,Dd++){Dd>uc&&(Dd=Qb);var Ke=J.iT();Ke.FirstRow=Ke.LastRow=Dd;var zf=Y.iT();zf.FirstRow=zf.LastRow=hd;this.g4g(l,Ui.a.fR(Ke),Ui.a.fR(zf),za,Ua)}};Tc.prototype.KYi=function(l,
J){var Y=this.$.da.Aa(266);return void 0!==Y&&null!==Y?(Y.aUg(l,J.topLeft,Object(ci.a)(this.w3,this.w3.pKf,"processResults")),!0):!1};Tc.prototype.Ooi=function(l,J){var Y=l.right-l.left+1;l=l.bottom-l.top+1;var za=J.right-J.left+1;J=J.bottom-J.top+1;if(za>Y&&J>l){if(!(za%Y&&J%l))return!0}else if(za===Y&&J>l){if(!(J%l))return!0}else if(za>Y&&J===l&&!(za%Y))return!0;return!1};Tc.prototype.iih=function(l){if(We.EwaSettings.ma(103)){l=Je.g(this.$).N1(l).gridView.getRangeInformation(l);l=Cl(l);for(var J=
l.next();!J.done;J=l.next())if(J=J.value,Object(ag.a)(Qi.DynamicArrayRange,J)&&!Object(S.a)(Qi.DynamicArrayRange,J).umc)return!0}return!1};Tc.prototype.yDe=function(l,J,Y,za,Ua,Qb){J=Cl(J);for(var uc=J.next();!uc.done;uc=J.next())uc=uc.value,Y&&(this.k4g(uc,Ua),uc.setCell(!0)),za&&(Qb=this.M4h(Ua,uc)),Qb||(l.Ea.mW(),Qb=!0);return Qb};Tc.prototype.QQh=function(l,J,Y){J=new sg.Range(J,Y,J,Y,!0,!0);return l.mc(J)};Tc.prototype.g4g=function(l,J,Y,za,Ua){if(Y){this.SSa&&Y.equals(this.SSa.range)||(hh.a.Ha(this.SSa),
this.SSa=l.wk("FormatCellsAction.CopyBetweenRows",Y));Y=this.SSa;Y.$$rst();var Qb=!1;if(We.EwaSettings.getBooleanFeatureGate(Kj.a.pGe,!1)){var uc=J.iT().FirstColumn+1,ed=J.iT().LastColumn+1;J=J.iT().FirstRow+1;for(var Dd=uc;Y.$$mn();){Dd>ed&&(Dd=uc);var hd=this.QQh(l,J,Dd);Dd+=1;var Ke=void 0,zf=Y.$$cu().wF?l.ZJb(Y.$$cu().range):(Ke=new P.a,Ke.add(Y.$$cu()),Ke);hd&&(Qb=this.yDe(l,zf,za,Ua,hd,Qb));Ha.lastOrDefault(zf)}}else for(uc=l.wk("FormatCellsAction.CopyBetweenRows2",J);Y.$$mn();)uc.$$mn()||(uc.$$rst(),
uc.$$mn()),ed=uc.$$cu(),J=void 0,Dd=Y.$$cu().wF?l.ZJb(Y.$$cu().range):(J=new P.a,J.add(Y.$$cu()),J),ed&&(Qb=this.yDe(l,Dd,za,Ua,ed,Qb)),Ha.lastOrDefault(Dd)}else Cd.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};Tc.prototype.N4f=function(){var l=wg.a.gd(1,0,0,647,0,104573951,"PivotTableContextMenuOperationFailure");Bj.a(this.$).ui(l)};Tc.prototype.qzi=function(l,J){var Y={ValidMembers:32},za=J.NumberFormat;switch(l){case 1890566896:if(1001===za||1002===
za||1003===za){Y.NumberFormat=14;Y.NumberFormatOptions={};switch(za){case 1001:Y.NumberFormatOptions.TimeType=2;break;case 1002:Y.NumberFormatOptions.DateType=7;break;case 1003:Y.NumberFormatOptions.DecimalPlaces=0}Y.NumberFormatOptions.NumberFormatCategory=this.ZKg(za)}else Y.NumberFormat=za;break;case 1886928607:Y.NumberFormat=13;break;case -992833457:Y.NumberFormat=11;break;case 218524921:Y.NumberFormat=12;break;case 996232352:Y.NumberFormat=14;Y.NumberFormatOptions=Object(tg.a)(new If.a,{DecimalPlaces:0});
Y.NumberFormatOptions.NumberFormatCategory=6;break;default:return J}return Y};Tc.prototype.formatCells=function(l,J,Y,za,Ua,Qb,uc){za=void 0===za?null:za;Ua=void 0===Ua?null:Ua;Qb=void 0===Qb?null:Qb;uc=void 0===uc?null:uc;var ed=this.$.Ob.Hc("UserAction","FormatCellsInstantaneous, command = "+Zg.b().ti(l)),Dd=this.$.Ob.$g("UserAction","FormatCellsInstantaneousFrame");Dd.start();ii.a(Dd);var hd=Zg.b().ti(l),Ke=this.$,zf=Je.g(Ke),Dg=zf.ha.ta,Tg=Ua||Dg.selectedRanges,Rg=Vf.g(Tg,function(zj){return zj.mQ});
hd=String.format("{0}, cellCount={1}",hd,Rg);Je.g(this.$).Ki.e8(1,ed.id,hd);Tg=Gf.r(Tg,this.$);Dg=Dg.activeCell;hd=-168056295===Y.command;var Yh=Rg=null;if(hd){Yh=zf.Rb.lp(Dg);if(!Yh){this.N4f();return}Rg=Yh.fda.substring(1,Yh.fda.length-1);Yh=Yh.lbc();if(!Yh){this.N4f();return}Yh=Yh.Caption}zf.rg.iH(!1,!0);var Li=Gf.o(Dg,Ke),Mh=Ke.na.va.hc({Lla:!0,Lka:1}),Uj=this.qzi(Y.command,J);hd||this.qea(zf,l,J,!1,za,Ua);ed.stop();Je.g(this.$).Ki.o1(ed.id,Jh.BasicTelemetryCalculator.wR);Y.zdi=Pf.a.Ta.Wb;za=
this.$.Ob.Hc("UserAction","FormatCellsUserAction");this.Gvi(l,Y.taskId,J,Tg,Dg,za.id);Zg.b().QA(ed.id,za.id,"actions","actions");Zg.b().QA(Dd.id,za.id,"actions","actions");We.EwaSettings.qc()?Ke.userOperationManager.ic(new ie(this,Tg,Li,Uj,hd,Rg,Yh,Mh,za,ed.id,64,Qb,uc),Y):Ke.userOperationManager.ic(new ie(this,Tg,Li,Uj,hd,Rg,Yh,Mh,za,ed.id,0,Qb,uc),Y)};Tc.prototype.u3=function(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd,Ke){var zf=this,Dg=this.$;return function(Tg,Rg,Yh){Dg.Oy();Tg=[Tg,zf.yLi];Rg=[Rg];hd&&Tg.push(hd);
Ke&&Rg.push(Ke);return Td.q(Dg.na.va,l,J,Y,za,Ua,Qb,!1,lf.b.apply(null,Tg),lf.a.apply(null,Rg),Yh,Dd,uc,ed)}};Tc.prototype.u4f=function(l,J,Y,za,Ua,Qb,uc){uc=void 0===uc?null:uc;if(J&&Y){var ed=Y.Font,Dd=Y.HorizontalAlignment,hd=Y.VerticalAlignment;Y.ValidMembers&2||(Dd=J.horizontalAlignment);Y.ValidMembers&1||(hd=J.verticalAlignment);var Ke=0!==Dd;Tc.Ffi(l)&&0===Dd&&(Dd=this.c0e(J));var zf=!1;switch(l){case -394785302:this.fva.gdb(J,Dd,Ke,0);break;case 1041132226:this.fva.gdb(J,Dd,Ke,1);break;case -571165336:this.fva.gdb(J,
Dd,Ke,2);break;case -1150205178:case -1142465846:case -286432209:this.fva.gdb(J,Dd,Ke,hd,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.U7a&&this.Npj(J,Y);break;case 1650812936:this.setFillColor(J,Y,Qb);break;case -287251124:J.bold=ed.Bold;break;case -1690267012:Je.g(this.$).ha.ta.Lg&&(ed=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?uc?uc:Je.g(this.$).ha.ta.ud:Je.g(this.$).ha.ta.ud,
this.fva.AKb(J,Y,ed));break;case 1970784898:Y=Gd.a.iq(J.color,J.backgroundColor);if(Eh.a.compare(Y,Eh.a.red)&&(da.a.S5(J.text)||da.a.T7e(J.text)))break;ed=Eh.a.wH(ed.FontColor);J.color=ui.c(Gd.a.sG(ed));break;case -1925065947:J.italic=ed.Italic;break;case -1293291468:Y=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.Pm?(J.SKb(ed.FontName,Y,"ShowInstantaneousFormattingOnCell"),J.o_f(ed.FontScheme)):J.SKb(ed.FontName,Y,"ShowInstantaneousFormattingOnCell");break;
case 862890474:case 963349338:J.fontSize=ed.FontSize;this.$.Bf();break;case -1077965542:J.fontSize=ed.FontSize;break;case 1764140053:J.underline=ed.Underline;break;case -1685033574:J.doubleUnderline=ed.DoubleUnderline;break;case -1590502662:J.fontStrikethrough=ed.Strikethrough;break;case -848953656:case 2045211913:zf=J.Dqb();break;case 2105621672:ed=Object(S.a)(Sh.a,Ua);if(!ed)break;Y=Eh.a.fGh(ed.color);J.color=ui.c(Gd.a.sG(Y));this.xse(J,ed.Hya);break;case -1409276245:this.xse(J,Y.NumberFormatOptions.CustomFormatString);
break;case 1890566896:this.iLg(J,Y);break;case -1228228458:J.Dqb();J.clearFormat();this.pXc(J,0);zf=!0;break;case -730106152:J.clearFormat();this.pXc(J,0);break;case 932244020:this.Mpj(J,Y,Qb);break;case -1942512156:case -1920201820:this.Drj(J,Y)}za||(zf?J.UHb(!0):J.setCell(!0))}else Cd.ULS.shipAssertTag(537162135,0,!J,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),Cd.ULS.shipAssertTag(537162134,0,!Y,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};
Tc.prototype.k4g=function(l,J){l&&J?(l.Lqb(J),l.y1c(J),this.pXc(l,J.cell.Ck)):Cd.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};Tc.prototype.pXc=function(l,J){if(0>J)this.$_({caller:"ApplyNumberFormatIndexOnCell",cell:l,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{if(!this.zK&&(J=new of(this.Nl,this.Eo,J),!J.isValid())){this.$_({caller:"ApplyNumberFormatIndexOnCell",cell:l,
kind:"failure",reason:"ApplyNumberFormatIndexOnCell: invalid number format holder"});return}var Y=this.w3a(l.Ju,J,l.cell.EBa,l.cell.oaa);Object(qg.b)(Y)?this.$_({caller:"ApplyNumberFormatIndexOnCell",cell:l,kind:"failure",reason:Y.reason}):(this.LZa(l,Y.value),this.zK?this.$_({caller:"ApplyNumberFormatIndexOnCell",cell:l,kind:"success",Bz:Y.value,format:J}):this.pCb("ApplyNumberFormatIndexOnCell",l,!0,void 0,Y.value,J))}};Tc.prototype.xse=function(l,J){if(void 0===J||null===J)this.$_({caller:"ApplyNumberFormatStringOnCell",
cell:l,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{if(!this.zK&&(J=new of(this.Nl,this.Eo,void 0,J),!J.isValid())){this.$_({caller:"ApplyNumberFormatStringOnCell",cell:l,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: invalid number format holder"});return}var Y=this.w3a(l.Ju,J,l.cell.EBa,l.cell.oaa);Object(qg.b)(Y)?this.$_({caller:"ApplyNumberFormatStringOnCell",cell:l,kind:"failure",reason:Y.reason}):(this.LZa(l,Y.value),this.zK?this.$_({caller:"ApplyNumberFormatStringOnCell",
cell:l,kind:"success",Bz:Y.value,format:J}):this.pCb("ApplyNumberFormatStringOnCell",l,!0,void 0,Y.value,J))}};Tc.prototype.iLg=function(l,J){if(J=void 0===J?null:J)if(J=this.TXh(l,J),J.success){var Y=this.w3a(l.Ju,J.TOa,l.cell.EBa,l.cell.oaa);Object(qg.b)(Y)?this.zK?this.$_({caller:"ApplyNumberFormatCategoryOnCell",cell:l,kind:"failure",reason:Y.reason,format:J.TOa}):this.pCb("ApplyNumberFormatCategoryOnCell",l,!1,Y.reason,void 0,J.TOa):(this.LZa(l,Y.value),this.zK?this.$_({caller:"ApplyNumberFormatCategoryOnCell",
cell:l,kind:"success",Bz:Y.value,format:J.TOa}):this.pCb("ApplyNumberFormatCategoryOnCell",l,!0,void 0,Y.value,J.TOa))}else this.zK?this.$_({caller:"ApplyNumberFormatCategoryOnCell",cell:l,kind:"failure",reason:J.reason,format:J.TOa}):this.pCb("ApplyNumberFormatCategoryOnCell",l,!1,J.reason,void 0,J.TOa);else this.$_({caller:"ApplyNumberFormatCategoryOnCell",cell:l,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})};Tc.prototype.ZKg=function(l){switch(l){case 1004:return 1;
case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<l?-1:l};Tc.prototype.TXh=function(l,J){if(!this.Nl||!this.localeInfo||!J)return l=this.Nl?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Ad(!1,void 0,"GetRibbonNumberFormat: "+l);J=J.NumberFormat;switch(J){case 0:l=Re.EGh;break;case 1:l=Re.GGh;break;case 2:l=Re.CGh;break;case 3:l=Re.AGh;break;case 4:l=Re.JGh;
break;case 5:l=Re.FGh;break;case 6:l=Re.LGh;break;case 7:l=Re.HGh;break;case 8:l=Re.DGh;break;case 9:l=Re.IGh;break;case 10:l=Re.KGh;break;case 11:case 12:return this.Nl.UVe(),this.gOh(l,J);case 13:l=Re.YSg;break;case 1006:l=Re.buttonPercentage;break;case 1004:l=Re.keyboardNumber;break;case 1005:l=Re.keyboardCurrency;break;case 1002:l=Re.keyboardDate;break;case 1001:l=Re.keyboardTime;break;case 1003:l=Re.keyboardPercentage;break;case 14:return l="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",
Cd.ULS.shipAssertTag(537162132,0,!1,l),new Ad(!1,void 0,l);default:return l="GetRibbonNumberFormat: unknown NumberFormatType!",Cd.ULS.shipAssertTag(537162131,0,!1,l),new Ad(!1,void 0,l)}if(!l)return new Ad(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");l=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,l);if(!l)return new Ad(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");if(this.zK)return new Ad(!0,
l);l=new of(this.Nl,this.Eo,void 0,l);return new Ad(!0,l)};Tc.prototype.gOh=function(l,J){if(!this.calcManager||!this.Eo)return J=this.calcManager?"numberFormatter is null":"calcManager is null",new Ad(!1,void 0,"GetDecimalChangeNumberFormat: "+J);l=l.cell.Ck;if(this.zK){l=this.calcManager.jcc(l);if(!Object(qg.c)(l))return new Ad(!1,void 0,"getDecimalChangeNumberFormat: "+l.reason);l=l.value}else if(l=this.calcManager.sgd(new of(this.Nl,this.Eo,l)),!l)return new Ad(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");
J=this.Eo.changeFormatDecimals(l,11===J?1:-1);if(!excelOnlineCalc.util.isSuccess(J))return new Ad(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");if(void 0===J.value||null===J.value)return new Ad(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");if(this.zK)return new Ad(!0,J.value);J=new of(this.Nl,this.Eo,void 0,void 0,J.value);return new Ad(!0,J)};Tc.prototype.$_=function(l){var J=l.caller,Y=l.cell,za=l.format;za=null==za?"null":"number"===
typeof za?za:"string"===typeof za?da.a.xha(za):da.a.xha(za.formatString);var Ua=da.a.xha(Y.Ju.value)||"null",Qb="success"===l.kind?da.a.xha(l.Bz.text):"null";Cd.ULS.sendTraceTag(537162130,0,50,"FormatCellsAction.LogNumberFormatEdit: {0}",{caller:J,"range.top":Y.range.top,"range.left":Y.range.left,result:l.kind,reason:"success"===l.kind?"":l.reason,value:Ua,valueType:Y.Ju.type,ifmt:za,prediction:Qb})};Tc.prototype.pCb=function(l,J,Y,za,Ua,Qb){za=void 0===za?"":za;Ua=void 0===Ua?null:Ua;Qb=(Qb=void 0===
Qb?null:Qb)?Qb.eR?Qb.eR.toString():da.a.xha(Qb.formatString):"null";var uc=da.a.xha(J.Ju.value)||"null";Ua=Ua?da.a.xha(Ua.text)||"null":"null";l=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",l,J.range.top,J.range.left,Y,za,uc,J.Ju.type,Qb,Ua);Cd.ULS.sendTraceTag(523297929,0,50,l)};Tc.prototype.jLg=function(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd,Ke){ed=void 0===ed?!1:ed;
Dd=void 0===Dd?!1:Dd;var zf=J.cell;zf.oQ=void 0===hd?0:hd;hd=J.text;hd!==Y&&(zf.text=Y);zf.M9a=void 0===Ke?null:Ke;Hi.e(hd)?J.formulaBarText=hd:J.formulaBarText="";l=Je.g(l).Rb.Zgf(J.range);this.f2b(J,za,null,ed,Dd,l);Ua&&(J.color=ui.c(Gd.a.sG(Ua)));J.cell.Ck=Qb;J.cell.xpc=uc;J.cell.tUd=Qb};Tc.prototype.Gvi=function(l,J,Y,za,Ua,Qb){var uc={};uc.a=this.$.ya.UserSessionId;uc.b=J;uc.c=za.Ranges.length;uc.d=this.i8g(za.Ranges);uc.e=Ua.toString();uc.f=l;uc.h=Qb;1890566896===l?uc.g=Y.NumberFormat.toString():
2105621672===l&&(uc.g=Y.NumberFormatOptions.NumberFormatCategory.toString());Zg.b().Pe(3,uc,!0)};Tc.prototype.i8g=function(l){for(var J=0,Y=0,za=0,Ua=0;Ua<l.length;Ua++){var Qb=Gf.B(l[Ua]).mQ;J+=Qb;Qb>za&&(za=Qb,Y=Ua)}l=Gf.B(l[Y]).toString();return"TotalCellCount:"+J+"; Max range:"+l+"; MaxRangeSize:"+za+";"};Tc.prototype.Mpj=function(l,J,Y){64===(J.ValidMembers&64)&&this.setFillColor(l,J,Y);16===(J.ValidMembers&16)&&Tc.jrj(l,J);128===(J.ValidMembers&128)&&this.fva.AKb(l,J,l.range);if(2===(J.ValidMembers&
2)||1===(J.ValidMembers&1)){Y=J.VerticalAlignment;J=J.HorizontalAlignment;var za=0!==J;We.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!za&&this.c0e(l);this.fva.gdb(l,J,za,Y)}};Tc.prototype.setFillColor=function(l,J,Y){(We.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?l.vba:l.vba&&l.Tdc&&!l.nxb&&!l.Ydc)||(J=-1===J.FillColor?Y?Gd.a.sG(Eh.a.white):null:Gd.a.sG(Eh.a.wH(J.FillColor)),l.backgroundColor=J?ui.c(J):
null)};Tc.prototype.Drj=function(l,J){0!==l.horizontalAlignment&&2!==l.horizontalAlignment||l.R7(1,!1);0<=l.indentation+J.IndentationIncrease&&(l.indentation+=J.IndentationIncrease)};Tc.prototype.Npj=function(l,J){var Y=l.Goa,za=J.TextOrientation;za!==ze.a.verticalText&&(0>za||180<za)&&Cd.ULS.shipAssertTag(523090050,0,!1,"FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server {0}",za);Y===za||Y===ze.a.Kuc&&za===ze.a.Luc||Y===ze.a.Muc&&za===ze.a.Nuc?J.TextOrientation=
0:l.Goa=J.TextOrientation};Tc.prototype.c0e=function(l){if(this.zK)var J=l.cell.Ck;else if(J=new of(this.Nl,this.Eo,l.cell.Ck),!J.isValid())return 0;l=this.w3a(l.Ju,J,l.cell.EBa,l.cell.oaa);return Object(qg.b)(l)?0:null!=l.value.horizontalAlignment?l.value.horizontalAlignment:0};Tc.prototype.Psj=function(l,J,Y){this.ZA||(this.ZA=new ne(Je.g(this.$).Ea,this.$));this.ZA.AKb(l,J,Y)};Tc.prototype.M4h=function(l,J){var Y=new Fi.a;if(l.cell.formulaBarText&&l.cell.formulaBarText.startsWith("'"))Y.Text=l.cell.formulaBarText;
else{var za=l.cellValue;za&&4!==l.cell.oQ||(za=l.text);Y.Text=za}this.iBa(J,Y,!1,void 0,og.a.lhc(this.$));return!0};Tc.prototype.$Rd=function(l,J){return this.Fb&&!!l&&!!J};Tc.j1g=function(l,J,Y,za){za&&J.setCell(!0);0===Y&&l.Ea.mW()};Tc.expandRange=function(l,J){J=J.clone();J.height<l.height&&(J.bottom=J.top+l.height-1);J.width<l.width&&(J.right=J.left+l.width-1);return J};Tc.Ffi=function(l){switch(l){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}};Tc.jrj=function(l,J){J=J.Font;var Y=0!==(J.ValidMembers&16),za=0!==(J.ValidMembers&16),Ua=0!==(J.ValidMembers&16);l.bold=0!==(J.ValidMembers&4);l.italic=0!==(J.ValidMembers&8);Y&&(l.underline=Y);za&&(l.doubleUnderline=za);Ua&&(l.fontStrikethrough=Ua);Y=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");l.SKb(J.FontName,Y,"SetFont");l.fontSize=J.FontSize;Y=Gd.a.iq(l.color,l.backgroundColor);Eh.a.compare(Y,Eh.a.red)&&(da.a.S5(l.text)||da.a.T7e(l.text))||
(J=Eh.a.wH(J.FontColor),l.color=ui.c(Gd.a.sG(J)))};Ck.Object.defineProperties(Tc.prototype,{fva:{configurable:!0,enumerable:!0,get:function(){return this.aFh}},Eo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.Eo}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});Tc.mDh=36;Object(Vd.a)(Tc,"FormatCellsAction",null,[748,
2]);var ck=Og.a;Am(Pd,ck);Pd.prototype.create=function(){this.Eb(new Tc(this.$))};Pd.ka=function(l){l.da.Ga(18,new Pd(l))};Object(Vd.a)(Pd,"FormatCellsActionFactory",Og.a,[]);Object(Vd.a)(vb,"FormulaAssistanceUIContext",null,[]);var dk=Og.a;Am(qc,dk);qc.prototype.create=function(){var l=this,J=this.$.da.Aa(448);if(J)this.Eb(J);else{var Y=Hf.GetServiceTaskFactory.Ua(this.$.da,283,284,this.ub);Pg.TaskExtensions.Ba(Y,function(){Pg.TaskExtensions.Ba(zh.c(Y.result.Jn.loadScript(l.Jlj)),function(){J=l.$.da.Aa(448);
if(!J){var za=Object(tg.a)(new vb,{isFeedbackAllowed:l.$.isFeedbackEnabled});J=l.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(za));l.$.Zye(function(){var Ua={};Ua.isFeedbackAllowed=l.$.isFeedbackEnabled;J.updateContext(Ua)})}l.Eb(J)},l.$.la,3)},this.$.la,3)}};qc.ka=function(l){l.da.Ga(449,new qc(l))};Object(Vd.a)(qc,"FormulaAssistanceUIControlFactory",Og.a,[]);var Ij=b(740);Object(Vd.a)(fd,"FreezePanesCommandParameters",null,[]);var Gj=b(185),bi=b(411),Hk=b(281),yk=b(305),
ej=b(115);sd.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(Vd.a)(sd,"MacroRecorderSheetPaneFrozenPayload",null,[447]);Sc.prototype.$c=function(l,J){var Y=!1;switch(J){case 1844679312:Y=1!==l&&!this.gridView.rb.o5}return Y};Sc.prototype.executeCommand=function(l,J){l=this.gridView.rb;var Y=this.gridView.yid();Fg.AFrameworkApplication.sa.Pa.Lz&&this.$.jla&&(1844679312===J.command||340334732===J.command||-806625837===J.command)&&Ij.ShyRibbon.pQ(1,2);switch(J.command){case 1844679312:return this.setFreezePanes(J,
Y,l.dj);case 340334732:return l.y$b?ig.Task.Ra(!1):this.mrj(J,Y);case -806625837:return l.QTa?ig.Task.Ra(!1):this.nrj(J,Y)}return ig.Task.Ra(!1)};Sc.prototype.Kc=function(l,J){l=!1;switch(J.command){case 1844679312:case 340334732:case -806625837:case 1745254833:l=!0}return l};Sc.prototype.jd=function(){return!1};Sc.prototype.setFreezePanes=function(l,J,Y){if(Y)return this.Svc(l,!1,0,0,0,0,J,null);var za=this.gridView.ha.ta;Y=za.activeCell.clone();za=za.activeRange;za.ff&&(Cd.ULS.sendTraceTag(537159585,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",Y.top,Y.bottom,J.top),Y.top=Y.bottom=J.top);za.isRow&&(Cd.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",Y.left,Y.right,J.left),Y.left=Y.right=J.left);Y.top===J.top&&Y.left===
J.left&&(Y=sg.Range.hd(Y.top+1,Y.left));za=Y.top-1;var Ua=Y.left-1,Qb=za-(J.top-1),uc=Ua-(J.left-1);return this.$Vj(Y,Qb,uc)?this.Svc(l,!0,za,Ua,Qb,uc,J,Y):(this.$.Bf(),this.TFf(),ig.Task.Ra(!0))};Sc.prototype.mrj=function(l,J){return this.Svc(l,!0,0,J.left,0,1,J,null)};Sc.prototype.nrj=function(l,J){return this.Svc(l,!0,J.top,0,1,0,J,null)};Sc.prototype.$Vj=function(l,J,Y){var za=this.gridView.qg(l),Ua=this.gridView.view.visibleArea;return!za||Ua.topLeft.y>za.bottomRight.y||Ua.topLeft.x>za.bottomRight.x||
Ua.bottomRight.y<za.bottomRight.y||Ua.bottomRight.x<za.bottomRight.x?(Cd.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",l,za?za.toString():"null",Ua.toString()),l=wg.a.gd(1,0,26,1456,0,2105967339,"FreezePaneSelectionNotInViewErr"),We.EwaSettings.Kz()?new $g.a(this.$,l):(l=new be.ErrorDialog(this.$,l),l.initialize(),l.kf()),!1):0>=J&&0>=Y?(Cd.ULS.sendTraceTag(537159582,
0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),l=Je.g(this.$).rtl?1458:1457,J=Je.g(this.$).rtl?-2131054257:-1953454131,l=wg.a.gd(1,0,26,l,0,J,"FreezePaneA1SelectedErr"),We.EwaSettings.Kz()?new $g.a(this.$,l):(l=new be.ErrorDialog(this.$,l),l.initialize(),l.kf()),!1):!0};Sc.prototype.Svc=function(l,J,Y,za,Ua,Qb,uc,ed){function Dd(){return new sd(Ke)}var hd=this;this.KGd=Bj.a(this.$).k$(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.XP(this.syf);
this.JF.pBa();this.gridView.FFj(J?"":"UnsetFreezePane");this.Htj(l,J,this.gridView.rb);var Ke=Object(tg.a)(new fd,{SheetName:this.$.qa.name,Freeze:J,FrozenRows:Ua,FrozenColumns:Qb,FirstRow:Y,FirstColumn:za});Cd.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",J,Ua,Qb,Y,za);this.dac=Pf.a.Ta.oe;return af.a(this.$.userOperationManager,function(zf,Dg,Tg){if(We.EwaSettings.ma(61)){var Rg=window.performance;
Rg.clearMarks();Rg.mark("FreezePanes request sent")}Rg=hd.gridView.Ps;hd.$.ma(699)&&Rg?(Rg=hd.Mmh(Ke,Rg,uc,ed),hd.RMj(Rg)):hd.$.Oy();Rg=hd.$.na.va;var Yh=Rg.Na(9,null);Yh.freezeSettings=Ke;return Td.i(Rg,"FreezeOrUnfreezePanes",Yh,zf,Dg,Tg,J,0)},function(zf){return new Wg.a(151,0,zf,void 0,Dd)},l)};Sc.prototype.Mmh=function(l,J,Y,za){Cd.ULS.shipAssertTag(537159580,1,!!J,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!l.Freeze)return null;var Ua=
yk.a();Ua.State=1;Ua.IsEstimated=!0;var Qb=!1,uc=!1,ed=J.TV(sg.Range.hd(Y.top,Y.left)),Dd=l.FrozenRows,hd=l.FrozenColumns;1!==l.FrozenRows||l.FrozenColumns?l.FrozenRows||1!==l.FrozenColumns?(hd=J.TV(sg.Range.hd(l.FirstRow+1,l.FirstColumn+1)),J=J.TV(sg.Range.hd(Y.top,Y.left)),Ua.Width=hd.jm-ed.jm,Ua.Height=hd.Xm-ed.Xm,0<l.FrozenRows&&(Ua.AbsoluteTop=hd.Xm,uc=!0),0<l.FrozenColumns&&(Ua.AbsoluteLeft=hd.jm,Qb=!0),Dd=hd.vL-J.vL,hd=hd.PJ-J.PJ):(Ua.Width=J.Zgd(Gj.a.hd(Y.top,Y.left)),za=sg.Range.hd(Y.top,
Y.left+1),Ua.AbsoluteLeft=ed.jm+Ua.Width,Qb=!0):(Ua.Height=J.Ygd(Gj.a.hd(Y.top,Y.left)),za=sg.Range.hd(Y.top+1,Y.left),Ua.AbsoluteTop=ed.Xm+Ua.Height,uc=!0);uc&&(Ua.FirstFrozenRow=Y.top,Ua.FirstScrollableRow=za.top);Qb&&(Ua.FirstFrozenColumn=Y.left,Ua.FirstScrollableColumn=za.left);Ua.VisibleRows=Dd;Ua.VisibleColumns=hd;return Ua};Sc.prototype.RMj=function(l){var J=this;ig.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){J.$.qa&&J.$.ea&&(J.$.ea.bY(ze.a.Re,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
bi.b(J.$.qa,l,-1,void 0,!0))})};Sc.prototype.Htj=function(l,J,Y){if(!We.EwaSettings.ma(670))switch(l.command){case 1844679312:if(J||-1===this.nLa&&-1===this.oLa)this.nLa=Y.Fx-Y.width+this.gridView.scrollLeft,this.oLa=Y.Gx-Y.height+this.gridView.scrollTop;break;case 340334732:if(J||-1===this.nLa)this.nLa=Y.Fx-Y.width+this.gridView.scrollLeft;break;case -806625837:if(J||-1===this.oLa)this.oLa=Y.Gx-Y.height+this.gridView.scrollTop}};Sc.prototype.juc=function(){var l=this.gridView.rb;0<l.width?this.gridView.scrollLeft=
ej.a.j1b(this.gridView.domElement,Je.g(this.$).rtl,0):-1!==this.nLa&&(this.gridView.scrollLeft=this.nLa,this.nLa=-1);0<l.height?this.gridView.scrollTop=0:-1!==this.oLa&&(this.gridView.scrollTop=this.oLa,this.oLa=-1)};Sc.prototype.TFf=function(){this.JF.kTa();hh.a.Ha(this.KGd);this.KGd=null;this.gridView.mL(this.syf)};Object(Vd.a)(Sc,"FreezePanesCommandHandler",null,[424]);var Gi=Sf.a;Am(Zb,Gi);Zb.prototype.Nd=function(){var l=this;Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(this.$.da,12,477,
this.ub),function(J){l.Dd([new Sc(l.$,J.result)])},this.$.la)};Zb.ka=function(l){l.da.Ga(116,new Zb(l))};Object(Vd.a)(Zb,"FreezePanesCommandHandlerFactory",Sf.a,[]);var Nj=b(1016),Ek=Og.a;Am(oc,Ek);oc.prototype.create=function(){var l=this,J=Hf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),Y=Hf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([J,Y],this.la),function(){l.Eb(l.$.da.Aa(296)||l.$.da.Ga(296,new Nj.BorderFormatManager(l.$,
J.result,Y.result)))},this.la,3)};oc.ka=function(l){We.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&l.da.Ga(468,new oc(l))};Object(Vd.a)(oc,"BorderFormatManagerFactory",Og.a,[]);var sh=b(1031),Jj=b(24),Lk=b(96),Wi=b(257),Oj=b(372),hk=b(368),nj=b(100),Ik;(function(l){l[l.insert=1]="insert";l[l.delete=2]="delete";l[l.rows=4]="rows";l[l.columns=8]="columns";l[l.cellsShiftHorizontal=16]="cellsShiftHorizontal";l[l.cellsShiftVertical=32]="cellsShiftVertical";l[l.insertRows=
5]="insertRows";l[l.insertColumns=9]="insertColumns";l[l.insertCellsShiftRight=17]="insertCellsShiftRight";l[l.insertCellsShiftDown=33]="insertCellsShiftDown";l[l.deleteRows=6]="deleteRows";l[l.deleteColumns=10]="deleteColumns";l[l.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";l[l.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Ik||(Ik={}));Object(Vd.b)("InsertDeleteCellFlags",Ik);var Ii=b(444);Object(Vd.a)(dd,"MacroRecorderRangeInsertedOrDeletedPayload",null,[447]);var Rk=b(121),Dk=b(267),Jk=b(1210);
b(322);fc.pfd="GetFontPreviewData";Object(Vd.a)(fc,"FontWebServiceMethods",null,[]);ge.prototype.pfd=function(l,J){var Y=this.lv,za=this.lv.hc(),Ua=fc.pfd;za=Y.Na(5,void 0===za?null:za);return Td.i(Y,Ua,za,l,J,null,null,644)};Object(Vd.a)(ge,"FontServiceManager",null,[]);Xe.prototype.bXe=function(l,J,Y,za){za=void 0===za?null:za;var Ua=Object(tg.a)(new Qh.a,{Id:"FontDropdownMenu"});Ua.MenuSectionList=[];if(this.Pm&&this.themesManager){this.themesManager.Pad(za);if(null==this.themesManager.ML||this.themesManager.fsd)return Ua;
za=Object(tg.a)(new bh.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:se.a.instance.fa(1303),ControlList:this.I_h(l,J,Y)});Ua.MenuSectionList.push(za)}za=Object(tg.a)(new bh.a,{ControlsId:"FontsMenuSectionControl"});this.Pm&&(za.Title=se.a.instance.fa(1304));za.ControlList=this.FQh(l,J,Y);Ua.MenuSectionList.push(za);return Ua};Xe.prototype.I_h=function(l,J,Y){var za,Ua=[],Qb=Je.g(this.$).ha.Oa.oc;Qb=5===(null===(za=null===Qb||void 0===Qb?void 0:Qb.floatingObject)||void 0===za?void 0:za.type);
if(this.themesManager.ML){var uc=this.themesManager.ML.nrf;var ed=this.themesManager.ML.Mpf}else Cd.ULS.sendTraceTag(525361436,1,15,"ThemeFonts are Null");null!=ed?(za=this.aGe(ed,1,Qb,l,J,Y),Ua.push(za)):Cd.ULS.sendTraceTag(525361435,1,15,"Major Theme Font is Null");null!=uc?(l=this.aGe(uc,2,Qb,l,J,Y),Ua.push(l)):Cd.ULS.sendTraceTag(525361434,1,15,"Minor Theme Font is Null");return Ua};Xe.prototype.aGe=function(l,J,Y,za,Ua,Qb){var uc=2===J?this.DBi:this.Iyi;Y=Y?uc:hg.a.nf(l);uc=hg.a.nf(md.HelperMethods.Tcc(l,
J));l=hg.a.nf(l);return Object(tg.a)(new Jk.a,{MenuItemId:2===J?"MinorThemeFont":"MajorThemeFont",CommandValueId:Y,LabelText:uc,LabelCss:String.format("font-size:12pt;font-family:{0};",l),Styles:Xe.vwb(l),AriaLabel:uc,Alt:uc,Command:za.toString(),CommandPreviewId:Ua.toString(),CommandRevertId:Qb.toString()})};Xe.prototype.FQh=function(l,J,Y){if(Xe.NZc)return Xe.NZc.f6c;var za=this.ngi&&!this.Kgf,Ua=!1;Xe.s3a||(Xe.Saf(),Ua=!0);var Qb=this.GEe(l,J,Y,Xe.s3a,za,Ua);Qb.Hxc&&!Ua&&(Cd.ULS.sendTraceTag(523903238,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),Xe.Saf(),Qb=this.GEe(l,J,Y,Xe.s3a,za,Qb.Hxc));this.lu&&!Qb.Hxc&&(Uc.a.Li(Xe.styles),Xe.NZc=Qb);za&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.NQi);return Qb.f6c};Xe.prototype.GEe=function(l,J,Y,za,Ua,Qb){var uc=[],ed=this.lu&&!Qb;var Dd=ed?"msofpNew":"msofp";for(var hd in za){var Ke=hd,zf=za[hd],Dg=hg.a.nf(Ke),Tg;if(ed)if(Tg=Xe.Eea?Xe.Eea[Ke]:null)Tg=hg.a.nf(Tg);else return Cd.ULS.sendTraceTag(523903237,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for {0}",Ke),{Hxc:!0,f6c:[]};else Tg=hg.a.nf(md.HelperMethods.Eea[Ke]);Ke=hg.a.nf(Ke);Ua||(zf=0);Dg=Object(tg.a)(new Jk.a,{MenuItemId:Dg,CommandValueId:Dg,LabelText:Ua&&0<zf?hg.a.nf(String.fromCodePoint(zf)):Tg,LabelCss:String.format("font-size:12pt;font-family:{0};",Ua&&0<zf?Dd:Ke),Styles:Xe.vwb(Ua&&0<zf?Dd:Ke),AriaLabel:Tg,Alt:Tg,Command:l.toString(),CommandPreviewId:J.toString(),CommandRevertId:Y.toString()});
uc.push(Dg)}return{Hxc:Qb,f6c:uc}};Xe.prototype.csj=function(l){this.menuId=l};Xe.prototype.$ii=function(){return 2!==this.Qub&&3!==this.Qub?!1:!0};Xe.prototype.pgj=function(){this.Qub=1;this.QVe||(this.QVe=new ge(this.$.na.lv));this.QVe.pfd(this.wLi,this.xLi)};Xe.prototype.F0i=function(l){var J=this;if(this.tpi(l)){var Y=md.HelperMethods.Cca(function(){var za=l.Result;Xe.styles='@font-face{font-family:"msofpNew";font-style:normal;font-weight:normal;src:url(\''+za.PreviewUrl+"') format('truetype')}";
var Ua=za.FontFacePropertiesList,Qb=za.FontNameList;Xe.s3a={};Xe.Eea={};Qb.forEach(function(uc,ed){Xe.s3a[uc]=Ua[ed].Codepoint;Xe.styles=J.FKg(Xe.styles,uc,"https://fs.microsoft.com/fs/"+za.CatalogVersion+"/rawguids/"+Ua[ed].FontGuid);Xe.Eea[uc]=uc})});10<Y&&Cd.ULS.sendTraceTag(523903236,1,50,"FontDropdownHelper.prepareFontCodepointMap: Duration for prepareFontCodepointMap the model, duration={0}",Y)}};Xe.prototype.tpi=function(l){if(!l.Result)return Cd.ULS.sendTraceTag(523903235,1,15,"FontDropdownHelper.isValidFontPreviewData: Result in EwaResult is Null."),
!1;l=l.Result;return l?l.PreviewUrl?l.FontFacePropertiesList?l.FontNameList?0==l.FontFacePropertiesList.length||l.FontFacePropertiesList.length!=l.FontNameList.length?(Cd.ULS.sendTraceTag(523903202,1,15,"FontDropdownHelper.isValidFontPreviewData: Mismatch in length of FontFacePropertiesList and FontNameList in fontListPreviewData."),!1):!0:(Cd.ULS.sendTraceTag(523903203,1,15,"FontDropdownHelper.isValidFontPreviewData: FontNameList in fontListPreviewData is Null."),!1):(Cd.ULS.sendTraceTag(523903232,
1,15,"FontDropdownHelper.isValidFontPreviewData: FontFacePropertiesList in fontListPreviewData is Null."),!1):(Cd.ULS.sendTraceTag(523903233,1,15,"FontDropdownHelper.isValidFontPreviewData: PreviewUrl in fontListPreviewData is Null."),!1):(Cd.ULS.sendTraceTag(523903234,1,15,"FontDropdownHelper.isValidFontPreviewData: fontListPreviewData is Null."),!1)};Xe.prototype.FKg=function(l,J,Y){return l+('@font-face{font-family:"'+J+'";src:local("'+J+"\"), url('"+Y+"')}")};Xe.prototype.oOf=function(){this.menuId&&
this.frame.Wv(this.menuId)};Xe.Saf=function(){var l={};Xe.s3a=(l["Angsana New"]=983046,l["Arial Black"]=983051,l.Arial=983050,l.Batang=983061,l["Book Antiqua"]=983077,l["Browallia New"]=983082,l.Calibri=983085,l.Cambria=983089,l.Candara=983091,l.Century=983095,l["Comic Sans MS"]=983100,l.Consolas=983101,l.Constantia=983102,l.Corbel=983106,l["Cordia New"]=983107,l["Courier New"]=983109,l.DilleniaUPC=983121,l.Dotum=983123,l.FangSong=983138,l.Garamond=983154,l.Georgia=983156,l.Gulim=983182,l.GungSuh=
983186,l.KaiTi=983222,l.JasmineUPC=983218,l["Malgun Gothic"]=983258,l.Mangal=983262,l.Meiryo=983264,l["Microsoft JhengHei"]=983272,l["Microsoft YaHei"]=983284,l.MingLiU=983292,l.MingLiU_HKSCS=983296,l["MS Gothic"]=983245,l["MS Mincho"]=983247,l["MS PGothic"]=983249,l["MS PMincho"]=983251,l.PMingliU=983322,l["PMingLiU-ExtB"]=983324,l.SimHei=983382,l.SimSun=983384,l["SimSun-ExtB"]=983386,l["Source Sans Pro"]=983396,l.Tahoma=983405,l.THSarabunPSK=983404,l["Times New Roman"]=983415,l["Trebuchet MS"]=
983419,l.Verdana=983443,l["Yu Gothic"]=983464,l["Yu Mincho"]=983474,l)};Xe.vwb=function(l){var J={};J["font-family"]=l;J["font-size"]="12pt";return{optionText:J}};Ck.Object.defineProperties(Xe.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.Bx||(this.Bx=this.$.da.Aa(422));return this.Bx}}});Ck.Object.defineProperties(Xe,{r8f:{configurable:!0,enumerable:!0,get:function(){return Xe.Eea}}});Xe.s3a=null;Xe.Eea=null;Xe.NZc=null;Xe.styles=null;Object(Vd.a)(Xe,"FontDropdownHelper",
null,[655]);de.PRg=function(l,J){return new de(l,J,null,null,null)};de.GZc=function(l,J){return new de(l,null,J,null,null)};de.QRg=function(l,J){return new de(l,null,null,J,null)};de.ORg=function(l,J,Y){return new de(l,null,J,null,Y)};Ck.Object.defineProperties(de.prototype,{bKa:{configurable:!0,enumerable:!0,get:function(){return this.Apg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.Bpg}},style:{configurable:!0,enumerable:!0,get:function(){return this.Axg}},size:{configurable:!0,
enumerable:!0,get:function(){return this.fXb}},aba:{configurable:!0,enumerable:!0,get:function(){return this.PVe}}});Object(Vd.a)(de,"CachedPreviewCellGroup",null,[]);var Sk=b(66);Qc.prototype.ZL=function(){var l=this;this.nEc=!1;if(Bh.b(this.ICa,514846606)){this.nEc=!0;Cd.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");Sk.a(this.Cf.$).rd.nE(514846606);if(this.LPb&&this.b1d)window.setTimeout(function(){l.Cf.Faa(l.Cf.gridView,l.HCa,!0,!0)},0);else return this.r1d=Je.g(this.Cf.$).rtl,
this.t1d=wg.a.gd(3,2,0,this.r1d?634:633,0,514846606,"MergeCellsLoseData"),this.kj=Bj.a(this.Cf.$).ui(this.t1d).G(),this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext)),this.gEc;return this.tgb}return this.R1};Qc.prototype.R1=function(){this.Cf.Mmf(this.nEc,this.b1d,this.Vhg.scenario,this.LPb);this._state=3};Qc.prototype.tgb=function(){return this.R1};Qc.prototype.gEc=function(){this.jEc=this.kj.Dz();if(0===this.jEc)return Cd.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
this.kj=this.Cf.Faa(this.Cf.gridView,this.HCa,!0,!1).g(),this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext)),this.hEc;1===this.jEc&&Cd.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.vgb};Qc.prototype.vgb=function(){return this.tgb};Qc.prototype.hEc=function(){this.kj.Dz();return this.vgb};Qc.prototype.dispose=function(){};Object(Vd.a)(Qc,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[2]);kd.prototype.ZL=
function(){return Bh.b(this.ICa,514846606)?(Cd.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),Sk.a(this.Cf.$).rd.nE(514846606),this.o1d=Je.g(this.Cf.$).rtl,this.p1d=wg.a.gd(3,2,0,this.o1d?634:633,0,514846606,"MergeCellsLoseData"),this.kj=Bj.a(this.Cf.$).ui(this.p1d).G(),this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext)),this.sgb):this.R1};kd.prototype.R1=function(){this._state=3};kd.prototype.sgb=function(){this.mEc=this.kj.Dz();if(0===this.mEc)return Cd.ULS.sendTraceTag(537159426,
0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.kj=this.Cf.Faa(this.Cf.gridView,this.HCa,!0,this.LPb).g(),this.kj.isCompleted||(this._state=2,this.kj.UN(this.moveNext)),this.gig;1===this.mEc&&Cd.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.ugb};kd.prototype.ugb=function(){return this.R1};kd.prototype.gig=function(){this.kj.Dz();return this.ugb};kd.prototype.dispose=function(){};Object(Vd.a)(kd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",
null,[2]);var zk=b(388),el=zk.a;Am(gd,el);gd.prototype.jh=function(){1896159024===this.Er?(this.Im=se.a.instance.fa(23),this.$6c=0):(this.Im=se.a.instance.fa(22),this.$6c=1);var l=this.selectedRanges[0].uW&&!this.selectedRanges[0].N_?0:1;this.jc=1;var J={};l=(J[gd.ay]=this.Cc,J.dialogToDisplay=this.$6c,J.defaultSelectedKey=l,J.isRtl=this.isRtl,J);this.initializeAndShow(this.Im,this.ddi,l)};Ck.Object.defineProperties(gd.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});
Object(Vd.a)(gd,"InsertDeleteCellsDialog",zk.a,[]);Object(Vd.a)(rc,"MacroRecorderRangeFilledPayload",null,[447]);Object(Vd.a)(Wd,"RangeBorders",null,[]);Object(Vd.a)(he,"ScenarioInfo",null,[]);Oc.prototype.dispose=function(){this.$=null};Oc.prototype.Fhi=function(l,J){return!(void 0===J||null===J)&&!!(J.scenario&16384)&&155820588!==l&&this.Ocf(J,l)};Oc.prototype.Y0e=function(){var l=Eb.a.Ae(),J=Je.g(this.$),Y=J.ha.ta.selectedRanges,za=0,Ua=0,Qb=Y.length,uc=new he;if(1<Qb)return uc.scenario=4,uc;this.hqd&&
Je.g(this.$).rtl&&(za|=65536);if(!J.U5(Y[0]))if(this.fzb)za|=32;else return uc.scenario=32,uc;if(J=J.Ea.s4a(Y[0],this.$.activeItemName))for(uc.$Yc=J,J=Cl(J),Qb=J.next();!Qb.done;Qb=J.next())if(Ua+=1,1<Ua){this.fzb?(za|=256,uc.scenario=za):uc.scenario=256;if(!this.Wzb)return uc;break}Ua=Je.g(this.$).Ea.pva(Y[0]);if(!Ua)return uc.scenario=32768,uc;J=Ua.length;Y=Y[0];Qb=Y.bottom-Y.top+1;for(var ed=Y.right-Y.left+1,Dd=new Wd,hd=0;hd<J;hd++)if(this.Wgf&&this.NWh(Ua[hd],Y,Dd),za=za|(void 0!==Ua[hd].text&&
null!==Ua[hd].text&&""!==Ua[hd].text?1:0)|(Ua[hd].pN?2:0)|(Ua[hd].jwa?8:0)|(Ua[hd].lxb?16:0)|(Ua[hd].LH?64:0)|(Ua[hd].vba?128:0),void 0!==Ua[hd].text&&null!==Ua[hd].text&&""!==Ua[hd].text||Ua[hd].jwa)if(void 0===uc.cR||null===uc.cR)uc.cR=Je.g(this.$).mc(Ua[hd].getRange());else{if(Ua[hd].getRange().top<uc.cR.range.top||Ua[hd].getRange().top==uc.cR.range.top&&Ua[hd].getRange().left<uc.cR.range.left)uc.cR=Je.g(this.$).mc(Ua[hd].getRange());za|=16384}this.Wgf&&(Dd.OTa===ed&&(za|=512),Dd.XGa===ed&&(za|=
2048),Dd.UNa===Qb&&(za|=4096),Dd.oRa===Qb&&(za|=1024),0<Dd.OTa&&Dd.OTa<ed||0<Dd.XGa&&Dd.XGa<ed||0<Dd.UNa&&Dd.UNa<Qb||0<Dd.oRa&&Dd.oRa<Qb)&&(za|=8192);!We.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Y.right!==Y.maxColumns&&Y.bottom!==Y.maxRows||(za|=131072);l=Eb.a.Ae()-l;Cd.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : {0}",l);uc.scenario=za;return uc};Oc.prototype.Uqf=function(l,J){var Y=l.command;if(void 0===J||null===
J)J=this.Y0e();if(!this.Ocf(J,Y))return!1;l=Je.g(this.$).ha.ta.selectedRanges;var za=Je.g(this.$).Ea.pva(l[0]);if(!za)return!1;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===za.length&&!za[0].pN)return-167499203===Y?(za[0].R7(2,!0),!0):!1;za=Je.g(this.$).ha.ta.sB;var Ua=this.$.qa.sheetName,Qb=!0;switch(Y){case -167499203:2===(J.scenario&2)&&this.yhc?this.bcg(J.scenario,l,Y):Qb=this.VAi(J,l);break;case 1097660126:(J=this.Vqf(J,l))&&0!=J.length||(Qb=!1);
break;case 155820588:this.bcg(J.scenario,l,Y);break;default:return!1}Je.g(this.$).bW(l,za,Ua,null,l[0],null,null,0,"MergeCellCommandAction");return this.Wzb?Qb:!0};Oc.prototype.Ocf=function(l,J){var Y=this.sgi(l,J);if(!this.Uef)return Y;var za=Je.g(this.$).ha.ta.selectedRanges[0].qB(!1);Cd.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",J.toString(),l.scenario,Y,za);return Y};Oc.prototype.sgi=function(l,J){if(-255094134===J)return!1;
var Y=l.scenario;if(this.hqd&&65536===(Y&65536))return!1;if(this.cpi(J,l))return this.bpi(J,l);this.fzb&&32===(Y&32)&&(Y&=-33);if(256==(Y&256))if(this.Zki(l))Y&=-257;else return!1;return 32768===Y||4===Y||128===(Y&128)||!this.fzb&&32===Y?!1:-167499203!=J&&1097660126!==J||!this.fod(l)?void 0!==l.cR&&null!==l.cR&&l.cR.sT?!1:0===Y?!0:16384===(Y&16384)?We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Y&1)&&8!==(Y&8)||!We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",
!1)?!1:!0:this.zhc};Oc.prototype.rii=function(l){return 131072===(l.scenario&131072)?!0:!1};Oc.prototype.Zki=function(l){if(!this.Wzb)return!1;var J="Multi block",Y=!0;this.fod(l)&&(J+=" with border",Y=!1);this.rii(l)&&(Y=!1,J+=" with entire row or column selected",16384===(l.scenario&16384)&&(J+=" and a data loss scenario"));Y||Cd.ULS.sendTraceTag(523511383,0,50,"CSE for {0}, is not enabled",J);return Y};Oc.prototype.fod=function(l){return 16===(l.scenario&16)||this.Wjd(l.scenario)||this.okd(l.scenario)||
this.fkd(l.scenario)||this.rkd(l.scenario)||8192===(l.scenario&8192)?!0:!1};Oc.prototype.cpi=function(l,J){return 155820588===l||(-167499203===l||1097660126===l)&&2===(J.scenario&2)&&this.yhc?!0:!1};Oc.prototype.$oi=function(l){return this.rkd(l.scenario)||this.fkd(l.scenario)||this.Wjd(l.scenario)||this.okd(l.scenario)?!0:!1};Oc.prototype.bpi=function(l,J){if(1097660126===l&&2===(J.scenario&2)||this.yhi&&void 0!==J.cR&&null!==J.cR&&J.cR.sT)return!1;this.fzb&&32===(J.scenario&32)&&(J.scenario&=-33);
return 32768===J.scenario||4===J.scenario||256===(J.scenario&256)&&this.Kki||128===(J.scenario&128)?!1:2===(J.scenario&2)?this.$oi(J)?We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1};Oc.prototype.NWh=function(l,J,Y){var za=l.getRange();if(za.top===J.top)if(l.yLa)Y.OTa+=za.right-za.left+1;else{var Ua=this.ZA.hR(za,0);if(Ua){var Qb=Cl(Ua);
for(Ua=Qb.next();!Ua.done;Ua=Qb.next())Ua=Ua.value,Ua.sLa&&(Y.OTa+=Ua.getRange().right-Ua.getRange().left+1)}}if(za.left===J.left)if(l.uLa)Y.UNa+=za.bottom-za.top+1;else if(Ua=this.ZA.hR(za,2))for(Qb=Cl(Ua),Ua=Qb.next();!Ua.done;Ua=Qb.next())Ua=Ua.value,Ua.wLa&&(Y.UNa+=Ua.getRange().bottom-Ua.getRange().top+1);if(za.bottom===J.bottom)if(l.sLa)Y.XGa+=za.right-za.left+1;else if(Ua=this.ZA.hR(za,1))for(Qb=Cl(Ua),Ua=Qb.next();!Ua.done;Ua=Qb.next())Ua=Ua.value,Ua.yLa&&(Y.XGa+=Ua.getRange().right-Ua.getRange().left+
1);if(za.right===J.right)if(l.wLa)Y.oRa+=za.bottom-za.top+1;else if(l=this.ZA.hR(za,3))for(l=Cl(l),Ua=l.next();!Ua.done;Ua=l.next())J=Ua.value,J.uLa&&(Y.oRa+=J.getRange().bottom-J.getRange().top+1)};Oc.prototype.X$i=function(l,J){J=Cl(J.$Yc);for(var Y=J.next();!Y.done;Y=J.next()){Y=l.Te(Y.value.uf);Y=Je.g(this.$).Ea.pva(Y);for(var za=Y.length,Ua=1;Ua<za;Ua++){var Qb=Je.g(this.$).mc(Y[Ua].getRange());this.zhc?Qb.cell.deleteCellFromModel():(Qb.Dqb(),Qb.clearFormat(),Qb.cell.Y$i());Qb.UHb(!0)}}};Oc.prototype.rUj=
function(l,J){l.backgroundColor=J.backgroundColor;l.color=J.color};Oc.prototype.Rig=function(l,J){return{SpansBlocks:!0,OriginRow:l,OriginColumn:J,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};Oc.prototype.WAg=function(l,J,Y,za,Ua){Y=l.Te(Y.uf);if(!Y)return Cd.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var Qb=new sg.Range(l.top,
l.left,Y.top,Y.left,!1,!1);if(Y.top==l.top)var uc=0;else Qb.bottom=Y.top-1,uc=J.Ygd(Qb);Y.left==l.left?Qb=0:(Qb.right=Y.left-1,Qb=J.Zgd(Qb));J=this.Rig(l.top-1,l.left-1);J.OriginDeltaY=uc;J.OriginDeltaX=Qb;J.Rows=Y.bottom-Y.top;J.Columns=Y.right-Y.left;J.Height=Ua;J.Width=za;Y.top==l.top&&Y.left==l.left&&(J.IsOrigin=!0);l=Je.g(this.$).mc(Y.topLeft);l.cell.T_f(J);return l};Oc.prototype.WPd=function(l,J){var Y=[],za=Je.g(this.$).Df;if(!za)return Y;var Ua=za.Ygd(l),Qb=za.Zgd(l);if(J.$Yc){J=Cl(J.$Yc);
for(var uc=J.next();!uc.done;uc=J.next())if(uc=this.WAg(l,za,uc.value,Qb,Ua))Y.push(uc);else{Y=[];break}}return Y};Oc.prototype.MXh=function(l,J,Y,za){var Ua=Y.bottom-Y.top,Qb=Y.right-Y.left,uc=[],ed=za.scenario;if(256===(ed&256)){if(uc=this.WPd(Y,za),!uc||0==uc.length)return uc}else J.cell.WPd(Ua,Qb),uc.push(J);Ua=this.C3(this.G5(J),!0,0,ed,"merge");if(void 0!==l&&null!==l){Qb=Cl(uc);for(var Dd=Qb.next();!Dd.done;Dd=Qb.next()){Dd=Dd.value;var hd=l.cell.formattedText,Ke=Object(tg.a)(new Fi.a,{TextRuns:hd.TextRuns,
Fonts:hd.Fonts});Ke.Text=void 0!==l.cell.originalText&&null!==l.cell.originalText?l.cell.originalText:void 0!==l.cell.userInput&&null!==l.cell.userInput?l.cell.userInput:hd.Text;Ua=this.C3(this.G5(Dd),Ua,1,ed,"merge");this.Sg.iBa(Dd,Ke,!1,null,!0,"MergeCells",void 0,2);Ua=this.C3(this.G5(Dd),Ua,2,ed,"merge");this.hqd?Dd.Lqb(l):this.rUj(Dd,l);Ua=this.C3(this.G5(Dd),Ua,3,ed,"merge");Dd.cell.i4g(l.cell);Ua=this.C3(this.G5(Dd),Ua,4,ed,"merge");Dd.cell.KCc(!1);Ua=this.C3(this.G5(Dd),Ua,6,ed,"merge")}}this.X$i(Y,
za);this.C3(this.G5(J),Ua,5,ed,"merge");return uc};Oc.prototype.fkd=function(l){return 4096===(l&4096)};Oc.prototype.rkd=function(l){return 512===(l&512)};Oc.prototype.Wjd=function(l){return 2048===(l&2048)};Oc.prototype.okd=function(l){return 1024===(l&1024)};Oc.prototype.Oac=function(l,J){for(var Y=null,za=0;za<l.length;za++)if(l[za].BorderPosition===J){Y=l[za];break}return Y};Oc.prototype.$Sh=function(l,J){this.hic?(J=this.Oac(J.cell.$M().Borders,2))&&l.push(J):(J=J.cell.$M().Borders,1<J.length&&
(J=[J[1]]),l=[].concat(Dl(J),Dl(l)));return l};Oc.prototype.a0h=function(l,J){this.hic?(J=this.Oac(J.cell.$M().Borders,0))&&l.push(J):(J=J.cell.$M().Borders,1<J.length&&(J=[J[0]]),l=[].concat(Dl(J),Dl(l)));return l};Oc.prototype.VKh=function(l,J){J=this.ZA.hR(J.cell.getRange(),1);if(this.hic){if(J=J[0].$M().Borders,J=this.Oac(J,0))J.BorderPosition=1,l.push(J)}else{var Y=[];0<J.length&&(Y=J[0].$M().Borders);Y[0].BorderPosition=1;l=[].concat(Dl(Y),Dl(l))}return l};Oc.prototype.XXh=function(l,J){J=this.ZA.hR(J.cell.getRange(),
3);if(this.hic){if(J=J[0].$M().Borders,J=this.Oac(J,2))J.BorderPosition=3,l.push(J)}else{var Y=[];0<J.length&&(Y=J[0].$M().Borders);Y[0].BorderPosition=3;l=[].concat(Dl(Y),Dl(l))}return l};Oc.prototype.OWh=function(l,J,Y){this.fkd(l.scenario)&&(J=this.$Sh(J,Y));this.rkd(l.scenario)&&(J=this.a0h(J,Y));this.Wjd(l.scenario)&&(J=this.VKh(J,Y));this.okd(l.scenario)&&(J=this.XXh(J,Y));return J};Oc.prototype.e_=function(l){if(0===l.length)return null;var J=[0,0,0,0],Y=[1,1,1,1],za=0;l.forEach(function(Qb){var uc=
Qb.BorderPosition;Y[uc]=Qb.BorderLineStyle;var ed=new Eh.a(Qb.Color.Red,Qb.Color.Green,Qb.Color.Blue);J[uc]=ed.XX();za|=md.HelperMethods.Y3a(Qb.BorderPosition)});l={};l.LineStyle=Y;l.Color=J;var Ua={};Ua.BorderFormat=l;Ua.Border=za;return Ua};Oc.prototype.a2d=function(l,J,Y){Y=void 0===Y?null:Y;var za=[];za=null!==Y?[].concat(Dl(Y)):this.OWh(J,za,l);J=this.e_(za);l.cell.Gsc(l.cell.getRange());this.ZA.jJd(l.cell.getRange());this.Sg.qea(Je.g(this.$),-1690267012,J,!1,null,[l.cell.getRange()])};Oc.prototype.cmi=
function(l){return 512===(l.scenario&512)||4096===(l.scenario&4096)||1024===(l.scenario&1024)||2048===(l.scenario&2048)?!0:!1};Oc.prototype.b0h=function(l){l=this.ZA.hR(l.cell.getRange(),1);return l[0].yLa?(l=l[0].$M().Borders[0],l.BorderPosition=1,l):null};Oc.prototype.c0h=function(l){l=this.ZA.hR(l.cell.getRange(),3);return l[0].uLa?(l=l[0].$M().Borders[0],l.BorderPosition=3,l):null};Oc.prototype.x4h=function(l,J,Y,za,Ua){J.cell.Zdg();this.cmi(l)?this.a2d(J,l):Ua&&(Ua=[],null!==Y&&Ua.push(Y),null!==
za&&Ua.push(za),0<Ua.length?this.a2d(J,l,Ua):(J.cell.Gsc(J.cell.getRange()),this.ZA.jJd(J.cell.getRange())))};Oc.prototype.vSh=function(l,J){return null===l||void 0===l?!0:l.cell.getRange().top===J.topLeft.top&&l.cell.getRange().left===J.topLeft.left&&l.cell.getRange().bottom===J.topLeft.bottom&&l.cell.getRange().right===J.topLeft.right?!0:!1};Oc.prototype.VAi=function(l,J){J=this.Vqf(l,J);if(this.Wzb&&(!J||0==J.length))return!1;for(var Y=0;Y<J.length;Y++)J[Y].R7(2,!0),this.C3(this.G5(J[Y]),!0,8,
l.scenario,"merge");return!0};Oc.prototype.Vqf=function(l,J){var Y=l.cR,za=Je.g(this.$).mc(J[0]),Ua=null,Qb=null;this.zhc&&(Ua=this.b0h(za),Qb=this.c0h(za));var uc=this.MXh(Y,za,J[0],l);if(this.Wzb&&(!uc||0==uc.length))return uc;Je.g(this.$).Ea.I$(J[0],this.$.activeItemName).$dg(J[0],!0);this.C3(this.G5(za),!0,9,l.scenario,"merge");if(this.zhc&&this.fod(l))for(J=this.vSh(Y,J[0]),Y=Cl(uc),za=Y.next();!za.done;za=Y.next())this.x4h(l,za.value,Ua,Qb,J);return uc};Oc.prototype.XKg=function(l,J,Y){var za=
this;if(!(1>l.Borders.length)){var Ua=this.e_(l.Borders);Y.forEach(function(Qb){Qb=Je.g(za.$).mc(Qb.getRange());za.Sg.u4f(-1690267012,Qb,Ua,!1,null,!1,J)})}};Oc.prototype.GPj=function(l,J,Y){for(var za=l.length,Ua=0;Ua<za;Ua++){l[Ua].cell.KCc();var Qb=l[Ua].cell.getRange(),uc=Je.g(this.$).Ea.pva(Qb),ed=uc.length;if(-167499203===J&&this.yhc){var Dd=0;2===l[Ua].cell.UHd||1===l[Ua].cell.oQ?Dd=3:2===l[Ua].cell.oQ&&(Dd=1);l[Ua].R7(Dd,!1)}for(Dd=1;Dd<ed;Dd++)uc[Dd].attachCellToModel(),uc[Dd].Lqb(l[Ua]),
-167499203===J&&this.yhc&&uc[Dd].R7(null,!1);this.Pif&&Y&&this.XKg(Y[Ua],Qb,uc)}};Oc.prototype.HXe=function(l,J){for(var Y=null,za=0;za<l.length;za++)if(l[za].BorderPosition===J){Y=l[za];break}return Y};Oc.prototype.UKh=function(l,J){var Y=l.cell.$M();l.sLa()&&l.cell.KQa(1);l.wLa()&&l.cell.KQa(3);l=this.ZA.hR(J,0);if(l[0].sLa){var za=l[0].$M().Borders;za=this.HXe(za,1);za.BorderPosition=0;Y.Borders.push(za);l.forEach(function(Ua){Ua.KQa(1)})}J=this.ZA.hR(J,2);J[0].wLa&&(l=J[0].$M().Borders,l=this.HXe(l,
3),l.BorderPosition=2,Y.Borders.push(l),J.forEach(function(Ua){Ua.KQa(3)}));return Y};Oc.prototype.bcg=function(l,J,Y){var za=Je.g(this.$).Ea.Jva(J[0],this.$.activeItemName),Ua=Je.g(this.$).Ea.I$(J[0],this.$.activeItemName),Qb=[];if(void 0!==za&&null!==za&&(J=Je.g(this.$).Tja(J[0],za),void 0!==J&&null!==J)){J=J.$$ge();for(za=[];J.$$mn();){var uc=J.$$cu();if(uc.wF){Qb.push(uc);this.C3(this.G5(uc),!0,10,l,"unmerge");uc.cell.TYg();var ed=uc.cell.getRange();this.C3(this.G5(uc),!1,11,l,"unmerge");Ua.$dg(ed,
!1);this.Pif&&(uc=this.UKh(uc,ed),za.push(uc))}}0<Qb.length&&(Ua.Ff.resetCellLookup(),this.GPj(Qb,Y,za))}};Oc.prototype.C3=function(l,J,Y,za,Ua){if(!this.Uef)return!1;l!==J&&Cd.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",Y,za,Ua,J?"populated":"empty",l?"populated":"empty");return l};Oc.prototype.G5=function(l){return!!l.cell.cell.Merge};Object(Vd.a)(Oc,"MergeCellCommandAction",
null,[]);var Tk=b(107),rl=b(490),$k=b(395),rk=b(905),sk=b(354);Gb.prototype.bki=function(l){return 1896159024===l||-1554384558===l||-1113896058===l||1554436520===l||1415868706===l||674605324===l||1035996630===l};Gb.prototype.$c=function(l,J){return 2054778433===J&&l&1?!rg.a(this.$).kic:600686207===J?!1:this.bki(J)&&xh.a.any(this.gridView.ha.ta.selectedRanges,function(Y){return Y.ff||Y.isRow})&&!this.Mhf&&!this.Ghf?!0:this.Cic(l,J)};Gb.prototype.executeCommand=function(l,J,Y){return this.$b(J,Y)};
Gb.prototype.Kc=function(l,J,Y){if(l=1===l)switch(J.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:l=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:l=
!!Y;break;case 862825906:case 1532790410:case 46555851:case -1522760979:l=!0;break;default:l=!1}return l};Gb.prototype.jd=function(l,J,Y){switch(J){case "PopulateFontColor":Y.MenuItems=this.IB.$ac(1970784898,-803000997,null,-128950598,2036397036,1688184685,862825906,Y.MenuId);break;case "PopulateFillColor":Y.MenuItems=this.IB.$ac(1650812936,null,87208751,673562736,1457172838,-446735083,1532790410,Y.MenuId);break;case "PopulateBorderColor":Y.MenuItems=this.IB.$ac(-236759591,-1803452024,void 0,void 0,
void 0,void 0,46555851,Y.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.P4h(Y);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.lu&&(this.lcd.csj(Y.MenuId),!this.lcd.$ii()))return!1;Y.MenuItems=this.lcd.bXe(-1293291468,324978188,-1428968098,Y.MenuId);break;default:return!1}return!0};Gb.prototype.Cic=function(l,J){var Y=Je.g(this.$).ha.ta.selectedRanges;return!(new ah.a(this.$.xa)).Om(l,J,Y,this.gridView)};Gb.prototype.$b=function(l,J){var Y=this,za=this.gridView,
Ua=l.command,Qb=Pg.TaskExtensions.Dl(),uc=!0;switch(Ua){case -1077965542:uc=this.J6e(J,l,!1);break;case 909774670:this.Tpb(Ua);uc=this.J6e(J,l,!0);break;case -1293291468:uc=this.H6e(J,l,!1);break;case 324978188:We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Cd.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.Tpb(Ua);uc=this.H6e(J,l,!0);break;case 862890474:case 963349338:uc=this.l4h(l);break;case -1832800737:uc=
this.Ddc(Ua,J,!1,l);break;case 1970784898:uc=this.Ddc(Ua,J,!1,l);break;case -803000997:uc=this.Ddc(Ua,J,!1,l);break;case -128950598:case 1688184685:this.Tpb(Ua);uc=this.Ddc(Ua,J,!0,l);break;case 1597684571:uc=this.bxb(Ua,J,!1,l);break;case 87208751:J.Color="-1";J.IntColor=!0;uc=this.bxb(Ua,J,!1,l);break;case -446735083:this.Tpb(Ua);J.Color="-1";J.IntColor=!0;uc=this.bxb(Ua,J,!0,l);break;case 1650812936:uc=this.bxb(Ua,J,!1,l);break;case 673562736:this.Tpb(Ua);uc=this.bxb(Ua,J,!0,l);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(l=Zg.b().ti(Ua),Cd.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",l));this.uUf(Ua);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:uc=this.X3h(Ua,l);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:uc=this.h3h(Ua,l);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:uc=this.L4h(Ua,l);break;case -1803452024:case -236759591:uc=
this.cjd(Ua,J,l);break;case -2118943501:uc=this.borderFormatManager.r3h(J,l);break;case 1012765228:uc=this.borderFormatManager.c5h(J,l);break;case 1256700402:uc=this.borderFormatManager.hjd(l);break;case -1756763834:uc=this.borderFormatManager.ijd(l);break;case -1418159950:uc=this.borderFormatManager.v6e(l);break;case -1920201820:case -1942512156:uc=this.m4h(Ua,l);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:uc=this.borderFormatManager.i6e(J,l);this.DBh(J);
break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:uc=this.H4h(Ua,J,l);break;case -693675336:case 322710748:break;case 1696566924:uc=this.Y3h(l);break;case -167499203:case -255094134:case 1097660126:case 155820588:Qb=this.handleMergeCellsCommand(this.gridView,l);break;case 1896159024:case -1554384558:J=this.gridView.ha.ta.selectedRanges;if(this.Myj(l,J))Cd.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new gd(this.$,
Ua,J)).jh(),uc=!0;else if(xh.a.any(J,function(Dd){return Y.gridView.Rb.txa(Dd)})){za="";Qb=1461300262;var ed=-1554384558===Ua&&this.gridView.Rb.dmi(J[0]);J=J[0].height>J[0].width&&!ed;switch(Ua){case 1896159024:za=J?"InsertColumnsTable":"InsertRowsTable";Qb=J?622604322:942362098;break;case -1554384558:za=J?"DeleteColumnsTable":"DeleteRowsTable",Qb=J?284490184:1405456548}J=Rh.a.fo(Gb.hnd,za,1);new rh.a(Qb,1,2,6,null);Qb=this.insertOrDeleteCells(J,l,!0)}else Qb=this.insertOrDeleteCells(1896159024===
Ua?1:2,l,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Qb=this.insertOrDeleteCells(Rh.a.fo(Gb.hnd,J[kg.a.ld],1),l,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Qb=this.insertOrDeleteCells(Rh.a.fo(Gb.hnd,J[kg.a.ld],1),l,!1);break;case 504848446:Qb=za.startEdit(!1,1,J[oa.a.event],void 0,void 0,!0);break;case 1504715724:if(Je.g(this.$).Gz&&this.borderFormatManager.sV.wB)break;Qb=za.startEdit(!0,0,J[oa.a.event],void 0,void 0,!0);break;
case 1872288872:this.Gqb();break;case 41465729:Qb=this.fill(za.ha.ta.ud,null,0,1,l);break;case -1451655532:case 1972143101:Qb=this.fillDownAbsoluteValueAndStartEdit(za,J[oa.a.event],-1451655532===Ua);break;case -475861485:Qb=this.fill(za.ha.ta.ud,null,za.rtl?1:2,1,l);break;case -978843926:Qb=this.fill(za.ha.ta.ud,null,3,1,l);break;case 2098035706:Qb=this.fill(za.ha.ta.ud,null,za.rtl?2:1,1,l);break;case -2142700828:Qb=this.fill(za.ha.sourceRange,za.ha.ta.ud,Gb.n_e(za.ha.ta.ud,za.ha.sourceRange),2,
l);break;case 1405660955:Qb=this.fill(za.ha.sourceRange,za.ha.ta.ud,Gb.n_e(za.ha.ta.ud,za.ha.sourceRange),4,l);break;case 1983983164:Qb=this.fill(za.ha.ta.ud,null,0,0,l);break;case 478842689:(l=this.$.da.Aa(376))?(l.r4i(),uc=!0):Cd.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:uc=za.ha.$b(null,Ua);break;case -208772570:this.D4h();uc=
!0;break;case -987339782:this.z3h();uc=!0;break;case -1770246794:za.ha.A3h();uc=!0;break;case 748067091:case -381232414:this.D3h(Ua);uc=!0;break;case -1522760979:this.gridView.toggleFormulaView();uc=!0;break;case 886009118:Qb=this.j4h();break;case 894341014:this.o4h();uc=!0;break;case 862825906:Qb=this.Y6e(1970784898,l);break;case 1532790410:Qb=this.Y6e(1650812936,l);break;case 46555851:Qb=this.z4h(l);break;default:uc=!1}uc||(Qb=eg.a(Ua));return Qb};Gb.prototype.DBh=function(l){l&&l.MenuItemId&&["OutsideBorders",
"AllBorders","ThickOutsideBorders"].includes(l.MenuItemId)&&We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.xPg(new sk.a(this.gridView.ha.ta.activeRange,tf.d(this.$.xa.qa)))};Gb.prototype.xPg=function(){Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(this.$.da,426,427,1),function(){},this.$.la,3)};Gb.prototype.Myj=function(l,J){var Y=this,za=xh.a.all(J,function(uc){return!Y.gridView.Rb.txa(uc)}),Ua=1<J.length&&!!this.gridView.Rb.Nhd(J),
Qb=xh.a.all(J,function(uc){return!Y.gridView.Rb.fla(uc)});J=!xh.a.any(J,function(uc){return uc.isRow||uc.ff});return 1===l.method&&6===l.Xe&&(za||Ua)&&Qb&&J};Gb.prototype.fillDownAbsoluteValueAndStartEdit=function(l,J,Y){var za=this,Ua=l.ha.ta.activeCell,Qb=Gf.E(Ua,this.gridView.Ps);return l.startEdit(!0,0,J).CWR(function(){var uc=l.mc(Qb),ed=l.mc(Ua);if(!uc||!ed)return Cd.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",
Ua.toString(),Qb.toString()),ig.Task.Ra(!1);za.gridView.rc.text=Y?uc.C1:uc.text;za.gridView.rc.textBox.setCaretPositionToEnd();return ig.Task.Ra(!0)})};Gb.prototype.insertOrDeleteCells=function(l,J,Y){function za(){return new dd(hd)}var Ua=this,Qb=ji.a.create().toString(),uc=Enum.toString(Ik,l);this.gridView.Ki.e8(17,Qb,uc);uc=this.gridView.ha.ta.selectedRanges;var ed=this.Mhf,Dd=this.Ghf;if(!this.$.Dq(null,!1,void 0,J.Xe)&&!Dd&&!ed&&5!==l&&9!==l)return ig.Task.Ra(!0);2===l?l=Dd?10:ed?6:uc[0].height>
uc[0].width?18:34:1===l?l=Dd?9:ed?5:uc[0].height>uc[0].width?17:33:18===l&&ed?l=34:34===l&&Dd&&(l=18);uc=this.TIg(uc,l);if((10===l||6===l)&&!this.$.Dq(uc,!0,1,J.Xe))return ig.Task.Ra(!0);var hd={};hd.InsertDeleteRangeItems=Array(uc.length);hd.SheetName=this.$.qa.sheetName;hd.IsTableCommand=Y;for(Y=0;Y<uc.length;Y++){ed=uc[Y];var Ke={},zf=Dd=void 0;l&4?(Ke.FirstRow=ed.top-1,Ke.LastRow=ze.a.zy,Ke.FirstColumn=0,Ke.LastColumn=ze.a.yv,Dd=ed.bottom-ed.top+1,zf=0,6===l&&(ed.ff||(Ke.FirstRow=ed.bottom),Dd=
-Dd)):l&8?(Ke.FirstRow=0,Ke.LastRow=ze.a.zy,Ke.FirstColumn=ed.left-1,Ke.LastColumn=ze.a.yv,Dd=0,zf=ed.right-ed.left+1,10===l&&(ed.isRow||(Ke.FirstColumn=ed.right),zf=-zf)):l&16?(Ke.FirstRow=ed.top-1,Ke.LastRow=ed.bottom-1,Ke.FirstColumn=ed.left-1,Ke.LastColumn=ze.a.yv,Dd=0,zf=ed.right-ed.left+1,18===l&&(Ke.FirstColumn=ed.right,zf=-zf)):(Ke.FirstRow=ed.top-1,Ke.LastRow=ze.a.zy,Ke.FirstColumn=ed.left-1,Ke.LastColumn=ed.right-1,Dd=ed.bottom-ed.top+1,zf=0,34===l&&(Ke.FirstRow=ed.bottom,Dd=-Dd));Ke={InsertDeleteRange:Ke};
Ke.DeltaRow=Dd;Ke.DeltaColumn=zf;Ke.AdjustedSelectedRange=Gf.j(ed);hd.InsertDeleteRangeItems[Y]=Ke}this.gridView.rg.iH(!1);var Dg=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");hd.IsDecoupleRecalc=Dg;var Tg=this.$.na.va.hc();return af.a(this.$.userOperationManager,function(Rg,Yh,Li){Dg&&!We.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Ua.$.Oy();var Mh=Ua.$.na.va;Rg=lf.b(Rg,Ua.fOi);var Uj=Mh.Na(41,void 0===Tg?null:Tg);Uj.insertDeleteMultiRangeParameters=
hd;return Td.i(Mh,"InsertDeleteCells",Uj,Rg,Yh,Li,Qb,0)},function(Rg){return new Wg.a(237,0,Rg,void 0,za)},J)};Gb.prototype.TIg=function(l,J){return J&32?this.wZa(l,function(Y){return Y.bottom},function(Y){return Y.top},function(Y,za){Y.bottom=za},!1,!0):J&16?this.gridView.rtl?this.wZa(l,function(Y){return Y.left},function(Y){return Y.right},function(Y,za){Y.left=za},!1,!1):this.wZa(l,function(Y){return Y.right},function(Y){return Y.left},function(Y,za){Y.right=za},!1,!1):J&4?this.wZa(l,function(Y){return Y.bottom},
function(Y){return Y.top},function(Y,za){Y.bottom=za},!0,!0):J&8?this.gridView.rtl?this.wZa(l,function(Y){return Y.left},function(Y){return Y.right},function(Y,za){Y.left=za},!0,!1):this.wZa(l,function(Y){return Y.right},function(Y){return Y.left},function(Y,za){Y.right=za},!0,!1):l};Gb.prototype.wZa=function(l,J,Y,za,Ua,Qb){l=Gf.d(l);l.sort(function(Dd,hd){return J(hd)-J(Dd)});if(Ua){Ua=[];Qb=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?Qb?ze.a.Ih+1:ze.a.Qh+
1:Qb?ze.a.zy:ze.a.yv;for(var uc=0;uc<l.length;uc++){var ed=l[uc];Y(ed)<Qb&&(za(ed,Math.min(J(ed),Qb-1)),Ua.push(ed),Qb=Y(ed))}l=Ua}return l};Gb.prototype.fill=function(l,J,Y,za,Ua){function Qb(){return new rc(Dd,hd,za,Y)}var uc=this,ed=this.$;if(!ed.Dq([J],!0))return ig.Task.Ra(!0);var Dd=Gf.v(l,ed),hd=J?Gf.v(J,ed):Dd,Ke=this.$.na.va.hc();return af.a(this.$.userOperationManager,function(zf,Dg,Tg){uc.$.Oy();var Rg=uc.$.na.va,Yh=Rg.Na(9,Ke);Yh.sourceRange=Dd;Yh.targetRange=hd;Yh.fillDirection=Y;Yh.fillType=
za;return Td.i(Rg,"FillRange",Yh,zf,Dg,Tg,null,0)},function(zf){return new Wg.a(155,0,zf,void 0,Qb)},Ua)};Gb.prototype.H4h=function(l,J,Y){var za={ValidMembers:32};switch(l){case 1890566896:l=parseInt(J[kg.a.ld].toString(),10);if(14===l)return Y=new rh.a(2105621672,Y.method,Y.mode,Y.Xe,Y.tabName),J[kg.a.ld]=null,this.$.Ka.$b(Y,J),Cd.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;za.NumberFormat=l;break;case 1886928607:za.NumberFormat=
13;break;case -992833457:za.NumberFormat=11;break;case 218524921:za.NumberFormat=12;break;case 996232352:za.NumberFormat=1006;break;default:return Cd.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+Zg.b().ti(Y.command)),!1}Cd.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",Zg.b().ti(Y.command),J[kg.a.ld]);this.Sg.formatCells(1890566896,za,Y);this.$.Bf();return!0};Gb.prototype.l4h=function(l){var J=
this.gridView.mc(this.gridView.ha.ta.activeCell);if(this.Fb&&this.gridView.isEditing){J=this.gridView.kk.q4a(J?Hi.a(J).Font:null);if(!J)return Cd.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.ta.activeCell.toString()),!1;var Y=J.FontSize}else if(J)Y=J.fontSize;else return!1;J=l.command;var za=0;if(862890474===J)for(;za<Gb.$Ja.length-1&&Gb.$Ja[za]<=Y;)za++;else if(963349338===J)for(za=Gb.$Ja.length-
1;0<za&&Gb.$Ja[za]>=Y;)za--;Cd.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",Y,Gb.$Ja[za]);if(Y===Gb.$Ja[za])return!0;Y=Gb.pwc(2);Y.Font.FontSize=Gb.$Ja[za];this.Fb&&this.gridView.isEditing?(this.Bob(l,!1,Y),this.$.Bf()):this.Sg.formatCells(J,Y,l);return!0};Gb.prototype.J6e=function(l,J,Y){l=l[l[sh.a.IsFreeForm]?sh.a.Value:kg.a.Ag].toString();if(!Gb.O_i.test(l))return Cd.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),
We.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;l=parseFloat(l);if(8>l||72<l)return Cd.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits ({0} - {1}).",8,72),We.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var za=Math.round(2*l)/2,Ua=Gb.pwc(2);Ua.Font.FontSize=za;this.Fb&&this.gridView.isEditing?(this.Bob(J,Y,Ua,
!0),za===l||Y||this.$.Bf()):Y?this.Sg.qea(this.gridView,-1077965542,Ua,Y):(this.Sg.formatCells(-1077965542,Ua,J),this.o0a());return!0};Gb.prototype.H6e=function(l,J,Y){var za=l[kg.a.Ag];if(this.lu){var Ua=Xe.r8f?Xe.r8f[za]:null;Ua||(Cd.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for {0}",za),Ua=md.HelperMethods.Eea[za])}else Ua=md.HelperMethods.Eea[za];var Qb=0;this.Pm&&(l=l.MenuItemId,"MinorThemeFont"===l?(za==this.themesManager.ML.nrf&&
(Ua=za),Qb=2):"MajorThemeFont"===l&&(za==this.themesManager.ML.Mpf&&(Ua=za),Qb=1));if(!Ua)return!0;za=Gb.pwc(1);za.Font.FontName=Ua;this.Pm&&(za.Font.FontScheme=Qb);this.Fb&&this.gridView.isEditing?(this.Bob(J,Y,za),this.$.Bf()):Y?this.Sg.qea(this.gridView,-1293291468,za,Y):(this.Sg.formatCells(-1293291468,za,J),this.o0a());return!0};Gb.prototype.Ddc=function(l,J,Y,za){var Ua=-803000997===l||1688184685===l?"black":J.Color;this.moreColorsHelper&&(-1832800737===l?Ua=da.a.compare(Ua,"WindowText",!0)?
this.moreColorsHelper.xHb:"black":Y||(this.moreColorsHelper.xHb=Ua,this.moreColorsHelper.wda(J,Ua,za)));l=Gb.pwc(32);l.Font.FontColor=Gd.a.xH(Ua,Rh.a.xg(J,"IntColor"));this.Fb&&this.gridView.isEditing?this.Bob(za,Y,l,17===za.Xe):Y?this.Sg.qea(this.gridView,1970784898,l,Y):(this.cD&&(Y=this.getThemeColor(J),J=Y.themeColor,Y.returnValue&&(l.Font.ThemeFontColor=J,l.Font.ColorTypeOption=1)),this.Sg.formatCells(1970784898,l,za),this.o0a());return!0};Gb.prototype.D3h=function(l){var J=(new Date).format(748067091===
l?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),Y=this.gridView.Fj?Rk.a(this.gridView.$):this.gridView.rc;l=Y.textBox;if(this.gridView.isEditing)Y.insertText(J);else{var za=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeEditingModeAfterInsertDateOrTime",!1)?0:1;this.gridView.startEdit(!0,za);Y.text=J;J=J.length;l.VRa(J);l.caretPosition=J}};Gb.prototype.D4h=function(){this.gridView.U5(this.gridView.ha.ta.activeCell)||this.gridView.Lvc||this.gridView.YMa()||this.gridView.eu(this.gridView.ha.ta.activeCell,
3,Tk.a.S5e)};Gb.prototype.z3h=function(){if(!(this.gridView.Lvc||this.gridView.YMa()||this.gridView.isEditing&&Jj.a.isMac)){var l=this.gridView.ha.ta.W4;this.gridView.Eg(Gf.v(l,this.$),l,null,null,60,Tk.a.S5e)}};Gb.prototype.Y3h=function(l){var J=this;this.W$b=tf.d(this.$.xa.qa);var Y=this.$.da.Aa(254,!0);if(this.gridView.R6a)return this.gridView.rg.iH(!1),!!Y;if(!Y)return Cd.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.aZ(this.Bcd);
var za=String.format(oa.a.Uta,Hg.a.current.np(84));this.gridView.rg.No(za);l=new rh.a(-911352779,l.method,l.mode,l.Xe,l.tabName);za={};this.$.Ka.$b(l,(za[oa.a.silentClipboardAccessFailures]=!0,za[oa.a.isFormatPainter]=!0,za)).continueWith(function(Ua){(6>Ua.status||6===Ua.status&&!Ua.result)&&J.Gqb()});this.gridView.R6a=!0;Y.SGg(this.Gqb);return!0};Gb.prototype.bxb=function(l,J,Y,za){var Ua=87208751===l?"-1":J.Color;this.moreColorsHelper&&(1597684571===l?Ua=this.moreColorsHelper.nbb:Y||(this.moreColorsHelper.nbb=
Ua===Gb.notSet?Gb.IXd:Ua,this.moreColorsHelper.wda(J,Ua,za)));l={ValidMembers:64};l.FillColor=Gd.a.xH(Ua,Rh.a.xg(J,"IntColor"));Y?this.Sg.qea(this.gridView,1650812936,l,!0):(this.cD&&(Y=this.getThemeColor(J),J=Y.themeColor,Y.returnValue&&(l.ThemeFillColor=J,l.ColorTypeOption=1)),this.Sg.formatCells(1650812936,l,za),this.o0a());return!0};Gb.prototype.o4h=function(){Cd.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var l=this.$.da.Aa(221);
if(l){var J=this.gridView.kk;if(J){var Y=l.fdi(J.text,J.textBox.caretPosition);var za=Y.xsf;var Ua=Y.YUe;(Y=Y.returnValue)?(l.isListVisible=!1,J.text=Y,J.textBox.selectRange(za,za+Ua),Cd.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):Cd.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Cd.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Cd.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};Gb.prototype.X3h=function(l,J){var Y=0,za=this.gridView,Ua=Hi.a(za.mc(null));this.Fb&&za.isEditing&&(Ua.Font=za.kk.q4a(Ua.Font));var Qb=Ua.Font;Qb||(Qb={ValidMembers:0});switch(l){case -287251124:Y|=4;Dk.e(Qb,4)?Qb.Bold=!Qb.Bold:Qb.Bold=!0;break;case -1925065947:Y|=8;Dk.e(Qb,8)?Qb.Italic=
!Qb.Italic:Qb.Italic=!0;break;case 1764140053:Y|=16;Dk.e(Qb,16)?Qb.Underline=!Qb.Underline:Qb.Underline=!0;break;case -1685033574:Y|=64;Dk.e(Qb,64)?Qb.DoubleUnderline=!Qb.DoubleUnderline:Qb.DoubleUnderline=!0;break;case -1590502662:Y|=128,Dk.e(Qb,128)?Qb.Strikethrough=!Qb.Strikethrough:Qb.Strikethrough=!0}if(!Y)return!1;Qb.ValidMembers=Y;Ua.Font=Qb;Ua.ValidMembers=16;this.Fb&&this.gridView.isEditing?this.Bob(J,!1,Ua):(We.EwaSettings.ma(665)||za.rg.iH(!1),this.Sg.formatCells(l,Ua,J));this.$.Bf();return!0};
Gb.prototype.h3h=function(l,J){var Y=0,za=this.gridView,Ua=Hi.a(za.mc(null));-571165336===l||1041132226===l||-394785302===l?(Y|=1,Ua.VerticalAlignment=Rh.a.fo(Gb.AZa,l.toString(),2)):Gb.Mji(l)?(Y|=2,this.g4h(Ua,l)):-1116189897===l&&(Y|=8,Ua.Wrap=Ua.ValidMembers&8?!Ua.Wrap:!0);if(!Y)return!1;Ua.ValidMembers=Y;We.EwaSettings.ma(665)||za.rg.iH(!1);this.Sg.formatCells(l,Ua,J);this.$.Bf();return!0};Gb.prototype.g4h=function(l,J){!We.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==J&&(J=-1150205178===J?-286432209:-1150205178);J=Rh.a.fo(Gb.AZa,J.toString(),0);l.HorizontalAlignment=J===l.HorizontalAlignment?0:J};Gb.prototype.mKf=function(l,J,Y,za){var Ua=this,Qb=!1;We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Qb=this.Glc.Uqf(J,Y))&&Je.g(this.$).Ki.o1(this.m9a,Jh.BasicTelemetryCalculator.wR);return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.Faa(l,J,!1,Qb,function(uc){Ua.rPi(uc,Y,J,Qb,za)}):this.Faa(l,J,!1,Qb,function(uc,ed,Dd){Ua.tPi(uc,ed,Dd,Y,J,Qb,za)})};Gb.prototype.handleMergeCellsCommand=function(l,J){var Y=this;this.m9a=ji.a.create().toString();var za=null;za=this.Glc.Y0e();var Ua=Ii.a(J.command),Qb=this.Glc.Fhi(J.command,za),uc=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),ed=0;uc&&Qb?ed=Eb.a.Ae():Je.g(this.$).Ki.e8(4,this.m9a,Ua+", Scenario = "+za.scenario.toString());Ua=
l.ha.ta.selectedRanges;Cd.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",Zg.b().ti(J.command),Ua.length,Gf.i(Ua,",",this.$,!1));Ua=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);l.rg.iH(!1,Ua);if(10===Rh.a.fo(Gb.Wqf,J.command.toString(),10))return ig.Task.Ra(!1);var Dd=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Ua&&
Dd)return Qb?(uc?this.PSd(za,J,!0,!0,ed):this.PSd(za,J,!0),ig.Task.Ra(!0)):this.mKf(l,J,za,!1);var hd=!1;Ua&&(hd=this.Glc.Uqf(J,za))&&Je.g(this.$).Ki.o1(this.m9a,Jh.BasicTelemetryCalculator.wR);return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.Faa(l,J,!1,hd,function(Ke){Y.sPi(Ke,J,hd)}):this.Faa(l,J,!1,hd,function(Ke,zf,Dg){Y.uPi(Ke,zf,Dg,J,hd)})};Gb.prototype.Faa=function(l,J,Y,za,Ua){function Qb(Dg,Tg,Rg){Dd.$.Oy();
Dg=Ua?lf.b(Dg,Ua):Dg;Dg=lf.b(Dg,uc);return Td.f(Dd.$.na.va,Ke,zf,Y,Dg,Tg,Rg,null,hd)}function uc(Dg){var Tg=!!Dg&&!!Dg.RequestTelemetryData;Je.g(Dd.$).Ki.Ola(Dd.m9a,Dg.StateId,Tg?Dg.RequestTelemetryData.EcsOperationDuration:0,Tg?Dg.RequestTelemetryData.EcsRequestDuration:0,Tg?Dg.RequestTelemetryData.WfeRequestDuration:0)}function ed(){return new Od(Ke,zf)}var Dd=this;Ua=void 0===Ua?null:Ua;var hd=this.$.na.va.hc(),Ke=Rh.a.fo(Gb.Wqf,J.command.toString(),10),zf=Gf.r(l.ha.ta.selectedRanges,l.$);return za?
We.EwaSettings.qc()?af.a(this.$.userOperationManager,Qb,function(Dg){return new Wg.a(156,0,Dg,64,ed)},J):af.a(this.$.userOperationManager,Qb,function(Dg){return new Kd.a(156,0,Dg,void 0,ed)},J):af.a(this.$.userOperationManager,Qb,function(Dg){return new Wg.a(156,0,Dg,void 0,ed)},J)};Gb.prototype.PSd=function(l,J,Y,za,Ua){var Qb=this;za=void 0===za?!1:za;Ua=void 0===Ua?0:Ua;Cd.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",Y);var uc=Je.g(this.$).rtl,ed=
We.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");uc=wg.a.gd(3,2,0,uc?634:633,0,514846606,"MergeCellsLoseData");Pg.TaskExtensions.Ba(Bj.a(this.$).ui(uc),function(Dd){Dd=Dd.result;if(za){var hd=Eb.a.Ae()-Ua;Cd.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",hd,Dd)}0===Dd?(Cd.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Y?(za&&ed&&(Dd=Ii.a(J.command),Je.g(Qb.$).Ki.e8(4,
Qb.m9a,Dd+", Scenario = "+l.scenario.toString())),Qb.mKf(Je.g(Qb.$),J,l,!0)):Qb.Faa(Qb.gridView,J,!0,!1)):1===Dd&&Cd.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)};Gb.prototype.Mmf=function(l,J,Y,za){J!==l&&Cd.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",J,l,Y,za)};Gb.prototype.sPi=
function(l,J,Y){var za=this;Bh.b(l,514846606)&&(Cd.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Sk.a(this.$).rd.nE(514846606),l=Je.g(this.$).rtl,l=wg.a.gd(3,2,0,l?634:633,0,514846606,"MergeCellsLoseData"),Pg.TaskExtensions.Ba(Bj.a(this.$).ui(l),function(Ua){Ua=Ua.result;0===Ua?(Cd.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),za.Faa(za.gridView,J,!0,Y)):1===Ua&&Cd.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,
11))};Gb.prototype.uPi=function(l,J,Y,za,Ua){new kd(this,l,J,Y,za,Ua)};Gb.prototype.rPi=function(l,J,Y,za,Ua){var Qb=this,uc=!1;Bh.b(l,514846606)&&(uc=!0,Sk.a(this.$).rd.nE(514846606),za&&Ua?window.setTimeout(function(){Qb.Faa(Qb.gridView,Y,!0,!0)},0):this.PSd(J,Y,!1));this.Mmf(uc,Ua,J.scenario,za)};Gb.prototype.tPi=function(l,J,Y,za,Ua,Qb,uc){new Qc(this,l,J,Y,za,Ua,Qb,uc)};Gb.prototype.Tpb=function(l){var J=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(J&&
this.M_a!==l&&1461300262!==this.M_a){this.uUf(this.M_a);var Y=Zg.b().ti(l),za=Zg.b().ti(this.M_a);Cd.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",za,Y)}J&&(this.M_a=l);if(this.Fb&&this.gridView.isEditing)this.J_a||(this.J_a=this.gridView.kk.formattedText);else if(!this.$A){this.$A=[];J=this.gridView.naa("GridCommandHandler.CacheFontStyles",this.gridView.ha.ta.selectedRanges);try{for(J.$$rst();J.$$mn();){var Ua=
J.$$cu(),Qb=Ua.cell.hasRichText;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var uc=Zg.b().ti(l);Cd.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",uc,Qb,this.$A.length)}if(Qb)this.$A.push(de.PRg(Ua,Ua.cell.formattedText));else switch(l){case 673562736:case -446735083:this.$A.push(de.GZc(Ua,Ua.backgroundColor));We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Ua.backgroundColor&&Cd.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Ua.backgroundColor);break;case -128950598:case 1688184685:this.$A.push(de.GZc(Ua,Ua.color));We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ua.color&&Cd.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Ua.color);break;case 909774670:this.$A.push(de.QRg(Ua,
Ua.fontSize));if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var ed=rk.c(Ua.fontSize)?"null or undefined":Ua.fontSize.toString();Cd.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",ed)}break;case 324978188:this.Pm?this.$A.push(de.ORg(Ua,Ua.fontName,Ua.aba)):this.$A.push(de.GZc(Ua,Ua.fontName)),We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Ua.fontName?Cd.ULS.sendTraceTag(537159444,
0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Ua.fontName),Ua.fontName.length):Cd.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!Ua.fontName))}}}finally{J&&J.dispose()}}};Gb.prototype.aDj=function(){return this.Fb&&this.gridView.isEditing?!this.J_a:!this.$A};Gb.prototype.xgi=function(l){return!!this.$A&&this.$A.length>l&&!!this.$A[l].formattedText};
Gb.prototype.Lac=function(l){return this.$A[l].style};Gb.prototype.zLh=function(l){return this.$A[l].size};Gb.prototype.yLh=function(l){return this.$A[l].aba};Gb.prototype.uUf=function(l){if(this.aDj())We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Cd.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",l);else{if(this.Fb&&this.gridView.isEditing)We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(l=Zg.b().ti(l),Cd.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",l)),this.J_a&&(this.gridView.rc.formattedText=this.J_a);else for(var J=this.$A.length,Y=0;Y<J;Y++){var za,Ua=this.$A[Y].bKa.cell.getRange();if(za=this.gridView.mc(Ua)){Ua=void 0;var Qb=za.wF?this.gridView.ZJb(za.range):(Ua=new P.a,Ua.add(za),Ua);Ua=Cl(Qb);for(Qb=Ua.next();!Qb.done;Qb=Ua.next()){Qb=Qb.value;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var uc=
Zg.b().ti(l);Cd.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",uc,Qb.cell.hasRichText,Y,za.wF,J)}if(Qb.cell.hasRichText&&1457172838!==l)this.xgi(Y)&&(Qb.cell.formattedText=this.$A[Y].formattedText,We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Qb.cell.formattedText&&Cd.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));
else switch(l){case 1457172838:Qb.backgroundColor=this.Lac(Y);We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Qb.backgroundColor&&Cd.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!Qb.backgroundColor);break;case 2036397036:Qb.color=this.Lac(Y);We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Qb.color&&Cd.ULS.sendTraceTag(537159437,0,100,
"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!Qb.color);break;case -1904244080:Qb.fontSize=this.zLh(Y);We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Qb=rk.c(Qb.fontSize)?"null or undefined":Qb.fontSize.toString(),Cd.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",Qb));break;case -1428968098:uc=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),
this.Pm?(Qb.SKb(this.Lac(Y),uc,"RestoreCachedStyles"),Qb.o_f(this.yLh(Y))):Qb.SKb(this.Lac(Y),uc,"RestoreCachedStyles")}}}else Cd.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",Ua.qB(!1))}We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.M_a=1461300262);this.o0a()}};Gb.prototype.o0a=function(){this.Fb&&this.gridView.isEditing?this.J_a=null:this.$A=null;We.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
Cd.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};Gb.prototype.m4h=function(l,J){var Y={IndentationIncrease:0};if(-1942512156===l)Y.IndentationIncrease=1;else if(-1920201820===l)Y.IndentationIncrease=-1;else return!0;Y.ValidMembers=256;this.Sg.formatCells(l,Y,J);return!0};Gb.prototype.L4h=function(l,J){var Y=l;!Je.g(this.$).rtl||-1649235364!==l&&524773427!==l||(Y=-1649235364===l?524773427:-1649235364);switch(Y){case -1649235364:Y=ze.a.rotateTextUp45;break;
case 524773427:Y=ze.a.Luc;break;case 1886217042:Y=ze.a.rotateTextUp90;break;case 928057943:Y=ze.a.Nuc;break;case -1526602249:Y=ze.a.verticalText;break;default:return!1}var za={ValidMembers:512};za.TextOrientation=Y;this.Sg.formatCells(l,za,J);return!0};Gb.prototype.j4h=function(){var l=this,J=Je.g(this.$),Y=Gf.r(J.ha.ta.selectedRanges,this.$),za=Gf.o(J.ha.ta.activeCell,this.$);Cd.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return af.a(this.$.userOperationManager,
function(Ua,Qb,uc){return Td.L(l.$.na.va,za,Y,Ua,Qb,uc,null)},function(Ua){return new Wg.a(201,0,Ua)},null)};Gb.prototype.Y6e=function(l,J){var Y=null,za=Je.g(this.$).ha.ta.selectedRanges;za=this.gridView.naa("MoreColors",za,1,!0);try{for(za.$$rst();za.$$mn();){var Ua=za.$$cu().cell;if(Ua){var Qb=Gb.black;if(1970784898===l)Qb=Ua.color;else if(1650812936===l){var uc=Ua.backgroundColor;Qb=da.a.compare(uc,Gb.IXd,!0)&&da.a.compare(uc,Gb.empty,!0)?Ua.backgroundColor:Gb.white}if(!Y)Y=Qb;else if(Y!==Qb){Y=
Gb.black;break}}}}finally{za&&za.dispose()}this.Fb&&this.gridView.isEditing&&1970784898===l&&this.gridView.kk.textBox.Oue();return this.moreColorsHelper.Vxa(l,J,Y)};Gb.prototype.z4h=function(l){var J=hg.a.L4a(this.borderFormatManager.Z3);return this.moreColorsHelper.Vxa(-236759591,l,J)};Gb.prototype.Bob=function(l,J,Y,za){var Ua=this;za=void 0===za?!1:za;J?this.gridView.kk.oJf(Y.Font):(this.oxi(l),za?window.requestAnimationFrame(function(){Lk.FocusManager.instance().ek(Wi.AFrame.Qia);Ua.gridView.kk.bWe(Y.Font)}):
(Lk.FocusManager.instance().ek(Wi.AFrame.Qia),this.gridView.kk.bWe(Y.Font)),this.o0a())};Gb.prototype.oxi=function(l){var J=Ii.a(l.command);l=Oj.a[l.Xe]+"_"+hk.a[l.method];var Y=this.gridView.Ac.qye.toString(),za=new Map;za.set("Command",J);za.set("Source",l);za.set("Ribbon","React");za.set("CellTextRuns",Y);nj.Health.instance.recordKpiUsage($k.a.cFh,0,rl.a.UUf,za)};Gb.prototype.cjd=function(l,J,Y){l=this.borderFormatManager.cjd(l,J,Y);this.moreColorsHelper&&this.moreColorsHelper.wda(J,this.borderFormatManager.Z3,
Y);return l};Gb.prototype.getThemeColor=function(l){var J={};var Y=!1;if((l.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return Cd.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:J};Y=this.themesManager.getThemeColor(l.Color);l=Y.themeIndex;var za=Y.JBa;if(Y=Y.returnValue)J.ThemeColorIndex=l,J.ThemeColorRow=za}return{returnValue:Y,themeColor:J}};Gb.Mji=function(l){return-1150205178===l||-1142465846===
l||-286432209===l};Gb.pwc=function(l){var J={},Y={};J.ValidMembers=16;J.Font=Y;Y.ValidMembers=l;return J};Gb.n_e=function(l,J){var Y=l.top<J.top?3:l.bottom>J.bottom?0:-1;return Y=l.left<J.left?1:l.right>J.right?2:Y};Ck.Object.defineProperties(Gb.prototype,{Mhf:{configurable:!0,enumerable:!0,get:function(){return xh.a.all(this.gridView.ha.ta.selectedRanges,function(l){return l.isRow})}},Ghf:{configurable:!0,enumerable:!0,get:function(){return xh.a.all(this.gridView.ha.ta.selectedRanges,function(l){return l.ff})}},
themesManager:{configurable:!0,enumerable:!0,get:function(){this.Bx||(this.Bx=this.$.da.Aa(422));return this.Bx}}});Ck.Object.defineProperties(Gb,{O_i:{configurable:!0,enumerable:!0,get:function(){return Gb.Tee||(Gb.Tee=RegExp("^[0-9]+[.]?[0-9]*$"))}},hnd:{configurable:!0,enumerable:!0,get:function(){var l={};return Gb.C9d||(Gb.C9d=(l.InsertRows=5,l.InsertColumns=9,l.InsertCellsShiftRight=17,l.InsertCellsShiftDown=33,l.DeleteRows=6,l.DeleteColumns=10,l.DeleteCellsShiftLeft=18,l.DeleteCellsShiftUp=
34,l.DeleteRowsTable=6,l.DeleteColumnsTable=10,l.InsertRowsTable=5,l.InsertColumnsTable=9,l))}},AZa:{configurable:!0,enumerable:!0,get:function(){var l={};return Gb.khb||(Gb.khb=(l["-394785302"]=0,l["-571165336"]=2,l["1041132226"]=1,l["-1150205178"]=1,l["-1142465846"]=2,l["-286432209"]=3,l))}},Wqf:{configurable:!0,enumerable:!0,get:function(){var l={};return Gb.mce||(Gb.mce=(l["-167499203"]=2,l["-255094134"]=5,l["1097660126"]=6,l["155820588"]=7,l))}}});Gb.IXd="transparent";Gb.notSet="-1";Gb.black=
"#000000";Gb.empty="";Gb.white="#FFFFFF";Gb.C9d=null;Gb.khb=null;Gb.mce=null;Gb.Tee=null;Gb.$Ja=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(Vd.a)(Gb,"GridCommandHandler",null,[424]);var Eg=Sf.a;Am(qd,Eg);qd.prototype.Nd=function(){var l=this;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var J=Hf.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ub),Y=Hf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),za=Hf.GetServiceTaskFactory.create(this.$.da,
397,this.la,this.ub),Ua=Hf.GetServiceTaskFactory.Ua(this.$.da,296,468,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([J,Y,za,Ua],this.la),function(){l.Dd([new Gb(l.$,Je.g(l.$),Y.result,J.result,Ua.result,za.result,new Xe(l.$))])},this.la,3)}else{var Qb=Hf.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ub),uc=Hf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),ed=Hf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),Dd=Hf.GetServiceTaskFactory.create(this.$.da,397,this.la,
this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([Qb,uc,ed,Dd],this.la),function(){l.Dd([new Gb(l.$,Je.g(l.$),uc.result,Qb.result,new Nj.BorderFormatManager(l.$,uc.result,ed.result),Dd.result,new Xe(l.$))])},this.la,3)}};qd.ka=function(l){Sf.a.he(80,new qd(l))};Object(Vd.a)(qd,"GridCommandHandlerFactory",Sf.a,[]);var tk=b(31),Zi=b(215),Uk=b(1255);nd.prototype.dispose=function(){var l=this;this.deactivate();this.gridView&&(this.tableManager.sRf(this.WBf),this.gridView.lcj(this.nzf),this.gridView.mcj(this.ozf),
this.$.xa.Vg(this.He),this.$.Hb.Vg(this.He),this.wse(function(J){J.GKd(l.zLa)}));this.gridView=this.tableManager=this.dha=null};nd.prototype.OAc=function(l,J,Y,za){if(!tf.b(this.$.qa)||this.$.ea.isNamedObjectViewMode||this.gridView.rb.QTa)return!0;if(!Y.length)return!1;var Ua=za.length;if(za[Ua-1]<l.left)return!1;var Qb=md.HelperMethods.Lx(new Zi.a(za),0,Ua,l.left,md.HelperMethods.gD);if(0>Qb)return!1;var uc=l.x$f,ed=!!l.G_a&&0<l.G_a.length,Dd=!!l.menuModel&&0<l.menuModel.length,hd=Qb,Ke=0;for(Ua=
Math.min(uc.length+Qb,Ua);hd<Ua;hd++,Ke++)if(Qb=Y[hd],!We.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||Qb){var zf=null,Dg=Qb.getElementsByClassName(tk.a.J$c);Dg&&(zf=Dg[0]);if(zf&&zf.innerText){if(Dg=Qb.getElementsByClassName(tk.a.cqe))for(var Tg=Dg.length-1;0<=Tg;Tg--)Qb.removeChild(Dg[Tg]);Dg=za[hd];J?(zf.innerText=uc[Ke],Qb.classList.add(tk.a.HRe),ed&&l.G_a[Ke]&&(zf=document.createElement("div"),zf.innerHTML=l.G_a[Ke],Dd&&l.menuModel[Ke]&&this.qCg(l,Ke,
Dg),Qb.appendChild(zf.firstChild))):(Qb.classList.remove(tk.a.HRe),zf.textContent=sg.Range.XU(Dg),this.Tih(Dg))}}l.YSa=J;return!0};nd.prototype.qCg=function(l,J,Y){this.$.da.$a(8,function(za){za.f$b.FNi(l,J,Y)})};nd.prototype.Tih=function(l){this.$.da.$a(8,function(J){J.f$b.GNi(l)})};nd.prototype.c6f=function(l,J,Y,za){for(var Ua=!1,Qb=this.B0h(l,J),uc=this.dha.length-1;0<=uc;uc--){var ed=this.dha[uc];J>=ed.left&&l<=ed.right&&(this.OAc(ed,!1,Y,za),Array.removeAt(this.dha,uc),Ua=!0)}l=0;for(J=Qb.length;l<
J;l++)this.OAc(Qb[l],!0,Y,za)&&(this.dha.push(Qb[l]),Ua=!0);return Ua};nd.prototype.activate=function(){this.ke()&&!this.active&&(this.gridView.view.Ts(this.Ww),this.active=!0)};nd.prototype.deactivate=function(){this.active&&(this.gridView.view.Yq(this.Ww),this.active=!1)};nd.prototype.ke=function(){return tf.b(this.$.qa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.rb.oP&&0<this.tableManager.rangeList.length};nd.prototype.wse=function(l){var J=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",
!1)?this.gridView.Lpc:[this.gridView.L3];J=Cl(J);for(var Y=J.next();!Y.done;Y=J.next()){Y=Cl(Y.value);for(var za=Y.next();!za.done;za=Y.next()){za=Cl(za.value);for(var Ua=za.next();!Ua.done;Ua=za.next())l(Ua.value)}}};nd.prototype.B0h=function(l,J){var Y=[];if(!this.active)return Y;this.MNa=this.gridView.bid();for(var za=this.tableManager.rangeList.length-1;0<=za;za--){var Ua=this.tableManager.rangeList[za];Ua.bottom>=this.MNa&&this.aid(Ua)<=this.MNa&&Ua.left>=l&&Ua.right<=J&&Ua.yba&&Y.push(Ua)}return Y};
nd.prototype.aid=function(l){var J=this.gridView.Rb.Qj(l);return J&&this.tableManager.Oef(l,J.usedRange.topLeft)?l.top+1:l.top};Object(Vd.a)(nd,"HeaderSnappingFeature",null,[2]);var Mk=Og.a;Am(Ac,Mk);Ac.prototype.create=function(){var l=this,J=Hf.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([J],this.la),function(){l.Eb(l.$.da.Aa(68)||new nd(J.result,Je.g(l.$)))},this.la,11)};Ac.ka=function(l){l.da.Ga(67,new Ac(l))};Object(Vd.a)(Ac,"HeaderSnappingFactory",
Og.a,[]);var fl=b(1306),jj=b(1107),gl=Og.a;Am(dc,gl);dc.prototype.create=function(){var l=this,J=this.$.da,Y=Hf.GetServiceTaskFactory.create(J,134,this.la,this.ub),za=Hf.GetServiceTaskFactory.Ua(J,213,214,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([Y,za],this.la),function(){if(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1))l.Eb(Object(jj.a)(l.$.da,1,function(){var Qb=new fl.CellAutoCompleteControl(l.$,Y.result);za.result.ka(Qb);return Qb}));else{var Ua=J.Aa(1);
Ua||(Ua=new fl.CellAutoCompleteControl(l.$,Y.result),za.result.ka(Ua));l.Eb(Ua)}},this.la,3)};dc.ka=function(l){l.da.Ga(151,new dc(l))};Object(Vd.a)(dc,"CellAutoCompleteControlFactory",Og.a,[]);bb.prototype.dispose=function(){this.GYd();this.f_a=null};bb.prototype.ka=function(l){l&&(this.f_a=l,l.NZb(this.bCf),l.j3(this.cCf),l.aGg(this.dCf))};bb.prototype.GYd=function(){this.f_a&&(this.f_a.ntc(this.bCf),this.f_a.Jda(this.cCf),this.f_a.wcj(this.dCf))};Object(Vd.a)(bb,"CellAutoCompleteReadoutHandler",
null,[654,2]);var tj=Og.a;Am(Ca,tj);Ca.prototype.create=function(){var l=this,J=this.$.da;Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(J,211,212,this.ub),function(Y){if(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1))l.Eb(Object(jj.a)(J,213,function(){return new bb(Y.result,J)}));else{var za=J.Aa(213)||new bb(Y.result,J);l.Eb(za)}},this.la,3)};Ca.ka=function(l){l.da.Ga(214,new Ca(l))};Object(Vd.a)(Ca,"CellAutoCompleteReadoutHandlerFactory",Og.a,[]);Jc.Xoh="ewa-dv";
Jc.Yoh="ewa-dv-buttonarea";Jc.eoh="ewa-dlb";Jc.eCb="list-table";Jc.listItem="list-item";Jc.$Bb="list-item-selected";Jc.fCb="list-table-touch";Jc.Woh="ewa-dpb";Jc.hjh="dv-prompt-title";Jc.gjh="dv-prompt-message";Object(Vd.a)(Jc,"CssClassNames",null,[]);var Kk=b(563),uk=b(48),Fk=b(458),Ak=b(1032),ek=be.ErrorDialog;Am(Ed,ek);Ed.prototype.dispose=function(){Je.g(this.$).ha.cG(this.kd);ek.prototype.dispose.call(this)};Ed.prototype.setFocus=function(){switch(this.error.Severity){case 0:var l=4;break;case 1:l=
3;break;case 2:l=0;break;default:l=this.closeAction}(l=this.getButton(l))?l.get_element().focus():ek.prototype.setFocus.call(this)};Ed.prototype.$qb=function(){var l=Je.g(this.$);l.isEditing&&l.rc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.BUd(1);if(2===this.returnValue||0===this.returnValue){var J=l.mc(null);if(J){l.Ea.mW();var Y=Object(tg.a)(new Fi.a,{Text:J.originalText});l.setCell(Y,J.range,0,63,null)}this.$.Zd(-798660877,kg.a.Vb,8,null)}ek.prototype.$qb.call(this)};
Ed.prototype.Vsa=function(){var l=Je.g(this.$);l.isEditing&&l.rc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.BUd(0);ek.prototype.Vsa.call(this)};Ed.prototype.BUd=function(l){var J=Je.g(this.$);Pg.TaskExtensions.Ba(J.startEdit(!1,l),function(){var Y=J.rc.textBox;Y.text&&Y.selectRange(0,Y.text.length)},this.la,11,Cf.a.current)};Ed.jR=function(l,J,Y){Y=J.da.Aa(14).e4a(Y);l.MessageId=-1083021405;l.MessageIdName="DataValidationError";l.MessageIdHash=
hg.a.sw(l.MessageIdName);l.Severity=Y?Y.t9c:1;J=(null===Y||void 0===Y?0:Y.pJa)?hg.a.Sf(Y.pJa):null;Y=(null===Y||void 0===Y?0:Y.error)?hg.a.Sf(Y.error):String.format("<p>{0}</p><p>{1}</p>",se.a.instance.fa(887),se.a.instance.fa(888));switch(l.Severity){case 0:l.Appearance=18;break;case 1:l.Appearance=12;Y+=String.format("<p>{0}</p>",se.a.instance.fa(889));break;default:l.Appearance=3}l.Caption=J;l.Description=Y;l.HelpDescription=se.a.instance.fa(1286);l.HelpTopicId=Ak.a.aHe;return l};Object(Vd.a)(Ed,
"DataValidationErrorDeprecatedDialog",be.ErrorDialog,[]);var ml=b(196),hl=b(178),wj=zk.a;Am(Fc,wj);Fc.prototype.dispose=function(){this===this.zb.$p&&(this.zb.$p=null);hh.a.Ha(this.Gm);this.Gm=null;wj.prototype.dispose.call(this)};Fc.prototype.uqj=function(){this.dv&&this.dv.error?this.errorMessage=this.dv.error:this.dv&&this.dv.options&1?(Cd.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=se.a.instance.fa(1699),
this.T8e=Hg.a.current.np(96)):(this.errorMessage=se.a.instance.fa(1698),this.bOh(this.gNe));var l=this.dv?this.dv.t9c:1,J={};this.MQ=(J[Fc.ay]=this.Cc,J.errorDescription=this.errorMessage,J.helpImageUri=this.T8e,J);switch(l){case 0:this.jc=1;this.Bc(1,"Retry");this.MQ.dialogIcon=2;this.phf=!0;break;case 1:this.jc=4;this.MQ.dialogIcon=1;this.MQ.additionalInformation=se.a.instance.fa(889);break;default:this.jc=1,this.MQ.dialogIcon=3}l={};this.MQ.helpLink=(l.type="AppLinkProps",l[Fc.ay]=this.error.HelpTopicId,
l.text=se.a.instance.fa(1286),l.handler=this.f$a,l);l=wg.a.vXc([this.error]);J={};this.zV=(J[oa.a.R9b]=!0,J[oa.a.Had]=l,J[oa.a.Iad]=hl.a(this.$).Ctb(this.error.MessageIdHash),J[oa.a.HV]=this.Cc,J.DismissHandler=this.iBd,J);l={};this.MQ.giveFeedbackLink=(l.type="AppLinkProps",l[Fc.ay]=oa.a.Jid,l.text=se.a.instance.fa(1735),l.handler=this.yNi,l)};Fc.prototype.bOh=function(l){var J=this.$.na.va.hc();Td.u(this.$.na.va,Gf.q(l,this.$),lf.b(this.YLi),lf.a(this.XLi),null,J)};Fc.prototype.eYh=function(l){switch(l.RuleType){case 1:switch(l.ConditionType){case 0:var J=
se.a.instance.Ab(108);return String.format(J,l.LowerBoundary,l.UpperBoundary);case 1:return J=se.a.instance.Ab(109),String.format(J,l.LowerBoundary,l.UpperBoundary);case 2:return J=se.a.instance.Ab(110),String.format(J,l.LowerBoundary);case 3:return J=se.a.instance.Ab(111),String.format(J,l.LowerBoundary);case 4:return J=se.a.instance.Ab(112),String.format(J,l.LowerBoundary);case 5:return J=se.a.instance.Ab(113),String.format(J,l.UpperBoundary);case 6:return J=se.a.instance.Ab(114),String.format(J,
l.LowerBoundary);case 7:return J=se.a.instance.Ab(115),String.format(J,l.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(l.ConditionType){case 0:return J=se.a.instance.Ab(116),String.format(J,l.LowerBoundary,l.UpperBoundary);case 1:return J=se.a.instance.Ab(117),String.format(J,l.LowerBoundary,l.UpperBoundary);case 2:return J=se.a.instance.Ab(118),String.format(J,l.LowerBoundary);case 3:return J=se.a.instance.Ab(119),String.format(J,l.LowerBoundary);case 4:return J=se.a.instance.Ab(120),
String.format(J,l.LowerBoundary);case 5:return J=se.a.instance.Ab(121),String.format(J,l.UpperBoundary);case 6:return J=se.a.instance.Ab(122),String.format(J,l.LowerBoundary);case 7:return J=se.a.instance.Ab(123),String.format(J,l.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(l.ConditionType){case 0:return J=se.a.instance.Ab(124),String.format(J,l.LowerBoundary,l.UpperBoundary);case 1:return J=se.a.instance.Ab(125),String.format(J,l.LowerBoundary,l.UpperBoundary);case 2:return J=
se.a.instance.Ab(126),String.format(J,l.LowerBoundary);case 3:return J=se.a.instance.Ab(127),String.format(J,l.LowerBoundary);case 4:return J=se.a.instance.Ab(128),String.format(J,l.LowerBoundary);case 5:return J=se.a.instance.Ab(129),String.format(J,l.UpperBoundary);case 6:return J=se.a.instance.Ab(130),String.format(J,l.LowerBoundary);case 7:return J=se.a.instance.Ab(131),String.format(J,l.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(l.ConditionType){case 0:return J=
se.a.instance.Ab(132),String.format(J,l.LowerBoundary,l.UpperBoundary);case 1:return J=se.a.instance.Ab(133),String.format(J,l.LowerBoundary,l.UpperBoundary);case 2:return J=se.a.instance.Ab(134),String.format(J,l.LowerBoundary);case 3:return J=se.a.instance.Ab(135),String.format(J,l.LowerBoundary);case 4:return J=se.a.instance.Ab(136),String.format(J,l.LowerBoundary);case 5:return J=se.a.instance.Ab(137),String.format(J,l.UpperBoundary);case 6:return J=se.a.instance.Ab(138),String.format(J,l.LowerBoundary);
case 7:return J=se.a.instance.Ab(139),String.format(J,l.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(l.ConditionType){case 0:return J=se.a.instance.Ab(140),String.format(J,l.LowerBoundary,l.UpperBoundary);case 1:return J=se.a.instance.Ab(141),String.format(J,l.LowerBoundary,l.UpperBoundary);case 2:return J=se.a.instance.Ab(142),String.format(J,l.LowerBoundary);case 3:return J=se.a.instance.Ab(143),String.format(J,l.LowerBoundary);case 4:return J=se.a.instance.Ab(144),String.format(J,
l.LowerBoundary);case 5:return J=se.a.instance.Ab(145),String.format(J,l.UpperBoundary);case 6:return J=se.a.instance.Ab(146),String.format(J,l.LowerBoundary);case 7:return J=se.a.instance.Ab(147),String.format(J,l.UpperBoundary);default:return"we couldn't get the details"}case 3:return J=se.a.instance.Ab(106),String.format(J,l.LowerBoundary);case 7:return J=se.a.instance.Ab(107),String.format(J,l.LowerBoundary);default:return"we couldn't get the details"}};Fc.prototype.BUd=function(l){var J=Je.g(this.$);
Pg.TaskExtensions.Ba(J.startEdit(!1,l),function(){var Y=J.rc.textBox;Y.text&&Y.selectRange(0,Y.text.length)},this.la,11,Cf.a.current)};Fc.jR=function(l,J,Y){J=J.da.Aa(14).e4a(Y);l.MessageId=-1083021405;l.MessageIdName="DataValidationError";l.MessageIdHash=hg.a.sw(l.MessageIdName);l.Severity=J?J.t9c:1;l.HelpDescription=se.a.instance.fa(1286);l.HelpTopicId=Ak.a.aHe;return l};Ck.Object.defineProperties(Fc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},
la:{configurable:!0,enumerable:!0,get:function(){this.Gm=this.Gm||new ml.a;return this.Gm.token}}});Object(Vd.a)(Fc,"DataValidationErrorDialog",zk.a,[475,474,2,416]);var Nk=b(1114),Ai=b(406),vk=Nk.a;Am(Gc,vk);Gc.prototype.dispose=function(){this.dataValidationControl=null;vk.prototype.dispose.call(this)};Gc.prototype.Wh=function(l,J){this.dataValidationControl.Ya=this.Ya;var Y=l.keyCode;return 1461300262!==J||16!==Y&&17!==Y&&18!==Y?vk.prototype.Wh.call(this,l,J):!1};Gc.prototype.nAd=function(){this.qW&&
(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.NR,!0,!0,Jj.a.xp||3===kg.a.Vb))};Gc.prototype.Ng=function(){};Gc.prototype.gj=function(){this.dataValidationControl.show(this.dataValidationControl.NR,!0,!0,Jj.a.xp||3===kg.a.Vb)};Gc.prototype.NGd=function(l,J){return this.dataValidationControl.Wh(J)};Ck.Object.defineProperties(Gc.prototype,{kzb:{configurable:!0,enumerable:!0,get:function(){return Object(ag.a)(Fc,this.$.zb.nh)}},qW:{configurable:!0,enumerable:!0,
get:function(){return this.dataValidationControl.isListVisible},set:function(l){this.dataValidationControl.isListVisible=l}},f6a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Ai.a.V5c}}});Object(Vd.a)(Gc,"DataValidationListAutoCompleteBehavior",Nk.a,[]);var Ok=b(1047),Vk=b(1113),al=Ok.a;Am(zb,al);zb.prototype.dispose=function(){al.prototype.dispose.call(this);this.dCb=this.fmb=null};zb.prototype.Rea=function(l,J,Y,za){if(l&&(!l||
l.length)){this.j8(!1);this.zIa=l;this.FW=[];for(var Ua=0;Ua<l.length;Ua++)this.FW[Ua]=l[Ua]?l[Ua].Name:null;Ua=String.format("<table class='{0}' aria-live='polite'><tbody>",this.rca);var Qb="",uc="";l=0;var ed=Je.g(this.$).mc(null);za=this.isEditing?za?za.text:this.editText:ed?ed.originalText:null;ed=!za;var Dd=0;Array.clear(this.PFb);var hd=[],Ke=[],zf=[],Dg=za?za.split(" "):[""];za=za.trim();for(var Tg={},Rg=0;Rg<this.FW.length;Tg={wEc:Tg.wEc},Rg++){var Yh=this.FW[Rg],Li=void 0;Tg.wEc=Yh.split(" ");
Li=xh.a.all(Dg,function(zj){return function(Nf){return xh.a.any(zj.wEc,function(jh){return da.a.FL(jh,Nf)})}}(Tg));var Mh=!Yh,Uj=Array.contains(zf,Yh);Mh||Uj||this.isEditing&&!Li||(Li=Yh?hg.a.Sf(hg.a.n8b(Yh)):"",Li=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.W_,Li),zf.push(Yh),this.isEditing&&da.a.FL(Yh,za)?(Qb+=Li,hd.push(Rg)):(uc+=Li,Ke.push(Rg)),!ed&&da.a.equals(za,Yh,!0)&&(l=this.isEditing?hd.length-1:Dd,ed=!0),Dd++)}this.aOa=Dd;Array.addRange(this.PFb,hd);Array.addRange(this.PFb,
Ke);this.dg.innerHTML=Ua+(Qb+uc+"</tbody></table>");Ua=this.Un=id.DOMElementExtensions.Cj(this.domElement,this.rca);this.Knb(Ua,J);this.j8(!0);this.osa(J,Y);this.Vk=0<this.aOa?Ua.rows[l]:null}};zb.prototype.WRa=function(l){var J=!1;this.isEditing&&l&&(J=!this.aOa,l.endEdit(J,"DataValidationListBox.SetCellContent",0));if(!J&&(l=Je.g(this.$),J=l.mc(null))){var Y=null;this.bea&&-1!==this.bea.SheetId&&-1!==this.bea.Row&&-1!==this.bea.Column&&(Y={},Y.SheetName=this.bea.SheetId.toString(),Y.FirstRow=this.bea.Row,
Y.FirstColumn=this.bea.Column,Y={ParameterType:6,SourceRange:Y});var za=Object(tg.a)(new Fi.a,{Text:this.we});l.setCell(za,J.range,0,63,Y)}return!0};zb.prototype.osa=function(l,J){var Y=l?this.SCb:this.kI;l=l?this.kkc:this.lkc;0>=this.aOa?this.dg.style.height=md.HelperMethods.nc(l):(this.dg.style.height="auto",this.aOa>Y?(id.DOMElementExtensions.bJ(this.dg,this.SRj?Math.floor(l*Y):Math.floor(this.dg.offsetHeight*Y/this.aOa)),this.dg.style.overflowY="auto"):(this.dg.style.height="auto",this.dg.style.overflowY=
"hidden"));id.DOMElementExtensions.Jr(this.dg,J);id.DOMElementExtensions.Jr(this.Un,J-(this.aOa>Y?ej.a.zu:0))};Ck.Object.defineProperties(zb.prototype,{Vk:{configurable:!0,enumerable:!0,get:function(){return this.fmb},set:function(l){this.PBa(this.fmb);if(l){this.fmb=l;this.dCb.innerText="";this.PBa(this.fmb);var J=this.PFb[l.rowIndex];this.we=this.FW[J];this.zIa&&(this.bea=this.zIa[J],Cd.ULS.shipAssertTag(537163286,0,!this.PFb.length||!!this.bea,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));
this.dCb.innerText=this.we;this.rvc(l)}else this.bea=this.we=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return Je.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return Je.g(this.$).rc.text}}});Object(Vd.a)(zb,"DataValidationListBox",Ok.a,[]);var il=b(250),Bk=b(109),ik=b(179),Wk=Si.a;Am(hb,Wk);hb.prototype.JVc=function(l){this.get_events().addHandler("ClickButton",l)};hb.prototype.XJd=function(l){this.get_events().removeHandler("ClickButton",l)};hb.prototype.UVc=
function(l){this.get_events().addHandler("KeyDown",l)};hb.prototype.iKd=function(l){this.get_events().removeHandler("KeyDown",l)};hb.prototype.WZb=function(l){this.get_events().addHandler("PointerOver",l)};hb.prototype.tKd=function(l){this.get_events().removeHandler("PointerOver",l)};hb.prototype.VZb=function(l){this.get_events().addHandler("PointerOut",l)};hb.prototype.sKd=function(l){this.get_events().removeHandler("PointerOut",l)};hb.prototype.Pnb=function(l){this.get_events().addHandler("Blur",
l)};hb.prototype.kIb=function(l){this.get_events().removeHandler("Blur",l)};hb.prototype.l$=function(l){this.get_events().addHandler("Focus",l)};hb.prototype.Ida=function(l){this.get_events().removeHandler("Focus",l)};hb.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(Kk.a.FZ),this.domElement.style.cursor="",zi.a.instance.pa(Bg.a.click,this.domElement,this.vd),Bk.KeyInputManager.instance.pa(Bg.a.Xb,this.domElement,this.onKeyDown),ik.a.instance.pa(Bg.a.pointerOver,this.domElement,
this.Vw),ik.a.instance.pa(Bg.a.pointerOut,this.domElement,this.dO),this.Fc.wn("blur")||this.Fc.ka("blur",this.onBlur),this.Fc.wn("focus")||this.Fc.ka("focus",this.onFocus),this.domElement.title=this.glh,this.El=!0)};hb.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(Kk.a.FZ),this.domElement.style.cursor="",this.isEnabled&&(zi.a.instance.za(Bg.a.click,this.domElement,this.vd),Bk.KeyInputManager.instance.za(Bg.a.Xb,this.domElement,this.onKeyDown),ik.a.instance.za(Bg.a.pointerOver,
this.domElement,this.Vw),ik.a.instance.za(Bg.a.pointerOut,this.domElement,this.dO)),this.domElement.title=this.jgh,this.El=!1)};hb.prototype.dispose=function(){this.isEnabled&&(zi.a.instance.za(Bg.a.click,this.domElement,this.vd),Bk.KeyInputManager.instance.za(Bg.a.Xb,this.domElement,this.onKeyDown),ik.a.instance.za(Bg.a.pointerOver,this.domElement,this.Vw),ik.a.instance.za(Bg.a.pointerOut,this.domElement,this.dO),this.El=!1);id.DOMElementExtensions.setVisible(this.domElement,!1);Wk.prototype.dispose.call(this)};
hb.Bb=function(l,J,Y,za,Ua,Qb,uc,ed){l.removeAttribute("Href");l.setAttribute(oa.a.Rd,oa.a.Us);l.className=J;l.tabIndex=ed;J=document.createElement("span");J.className=uc;J.classList.add(Y);J.tabIndex=-1;l.appendChild(J);l=document.createElement("img");l.src=Hg.a.Se(za);l.className=Ua;l.alt=Qb;l.tabIndex=-1;J.appendChild(l);return l};Ck.Object.defineProperties(hb.prototype,{yl:{configurable:!0,enumerable:!0,get:function(){return this.oJ}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.El}}});
Object(Vd.a)(hb,"ListButton",Si.a,[678,2]);var Ah="<p class='"+Jc.hjh+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",Pk="<p class='"+Jc.gjh+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",Qk=D.a.fOe,bl=D.a.fOe,X=D.a.DZg,Ba=Si.a;Am(Ib,Ba);Ib.prototype.dispose=function(){this.$&&(this.NMb(!1),this.gridView.ha.tO(this.Rh),this.gridView.gx(this.onContentReady),this.gridView.Ac.Ubj(this.xxf),this.$.sm(this.Zc));this.pFe(!1);this.qFe(!1);hh.a.yc(this.h6b);this.h6b=this.Qsa=
this.dg=this.C0=this.iJ=this.gridView=this.$=null;Ba.prototype.dispose.call(this)};Ib.prototype.E7c=function(l){return!!this.e4a(l)};Ib.prototype.Grb=function(l,J){return We.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new Fc(this.$,l,J):new Ed(this.$,l,J)};Ib.prototype.e4a=function(l){l=this.gridView.getRangeInformation(l);for(var J=0;J<l.length;J++){var Y=l[J];if(Object(ag.a)(Fk.DataValidationRange,Y))return Y}return null};Ib.prototype.eKh=function(){if(!this.t5a)return"";
var l=this.n8e?String.format("{0} {1}",this.dv.CKf,this.dv.prompt):"",J=this.sxb?se.a.instance.fa(835):"";return String.format(se.a.instance.Ab(17),l,J)};Ib.prototype.Wh=function(l){var J=!1;if(this.isListVisible||(-569786022===l||541421805===l)&&this.sxb||1872288872===l&&this.NR)switch(l){case -569786022:case 541421805:this.show(this.NR,!this.isListVisible,!0,Jj.a.xp||3===kg.a.Vb);J=!0;break;case 1872288872:this.isListVisible?(this.show(this.NR,!1,!0,!1),J=!0):this.NR?(this.show(!1,!1,!0,!1),J=!0):
this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),J=!0);break;case -798660877:this.$h.CB(1);J=!0;break;case 137938150:this.$h.CB(-1);J=!0;break;case 2091832999:this.$h.CB(this.$h.kI-1);J=!0;break;case 742457698:this.$h.CB(-(this.$h.kI-1));J=!0;break;case 125627505:case 267796030:J=this.WRa()}return J};Ib.prototype.show=function(l,J,Y,za){this.ny();if(this.NAb&&this.t5a){var Ua=this.YOa;if(Ua){if(l||J||Y)this.isVisible=!0;Sg.d(this.style,this.isGridRtl);Y&&this.sxb&&(this.qFe(!0),
this.Vdg(Ua,!1));J&&this.sxb&&this.JSa(za,Ua);l&&this.n8e&&this.VBj(Ua);this.Yoi||(this.isVisible=!1)}}};Ib.prototype.Ova=function(l,J){if(!J||!J.cell.Yj)return null;var Y=this.gridView.Ac.textBox.domElement;var za=0<id.DOMElementExtensions.getHeight(Y)&&0<id.DOMElementExtensions.getWidth(Y)&&0<=Y.offsetTop&&0<=Y.offsetLeft;if(za)Y=id.DOMElementExtensions.Ova(Y,l.Oj);else{Y=l.getCellBounds(J.cell);var Ua=id.DOMElementExtensions.getBoundingClientRect(l.Oj);Y=new Sys.UI.Bounds(Y.x-Ua.x,Y.y-Ua.y,Y.width,
Y.height)}if(Y)if(za)2<Y.height&&2<Y.height&&(Y.x+=1,Y.y+=1,Y.height-=2,Y.width-=2);else if(za=Je.g(this.$).fK(J.cell))za=za.width+1,Ua=da.a.equals(il.a.d4a(J.cell,l.rtl),"right",!0),l.rtl&&Ua&&(Y.x=Y.x+Y.width-za),J.kla&&l.rtl===Ua&&(Y.width=za);else return null;return Y};Ib.prototype.$3f=function(l){var J=this.t5a;this.NMb(J);J?this.show(!0,l,!0,!1):this.ny()};Ib.prototype.WRa=function(){var l=!1;this.isListVisible&&(l=this.$h.WRa(this.Ya),this.show(this.NR,!1,!0,!1));return l};Ib.prototype.ny=
function(){this.Ihi?(this.isListVisible&&(this.isListVisible=!1),this.tMa&&(this.tMa=!1),this.NR&&(this.NR=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.tMa=this.NR=this.isVisible=!1;this.cqd=this.iod=this.Uqd=!1};Ib.prototype.JSa=function(l,J){this.sxb&&!this.dv.zIa?this.tMa&&this.Ph.disable():(this.pFe(!0),this.$h.Rea(this.dv.zIa,l,this.mTh(J),this.Ya),this.fCa(J,!1))};Ib.prototype.VBj=function(l){this.dv.prompt&&(this.NR=!0,this.DTj(this.dv.CKf,this.dv.prompt),this.qeg(l,!1))};
Ib.prototype.Vdg=function(l,J){var Y=l.y;this.Qsa.style.top=md.HelperMethods.nc(Y);l=this.isGridRtl?l.x-this.Qsa.offsetWidth+1:l.x+l.width+1;this.Qsa.style.left=md.HelperMethods.nc(l);J?this.tMa=this.gridView.djc(new uk.a(l,Y))&&this.iod:this.iod=!0};Ib.prototype.fCa=function(l,J){var Y=l.y+l.height;l=this.isGridRtl?l.x+l.width-this.dg.offsetWidth:l.x;this.dg.style.top=md.HelperMethods.nc(Y);this.dg.style.left=md.HelperMethods.nc(l);J?this.isListVisible=this.gridView.djc(new uk.a(l,Y))&&this.cqd:
this.cqd=!0};Ib.prototype.qeg=function(l,J){var Y=l.y+l.height+5,za=this.activeCell;za=za?za.width/2:32;l=this.isGridRtl?l.x-this.C0.offsetWidth+za:l.x+l.width-za;this.C0.style.top=md.HelperMethods.nc(Y);this.C0.style.left=md.HelperMethods.nc(l);J?this.NR=this.gridView.djc(new uk.a(l,Y))&&this.Uqd:this.Uqd=!0};Ib.prototype.DTj=function(l,J){if(J){var Y="";l&&(Y+=String.format(Ah,hg.a.Sf(l)));Y+=String.format(Pk,hg.a.Sf(J));this.C0.innerHTML=Y;l=id.DOMElementExtensions.Cj(this.C0,"dv-prompt-titletext");
if(J=id.DOMElementExtensions.Cj(this.C0,"dv-prompt-messagetext"))for(l=l?parseInt(String(Math.max(l.offsetWidth,J.offsetWidth)),10):J.offsetWidth,l+=6,id.DOMElementExtensions.Jr(this.C0,l),J=0,Y=this.C0.children.length;J<Y;J++)id.DOMElementExtensions.Jr(this.C0.children[J],l)}};Ib.prototype.mTh=function(l){return this.Jhi?l.width+17-2+1:l.width+this.Qsa.clientWidth-2+1};Ib.prototype.qFe=function(l){this.$&&!this.NAb||!l?(this.c8f(!1),hh.a.Ha(this.Ph),this.Ph=null):(this.Ph||(this.Ph=new hb(this.Qsa,
Qk,Kk.a.Fia,1,bl,se.a.instance.fa(886),X,se.a.instance.fa(885),"",-1),this.c8f(!0)),this.tMa=!0,this.dv.zIa?this.Ph.isEnabled||this.Ph.enable():this.Ph.disable())};Ib.prototype.pFe=function(l){this.$&&!this.NAb||!l?(this.oTa(!1),hh.a.Ha(this.$h),this.$h=null):(this.$h||(this.$h=new zb(this.$,this.dg,this.dCb),this.oTa(!0)),this.isListVisible=!0)};Ib.prototype.oTa=function(l){this.$h&&(l&&!this.ZR?(this.$h.l$(this.TAd),this.$h.JZb(this.ULa),this.$h.gob(this.eza),this.ZR=!0):!l&&this.ZR&&(this.$h.Ida(this.TAd),
this.$h.ktc(this.ULa),this.$h.CIb(this.eza),this.ZR=!1))};Ib.prototype.NMb=function(l){l&&!this.qR?(this.gridView.view.Ts(this.ot),this.qR=!0):!l&&this.qR&&(this.gridView.view.Yq(this.ot),this.qR=!1)};Ib.prototype.c8f=function(l){this.Ph&&(l&&!this.u1b?(this.Ph.JVc(this.mPa),this.Ph.UVc(this.mPa),this.Ph.Pnb(this.ULa),this.u1b=!0):!l&&this.u1b&&(this.Ph.XJd(this.mPa),this.Ph.iKd(this.mPa),this.Ph.kIb(this.ULa),this.u1b=!1))};Ib.prototype.eeg=function(){if(this.t5a){var l=this.YOa;l&&(this.Vdg(l,!0),
this.fCa(l,!0),this.qeg(l,!0))}};Ck.Object.defineProperties(Ib.prototype,{NAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Pd&16)}},Yoi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.NR||this.tMa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return id.DOMElementExtensions.isVisible(this.dg)},set:function(l){id.DOMElementExtensions.setVisible(this.dg,l)}},NR:{configurable:!0,enumerable:!0,get:function(){return id.DOMElementExtensions.isVisible(this.C0)},
set:function(l){id.DOMElementExtensions.setVisible(this.C0,l)}},tMa:{configurable:!0,enumerable:!0,get:function(){return id.DOMElementExtensions.isVisible(this.Qsa)&&!!this.Ph&&id.DOMElementExtensions.isVisible(this.Ph.domElement)},set:function(l){id.DOMElementExtensions.setVisible(this.Qsa,l);this.Ph&&id.DOMElementExtensions.setVisible(this.Ph.domElement,l)}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.iJ},set:function(l){this.iJ=l}},t5a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&
this.E7c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.mc(null)}},n8e:{configurable:!0,enumerable:!0,get:function(){return this.t5a&&!!this.dv&&!!(this.dv.options&2)&&!!this.dv.prompt}},sxb:{configurable:!0,enumerable:!0,get:function(){return this.t5a&&!!this.dv&&!!(this.dv.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},dv:{configurable:!0,enumerable:!0,get:function(){return this.e4a(this.activeCell.range)}},
YOa:{configurable:!0,enumerable:!0,get:function(){var l=this.activeCell;return l?this.Ova(this.gridView,l):null}}});Object(Vd.a)(Ib,"DataValidationControl",Si.a,[653,2]);var fb=Og.a;Am(nb,fb);nb.prototype.create=function(){this.Eb(this.$.da.Aa(14)||new Ib(this.$))};Object(Vd.a)(nb,"DataValidationControlFactory",Og.a,[]);Cb.W$c="!";Cb.ZFf="[";Cb.YFf="]";Cb.openParen="(";Cb.closeParen=")";Cb.uhg=" /.(*\\".split("");Cb.e8b="...";Cb.$Fb="param_help_link";Cb.XDd="param_help_udf";Cb.cdd="function_list_box";
Cb.vGh="function_param_box";Cb.edd="function_reader_description";Cb.Xcd="function_description_box";Cb.GWe="function_param_table";Cb.nXi="param_row_";Cb.YDd="param_set";Cb.EGf="param_row_0";Cb.FGf="param_row_1";Cb.wGh="<div id='{0}' class='{1}'></div>";Cb.uGh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";Cb.GGf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
Cb.rGh="<div id='{0}' class='{1} {2} {3}'></div>";Cb.oGh="<div id='{0}' class='{1} {2} {3} {4}'></div>";Cb.llf="[@";Cb.y4g=1;Cb.x4g=3;Cb.zdh=500;Cb.Dqf=50;Object(Vd.a)(Cb,"FormulaAssistanceConstants",null,[]);var Vb=b(369),xc;(function(l){l.CategoryList="categoryList";l.FunctionsMap="functionsMap";l.FunctionIdsToDisplay="functionIdsToDisplay";l.RefreshListCallback="refreshListCallback";l.HelpCallback="helpCallback";l.InitialCategory="initialCategory";l.AllCategoryName="allFunctionsCategoryName"})(xc||
(xc={}));Object(Vd.b)("PropsKeys",xc);var bd=zk.a;Am(La,bd);La.prototype.jh=function(){this.functionInfoManager.A2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.jc=1;this.functionInfoManager.E_?this.yaf():this.functionInfoManager.fZa(this.onFunctionInfoLoaded)};La.prototype.yaf=function(){var l;this.F_b=this.functionInfoManager.hac.filter(this.jgf);var J=null!==(l=La.ckf)&&void 0!==l?l:La.P0g;l=this.functionInfoManager.Wcd;var Y=this.functionInfoManager.Fbc(J).map(function(Ua){return Ua.FunctionIndex}),
za={};this.MQ=(za[La.ay]=this.Cc,za[xc.CategoryList]=l,za[xc.FunctionsMap]=this.p7g(),za[xc.FunctionIdsToDisplay]=Y,za[xc.RefreshListCallback]=this.$Ni.bind(this),za[xc.HelpCallback]=this.dwb,za[xc.InitialCategory]=J,za[xc.AllCategoryName]=La.AllCategoryName,za);this.initializeAndShow(this.Im,this.BWe,this.MQ)};La.prototype.p7g=function(){var l={};this.F_b.forEach(function(J){l[J.FunctionIndex]=J});return l};La.prototype.ORj=function(l){l=l.map(function(J){return J.FunctionIndex});this.MQ[xc.FunctionIdsToDisplay]=
l;this.tOb(this.Im,this.Ccc(this.BWe),this.MQ)};La.prototype.$Ni=function(l,J){J?J=this.KBh(J):(J=this.functionInfoManager.Fbc(l).filter(this.jgf),La.ckf=l);this.ORj(J)};La.prototype.KBh=function(l){l=void 0===l?"":l;l=l.toLocaleLowerCase();var J=this.F_b.filter(function(Y){return Y.NameUI.toLocaleLowerCase().startsWith(l)});3<=l.length&&(J.push.apply(J,Dl(this.F_b.filter(function(Y){return Y.NameUI.toLocaleLowerCase().includes(l)&&!J.includes(Y)}))),J.push.apply(J,Dl(this.F_b.filter(function(Y){return Y.Help.toLocaleLowerCase().includes(l)&&
!J.includes(Y)}))));return J};Ck.Object.defineProperties(La.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}}});La.AllCategoryName=se.a.instance.fa(1012);La.P0g=se.a.instance.fa(1011);La.ckf=void 0;Object(Vd.a)(La,"FunctionDialog",zk.a,[]);var $c=b(71),Pc=b(229),Hc=$c.a.Joh,Jd=$c.a.aOe,Qd=$c.a.bOe,Be=$c.a.N9c,mf=$c.a.Loh,xf=$c.a.Poh,lg=$c.a.XNe,ng=$c.a.eOe,Gh=$c.a.Noh,Kh=$c.a.YNe,Ih=Vh.a;Am(ua,Ih);ua.prototype.initialize=function(){this.Qb.classList.add($c.a.Hoh);
this.Qb.innerHTML=ua.kH();this.Ne||(this.fl(),this.e3());Ih.prototype.initialize.call(this);var l=id.DOMElementExtensions.Cj(this.Qb,Kh);this.rtl&&(l.align="right",this.bvb.style.marginLeft="5px");this.Ne&&(l.style.padding="1px");this.functionInfoManager.A2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};ua.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.Nbb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.Fk(this.qd));hh.a.yc([this.e2b,this.y6,
this.Jxb,this.iKa,this.cvb]);Ih.prototype.dispose.call(this)};ua.prototype.fl=function(){this.jKa=id.DOMElementExtensions.Cj(this.Qb,Hc);this.Gja=id.DOMElementExtensions.Cj(this.Qb,Jd);this.jKa.setAttribute(oa.a.Rd,oa.a.j0b);this.iKa=new sj.a(this.jKa,!0);this.cvb=new sj.a(this.Gja,!0);this.EWe=id.DOMElementExtensions.Cj(this.Qb,xf);this.bvb=id.DOMElementExtensions.Cj(this.Qb,mf);this.IWe=id.DOMElementExtensions.Cj(this.Qb,ng);this.qmf=id.DOMElementExtensions.Cj(this.Qb,Gh);this.FWe=$get(ua.Ycd,this.Qb);
this.Fja=id.DOMElementExtensions.Cj(this.Qb,lg);this.Ne&&(this.Fja.style.paddingLeft="1px");this.functionInfoManager.fZa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.gk(this.qd)};ua.prototype.tR=function(l){var J=this;this.$.da.$a(40,function(){J.iKa.tR(l)})};ua.prototype.um=function(){this.Ecd?this.formulaAssistanceManager.j7c():this.formulaAssistanceControl.set_visible(!1);Ih.prototype.um.call(this);this.tkd||(this.getButton(0).get_element().disabled=!0)};ua.prototype.setFocus=function(){!this.jKa.disabled&&
this.tkd&&id.DOMElementExtensions.setFocus(this.jKa)};ua.prototype.commit=function(){return!0};ua.prototype.$qb=function(){var l=this,J=this.qaa.NameDataStrings;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var Y=new rh.a(-433697611,0,this.$.fd,8,null),za={};za=(za[kg.a.ld]=J,za);this.$.Ka.$b(Y,za)}else{J+=Cb.openParen;Y=Je.g(this.$);Y.view.visibleArea.contains(Y.qg(null))||Y.eu(Y.ha.ta.activeCell,3,Tk.a.pGh);var Ua=this.eJa.textBox;if(this.eJa.isEditing&&this.eJa.text){za=
this.eJa.text;var Qb=this.a0c?za.substring(0,this.a0c):"=";this.eJa.text=Qb+J+za.substring(this.a0c+(Ua.Iv?Ua.Iv.length:0),za.length);Ua.caretPosition=Qb.length+J.length}else Pg.TaskExtensions.Ba(Y.startEdit(!0,1),function(){l.eJa.text="="+J;var uc=J.length+1;Ua.VRa(uc);Ua.caretPosition=uc},this.la,11,Cf.a.current);Y.Fj&&(Y=Y.rc,Y.text=Ua.text,Y.setCaretPosition(Ua.caretPosition));(Y=this.eJa.iZ.get(Ai.a.H3a))&&Y.VU(!1)}};ua.prototype.Vsa=function(){this.Ecd?this.formulaAssistanceManager.Pda():this.formulaAssistanceControl.Sob()};
ua.prototype.mva=function(l){this.cvb.clear();for(var J=ua.Ycd+" "+ua.zWe,Y=0,za=l.length;Y<za;++Y){var Ua=this.cvb.tM(l[Y].NameUI,l[Y].FunctionIndex.toString(),!1);Jj.a.vv&&Ua.classList.add(Be);Ua.setAttribute(oa.a.wE,ua.AWe);Ua.setAttribute(oa.a.XG,J)}this.cvb.selectedIndex=0};ua.prototype.DZf=function(){if(this.qaa){this.bvb.parentNode.className=$c.a.YNe+(this.functionInfoManager.$gc(this.qaa)?"-udf":"");var l=this.qaa.NameDataStrings;this.IWe.innerText=l;this.bvb.innerText=l;this.Fja.innerText=
this.qaa.Help;l=this.qaa.Params.split(Cb.W$c);this.FWe.innerText=Cb.openParen+(1<l.length?Cb.e8b:l[0])+Cb.closeParen}};ua.kH=function(){return String.format("<div class='"+$c.a.Ioh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Ni.a.wo+"'>{1}</div>\r\n<div class='"+$c.a.WNe+"'>\r\n\t<select id='{16}' class='{17} "+D.a.gq+" "+D.a.lm+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+$c.a.Moh+
"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+D.a.gq+"'>\r\n\t\t\t<span class='"+D.a.Wr+" "+$c.a.Ooh+"'>\r\n\t\t\t\t<img title='{3}' class='"+D.a.wvh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",se.a.instance.fa(1015),se.a.instance.fa(1016),se.a.instance.fa(733),se.a.instance.Ab(3),
Hg.a.Se(13),se.a.instance.fa(1017),ua.nGh,ua.Ycd,7,Hc,mf,xf,lg,ng,Gh,Kh,ua.sGh,Jd+(Jj.a.vv?" "+Qd:""),ua.zWe,ua.AWe)};Ck.Object.defineProperties(ua.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDeprecatedDialog"}},qaa:{configurable:!0,enumerable:!0,get:function(){if(!this.Gja||!this.Gja.firstChild)return null;var l=Number.parseInvariant(this.Gja.children[this.Gja.selectedIndex].value);return this.functionInfoManager.bRh(l)}}});ua.Ycd="function_dialog_param_string";ua.zWe=
"function_dialog_function_description";ua.AWe="function_dialog_function_name";ua.sGh="function_list";ua.nGh="function_category";Object(Vd.a)(ua,"FunctionDeprecatedDialog",Vh.a,[]);ba.prototype.$c=function(l,J){if(!We.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(J){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return l=
Je.g(this.$).kk,l.f6a||!l.isEditing||0>=l.text.length?!1:!0;default:return!1}};ba.prototype.executeCommand=function(l,J,Y){J=J.command;l=Je.g(this.$);var za=l.kk;switch(J){case 753860909:case -2060563418:l.inRangePicker&&za.eH(!1);this.create(za);this.formulaAssistanceManager&&this.formulaAssistanceTelemetryManager.Zcd.dialogShownCounter++;break;case -433697611:this.formulaAssistanceManager&&this.formulaAssistanceTelemetryManager.Zcd.dialogCommitedCounter++;var Ua=Y[kg.a.ld]+Cb.openParen;Y.UILocation&&
this.$.Zd(-1075437823,-1,0,null);l.view.visibleArea.contains(l.qg(null))||l.eu(l.ha.ta.activeCell,3,Tk.a.qFh);var Qb=za.textBox;Y=za.textBox.caretPosition;if(za.isEditing&&za.text){J=za.text;var uc=Y?J.substring(0,Y):"=";za.text=uc+Ua+J.substring(Y+(Qb.Iv?Qb.Iv.length:0),J.length);Qb.caretPosition=uc.length+Ua.length}else Pg.TaskExtensions.Ba(l.startEdit(!0,1),function(){za.text="="+Ua;var ed=Ua.length+1;Qb.VRa(ed);Qb.caretPosition=ed},this.$.la,11,Cf.a.current);l.Fj&&(l=l.rc,l.text=Qb.text,l.setCaretPosition(Qb.caretPosition));
this.uB?this.formulaAssistanceManager.Pda():(l=za.iZ.get(Ai.a.H3a),null===l||void 0===l?void 0:l.VU(!1))}return ig.Task.Ra(!0)};ba.prototype.Kc=function(l,J){switch(J.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};ba.prototype.nHh=function(l,J){J=this.Sa.Zp(J);var Y=this.Sa.Pc(),za=this.functionInfoManager.Fbc(l);if(!za)return Cd.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),J.sC();for(var Ua=0;Ua<
za.length;++Ua){var Qb=za[Ua].NameUI,uc=this.Sa.zQ(280,"Formulas."+l+"MenuItem_"+za[Ua].FunctionIndex.toString(),-433697611,null,1,"None",0,0,Qb,!1,0);uc.label=Qb;var ed=za[Ua].Params.split(Cb.W$c);uc.WS(Qb+" "+(Cb.openParen+(1<ed.length?Cb.e8b:ed[0])+Cb.closeParen)+"\n"+za[Ua].Help);Y.buttons.push(uc)}l=this.Sa.Pc();za=this.Sa.zQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,D.a.CRe,3,"Image16by16",1014,0,"Formulas.MoreFunctionsMenuItem",!1,0);l.buttons.push(za);J.Dc.push(Y);J.Dc.push(l);return J.sC()};
ba.prototype.jd=function(l,J,Y){l=this.aRh(J);if(-1===l)return!1;this.menuId=Y.MenuId;if(!this.functionInfoManager.E_)return this.functionInfoManager.A2a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;l=this.functionInfoManager.Wcd[l];this.CM[l]=this.CM[l]||this.nHh(l,Y.MenuId);Y.MenuItems=this.CM[l];return!0};ba.prototype.create=function(l){og.a.egf(this.$)?(this.formulaAssistanceManager.j7c(),new La(this.$)):(new ua(this.$,l)).kf()};ba.prototype.aRh=function(l){switch(l){case "PopulateFinancialFnsMenu":return 2;
case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(Vd.a)(ba,"FormulaAssistanceCommandHandler",null,[424]);var fj=Sf.a;Am(K,fj);K.prototype.Nd=function(){var l=
this,J=Hf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),Y=Hf.GetServiceTaskFactory.create(this.$.da,153,this.la,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([J,Y],this.la),function(){l.Dd([new ba(l.$,J.result,Y.result)])},this.la,3)};K.ka=function(l){Sf.a.he(92,new K(l))};Object(Vd.a)(K,"FormulaAssistanceCommandHandlerFactory",Sf.a,[]);$a.prototype.dispose=function(){this.GYd();this.kKa=this.gva=this.Bja=null};$a.prototype.aYc=function(l){l&&(this.Bja=l,this.Bja.soe(this.eCf),
this.Bja.fpe(this.gCf),this.Swa&&this.Bja.epe(this.fCf))};$a.prototype.bYc=function(l){l&&(this.gva=l,this.Swa&&(this.gva.qoe(this.ryf),this.gva.ooe(this.kyf)),this.gva.poe(this.nyf))};$a.prototype.cYc=function(l){l&&(this.kKa=l,this.kKa.hWc(this.hCf),this.kKa.NZb(this.aCf))};$a.prototype.GYd=function(){var l,J,Y;this.Bja&&(this.Bja.aRf(this.eCf),this.Bja.wRf(this.gCf),this.Swa&&this.Bja.vRf(this.fCf));this.kKa&&(this.kKa.wKd(this.hCf),this.kKa.ntc(this.aCf));this.Swa&&(null===(l=this.gva)||void 0===
l?void 0:l.$Qf(this.ryf),null===(J=this.gva)||void 0===J?void 0:J.YQf(this.kyf));null===(Y=this.gva)||void 0===Y?void 0:Y.ZQf(this.nyf)};$a.prototype.A6i=function(l,J){if(J){var Y="";this.Swa||(Y+=se.a.instance.Ab(57)+this.ariaLiveNotifier.eya);for(var za=0;za<J.length;za++)Y+=l+this.ariaLiveNotifier.eya+this.FZc(J[za])+$a.bFd(za,J.length);this.Swa&&(Y+=se.a.instance.fa(874)+this.ariaLiveNotifier.eya);this.ariaLiveNotifier.readText(Y)}};$a.prototype.z6i=function(l,J,Y){if(l){var za="",Ua=0;if(J){for(var Qb=
0;Qb<J.length;Qb++)if(Y>=l[Qb].split(this.$.listSeparator).length)Ua++;else{var uc=J[Qb].trim();if(!uc)return;uc=this.FZc(uc);var ed=$a.bFd(Qb-Ua,J.length-Ua);za+=uc+ed;ed&&(za+=this.ariaLiveNotifier.eya)}this.ariaLiveNotifier.readText(za)}}};$a.prototype.FZc=function(l){if(!l)return"";var J=l.split(this.$.listSeparator);l="";J=Cl(J);for(var Y=J.next();!Y.done;Y=J.next()){var za=Y.value;$a.cpd(za)?l+=za:(za=(Y=$a.rli(za))?za.replace("[","").replace("]",""):za,l+=String.format(Y?se.a.instance.Ab(59):
se.a.instance.Ab(58),za));l+=this.ariaLiveNotifier.eya}return l};$a.bFd=function(l,J){return l>=J||1===J?(Cd.ULS.shipAssertTag(537161997,0,l<J,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(se.a.instance.Ab(55),l+1,J)+"\r\n"};$a.cpd=function(l){return da.a.contains(l,Cb.e8b,!0)};$a.rli=function(l){return l.trimStart().startsWith(Cb.ZFf)||l.trimEnd().endsWith(Cb.YFf)};Object(Vd.a)($a,"FormulaAssistanceReadoutHandler",null,[737,2]);var Oi=Og.a;Am(mb,
Oi);mb.prototype.create=function(){var l=this,J=this.$.da;Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(J,211,212,this.ub),function(Y){Y=J.Aa(219)||new $a(Y.result,l.$);l.Eb(Y)},this.la,3)};mb.ka=function(l){l.da.Ga(220,new mb(l))};Object(Vd.a)(mb,"FormulaAssistanceReadoutHandlerFactory",Og.a,[]);var gi=b(737),oj=b(112),$i=b(1198);cd.prototype.Ihd=function(l){return this.iRa&&l in this.iRa?this.iRa[l]:null};cd.prototype.A7f=function(l,J){this.iRa||(this.iRa={});this.iRa[l]=J};cd.prototype.v_=function(){this.iRa=
null};Object(Vd.a)(cd,"FormulaAssistanceContextualPreviewCache",null,[]);Fb.prototype.dispose=function(){this.Od||(this.$&&(this.$.ea.bG(this.mD),this.$=null),this.$ha=this.mGb=null,this.Od=!0)};Fb.prototype.xed=function(l,J,Y,za){var Ua=this;if(J&&0>=J.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!l)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var Qb="="+J.substring(Y.start,Y.end);We.EwaSettings.ma(603)&&(Qb=this.calcManager.ZZh(Je.g(this.$).ha.ta.activeCell,l,Y));var uc=this.fNh(Qb,Y);if(We.EwaSettings.ma(603)){if(uc&&!this.calcManager.isFormulaSubExpressionVolatile(l))return Promise.resolve(uc)}else if(uc)return Promise.resolve(uc);return this.hNh(Qb,Y).then(function(ed){if(Ua.J0c(za))throw Error.create("OperationCanceledException");if(!ed||ed.qij||ed.rna.startsWith("##UNSUPPORTED:"))return Ua.hZe(J,Qb,Y,za);Ua.$ha.A7f(Qb,ed.rna);return Promise.resolve(ed)})};
Fb.prototype.fNh=function(l,J){return(l=this.$ha.Ihd(l))?new $i.a(l,J.start,J.end,0):null};Fb.prototype.hNh=function(l,J){if(!l||0>=l.length||!J)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.VTg(Je.g(this.$).ha.ta.activeCell,l,this.bAi,J)};Fb.prototype.hZe=function(l,J,Y,za){var Ua=this;if(!l||0>=l.length||!J||0>=J.length||!Y)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.zPa)return this.gNh(l,J,Y,za);var Qb={};Qb.PartialFormula=J;Qb.Formula=l;Qb.SourceRange=Gf.v(Je.g(this.$).ha.ta.activeCell,this.$);return this.zPa=new Promise(function(uc,ed){Ua.mGb=new gi.a;Ua.vTf=Ua.$.ea.af;Ua.kab=hc(Ua.$.na.va,Qb,function(Dd){Ua.eVi(J,Y,za,Dd,uc,ed)},function(Dd){Ua.zPa=null;Ua.kab=null;ed(Dd)},null,null,null);Ua.mGb.token.R(function(){Ua.yVg(ed)})})};Fb.prototype.eVi=function(l,J,Y,za,Ua,Qb){this.kab=this.zPa=null;if(this.vTf!==this.$.ea.af)Qb(Error.create("OperationCanceledException"));
else if(za.Result)if(za=je.a.oi(za.Result),!za||oj.a.isEmpty(za))Ua(null);else{for(var uc in za)this.$ha.A7f(uc,za[uc]);this.J0c(Y)?Qb(Error.create("OperationCanceledException")):(l=this.$ha.Ihd(l))?(""===l&&(l=" "),Ua(new $i.a(l,J.start,J.end,0))):Qb(Error.create("SubexpressionNotFoundException"))}else Ua(null)};Fb.prototype.gNh=function(l,J,Y,za){var Ua=this;return new Promise(function(Qb,uc){Ua.zPa.then(function(){Ua.hUf(l,J,Y,za,Qb,uc)}).catch(function(){Ua.hUf(l,J,Y,za,Qb,uc)})})};Fb.prototype.hUf=
function(l,J,Y,za,Ua,Qb){if(this.J0c(za))Qb(Error.create("OperationCanceledException"));else{var uc=this.$ha.Ihd(J);uc?Ua(new $i.a(uc,Y.start,Y.end,0)):this.hZe(l,J,Y,za).then(function(ed){Ua(ed)}).catch(function(ed){Qb(ed)})}};Fb.prototype.yVg=function(l){this.kab&&(Xg.a.Fu(this.kab.Qt)?(this.zPa=this.kab=null,l(Error.create("PendingWebReqeuestCancelled"))):Cd.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};Fb.prototype.v_=function(){this.zVg();this.$ha&&this.$ha.v_()};
Fb.prototype.zVg=function(){this.mGb&&this.mGb.C()};Fb.prototype.J0c=function(l){return this.Od||l.xK};Object(Vd.a)(Fb,"FormulaAssistanceContextualPreviewCalculator",null,[2]);var Rj=b(220);Cc.wph="ewa-facp-text-box";Object(Vd.a)(Cc,"CssClassNames",null,[]);Tb.prototype.dispose=function(){(this.haa||this.yQ)&&this.d9e();this.Ya=this.Qqa=null};Tb.prototype.ARj=function(l,J,Y,za){l&&J&&za&&J.rna&&!(1>J.rna.length)&&(this.Ya=l,this.fQf(),this.J2a=J,this.qTa=za,this.iAj(J,Y,za))};Tb.prototype.d9e=function(){this.B7h();
this.fQf();this.qTa=this.J2a=null};Tb.prototype.iAj=function(l,J,Y){var za=this;if(l.rna&&!(1>l.rna.length)){var Ua=this.Rc.da.Aa(266);if(Ua){var Qb=Ua.nTh();Qb&&Pg.TaskExtensions.Ba(this.jCb,function(){if(J)if(We.EwaSettings.ma(603)&&za.Ya.isEditing&&0<Y.length){za.Uxb(l.eKa,Y[0].start,null);var uc=za.b4e(Y[0],Qb),ed=za.Ya.text.substring(Y[0].start,Y[0].end).trim();ed=za.Ya.text.indexOf(ed);ed=za.Ya.text.substring(0,ed).lastIndexOf("\n");za.Uxb(0>ed||1>=Y.length?Y[0].start:ed+1,Y[0].end,uc?String.format(uc,
.3):null);for(var Dd=1;Dd<Y.length;Dd++)uc=za.b4e(Y[Dd],Qb),ed=za.Ya.text.substring(Y[Dd].start,Y[Dd].end).trim(),ed=za.Ya.text.indexOf(ed),ed=za.Ya.text.substring(Y[Dd-1].end,ed).lastIndexOf("\n"),za.Uxb(0>ed?Y[Dd-1].end:ed+1+Y[Dd-1].end,Y[Dd].end,uc?String.format(uc,.3):null);ed=za.Ya.text.substring(Y[Y.length-1].end,l.iva).indexOf("\n");za.Uxb(0>ed?Y[Y.length-1].end:ed+1+Y[Y.length-1].end,l.iva,null);Cd.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else za.Uxb(l.eKa,
l.iva,null),Cd.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");za.haa||(za.haa=document.createElement(Rj.a.div),za.Ya.textBox.domElement.appendChild(za.haa));za.yQ||(za.yQ=document.createElement(Rj.a.div),za.yQ.className=Cc.wph,za.Rc.domElement.appendChild(za.yQ));uc=l.iva;We.EwaSettings.ma(603)&&za.Ya.isEditing&&Y&&0<Y.length&&Y[0].start<uc&&Y[0].start!==l.eKa&&!za.Ya.textBox.Iv.length&&
(uc=Y[0].start);Dd=da.a.contains(za.Ya.textBox.lf.id,"FormulaBar",!0)&&da.a.contains(za.Ya.text.substring(l.eKa,l.iva),"\n",!0);ed=za.Ya.isEditing?za.Ya.textBox.caretPosition:0;uc=excelOnline.utils.getBoundingRectForText(za.Ya.textBox.lf,Dd?ed:l.eKa,Dd?ed:uc,We.EwaSettings.ma(603));za.yQ.style.left=md.HelperMethods.nc(uc.left);za.yQ.style.top=md.HelperMethods.nc(uc.top);za.yQ.style.width=md.HelperMethods.nc(uc.width);za.yQ.style.height=md.HelperMethods.nc(uc.height);uc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
l.iva,l.iva);dialogControls.renderToolTip(za.haa,uc,l.rna,za.yQ,0,!1,!1,1)},this.Rc.la,3)}}};Tb.prototype.b4e=function(l,J){var Y=this.Ya.text,za=Y.substring(l.start,l.end);za=za.trim();l=Y.indexOf(za,l.start);J=Y.indexOf(J,l);za=Y.substring(l,J);za=za.trim();return this.Ya.colors.getItem(l+"-"+(l+za.length))};Tb.prototype.B7h=function(){var l=this;this.Ya&&this.haa&&this.yQ&&Pg.TaskExtensions.Ba(this.jCb,function(){l.Ya.textBox.domElement.contains(l.haa)&&(dialogControls.clearToolTip(l.haa),l.Ya.textBox.domElement.removeChild(l.haa),
l.haa=null);l.Rc.domElement.contains(l.yQ)&&(l.Rc.domElement.removeChild(l.yQ),l.yQ=null)},this.Rc.la,3)};Tb.prototype.Uxb=function(l,J,Y){if(this.Ya&&!(l>=J)){var za={};this.Ya.textBox.formatText(l,J-l,(za.background=Y||"#E3DDCC",za));this.dkd=!0}};Tb.prototype.fQf=function(){if(this.Ya&&this.J2a&&this.dkd){var l=this.J2a.iva;We.EwaSettings.ma(603)&&0<this.qTa.length&&this.qTa[this.qTa.length-1].end>l&&(l=this.qTa[this.qTa.length-1].end);var J={};this.Ya.textBox.formatText(this.J2a.eKa,l-this.J2a.eKa,
(J.background=!1,J));this.dkd=!1}};Ck.Object.defineProperties(Tb.prototype,{jCb:{configurable:!0,enumerable:!0,get:function(){var l=this;if(this.Qqa)return this.Qqa;var J=new Zh.a;this.Rc.WC(function(Y){Pg.TaskExtensions.Ba(Y.wud(),function(){J.setResult(!0)},l.Rc.la,3)});return this.Qqa=J.task}}});Object(Vd.a)(Tb,"FormulaAssistanceContextualPreviewControl",null,[2]);var pj=b(47),mh=b(44);Sa.prototype.X3f=function(l,J,Y){Y?this.u6g(l,J,Y):this.p6e(l,J,Y,!0)};Sa.prototype.Zgj=function(){this.p8=0};
Sa.prototype.u6g=function(l,J,Y){var za=this;this.p8++;var Ua=this.p8;pj.a.instance.create(function(){za.p6e(l,J,Y,Ua===za.p8)},500,mh.a.rFh,!0,!0)};Sa.prototype.p6e=function(l,J,Y,za){var Ua=this,Qb=this.Dcd.xed(l,J);Qb&&Qb.then(function(uc){za&&Ua.Dcd.Npd(J)&&Ua.Dcd.zRj(l,uc,Y)}).catch(function(uc){uc=Object(S.a)(Error,uc);"OperationCanceledException"===uc.message?Cd.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",uc):Cd.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",uc)})};Object(Vd.a)(Sa,"FormulaAssistanceContextualPreviewHoverManager",null,[]);xb.prototype.dispose=function(){this.I_c();hh.a.yc([this.Tub,this.X$b]);this.Y$b=this.X$b=this.Tub=null;this.$&&Je.g(this.$).rc.Zn(this.c$a);this.Yha=this.Ya=this.$=null};xb.prototype.jAj=function(l,J){J&&Hi.e(J.text)&&!(J.cxa||J.textBox.Iv||this.Ya&&this.Ya.textBox.Iv)&&(this.Ya=J,this.calcManager=this.$.da.Aa(266))&&(Cd.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),l=md.HelperMethods.Cvb(l),l=this.calcManager.WZh(Je.g(this.$).ha.ta.activeCell,this.Ya.text,l.x,l.y),J=this.calcManager.getSubExpressionSpan(l),!J||J.end<=J.start||this.Npd(J)||(this.Yha=J,this.Y$b.X3f(l,J,!0)))};xb.prototype.NSd=function(l){if(l&&Hi.e(l.text))if(l.textBox.Iv&&l.textBox.Iv.trim()){if(this.Ya=l,this.calcManager=this.$.da.Aa(266)){Cd.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");l={};var J=this.Ya.textBox.Iv.trim();l.start=this.Ya.text.indexOf(J,this.Ya.textBox.caretPosition);l.end=l.start+J.length;(J=this.calcManager.getFormulaSubExpressionObject(Je.g(this.$).ha.ta.activeCell,this.Ya.text,this.Ya.textBox.Iv))&&!this.Npd(l)&&(this.Yha=l,this.Y$b.X3f(J,l,!1))}}else this.L5a(!1,!0)};xb.prototype.L5a=function(l,J){!this.Ya||J&&this.Ya.textBox.Iv||
(this.Yha=null,l&&(this.I_c(),this.X$b.v_(),this.Y$b.Zgj()),this.Tub&&this.Tub.d9e(),this.Ya.cxa||(this.Ya.cxa=!1,this.Ya=null))};xb.prototype.xed=function(l,J){if(!this.Ya||this.Ya.cxa)return null;this.I_c();this.$rb=new gi.a;return this.X$b.xed(l,this.Ya.text,J,this.$rb.token)};xb.prototype.zRj=function(l,J,Y){this.$rb=null;!l||!J||!J.rna||0>=J.rna.length?this.L5a(!1,!1):(l=this.calcManager.XZh(Je.g(this.$).ha.ta.activeCell,l,this.Ya.text),this.Tub.ARj(this.Ya,J,Y,l))};xb.prototype.Npd=function(l){return this.Yha?
l.start===this.Yha.start&&l.end===this.Yha.end&&l.pre===this.Yha.pre&&l.post===this.Yha.post:!1};xb.prototype.I_c=function(){this.$rb&&this.$rb.C()};Object(Vd.a)(xb,"FormulaAssistanceContextualPreviewManager",null,[665,2,666]);var ni=b(1256),Ji=b(983),Xi=b(254),Lj=b(166);Yb.prototype.s_f=function(l){this.ZT=0;this.c$d=l.IsCompatibility;this.set_name(l.NameDataStrings);this.wWa=l.Help};Yb.prototype.Qqj=function(l){this.ZT=1;this.set_name(l.Name)};Yb.prototype.rqj=function(l){this.ZT=2;this.set_name(l.name);
this.wWa=l.tooltip};Yb.prototype.Orj=function(l){this.ZT=3;this.set_name(l.name);this.wWa=l.toolTip};Yb.prototype.S0f=function(l){this.ZT=4;this.set_name(l.name)};Yb.prototype.huj=function(l){this.ZT=5;this.set_name(l.name);this.wWa=l.toolTip};Yb.prototype.guj=function(l){this.ZT=7;this.set_name(l.name)};Yb.prototype.Esj=function(){this.ZT=6;this.set_name(se.a.instance.Ab(183));this.wWa=se.a.instance.Ab(184)};Yb.prototype.set_name=function(l){return this.yae=l};Yb.Q$g=function(){return Object(tg.a)(new Yb(!0),
{})};Ck.Object.defineProperties(Yb.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.ZT}},ihi:{configurable:!0,enumerable:!0,get:function(){return this.c$d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.yae}},Fja:{configurable:!0,enumerable:!0,get:function(){return this.wWa}},GAb:{configurable:!0,enumerable:!0,get:function(){return this.Zrg}}});Object(Vd.a)(Yb,"AutoCompleteItem",null,
[683]);Object(Vd.a)(Ob,"DefinedNameInfo",null,[]);Ub.prototype.cOj=function(l){var J=this.WHe[l.toUpperCase()];if(!J)return{returnValue:!1,sheetName:"",range:null};l=J.sheetName;J=this.u3g(J.namedRange);return{returnValue:!0,sheetName:l,range:J}};Ub.prototype.J3g=function(l){if(null!=l&&void 0!=l)return{top:l.top,left:l.left,bottom:l.bottom,right:l.right,maxRows:l.maxRows,maxColumns:l.maxColumns,sheetName:void 0}};Ub.prototype.u3g=function(l){if(null!=l&&void 0!=l)return new Ui.a(l.top,l.left,l.bottom,
l.right,l.maxRows,l.maxColumns)};Ub.prototype.C3g=function(l){switch(l){case 2:return 0;case 3:return 1;default:return-1}};Ck.Object.defineProperties(Ub.prototype,{VHe:{configurable:!0,enumerable:!0,get:function(){var l=[];if(!this.$.Hb||!this.$.Hb.items)return l;for(var J=0,Y=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&og.a.uB(this.$),za=Cl(this.$.Hb.items),Ua=za.next();!Ua.done;Ua=za.next())if((Ua=Ua.value)&&(3===Ua.type&&Ua.usedRange||Y&&2===
Ua.type)){var Qb=new Ob;Qb.tooltip=Ua.sheetName+ja.a.exclamation+Ua.usedRange.toString();Qb.name=Ua.name;Qb.namedRange=this.J3g(Ua.usedRange);Qb.sheetName=Ua.sheetName;Qb.type=this.C3g(Ua.type);l.push(Qb);this.WHe[Ua.name.toUpperCase()]=Qb;++J;if(J===Cb.Dqf){Cd.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",Cb.Dqf);break}}return l}}});Object(Vd.a)(Ub,"DefinedNameInfoManager",null,[]);var Bi=b(126),Lh=Sys.EventArgs;Am(yd,Lh);Object(Vd.a)(yd,"FormulaAssistanceFunctionChangedEventArgs",
Sys.EventArgs,[]);var Th=Sys.EventArgs;Am(ec,Th);Object(Vd.a)(ec,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Yi=Sys.EventArgs;Am(Ya,Yi);Object(Vd.a)(Ya,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var gj=b(272);rb.prototype.Wf=function(l,J){l=!1;J||(Je.g(this.$).kk.textBox.tK=!0,l=this.formulaAssistanceUIControl.focus(this.gWe));return l};rb.prototype.sh=function(l){var J=this.uc;return!(void 0===J||null===J)&&id.DOMElementExtensions.Gf(J,l)};
rb.prototype.Ej=function(){this.G6e&&this.G6e()};rb.prototype.Rj=function(){};rb.prototype.dispose=function(){gj.a(this.$).Xz(this)};Ck.Object.defineProperties(rb.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.v_c},set:function(l){this.v_c!==l&&(l?gj.a(this.$).ai(this):gj.a(this.$).Xz(this),this.v_c=l)}},ve:{configurable:!0,enumerable:!0,get:function(){return this.zmj}},uc:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.gWe)}}});
Object(Vd.a)(rb,"FormulaAssistanceFocusManager",null,[438,2]);var Ki=b(1115),oi=zg.a;Am(pb,oi);pb.prototype.fZa=function(l){this.addHandler("FunctionInfoLoaded",l)};pb.prototype.Nbb=function(l){this.removeHandler("FunctionInfoLoaded",l)};pb.prototype.EFg=function(l){this.addHandler("FunctionInfoReset",l)};pb.prototype.hcj=function(l){this.removeHandler("FunctionInfoReset",l)};pb.prototype.dispose=function(){var l=this.$.da.Aa(268);l&&l.dKd(this.vyf);this.wb=null;oi.prototype.dispose.call(this)};pb.prototype.OTf=
function(){this.raiseEvent("FunctionInfoReset")};pb.prototype.JLd=function(){this.OTf();this.MLc=!1;this.VT=null;this.KLc=!0};pb.prototype.A2a=function(l,J){var Y=this;J=void 0===J?!1:J;if(this.E_)this.DLf();else{Cd.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var za=null;(za=this.$.da.Aa(268))||Cd.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===za||void 0===za?0:za.Hja)&&
0<za.Hja.length)We.EwaSettings.ma(122)?za.SEh(this.Kyf):this.xId(za.Hja,!0,!1);else{var Ua=this.$.na.va.hc();l&&(this.$.ea.sc||J)&&!this.fji&&(J?af.a(this.$.userOperationManager,function(Qb,uc,ed){return Td.x(Y.$.na.va,l,lf.b(Qb,Y.Myf),lf.a(uc,Y.Lyf),ed,l,Ua)},function(Qb){return new Wg.a(130,0,Qb,16)},null):Td.x(this.$.na.va,l,this.Myf,this.Lyf,null,l,Ua));!this.E_&&this.$.ea.sc&&(za?(Cd.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.E_,this.$.ea.sc),za.roe(this.vyf)):(Cd.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),Td.x(this.$.na.va,{FilterType:0},this.Kyf,null,null,null,Ua),this.KLc=!1))}}};pb.prototype.bRh=function(l){return 0>l||l>=this.VT.length?null:this.VT[l]};pb.prototype.yfd=function(l){return Rh.a.Nc(this.gdd,l.toUpperCase())};pb.prototype.Fbc=function(l){return Rh.a.Nc(this.lKa,l)};pb.prototype.$gc=function(l){return!l.GroupUI};
pb.prototype.yyf=function(l,J,Y){var za=Bh.a(l);Cd.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",za);za?(Je.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.Hp(l.Errors)):(this.xId(l.Result,J,Y),og.a.IR()&&!og.a.uB(this.$)&&this.LTj())};pb.prototype.xId=function(l,J,Y){Cd.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
l.length,J,Y,this.E_);this.E_||(this.VT=l,this.GQg(J),this.MLc=!Y,this.DLf())};pb.prototype.DLf=function(){this.raiseEvent("FunctionInfoLoaded")};pb.prototype.LTj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.hac)};pb.prototype.GQg=function(l){function J(zf,Dg){return zf.NameUI.localeCompare(Dg.NameUI)}var Y=se.a.instance.fa(1011),za=[];this.lKa={};this.r9=[];this.lKa[Y]=za;var Ua=se.a.instance.fa(1012),Qb=[];this.r9.push(Y);this.r9.push(Ua);Y=0;for(var uc=this.VT.length;Y<uc;Y++){var ed=
this.VT[Y];ed.IsCompatibility||Qb.push(ed);var Dd=ed.NameUI,hd=ed.NameDataStrings;this.gdd[hd.toUpperCase()]||(this.gdd[hd.toUpperCase()]=ed);this.KWe[Dd.toUpperCase()]||(this.KWe[Dd.toUpperCase()]=ed);if(!this.$gc(ed)){if(l){Dd=ed.GroupUI;var Ke=Rh.a.Nc(this.lKa,Dd);Ke||(Ke=[],this.lKa[Dd]=Ke,this.r9.push(Dd));Ke.push(ed)}ed.IsCommonlyUsed&&za.push(ed);ed.IsCompatibility||this.Hpg.push(hd)}}this.lKa[Ua]=Qb;l&&(pb.vPf(za,[2,3,0,5,4,9,1,7,8,6]),za=Array(14),za[0]=0,za[1]=1,za[2]=7,za[3]=11,za[4]=5,
za[5]=2,za[6]=6,za[7]=10,za[8]=9,za[9]=3,za[10]=4,za[11]=13,za[12]=12,za[13]=8,pb.vPf(this.r9,za),za=[],Array.addRange(za,this.r9),Array.removeAt(za,13),this.r9=za);this.VT=Array.clone(this.VT);this.VT.sort(function(zf,Dg){return zf.NameDataStrings.localeCompare(Dg.NameDataStrings)});za=1;for(Ua=this.r9.length;za<Ua&&l;za++)this.lKa[this.r9[za]].sort(J);l=0;for(za=this.VT.length;l<za;l++)this.VT[l].FunctionIndex=l};pb.vPf=function(l,J){for(var Y=Array.clone(l),za=0;za<Y.length&&za<J.length;za++)l[za]=
Y[J[za]]};Ck.Object.defineProperties(pb.prototype,{E_:{configurable:!0,enumerable:!0,get:function(){return this.MLc}},fji:{configurable:!0,enumerable:!0,get:function(){return this.KLc}},hac:{configurable:!0,enumerable:!0,get:function(){var l=this.VT,J=Ki.a(this.$);if(!J)return l;J=J.pQh();var Y=J.length;if(0>=Y)return l;var za=[];Array.addRange(za,l);for(l=0;l<Y;l++){var Ua=J[l],Qb={};Qb.FunctionIndex=za.length;Qb.HelpId=Qb.GroupUI=null;Qb.Help=Ua.description;Qb.IsCommonlyUsed=Qb.IsCompatibility=
!1;Qb.NameDataStrings=Ua.name;Qb.NameUI=Ua.name;Qb.Params=null;Qb.ParamsHelp=null;za.push(Qb)}return za}},Wcd:{configurable:!0,enumerable:!0,get:function(){return this.r9}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(Vd.a)(pb,"FunctionInfoManager",zg.a,[649,650,2]);var fk=b(1194),Dh=fk.a;Am(nc,Dh);nc.prototype.setVisible=function(l){id.DOMElementExtensions.setVisible(this.domElement,l);l||(this.domElement.style.top="auto",this.domElement.style.left="auto")};nc.prototype.isRtl=
function(){return this.lj};nc.prototype.c2e=function(){return this.domElement.parentNode};nc.prototype.kSa=function(l){var J=this.domElement.style;J.cursor="move";J.position=l?"relative":"absolute"};Object(Vd.a)(nc,"FunctionParamBoxDraggableItem",fk.a,[]);Object(Vd.a)(Pa,"FormulaArgumentAssistanceCallbacks",null,[]);Object(Vd.a)(cc,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(Vd.a)(ib,"ArgumentAssistanceRequest",null,[]);eb.prototype.ka=function(l){(this.root=l)&&!this.wn&&(this.root.addEventListener("keydown",
this.onKeyDown,!0),this.wn=!0)};eb.prototype.detach=function(){this.root&&this.wn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.wn=!1)};eb.prototype.E8b=function(){this.root&&(this.target=this.pH.hEf("move",!0),this.NUd=this.target.getBoundingClientRect(),this.r_=!0,this.PRd=!1,this.Ev(),this.Xlc||this.D4c(),this.target.appendChild(this.Xlc))};eb.prototype.J4=function(l){this.pH.Ixf(void 0===l?!1:l);this.r_=!1;this.FJd();this.gJd();this.NUd=this.target=void 0};eb.prototype.Ev=function(){this.xr.capture(this.zNa,
null);this.pointerInputManager.wt(Bg.a.pointerDown,this.target,this.wGb,!0);this.target.addEventListener("blur",this.onBlur)};eb.prototype.gJd=function(){this.xr.releaseCapture();this.pointerInputManager.Ft(Bg.a.pointerDown,this.target,this.wGb,!0);this.target.removeEventListener("blur",this.onBlur)};eb.prototype.FJd=function(){var l;this.target&&(null===(l=this.Xlc)||void 0===l?void 0:l.parentNode)===this.target&&this.target.removeChild(this.Xlc)};eb.prototype.w6=function(l,J){var Y=this.target.getBoundingClientRect();
l+=Y.left-this.NUd.left;J+=Y.top-this.NUd.top;this.pH.onMove(l,J)};eb.prototype.D4c=function(){this.Xlc=mi.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(Vd.a)(eb,"FormulaAssistanceMoveAdapter",null,[]);var jk=b(288);lc.prototype.Oba=function(){return this.wn&&!!this.pka};lc.prototype.fPa=function(l){this.pka.style.cursor="grabbing";this.XFj=l.clientPoint.x;this.YFj=l.clientPoint.y;this.pH.hEf("drag");return!0};lc.prototype.qma=function(l){this.pH.onMove(l.clientPoint.x-
this.XFj,l.clientPoint.y-this.YFj);return!0};lc.prototype.pma=function(){this.Yt()};lc.prototype.oma=function(){this.Yt()};lc.prototype.ka=function(l){if(this.pka=l)this.pka.style.cursor="grab",jk.a.instance.O0(this.pka,this),this.wn=!0};lc.prototype.detach=function(){this.wn&&this.pka&&(this.pka.style.cursor="",jk.a.instance.x8(this.pka,this),this.wn=!1)};lc.prototype.Yt=function(){this.pka.style.cursor="grab";this.pH.Ixf()};Object(Vd.a)(lc,"FormulaAssistanceDragAdapter",null,[718]);pc.prototype.ka=
function(l,J,Y,za){this.root=l;this.render=Y;this.dismiss=za;this.detach();J&&(this.xKe.ka(J),this.zrf.ka(l.firstChild),this.wn=!0)};pc.prototype.detach=function(){this.wn&&(this.xKe.detach(),this.zrf.detach(),this.wn=!1);id.DOMElementExtensions.Af(this.placeholder)};pc.prototype.clear=function(){this.Z$b.setOverrideTarget(void 0);this.detach();this.tLd()};pc.prototype.hEf=function(l,J){J=void 0===J?!1:J;this.usageCount[l]+=1;this.lzc=this.root.firstChild.getBoundingClientRect();this.placeholder=
this.root.cloneNode(!0);l=this.placeholder.firstChild;l.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);J&&(this.WFd=document.activeElement,l.tabIndex=0,l.focus());this.dismiss();return l};pc.prototype.onMove=function(l,J){l=Math.min(Math.max(l,this.JDc-this.lzc.left),window.innerWidth-this.lzc.right-this.JDc);J=Math.min(Math.max(J,this.JDc-this.lzc.top),window.innerHeight-this.lzc.bottom-this.JDc);this.placeholder.firstChild.style.transform="translate("+l+"px, "+
J+"px)"};pc.prototype.Ixf=function(l){var J=this;l=void 0===l?!0:l;var Y=this.placeholder.firstChild.getBoundingClientRect(),za=this.Z$b.getDirectionalHint({top:Y.top,left:Y.left});this.Z$b.setOverrideTarget({top:1===za?Y.bottom:Y.top,left:Y.left});this.render();window.requestAnimationFrame(function(){id.DOMElementExtensions.Af(J.placeholder);J.WFd&&(l&&J.WFd.focus(),J.WFd=void 0)})};pc.prototype.tLd=function(){var l=this.formulaAssistanceTelemetryManager.B$,J=this.usageCount[ak.Drag],Y=this.usageCount[ak.Move];
0<J&&(l.argumentAssistanceDragCounter+=1,l.argumentAssistanceDragTotalCounter+=J,this.usageCount[ak.Drag]=0);0<Y&&(l.argumentAssistanceMoveCounter+=1,l.argumentAssistanceMoveTotalCounter+=Y,this.usageCount[ak.Move]=0)};Object(Vd.a)(pc,"FormulaAssistanceDragControl",null,[]);var ak;(function(l){l.Drag="drag";l.Move="move"})(ak||(ak={}));Object(Vd.b)("FormulaAssistanceDragMode",ak);var jl=Si.a;Am(Db,jl);Db.prototype.soe=function(l){this.addHandler("FAFunctionNameUpdated",l)};Db.prototype.aRf=function(l){this.removeHandler("FAFunctionNameUpdated",
l)};Db.prototype.fpe=function(l){this.addHandler("FAParameterSelectionChangedOld",l)};Db.prototype.wRf=function(l){this.removeHandler("FAParameterSelectionChangedOld",l)};Db.prototype.epe=function(l){this.addHandler("FAParameterSelectionChanged",l)};Db.prototype.vRf=function(l){this.removeHandler("FAParameterSelectionChanged",l)};Db.prototype.set_visible=function(l){this.$k?l||this.Jsb():Sys.UI.Control.prototype.set_visible.call(this,l);return l};Db.prototype.Jsb=function(){this.formulaAssistanceUIControl&&
(this.Zq=null,this.CR&&this.pH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.xla=null,this.rr.canReceiveFocus=!1)};Db.prototype.show=function(l){this.$k||(this.formulaAssistanceTelemetryManager.RI(["argumentAssistanceRender"]),this.j2a.setVisible(!!l),this.formulaAssistanceTelemetryManager.bF(["argumentAssistanceRender"]),this.BXc&&(this.BXc=!1,this.formulaAssistanceTelemetryManager.q8b("argumentAssistanceOverall")))};Db.prototype.xLd=function(){var l=this;if(!this.Mba||this.zSa){this.formulaAssistanceTelemetryManager.RI(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);var J=Je.g(this.$).kk;this.pluginScheduler.requester().argumentAssistance(Object(tg.a)(new ib,{content:J.text,caretPosition:J.textBox.caretPosition})).then(function(Y){0===Y.kind?Y.payload?(l.formulaAssistanceTelemetryManager.bF(["argumentAssistanceComputation"]),l.Ozj(l.tFd(Y.payload),J.textBox.domElement)):l.Jsb():l.formulaAssistanceTelemetryManager.bF(["argumentAssistanceComputation"],!1);return null})}};Db.prototype.update=function(l,J,Y,za){if(!this.$k&&l){this.formulaAssistanceTelemetryManager.RI(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.BXc=!0;var Ua=this.$.listSeparator;try{var Qb=$get(Cb.edd,this.Oj),uc=$get(Cb.Xcd,this.Oj);Qb.innerText="";uc.innerText="";var ed=$get(Cb.GWe,this.Oj),Dd=l.Params.split(Cb.W$c);Qb=[];uc=0;for(var hd=ed.rows.length;uc<hd;uc++){var Ke=ed.rows[uc];id.DOMElementExtensions.setVisible(Ke,uc<Dd.length);var zf=Dd[uc],Dg=Cb.nXi+uc+"_",Tg=l.NameDataStrings;$get(Dg+Cb.$Fb,Ke).innerText=Tg;$get(Dg+Cb.XDd,Ke).innerText=Tg;if(zf){var Rg=Dd[uc].split(Ua),Yh=Db.cpd(Rg[Rg.length-
1]),Li=Db.vli(l);Yh&&(Li&&(2<Rg.length?(Rg[Rg.length-2]+="1",Rg[Rg.length-3]+="1"):Cd.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Tg,Rg.length.toString(),J)),Db.LKg(Rg,Li,J,l));zf=Rg.join(Ua.toString()+" ");Dd[uc]=zf;Y<Rg.length?(Qb[uc]=Rg[Y],Cd.ULS.shipAssertTag(537162072,0,!!Rg[Y]&&1<=Rg[Y].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
Y,Rg.length,Tg,uc),Rg[Y]=String.format("{0}{1}{2}","<b>",Rg[Y],"</b>"),zf=Rg.join(Ua.toString()+" ")):Cd.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Y+"currRowParamsArray.Length = "+Rg.length+", current row = "+uc);za&&Cd.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Tg,Rg.length,Yh,Li,J)}$get(Dg+Cb.YDd,Ke).innerHTML="("+(zf||"")+")"}za?
this.raiseEvent("FAFunctionNameUpdated",new yd(l.NameDataStrings,Dd)):this.raiseEvent("FAParameterSelectionChangedOld",new Ya(Dd,Qb,Y));ed.className=Ji.a.arh+(this.functionInfoManager.$gc(l)?"-udf":"")}catch(Mh){throw Cd.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",l.NameDataStrings,J,Mh),Mh;}this.formulaAssistanceTelemetryManager.bF(["argumentAssistanceComputation"])}};Db.prototype.dispose=function(){this.$k||(this.Fc.hB(),hh.a.Ha(this.Fc),
Je.g(this.$).view.Yq(this.ot),hh.a.Ha(this.j2a),this.j2a=null);this.$k&&hh.a.Ha(this.rr);this.Mba&&Je.g(this.$).Ac.Zn(this.Ng);this.functionInfoManager=this.$=null;jl.prototype.dispose.call(this)};Db.prototype.tFd=function(l){var J=new cc;J.functionRenderingInfo=l;J.cardMode=this.q3;this.XId(J);return J};Db.prototype.XId=function(l){l.callbacks=new Pa;l.callbacks.onHelpLink=this.dwb(l.functionRenderingInfo);l.callbacks.onCardModeChange=this.onCardModeChange;l.callbacks.onFeedback=this.LRa;this.Mba&&
(l.callbacks.onDismissClick=this.onDismissClick)};Db.prototype.Ozj=function(l,J){var Y=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.RI(["argumentAssistanceRender"]);var za={};za.zoomLevel=ub(this.$);this.formulaAssistanceUIControl.updateContext(za);this.Zq=function(){Y.formulaAssistanceUIControl.renderArgumentAssistanceCard(Y.domElement,J,l)};this.Zq();this.xEd(l);this.CR&&this.pH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Zq,function(){return Y.formulaAssistanceUIControl.dismiss(Y.domElement)});this.rr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.bF(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.q8b("argumentAssistanceOverall")}};Db.prototype.dwb=function(l){var J=this;return function(){tb(J.$,l.helpID,l.isUDF)}};Db.prototype.KPd=function(){var l=Bi.a.get(oa.a.h0b);this.q3=l?parseInt(l,10):Db.u6c;this.formulaAssistanceTelemetryManager.VYf(this.q3)};Db.prototype.xEd=function(l){var J=
l.functionRenderingInfo.functionName;this.xla&&da.a.equals(this.xla,J,!0)?(J=xh.a.map(l.functionRenderingInfo.signatures,function(Y){var za="";0<=Y.signatureParams.activeParam&&Y.signatureParams.activeParam<Y.signatureParams.params.length&&(za=Y.signatureParams.params[Y.signatureParams.activeParam]);return za}),this.raiseEvent("FAParameterSelectionChanged",new ec(J))):(this.xla=J,l=xh.a.map(l.functionRenderingInfo.signatures,function(Y){return Y.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",
new yd(J,l)))};Db.prototype.oOb=function(l){this.q3=l;try{Bi.a.Mv(oa.a.h0b,l.toString(),Wi.AFrame.Pea)}catch(J){Cd.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",J.message)}};Db.cpd=function(l){return da.a.contains(l,Cb.e8b,!0)};Db.vli=function(l){return!!l&&da.a.w2a(l.NameDataStrings,"IFS")};Db.LKg=function(l,J,Y,za){try{if(!l||2>l.length)Cd.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",
za.NameDataStrings,l?l.length.toString():"currRowParamsArray == null",J,Y);else{for(var Ua=l.pop().toString(),Qb=l.length-1;Qb<Y;Qb++){var uc=l[Qb].trim();if(J){var ed=l[Qb-1].trim();l.push(Db.cIh(ed,uc))}else{var Dd=Db.Y$e(uc);l.push(Db.hXe(Dd))}}l.push(Ua)}}catch(hd){throw Cd.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",za.NameDataStrings,l?l.length.toString():"currRowParamsArray == null",
J,Y,hd),hd;}};Db.cIh=function(l,J){l=Db.Y$e(l);var Y=Db.b2e(l);J=Db.b2e(J);return Db.hXe(l,!0,!!Y&&!!J&&Y!==J)};Db.Y$e=function(l){var J=l.match(Db.Ozd);l=da.a.trimEnd(da.a.trimStart(l,Cb.ZFf),Cb.YFf);if(J&&J.length){J=J[J.length-1];var Y=Number.parseLocale(J)+1;l=l.replace(J,Y.toString())}else l=String.format("{0}{1}",l,1);return l};Db.hXe=function(l,J,Y){var za="[{0}]";(void 0===J?0:J)&&(za=(void 0===Y?0:Y)?"[{0}":"{0}]");return String.format(za,l)};Db.b2e=function(l){return(l=l.match(Db.Ozd))&&
l.length?l[0]:null};Db.oKa=function(l){if(l)return document.createElement("div");l=String.format(Cb.GGf,Cb.EGf,Cb.XDd,Ji.a.LOe,Cb.$Fb,Ji.a.KOe,Cb.YDd);var J=String.format(Cb.GGf,Cb.FGf,Cb.XDd,Ji.a.LOe,Cb.$Fb,Ji.a.KOe,Cb.YDd);l=String.format(Cb.uGh,Cb.vGh,Ji.a.EPe,Ji.a.cnh,D.a.gq,Cb.GWe,l,J);J=document.createElement("div");J.innerHTML=l;return J.firstChild};Db.Ozd=RegExp("\\d+");Db.u6c=0;Object(Vd.a)(Db,"FormulaArgumentAssistanceControlDeprecated",Si.a,[682]);Object(Vd.a)(Wa,"ParseContext",null,[]);
var Gk=b(336),xj=Nk.a;Am(Fa,xj);Fa.prototype.Wh=function(l,J){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==J&&-1231471547!==J||!this.RIe()||(this.qW=!1);return xj.prototype.Wh.call(this,l,J)};Fa.prototype.nAd=function(){var l=this.f6a;if(l||this.mSd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.jpb.formulaAssistanceRequestAttemptedCounter++,this.RIe())if(!l&&this.mSd)this.formulaAssistanceControl.gte();else if(We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)&&this.O9h){if(l=this.$.Ob.Hc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.ite(),l.stop(),this.dpb.text.endsWith("[")&&"["!==this.dpb.text.charAt(this.dpb.text.length-2)){var J=""===this.vIa?this.formulaAssistanceControl.tableManager.Cg:Object(S.a)(Gk.a,this.$.Hb.getItemByName(this.vIa));Cd.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
J.jj,l.zc,this.dmd,this.qW)}}else this.formulaAssistanceControl.Sob(),this.BFf&&(this.BFf=this.qW=!1);else this.formulaAssistanceTelemetryManager.jpb.formulaAssistanceRequestOptimizedCounter++;else this.qW=!1};Fa.prototype.gj=function(){this.saj||(this.DSa=null,this.mSd&&this.formulaAssistanceControl.f_())};Fa.prototype.Ng=function(){this.qW=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.huc();this.$k&&this.Hvi()};Fa.prototype.NGd=function(l,J){return this.formulaAssistanceControl.Wh(l,
J)};Fa.prototype.Hvi=function(){this.formulaAssistanceControl.nBa&&(this.formulaAssistanceTelemetryManager.gKa.smartSuggestionShownCounter++,this.formulaAssistanceControl.nBa=!1);this.formulaAssistanceControl.XSa&&(this.formulaAssistanceTelemetryManager.gKa.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.XSa=!1);this.formulaAssistanceControl.sMb&&(this.formulaAssistanceTelemetryManager.gKa.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.sMb=!1)};Fa.prototype.SVg=function(l,
J){for(var Y=0,za;-1!==Y;)if(Y=l.indexOf("[",Y+1),-1!==Y&&Y<J&&(za=l.indexOf("]",Y+1),-1===za||za>=J))return Y;return-1};Fa.prototype.RIe=function(){var l=this.Ya.text,J=this.Ya.textBox.caretPosition,Y=this.formulaAssistanceControl.KNa,za=this.formulaAssistanceControl.JNa;if(this.qW&&da.a.equals(l,Y,!0)&&J===za)return!1;this.formulaAssistanceControl.KNa=l;this.formulaAssistanceControl.JNa=J;return!0};Ck.Object.defineProperties(Fa.prototype,{kzb:{configurable:!0,enumerable:!0,get:function(){return Object(ag.a)(ua,
this.$.zb.nh)}},qW:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(l){this.formulaAssistanceControl.isListVisible=l}},f6a:{configurable:!0,enumerable:!0,get:function(){return this.Ya.f6a}},O9h:{configurable:!0,enumerable:!0,get:function(){var l=this.dpb.text,J=!1;if(0>=l.length)return J;var Y=this.$.Ob.Hc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),za=Je.g(this.$).ha.ta.activeCell.clone(),Ua=l.charCodeAt(0);this.vIa=
"";this.IQ=this.SVg(l,this.dpb.caretPosition);Ua=61===Ua&&-1!==this.IQ;if(!We.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Ua&&(J=!0);else if(Ua){if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Ua=0;for(var Qb=this.IQ-1;1<=Qb&&!(this.IQ-Qb>Fa.zqf);Qb--)if(Array.contains(Fa.eve,l.charAt(Qb))){Ua=Qb;break}Ua=l.substring(Ua+1,this.IQ);l=""!==Ua?this.$.Hb.getItemByName(Ua):null;Qb=this.IQ;for(var uc=this.IQ+1;uc<=
this.Ya.textBox.caretPosition;uc++)if("["===this.Ya.text.charAt(uc))Qb=uc;else break;this.IQ=Qb}else{Ua=l.lastIndexOf("[");Qb=0;for(uc=Ua-1;1<=uc&&!(Ua-uc>Fa.zqf);uc--)if(Array.contains(Fa.eve,l.charAt(uc))){Qb=uc;break}Ua=l.substring(Qb+1,Ua);l=""!==Ua?this.$.Hb.getItemByName(Ua):null}l&&2===l.type?(J=!0,this.vIa=Ua):Je.g(this.$).Rb.Qj(za)&&(J=!0,this.vIa="")}Y.stop();this.dmd=Y.zc;Cd.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",
this.dmd);return J}},key:{configurable:!0,enumerable:!0,get:function(){return Ai.a.H3a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.GGc||(this.GGc=this.$.da.Aa(266,!1));return this.GGc}},mSd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.DSa)return this.DSa;if(!We.EwaSettings.ma(136))return this.DSa=!1;var l=Je.g(this.$).ha.ta.activeCell.clone();if(1!==l.hqf||!l.left||Je.g(this.$).ha.ta.Ahc())return!1;var J=this.formulaAssistanceControl.tableManager.tn(l);if(J)return this.DSa=
!1;--l.left;--l.right;if(!l.isValidRange)return!1;J=this.formulaAssistanceControl.tableManager.tn(l);return this.DSa=!!J&&l.top===J.top&&this.formulaAssistanceControl.tableManager.v4g(J,Je.g(this.$))}}});Fa.eve=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Fa.zqf=255;Object(Vd.a)(Fa,"FormulaAutoCompleteListAutoCompleteBehavior",Nk.a,[]);var hj;(function(l){l[l.function=0]="function";l[l.field=1]="field";l[l.definedName=2]="definedName";l[l.letVariable=3]="letVariable";l[l.tableColHeaderName=4]="tableColHeaderName";
l[l.tableSpecialStructRef=5]="tableSpecialStructRef";l[l.pendingData=6]="pendingData";l[l.tableNamedObject=7]="tableNamedObject"})(hj||(hj={}));Object(Vd.b)("ItemType",hj);var gk=b(1258),Vi=b(1257);sa.prototype.execute=function(l){l.push(this.index)};Object(Vd.a)(sa,"AppendIndexOperation",null,[716]);Oa.prototype.execute=function(){};Object(Vd.a)(Oa,"NopIndexOperation",null,[716]);wb.prototype.execute=function(l){for(var J=0;J<l.length;J++)l[J]===this.m1i&&(l[J]=this.Bsf)};Object(Vd.a)(wb,"ReplaceIndexOperation",
null,[716]);ob.prototype.mFe=function(l,J){var Y=new sa(J);if(!this.NMa)return Y;l=this.kqi(l,J);return null!=l?this.items[l].GAb?new wb(l,J):new Oa:Y};ob.prototype.kqi=function(l,J){var Y=this,za=this.items[J];Cd.ULS.shipAssertTag(537162075,0,!!za,"Internal error: invalid item index");l=Ha.where(Ha.asEnumerable(l),function(Ua){return Y.items[Ua].name===za.name});return Ha.Ct(l)?Ha.first(l):null};Object(Vd.a)(ob,"FilterItemOperationFactory",null,[]);Object(Vd.a)(gb,"CompletionItem",null,[]);var Sj=
"<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+D.a.gq+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+D.a.gq+"'>{5}</td>\r\n</tr>",lk="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+D.a.gq+"'></td>\r\n\t<td id='item_type_cell' class='"+D.a.gq+"'>{2}</td>\r\n</tr>",Pi="<td>\r\n\t<div class='"+D.a.Wr+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",Tj="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
D.a.gq+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+D.a.gq+"'>{2}</td>\r\n</tr>",N=gk.a;Am(Na,N);Na.prototype.hWc=function(l){this.addHandler("FLBSelectedRowChanged",l)};Na.prototype.wKd=function(l){this.removeHandler("FLBSelectedRowChanged",l)};Na.prototype.NZb=function(l){this.addHandler("ACLBUpdated",l)};Na.prototype.ntc=function(l){this.removeHandler("ACLBUpdated",l)};Na.prototype.dispose=function(){N.prototype.dispose.call(this);this.Gra=this.HWe=this.avb=null};Na.prototype.Tzc=function(l,
J,Y,za){za=void 0===za?0:za;this.fgf||this.j8(!1);var Ua="";Y&&(Ua+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",Ji.a.J_g,Y));Ua+=String.format("<table class='{0}' aria-live='off'><tbody>",this.rca);for(var Qb=new P.a,uc=0,ed=this.fX.length;uc<ed;uc++)Ua+=this.h4e(l[this.fX[uc]],uc+1,J,za),this.$k&&Qb.add(this.eZe(l[this.fX[uc]]));uc=this.fX.length;ed=0;for(var Dd=this.Gq.length;ed<Dd;ed++)Array.contains(this.fX,this.Gq[ed])||(uc++,
Ua+=this.h4e(l[this.Gq[ed]],uc,J,za),this.$k&&Qb.add(this.eZe(l[this.Gq[ed]])));this.dg.innerHTML=Ua+"</tbody></table>";this.Un=id.DOMElementExtensions.Cj(this.domElement,this.rca);this.$k&&(this.I3b=Qb.toArray());this.fgf?(this.isListVisible=!0,this.PGa.set_visible(!0)):(this.j8(!0),this.KIg(!!Y))};Na.prototype.PJa=function(l,J,Y,za,Ua,Qb){za=void 0===za?"":za;Ua=void 0===Ua?0:Ua;Qb=void 0===Qb?!1:Qb;if(l){var uc=[],ed=[];this.rMb=0;var Dd=new ob(this.$,l);if(J){var hd=!!J&&0<Ua,Ke=hd&&91===J.charCodeAt(Ua+
1)?Ua+2:Ua+1;Qb=hd?J.length===Ke:!1;hd&&J.length===Ua&&We.EwaSettings.ma(136)&&(Qb=!0);var zf=null;!Qb&&hd&&J.length>Ua+1&&(zf=J.substring(Ke,J.length));if(J)for(hd=0,Ke=l.length;hd<Ke;hd++){var Dg=l[hd].name;if(!l[hd].ihi){var Tg=Dd.mFe(uc,hd);l[hd].GAb&&this.rMb++;if(!zf&&!Qb||0===l[hd].itemType)ed=this.bUe(J,Dg,Y,Tg,uc,ed),uc=ed.faf,ed=ed.LIf;zf&&1===l[hd].itemType&&(ed=this.bUe(zf,Dg,!0,Tg,uc,ed),uc=ed.faf,ed=ed.LIf);Qb&&1===l[hd].itemType&&Tg.execute(uc)}}}else for(Y=0;Y<l.length;++Y)if(l[Y].GAb||
Qb)zf=Dd.mFe(uc,Y),zf.execute(uc),zf.execute(ed),l[Y].GAb&&this.rMb++;this.fX=ed;this.Gq=uc;this.Tzc(l,J,za,Ua)}};Na.prototype.PSj=function(l){if(l&&!(1<l.length)){var J=[],Y=[];J.push(0);Y.push(0);this.fX=J;this.Gq=Y;this.Tzc(l,"","",0)}};Na.prototype.wya=function(){this.Vk&&N.prototype.wya.call(this)};Na.prototype.F4i=function(l,J){this.raiseEvent("ACLBUpdated",new Vi.a(l,void 0,void 0,J))};Na.prototype.zeg=function(l){var J=this.Un.rows[l];return(!this.Vk||this.Vk!==J)&&l<this.Un.rows.length?(this.Vk=
J,!0):!1};Na.prototype.onItemClick=function(l){Fh.g(l.Ca);0===this.jx||2===this.jx||3===this.jx||4===this.jx||5===this.jx||7===this.jx?(this.raiseEvent(Ok.a.b5a),this.wya()):1===this.jx?this.PGa.kz(!1):(this.PGa.kz(!1),l=Je.g(this.$),l.Kp(!1),l.focus());return!0};Na.prototype.KIg=function(l){this.osa();if(l){var J=this.Un.offsetWidth+(this.Gq.length>this.kI?ej.a.zu:0);l=$get("list_column_header");l.offsetWidth>J&&id.DOMElementExtensions.Jr(this.dg,l.offsetWidth);J=this.dg.getElementsByClassName(this.W_);
for(var Y=0;Y<J.length;Y++)J[Y].style.width=md.HelperMethods.nc(l.offsetWidth)}};Na.prototype.h4e=function(l,J,Y,za){if(1===l.itemType){var Ua=hg.a.Sf(l.name),Qb=hg.a.Sf(za?Y.substring(za+1,Y.length):Y),uc=0;Ua.substring(0,Qb.length).toLowerCase()!==Qb.toLowerCase()&&(uc=Na.DFj(Ua,Cb.uhg,Qb));Y="";Y=0<=uc?Y+(Ua.substring(0,uc)+"<b>"+Ua.substring(uc,uc+Qb.length)+"</b>"+Ua.substring(uc+Qb.length,Ua.length)):Y+Ua;za=za?String.format(Pi,D.a.iQe,hg.a.o_(Hg.a.Se(0)),se.a.instance.fa(709)):"";return String.format(lk,
za,J,hj[l.itemType],this.W_,Y)}if(5===l.itemType)return String.format(Tj,"",J,hj[l.itemType],this.W_,hg.a.Sf(l.name),hg.a.Sf(l.Fja));if(4===l.itemType)return String.format(Tj,"(...)",J,hj[l.itemType],this.W_,hg.a.Sf(l.name));if(6===l.itemType)return za=za?String.format(Pi,D.a.iQe,hg.a.o_(Hg.a.Se(0)),se.a.instance.fa(709)):"",String.format(Sj,za,this.W_,hg.a.Sf(l.name),hg.a.Sf(l.Fja),J,hj[l.itemType]);za=String.format(Pi,2===l.itemType||3===l.itemType?D.a.Euh:D.a.Cuh,hg.a.o_(Hg.a.Se(0)),se.a.instance.fa(706));
return String.format(Sj,za,this.W_,hg.a.Sf(l.name),hg.a.Sf(l.Fja),J,hj[l.itemType])};Na.prototype.eZe=function(l){var J=new gb;J.label=l.label;J.textEdit=l.textEdit;J.kind=Na.QMh(l.itemType);J.type=l.GAb?1:0;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===J.kind){var Y=this.formulaAssistanceControl.cRh(l.label);J.detail=Y?Y:l.Fja}else J.detail=l.Fja;return J};Na.prototype.bUe=function(l,J,Y,za,Ua,Qb){da.a.equals(J,"Pretend this is the line.",!1)&&0<Ua.length||
da.a.FL(J,l)?(za.execute(Ua),za.execute(Qb)):Y&&l.length>=Cb.y4g&&Na.deh(J,Cb.uhg,l)?za.execute(Ua):!Y&&l.length>=Cb.x4g&&da.a.contains(J,l,!0)&&za.execute(Ua);return{faf:Ua,LIf:Qb}};Na.QMh=function(l){switch(l){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};Na.deh=function(l,J,Y){J=Cl(J);for(var za=J.next();!za.done;za=J.next())if(za=l.split(za.value),!(2>za.length)){za=Cl(za);for(var Ua=za.next();!Ua.done;Ua=
za.next())if(da.a.FL(Ua.value,Y))return!0}return!1};Na.DFj=function(l,J,Y){J=Cl(J);for(var za=J.next();!za.done;za=J.next())if(za=l.toLowerCase().indexOf((za.value+Y).toLowerCase()),0<za)return za+1;return-1};Ck.Object.defineProperties(Na.prototype,{Dic:{configurable:!0,enumerable:!0,get:function(){return 0<this.rMb&&this.rMb===this.Gq.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Fj.a)(Na.prototype,this,"isListVisible")},set:function(l){Object(Fj.b)(Na.prototype,
this,"isListVisible",l);l||(this.Hvc=0,this.we=null);0===this.Hvc?id.DOMElementExtensions.setVisible(this.avb,l&&!this.$k):id.DOMElementExtensions.setVisible(this.avb,!1)}},Vk:{configurable:!0,enumerable:!0,get:function(){return this.Gra},set:function(l){this.PBa(this.Vk);if(l){this.HWe.innerText="";this.Gra=l;var J=this.PBa(this.Vk),Y=l.rowIndex+1,za=$get("description_cell"+Y,l);this.avb.innerText=za.innerText;var Ua=$get("item_type_cell",l);this.we=J=J.innerText;this.Hvc="field"===Ua.innerText?
1:"definedName"===Ua.innerText?2:"letVariable"===Ua.innerText?3:"tableColHeaderName"===Ua.innerText?4:"tableSpecialStructRef"===Ua.innerText?5:"pendingData"===Ua.innerText?6:"tableNamedObject"===Ua.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Vi.a(this.Gq.length,Y,J,za.innerText));this.rvc(l)}}},MTa:{configurable:!0,enumerable:!0,get:function(){return this.avb}},PGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},jx:{configurable:!0,enumerable:!0,
get:function(){return this.Hvc}}});Object(Vd.a)(Na,"FormulaAutoCompleteListBox",gk.a,[681]);Ck.Object.defineProperties(ra.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.b$}}});Object(Vd.a)(ra,"LETVariableInfo",null,[]);Ck.Object.defineProperties(ta.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Vd.a)(ta,"TableColHeaderNameInfo",null,[]);Ck.Object.defineProperties(ac.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Vd.a)(ac,"TableNamedObjectInfo",null,[]);Ck.Object.defineProperties(kb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.b$}}});Object(Vd.a)(kb,"TableSpecialStructRefInfo",null,[]);var la=b(188),Ra=b(187);Object(Vd.a)(db,"FormulaAutoCompleteCallbacks",null,[]);Object(Vd.a)(sb,"FormulaAutoCompleteRenderingInfo",null,[]);Object(Vd.a)(Ta,
"CellMessage",null,[]);Object(Vd.a)(wa,"FunctionSuggestionRequest",null,[]);Object(Vd.a)(qa,"RunExperimentRequest",null,[]);var Pb=ni.a;Am(Aa,Pb);Aa.prototype.qoe=function(l){this.addHandler(Aa.Mcd,l)};Aa.prototype.$Qf=function(l){this.removeHandler(Aa.Mcd,l)};Aa.prototype.ooe=function(l){this.addHandler(Aa.hcd,l)};Aa.prototype.YQf=function(l){this.removeHandler(Aa.hcd,l)};Aa.prototype.poe=function(l){this.addHandler("FormulaAutoCompleteShown",l)};Aa.prototype.ZQf=function(l){this.removeHandler("FormulaAutoCompleteShown",
l)};Aa.prototype.set_visible=function(l){this.Aja.set_visible(l);this.$k&&!l&&this.Ksb();Sys.UI.Control.prototype.set_visible.call(this,l);return l};Aa.prototype.$Ug=function(l,J){this.isListVisible&&(l+=Cb.openParen,J++,this.bEd(l,J));var Y=0<J&&l.charAt(J-1)===Cb.openParen,za=J===l.length||l.charAt(J)===Cb.closeParen;if(!Y||!za)return Cd.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",
J,!l.length,!!this.HQ),!1;Y=l.substring(0,J).lastIndexOf(this.$.listSeparator);za=l.substring(0,J-1).lastIndexOf(Cb.openParen);l=l.substring(-1===Y&&-1===za?1:Math.max(Y,za)+1,J-1).trim();return this.functionInfoManager.yfd(l)?!0:(Cd.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.HQ),!1)};Aa.prototype.fdi=function(l,J){var Y=this.$Ug(l,J);if(!Y||!this.HQ)return Cd.ULS.shipAssertTag(537162051,
0,!Y||Y&&!!this.HQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,xsf:0,YUe:0};Y=this.HQ.Params;Y=Y.replace(RegExp("[\\[\\]]","g"),"");var za=l.charAt(J-1)===Cb.openParen,Ua=za?"":"(",Qb=J===l.length?")":"";var uc=this.$.listSeparator;uc=Y.includes(uc)?Y.indexOf(uc):Y.length;return{returnValue:l.substring(0,J)+Ua+Y+Qb+l.substring(J,l.length),xsf:za?J:J+1,YUe:uc}};Aa.prototype.ot=function(l,J){this.$k&&void 0!==this.Zq&&null!==this.Zq&&
this.Zq();this.$k||Pb.prototype.ot.call(this,l,J)};Aa.prototype.dispose=function(){if(this.$){this.oTa(!1);var l=Je.g(this.$);l&&(l.ha&&(this.$k?l.ha.cG(this.kd):l.ha.A7(this.kd),og.a.IR()&&4!==this.fDb&&l.ha.iAa(this.wuf)),l.view.Yq(this.Jnc));this.$k&&this.$.xa&&this.$.xa.Vg(this.ii)}this.functionInfoManager&&(this.functionInfoManager.Nbb(this.onFunctionInfoLoaded),this.functionInfoManager.hcj(this.xyf));this.uh&&this.uh.etc(this.Rya);this.$k&&this.Ef&&this.Ef.wKd(this.oDf);og.a.cgc&&this.Ya&&this.Ya.lIb(this.K6);
this.d8f(!1);hh.a.Ha(this.Ef);hh.a.Ha(this.s0b);hh.a.Ha(this.Aja);hh.a.Ha(this.rr);this.Ya=this.functionInfoManager=this.uh=null;hh.a.yc(this.cKa);this.Cg=this.U8=this.Aja=this.cKa=null;Pb.prototype.dispose.call(this)};Aa.prototype.kxa=function(){return!this.Rt};Aa.prototype.jki=function(){return!this.QGa};Aa.prototype.Wh=function(l,J){if(!this.kxa()){if(this.$k&&this.AK){if(125627505===J||267796030===J)return this.$k&&this.XBc(J),this.JBe(),!1;if(1872288872===J)return this.hna(),this.isListVisible=
!1,!0;if(this.Ef.Dic&&(-798660877===J||137938150===J))return!1}if(1!==this.Ef.jx||125627505!==J&&267796030!==J)if(6===this.Ef.jx){var Y=l.keyCode;13!==Y&&9!==Y||this.kz(!1)}else{if(4===this.Ef.jx||5===this.Ef.jx)return Pb.prototype.Wh.call(this,l,J,!0);1===this.Ef.fX.length&&(Y=l.keyCode,this.yxe=8===Y||127===Y||46===Y?!0:!1)}else{if(this.kz(!1)&&!this.Dka)return Je.g(this.$).ha.Wh(l,J);if(125627505===J&&this.Dka)return!0}}return Pb.prototype.Wh.call(this,l,J)};Aa.prototype.huc=function(){this.uh.mcb();
this.U8=null;null==this.nja||this.nja||this.xkc("NoFieldChosen",1,2,1);this.nja=null;this.o4=0;this.d6=this.Ksd=this.Vpc=null};Aa.prototype.Sob=function(){var l=this,J=!!this.Ya&&!tf.f(this.$.qa);if((this.mBa||this.Uyc)&&J){var Y=this.Ya.text;this.pluginScheduler.requester().functionSuggestion(Object(tg.a)(new wa,{content:Y})).then(function(za){0===za.kind&&(Cd.ULS.shipAssertTag(537162050,0,!!za&&!!za.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),
za=Ha.toArray(Ha.select(Ha.asEnumerable(za.payload.items),function(Ua){return Aa.r3g(Ua)})),l.Uyc&&"="===Y&&0<za.length&&l.gridView.n2a.Rrj("="+za[0].textEdit.newText),l.mBa&&(l.WSa=za,Fg.AFrameworkApplication.Kg||l.hte(J,!0)));return null})}this.mBa&&J||this.hte(J,!1)};Aa.prototype.g4e=function(){if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var l=Je.g(this.$).Fj?this.Uub.IQ:this.nqb.IQ;"@"===this.Ya.text.charAt(l+1)&&this.Ya.textBox.caretPosition>
l+1?this.Feb=l+2:this.Feb=l+1}else{l=this.Ya.text.lastIndexOf(Cb.llf);var J=this.Ya.text.lastIndexOf("[");this.Feb=l+1>=J?l+2:J+1}return this.Ya.text.substring(this.Feb,this.Ya.textBox.caretPosition)};Aa.prototype.ite=function(){this.f5f()&&(this.gah(),this.Rt&&(this.nja=!1,this.yW=this.g4e(),this.Ef.PJa(this.Rt,this.yW,!0,void 0,void 0,!0),this.show(),We.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Aja.Jsb()))};Aa.prototype.gte=function(){this.f5f()&&
(this.s0b&&this.s0b.cancel(),this.uh.wzb?(this.kxa()&&this.bEe(!0),this.get_visible()?this.YTe():this.c3d=la.AsyncMethodContext.av(this.YTe,Cb.zdh,mh.a.sFh,this.s0b)):this.f_())};Aa.prototype.f5f=function(){return this.Ya?0<this.$.zb.pS||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):tf.f(this.$.qa)?!1:!0:!1};Aa.prototype.arb=function(l){this.Ya&&this.isListVisible&&(this.lnd(this.Ya.text,l),this.Ya.textBox.caretPosition=l.range.start.character+l.newText.length,this.set_visible(!1))};
Aa.prototype.kz=function(){var l;if(!this.Ya||!this.isListVisible)return!1;var J="",Y=0,za=Je.g(this.$),Ua=this.Ya.text,Qb=0,uc=this.Ef.we,ed=!1;if(0===this.Ef.jx||2===this.Ef.jx||3===this.Ef.jx||7===this.Ef.jx)J+=Ua.substr(0,this.I3a)+this.Ef.we,0!==this.Ef.jx||this.Ef.we.endsWith(")")||(J+="("),Y=J.toString().length,J+=Ua.substr(this.iac),2===this.Ef.jx&&(Qb=4,uc="DefinedName",ed=!0,this.set_visible(!1));else if(1===this.Ef.jx)if(this.nja=!0,this.Dka){J+=Ua.substr(0,this.o4+2);!J.toString().endsWith(ja.a.rV)&&
We.EwaSettings.ma(136)&&(J+=ja.a.rV);Qb=this.Ef.we;Qb=Qb.replace("'","''");Qb=Qb.replace("[","'[");Qb=Qb.replace("]","']");if(this.F6c||this.OAh(Qb))Qb=ja.a.Isi+Qb+ja.a.kjj,ed=!0;J+=Qb;Y=J.length;Qb=3;Ra.a("PulloutFieldAccepted")}else return this.Ya.text=this.Ef.we,this.set_visible(!1),za.Kp(!1),za.focus(),this.xkc("FieldName",1,1,1),Ra.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Ef.jx)Cd.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),
J+=Ua.substr(0,this.Feb),da.a.equals(this.Ef.we,"@ - "+this.instantaneousSupportInformationManager.Ge.ThisRowStructRefString,!1)?J+="@":(J+=this.Ef.we,ed=!0,this.set_visible(!1)),Y=J.length;else if(4===this.Ef.jx){Cd.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");J+=Ua.substr(0,this.Feb);ed="";Y=!1;for(var Dd=[39,91,93,64,35],hd=0;hd<this.Ef.we.length;hd++){var Ke=this.Ef.we.charCodeAt(hd);Array.contains(Dd,Ke)&&(ed+="'");ed+=
this.Ef.we.charAt(hd).toString();Y||da.a.isNumeral(Ke)||da.a.yff(Ke)||(Y=!0)}Dd=Je.g(this.$).Fj?this.Uub.IQ:this.nqb.IQ;Ua=We.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Ua.charAt(Dd+1)&&Y:Ua.lastIndexOf(Cb.llf)+1>=Ua.lastIndexOf("[")&&Y;J+=Ua?"["+ed+"]":ed;ed=!0;this.set_visible(!1);Y=J.toString().length}else if(6===this.Ef.jx)J+=Ua.substr(0,this.Vsb);else return Cd.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),
!1;this.Ya.text=J;this.Ya.textBox.caretPosition=Y;this.Ya.Cxa()&&(null===(l=za.Zr)||void 0===l?0:l.hva)&&za.Zr.kKb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.Iv.length);za.Fj&&(l=za.rc,l.text=this.Ya.text,l.setCaretPosition(this.Ya.textBox.caretPosition));uc=(null==this.nja?0:this.nja)?"FieldName":uc;this.Ef.Vk.sectionRowIndex>=this.Ef.fX.length?this.xkc(uc,4,Qb,0):this.xkc(uc,1,Qb,0);ed||(5===this.Ef.jx||4===this.Ef.jx?this.ite():this.Sob());return!0};
Aa.prototype.f_=function(l,J){l=void 0===l?null:l;J=void 0===J?null:J;l?(this.uh.mcb(),this.uh.f_(l,!1,!1,J)):(l=Je.g(this.$),l.ha.ta.Lg&&(l=Gf.v(l.ha.ta.ud,this.$),this.uh.f_(l,!0,!0,J)))};Aa.prototype.hna=function(){this.ega=!1;this.Ya.sJe()};Aa.prototype.cRh=function(l){l=this.calcManager.getWorksheetFuncId(l);return this.LWe?this.LWe.descriptionsMap.get(l):null};Aa.prototype.bEe=function(l){if(this.jki()){if(this.uh.wzb&&this.uh.Mk&&(!this.uh.Mk.length||!this.uh.Mk[0].FieldInfoDataList))return;
this.UQj(l)}l=Ha.asEnumerable(this.QGa);l=Ha.concat(l,this.eTh(this.Ya.text));We.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.$k&&(l=Ha.concat(l,this.nUh()));Ha.OBc(l,function(J){return J.name},new Qf);this.mBa&&(l=Ha.concat(Ha.asEnumerable(this.WSa),l),We.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.WSa.length&&(this.nBa=!0),this.WSa=[]));this.U8=Ha.toArray(l)};Aa.prototype.gah=function(){var l=this.Ya.text;
if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var J=Je.g(this.$).Fj?this.Uub.vIa:this.nqb.vIa,Y=!0;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==J&&(this.Cg=Object(S.a)(Gk.a,this.$.Hb.getItemByName(J))),this.Cg||(this.Cg=this.tableManager.Cg,Y=!1),!this.Cg){Cd.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",
this.$.Hb.count,""===J);return}}else this.Cg=Object(S.a)(Gk.a,this.$.Hb.getItemByName(J)),this.Cg||(this.Cg=this.tableManager.Cg,Y=!1);this.Cg.$O&&this.Cg.$O.IsFullTableHeaders?this.kIf(Y):Lj.d(this.Cg)?(Cd.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Cg.jj),Td.I(this.$.na.va,this.Cg.jj,this.mNi,this.lNi,null,null)):Cd.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",
this.Cg.jj)}else if(this.calcManager&&this.tableManager.Cg)if(J=this.calcManager.V4a(this.tableManager.Cg))if(this.calcManager.xJg(this.tableManager.Cg,J)){l=Ha.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var za=this.k1a("@ - "+this.instantaneousSupportInformationManager.Ge.ThisRowStructRefString);l=Ha.concat(l,(Y=new P.a,Y.add(za),Y))}l=Ha.concat(l,Ha.select(Ha.asEnumerable(J.toArray()),function(Ua){var Qb=new Yb,uc=new ta;uc._name=Ua.toString();Qb.S0f(uc);return Qb}));this.U8=
Ha.toArray(l)}else l.endsWith("[")&&"["!==l.charAt(l.length-2)&&Cd.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",J.count,this.tableManager.Cg.jj,this.tableManager.Cg.usedRange.right-this.tableManager.Cg.usedRange.left+1);else l.endsWith("[")&&"["!==l.charAt(l.length-2)&&Cd.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};
Aa.prototype.OAh=function(l){if(!l)return!1;var J=l.charCodeAt(0);if(46===J||48<=J&&57>=J||63===J)return!0;for(var Y=0;Y<l.length;Y++,J=l.charCodeAt(Y))if(!((We.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?da.a.isLetter(J):da.a.aqd(J))||92===J||95===J||63===J||48<=J&&57>=J))return!0;return!1};Aa.prototype.bEd=function(l,J){var Y=!1,za=!1,Ua=!1,Qb=0,uc=0;this.I3a=0;this.iac=J;this.K5b=1;for(var ed=J-1;0<=ed;--ed)switch(l.charCodeAt(ed)){case 39:za=
!za;break;case 34:Y=!Y;break;case 91:++Qb;Ua=Qb>uc;break;case 93:++uc}Ua=Object(tg.a)(new Wa,{lta:!Y,mta:!za,oia:!Ua,aGb:1});Qb=this.JXi(l,J,Ua);J=this.KXi(l,J,Ua.lta,Ua.mta,Ua.oia);this.K5b=Qb+J;if(this.iRc=Qb-1)this.Pxc=!1;this.CBh(l,Y,za,Ua.DDd,Ua.EDd)};Aa.prototype.Vmd=function(){4!==this.fDb&&Je.g(this.$).ha.hsa(this.wuf);var l=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveCellChangedArgs",!1)?this.gridView.mc(null):void 0;this.KDb(l);og.a.cgc&&Je.g(this.$).kk.eZa(this.K6);
Aa.gNd(this.pluginScheduler);this.mBa&&this.wXg()};Aa.prototype.Zzh=function(){return this.mBa||this.hTe};Aa.prototype.LXi=function(){var l=this.d6;if(!this.$xj||!l)return this.o4=0,this.QGa=this.U8=null,!1;l=l.endsWith(ja.a.rV);var J;if(J=We.EwaSettings.ma(136)){J=this.tOj(this.d6.substring(0,this.p4));var Y=J.sheetRange;J=J.returnValue}return J&&(J=this.d6.substring(0,this.o4),l&&J!==this.Ksd)?(this.Ksd=J,this.o4=this.d6.length-(l?1:0),this.f_(Y,this.d6),this.nja=!1,Cd.ULS.sendTraceTag(537162015,
0,50,"Begin dot notation autocomplete"),!0):!1};Aa.prototype.eTh=function(l){var J=new P.a;this.calcManager&&We.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Cd.ULS.shipAssertTag(537162014,0,!!this.calcManager.zta(sg.Range.hd(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.hTe&&(l=this.calcManager.extractLetVariables(l,this.Ya.textBox.caretPosition))){l=Cl(l);for(var Y=l.next();!Y.done;Y=l.next()){var za=
Y.value;Y=new ra;Y._name=za;Y.b$=se.a.instance.fa(2163);za=new Yb;za.Orj(Y);J.add(za)}}return J};Aa.prototype.nUh=function(){for(var l=new P.a,J=this.$.Hb.items,Y=0,za=J.length;Y<za;Y++){var Ua=J[Y];if(tf.n(Ua)){var Qb=new ac;Qb._name=Ua.name;Ua=new Yb;Ua.guj(Qb);l.add(Ua)}}return l};Aa.prototype.k1a=function(l){var J=new Yb,Y=new kb;Y._name=l;J.huj(Y);return J};Aa.prototype.kIf=function(l){var J=new P.a,Y=this.Ya.text.charCodeAt(this.Ya.text.length-1),za=this.Ya.textBox.caretPosition-1;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
91===this.Ya.text.charCodeAt(za):91===Y){var Ua=this.k1a("@ - "+this.instantaneousSupportInformationManager.Ge.ThisRowStructRefString);J.add(Ua)}Ua=Cl(this.Cg.$O.HeadersList);for(var Qb=Ua.next();!Qb.done;Qb=Ua.next()){Qb=Qb.value;var uc=new Yb,ed=new ta;ed._name=Qb.Name;uc.S0f(ed);J.add(uc)}Ua=Je.g(this.$).Fj?this.Uub.IQ:this.nqb.IQ;Qb=this.Ya.text.charCodeAt(Ua+1);(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!l||za!==Ua&&35!==Qb:!l||91!==Y&&35!==
Y)||(l=this.k1a("#"+this.instantaneousSupportInformationManager.Ge.AllStructRefString),J.add(l),l=this.k1a("#"+this.instantaneousSupportInformationManager.Ge.DataStructRefString),J.add(l),l=this.k1a("#"+this.instantaneousSupportInformationManager.Ge.HeadersStructRefString),J.add(l),l=this.k1a("#"+this.instantaneousSupportInformationManager.Ge.TotalsStructRefString),J.add(l));J&&(this.U8=J.toArray())};Aa.prototype.UQj=function(l){var J=Ha.empty();!l&&this.functionInfoManager.E_&&(J=Ha.concat(J,Ha.select(Ha.asEnumerable(this.functionInfoManager.hac),
function(Y){var za=new Yb;za.s_f(Y);return za})),l=this.w6b.VHe,0<l.length&&(J=Ha.OBc(Ha.concat(J,Ha.select(Ha.asEnumerable(l),function(Y){var za=new Yb;za.rqj(Y);return za})),function(Y){return Y.name},new Qf)));if(this.uh.wzb&&this.uh.Mk){if(!this.uh.Mk.length||!this.uh.Mk[0].FieldInfoDataList)return;J=Ha.OBc(Ha.concat(J,Ha.select(Ha.asEnumerable(this.uh.Mk[0].FieldInfoDataList),function(Y){var za=new Yb;za.Qqj(Y);return za})),function(Y){return Y.name},new Qf);this.columnName=this.uh.Mk[0].ColumnName}this.QGa=
Ha.toArray(J)};Aa.prototype.KDb=function(l){var J;if(1!==this.fDb){var Y=Je.g(this.$).ha.ta.activeCell;if(Y){this.formulaAssistanceTelemetryManager.RI(["convertToSheetGridCell"]);var za=this.calcManager.zta(Y,!this.Dod);this.formulaAssistanceTelemetryManager.bF(["convertToSheetGridCell"]);if(za){var Ua=this.$.xa,Qb=za.sheet.index;0>=Ua.count||0>Qb||Qb>=Ua.count||(Qb=Ua=null,this.pzd&&void 0!==this.calcManager&&null!==this.calcManager&&(this.formulaAssistanceTelemetryManager.RI(["getActiveSheetCellFromRange"]),
l=null!==(J=null===l||void 0===l?void 0:l.cell)&&void 0!==J?J:Je.g(this.$).Ea.hs(Y),this.formulaAssistanceTelemetryManager.bF(["getActiveSheetCellFromRange"]),l&&(J=this.calcManager.lcc(l.Ck),void 0!==J&&null!==J&&(Ua=J.FormatString,Qb=J.Builtin))),2!==this.fDb&&(this.formulaAssistanceTelemetryManager.RI(["setActiveCell"]),this.pluginScheduler.notifier().setActiveCell(Object(tg.a)(new Ta,{colIndex:za.range.col,rowIndex:za.range.row,sheetIndex:this.$.xa.getItem(za.sheet.index).sheetId,docName:za.sheet.document.name,
docPath:za.sheet.document.path,formatString:Ua,builtIn:Qb})),this.formulaAssistanceTelemetryManager.bF(["setActiveCell"])))}}}};Aa.prototype.wXg=function(){Je.g(this.$).Fj?this.Uub.VU(!1):this.nqb.VU(!1)};Aa.prototype.Yif=function(l){var J=We.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?da.a.isLetter(l):da.a.aqd(l);return 48<=l&&57>=l||46===l||95===l||J};Aa.prototype.show=function(){if(this.Rt){var l=this.Ef.zeg(0);this.$k?0<this.Ef.Gq.length?
l||this.T4f():this.Ksb():((l=0<this.Ef.Gq.length)&&this.formulaAssistanceTelemetryManager.RI(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&l&&this.Ef.F4i(this.Ef.Gq.length,this.columnName),this.isListVisible=l,this.Aja.show(this.HQ),this.fCa(!0),this.Ef.wya(),l&&this.formulaAssistanceTelemetryManager.bF(["autoCompleteRender"]))}};Aa.prototype.KXi=function(l,J,Y,za,Ua){for(Y=Object(tg.a)(new Wa,{PFf:41,FAe:40,lta:Y,mta:za,oia:Ua});J<l.length&&!this.KGf(l,J,Y);++J);return Y.aGb};Aa.prototype.JXi=
function(l,J,Y){for(--J;0<=J&&!this.KGf(l,J,Y);--J);return Y.aGb};Aa.prototype.KGf=function(l,J,Y){var za=l.charCodeAt(J);0>=this.p4&&(this.p4=l.substring(0,J).lastIndexOf(ja.a.rV));46===za&&(J<this.p4?this.p4=J:J>this.Vsb&&(this.o4=this.Vsb=J));if(!this.Yif(za)&&!Aa.Cpi(za)&&(!this.Dka||J<=this.p4||!Aa.p9h(za,Y))){Y.Pwf&&(Y.Pwf=!1,this.I3a=J+1);if(Y.hCd){Y.EDd=J+1;if(this.functionInfoManager.yfd(l.substring(Y.EDd,Y.DDd)))return!0;Y.hCd=!1}switch(za){case 39:Y.mta=!Y.mta;break;case 34:Y.lta=!Y.lta;
break;case 91:Y.oia=!1;break;case 93:Y.oia=!0}za===this.$.listSeparator.toString().charCodeAt(0)&&Y.mta&&Y.lta&&!Y.w0a&&(!this.Dka||Y.oia)&&(J<Y.VNd||-1===Y.VNd)&&(Y.aGb+=1,this.K5b++);za===Y.FAe&&Y.lta&&Y.mta&&(!this.Dka||Y.oia)?Y.w0a+=1:za===Y.PFf&&Y.lta&&Y.mta&&(!this.Dka||Y.oia)?0<Y.w0a?--Y.w0a:(Y.VNd=Y.XUe,Y.XUe=J,0<J&&this.Yif(l.charCodeAt(J-1))&&(Y.hCd=!0,Y.DDd=J)):this.Dka&&46===za&&J>this.p4&&(J<this.p4?this.p4=J:J>this.Vsb&&(this.o4=this.Vsb=J))}return!1};Aa.prototype.CBh=function(l,J,Y,
za,Ua){this.iac>this.I3a&&0<=this.I3a?J||Y||(this.yW=l.substring(this.I3a,this.iac)):this.yW=null;za!==Ua?(l=l.substring(Ua,za),this.HQ&&da.a.equals(this.HQ.NameDataStrings,l,!0)||(this.Pxc=!0),this.HQ=this.functionInfoManager.yfd(l)):(this.Pxc=!1,this.HQ=null)};Aa.prototype.d8f=function(l){var J=$get(Cb.EGf+"_"+Cb.$Fb,this.domElement),Y=$get(Cb.FGf+"_"+Cb.$Fb,this.domElement);l&&!this.kec?(J&&zi.a.instance.pa(Bg.a.click,J,this.Qca),Y&&zi.a.instance.pa(Bg.a.click,Y,this.Qca),this.kec=!0):this.kec&&
(J&&zi.a.instance.za(Bg.a.click,J,this.Qca),Y&&zi.a.instance.za(Bg.a.click,Y,this.Qca),this.kec=!1)};Aa.prototype.tOj=function(l){var J=this;var Y=null;var za;if(function(){var ed=Gf.Z(l,J.$.ea.xa);Qb=ed.sheetName;za=ed.range;return ed}().returnValue&&za){if(!Qb){var Ua=Object(S.a)(Kb.a,this.$.qa);if(!Ua)return{returnValue:!1,sheetRange:Y};var Qb=Ua.name}Y=Gf.v(za,this.$);Y.SheetName=Qb;this.F6c=!1;return{returnValue:!0,sheetRange:Y}}var uc=null;return function(){var ed=J.w6b.cOj(l);Qb=ed.sheetName;
uc=ed.range;return ed}().returnValue?(Y=Gf.v(uc,this.$),Y.SheetName=Qb,this.F6c=!0,{returnValue:!0,sheetRange:Y}):{returnValue:!1,sheetRange:Y}};Aa.prototype.eNd=function(l){this.pluginScheduler.requester().runAuthoringExperiment({content:l})};Aa.prototype.Yld=function(){if(1===this.Ef.fX.length&&this.Rt.length){var l=this.Rt[this.Ef.fX[0]];if(1===l.itemType){var J=l.name;l=this.Ya.text;J=J.substring(l.length,J.length);J.length&&(this.Ya.text=l+J,this.Ya.textBox.selectRange(l.length,this.Ya.text.length))}}else Cd.ULS.shipAssertTag(537162007,
0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Ef.fX.length)};Aa.prototype.xkc=function(l,J,Y,za){var Ua={};Ua.a=l;Ua.b=J;Ua.c=Y;Ua.d=za;Zg.b().Pe(38,Ua,!0)};Aa.prototype.hte=function(l,J){if(!this.functionInfoManager.E_){if(l)if(this.bEd(this.Ya.text,this.Ya.textBox.caretPosition),this.mBa||this.yW){var Y={};Y.Filter=this.yW?this.yW.charAt(0).toString():"";Y.FilterType=1;Y.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.A2a(Y)}else We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)&&this.get_visible()&&this.set_visible(!1);if(!J)return}0<this.$.zb.pS||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):l&&(this.bEd(this.Ya.text,this.Ya.textBox.caretPosition),this.Aja.update(this.HQ,this.K5b,this.iRc,this.Pxc),this.d6=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.p4=this.d6.indexOf(ja.a.rV),this.o4=this.d6.lastIndexOf(ja.a.rV),this.LXi()?(l=new Yb,l.Esj(),this.QGa=this.U8=l=[l],this.Ef.PSj(l),this.show()):((this.Zzh()||this.kxa())&&this.bEe(!1),0<this.o4?this.Ef.PJa(this.Rt,
this.d6,!1,void 0,this.d6.lastIndexOf(ja.a.rV),!1):this.Ef.PJa(this.Rt,this.yW,!1,void 0,this.o4,!1),this.show(),this.$k&&(this.Ef.Gq.length||Je.g(this.$).kk.hL?this.Aja.Jsb():(this.Aja.xLd(),this.$k&&this.Ksb()))))};Aa.prototype.T4f=function(){var l=this;if(0<this.Ef.Gq.length){this.formulaAssistanceTelemetryManager.RI(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var J={};J.zoomLevel=ub(this.$);this.formulaAssistanceUIControl.updateContext(J);this.Zq=function(){l.formulaAssistanceUIControl.renderAutoCompleteMenu(l.I0b,
Je.g(l.$).kk.textBox.domElement,l.vfd())};this.Zq();this.$k&&this.Ef.Dic&&this.raiseEvent(Aa.Mcd,null);this.Znd||this.Ef.Dic||this.raiseEvent("FormulaAutoCompleteShown");this.Znd=this.rr.canReceiveFocus=!0;this.ief&&this.formulaAssistanceTelemetryManager.W$e(this.Ef.I3b)}this.formulaAssistanceTelemetryManager.bF(["autoCompleteRender"]);!We.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.WSa&&null!==this.WSa&&0<this.WSa.length&&(this.nBa=!0)}};Aa.prototype.Qud=
function(){this.OIa&&(this.formulaAssistanceTelemetryManager.kZ.selectByArrowKeyCounter++,this.OIa=!1);this.PIa&&(this.formulaAssistanceTelemetryManager.kZ.selectByMouseHoverCounter++,this.PIa=!1);this.gua&&(this.formulaAssistanceTelemetryManager.kZ.commitByTabKeyCounter++,this.gua=!1);this.eua&&(this.formulaAssistanceTelemetryManager.kZ.commitByEnterKeyCounter++,this.eua=!1);this.fua&&(this.formulaAssistanceTelemetryManager.kZ.commitByMouseClickCounter++,this.fua=!1);this.ief&&(this.eua||this.fua||
this.gua)&&this.formulaAssistanceTelemetryManager.V$e(this.jOd.kind)};Aa.prototype.vfd=function(){var l=new sb;l.completionItems=this.Ef.I3b;l.activeItemIndex=this.Ef.Vk?this.Ef.Vk.rowIndex:-1;this.VId(l);return l};Aa.prototype.VId=function(l){l.callbacks=new db;l.callbacks.onCompletionItemSelected=this.OAd;l.callbacks.onCompletionItemCommitted=this.NAd;l.callbacks.onFeedback=this.LRa;l.callbacks.onDismiss=this.onDismiss;l.callbacks.onRestoreFocus=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?
this.onRestoreFocus:void 0};Aa.prototype.KFd=function(l){this.ega=!0;var J=l.textEdit.newText;this.Ya.LSa(J.substring(this.Ya.text.length-l.textEdit.range.start.character,J.length))};Aa.prototype.JBe=function(){this.kz(!0);this.ega=this.isListVisible=!1;this.XSa=!0};Aa.prototype.lnd=function(l,J){this.Ya.text=l.substring(0,J.range.start.character)+J.newText+l.substring(J.range.end.character,l.length);Je.g(this.$).Fj&&(Je.g(this.$).rc.text=this.Ya.text)};Aa.gNd=function(l){l.requester().runExperiment(new qa)};
Aa.r3g=function(l){var J=Yb.Q$g(),Y={IsCompatibility:!1};Y.NameDataStrings=l.label;Y.Help=l.detail;J.s_f(Y);J.textEdit=l.textEdit;return J};Aa.oKa=function(){var l=String.format(Cb.wGh,Cb.edd,tk.a.OOe),J=String.format(Cb.rGh,Cb.cdd,Ji.a.V9c,D.a.lm,D.a.gq),Y=String.format(Cb.oGh,Cb.Xcd,Ji.a.V9c,D.a.lm,Ji.a.EPe,D.a.gq);return String.format("{0}\r\n{1}\r\n{2}",l,J,Y)};Aa.Cpi=function(l){return 36===l||58===l||33===l||39===l||32===l};Aa.p9h=function(l,J){return 32===l||91===l||!J.oia};Ck.Object.defineProperties(Aa.prototype,
{St:{configurable:!0,enumerable:!0,get:function(){return this.Ef}},Rt:{configurable:!0,enumerable:!0,get:function(){return this.U8}},cKb:{configurable:!0,enumerable:!0,get:function(){return this.Ef.we}},DWe:{configurable:!0,enumerable:!0,get:function(){return this.Ef}},fWe:{configurable:!0,enumerable:!0,get:function(){return this.Aja}},Ef:{configurable:!0,enumerable:!0,get:function(){return this.Cpg}},p1a:{configurable:!0,enumerable:!0,get:function(){return this.mBa?this.Ya?this.Ya.text:null:this.yW}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.St.isListVisible},set:function(l){this.$k&&!l&&this.Ksb();this.St.isListVisible=l}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Pxg}},Dka:{configurable:!0,enumerable:!0,get:function(){return 0<this.o4}},AK:{configurable:!0,enumerable:!0,get:function(){return this.ega}},s0b:{configurable:!0,enumerable:!0,get:function(){return this.c3d}},o4:{configurable:!0,enumerable:!0,get:function(){return this.jKe},
set:function(l){this.jKe=l;l||(this.p4=0)}},$xj:{configurable:!0,enumerable:!0,get:function(){if(null==this.Vpc){var l=this.$.wc;this.Vpc=!!l&&!l.inEmbedView}return this.Vpc}},jOd:{configurable:!0,enumerable:!0,get:function(){return this.Ef.I3b[this.Ef.Vk.rowIndex]}},LWe:{configurable:!0,enumerable:!0,get:function(){!this.fdd&&this.pluginScheduler&&(this.fdd=this.pluginScheduler.getFunctionsShortDescriptions());return this.fdd}}});Aa.Mcd="FACardOpened";Aa.hcd="FAFocusOnSmartSuggestionsCard";Aa.uld=
null;Object(Vd.a)(Aa,"FormulaAssistanceControl",ni.a,[662,660,2,663,664]);var vc=Si.a;Am(va,vc);va.prototype.soe=function(l){this.addHandler("FAFunctionNameUpdated",l)};va.prototype.aRf=function(l){this.removeHandler("FAFunctionNameUpdated",l)};va.prototype.fpe=function(l){this.addHandler("FAParameterSelectionChangedOld",l)};va.prototype.wRf=function(l){this.removeHandler("FAParameterSelectionChangedOld",l)};va.prototype.epe=function(l){this.addHandler("FAParameterSelectionChanged",l)};va.prototype.vRf=
function(l){this.removeHandler("FAParameterSelectionChanged",l)};va.prototype.iFg=function(l){this.addHandler("DC",l)};va.prototype.Rbj=function(l){this.removeHandler("DC",l)};va.prototype.dismiss=function(){this.lw=!1;this.formulaAssistanceUIControl&&(this.Zq=null,this.CR&&this.pH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.xla=null,this.rr.canReceiveFocus=!1)};va.prototype.show=function(l,J){var Y=this;this.lw=!0;var za=this.tFd(l);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.RI(["argumentAssistanceRender"]),
l={},l.zoomLevel=ub(this.$),this.formulaAssistanceUIControl.updateContext(l),We.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Zq=function(){Y.formulaAssistanceUIControl.renderArgumentAssistanceCard(Y.domElement,J,za)},this.Zq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,J,za),this.xEd(za),this.CR&&this.pH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Zq,function(){return Y.formulaAssistanceUIControl.dismiss(Y.domElement)}),
this.rr.canReceiveFocus=!0,this.formulaAssistanceTelemetryManager.bF(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.q8b("argumentAssistanceOverall"))};va.prototype.dispose=function(){if(this.$){var l=Je.g(this.$);l&&(l.ha&&l.ha.cG(this.kd),l.view.Yq(this.ot),this.CR&&l.Ac.Zn(this.Ng))}hh.a.Ha(this.rr);this.$=null};va.prototype.tFd=function(l){var J=new cc;J.functionRenderingInfo=l;J.cardMode=this.q3;this.XId(J);return J};va.prototype.XId=function(l){l.callbacks=new Pa;l.callbacks.onHelpLink=
this.dwb(l.functionRenderingInfo);l.callbacks.onCardModeChange=this.onCardModeChange;l.callbacks.onFeedback=this.LRa;this.Mba&&(l.callbacks.onDismissClick=this.onDismissClick)};va.prototype.dwb=function(l){var J=this;return function(){tb(J.$,l.helpID,l.isUDF)}};va.prototype.KPd=function(){var l=Bi.a.get(oa.a.h0b);this.q3=l?parseInt(l,10):va.u6c;this.formulaAssistanceTelemetryManager.VYf(this.q3)};va.prototype.xEd=function(l){var J=l.functionRenderingInfo.functionName;this.xla&&da.a.equals(this.xla,
J,!0)?(J=xh.a.map(l.functionRenderingInfo.signatures,function(Y){var za="";0<=Y.signatureParams.activeParam&&Y.signatureParams.activeParam<Y.signatureParams.params.length&&(za=Y.signatureParams.params[Y.signatureParams.activeParam]);return za}),this.raiseEvent("FAParameterSelectionChanged",new ec(J))):(this.xla=J,l=xh.a.map(l.functionRenderingInfo.signatures,function(Y){return Y.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new yd(J,l)))};va.prototype.oOb=function(l){this.q3=
l;try{Bi.a.Mv(oa.a.h0b,l.toString(),Wi.AFrame.Pea)}catch(J){Cd.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",J.message)}};va.oKa=function(){return document.createElement("div")};Ck.Object.defineProperties(va.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.lw},set:function(l){l||this.dismiss();this.lw=l}}});va.u6c=0;Object(Vd.a)(va,"FormulaArgumentAssistanceControl",Si.a,[690]);var ad;(function(l){l[l.Dismissed=
0]="Dismissed";l[l.Smart=1]="Smart";l[l.Simple=2]="Simple";l[l.Mixed=3]="Mixed"})(ad||(ad={}));Object(Vd.b)("UIState",ad);var Fd=Si.a;Am(xa,Fd);xa.prototype.qoe=function(l){this.addHandler("FACardOpened",l)};xa.prototype.$Qf=function(l){this.removeHandler("FACardOpened",l)};xa.prototype.ooe=function(l){this.addHandler("FAFocusOnSmartSuggestionsCard",l)};xa.prototype.YQf=function(l){this.removeHandler("FAFocusOnSmartSuggestionsCard",l)};xa.prototype.poe=function(l){this.addHandler("FormulaAutoCompleteShown",
l)};xa.prototype.ZQf=function(l){this.removeHandler("FormulaAutoCompleteShown",l)};xa.prototype.hWc=function(l){this.addHandler("SelectedRowChanged",l)};xa.prototype.wKd=function(l){this.removeHandler("SelectedRowChanged",l)};xa.prototype.NZb=function(l){this.addHandler("ListBoxUpdated",l)};xa.prototype.ntc=function(l){this.removeHandler("ListBoxUpdated",l)};xa.prototype.dispose=function(){if(this.$){var l=Je.g(this.$);l&&(l.ha&&l.ha.cG(this.kd),l.Ac&&this.Fzb&&l.Ac.Zn(this.Ng),l.view.Yq(this.ot));
this.$.xa&&this.$.xa.Vg(this.ii)}hh.a.Ha(this.rr);this.$=null};xa.prototype.WEg=function(l){this.addHandler("CVIC",l)};xa.prototype.Dbj=function(l){this.removeHandler("CVIC",l)};xa.prototype.Wh=function(l,J){if(!this.visible)return!1;this.XBc(J);var Y;return(Y=this.R4h(J)).Pdc?Y.result:this.Cxj(J)};xa.prototype.cxb=function(l){if(!this.visible)return!1;var J=!1;switch(l){case 1872288872:this.AK&&this.hna();this.visible=!1;J=!0;break;case -798660877:this.Sfb(this.Lwb(this.FX+1));J=!0;break;case 137938150:this.Sfb(this.Lwb(this.FX-
1));J=!0;break;case 2091832999:this.Sfb(this.Lwb(this.FX+8));J=!0;break;case 742457698:this.Sfb(this.Lwb(this.FX-8));J=!0;break;case 125627505:case 267796030:this.arb(this.Rt.items[this.FX]),J=!0}return J};xa.prototype.show=function(l){this.Ya=Je.g(this.$).kk;this.lw=!0;this.FX=0;this.Rt=l;0<this.Rt.items.length&&(this.render(),this.Sfb(this.Lwb(this.FX)),1===this.Rt.items[0].type&&this.Fzb&&(this.nBa=!0));this.formulaAssistanceTelemetryManager.W$e(l.items)};xa.prototype.hna=function(){this.ega=!1;
this.Ya.sJe()};xa.prototype.Cxj=function(l){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(l)};xa.prototype.R4h=function(l){return this.AK?125627505===l||267796030===l?(this.arb(this.Rt.items[this.FX]),{Pdc:!0,result:!1}):!this.CFf||-798660877!==l&&137938150!==l?{Pdc:!1}:{Pdc:!0,result:!1}:{Pdc:!1}};xa.prototype.render=function(){var l=this;this.formulaAssistanceTelemetryManager.RI(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var J={};J.zoomLevel=
ub(this.$);this.formulaAssistanceUIControl.updateContext(J);this.Zq=function(){l.formulaAssistanceUIControl.renderAutoCompleteMenu(l.domElement,l.Ya.textBox.domElement,l.vfd())};this.Zq();this.u4i();this.rr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.bF(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.q8b("autoCompleteOverall")}};xa.prototype.u4i=function(){var l=this.dOb;this.dOb=this.v0h(this.Rt.items);l!==ad.Dismissed&&l!==ad.Smart||this.dOb!==ad.Simple&&this.dOb!==
ad.Mixed||this.raiseEvent("FormulaAutoCompleteShown")};xa.prototype.X4i=function(){var l;if(this.yki&&0!==this.Rt.items.length){var J=0<=this.FX?this.FX:0,Y=this.Rt.items[J];Y={iG:Y.label,description:null!==(l=Y.detail)&&void 0!==l?l:"",selectedIndex:J+1,length:this.Rt.items.length};this.raiseEvent("SelectedRowChanged",Y)}};xa.prototype.arb=function(l){if(this.Ya&&this.visible){var J=l.textEdit;this.lnd(this.Ya.text,J);this.Ya.textBox.caretPosition=J.range.start.character+J.newText.length;this.AK&&
(this.ega=!1,this.Fzb&&(this.XSa=!0),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:l.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.V$e(l.kind)}};xa.prototype.kJg=function(){this.nBa&&(this.formulaAssistanceTelemetryManager.gKa.smartSuggestionShownCounter++,this.nBa=!1);this.XSa&&(this.formulaAssistanceTelemetryManager.gKa.smartSuggestionSelectedCounter++,this.XSa=!1);this.sMb&&
(this.formulaAssistanceTelemetryManager.gKa.smartSuggestionCommittedCounter++,this.sMb=!1)};xa.prototype.vfd=function(){var l=new sb;l.completionItems=this.Rt.items;l.activeItemIndex=this.FX;this.VId(l);return l};xa.prototype.VId=function(l){l.callbacks=new db;l.callbacks.onCompletionItemSelected=this.OAd;l.callbacks.onCompletionItemCommitted=this.NAd;l.callbacks.onFeedback=this.LRa;l.callbacks.onDismiss=this.iKi;l.callbacks.onRestoreFocus=We.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?
this.onRestoreFocus:void 0};xa.prototype.KFd=function(l){this.ega=!0;var J=l.textEdit.newText;this.Ya.LSa(J.substring(this.Ya.text.length-l.textEdit.range.start.character,J.length))};xa.prototype.Sfb=function(l){var J=this.FX;this.FX=l;var Y=this.Rt.items[l];this.AK&&this.hna();J!==l&&this.render();1===Y.type&&We.EwaSettings.Fb()&&!Je.g(this.$).kk.text.includes("\n")&&this.KFd(Y);this.X4i()};xa.prototype.Lwb=function(l){return 0>l?0:Math.min(l,this.Rt.items.length-1)};xa.prototype.lnd=function(l,
J){this.Ya.text=l.substring(0,J.range.start.character)+J.newText+l.substring(J.range.end.character,l.length);Je.g(this.$).Fj&&(Je.g(this.$).rc.text=this.Ya.text)};xa.prototype.Qud=function(){this.OIa&&(this.formulaAssistanceTelemetryManager.kZ.selectByArrowKeyCounter++,this.OIa=!1);this.PIa&&(this.formulaAssistanceTelemetryManager.kZ.selectByMouseHoverCounter++,this.PIa=!1);this.gua&&(this.formulaAssistanceTelemetryManager.kZ.commitByTabKeyCounter++,this.gua=!1);this.eua&&(this.formulaAssistanceTelemetryManager.kZ.commitByEnterKeyCounter++,
this.eua=!1);this.fua&&(this.formulaAssistanceTelemetryManager.kZ.commitByMouseClickCounter++,this.fua=!1)};xa.prototype.XBc=function(l){switch(l){case -798660877:case 137938150:case 2091832999:case 742457698:this.OIa=!0;break;case 125627505:this.gua=!0;break;case 267796030:this.eua=!0}};xa.oKa=function(){return document.createElement("div")};xa.prototype.v0h=function(l){return l.reduce(function(J,Y){return J|=0===Y.type?ad.Simple:ad.Smart},ad.Dismissed)};Ck.Object.defineProperties(xa.prototype,{visible:{configurable:!0,
enumerable:!0,get:function(){return this.lw},set:function(l){l||this.dismiss();this.lw=l}},AK:{configurable:!0,enumerable:!0,get:function(){return this.ega}},CFf:{configurable:!0,enumerable:!0,get:function(){return 1===this.Rt.items.length&&1===this.Rt.items[0].type}}});Object(Vd.a)(xa,"FormulaAutoCompleteControl",Si.a,[689,2,663]);ka.prototype.then=function(l,J){return this.promise.then(l,J)};ka.prototype.resolve=function(l){this.Dvg(l);return null!=l&&"function"===typeof l.then?this.promise.then():
void 0};ka.prototype.reject=function(l){this.lvg(l);return null!=l&&"function"===typeof l.then?this.promise.then():void 0};Object(Vd.a)(ka,"ResolvablePromise",null,[]);ha.prototype.getRichValueFieldListContext=function(l,J,Y,za){this.mkf&&l!==this.mkf&&this.uh.mcb();this.mkf=l;this.uh.f_(l,Y,za,J);this.V9b=new ka;this.uh.wzb?this.V9b.resolve(this.uh.Mk):this.Y8i();return this.V9b.promise};ha.prototype.Y8i=function(){this.uh.EZb(this.Rya);this.uh.GFg(this.Fyf)};ha.prototype.Nbg=function(){this.uh.etc(this.Rya);
this.uh.jcj(this.Fyf)};Object(Vd.a)(ha,"ServerDataProvider",null,[688]);na.prototype.dispose=function(){if(this.$){var l=Je.g(this.$);l&&(l.ha&&og.a.IR()&&l.ha.iAa(this.Rh),this.cgf&&l.Ea&&l.Ea.Fv(this.Qi))}this.Mba&&(Je.g(this.$).Ac.Zn(this.Ng),this.vqa.Rbj(this.Vuf));this.Wfa.Dbj(this.cvf);this.functionInfoManager&&this.functionInfoManager.Nbb(this.onFunctionInfoLoaded);og.a.cgc&&this.Ya&&this.Ya.lIb(this.K6);hh.a.Ha(this.vqa);hh.a.Ha(this.Wfa);this.Wfa=this.vqa=this.functionInfoManager=this.$=
null};na.prototype.Igj=function(){this.JNa=-1;this.KNa=null};na.prototype.j7c=function(){this.Wfa.visible=!1;this.vqa.visible=!1};na.prototype.Wh=function(){this.Pda();return!1};na.prototype.Pda=function(){if(!this.Ya.hL)if(this.formulaAssistanceTelemetryManager.jpb.formulaAssistanceRequestAttemptedCounter++,this.ryj()){this.functionInfoManager.E_||(this.functionInfoManager.fZa(this.onFunctionInfoLoaded),this.functionInfoManager.A2a({}));var l=this.Ya,J=l.text;l=l.textBox.caretPosition;!this.Mba||
this.zSa?(this.formulaAssistanceTelemetryManager.RI(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.ZXf(J,l)):(this.formulaAssistanceTelemetryManager.RI(["autoCompleteComputation","autoCompleteOverall"]),this.qgj(J,l))}else this.formulaAssistanceTelemetryManager.jpb.formulaAssistanceRequestOptimizedCounter++};na.prototype.ZXf=function(l,J){var Y=this;l=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:l,
caretPosition:J},argumentAssistance:{content:l,caretPosition:J}});this.cda+=1;l.then(function(za){--Y.cda;0===za.kind&&(Y.h6e(za.payload.argumentAssistance),Y.L6e(za.payload.functionSuggestion));return null})};na.prototype.qgj=function(l,J){var Y=this;l=this.pluginScheduler.requester().functionSuggestion(Object(tg.a)(new wa,{content:l,caretPosition:J}));this.cda+=1;l.then(function(za){--Y.cda;0===za.kind&&Y.L6e(za.payload);return null})};na.prototype.xLd=function(l,J){var Y=this;l=this.pluginScheduler.requester().argumentAssistance({content:l,
caretPosition:J});this.cda+=1;l.then(function(za){--Y.cda;0===za.kind&&Y.h6e(za.payload)})};na.prototype.ryj=function(){var l=this.Ya,J=l.text;l=l.textBox.caretPosition;if(this.Wfa.visible&&da.a.equals(J,this.KNa,!0)&&l===this.JNa)return!1;this.KNa=J;this.JNa=l;return!0};na.prototype.gNd=function(){this.pluginScheduler.requester().runExperiment(new qa)};na.prototype.h6e=function(l){l&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.bF(["argumentAssistanceComputation"]),this.vqa.show(l,this.Ya.textBox.domElement)):
this.vqa.dismiss()};na.prototype.L6e=function(l){l&&0<l.items.length&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.bF(["autoCompleteComputation"]),this.Wfa.show(l)):this.Wfa.dismiss()};na.prototype.eNd=function(l){this.pluginScheduler.requester().runAuthoringExperiment({content:l})};na.prototype.KDb=function(l){var J,Y=Je.g(this.$).ha.ta.activeCell;if(Y){this.formulaAssistanceTelemetryManager.RI(["convertToSheetGridCell"]);var za=this.calcManager.zta(Y,!this.Dod);this.formulaAssistanceTelemetryManager.bF(["convertToSheetGridCell"]);
if(za){var Ua=this.$.xa,Qb=za.sheet.index;0>=Ua.count||0>Qb||Qb>=Ua.count||(Qb=Ua=null,this.pzd&&void 0!==this.calcManager&&null!==this.calcManager&&(this.formulaAssistanceTelemetryManager.RI(["getActiveSheetCellFromRange"]),l=null!==(J=null===l||void 0===l?void 0:l.cell)&&void 0!==J?J:Je.g(this.$).Ea.hs(Y),this.formulaAssistanceTelemetryManager.bF(["getActiveSheetCellFromRange"]),l&&(J=this.calcManager.lcc(l.Ck),void 0!==J&&null!==J&&(Ua=J.FormatString,Qb=J.Builtin))),this.formulaAssistanceTelemetryManager.RI(["setActiveCell"]),
this.pluginScheduler.notifier().setActiveCell(Object(tg.a)(new Ta,{colIndex:za.range.col,rowIndex:za.range.row,sheetIndex:this.$.xa.getItem(za.sheet.index).sheetId,docName:za.sheet.document.name,docPath:za.sheet.document.path,formatString:Ua,builtIn:Qb})),this.formulaAssistanceTelemetryManager.bF(["setActiveCell"]))}else Cd.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};na.prototype.MTj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.hac)};
na.prototype.Vmd=function(){Je.g(this.$).ha.hsa(this.Rh);var l=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveCellChangedArgs",!1)?Je.g(this.$).mc(null):void 0;this.KDb(l);og.a.cgc&&this.Ya.eZa(this.K6);this.gNd();this.Wfa.WEg(this.cvf);this.pluginScheduler.setServerDataProvider(new ha(this.uh,this.$));this.Pda()};Ck.Object.defineProperties(na.prototype,{Cja:{configurable:!0,enumerable:!0,get:function(){return this.Wfa}},eWe:{configurable:!0,enumerable:!0,get:function(){return this.vqa}},
Ya:{configurable:!0,enumerable:!0,get:function(){return Je.g(this.$).kk}}});Object(Vd.a)(na,"FormulaAssistanceManager",null,[652,2]);var ve=Og.a;Am(aa,ve);aa.prototype.create=function(){var l=this,J=og.a.IR(),Y=We.EwaSettings.ma(375),za=We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),Ua=og.a.uB(this.$),Qb=this.$.da,uc=Hf.GetServiceTaskFactory.create(Qb,134,this.la,this.ub),ed=Hf.GetServiceTaskFactory.Ua(this.$.da,12,477,this.ub);var Dd=og.a.D5()?Hf.GetServiceTaskFactory.create(this.$.da,
449,this.$.la,1):ig.Task.Ra(null);var hd=og.a.IR()?Hf.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):ig.Task.Ra(null);if(za||J){var Ke=Hf.GetServiceTaskFactory.Ua(Qb,266,265,this.ub),zf=Hf.GetServiceTaskFactory.Ua(Qb,219,220,this.ub),Dg=Hf.GetServiceTaskFactory.Ua(Qb,491,492,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([Ke,hd,Dd,zf,Dg],this.la),function(){var Yh=Qb.Aa(19)||new pb(l.$,hd.result),Li=zf.result;if(Ua){var Mh=Qb.Aa(464);Mh||(Mh=new na(l.$,Yh,Ke.result,hd.result,Dd.result,
Dg.result,ed.result.d4c(l.$,uc.result)),Li.aYc(Mh.eWe),Li.bYc(Mh.Cja),We.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Li.cYc(Mh.Cja))}else Mh=Qb.Aa(221),Mh||(Mh=new Aa(l.$,Yh,uc.result,Ke.result,null,ed.result,Dd.result,Dg.result,hd.result),Li.aYc(Mh.fWe),Li.cYc(Mh.DWe),Li.bYc(Mh)),Y&&(Qb.Aa(317)||new xb(l.$));l.Eb(Yh)},this.la,3)}else{var Tg=Hf.GetServiceTaskFactory.Ua(Qb,219,220,this.ub),Rg=Hf.GetServiceTaskFactory.Ua(Qb,491,492,this.ub);Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([Tg,
Dd,hd],this.la),function(){var Yh=Qb.Aa(19)||new pb(l.$,hd.result),Li=Tg.result,Mh=Qb.Aa(221);Mh||(Mh=new Aa(l.$,Yh,uc.result,null,null,ed.result,Dd.result,Rg.result,hd.result),Li.aYc(Mh.fWe),Li.cYc(Mh.DWe),Li.bYc(Mh));Y&&(Qb.Aa(317)||new xb(l.$));l.Eb(Yh)},this.la,3)}};aa.ka=function(l){l.da.Ga(153,new aa(l))};Object(Vd.a)(aa,"FunctionInfoManagerFactory",Og.a,[]);var Me=b(211),fg=b(76),gh=b(117);fa.prototype.XZe=function(){return gh.a(Pf.a.Ta,this.startTime)};Object(Vd.a)(fa,"OngoingAction",null,
[]);var Wh=fg.a;Am(U,Wh);U.prototype.qHf=function(l){Cd.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Ila,this.kMa,this.t6a);this.nob=this.Xzg.MWc(l,this.nob);this.xnd()};U.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.oIb(this.Qya);this.Kxe();Wh.prototype.dispose.call(this)};U.prototype.g0f=function(l){this.OZc?(this.yPa=l?new fa:null,l?this.startTimer():
this.Kxe()):this.yPa=l?{}:null};U.prototype.NUe=function(l){l=void 0===l?null:l;this.OZc&&l&&l.xK?Cd.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.Ila):(Cd.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Ila,this.kMa,this.t6a),this.g0f(!1),this.xnd())};U.prototype.xnd=function(){var l=this;if(!this.NLb()){var J=this.nob;this.nob=null;this.g0f(!0);Cd.ULS.sendTraceTag(537153857,
0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.Ila);var Y=this.OZc?this.yPa.Ox.token:Me.a.none;Pg.TaskExtensions.Ba(this.Wzg.wEd(J),function(){l.NUe(Y)},Y,0,this.bP)}};U.prototype.NLb=function(){return!this.t6a||this.kMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Bi?(Cd.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.Ila),!0):!1};U.prototype.Kxe=function(){this.qpc&&
this.qpc.cancel()};U.prototype.startTimer=function(){this.PZc<=this.hwe&&(this.qpc=pj.a.instance.create(this.RRi,this.jTg,mh.a.$ke))};Ck.Object.defineProperties(U.prototype,{kMa:{configurable:!0,enumerable:!0,get:function(){return!!this.yPa}},t6a:{configurable:!0,enumerable:!0,get:function(){return!!this.nob}}});Object(Vd.a)(U,"ActionAggregator",fg.a,[695,2]);var Ci=b(128),Hj=zg.a;Am(L,Hj);L.prototype.fGg=function(l){this.addHandler("KBIS",l)};L.prototype.Bcj=function(l){this.removeHandler("KBIS",
l)};L.prototype.dispose=function(){this.firstElement&&yi.a.removeHandler(this.firstElement,Bg.a.focus,this.cyf);this.Hs&&this.Hs.detach("focus");this.Rw&&(yi.a.removeHandler(this.Rw,Bg.a.focus,this.Xzf),yi.a.removeHandler(this.Rw,Bg.a.blur,L.onBlur),Bk.KeyInputManager.instance.za(Bg.a.Xb,this.Rw,this.Yzf));Bk.KeyInputManager.instance.za(Bg.a.Xb,this.$.domElement,this.rFf);this.Hs=this.Rw=this.firstElement=this.$=null;Hj.prototype.dispose.call(this)};L.prototype.b7g=function(){this.Gwj?(this.firstElement=
document.documentElement,this.Hs=Ci.a.instance.PE(document.parentWindow),this.Hs.ka("focus",this.lVi)):(this.firstElement=L.FEe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),yi.a.addHandler(this.firstElement,Bg.a.focus,this.cyf))};L.prototype.$7g=function(){this.Rw=L.FEe();this.Rw.id=oa.a.KLe;this.Rw.setAttribute(oa.a.Pt,se.a.instance.fa(855));document.body.appendChild(this.Rw);yi.a.addHandler(this.Rw,Bg.a.focus,this.Xzf);yi.a.addHandler(this.Rw,Bg.a.blur,L.onBlur);Bk.KeyInputManager.instance.pa(Bg.a.Xb,
this.Rw,this.Yzf)};L.prototype.kzh=function(l){this.jag(l);return!1};L.prototype.JKi=function(){this.KMa=!0;Je.g(this.$).focus();Je.g(this.$).ha.F6e();this.raiseEvent("KBIS");return!0};L.prototype.jag=function(l){this.KMa?this.KMa=!1:(this.KMa=!0,l&&l.focus())};L.FEe=function(){var l=document.createElement("div");l.tabIndex=0;return l};L.t9e=function(){document.body.classList.add(D.a.gOe)};L.onBlur=function(){document.body.classList.remove(D.a.gOe)};Object(Vd.a)(L,"EmbedViewFocusControl",zg.a,[696,
2]);var aj=b(60),mk=b(570),Mj=zg.a;Am(H,Mj);H.prototype.EZb=function(l){this.addHandler("FieldInfoListContextLoaded",l)};H.prototype.etc=function(l){this.removeHandler("FieldInfoListContextLoaded",l)};H.prototype.GFg=function(l){this.addHandler("GetFieldInfoListContextOperationFailed",l)};H.prototype.jcj=function(l){this.removeHandler("GetFieldInfoListContextOperationFailed",l)};H.prototype.dispose=function(){this.wb=null;this.mcb();Mj.prototype.dispose.call(this)};H.prototype.f_=function(l,J,Y,za){za=
void 0===za?null:za;if(l){this.F_c();this.W1b();var Ua=null,Qb=!1,uc;if(uc=!za)uc=this.VNj(l,J,Y),Qb=uc.cab,Ua=uc.Mk,uc=uc.returnValue;if(uc&&(this.WZf(Ua),this.rUb=!0,(this.IP=Ua)&&0<this.IP.length&&(this.Mjb=!0,this.fHd()),!Qb))return;this.Sdg(l,za,J,Y,!1)}};H.prototype.Sdg=function(l,J,Y,za,Ua){if(this.$.ea.sc){this.$.Ob&&(this.fJb=this.$.Ob.Hc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Svb=null;var Qb=this.$.na.va.hc(),uc=this.$.na.va,ed=this.eMi,Dd=this.dMi,hd=uc.Na(1,null);hd.selectedRange=
l;hd.richValueKeyPath=J;hd.singleColumn=Y;hd.searchForRange=za;hd.calculateMajorityDataType=Ua;this.Svb=Td.i(uc,"GetRichValueFieldListContextList",hd,ed,Dd,null,Qb,4)}else this.IP=null};H.prototype.mcb=function(){this.IP=null;this.Mjb=!1;this.F_c();this.W1b();this.Svb=null;this.bTb=-1};H.prototype.F_c=function(){H.jqb(this.Svb)};H.prototype.W1b=function(){H.jqb(this.cfd)};H.prototype.fHd=function(){this.raiseEvent("FieldInfoListContextLoaded")};H.prototype.tn=function(l){l=Gf.D(l);--l.left;--l.right;
return this.tableManager.tn(l)};H.prototype.CKa=function(l){var J=this;l.FirstColumn=l.FirstColumn;l.LastColumn=l.LastColumn;l.FirstRow=l.FirstRow;l.LastRow=l.LastRow;this.W1b();this.cfd=null;return af.a(this.$.userOperationManager,function(Y,za,Ua){return Td.w(J.$.na.va,l,lf.b(Y,function(Qb){J.oMi(Qb)}),lf.a(za,za,function(Qb){J.nMi(Qb)}),Ua,null)},function(Y){return new Wg.a(264,0,Y,80)},null)};H.prototype.nMi=function(l){l=Xg.a.pg(l.data);Cd.ULS.sendTraceTag(525336847,0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",
wg.a.Xc(l))};H.prototype.oMi=function(l){if(Bh.a(l))-315732528!==l.Errors[0].MessageId&&Cd.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",wg.a.Xc(l.Errors));else if(l&&l.Result){l=l.Result;var J=l.HasHeaderRow;J=new mk.AutofilterRange(l.TableRange.FirstRow+(J?1:0)+1,l.TableRange.FirstColumn+1,l.TableRange.LastRow+1,l.TableRange.LastColumn+1,null,null,null,0,J);this.bTb=l.TableRange.FirstColumn;(l=this.rKf(!1,!0,J))||
Cd.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.WZf(l)}else Cd.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};H.prototype.VNj=function(l,J,Y){var za=null;var Ua=!1;if(l.SheetName!==this.$.ea.qa.sheetName)return{returnValue:!1,cab:Ua,CKa:!1,Mk:za};this.bTb=-1;if(Y){var Qb=this.tn(l);if(!Qb||!Qb.yba)return{returnValue:!1,cab:Ua,CKa:!1,Mk:za};var uc=Je.g(this.$).Rb.a3e(Qb);
this.C5d=Qb;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&uc&&0<uc.count)return--l.FirstColumn,--l.LastColumn,this.cfd=this.CKa(l),{returnValue:!0,cab:Ua,CKa:!0,Mk:za};Qb.top+=1;Qb.right=Gf.D(l).right-1}else Qb=new mk.AutofilterRange(l.FirstRow+1,l.FirstColumn+1,l.LastRow+1,l.LastColumn+1,null,null,null,0,!1);if(Qb.top>Qb.bottom||Qb.left>Qb.right)return{returnValue:!0,cab:Ua,CKa:!1,Mk:za};l=Je.g(this.$);var ed=l.rb.width,
Dd=l.rb.height;uc=l.view.visibleArea;ed=new aj.a(uc.x-ed,uc.y-Dd,uc.width+ed,uc.height+Dd);Dd=l.qg(Qb);if(!uc||!Dd||!l.iic(Qb))return{returnValue:!1,cab:Ua,CKa:!1,Mk:za};ed.contains(Dd)||(Ua=!0);za=this.rKf(J,Y,Qb);return{returnValue:!0,cab:Ua,CKa:!1,Mk:za}};H.prototype.WZf=function(l){l&&Cd.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",l.length);this.rUb=!0;(this.IP=l)&&0<this.IP.length&&(this.Mjb=!0,this.fHd())};H.prototype.rKf=function(l,J,Y){var za=
null;var Ua=Y.clone();if(J){J=Y.right;for(var Qb=0;J>=Y.left;--J){Ua.left=J;Ua.right=J;var uc=this.k_e(Ua,!0,Y.left);if(uc){za||(za=[]);za[Qb]=uc;if(l)break;++Qb}}}else if(l=this.k_e(Ua,!1))za=[],za[0]=l;return za};H.prototype.k_e=function(l,J,Y){Y=void 0===Y?0:Y;var za=null;if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Ua=Je.g(this.$).Rb.WXh(l);if(Ua&&0<Ua.count){var Qb=Array(Ua.count),uc=0;Ua=Cl(Ua.values);for(za=Ua.next();!za.done;za=Ua.next()){var ed=
{};ed.Name=za.value;Qb[uc]=ed;++uc}uc="";Ua=-1;0<l.top&&J&&(l=new sg.Range(l.top-1,l.left,l.top-1,l.left,!1,!1),null!=Je.g(this.$).mc(l)&&null!=Je.g(this.$).mc(l).originalText&&(uc=Je.g(this.$).mc(l).originalText),Ua=l.left-Y);za={};za.ColumnName=uc;za.ColumnIndex=Ua;za.FieldInfoDataList=Qb}}else if((Ua=Je.g(this.$).Rb.a3e(l))&&0<Ua.count){Qb=Array(Ua.count);uc=0;Ua=Cl(Ua);for(za=Ua.next();!za.done;za=Ua.next())ed={},ed.Name=za.value,Qb[uc]=ed,++uc;uc="";Ua=-1;0<l.top&&J&&(l=new sg.Range(l.top-1,
l.left,l.top-1,l.left,!1,!1),uc=Je.g(this.$).mc(l).originalText,Ua=l.left-Y);za={};za.ColumnName=uc;za.ColumnIndex=Ua;za.FieldInfoDataList=Qb}return za};H.jqb=function(l){l&&Fg.AFrameworkApplication.Jd.Fu(l.Qt)};Ck.Object.defineProperties(H.prototype,{wzb:{configurable:!0,enumerable:!0,get:function(){return this.Mjb}},jui:{configurable:!0,enumerable:!0,get:function(){return this.rUb}},yWe:{configurable:!0,enumerable:!0,get:function(){return this.bTb}},x5c:{configurable:!0,enumerable:!0,get:function(){return this.C5d}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Mk:{configurable:!0,enumerable:!0,get:function(){return this.IP}},RPh:{configurable:!0,enumerable:!0,get:function(){return!!this.Svb}}});Object(Vd.a)(H,"FieldInfoManager",zg.a,[694,2]);Am(I,H);I.prototype.aQh=function(l,J){this.p2a=J;Cd.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",l.FirstRow,l.FirstColumn,
l.LastRow,l.LastColumn);this.Sdg(l,null,!0,!1,!0)};Ck.Object.defineProperties(I.prototype,{ZG:{configurable:!0,enumerable:!0,get:function(){return this.Tlg}}});Object(Vd.a)(I,"FilterInfoManager",H,[693,694,2]);ca.Ysh="ewa-sharedUi-launchButton";ca.ath="ewa-sharedUi-launchButtonWithText";ca.Zsh="ewa-sharedUi-launchButtonClick";ca.bth="ewa-sharedUi-launchButtonWithTextClick";ca.$sh="ewa-sharedUi-launchButtonText";Object(Vd.a)(ca,"CssClassNames",null,[]);var Ej=b(296),nk=Si.a;Am(Z,nk);Z.prototype.h3=
function(l){this.addHandler(this.xGb,l)};Z.prototype.Hda=function(l){this.get_events().removeHandler(this.xGb,l)};Z.prototype.wGg=function(l){this.addHandler("OnObjectButtonMouseOver",l)};Z.prototype.Scj=function(l){this.get_events().removeHandler("OnObjectButtonMouseOver",l)};Z.prototype.vGg=function(l){this.addHandler("OnObjectButtonMouseOut",l)};Z.prototype.Rcj=function(l){this.get_events().removeHandler("OnObjectButtonMouseOut",l)};Z.prototype.adg=function(l){l&&(this.E_a.innerHTML=l)};Z.prototype.dRj=
function(l,J,Y){this.E_a.innerHTML="";l?l.Iba(J,16,16,this.E_a,16,16,void 0,Y):Cd.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};Z.prototype.eRj=function(l,J){l&&(this.nNb.innerText=l);this.domElement.title=J};Z.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.Fc.hB(),hh.a.yc([this.MZ,this.w_a]),zi.a.instance.za(Bg.a.click,this.domElement,this.vd),ik.a.instance.za(Bg.a.pointerDown,this.domElement,this.VN),this.PSa&&this.PSa.dispose(),
nk.prototype.dispose.call(this))};Z.prototype.kcb=function(){this.V2b&&this.domElement.classList.remove(this.V2b);this.wmc&&this.domElement.classList.add(this.wmc)};Z.prototype.vGb=function(){this.wmc&&this.domElement.classList.remove(this.wmc);this.V2b&&this.domElement.classList.add(this.V2b);this.D2a()};Z.prototype.D2a=function(){this.Eic&&(this.PSa.cancel(),this.o7f(),this.setOpacity(1));this.set_visible(!0)};Z.prototype.Jp=function(l,J,Y,za,Ua){Ua=void 0===Ua?!1:Ua;l=Df.a(za).Fi(l);J=Df.a(za).Fi(J);
Df.a(za).Swc(this.domElement);this.domElement.style.top=md.HelperMethods.nc(J);this.domElement.style.left=this.domElement.style.right="";J=l;Ua&&(J=l-this.domElement.offsetWidth);Sg.c(this.domElement.style,Y,md.HelperMethods.nc(J));this.set_visible(!0);this.setOpacity(1);this.Eic&&(this.ATd=!1,this.BFj(),this.PSa.$q())};Z.prototype.hide=function(){this.kcb();this.set_visible(!1);this.Eic&&(this.o7f(),this.PSa.cancel())};Z.prototype.j8b=function(){this.Fc.ka("mouseover",this.bO,!0);this.Fc.ka("mouseout",
this.aO,!0)};Z.prototype.BFj=function(){this.MZ.wn("mousemove")||this.MZ.ka("mousemove",this.pKi)};Z.prototype.o7f=function(){this.MZ.wn("mousemove")&&this.MZ.detach("mousemove")};Z.prototype.ujd=function(l){if(this.domElement.parentNode){var J=Sys.UI.DomElement.getBounds(this.domElement),Y=new Sys.UI.Point(Math.round(J.x+J.width),Math.round(J.y+J.height));J=Math.abs(Y.x-l.x);l=Math.abs(Y.y-l.y);l=J>l?J:l;this.ATd?this.setOpacity(Z.mUg(l)):100>=l&&this.lle()}};Z.prototype.lle=function(){this.ATd=
!0;this.PSa.cancel()};Z.prototype.setOpacity=function(l){Jj.a.setOpacity(this.domElement,l);this.zkf=Pf.a.Ta.Wb};Z.mUg=function(l){return 100>=l?1:250<=l?0:.01*(100-(l-100)/150*100)};Object(Vd.a)(Z,"OnObjectButton",Si.a,[704,146,2]);var Xk=b(1003),cl=ca.$sh,kl=fg.a;Am(ea,kl);ea.prototype.dispose=function(){this.Xgh();this.$=null;kl.prototype.dispose.call(this)};ea.prototype.getButton=function(l,J){return this.vva(l,void 0===J?!0:J)};ea.prototype.vva=function(l,J){var Y=l.toString();Y in this.buttons||
this.b8g(l,void 0===J?!0:J);return this.buttons[Y]};ea.prototype.Jp=function(l,J,Y,za,Ua,Qb){Ua=void 0===Ua?!0:Ua;Qb=void 0===Qb?!1:Qb;this.hide();if(this.$.ea.isNamedObjectViewMode&&tf.i(this.$.qa)){var uc=Je.g(this.$).SS.domElement,ed=l+this.buttonWidth-uc.scrollWidth;uc=J+this.buttonWidth-uc.scrollHeight;l=0<ed?l-ed:l;J=0<uc?J-uc:J}this.vva(za,Ua).Jp(l,J,Y,this.$,Qb)};ea.prototype.hide=function(){var l=this.buttons,J;for(J in l)l[J].hide()};ea.prototype.j8b=function(l,J){!this.W9e&&(J=this.buttons[J.toString()])&&
(this.Ulc=function(Y,za){l(za,!0)},J.wGg(this.Ulc),this.Tlc=function(Y,za){l(za,!1)},J.vGg(this.Tlc),this.W9e=!0,J.j8b())};ea.prototype.b8g=function(l,J){function Y(Qb,uc){za.HIi(uc,l)}var za=this;this.Hwa=String.format(this.Tld===D.a.$8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',hg.a.Sf(this.Tld),hg.a.Sf(this.Sld),"{0}");var Ua=String.format(this.Hwa,hg.a.Sf(this.altText));J=new Z(""===
this.buttonText?ca.Ysh:ca.ath,""===this.buttonText?ca.Zsh:ca.bth,D.a.Wr,Ua,J,this.xGb,this.buttonText,cl);J.h3(Y);this.buttons[l.toString()]=J;this.qNe[l.toString()]=Y;Ua=Je.g(this.$).Tf(l);Ua.domElement.insertBefore(J.domElement,Ua.domElement.firstChild)};ea.prototype.Xgh=function(){for(var l=Cl(Xk.a(this.buttons)),J=l.next();!J.done;J=l.next()){J=J.value;var Y=this.buttons[J];Y.Hda(this.qNe[J]);hh.a.Ha(Y);delete this.buttons[J];this.Ulc&&Y.Scj(this.Ulc);this.Tlc&&Y.Rcj(this.Tlc)}};ea.prototype.domElement=
function(l){return this.vva(l).domElement};ea.prototype.D2a=function(l){this.vva(l).D2a()};ea.prototype.MOb=function(l,J,Y){Y=void 0===Y?!0:Y;this.Hwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',hg.a.Sf(this.Tld),hg.a.Sf(this.Sld),"{0}");l=String.format(this.Hwa,hg.a.Sf(l));this.vva(J,Y).adg(l)};ea.prototype.oUa=function(l,J,Y){this.vva(Y,!1).eRj(l,J)};ea.prototype.Pdg=function(){var l=void 0===l?!1:l;this.Hwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",hg.a.Sf(this.Sld),"{1}");var J=String.format(this.Hwa,void 0,hg.a.Sf(void 0));this.vva(void 0,l).adg(J)};ea.prototype.Qdg=function(l,J,Y){this.vva(Y,!1).dRj(this.svgIconProvider,l,J)};Ck.Object.defineProperties(ea.prototype,{Ez:{configurable:!0,enumerable:!0,get:function(){return Df.a(this.$).wGa(ze.a.gQi)}},u2b:{configurable:!0,enumerable:!0,get:function(){return ze.a.fQi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return Df.a(this.$).wGa(ze.a.hQi)}}});Object(Vd.a)(ea,"OnObjectLaunchButton",
fg.a,[691,2]);var nl=b(88),ol=nl.a;Am(Q,ol);Q.prototype.dispose=function(){hh.a.Ha(this.lCb);this.lCb=null;ol.prototype.dispose.call(this)};Q.prototype.pBa=function(){hh.a.Ha(this.lCb);this.lCb=pj.a.instance.create(Object(ci.a)(this,this.display,"display"),this.j$h,mh.a.nui)};Q.prototype.kTa=function(){hh.a.Ha(this.lCb);this.hide()};Object(Vd.a)(Q,"LoadingIndicatorBehavior",nl.a,[697,2]);Am(R,Q);R.prototype.dispose=function(){this.kCb=null;Q.prototype.dispose.call(this)};R.prototype.display=function(){this.nog(this.kCb)};
R.prototype.hide=function(){this.v7h(this.kCb)};R.prototype.iCg=function(){this.kCb=document.createElement("div");this.domElement.appendChild(this.kCb)};Object(Vd.a)(R,"ShimmerLoadingIndicatorBehavior",Q,[]);Am(T,Q);T.prototype.dispose=function(){this.dOa=null;Q.prototype.dispose.call(this)};T.prototype.display=function(){id.DOMElementExtensions.setVisible(this.dOa,!0)};T.prototype.hide=function(){id.DOMElementExtensions.setVisible(this.dOa,!1)};T.prototype.hCg=function(){this.dOa=document.createElement("div");
this.dOa.classList.add($c.a.urh);var l=document.createElement("div");l.classList.add($c.a.vrh);this.A5c&&""!=this.A5c&&l.classList.add(this.A5c);var J=0===this.omf?"":se.a.instance.fa(this.omf),Y=String.format('<div class="'+$c.a.wrh+'">{0}</div>',J);this.cfc?(J=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.cfc,J),l.innerHTML=J+Y):l.innerHTML=Y;this.dOa.appendChild(l);this.domElement.appendChild(this.dOa)};Object(Vd.a)(T,"SpinnerLoadingIndicatorBehavior",Q,[]);M.prototype.B4c=function(l,
J,Y){return new Ok.a(l,J,Y)};M.prototype.a5b=function(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd){return new hb(l,J,Y,za,Ua,Qb,uc,ed,Dd,hd)};M.prototype.i1a=function(l,J,Y,za,Ua){return new T(l,J,Y,za,void 0===Ua?0:Ua)};M.prototype.Cgd=function(l){return l.da.Aa(238)||new L(l)};M.prototype.e5b=function(l,J,Y,za,Ua,Qb,uc,ed){return new ea(l,J,Y,za,Ua,Qb,uc,void 0===ed?"":ed)};M.prototype.d4c=function(l,J){return new H(l,J)};M.prototype.X6g=function(l,J,Y,za){return new I(l,J,Y,za)};M.prototype.K3c=function(l,J,Y,
za){return new U(l,J,Y,za)};Object(Vd.a)(M,"SharedUIControlsFactory",null,[651]);var pl=Og.a;Am(A,pl);A.prototype.create=function(){We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)?this.Eb(this.$.da.Aa(12)||new M):this.Eb(new M)};A.ka=function(l){l.da.Ga(477,new A(l))};Object(Vd.a)(A,"SharedUIControlsFactoryServiceFactory",Og.a,[]);var xl=b(1089),ul=Og.a;Am(C,ul);C.prototype.create=function(){var l=this;Cd.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
xl.a.then(this.v9g(),function(J){l.Eb(J);return!0})};C.prototype.v9g=function(){var l=this;if(this.g5b)return this.g5b;var J=ij.a.l1a(Zg.b(),Me.a.none,"LoadResource","x10Scheduler loading");if(We.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Jj.a.vv){var Y=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ga(413,Y);J.setResult(Y);return this.g5b=J.task}this.$.da.$a(266,function(){l.$.da.$a(283,function(za){var Ua=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();
za=zh.b(ig.Task.Ra(za.Jn));excelOnlineCalc.x10.ensureAllPluginsAttached(za).then(function(Qb){l.$.da.Ga(413,Ua);J.setResult(Ua);We.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&l.$.da.$a(491,function(uc){uc.Jna.anyPluginInitialized=Qb})})})});return this.g5b=J.task};C.ka=function(l){l.da.Ga(414,new C(l))};Object(Vd.a)(C,"PluginSchedulerFactory",Og.a,[]);var yl=b(239),ql=fg.a;Am(v,ql);v.prototype.dispose=function(){this.Xp.dispose();this.$=null;ql.prototype.dispose.call(this)};
v.prototype.domElement=function(l){return this.Xp.domElement(l)};v.prototype.getButton=function(l){return this.Xp.getButton(l,!1)};v.prototype.MOb=function(l,J){this.Xp.MOb(l,J,!1)};v.prototype.fBa=function(l,J){var Y=Je.g(this.$),za=Y.rb.rj(l);this.Xp.MOb(J?se.a.instance.fa(1701):se.a.instance.fa(1702),za);J=this.isMac?J?se.a.instance.fa(1705):se.a.instance.fa(1706):J?se.a.instance.fa(1703):se.a.instance.fa(1704);var Ua=Y.qg(l,za);l=Y.Tf(za).Bn;if(Ua&&0<=Ua.x&&0<=Ua.y){var Qb=Ua.bottomRight.x+this.Ez;
Ua=Ua.topLeft.y-this.Ez-this.buttonWidth;if(Ua<l.topLeft.y+this.Ez){if(Y.rb.QTa){this.hide();return}Ua=l.topLeft.y+this.Ez}this.Jp(Qb,Ua,Y.rtl,za);this.ariaLiveNotifier.tQa(J)}else this.hide()};v.prototype.Jp=function(l,J,Y,za){this.Xp.Jp(l,J,Y,za,!1)};v.prototype.hide=function(){this.Xp.hide()};Ck.Object.defineProperties(v.prototype,{Ez:{configurable:!0,enumerable:!0,get:function(){return this.Xp.Ez}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Xp.buttonWidth}}});Object(Vd.a)(v,
"PulloutLaunchButton",fg.a,[]);var sl=fg.a;Am(B,sl);B.prototype.dispose=function(){this.gridView&&(this.gridView.ha.A7(this.wh),this.gridView.view.Yq(this.ot),this.gridView.rc&&this.gridView.rc.kl(this.gj));if(this.$){var l=this.$;l.Ul(this.zd);l.sm(this.Zc);l.AD(this.fj);Je.g(l).gx(this.jS)}this.uh&&this.uh.etc(this.Rya);hh.a.Ha(this.Zh);this.uh=this.$=this.gridView=this.Vob=this.Zh=null;sl.prototype.dispose.call(this)};B.prototype.ny=function(){this.Zh.hide()};B.prototype.Sda=function(){this.Zh?
this.Zh.getButton(this.Xea).kcb():Cd.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};B.prototype.ihj=function(){this.V0=null};B.prototype.eKf=function(){this.Zh&&this.Zh.hide()};B.prototype.a1h=function(){if(!this.Tid||1!==this.selectedRange.width)return null;for(var l=this.selectedRange.clone();this.gridView.V5(l);){l.left+=1;l.right+=1;if(!this.gridView.Tf(this.gridView.rb.rj(l)).Hh.Te(l))break;if(this.gridView.Ea.hs(l)){var J=this.gridView.wk("PulloutManager.GetValidatedRangeToFill",
l,2);try{if(B.OVj(J))return l}finally{J&&J.dispose()}}}return null};B.prototype.huc=function(){this.uh.mcb()};B.prototype.showCallout=function(){var l=this;this.Rwa&&(this.uh.wzb?(this.Zh.getButton(this.Xea).vGb(),We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)?Pg.TaskExtensions.Ba(Hf.GetServiceTaskFactory.Ua(this.$.da,8,9,0),function(J){l.N3f(J.result)},this.$.la,3):this.N3f(this.contextMenuManager)):(this.LZc=!0,this.f_()))};B.prototype.N3f=function(l){l.ved("tableFieldList").k1(null,
this.Zh.domElement(this.Xea),this.uh,null,!0);this.huc()};B.prototype.EUe=function(){if(!this.Rwa||!this.gridView||this.gridView.ha.Oa.oc||!this.gridView.ha.ta.Lg)return null;var l=this.gridView.ha.ta.activeCell,J=Je.g(this.$).rb.rj(l);if(!l)return null;this.RFa=l.clone();var Y=this.tableManager.tn(l);this.pMc=!!Y;if(this.vN){this.Zh.MOb(se.a.instance.fa(1701),J);this.kP=B.Xfg(Y);if(!this.kP)return null;J=this.tableManager.FDe(Y,this.gridView);l=J.lZ;J=J.returnValue||l;this.rFc=l;if(J)return this.wvc=
new sg.Range(Y.top,Y.left,Y.bottom,Y.right,!1,!1),this.BOc=new sg.Range(this.kP.top,this.kP.right+1,this.kP.top,this.kP.right+1,!1,!1),this.kP}else if(this.Tid){this.Zh.MOb(se.a.instance.fa(1702),J);this.bYa=this.gridView.ha.ta.ud.clone();Y=Je.g(this.$).Rb.hNa(this.selectedRange);this.kP=B.Xfg(this.selectedRange);if(!Y||!this.kP||!this.selectedRange||We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.Sva(this.selectedRange))return null;this.BOc=this.a1h();
if((We.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.V5(this.selectedRange):this.gridView.V5(this.kP))&&this.Eya)return this.wvc=this.kP,Y=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.Eya?this.Eya.toString():"null",this.kP?this.kP.toString():"null",l?l.toString():"null"),Cd.ULS.sendTraceTag(537154137,0,50,Y),this.kP}return null};B.prototype.f_=function(){this.vN?this.uh.f_(Gf.v(this.Eya,
this.$),!1,!0):We.EwaSettings.ma(136)&&this.uh.f_(Gf.v(this.selectedRange,this.$),!0,!1)};B.prototype.i7a=function(){return this.$.ea.isNamedObjectViewMode&&tf.f(this.$.qa)};B.OVj=function(l){for(;l.$$mn();)if(l.$$cu().text||l.$$cu().wF||l.$$cu().Bi||l.uo.f8e)return!1;return!0};B.Xfg=function(l){return l.right===ze.a.Qh?null:new sg.Range(l.top,l.right,l.top,l.right,!1,!1)};Ck.Object.defineProperties(B.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.Zh.domElement(1)}},Eya:{configurable:!0,
enumerable:!0,get:function(){return this.BOc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.bYa}},vN:{configurable:!0,enumerable:!0,get:function(){return this.pMc}},LKf:{configurable:!0,enumerable:!0,get:function(){return this.ofe}},QBb:{configurable:!0,enumerable:!0,get:function(){var l=this.Zh.domElement(this.Xea);return l?id.DOMElementExtensions.isVisible(l):!1}},Rwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&We.EwaSettings.ma(136)?!(new ah.a(this.$.xa)).tj:
!1}},DIg:{configurable:!0,enumerable:!0,get:function(){return this.rFc}},Xea:{configurable:!0,enumerable:!0,get:function(){return this.Eya?this.gridView.rb.rj(this.kP):1}}});Object(Vd.a)(B,"PulloutManager",fg.a,[648,2]);var Yk=Og.a;Am(u,Yk);u.prototype.create=function(){var l=this;ph.a.Fa(function(J){var Y=Hf.GetServiceTaskFactory.Ua(J.da,12,477,l.ub),za=Hf.GetServiceTaskFactory.Ua(J.da,66,134,l.ub),Ua=Hf.GetServiceTaskFactory.Ua(J.da,211,212,l.ub),Qb=yl.a.Ra(null),uc=!We.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",
!1);uc&&(Qb=Hf.GetServiceTaskFactory.Ua(J.da,8,9,l.ub));Pg.TaskExtensions.Ba(Pg.TaskExtensions.xe([Y,za,Qb,Ua],J.la),function(){uc?l.Eb(l.$.da.Aa(261)||new B(l.$,Y.result,za.result,Qb.result,Ua.result)):l.Eb(l.$.da.Aa(261)||new B(l.$,Y.result,za.result,null,Ua.result))},J.la)})};u.ka=function(l){l.da.Ga(262,new u(l))};Object(Vd.a)(u,"PulloutManagerFactory",Og.a,[]);var ll={average:0,max:0,median:0,P75:0,P95:0},tl={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,
commitByMouseClickCounter:0,commitWhileRequestPending:0},vl={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},zl={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},wl={smartSuggestionShownCounter:0,
smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0},dl={dialogCommitedCounter:0,dialogShownCounter:0},F={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},ll),excludingFirstAction:Object.assign({},ll)},ia={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0},Qa={customFunction:{committedCounter:0,
shownCounter:0},function:{committedCounter:0,shownCounter:0},lambda:{committedCounter:0,shownCounter:0},letVariable:{committedCounter:0,shownCounter:0},namedRange:{committedCounter:0,shownCounter:0},richEntity:{committedCounter:0,shownCounter:0},table:{committedCounter:0,shownCounter:0},tableHeader:{committedCounter:0,shownCounter:0},tableSpecialStructRef:{committedCounter:0,shownCounter:0}};t.prototype.eTa=function(){this.xlc=Pf.a.Ta.oe.m};t.prototype.Yia=function(l){-1!==this.xlc&&(l?(this.Inb(Pf.a.Ta.oe.m-
this.xlc),this.xlc=-1):this.x0.failedCount++)};t.prototype.TBh=function(){this.x0.excludingFirstAction=t.iUe(this.U7b);this.U7b.push(this.x0.firstAction);this.x0.includingFirstAction=t.iUe(this.U7b)};t.prototype.Inb=function(l){var J=this;this.x0.count?1E3>this.x0.count&&this.U7b.push(l):this.x0.firstAction=l;this.grf&&this.hrf&&this.hrf.forEach(function(Y){l>Y&&J.x0.countAboveThresholds[Y]++});this.x0.count++};t.iUe=function(l){var J=Object.assign({},ll);0<l.length&&(Vf.i(l),J.median=l[Math.floor(.5*
l.length)],J.P75=l[Math.floor(.75*l.length)],J.P95=l[Math.floor(.95*l.length)],J.max=l[l.length-1],J.average=Vf.g(l,function(Y){return Y})/l.length);return J};Object(Vd.a)(t,"PerformanceMeasurement",null,[]);var Ab=b(41),Ec=b(98),Mc;(function(l){l[l.function=3]="function";l[l.namedRange=100]="namedRange";l[l.tableHeader=101]="tableHeader";l[l.letVariable=102]="letVariable";l[l.richEntity=103]="richEntity";l[l.lambda=104]="lambda";l[l.customFunction=105]="customFunction";l[l.table=106]="table";l[l.tableSpecialStructRef=
107]="tableSpecialStructRef"})(Mc||(Mc={}));Object(Vd.b)("CompletionItemKind",Mc);var zd={},Ld=(zd.argumentAssistanceOverall=[50,80,100,130,150,170,200],zd.autoCompleteOverall=[50,80,100,130,150,170,200],zd);x.prototype.RI=function(l){var J=this;l.forEach(function(Y){J.lab.xb(Y)||J.lab.ia(Y,new t(Ld[Y]));J.lab.oa(Y).eTa()})};x.prototype.bF=function(l,J){var Y=this;J=void 0===J?!0:J;l.forEach(function(za){Y.lab.xb(za)&&Y.lab.oa(za).Yia(J)})};x.prototype.VYf=function(l){var J="Undefined";switch(l){case 1:J=
"Collapsed";break;case 0:J="Expanded";break;case 2:J="Hidden"}this.B$.argumentAssistanceCardInitialMode=J};x.prototype.q8b=function(l){var J=this;window.requestAnimationFrame(function(){J.bF([l])})};x.prototype.W$e=function(l){var J=this;l.forEach(function(Y){J.vYc[Mc[Y.kind]].shownCounter++})};x.prototype.V$e=function(l){this.vYc[Mc[l]].committedCounter++};x.prototype.getJsonForLogging=function(){return"{"+this.$U("SessionDetails",this.Jna)+","+this.$U("ArgumentAssistanceUsage",this.B$)+","+this.$U("FormulaSuggestionsUsage",
this.gKa)+","+this.$U("FunctionDialogUsage",this.Zcd)+","+this.$U("AutocompleteCardInteraction",this.kZ)+","+this.$U("AutocompleteRenderOptimization",this.jpb)+","+this.$U("AutocompleteUsageByKind",this.vYc)+","+this.IYh()+"}"};x.prototype.Mtj=function(){this.Jna.argumentAssistanceFlight=this.Wvb("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Jna.autoCompleteUIFlight=this.Wvb("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Jna.smartFormulaBarAutoCompleteFlight=this.Wvb("Microsoft.Office.Excel.",
"SmartFormulaBarAutocompleteFeatureIsEnabled");this.Jna.formulaAssistanceRedesignFlight=this.Wvb("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.Jna.NewInsertFunctionDialogFlight=this.Wvb("Microsoft.Office.Excel.","NewInsertFunctionDialog")};x.prototype.IYh=function(){for(var l=new P.a,J=Cl(this.lab),Y=J.next();!Y.done;Y=J.next())Y=Y.value,Y.value.TBh(),l.add(String.format('"{0}":{1}',Y.key,je.a.Lc(Y.value.x0)));return String.format('"PerfMeasurements": {{{0}}}',l.toArray().join(","))};
x.prototype.Wvb=function(l,J){return da.a.contains(this.$.ya.FlightHolder.FlightId,J,!0)?We.EwaSettings.getBooleanFeatureGate(l+J,!1)?"T":"C":"None"};x.prototype.$U=function(l,J){return String.format('"{0}":{1}',l.toString(),Ab.c(J))};Object(Vd.a)(x,"FormulaAssistanceTelemetryManager",null,[647]);var ye=Og.a;Am(r,ye);r.ka=function(l){l.da.Ga(492,new r(l))};r.prototype.create=function(){var l;this.Eb(null!==(l=this.$.da.Aa(491))&&void 0!==l?l:this.$.da.Ga(491,new x(this.$)))};Object(Vd.a)(r,"FormulaAssistanceTelemetryManagerFactory",
Og.a,[]);y.prototype.$c=function(){return!1};y.prototype.executeCommand=function(l,J){l=!1;J=J.command;switch(J){case 1910465940:l=!0}return l?ig.Task.Ra(!0):eg.a(J)};y.prototype.Kc=function(l,J){switch(J.command){case 1910465940:return!0;default:return!1}};y.prototype.jd=function(){return!1};Object(Vd.a)(y,"NameManagerCommandHandler",null,[424]);var Te=Sf.a;Am(h,Te);h.prototype.Nd=function(){this.Dd([new y(this.$)])};h.ka=function(l){Sf.a.he(493,new h(l))};Object(Vd.a)(h,"NameManagerCommandHandlerFactory",
Sf.a,[]);var rf=b(408);Object(Vd.a)(w,"GestureAdapterInfo",null,[]);var dg=b(391),Jg=b(231);n.prototype.Fti=function(){if(!this.gIc){var l="hammer.min.js";Fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",!1)&&(l=Fg.AFrameworkApplication.ga.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");l=Fg.AFrameworkApplication.BO(String.format("{0}",l),5);l=Jg.a.create(l,null,null);dg.a.Zia(l);this.gIc=l.J8a}return this.gIc};Ck.Object.defineProperties(n,
{instance:{configurable:!0,enumerable:!0,get:function(){n.Ma||(n.Ma=new n);return n.Ma}}});n.Ma=null;Object(Vd.a)(n,"HammerJsDependencyLoader",null,[686]);var dh;(function(l){l[l.none=-1]="none";l[l.pinch=0]="pinch";l[l.pan=1]="pan";l[l.swipe=2]="swipe"})(dh||(dh={}));Object(Vd.b)("GestureEvent",dh);var bj=b(73),uh=bj.a;Am(m,uh);m.create=function(l,J,Y,za,Ua,Qb){if(Y.rawEvent)if(Qb){var uc=Y.rawEvent;uc=new Sys.UI.Point(uc.clientX,uc.clientY)}else uc=bj.a.Dvb(Y);else uc=new Sys.UI.Point(Y.clientX,
Y.clientY);return new m(l,uc,J,Y,za,Ua,Y.shiftKey,Y.ctrlKey,Qb)};Ck.Object.defineProperties(m.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.Mga}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.qY}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.Phb}},ova:{configurable:!0,enumerable:!0,get:function(){return this.Mpg}}});Object(Vd.a)(m,"GestureEventArgs",bj.a,[]);Object(Vd.a)(f,"GestureManagerData",null,[]);e.dkg=2;e.ekg=4;e.fkg=
8;e.gkg=8;Object(Vd.a)(e,"HammerConstants",null,[]);var hi=b(209),vi=yi.a;Am(c,vi);c.prototype.iRh=function(){return this.DPc?0:this.Bje?1:2};c.prototype.un=function(l){vi.prototype.un.call(this,l);this.Xd.Gka(this.xWa,l,0,this.Ykb)};c.prototype.km=function(l){vi.prototype.km.call(this,l);this.Xd.HIa(l,this.xWa)};c.prototype.f9i=function(l,J,Y){var za=this;Y=void 0===Y?null:Y;var Ua=void 0===Ua?null:Ua;Fg.AFrameworkApplication.Dhc()?n.instance.Fti().continueWith(function(Qb){za.MFj();if(Qb.ig||Qb.Oh)Cd.ULS.sendTraceTag(591192778,
310,10,"Hammer did not download correctly: {0}",Qb.status);else{Cd.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Qb.status);if(za.p4d){Qb=window.Hammer;if("undefined"===typeof Qb){Cd.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");za.wzc();return}if("undefined"===typeof Qb.inputHandler){Cd.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");za.wzc();return}}if(!l)throw za.wzc(),Error.argumentNull("source element can not be null");Qb=hi.a.Nva(l,za.Bqa);
if(void 0===Qb||null===Qb)Qb=new Ec.a,hi.a.pdb(l,za.Bqa,Qb),za.g9i(l);var uc=null;if(!Qb.xb(dh[0])){uc=Object;var ed=uc.assign,Dd=new w,hd=dh[0],Ke=Ua;Ke=void 0===Ke?null:Ke;if(void 0===za||null===za)throw Cd.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var zf=null;switch(hd){case Bg.a.pinch:zf=new Hammer.Pinch(Ke);break;case Bg.a.pan:zf=new Hammer.Pan(Ke)}zf&&(zf.manager=za);uc=ed.call(uc,Dd,{xda:zf,wXe:J});Qb.add(dh[0],uc)}if(void 0!==
Y&&null!==Y)for(ed=0;ed<Y.length;ed++)Qb.xb(dh[Y[ed]])&&(Dd=Qb.oa(dh[Y[ed]]),uc.xda.recognizeWith(Dd.xda))}za.wzc()}):Cd.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};c.prototype.MFj=function(){this.WJc&&(this.Eh?this.kSc=this.Eh.Hc("Task","RegisterGestureAdapterAfterLoad"):Cd.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};c.prototype.wzc=function(){this.WJc&&(this.kSc?this.kSc.stop():Cd.ULS.sendTraceTag(590387075,310,
10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};c.prototype.g9i=function(l){this.Npg.add(l);this.Xd.Gka(this.xWa,l,0,this.Ykb)};c.prototype.recognize=function(l){for(var J=Array(l.pointers.length),Y=0;Y<l.pointers.length;Y++)J[Y]=l.pointers[Y].target;Y=null;for(this.Ypa=this.CTh(J);void 0!==this.Ypa&&null!==this.Ypa&&(Y=hi.a.Nva(this.Ypa,this.Bqa),void 0===Y||null===Y);this.Ypa=this.Ypa.parentNode);if(void 0!==Y&&null!==Y){this.curRecognizer&&this.curRecognizer.state===e.gkg&&(this.curRecognizer=
null);J=Cl(Y.keys);for(var za=J.next();!za.done;za=J.next()){za=Y.oa(za.value);void 0!==za&&null!==za&&void 0!==za.xda&&null!==za.xda&&(void 0===this.curRecognizer||null===this.curRecognizer||za.xda===this.curRecognizer||za.xda.canRecognizeWith(this.curRecognizer))&&za.xda.recognize(l);var Ua=za.xda.state;this.curRecognizer||e.dkg!==Ua&&e.ekg!==Ua&&e.fkg!==Ua||(this.curRecognizer=za.xda)}}};c.prototype.emit=function(l,J){if("hammer.input"!==l){this.s9=!1;J=m.create(l,this.Ypa,J.srcEvent,J,3,this.DPc);
var Y=hi.a.Nva(this.Ypa,this.Bqa);if(this.Hli(l))var za=0;else if(this.xli(l))za=1;else if(this.soi(l))za=2;else{Cd.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}Y=Y.Nc(dh[za]).value;void 0!==Y&&null!==Y&&((Y=Y.wXe,Y.uji())?l.endsWith("start")?this.s9=Y.LLi(J):l.endsWith("end")?(Y.JLi(J),this.s9=!0):l.endsWith("cancel")?(Y.ILi(J),this.s9=!0):l.endsWith("move")&&(this.s9=Y.KLi(J)):Cd.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",
l))}};c.prototype.get=function(l){return Object(S.a)(Hammer.Recognizer,l)};c.prototype.CTh=function(l){if(1>l.length)return null;if(1===l.length)return l[0];for(var J=l[0],Y=!0,za=1;za<l.length;za++){if(!l[za])return null;if(J!==l[za]){Y=!1;break}}if(Y)return J;J=this.OXe(l[0]);Y=0;l=Cl(l);for(za=l.next();!za.done;za=l.next()){za=this.OXe(za.value);if(J.oa(J.count-1)!==za.oa(za.count-1))return null;for(var Ua=J.count-2,Qb=za.count-2;Ua>=Y&&0<=Qb;Ua--,Qb--)if(J.oa(Ua)!==za.oa(Qb)){Y=Ua+1;break}}return J.oa(Y)};
c.prototype.OXe=function(l){for(var J=new P.a;void 0!==l&&null!==l;l=l.parentNode)J.add(l);return J};c.prototype.q0e=function(l){switch(l){case Bg.a.Lf:case Bg.a.Qha:return 1;case Bg.a.wg:case Bg.a.Msa:return 2;case Bg.a.Ce:case Bg.a.$Ga:return 4;case Bg.a.cBc:case Bg.a.pZc:return 8}return 0};c.prototype.iza=function(l,J,Y){l=this.q0e(l);J=this.kSh(Y);Hammer.inputHandler(this,l,J);this.s9&&Y.preventDefault();return this.s9};c.prototype.F7e=function(){return 1<this.aU.count};c.prototype.Y1b=function(){Cd.ULS.sendTraceTag(594055960,
310,50,"CancelPendingPointerEvents");if(this.Tmb)for(var l=Cl(this.aU),J=l.next();!J.done;J=l.next())this.iQf(J.value.key);else this.aU=new Ec.a;this.session=null};c.prototype.yCg=function(l,J,Y){Cd.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",l);if(!this.slb.xb(l)){try{J.setPointerCapture(l)}catch(za){Cd.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",za)}this.slb.add(l,J)}this.aU.ia(l,Y);this.BVa&&1<this.aU.count&&this.Lfa&&!this.Lfa.gqb&&(this.Lfa.gqb=!0)};
c.prototype.iQf=function(l){Cd.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",l);if(this.slb.xb(l)){try{this.slb.oa(l).releasePointerCapture(l)}catch(J){Cd.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",J)}this.slb.remove(l)}else Cd.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",l);this.aU.remove(l);this.BVa&&1>=this.aU.count&&this.Lfa&&this.Lfa.gqb&&(this.Lfa.gqb=!1)};c.prototype.xoc=function(l,J,Y){var za=Y.rawEvent.pointerType.toString(),
Ua=Y.rawEvent.pointerId.toString();if("touch"!==za)return!1;l=this.q0e(l);if(1!==l&&!this.aU.xb(Ua))return!1;this.v4d&&1===l&&Y.rawEvent.isPrimary&&this.aU.count&&(Cd.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Y1b());this.Tmb?this.yCg(Ua,J,Y):this.aU.ia(Ua,Y);this.zNc&&2===l&&(!this.RGc||this.RGc&&"function"===typeof Y.rawEvent.getCoalescedEvents)&&(J=Y.rawEvent.getCoalescedEvents())&&this.F7e()&&(this.Akb=Math.max(this.Akb,J.length));this.Yfe&&(this.s9=!1);za=this.jSh(this.aU,
Y,za);Hammer.inputHandler(this,l,za);if(4===l||8===l)this.Tmb?this.iQf(Ua):this.aU.remove(Ua),this.aU.count||(this.session=null,this.zNc&&-1!==this.Akb&&(Cd.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Akb),this.Akb=-1));this.s9&&Y.preventDefault();return this.s9};c.prototype.hoc=function(){return!1};c.prototype.kSh=function(l){var J=new f,Y=l.rawEvent,za=Y.touches;Y=Y.changedTouches;J.pointers=Array.clone(za);J.pointers=Array.clone(0<za.length?za:Y);J.changedPointers=
Array.clone(Y);J.srcEvent=l;J.pointerType="touch";return J};c.prototype.jSh=function(l,J,Y){var za=new f;za.pointers=Ha.toArray(l.values);za.changedPointers=[J];za.pointerType=Y;za.srcEvent=J;return za};c.prototype.Hli=function(l){return hg.a.startsWith(l,Bg.a.pinch)};c.prototype.xli=function(l){return hg.a.startsWith(l,Bg.a.pan)};c.prototype.soi=function(l){return hg.a.startsWith(l,Bg.a.swipe)};Object(Vd.a)(c,"GestureInputManager",yi.a,[657,658]);a.prototype.fi=function(l){l.register(c,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Ic().Oc(function(){return new c(jk.a.instance,
Fg.AFrameworkApplication.sa.MD)});this.tb=l};a.prototype.init=function(){this.vx||(this.tb.resolve("Common.App.GestureManager.GestureInputManager"),this.vx=!0)};a.prototype.dispose=function(){};a.main=function(){pg.a.instance.hj(new a)};Ck.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(Vd.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Uc.a.Li('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
ph.a.Fa(Ud.ka);ph.a.Fa(yc.ka);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Ia.main();Uc.a.Li(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){Bd.initData();ph.a.Fa(function(l){Kc.ka(l);Se.ka(l);Bd.ka(l);Ge.ka(l)})})();Uc.a.Li(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
Uc.a.Li(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
ph.a.Fa(jc.ka);ph.a.Fa(Ig.ka);ph.a.Fa(Pd.ka);Uc.a.Li(".ewa-facp-text-box{position:absolute}");(function(){ph.a.Fa(function(l){qc.ka(l)})})();(function(){ph.a.Fa(function(l){Zb.ka(l)})})();ph.a.Fa(qd.ka);ph.a.Fa(oc.ka);ph.a.Fa(Ac.ka);Uc.a.Li('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
ph.a.Fa(dc.ka);ph.a.Fa(Ca.ka);(function(){ph.a.Fa(function(l){l.da.Ga(150,new nb(l))})})();(function(){ph.a.Fa(function(l){K.ka(l);mb.ka(l);aa.ka(l)})})();ph.a.Fa(A.ka);(function(){ph.a.Fa(function(l){C.ka(l)})})();(function(){ph.a.Fa(function(l){l.ma(136)&&u.ka(l)})})();(function(){ph.a.Fa(function(l){h.ka(l)})})();Type.registerNamespace("Common.App.GestureManager");a.main();(function(){ph.a.Fa(function(l){r.ka(l)})})()},927:function(z,E,b){function a(na,ha,ka,xa,va,Aa,qa,wa,Ta,sb,db,kb){var ac=
aa.call(this)||this;ac.zlc=!1;ac.contextMenuController=null;ac.BJc=null;ac.MGc=null;ac.wpd=!1;ac.n0j=0;ac.m0j=0;ac.Nsb=null;ac.Huc=null;ac.LC=function(){ac.contextMenuController?ac.contextMenuController.LC():e.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");ac.ncg()};ac.wb=na;ac.Rqf=va;ac.DQc=sb;ac.y_j=ka;ac.x_j=xa;ac.a_j=ha;ac.bIf=Aa;ac.populateOnlyOnce=qa;ac.q6h=db;ac.NOf(kb);return ac}b.d(E,"a",
function(){return a});z=b(0);var c=b(7),e=b(14),f=b(623),m=b(90),n=b(24),w=b(621),h=b(392),y=b(651),r=b(630),x=b(112),t=b(276),u=b(85),B=b(438),v=b(1429);E=b(76);var C=b(19),A=b(5),M=b(1045),T=b(79),R=b(45),Q=b(59),ea=b(150),Z=b(121),ca=b(1),I=b(10),H=b(22),L=b(15),U=b(21),fa=b(33),aa=E.a;Am(a,aa);a.prototype.$c=function(na,ha){na=!0;switch(ha){case 1651433993:case 1675506831:case 966232027:na=this.ke(4096)||this.ke(2048);break;case 2045563128:na=this.ke(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:na=
this.ke(8192)}return!na};a.prototype.jd=function(na,ha,ka){ka.IsShadowMenuOpen||M.h(this.$,M.d);na=!1;ha===this.qt&&(ka.IsShadowMenuOpen||M.h(this.$,M.a),ha=Object(c.a)(new f.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.SEd(ha,ka.IsShadowMenuOpen),ka.MenuItems=ha,ka.IsShadowMenuOpen||M.h(this.$,M.c),na=!0);na&&this.zlc&&I.HelperMethods.k1b&&!ka.IsShadowMenuOpen&&M.j(this.$);return na};a.prototype.SEd=function(na,ha){(ha=this.DZ(ha))?(this.c$e(ha),Array.addRange(na.MenuSectionList,
ha.sC().MenuSectionList),this.RCg(na)):e.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.DZ=function(){e.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.k1=function(na,ha,ka,xa,va){na=Sys.UI.DomElement.getBounds(ha);ka=new Sys.UI.Point(na.x,na.y+na.height);this.iUa(ka,ha);this.$.isChromeRtl&&
(ka.x+=na.width);this.Jp(ka,va)};a.prototype.Jp=function(na,ha,ka){ka=void 0===ka?0:ka;ha&&(na=fa.a(this.$).aka(na));ha=!0;if(this.q6h){var xa;3===ka?(xa=this.FKa(3))&&0<xa.length?(ha=!1,this.showFloatie(xa,new Sys.UI.Bounds(na.x,na.y,0,0),ka)):e.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===ka&&this.$.isEditMode&&((xa=this.FKa(2))&&0<xa.length?xa[0]!==
a.nVe?(ha=!1,this.MSd(xa,new Sys.UI.Bounds(na.x,na.y,0,0),ka)):e.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):e.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ha&&this.showContextMenu(new Sys.UI.Bounds(na.x,na.y,0,0),ka)};a.prototype.FKa=function(){return null};a.prototype.Ugd=
function(na,ha){var ka="";3===na?ka="touch":2===na&&(ka="mouse");na={};return na.ContextMenuId=this.menuId,na.IsEditMode=this.$.isEditMode,na.IsSLR=!!Q.a.Dg&&Q.a.Dg.BK,na.IsReactMLR=!!Q.a.Dg&&Q.a.Dg.rW,na.IsNov=this.$.ea.isNamedObjectViewMode,na.InputType=ka,na.FloatieGroups=JSON.stringify(void 0===ha?null:ha),na};a.prototype.showContextMenu=function(na,ha){ha=void 0===ha?0:ha;var ka=this.Ugd(ha);e.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",
JSON.stringify(ka));this.contextMenuController?this.KB!==A.a.EHd&&this.KB!==A.a.FHd||0===ha?this.contextMenuController.LSd(this.KB,na,T.a.Vb):this.contextMenuController.LSd(this.KB,na,ha):e.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(na,ha,ka){var xa=this.Ugd(ka,na);e.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(xa));this.contextMenuController?(ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.TOf(),this.contextMenuController.lyc(na,ha,ka)):e.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(na))};a.prototype.MSd=function(na,ha,ka){var xa=this.Ugd(ka,na);e.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(xa));this.contextMenuController?(ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.TOf(),this.contextMenuController.KSd(na,ha,ka,this.KB)):e.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.NOf=function(na){this.contextMenuController=na};a.prototype.dispose=function(){this.$&&this.$.Ka.Fbb(this);this.wb=null;
ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.ncg();this.Huc&&(m.a.Ha(this.Huc),this.Huc=null);aa.prototype.dispose.call(this)};a.prototype.jHh=function(na){var ha=this.$.da.Aa(204);ha&&(ha=ha.RHh(this.Rqf))&&na.Dc.push(ha)};a.prototype.iUa=function(na,ha){na&&ha&&this.$.ea.wc.isDivSyndicated&&n.a.xf&&(ha=ha.ownerDocument.documentElement,na.x-=ha.scrollLeft,na.y-=ha.scrollTop)};a.prototype.ke=function(na){return(new ea.a(this.$.xa)).ke(na)};a.prototype.c$e=
function(na){na=Cl(na.Dc);for(var ha=na.next();!ha.done;ha=na.next())if(ha=ha.value,Object(B.a)(761,ha)){ha.title&&(ha.title=a.fg(ha.title));ha=Cl(ha.buttons);for(var ka=ha.next();!ka.done;ka=ha.next())ka=ka.value,Object(B.a)(762,ka)?(ka.label=a.fg(ka.label),ka.WS(a.fg(ka.alt))):Object(B.a)(763,ka)&&this.c$e(ka.menu)}};a.prototype.Oqf=function(na,ha){ha=void 0===ha?!1:ha;var ka=[];na=Cl(na);for(var xa=na.next();!xa.done;xa=na.next())ka.push(this.dV(xa.value,ha));return ka};a.prototype.dV=function(na){for(var ha=
[],ka=Cl(na.MenuItems),xa=ka.next();!xa.done;xa=ka.next())switch(xa=xa.value,xa.Type){case 3:ha.push(this.F5g(xa));break;case 2:ha.push(this.qah(xa));break;case 1:ha.push(this.g7g(xa))}return Object(c.a)(new w.a,{ControlList:ha,Title:na.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.rdd=function(na,ha){ha=[this.Nsb,na.RibbonCommand.toString(),ha?this.U_e(ha):this.U_e(na.Label),na.Disabled?na.Disabled.toString():
"False"];var ka=na.CommandData;ka=H.a.hashCode(ka).toString();ha.push(ka,na.Identifier.toString());ha=ha.join("_");na.IsChecked&&(ha+="_Checked");return ha};a.prototype.SHh=function(na){var ha=[this.Nsb,H.a.hashCode(na.Title).toString()];na=Cl(na.MenuItems);for(var ka=na.next();!ka.done;ka=na.next())ha.push(ka.value.RibbonCommand.toString());return ha.join("_")};a.prototype.aXe=function(na){var ha=na.Label;ha=H.a.hashCode(ha).toString();ha=[this.Nsb,ha];ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&
na.Id&&ha.push(H.a.hashCode(na.Id).toString());ha=ha.join("_");na.IsChecked&&(ha+="_Checked");return ha};a.prototype.F5g=function(na){var ha=this.qac(na,!1);var ka=ha.label;var xa=ha.RLa;ha=ha.Er;var va=this.rdd(na,ka);return Object(c.a)(new h.a,{Command:na.Disabled?(-251203935).toString():ha.toString(),ExternalId:va,Id:va,Image16by16Class:xa,LabelText:ka||na.Label,MenuItemId:na.CommandData,CommandValueId:na.CommandData})};a.prototype.qah=function(na){var ha=this.qac(na,na.IsChecked);var ka=ha.label;
var xa=ha.RLa;ha=ha.Er;var va=this.rdd(na,ka);return Object(c.a)(new y.a,{Command:na.Disabled?(-251203935).toString():ha.toString(),ExternalId:va,Id:va,Image16by16Class:xa,LabelText:ka||na.Label,MenuItemId:na.CommandData,CommandValueId:na.CommandData,IsChecked:na.IsChecked})};a.prototype.g7g=function(na){var ha=this.kXe(na);var ka=ha.label;ha=ha.RLa;var xa=Object(c.a)(new f.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(xa.MenuSectionList,this.Oqf(na.SubMenu.Sections,!0));var va=this.aXe(na);
na=ka||na.Label;return Object(c.a)(new r.a,{ExternalId:va,Id:va,LabelText:na,PopulateOnlyOnce:!1,Menu:xa,Image16by16Class:ha,ImageIsVisible:!!ha})};a.prototype.kXe=function(na){na=this.qac(na,!0);return{label:na.label,RLa:na.RLa,Er:na.Er}};a.prototype.qac=function(na,ha){switch(na.Identifier){case 26:var ka=912804500;ha=C.a.qRe;na=L.a.instance.fa(1909);break;case 3:ka=-1902148570;ha=ha?C.a.Jaa:null;na=L.a.instance.fa(1869);break;case 4:ka=-1902148570;ha=ha?C.a.Jaa:null;na=L.a.instance.fa(1870);break;
case 5:ka=-1902148570;ha=ha?C.a.Jaa:null;na=null;break;case 1:ka=-1677817820;ha=C.a.e9b;na=L.a.instance.fa(231);break;case 2:ka=-1649376918;ha=na.IsChecked?C.a.Qua:null;na=L.a.instance.fa(2072);break;case 23:ka=1701016594;ha=na.IsChecked?C.a.Qua:null;na=L.a.instance.fa(2072);break;case 6:ka=-87741481;ha=null;na=L.a.instance.fa(2073);break;case 7:ka=1948650742;ha=C.a.eQe;na=L.a.instance.fa(1907);break;case 8:ka=1933713114;ha=C.a.dQe;na=L.a.instance.fa(1908);break;case 14:ka=504133448;ha=C.a.wJa;na=
L.a.instance.fa(144);break;case 30:ka=504133448;ha=C.a.wJa;na=L.a.instance.fa(148);break;case 32:ka=504133448;ha=C.a.wJa;na=L.a.instance.fa(150);break;case 34:ka=504133448;ha=C.a.wJa;na=L.a.instance.fa(152);break;case 27:ka=1701016594;ha=ha?C.a.g9b:C.a.wJa;na=L.a.instance.fa(144);break;case 15:ka=-798968736;ha=C.a.xJa;na=L.a.instance.fa(146);break;case 31:ka=-798968736;ha=C.a.xJa;na=L.a.instance.fa(149);break;case 33:ka=-798968736;ha=C.a.xJa;na=L.a.instance.fa(151);break;case 35:ka=-798968736;ha=
C.a.xJa;na=L.a.instance.fa(153);break;case 28:ka=1701016594;ha=ha?C.a.h9b:C.a.xJa;na=L.a.instance.fa(146);break;case 21:ka=-2058042992;ha=C.a.R2a;na=null;break;case 29:ka=1701016594;ha=C.a.R2a;na=null;break;case 9:ka=1701016594;na=ha=null;break;case 11:ka=-1494291901;na=ha=null;break;case 25:ka=-1045020714;ha=na.IsChecked?C.a.Qua:null;na=null;break;case 13:ka=1701016594;ha=na.IsChecked?C.a.Qua:null;na=L.a.instance.fa(155);break;case 16:ka=1701016594;ha=C.a.vJa;na=L.a.instance.fa(1045);break;case 17:ka=
1701016594;ha=C.a.Oua;na=null;break;case 18:ka=1701016594;ha=C.a.Nua;na=null;break;case 19:ka=1701016594;ha=C.a.Q2a;na=L.a.instance.fa(1050);break;case 20:ka=1701016594;ha=C.a.c$c;na=L.a.instance.fa(1051);break;case 24:ka=1675506831;na=ha=null;break;case 22:ka=na.RibbonCommand;ha=na.IsChecked?C.a.Jaa:null;na=null;break;case 36:ka=1461300262;ha=null;na=L.a.instance.fa(154);break;case 38:ka=na.RibbonCommand;ha=C.a.i9b;na=L.a.instance.fa(1780);break;default:e.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",
JSON.stringify(na)),ka=1461300262,na=ha=null}return{label:na,RLa:ha,Er:ka}};a.prototype.U_e=function(na){return ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?H.a.hashCode(na+I.HelperMethods.fpj).toString():na};a.prototype.RCg=function(na){if(!this.$.ea.amIAlone){var ha=this.$.da.Aa(25);if((void 0!==ha&&null!==ha||!ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!x.a.isEmpty(ha.oCa)&&(ha=ha.p1h(),!t.a.Gh(ha))){var ka=[];u.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").H9g(ha,
ka);Array.addRange(na.MenuSectionList,ka)}}};a.prototype.TOf=function(){this.wpd||(this.Vub&&this.Vub.LZb(this.LC),this.oqb&&this.oqb.LZb(this.LC),this.wpd=!!this.Vub||!!this.oqb)};a.prototype.ncg=function(){this.Vub&&this.Vub.mtc(this.LC);this.oqb&&this.oqb.mtc(this.LC);this.wpd=!1};a.Bod=function(na,ha){ha=R.C(ha);na=U.g(na).Ea.z4a(ha);return!(null===na||void 0===na||!na.Yj)};a.wed=function(na,ha,ka){ha=R.C(ha);var xa=U.g(na).Ea.z4a(ha);ha=U.g(na).getCellBounds(xa);var va=xa.DNg;xa=xa.CNg;var Aa=
ha.x+va.x;ha=ha.y+va.y;ka&&ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(U.g(na).rtl||(Aa+=xa),ha-=xa);return new Sys.UI.Point(Aa,ha)};a.Qyh=function(na){try{Object(v.a)(na.CommandValueId)}catch(ha){}};a.fg=function(na){var ha=a.d2a.parseFromString(na,"text/html");return ha?ha.body.innerText:(e.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),na)};Ck.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.Huc}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.DQc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Lb+this.Rqf}},Vub:{configurable:!0,enumerable:!0,get:function(){this.BJc||(this.BJc=Z.a(this.$));return this.BJc}},oqb:{configurable:!0,enumerable:!0,get:function(){this.MGc||(this.MGc=U.g(this.$).rc);return this.MGc}}});a.d2a=new DOMParser;a.nVe="Unsupported";Object(z.a)(a,"ContextMenuBase",E.a,[424,
764,2])},983:function(z,E,b){function a(){}b.d(E,"a",function(){return a});z=b(0);a.ANe="ewa-ac";a.cnh="ewa-ac-param";a.KOe="ewa-function-help-link";a.V9c="ewa-lb";a.nOe="ewa-fb-refactor";a.listItem="list-item";a.$Bb="list-item-selected";a.fCb="list-table-touch";a.eCb="list-table";a.Qth="ewa-suggested-cell-name";a.J_g="columnName-header";a.EPe="ewa-tt";a.arh="ewa-function-link-container";a.LOe="ewa-function-udf-name";a.rtl="rtl";Object(z.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/70c1dddf1d70f68b0271e3022177bac5/EwaDS.kpae.js.map