(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[24],{1202:function(z,E,b){function a(m,n){m=f.call(this,m,n)||this;n!==e.a.v$&&m.XFa(n);m.iha(a.iterateNext);m.iha(a.Jxa);m.MUc(c.a.IUa);m.MUc(c.a.JUa);return m}b.d(E,"a",function(){return a});z=b(0);var c=b(167);E=b(1314);var e=b(970),f=E.a;Am(a,f);a.iterateNext="IterateNext";a.Jxa="IteratePrevious";a.INb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.xPa=
"OnVHDiffReady";Object(z.a)(a,"VersionHistoryMessenger",E.a,[])},1317:function(z,E,b){function a(L,U,fa,aa){var na=this;this.authorColor=this.O2=this.Yea=null;this.N7a=!1;this.Y$f=0;this.x1a=-1;this.y5c=0;this.IIa=100;this.rla=-1;this.O_d=null;this.opb=h.a.BWj;this.uHe=h.a.CWj;this.Th=function(ha){(ha=v.a(ha)?null:ha.Result)?ha.OperationWaitingForFileDownload?20>na.y5c?(na.IIa*=2,H.Task.delay(na.IIa).continueWith(function(){na.bYd()})):(na.qCc(),e.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ha.ActivityList?(na.initialize(ha.ActivityList,ha.VersionAuthors),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?na.xPa():na.syc(!0),na.O_d.stop(),e.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",na.O_d.zc.toString())):(na.qCc(),e.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(na.IIa*=2,H.Task.delay(na.IIa).continueWith(function(){na.bYd()}),
e.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.lza=function(){na.qCc();e.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Msd=function(ha){e.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ha.MessageId);switch(ha.MessageId){case Z.a.iterateNext:na.iterateNext();na.rla=(na.rla+1)%na.cT.length;na.jKb(Z.a.setCurrentChangeCount,
na.rla+1);break;case Z.a.Jxa:na.Jxa();na.rla=0>na.rla?0:na.rla;na.rla=(na.rla+na.cT.length-1)%na.cT.length;na.jKb(Z.a.setCurrentChangeCount,na.rla+1);break;case Z.a.INb:na.syc(ha.Values.ToggleValue)}};this.c1g=function(ha,ka){return na.C3b(ha.Jm,ka.Jm)};this.b1g=function(ha,ka){return na.C3b(ha.Jm,ka)};this.kd=function(){na.E6b()};this.Dp=function(){na.E6b()};this.gj=function(){na.E6b()};e.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=L;this.ariaLiveNotifier=
aa;this.gridView=Q.g(this.$);this.gridView.ha.WG(this.kd);this.gridView.rE(this.Dp);this.gridView.rc.sl(this.gj);this.ASj();U&&(this.O_d=L.Ob.Hc("UserAction","VersionHistoryDiffManagerStopWatch"),this.bYd());if(this.ms=fa)L=f.a.nba(this.$.ya.VersionHistoryActionUrl)||I.a.v$,L!==I.a.v$&&this.ms.XFa(L),this.ms.mo(Z.a.iterateNext),this.ms.mo(Z.a.Jxa),this.ms.mo(Z.a.INb),this.ms.Tl(Z.a.iterateNext,this.Msd),this.ms.Tl(Z.a.Jxa,this.Msd),this.ms.Tl(Z.a.INb,this.Msd)}function c(L,U,fa){this.UFa=L;this.Jm=
U;this.XCc=fa}z=b(0);var e=b(14),f=b(80),m=b(1033),n=b(83),w=b(201),h=b(9),y=b(215),r=b(63),x=b(45),t=b(561),u=b(175),B=b(110),v=b(293),C=b(1),A=b(10),M=b(99),T=b(15),R=b(292);b(107);var Q=b(21),ea=b(354);Object(z.a)(c,"UserActivityLocation",null,[]);var Z=b(1202),ca=b(84),I=b(970),H=b(55);b.d(E,"a",function(){return a});a.prototype.dispose=function(){this.gAa();this.Yea=this.O2=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.cG(this.kd),this.gridView.aG(this.Dp),this.gridView.rc&&this.gridView.rc.kl(this.gj),
this.ms&&(this.ms.Voa(Z.a.Jxa),this.ms.Voa(Z.a.iterateNext),this.ms.Voa(Z.a.INb)))};a.prototype.initialize=function(L,U){L?(this.gAa(),this.x1a=-1,this.Yea=[],this.N7a=!1,this.O2={},this.authorColor={},this.pzi(U),this.e5c(L)):e.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.bYd=function(){function L(fa,aa,na){var ha=U.$.na.va;fa=R.b(fa,U.Th);aa=R.a(aa,U.lza);var ka=ha.Na(1,null);return ca.i(ha,"GetVersionHistoryHighlightActivitiesData",
ka,fa,aa,na,null,4)}var U=this;e.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.y5c.toString(),this.IIa.toString());this.y5c++;C.EwaSettings.qc()?this.$.userOperationManager.ic(new u.a(537,0,L,80),null):this.$.userOperationManager.ic(new t.a(537,0,L,16),null)};a.prototype.syc=function(L){var U=this.O2,fa;for(fa in U){var aa=fa,na=U[fa];na?na.ZLb(L):e.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+
aa+"view was Null")}};a.prototype.gAa=function(){var L=this.O2,U;for(U in L){var fa=U,aa=L[U];aa?aa.uaj():e.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+fa+"view was Null")}this.Yea=this.O2=null};a.prototype.GXf=function(L){var U=this.HUh(L,this.x1a);var fa=U.daf;L=U.ufg;U.returnValue&&(e.ULS.shipAssertTag(537150402,0,!!L,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.E6b(),L.UFa.toString()in this.O2?(this.O2[L.UFa.toString()].Pmj(L.Jm),
U=x.D(L.Jm),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(T.a.instance.Ab(158),fa+1,this.cT.length,U.qB(!1),L.XCc.DisplayName)),this.x1a=fa):e.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",L.UFa.toString())))};a.prototype.jKb=function(L,U){if(C.EwaSettings.ma(320))if(this.ms){var fa={};fa.count=U;L=new m.a(L);L.Values=fa;this.ms.send(L)}else e.ULS.sendTraceTag(537150370,
0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else e.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.HUh=function(L,U){var fa=!1;var aa=null;for(var na=0;!fa&&na<this.cT.length;){U=L?this.yUh(U):this.jWh(U);aa=this.cT[U];var ha=Object(n.a)(M.a,this.$.xa.getItemByName(aa.Jm.SheetName));if(!ha)return e.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),
{returnValue:!1,daf:U,ufg:aa};ha.visible&&(fa=!0);na++}return{returnValue:fa,daf:U,ufg:aa}};a.prototype.yUh=function(L){return-1===L?this.q1e():(L+1)%this.cT.length};a.prototype.jWh=function(L){-1===L&&(L=this.q1e());return L=(L+this.cT.length-1)%this.cT.length};a.prototype.e5c=function(L){this.Fah(L);this.L4c()};a.prototype.J0h=function(L,U){var fa=[];if(!L.RangeList)return e.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
fa;L=Cl(L.RangeList);for(var aa=L.next();!aa.done;aa=L.next())(aa=aa.value)&&this.$.xa.Aj(aa.SheetName)?(aa=new c(0,aa,U),fa.push(aa)):e.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+aa.SheetName);return fa};a.prototype.Fah=function(L){L=Cl(L);for(var U=L.next();!U.done;U=L.next())if(U=U.value,!U||B.e(U.LocationList))e.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var fa=Cl(U.LocationList),aa=fa.next();!aa.done;aa=fa.next())if(aa=aa.value)switch(aa.Type){case 0:this.Yea.push.apply(this.Yea,
Dl(this.J0h(aa,U.Person)));break;default:e.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else e.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.L4c=function(){for(var L={},U=new w.a,fa=[],aa=Cl(this.Yea),na=aa.next();!na.done;na=aa.next())if(na=na.value,U.contains(na.XCc)||U.add(na.XCc),0===na.UFa){var ha=new ea.a(x.D(na.Jm),r.d(this.$.xa.getItemByName(na.Jm.SheetName))),
ka=a.sxc(ha);ka in L||fa.push(ha);L[ka]=this.wMh(na.XCc)}e.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.Yea.length,fa.length,U.count,this.Y$f);this.qCc();0<fa.length&&(L=new (b(1406).RangeVersionHistoryHighlightView)(this.$,fa,L,this.opb),this.O2["0"]=L)};a.prototype.qCc=function(){var L=this.Yea?this.cT.length:0;this.jKb(Z.a.setCurrentChangeCount,
0);this.jKb(Z.a.setTotalChangesCount,L)};a.prototype.xPa=function(){this.jKb(Z.a.xPa,0)};a.prototype.pzi=function(L){if(L){this.Y$f=L.length;for(var U=0;U<L.length;++U)if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!L[U].InitialsColor)e.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var fa=L[U].EmailAddress;var aa=L[U].UserName;var na=null;if(L[U].LoginName){var ha=
L[U].LoginName.split("|");3===ha.length&&(na=ha[2])}na?this.authorColor[na]=L[U].InitialsColor:fa?(e.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[fa]=L[U].InitialsColor):aa?(e.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[aa]=L[U].InitialsColor):e.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else e.ULS.sendTraceTag(537150363,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.ASj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var L=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,U=0;U<L.length;U++){var fa=L[U],aa=fa.key?fa.key:fa.Key?fa.Key:"";fa=fa.value?fa.value:fa.Value?fa.Value:"";"DefaultColor"===
aa?this.uHe=fa:"InitialTint"===aa?this.opb=fa:e.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else e.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};a.prototype.wMh=function(L){if(L.Email in this.authorColor)return this.authorColor[L.Email];if(L.DisplayName in this.authorColor)return this.authorColor[L.DisplayName];e.ULS.sendTraceTag(537150356,
0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.uHe};a.prototype.C3b=function(L,U){var fa=Object(n.a)(M.a,this.$.xa.getItemByName(L.SheetName)),aa=Object(n.a)(M.a,this.$.xa.getItemByName(U.SheetName));return fa&&aa?(fa=(fa=A.HelperMethods.gD(fa.index,aa.index))||A.HelperMethods.gD(L.FirstRow,U.FirstRow))||A.HelperMethods.gD(L.FirstColumn,U.FirstColumn):(e.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),
0)};a.prototype.q1e=function(){var L=x.m(this.gridView.ha.ta.activeRange,this.$.xa.qa);if(!L)return e.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;L=A.HelperMethods.Lx(new y.a(this.cT),0,this.cT.length,L,this.b1g);0>L&&(L=~L);return L%this.cT.length};a.prototype.E6b=function(){if(this.dKb){if(!(this.dKb.UFa.toString()in this.O2)){e.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",
this.dKb.UFa.toString()));return}this.O2[this.dKb.UFa.toString()].neh(this.dKb.Jm)}this.x1a=-1};a.prototype.iterateNext=function(){this.GXf(!0)};a.prototype.Jxa=function(){this.GXf(!1)};a.sxc=function(L){return String.format("{0}{1}",L.range,L.sheetId)};Ck.Object.defineProperties(a.prototype,{jgb:{configurable:!0,enumerable:!0,get:function(){return this.O2}},dKb:{configurable:!0,enumerable:!0,get:function(){return-1===this.x1a?null:this.cT[this.x1a]}},cT:{configurable:!0,enumerable:!0,get:function(){this.N7a||
(this.Yea.sort(this.c1g),this.N7a=!0);return this.Yea}}});Object(z.a)(a,"VersionHistoryHighlightManager",null,[773,2])},1406:function(z,E,b){function a(t,u,B,v){this.sjb=null;this.$=t;this.xwg=u;this.vSa=B;this.wSa={};this.opb=v;this.mci()}function c(){}b.r(E);z=b(0);var e=b(14),f=b(9);c.Xth="ewa-vhr-rectinnerborder";Object(z.a)(c,"CssClassNames",null,[]);var m=b(63),n=b(45),w=b(227),h=b(107),y=b(21),r=b(354),x=b(1317);b.d(E,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.ZLb=
function(t){t?this.Cb.Gn(this.QH):this.Cb.Xh(this.QH)};a.prototype.uaj=function(){this.ZLb(!1);this.Cb.TKb(new r.a(null,m.d(this.$.qa)),this.QH)};a.prototype.Pmj=function(t){if(this.vSa){var u=new r.a(n.D(t),m.d(this.$.xa.getItemByName(t.SheetName))),B=x.a.sxc(u);if(B in this.vSa)if(B in this.wSa){u=w.a.iq(this.vSa[B]);B=this.wSa[B];for(var v in B)B[v].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",u.r,u.g,u.b,f.a.DWj);y.g(this.$).ha.Oa.oH(null);y.g(this.$).P5e(t,60,!0,h.a.D5i)}else e.ULS.sendTraceTag(537150426,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+B);else e.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+B)}else e.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.neh=function(t){t=new r.a(n.D(t),m.d(this.$.xa.getItemByName(t.SheetName)));var u=x.a.sxc(t);if(u in this.wSa)if(u in this.vSa){t=w.a.iq(this.vSa[u]);
u=this.wSa[u];for(var B in u)u[B].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",t.r,t.g,t.b,this.opb)}else e.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+u);else e.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+u)};a.prototype.mci=function(){var t=this;this.Cb.lx(this.xwg,[a.u5],!1,function(u,B){if(u&&u.range&&u.sheetId&&B){var v=
new r.a(u.range,u.sheetId);v=x.a.sxc(v);v in t.wSa||(t.wSa[v]={});t.wSa[v][u.paneType.toString()]=B;v in t.vSa?(u=t.vSa[v],v=w.a.iq(u),B.style.borderColor=u,B.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",v.r,v.g,v.b,t.opb),u=document.createElement("div"),u.className=c.Xth,B.appendChild(u)):e.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+v)}else e.ULS.shipAssertTag(537150423,0,!!u,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),
e.ULS.shipAssertTag(537150422,0,!u||!!u.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),e.ULS.shipAssertTag(537150421,0,!u||!!u.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),e.ULS.shipAssertTag(537150420,0,!!B,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Ck.Object.defineProperties(a.prototype,{QH:{configurable:!0,enumerable:!0,get:function(){return[a.u5]}},Cb:{configurable:!0,enumerable:!0,get:function(){return this.sjb||
(this.sjb=y.g(this.$).Cb)}}});a.u5=23;Object(z.a)(a,"RangeVersionHistoryHighlightView",null,[817])},1444:function(z,E,b){function a(wc){var jd=xg.call(this)||this;jd.$=wc;jd.Tb();return jd}function c(wc,jd,xd,me){var Ae=this;xd=void 0===xd?null:xd;me=void 0===me?null:me;this.pHa=null;this.L7e=!1;this.wFf=function(Ze){Ae.$_a.jpj();Ae.$_a.syc(!0);bg.a.Gh(Ze.wywaActivities)||2===Ze.wywaActivities[0].type||Ae.$_a.f8h(Ze.wywaActivities[0])};this.$=wc;this.$_a=new R(this.$);this.i4d=new fa(ub.AFrameworkApplication.Ib,
ge.EwaSettings.ma(457));wc=Zd.a.dLj(Ue.a.instance.lc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.Alf=me;this.Zxe=new y(this.$,wc,this.c7a());this.Yxe=new T(this.$,ub.AFrameworkApplication.Ib);this.emptyCatchUpBehaviorManager=new h(this.$);this.Ati(function(Ze){Ae.ZHi(Ze)},jd);this.xvi();jd=null;xd||(jd=Ue.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=xd||new m(jd);this.flyoutFocus=new n(this.$,this.flyoutRibbonButton)}function e(){this.emptyCatchUpBehaviorManager=
this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function f(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=
this.featuredActivityGroupsEnabled=null}function m(wc){this.buttonClickedCallback=null;this.Ojb=this.zzb=!1;this.vEh=new Date;this.sVe=wc}function n(wc,jd){this.$=wc;this.flyoutRibbonButton=void 0===jd?null:jd;Zb.a(this.$).ai(this);this.hasFocus=!1}function w(wc){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+wc)}function h(wc){this.$=wc}function y(wc,jd,xd){xd=void 0===xd?!1:xd;this.$=wc;this.$xe=jd;this.nGb=Ue.a.instance.resolve("Common.App.People.IPeopleColorUtils");
this.lrc=Ue.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.c7a=xd}function r(wc,jd,xd,me,Ae,Ze,Bf){Bf=wc.Na(1,void 0===Bf?null:Bf);Bf.getRelevantActivitiesDataRequest=jd;return ud.i(wc,"GetRelevantActivitiesData",Bf,xd,me,Ae,Ze,0)}function x(wc,jd,xd,me,Ae,Ze){Ze=wc.Na(1,void 0===Ze?null:Ze);return ud.i(wc,"GetLineageWywaAuthors",Ze,jd,xd,me,Ae,4)}function t(){var wc=A.call(this)||this;wc.relationship=0;return wc}function u(){this.color=this.imageUrl=this.email=this.givenName=
this.displayName=this.provider=this.id=null}function B(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function v(){this.activityFeedItems=null}function C(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function A(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=
this.location=this.actors=null}function M(){}function T(wc,jd){this.$=wc;this.Ei=jd}function R(wc){var jd=this;this.GRa=this.o4b=this.sfa=null;this.t5={};this.LDa=null;this.ald=!1;this.NEb=function(xd,me){switch(me.state){case 0:case 1:3===me.fGd&&(jd.y7h(),jd.GRa=null);break;case 2:break;case 3:jd.M6c();jd.GRa=me.activityId;jd.fAj();break;default:tb.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+me.state)}};this.il=
function(){jd.Csb()};this.kd=function(){jd.Csb()};this.Dp=function(){jd.Csb()};this.gj=function(){jd.Csb()};this.G3f=function(xd,me){jd.sfa&&me.PH!==jd.xka&&(me.isSticky&&jd.Z6b(!0),(xd=jd.WNj(me.PH))?(jd.sfa.createActivityIndicatorTooltip(Object(Gb.a)(new Z,{target:me.PH,container:xd,activityIds:[me.activityId],isSticky:me.isSticky,dirHint:jd.gridView.rtl?12:9})),me.isSticky?(jd.xka=me.PH,tb.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):
(jd.Cec=me.PH,tb.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),jd.Wgc||(jd.gridView.view.Ts(jd.SBc),jd.gridView.Nt(jd.SBc),jd.Wgc=!0)):tb.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.nJe=function(xd,me){jd.Z6b(me.vgh)};this.SBc=function(){jd.sfa?(jd.xka&&jd.sfa.updateActivityIndicatorTooltip(Object(Gb.a)(new Q,{target:jd.xka,
isSticky:!0})),jd.Cec&&jd.sfa.updateActivityIndicatorTooltip(Object(Gb.a)(new Q,{target:jd.xka,isSticky:!1}))):tb.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=wc;this.gridView=Ce.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.rc;this.ha.AZb(this.il);this.ha.WG(this.kd);this.gridView.rE(this.Dp);this.Ya.sl(this.gj);this.xka=this.Cec=null;this.Wgc=!1;this.Xbd={}}function Q(){this.target=null;this.isSticky=
!1}function ea(){this.clearSticky=!1}function Z(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function ca(){this.E2c=[];this.oLb={};this.Ele={}}function I(wc,jd,xd,me,Ae){wc=H.call(this,wc,jd,xd,me)||this;wc.ranges=Ae;wc.N7a=!1;return wc}function H(wc,jd,xd,me){var Ae=hf.call(this)||this;Ae.$=wc;Ae.y2d=jd;Ae.Tkg=xd;Ae.mC=me;Ae.state=0;return Ae}function L(wc,jd,xd){xd=Qe.call(this,wc,jd,xd)||this;xd.gridView=Ce.g(wc);xd.Zma=jd;return xd}function U(wc){var jd=this;
this.NEb=function(){switch(jd.sv.model.state){case 1:jd.H4f(!0);break;case 0:jd.ZLb(!1);break;case 2:case 3:jd.ZLb(!0);break;default:tb.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+jd.sv.model.state)}};this.Aqg=wc;this.sv.Vne(this.NEb);this.Fz=[]}function fa(wc){this.Ei=wc}function aa(wc){return pf.call(this,wc)||this}function na(wc,jd){this.$=wc;this.catchUpActivityManager=jd}function ha(){this.tb=null}function ka(wc){this.Su=
wc}function xa(wc){this.oug=wc}function va(wc){this.Nga=wc;this.Ibe=new sf.a}function Aa(wc,jd,xd){this.ttg=wc;this.sVa=jd;this.IVa=xd}function qa(wc,jd,xd,me,Ae,Ze){wc=we.call(this,wc,jd)||this;wc.ItemIds=null;wc.ActivityStatesToSet=0;wc.ActivityStatesToReset=0;wc.ResetUnseenCount=!1;wc.ItemIds=xd;wc.ActivityStatesToSet=me;wc.ActivityStatesToReset=Ae;wc.ResetUnseenCount=Ze;return wc}function wa(wc,jd){return Hd.call(this,wc,jd)||this}function Ta(wc,jd){this.Wg=wc;this.Su=jd}function sb(wc){var jd=
Kc.call(this)||this;jd.$=wc;jd.Tb();return jd}function db(wc,jd){var xd=this;this.drd=!1;this.If=function(){xd.Cag()};this.$=wc;ge.EwaSettings.ma(621)&&this.$.ea.G8a&&!db.xxb&&(jd&&!jd.feb||this.tWj(),db.N7e?tb.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):jd&&!jd.feb||this.zWj());tb.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function kb(wc){var jd=Wb.call(this)||
this;jd.wi=null;jd.lh=null;jd.$=wc;jd.Tb();return jd}function ac(wc,jd,xd){var me=ug.call(this,wc)||this;me.te=null;me.BAe=null;me.REb=null;me.Dqd=!0;me.Eu=0;me.Np=!1;me.Zc=function(Ae,Ze){Ze.Fg||me.H1c()};me.ak=function(){me.H1c();return!0};me.$=jd;me.taskPaneManager=xd;me.$.Zk(me.Zc);Zb.a(me.$).ai(me);rd.a.Ld(me.$)&&(me.isVisible=!1);return me}function ta(wc){var jd=pa.call(this)||this;jd.lineageTaskPane=null;jd.Y7=null;jd.$=wc;jd.Tb();return jd}function ra(wc,jd,xd,me){var Ae=this;this.nub=this.HF=
null;this.mE=this.nud=0;this.REb=function(){Ae.Y7&&(Ae.Y7.stop(),Ae.Y7=null);Ae.PLb.start();Ae.HF.createLineagePane(Ae.iud,Ae.nub)};this.lineageOpenPaneOrChangeFilterRequest=function(Ze,Bf){function Qf(Lg,$d,le){var lh=Ae.$.na.va,Kf=De;Lg=zc.b(Lg,Ae.agd("LineageOpenPaneOrChangeFilter"));$d=zc.a($d,Vg);var Ph=lh.Na(1,null);Ph.clientParams=Rf;Ph.lineageFilter=Kf;return ud.i(lh,"LineageOpenPaneOrChangeFilter",Ph,Lg,$d,le,null,0)}function Vg(Lg){Lg=qf.a.pg(Lg.data);tb.ULS.sendTraceTag(537155481,0,50,
"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",Xe.a.Xc(Lg))}Ae.PLb.stop();ae.b(Ae.$).Vd(ie.a.UOi,{});Ae.sCj();var Rf=Object(Gb.a)(new ib,{ClientViewCapacity:Ze.clientViewCapacity}),De=null;Bf&&(De=Object(Gb.a)(new eb,{FilterSheetMultiRange:Ae.MMj(Bf.filterSheetMultiRange)}));ge.EwaSettings.qc()?Ae.$.userOperationManager.ic(new Lf.a(1010,0,Qf,80),null):Ae.$.userOperationManager.ic(new Ig.a(1010,0,Qf,16),null)};this.lineageLoadMoreRequest=function(Ze){function Bf(Vg,
Rf,De){var Lg=Ae.$.na.va;Vg=zc.b(Vg,Ae.agd("LineageLoadMore"));Rf=zc.a(Rf,Qf);var $d=Lg.Na(1,null);$d.fetchFromBelow=Ze;return ud.i(Lg,"LineageLoadMore",$d,Vg,Rf,De,null,0)}function Qf(Vg){Vg=qf.a.pg(Vg.data);tb.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Xe.a.Xc(Vg))}ae.b(Ae.$).Vd(ie.a.TOi,{});ge.EwaSettings.qc()?Ae.$.userOperationManager.ic(new Lf.a(1011,0,Bf,80),null):Ae.$.userOperationManager.ic(new Ig.a(1011,0,Bf,16),null)};this.lineageRefreshViewRequest=
function(){function Ze(Qf,Vg,Rf){var De=Ae.$.na.va;Qf=zc.b(Qf,Ae.agd("LineageRefreshView"));Vg=zc.a(Vg,Bf);var Lg=De.Na(1,null);return ud.i(De,"LineageRefreshView",Lg,Qf,Vg,Rf,null,0)}function Bf(Qf){Qf=qf.a.pg(Qf.data);tb.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Xe.a.Xc(Qf))}ae.b(Ae.$).Vd(ie.a.VOi,{});ge.EwaSettings.qc()?Ae.$.userOperationManager.ic(new Lf.a(1012,0,Ze,80),null):Ae.$.userOperationManager.ic(new Ig.a(1012,0,Ze,16),null)};
this.lineageUpdateViewRequest=function(){lc(Ae.$.na.va,function(Ze){if(Ze=jc.a(Ze)?null:Ze.Result){var Bf={};Bf=(Bf.CountOfUpdatedActivities=Ze.LineageActivitiesResponse.ActivityList.length,Bf);ae.b(Ae.$).Vd(ie.a.WOi,Bf);Ze=Object(Gb.a)(new Wa,{activityList:Ae.yGd(Ze.LineageActivitiesResponse.ActivityList),latestActivityId:Ze.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:Ze.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:Ze.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(Ze.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:Ze.HasNewActivities,filterSheetMultiRange:Ae.CMj(Ze.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:Ze.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:Ze.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:Ze.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:Ze.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(Ze.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:Ae.xwb(Ze.LineageActivitiesResponse.EolPersonHideHistory)});Ae.HF.onLineageActivitiesUpdateResponse(Ze)}else tb.ULS.shipAssertTag(537155475,0,!!Ze,"LineageManager.LineageUpdateView returned null response.")},function(Ze){Ze=qf.a.pg(Ze.data);tb.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Xe.a.Xc(Ze))},null,null)};this.onCardSelected=function(Ze,Bf){if(Ze=Ze.rangeHighlightLocation){if(Bf){var Qf=Re.Z(Bf,null);var Vg=Qf.range;
if(Qf.returnValue){Ae.v9e(Ze.sheetName,Ae.Ewb([Re.j(Vg)]));return}tb.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+Bf+" is not valid.")}Ze.rangeList.length?Ae.v9e(Ze.sheetName,Ze.rangeList):Ae.g8h(Ze.sheetName)}};this.onLearnMoreLinkClicked=function(){if(ge.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var Ze=new de.a(-859308420,gg.a.Vb,Ae.$.fd,12,null),Bf={};Bf=(Bf[gg.a.Ag]="HelpID=XLO_LineageTS",Bf.InputMethod=gg.a.Vb,Bf[gg.a.ld]=Ad.a.fW,
Bf.ShouldCanvasTakeFocus=!0,Bf);Ae.$.Ka.$b(Ze,Bf)}};this.onVersionHistoryButtonClicked=function(Ze){Ae.$.Ka.$b(new de.a(-1112508866,Ze,Ae.$.fd,12,null))};this.isFeatureEnabled=function(){return!1};this.If=function(){var Ze=Ae.$.ea.Rm.LineageVersion;Ze!==Ae.nud&&(tb.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",Ze,Ae.nud),Ae.nud=Ze,Ae.n8i())};this.qd=function(Ze,Bf){Ae.HF&&!Ae.lineageTaskPane.thc&&Bf.WH&&(tb.ULS.sendTraceTag(587220563,
0,15,"LineageManager::SessionIdChanged detected."),Ae.onStaleActivitiesDetected())};this.Io=function(){Ae.HF&&!Ae.lineageTaskPane.thc&&(tb.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Ae.onStaleActivitiesDetected())};this.lD=function(){var Ze=Ae.S4a();Ae.HF.onFilterableSheetListChange(Ze)};this.hza=function(){var Ze=Ae.S4a();Ae.HF.onFilterableSheetListChange(Ze)};this.Toc=function(){var Ze=Ae.S4a();Ae.HF.onFilterableSheetListChange(Ze)};this.onPaneClosed=function(){Ae.HF.onPaneClosed();
pc(Ae.$.na.va,null,function(Ze){Ze=qf.a.pg(Ze.data);tb.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",Xe.a.Xc(Ze))},null,null)};this.onRangeFilterInputEnabled=function(Ze){Ze?Ae.gridView.ha.bZ(Ae.kd):Ae.gridView.ha.A7(Ae.kd)};this.kd=function(){var Ze=Re.q(Ae.gridView.ha.ta.activeRange,Ae.$);Ze=Object(Gb.a)(new ob,{rangeList:Ae.Ewb(Ze.Ranges),sheetName:Ze.SheetName});Ae.HF.onSelectedRangeUpdated(Ze)};this.tryParseRangeInfo=function(Ze){var Bf=
Re.Z(Ze,Ae.$.xa);var Qf=Bf.sheetName;Ze=Bf.range;return Bf.returnValue?(Qf||(Qf=Ae.$.xa.qa.sheetName),Bf=[],Bf.push(Ze),Ze=Re.u(Qf,null,Bf),Object(Gb.a)(new ob,{rangeList:Ae.Ewb(Ze.Ranges),sheetName:Ze.SheetName})):null};this.Tz=function(){var Ze=Ae.mE!==Ae.$.ea.af;Ae.HF&&Ae.lineageTaskPane.isVisible&&Ze&&(Ae.mE=Ae.$.ea.af,Ae.HF.onRefreshRequired())};this.$=wc;jd.Ga(366,this);this.gridView=Ce.g(this.$);this.lineageTaskPane=xd;this.iud=this.lineageTaskPane.LM();this.batchSize=50;this.Y7=me;this.PLb=
this.$.Ob.$g("UserAction","LineagePaneLoadingShimmerStopWatch");this.lrc=Ue.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Jbi();this.FBg()}function Na(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function gb(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=
null;this.degradedCardTypeBits=0}function ob(){this.sheetName=this.rangeList=null}function wb(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function Oa(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function sa(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function Fa(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=
this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function Wa(){var wc=Db.call(this)||this;wc.hasNewActivities=!1;wc.filterSheetMultiRange=null;return wc}function Db(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;
this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function pc(wc,jd,xd,me,Ae,Ze){Ze=wc.Na(1,void 0===Ze?null:Ze);return ud.i(wc,"LineageClosePane",Ze,jd,xd,me,Ae,0)}function lc(wc,jd,xd,me,Ae,Ze){Ze=wc.Na(1,void 0===Ze?null:Ze);return ud.i(wc,"LineageUpdateView",Ze,jd,xd,me,Ae,0)}function eb(){}function ib(){}function cc(wc){var jd=Sd.call(this)||this;jd.$=wc;jd.Tb();return jd}function Pa(wc){this.feb=!0;Pa.Tcf()?Pa.adf()?(tb.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",
!wc),this.feb=wc):this.feb=!1:this.feb=!0}function nc(wc){return Dc.call(this,wc)||this}function pb(wc,jd){this.$=wc;this.lineageManager=jd;wc=[new Jf.a(zb.a.kud,1038647878,0,0,2186),new Jf.a(zb.a.idle,1038647878,0,1)];vb.a(this.$).GId(new $f.a(zb.a.jud,zb.a.idle,wc),new rb(zb.a.kud,zb.a.idle,jd))}function rb(wc,jd,xd){wc=Le.call(this,wc,jd)||this;wc.lineageManager=xd;return wc}function Ya(wc){var jd=vf.call(this)||this;jd.$=wc;jd.Tb();return jd}function ec(wc){return kf.call(this,wc)||this}function yd(wc){var jd=
this;this.baseVersionInfo=this.d4=this.ipa=this.xm=this.ewaAccessibilityManager=this.bOb=null;this.aJd=this.Qsf=!1;this.FGe=!0;this.dialog=this.WB=this.iVe=this.ED=this.R_d=this.P_d=this.Q_d=null;this.ACf=function(xd){tb.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(jd.ozj()){var me=function(Ze){nb.c(2138207060,!1);jd.xm.setRestoreFailedAtServer(Ze)};jd.ED&&jd.ED.startTimer(yd.k$f);var Ae=function(){jd.ED.endTimer(yd.k$f);jd.Sxe(jd.ED)};
jd.xm.setRestoreInProgress();fc.a(jd.$).rt(new dd.a(zb.a.Az,5,function(){var Ze=vb.a(jd.$).rd.activityState;Ze[qc.a.hr]=zb.a.LAe;Ze[fd.a.YY]=!0;Ze[fd.a.rU]=0;Ze[ba.pgg]=xd;Ze[ba.urc]=ub.AFrameworkApplication.oj;Ze[ba.Evd]=Ae;Ze[$a.$4f]=me}))}else nb.c(2138207060,!1)};this.cFf=function(xd){jd.bOb.then(function(me){me.enterFocusTrapZone();return null});tb.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");jd.ED.endTimer(yd.zWd);jd.ED.incrementCounter(yd.B4g);tb.ULS.sendTraceTag(537150348,
0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",jd.ED.getTimerDuration(yd.zWd));jd.Hgj(xd.containerDiv);xd.versions&&0<xd.versions.length&&(jd.iVe=yd.nF(xd.versions[xd.versions.length-1]));jd.d4&&jd.ipa&&jd.hOd(jd.d4);tb.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(xd){tb.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",
yd.nF(xd.currentVersion),yd.nF(jd.d4));jd.ED.incrementCounter(yd.A4g);jd.d4=xd.currentVersion;jd.baseVersionInfo=xd.baseVersion;jd.Qsf=xd.noBaseToCompareTo;jd.ipa&&jd.ZVj()&&(jd.hOd(xd.currentVersion),tb.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.ixf=function(xd){tb.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===xd||void 0===xd?0:xd.versionSelected)?
yd.nF(xd.versionSelected.currentVersion):null,(null===xd||void 0===xd?0:xd.updatedVersions)?xd.updatedVersions.length:0,yd.nF(jd.d4));jd.ED.incrementCounter(yd.z4g);if(jd.baseVersionInfo){if((null===xd||void 0===xd?0:xd.updatedVersions)&&2<=xd.updatedVersions.length){var me=null,Ae=null,Ze=yd.nF(jd.d4),Bf=yd.nF(jd.baseVersionInfo);xd=Cl(xd.updatedVersions);for(var Qf=xd.next();!Qf.done;Qf=xd.next()){Qf=Qf.value;var Vg=yd.nF(Qf);Ze===Vg?me=Qf:Bf===Vg&&(Ae=Qf);if(me&&Ae)break}me&&Ae?(jd.d4=me,jd.baseVersionInfo=
Ae,tb.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",yd.nF(jd.d4),yd.nF(jd.baseVersionInfo)),jd.hOd(jd.d4)):tb.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ze,Bf)}else tb.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
tb.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else tb.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.iwf=function(){tb.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");jd.j_g();var xd=new de.a(1470556788,0,jd.$.fd,0,null);jd.$.Ka.$b(xd)};this.RCf=function(xd){tb.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");
var me=new de.a(-1244760097,0,jd.$.fd,0,null);jd.$.Yf.get(51)&&(tb.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),me=new de.a(-309686558,0,jd.$.fd,0,null));nb.c(1604651619,!0);var Ae={};jd.$.Ka.$b(me,(Ae.FileDownloadUrl=xd,Ae))};this.jxf=function(xd){tb.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");xd=new Oc.QueryStringBuilder(xd);xd.Yi("fn",ub.AFrameworkApplication.fileName);tb.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+
xd.toString().length);8===jd.$.frame.x9a(xd.toString(),!0)?(tb.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),nb.c(1316171850,!1)):nb.c(1316171850,!0)};this.Nuf=function(xd){jd.xm.setFullAppErrorCode(xd)};this.uyf=function(xd){switch(xd){case 101:xd="VHFailedToGetDownloadToken";break;case 100:xd="VHFailedToLoadVersionList";break;case 104:xd="VHVersioningNotEnabled";break;case 105:xd="VHFileNotFound";break;case 106:xd="VHVersionTooOld";break;default:xd="None"}jd.ED.addEvent("OnFullAppError",
xd);tb.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",xd)};this.RCd=function(xd){jd.FGe=xd;tb.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",xd.toString());var me={};jd.GOd(oc.a.INb,(me.ToggleValue=xd,me))};this.Nzf=function(xd){tb.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",xd);nb.c(1488635506,!0);var me={};xd?jd.GOd(oc.a.iterateNext,me):jd.GOd(oc.a.Jxa,me)};this.wHb=function(xd){switch(xd.MessageId){case he.a.IUa:tb.ULS.sendTraceTag(537150289,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");ge.EwaSettings.ma(425)&&jd.xm.setVersionLoadComplete();break;case he.a.JUa:tb.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case oc.a.setCurrentChangeCount:xd=xd.Values.count;tb.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",xd);jd.xm.setCurrentChangeCount(xd);break;case oc.a.setTotalChangesCount:xd=
xd.Values.count;tb.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",xd);jd.xm.setTotalChangesCount(xd);break;case oc.a.xPa:jd.RCd(jd.FGe);break;default:tb.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",xd.MessageId)}};this.$=wc;this.s9b=this.$.Lb+yd.Iyh;this.$Id=!1;ge.EwaSettings.ma(389)&&this.Jah();this.JBb="";this.Dtd=0;this.perfTelemetryInfos=[]}function Ub(){this.perfTelemetryInfos=
this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function Ob(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=
this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Yb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function xb(){this.rootDiv=this.appBootSettings=null}function Sa(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function Tb(wc){this.Yw=wc}function Cc(wc){this.Yw=wc}function Fb(wc){this.Yw=wc}function hc(){}function cd(wc,jd){this.$=wc;this.GWj=jd}function mb(wc,jd){var xd=
Ed.call(this)||this;xd.activityName=wc;xd.MM=jd;xd.Tb();return xd}function $a(wc,jd){return Fc.call(this,wc,jd)||this}function K(wc,jd,xd){var me=Gc.call(this)||this;me.activityName=wc;me.MM=jd;me.aK=xd;me.Tb();return me}function ba(wc,jd,xd,me,Ae){var Ze=hb.call(this,wc,jd)||this;Ze.yi=null;Ze.retryCount=0;Ze.ERi=function(Bf){var Qf=Ze.YNj(Bf);Bf=Qf.pMd;Qf.returnValue?Bf.Success?(nb.c(2138207060,!0),tb.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):
(nb.c(2138207060,!1),tb.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",Bf.Output),Ze.Bh(Ze.aK)):(nb.c(2138207060,!1),Ze.Bh(Ze.aK));(Bf=Ze.yi.activityState[ba.Evd])&&Bf();Ze.Cp();Ze.yi.OJ()};Ze.DRi=function(){if(0<Ze.retryCount)tb.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",Ze.retryCount),Ze.retryCount--,Ze.zUf();else{tb.ULS.sendTraceTag(42287320,
0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");nb.c(2138207060,!1);Ze.Bh(Ze.aK);var Bf=Ze.yi.activityState[ba.Evd];Bf&&Bf();Ze.Cp();Ze.yi.OJ()}};Ze.aK=xd;Ze.J3=me;Ze.baseUrl=Ae;return Ze}b.r(E);var ua=b(11),La=b(0),ub=b(4),Va=b(226),tb=b(14),Cb=b(113),nb=b(187),Ib=b(41),hb=Cb.a;Am(ba,hb);ba.prototype.execute=function(wc){this.yi=wc;this.retryCount=3;this.zUf();return 1};ba.prototype.zUf=function(){var wc=this.yi.activityState[ba.urc],jd=this.yi.activityState[ba.pgg],
xd=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");wc=Ib.c({VersionId:jd,QuerySignature:wc});this.J3.hm(xd,2,wc,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.ERi,this.DRi,null)};ba.prototype.YNj=function(wc){var jd=null;wc=wc?wc.data?wc.data.me:null:null;if(!wc||!wc.length)return tb.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,pMd:jd};wc=Ib.d(wc);jd=wc.ev;return wc.returnValue?
{returnValue:!0,pMd:jd}:(tb.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,pMd:jd})};ba.pgg="RVAvi";ba.urc="RVAqs";ba.Evd="RVlvrt";Object(La.a)(ba,"RestoreVersionActivity",Cb.a,[]);var zb=b(6),Gc=Va.a;Am(K,Gc);K.prototype.create=function(){this.Eb(new ba(this.activityName,this.MM,this.aK,ub.AFrameworkApplication.Jd,ub.AFrameworkApplication.sa.Pa.LW))};K.ka=function(wc){wc.da.Ga(320,new K(zb.a.sMd,
zb.a.uj,zb.a.tMd))};Object(La.a)(K,"RestoreVersionActivityFactory",Va.a,[]);var Fc=Cb.a;Am($a,Fc);$a.prototype.execute=function(wc){var jd=this;(0,wc.activityState[$a.$4f])(function(){jd.Cp();wc.OJ()});return 1};$a.$4f="RVEAssea";Object(La.a)($a,"RestoreVersionErrorActivity",Cb.a,[]);var Ed=Va.a;Am(mb,Ed);mb.prototype.create=function(){this.Eb(new $a(this.activityName,this.MM))};mb.ka=function(wc){wc.da.Ga(321,new mb(zb.a.tMd,zb.a.uj))};Object(La.a)(mb,"RestoreVersionErrorActivityFactory",Va.a,[]);
var Jc=b(80),Ca=b(904),bb=b(51),dc=b(36),Ac=b(186),nd=b(389),qd=b(55);cd.prototype.$c=function(){return ub.AFrameworkApplication.ga.ra("IsAnonymousUser")?(tb.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};cd.prototype.executeCommand=function(wc,jd){tb.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");wc=!1;switch(jd.command){case -1112508866:nd.a(this.$)&&this.$.da.Aa(423).tyc(!1),wc=this.GWj.DCj()}tb.ULS.sendTraceTag(537150413,
0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",wc);return wc?qd.Task.Ra(wc):Ac.a(jd.command)};cd.prototype.Kc=function(wc,jd){return-1112508866===jd.command&&this.$.isVersionHistoryEnabled()};cd.prototype.jd=function(){return!1};Object(La.a)(cd,"VersionHistoryCommandHandler",null,[424]);var Gb=b(7),Oc=b(260),he=b(167),Wd=b(409),rc=b(24);hc.addAppPLTEventToLog=function(wc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(wc)}catch(jd){}};hc.setIsPageLoadForFirstTime=
function(wc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(wc)}catch(jd){}};Object(La.a)(hc,"VersionHistoryLogConnector",null,[]);var gd=b(1033),kd=b(1314),Qc=b(158),de=b(95),Xe=b(30),ge=b(1),fc=b(43),dd=b(258),oc=b(1202),Zb=b(272),Sc=b(254),sd=b(12);Fb.prototype.ai=function(){Zb.a(this.Yw.$).eN(this.ve)||Zb.a(this.Yw.$).ai(this)};Fb.prototype.y8=function(){Zb.a(this.Yw.$).eN(this.ve)&&Zb.a(this.Yw.$).Xz(this)};Fb.prototype.sh=function(wc){return sd.DOMElementExtensions.Gf(this.uc,
wc)};Fb.prototype.Ej=function(){this.Yw.$.frame.Qe.ek(this.Yw.$.frame.Qe.ZE)};Fb.prototype.Rj=function(){};Fb.prototype.Wf=function(wc,jd){jd||this.Yw.bOb.then(function(xd){xd.enterHeaderFocusTrapZone();return null});return!jd};Ck.Object.defineProperties(Fb.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return Sc.a.mgg}},uc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(La.a)(Fb,"VersionHistoryHeader",null,[438]);Cc.prototype.ai=function(){Zb.a(this.Yw.$).eN(this.ve)||Zb.a(this.Yw.$).ai(this)};Cc.prototype.y8=function(){Zb.a(this.Yw.$).eN(this.ve)&&Zb.a(this.Yw.$).Xz(this)};Cc.prototype.sh=function(wc){return sd.DOMElementExtensions.Gf(this.uc,wc)};Cc.prototype.Ej=function(){this.Yw.$.frame.Qe.ek(this.Yw.$.frame.Qe.ZE)};Cc.prototype.Rj=function(){};Cc.prototype.Wf=function(wc,jd){jd||this.Yw.bOb.then(function(xd){xd.enterFocusTrapZone();return null});return!jd};
Ck.Object.defineProperties(Cc.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return Sc.a.ngg}},uc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(La.a)(Cc,"VersionHistoryPane",null,[438]);Tb.prototype.ai=function(){Zb.a(this.Yw.$).eN(this.ve)||Zb.a(this.Yw.$).ai(this)};Tb.prototype.y8=function(){Zb.a(this.Yw.$).eN(this.ve)&&Zb.a(this.Yw.$).Xz(this)};
Tb.prototype.sh=function(wc){return sd.DOMElementExtensions.Gf(this.uc,wc)};Tb.prototype.Ej=function(){this.Yw.$.frame.Qe.ek(this.Yw.$.frame.Qe.ZE)};Tb.prototype.Rj=function(){};Tb.prototype.Wf=function(wc,jd){jd||this.Yw.bOb.then(function(xd){xd.enterViewerFocusTrapZone();return null});return!jd};Ck.Object.defineProperties(Tb.prototype,{ve:{configurable:!0,enumerable:!0,get:function(){return Sc.a.ogg}},uc:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(La.a)(Tb,"VersionHistoryViewer",null,[438]);var fd=b(146),qc=b(261),vb=b(66),Pd=b(443),Tc=b(970);Object(La.a)(Sa,"AppBootSettings",null,[]);Object(La.a)(xb,"AppVersionControllerFactoryParameters",null,[]);Object(La.a)(Yb,"OnVersionSelectedParams",null,[]);Object(La.a)(Ob,"AppSettings",null,[]);Object(La.a)(Ub,"ControllerFactoryParameters",null,[]);yd.prototype.dispose=function(){this.zze()};yd.prototype.z_i=function(){var wc=
this;this.$.da.$a(15,function(jd){wc.ewaAccessibilityManager=jd;wc.ewaAccessibilityManager.mode=2})};yd.prototype.Jah=function(){this.Q_d=new Cc(this);this.P_d=new Fb(this);this.R_d=new Tb(this)};yd.prototype.DCj=function(){var wc=this;tb.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");ub.AFrameworkApplication.AN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");ub.AFrameworkApplication.AN("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
ub.AFrameworkApplication.AN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.ED=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.ED.startTimer(yd.j$f);if(!this.xm&&(Pd.a(function(){wc.xm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(Gb.a)(new Ub,{ulsLogger:new Wd.a,docId:ub.AFrameworkApplication.oj,appSettings:Object(Gb.a)(new Ob,{appName:120,userSessionId:ub.AFrameworkApplication.userSessionId,
wdEnableSaveACopy:ge.EwaSettings.ma(357),wdEnableDownloadTokens:ge.EwaSettings.ma(352),wacCluster:ub.AFrameworkApplication.Jd.qT,uiLocale:ub.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:ge.EwaSettings.ma(322)&&wc.$.isEditMode,wdEnableIterator:ge.EwaSettings.ma(319)&&ge.EwaSettings.ma(320),useXhr:rc.a.G_,wdEnableHiddenButtonsUntilVersionLoadComplete:ge.EwaSettings.ma(425),disableSaveACopy:wc.C2f(),wdEnableShowVersionChanges:ge.EwaSettings.ma(319)&&ge.EwaSettings.ma(321),disabledChangeGates:wc.$.ya.VHSDisabledChangeGates,
wdEnableSaveACopyOverFlowMenu:ge.EwaSettings.ma(551),isRtl:ub.AFrameworkApplication.isRtl}),perfTelemetryInfos:wc.perfTelemetryInfos}))}),!this.xm))return tb.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),nb.c(429638140,!1),!1;this.ECj();this.ED.endTimer(yd.j$f);this.ED.startTimer(yd.m$f);tb.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");nb.c(429638140,
!0);return!0};yd.prototype.ECj=function(){this.Ek();if(!document.getElementById(this.s9b)){var wc=document.createElement("div");wc.id=this.s9b;wc.style.width="100%";wc.style.zIndex="998";wc.style.display="block";wc.style.position="absolute";ub.AFrameworkApplication.sa.Pa.Ug?(wc.style.top=document.getElementById("HeaderRegion").offsetHeight+"px",wc.style.bottom="0px"):wc.style.height="100%";this.$.kr.insertBefore(wc,this.$.kr.firstChild);this.bOb=this.xm.createVersionHistoryDialog(wc)}document.getElementById(this.s9b).style.display=
"block";this.SId();this.ED.startTimer(yd.zWd);this.xm.getVersions("")};yd.prototype.SId=function(){ge.EwaSettings.ma(389)&&(this.Q_d.ai(),this.P_d.ai(),this.R_d.ai(),this.z_i())};yd.prototype.KYd=function(){ge.EwaSettings.ma(389)&&(this.Q_d.y8(),this.P_d.y8(),this.R_d.y8(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};yd.prototype.Ek=function(){this.xm.getVersionsReadyEvent().addListener(this.cFf);this.xm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.xm.getCloseSelectedEvent().addListener(this.iwf);
this.xm.getFullAppErrorEvent().addListener(this.uyf);this.xm.getIteratorSelectedEvent().addListener(this.Nzf);this.xm.getShowVersionChangesToggledEvent().addListener(this.RCd);ge.EwaSettings.ma(352)&&(this.xm.getDownloadTokenReadyEvent().addListener(this.ixf),this.$Id=!0);ge.EwaSettings.ma(357)&&(this.xm.getSaveACopySelectedEvent().addListener(this.RCf),this.xm.getDownloadVersionSelectedEvent().addListener(this.jxf));ge.EwaSettings.ma(322)&&this.$.isEditMode&&(this.xm.getRestoreVersionSelectedEvent().addListener(this.ACf),
this.aJd=!0);this.ipa&&this.ipa.getAppErrorEvent().addListener(this.Nuf)};yd.prototype.wm=function(){this.xm.getVersionsReadyEvent().removeListener(this.cFf);this.xm.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.xm.getCloseSelectedEvent().removeListener(this.iwf);this.xm.getFullAppErrorEvent().removeListener(this.uyf);this.xm.getIteratorSelectedEvent().removeListener(this.Nzf);this.xm.getShowVersionChangesToggledEvent().removeListener(this.RCd);ge.EwaSettings.ma(357)&&(this.xm.getSaveACopySelectedEvent().removeListener(this.RCf),
this.xm.getDownloadVersionSelectedEvent().removeListener(this.jxf));this.$Id&&(this.xm.getDownloadTokenReadyEvent().removeListener(this.ixf),this.$Id=!1);this.aJd&&(this.xm.getRestoreVersionSelectedEvent().removeListener(this.ACf),this.aJd=!1);this.ipa&&this.ipa.getAppErrorEvent().removeListener(this.Nuf)};yd.prototype.ozj=function(){var wc=!0;if(ge.EwaSettings.ma(615)&&!this.$.yR)return tb.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+
this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!ge.EwaSettings.ma(318)){this.Vui();this.xm.setCoauthRestoreError();wc=!1;var jd=new de.a(-729359593,0,this.$.fd,0,null);this.$.Ka.$b(jd)}this.$.yR&&(tb.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),wc&&(wc=!1,this.CCj()));return wc};yd.prototype.CCj=function(){var wc=Xe.a.gd(1,0,1861,1860,0,-1603358883,"RestoreVersionUnsavedChangesError");wc=this.dialog||new Qc.ErrorDialog(this.$,
wc);wc.initialize();wc.kf()};yd.prototype.ZVj=function(){tb.ULS.sendTraceTag(537150343,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?yd.nF(this.baseVersionInfo):"");if(yd.nF(this.d4)===this.iVe)return tb.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(ge.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Qsf)return tb.ULS.sendTraceTag(537150341,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return tb.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var wc=yd.VOh(this.baseVersionInfo);tb.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",wc?wc.length:0);return wc?!0:(tb.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};yd.prototype.C2f=function(){return!this.$.Vka};
yd.prototype.j_g=function(){document.getElementById(this.s9b).style.display="none";var wc=new de.a(-1423792966,0,this.$.fd,0,null);this.$.Ka.$b(wc);this.zze()};yd.prototype.zze=function(){this.ED&&(this.ED.endTimer(yd.m$f),this.Sxe(this.ED),this.ED=null);this.wm();this.KYd();this.perfTelemetryInfos&&(tb.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.WB&&(this.WB.Voa(he.a.IUa),this.WB.Voa(he.a.JUa),this.WB.Voa(oc.a.setCurrentChangeCount),this.WB.Voa(oc.a.setTotalChangesCount),
ge.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.WB.Voa(oc.a.xPa),this.WB.dispose(),this.WB=null)};yd.prototype.Hgj=function(wc){var jd=this;try{this.ipa?hc.setIsPageLoadForFirstTime(!1):(hc.setIsPageLoadForFirstTime(!0),Pd.a(function(){var xd=new Sa;xd.ulsLogger=new Wd.a;xd.actionUrl=jd.$.ya.VersionHistoryActionUrl;xd.hideEmbedFooter=!0;xd.useFetch=ge.EwaSettings.ma(420)&&!rc.a.vv;jd.ipa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(Gb.a)(new xb,
{appBootSettings:xd,rootDiv:wc}))}))}catch(xd){tb.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",xd)}};yd.prototype.hOd=function(wc){tb.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",yd.nF(wc),this.JBb);if(wc)if(yd.nF(wc).length){var jd=(new Date).getTime();if(yd.nF(wc)===this.JBb&&1E3>jd-this.Dtd)tb.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");
else{yd.nF(wc)!==this.JBb&&(tb.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.xm.setTotalChangesCount(-1),this.xm.setCurrentChangeCount(-1));var xd=excelVersionHistory.FactoryGlobal.getTelemetryCollector();xd.addEvent("SelectVersion",yd.nF(wc));try{this.CYj(xd);this.Dtd=jd;this.JBb=yd.nF(wc);var me=new Yb;me.selectedVersionInfo=this.d4;me.baseVersionInfo=this.baseVersionInfo;me.telemetryCollector=xd;this.ipa.onVersionSelectedWithParams(me);
this.xm&&ge.EwaSettings.ma(357)&&this.xm.setDisableSaveACopy(this.C2f());var Ae=document.getElementById(yd.Hyh);Ae&&!this.WB&&(tb.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.WB=new oc.a(Ae.contentWindow,Jc.a.nba(this.$.ya.VersionHistoryActionUrl)||Tc.a.v$),this.WB.Tl(he.a.IUa,this.wHb),this.WB.Tl(he.a.JUa,this.wHb),this.WB.mo(oc.a.setCurrentChangeCount),this.WB.mo(oc.a.setTotalChangesCount),ge.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.WB.mo(oc.a.xPa),this.WB.Tl(oc.a.setCurrentChangeCount,this.wHb),this.WB.Tl(oc.a.setTotalChangesCount,this.wHb),ge.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.WB.Tl(oc.a.xPa,this.wHb))}catch(Ze){this.Dtd=0,this.JBb="",xd.addEvent("Exception",Ze.toString()),tb.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",Ze)}finally{tb.ULS.sendTraceTag(537150292,0,50,xd?xd.getJsonForLogging():"")}}}else tb.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else tb.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};yd.prototype.CYj=function(wc){for(var jd=Cl(this.perfTelemetryInfos),xd=jd.next();!xd.done;xd=jd.next()){var me=xd.value;xd=me.TelemetryEventKey?me.TelemetryEventKey:me.telemetryEventKey?me.telemetryEventKey:"";me=me.TelemetryEventData?me.TelemetryEventData:me.telemetryEventData?me.telemetryEventData:"";xd&&me&&wc.addEvent(xd,
me)}Array.clear(this.perfTelemetryInfos)};yd.prototype.Sxe=function(wc){tb.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",wc?wc.getJsonForLogging():"")};yd.prototype.Vui=function(){for(var wc=this.$.ea.Qm,jd={},xd=null,me=Cl(wc),Ae=me.next();!Ae.done;Ae=me.next())Ae=Ae.value,Ae.UserEmail&&(jd[Ae.UserEmail]=Ae.UserEmail in jd?jd[Ae.UserEmail]+1:1),Ae.User.UserID===this.$.ea.clientId&&(xd=Ae.UserEmail);tb.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
wc.length,xd?jd[xd]:-1)};yd.prototype.GOd=function(wc,jd){tb.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",wc);if(this.WB){wc=new gd.a(wc);wc.Values[kd.a.u5c]=this.$.ya.UserSessionId;if(jd)for(var xd in jd)wc.Values[xd]=jd[xd];this.WB.send(wc)}else tb.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};yd.nF=function(wc){return wc?wc.RevisionID?wc.RevisionID:wc.revisionID?
wc.revisionID:"":""};yd.VOh=function(wc){return wc?wc.DownloadUrl?wc.DownloadUrl:wc.downloadUrl?wc.downloadUrl:"":""};yd.Iyh="_excelVersionHistoryOverlay";yd.Hyh="vhs_frame";yd.j$f="TimeTakenShowVersionHistoryDialogAction";yd.m$f="TimeTillVersionHistoryDialogWasOpenMs";yd.zWd="TimeTakenGetVersionsToOnVersionsReady";yd.A4g="CountOnVersionSelectedCalledinOneVHSession";yd.B4g="CountOnVersionsReadyCalledinOneVHSession";yd.z4g="CountOnDownloadTokenReadyCalledinOneVHSession";yd.k$f="TimeTakenVersionRestore";
Object(La.a)(yd,"VersionHistoryPaneActor",null,[2]);var Ve=b(256),kf=Ca.a;Am(ec,kf);ec.prototype.Nd=function(){var wc=this,jd=this.gui(),xd=bb.GetServiceTaskFactory.Ua(this.$.da,21,137,this.ub);dc.TaskExtensions.Ba(dc.TaskExtensions.xe([jd,xd],this.la,3),function(){var me=xd.result,Ae=Jc.a.nba(wc.$.ya.VersionHistoryActionUrl);Ae!==Tc.a.v$&&me.XFa(Ae);me=new yd(wc.$);wc.Dd([new cd(wc.$,me)])},this.la,3)};ec.prototype.gui=function(){var wc=bb.GetServiceTaskFactory.occ(this.$.da,283,284,this.ub).then(function(jd){return jd.Jn.loadScript("excelVersionHistory")},
function(jd){tb.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",jd);return Promise.reject(jd)});return Ve.c(wc)};ec.ka=function(wc){Ca.a.he(304,new ec(wc))};Object(La.a)(ec,"VersionHistoryCommandHandlerFactory",Ca.a,[]);var of=b(1317),vf=Va.a;Am(Ya,vf);Ya.prototype.create=function(){var wc=this,jd=bb.GetServiceTaskFactory.Ua(this.$.da,211,212,this.ub),xd=bb.GetServiceTaskFactory.Ua(this.$.da,21,137,this.ub);dc.TaskExtensions.Ba(dc.TaskExtensions.xe([jd,
xd],this.$.la),function(){wc.Eb(wc.$.da.Aa(305)||new of.a(wc.$,!0,xd.result,jd.result))},this.$.la,3)};Ya.ka=function(wc){wc.da.Ga(306,new Ya(wc))};Object(La.a)(Ya,"VersionHistoryHighlightManagerFactory",Va.a,[]);var ne=b(556),Ad=b(5),Xd=b(165),ee=b(15),Le=Cb.a;Am(rb,Le);rb.prototype.execute=function(wc){this.lineageManager.lineageHidePreviousHistory();return Le.prototype.execute.call(this,wc)};Object(La.a)(rb,"LineageClearHistoryConfirmedActivity",Cb.a,[]);var Jf=b(16),$f=b(143);pb.prototype.$c=
function(){return!1};pb.prototype.executeCommand=function(wc,jd,xd){wc=!1;switch(jd.command){case 1834994092:9===jd.Xe&&this.WHj();this.cAj(jd,xd);wc=!0;break;case -409942531:this.eAj(),wc=!0}return wc?qd.Task.Ra(!0):Ac.a(jd.command)};pb.prototype.Kc=function(wc,jd){return 1834994092===jd.command||-409942531===jd.command};pb.prototype.jd=function(){return!1};pb.prototype.cAj=function(wc,jd){tb.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",jd.MenuItemId||
wc.Xe);this.lineageManager.w4f(19===wc.Xe&&!!jd.MenuItemId,jd.MenuItemId,wc.Xe)};pb.prototype.WHj=function(){var wc=Ad.a.Lrc;wc!==Xd.a(this.$).Wm.Mo&&Xd.a(this.$).Wm.activateRibbonTab(wc)};pb.prototype.eAj=function(){var wc=this;fc.a(this.$).rt(new dd.a(zb.a.jud,5,function(){var jd=vb.a(wc.$).rd,xd=Xe.a.gd(3,1,2183,2184,2185,1038647878,"LineageConfirmClearHistory");xd.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";xd.HelpDescription=ee.a.instance.fa(1286);jd.Lt([xd])}))};Object(La.a)(pb,"LineageActivityCommandHandler",
null,[424]);var Dc=Ca.a;Am(nc,Dc);nc.prototype.Nd=function(){var wc=this;dc.TaskExtensions.Ba(bb.GetServiceTaskFactory.Ua(this.$.da,366,367,this.ub),function(jd){wc.Dd([new pb(wc.$,jd.result)])},this.la,3)};nc.ka=function(wc){Ca.a.he(363,new nc(wc))};Object(La.a)(nc,"LineageActivityCommandHandlerFactory",Ca.a,[]);Pa.prototype.c7a=function(){return!this.feb};Pa.adf=function(){return Pa.Tcf()&&ge.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};Pa.Tcf=function(){return ge.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(La.a)(Pa,"LineageCatchUpExperimentManager",null,[790]);var Sd=Va.a;Am(cc,Sd);cc.prototype.create=function(){var wc=this;Pa.adf()?dc.TaskExtensions.Ba(bb.GetServiceTaskFactory.Ua(this.$.da,456,457,this.ub),function(jd){dc.TaskExtensions.Ba(jd.result.Dyj(),function(xd){wc.CEe(xd.result)},wc.$.la,3)},this.$.la,3):this.CEe(!0)};cc.prototype.CEe=function(wc){this.Eb(this.$.da.Aa(458)||
this.$.da.Ga(458,new Pa(wc)))};cc.ka=function(wc){wc.da.Ga(459,new cc(wc))};Object(La.a)(cc,"LineageCatchUpExperimentManagerFactory",Va.a,[]);var te=b(439),rd=b(37),Ue=b(85),ef=b(152),pe=b(123);Object(La.a)(ib,"LineageClientParams",null,[]);Object(La.a)(eb,"LineageFilter",null,[]);var Ne=b(63),gg=b(79),ie=b(131),Re=b(45),Ig=b(561),Lf=b(175),qf=b(119),vg=b(110),jc=b(293),zc=b(292),Md=b(107),Ce=b(21),ae=b(132),ud=b(84),Rb=b(49),Ie=b(355);Object(La.a)(Db,"LineageActivitiesResponseDTO",null,[]);Am(Wa,
Db);Object(La.a)(Wa,"LineageActivitiesUpdateResponseDTO",Db,[]);Object(La.a)(Fa,"LineageAppCallbacks",null,[]);Object(La.a)(sa,"LineageAuthorDTO",null,[]);Object(La.a)(Oa,"LineageControllerFactoryParams",null,[]);Object(La.a)(wb,"LineageSharedRangeDTO",null,[]);Object(La.a)(ob,"LineageSheetMultiRangeDTO",null,[]);Object(La.a)(gb,"LineageUserActivityDTO",null,[]);Object(La.a)(Na,"LineageValueChangeDTO",null,[]);ra.prototype.dispose=function(){this.jaj();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.uO(this.onPaneClosed),
this.lineageTaskPane.dG(this.Tz),this.lineageTaskPane=null);this.PLb=this.lrc=this.nub=this.iud=this.HF=null};ra.prototype.w4f=function(wc,jd,xd){if(this.lineageTaskPane.isVisible){if(9===xd){tb.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!wc&&16!==xd&&18!==xd){this.lineageTaskPane.H1c();return}}rd.a.Ld(this.$)||(this.PLb.start(),this.Y7&&(Rb.b().QA(this.PLb.id,this.Y7.id,"actions","actions"),this.Y7.stop(),this.Y7=
null));this.lineageTaskPane.thc||tb.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",wc?jd:xd);this.mE=this.$.ea.af;this.nub=null;wc&&(wc=Re.r(this.gridView.ha.ta.selectedRanges,this.$),this.nub=Object(Gb.a)(new ob,{rangeList:jd.toString()===Ad.a.P3f?this.Ewb(wc.Ranges):null,sheetName:wc.SheetName}));rd.a.Ld(this.$)&&this.lineageTaskPane.thc?this.lineageTaskPane.Wrj(this.REb):this.HF.createLineagePane(this.iud,this.nub);this.lineageTaskPane.jg(!0);
this.$.Zd(-71295319,-1,0,null)};ra.prototype.lineageHidePreviousHistory=function(){function wc(me,Ae,Ze){var Bf=jd.$.na.va,Qf=Bf.Na(1,null);return ud.i(Bf,"LineageHidePreviousHistory",Qf,me,Ae,Ze,null,0)}var jd=this,xd={};xd=(xd.paneVisible=this.lineageTaskPane.isVisible,xd);ef.a.sendTelemetryEvent(Object(Gb.a)(new Ie.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:pe.a.al(xd)}));ge.EwaSettings.qc()?this.$.userOperationManager.ic(new Lf.a(1018,0,wc,64),null):this.$.userOperationManager.ic(new Ig.a(1018,
0,wc,0),null);this.lineageTaskPane.isVisible||this.w4f(!1,null,4)};ra.prototype.Jbi=function(){var wc=this,jd=Object(Gb.a)(new Fa,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});Pd.a(function(){wc.HF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(Gb.a)(new Oa,{clientBatchSize:wc.batchSize,filterableSheetList:wc.S4a(),uiCulture:wc.$.ya.UICultureTag,dataCulture:wc.$.ya.DataCultureTag,logger:new Wd.a,lineageAppCallbacks:jd}))})};ra.prototype.agd=function(wc){var jd=this;return function(xd){if(xd=jc.a(xd)?null:xd.Result){var me=
{};me=(me.CountOfActivities=xd.ActivityList.length,me);me.WebRequestName=wc;ae.b(jd.$).Vd(ie.a.yMi,me);xd=Object(Gb.a)(new Db,{activityList:jd.yGd(xd.ActivityList),latestActivityId:xd.LastSearchedActivityId,oldestActivityId:xd.FirstSearchedActivityId,serverMessageCode:xd.LineageResponseCode,lastSearchedActivityTimestamp:new Date(xd.EcmaLastSearchedDate),serverFirstActivityId:xd.ServerFirstActivityId,serverLastActivityId:xd.ServerLastActivityId,showLoadPrevious:xd.ShowLoadPrevious,eolCorrelationId:xd.EolCorrelationId,
eolDateHideHistory:new Date(xd.EolDateHideHistory),eolPersonHideHistory:jd.xwb(xd.EolPersonHideHistory)});jd.HF.onLineageActivitiesResponse(xd)}else tb.ULS.shipAssertTag(537155477,0,!!xd,"LineageManager."+wc+" returned null response.")}};ra.prototype.CMj=function(wc){return vg.e(wc.Ranges)&&!wc.SheetName?null:Object(Gb.a)(new ob,{rangeList:this.Ewb(wc.Ranges),sheetName:wc.SheetName})};ra.prototype.Ewb=function(wc){var jd=[];wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next())xd=xd.value,xd=Object(Gb.a)(new wb,
{firstCol:xd.FirstColumn,firstRow:xd.FirstRow,lastRow:xd.LastRow,lastCol:xd.LastColumn}),jd.push(xd);return jd};ra.prototype.MMj=function(wc){if(!wc)return null;var jd={};jd.Ranges=this.ahd(wc.rangeList);jd.SheetName=wc.sheetName;return jd};ra.prototype.ahd=function(wc){var jd=[];if(vg.e(wc))return jd;wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next()){xd=xd.value;var me={};me.FirstColumn=xd.firstCol;me.FirstRow=xd.firstRow;me.LastRow=xd.lastRow;me.LastColumn=xd.lastCol;jd.push(me)}return jd};ra.prototype.g8h=
function(wc){(wc=this.$.xa.getItemByName(wc))&&wc.visible&&wc.activate(!0)};ra.prototype.v9e=function(wc,jd){var xd=[];jd=Cl(jd);for(var me=jd.next();!me.done;me=jd.next()){me=me.value;var Ae={};Ae.FirstColumn=me.firstCol;Ae.FirstRow=me.firstRow;Ae.LastRow=me.lastRow;Ae.LastColumn=me.lastCol;xd.push(Re.D(Ae))}jd=xd.length-1;me=xd[jd].topLeft;Ce.g(this.$).bW(xd,jd,wc,null,me,null,null,3,Md.a.iti,void 0,void 0,void 0,!0)};ra.prototype.n8i=function(){this.HF&&this.lineageTaskPane.isVisible&&(this.mE=
this.$.ea.af,this.HF.onRefreshRequired())};ra.prototype.FBg=function(){this.lineageTaskPane.wM(this.onPaneClosed);this.lineageTaskPane.tE(this.Tz);this.$.ea.Ot(this.If);this.$.ea.gk(this.qd);this.$.ea.vM(this.Io);var wc=this.$.xa;wc.$Y(this.lD);wc.pha(this.Toc);wc.gGa(this.hza);wc.iZa(this.Toc)};ra.prototype.jaj=function(){this.$.ea.Gv(this.If);this.gridView.ha.A7(this.kd);this.$.ea.Fk(this.qd);this.$.ea.AS(this.Io);var wc=this.$.xa;wc.z7(this.lD);wc.jna(this.Toc);wc.SQa(this.hza);wc.uIb(this.Toc)};
ra.prototype.onStaleActivitiesDetected=function(){this.HF.onStaleActivitiesDetected()};ra.prototype.S4a=function(){for(var wc=[],jd=Cl(this.$.xa.items),xd=jd.next();!xd.done;xd=jd.next())xd=xd.value,xd.visible&&!Ne.e(xd)&&wc.push(xd.sheetName);return wc};ra.prototype.sCj=function(){if(ge.EwaSettings.ma(621)){var wc=this.$.da.Aa(403);wc&&wc.disable();wc=new de.a(-847286761,gg.a.Vb,this.$.fd,0,Ad.a.K0);var jd={};jd=(jd.InputMethod=gg.a.Vb,jd);jd.CalloutName=5;this.$.Ka.$b(wc,jd)}};ra.prototype.yGd=
function(wc){var jd=[];wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next())xd=xd.value,xd=Object(Gb.a)(new gb,{activityId:Number.parseLocale(xd.UserActivity.Id),activityGuid:xd.Uid,activityType:xd.UserActivity.Type,author:this.xwb(xd.UserActivity.Person),sheetName:xd.SheetName,displayTimestamp:new Date(xd.UserActivity.DisplayTimestamp),gridLocation:xd.DisplayLocation,valueChanges:this.J2i(xd.LineageValueChangeList),isBulkEditOverflow:xd.IsBulkEditOverFlow,rangeHighlightLocation:this.y2i(xd.UserActivity.LocationList,
xd.UserActivity.Type),nestedActivityList:this.r2i(xd.NestedActivityList),degradedCardTypeBits:xd.DegradedCardTypeBits}),jd.push(xd);return jd};ra.prototype.y2i=function(wc,jd){if(!wc)return tb.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!wc.length)return tb.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var xd=[],me=[],Ae="";21===jd?me.push(wc[0]):me=wc;wc=Cl(me);for(me=
wc.next();!me.done;me=wc.next())switch(me=me.value,me.Type){case 1:break;case 2:Ae=me.SheetName;break;case 0:if(!me.RangeList){tb.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Ae=me.RangeList[0].SheetName;var Ze=[];21===jd?Ze.push(me.RangeList[0]):Ze=me.RangeList;me=Cl(Ze);for(Ze=me.next();!Ze.done;Ze=me.next())Ze=Ze.value,Ze=Object(Gb.a)(new wb,{firstCol:Ze.FirstColumn,firstRow:Ze.FirstRow,lastRow:Ze.LastRow,lastCol:Ze.LastColumn}),
xd.push(Ze);break;default:tb.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",me.Type)}return Object(Gb.a)(new ob,{sheetName:Ae,rangeList:xd})};ra.prototype.J2i=function(wc){var jd=[];wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next())xd=xd.value,xd=Object(Gb.a)(new Na,{hasNewValue:xd.HasNewValue,hasOldValue:xd.HasOldValue,newValue:xd.HasNewValue?xd.NewValue:null,oldValue:xd.HasOldValue?xd.OldValue:null,cellLocation:xd.CellLocation}),jd.push(xd);
return jd};ra.prototype.r2i=function(wc){return wc?this.yGd(wc):null};ra.prototype.xwb=function(wc){if(!wc)return null;var jd=null;ge.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&ub.AFrameworkApplication.ga.ra("IsUserProfilePictureResolutionEnabled")&&(jd=this.lrc.jIa(wc.Email,wc.Provider,ub.AFrameworkApplication.oj,0));return Object(Gb.a)(new sa,{id:wc.Id,provider:wc.Provider,displayName:wc.DisplayName,email:wc.Email,imageUrl:jd})};Object(La.a)(ra,
"LineageManager",null,[793,2]);var pa=Va.a;Am(ta,pa);ta.prototype.Oti=function(wc){var jd=this;dc.TaskExtensions.Ba(wc,function(){jd.Eb(jd.$.da.Aa(366)||new ra(jd.$,jd.$.da,jd.lineageTaskPane,jd.Y7))},this.$.la,3)};ta.prototype.create=function(){var wc=this;this.Y7=this.$.Ob.Hc("UserAction","LineagePaneSeenStopwatch");this.Y7.start();var jd=bb.GetServiceTaskFactory.Ua(this.$.da,365,364,this.ub),xd=te.a(this.$),me=bb.GetServiceTaskFactory.Ua(this.$.da,283,284,this.ub);dc.TaskExtensions.Ba(dc.TaskExtensions.xe([jd,
xd,me],this.$.la),function(){wc.lineageTaskPane=jd.result;rd.a.Ld(wc.$)||xd.result.vR(wc.lineageTaskPane);wc.Oti(Ve.c(me.result.Jn.loadScript("cellLineage")))},this.$.la,3)};ta.ka=function(wc){wc.da.Ga(367,new ta(wc))};Object(La.a)(ta,"LineageManagerFactory",Va.a,[]);var qb=b(1001),Sb=b(228),$b=b(13),tc=b(109),ld=b(257),Vc=b(86),Se=b(242),Ge=b(19),Af=b(912),jf=b(67),Ef=Ad.a.kAc+"LineageActivityPaneTitle",Xf=Ad.a.Geb+"LineageActivityCloseButton",ug=Se.a;Am(ac,ug);ac.prototype.ZP=function(wc){this.get_events().addHandler("LineageTaskPaneRemove",
wc)};ac.prototype.BS=function(wc){this.get_events().removeHandler("LineageTaskPaneRemove",wc)};ac.prototype.tE=function(wc){this.addHandler("LineageTaskPaneVisibilityChanged",wc)};ac.prototype.dG=function(wc){this.removeHandler("LineageTaskPaneVisibilityChanged",wc)};ac.prototype.wM=function(wc){this.get_events().addHandler("LineageTaskPaneClose",wc)};ac.prototype.uO=function(wc){this.get_events().removeHandler("LineageTaskPaneClose",wc)};ac.prototype.UH=function(){};ac.prototype.vp=function(){return this.Np};
ac.prototype.ns=function(){return this.Np};ac.prototype.oS=function(){};ac.prototype.rR=function(){return!1};ac.prototype.Ej=function(){};ac.prototype.Rj=function(){};ac.prototype.dispose=function(){this.$&&(this.$.sm(this.Zc),Zb.a(this.$).Xz(this));this.te&&(Sb.a.instance.za($b.a.click,this.te,this.ak),tc.KeyInputManager.instance.Uv(this.te,this.BAe));this.te=this.taskPaneManager=this.$=null;ug.prototype.dispose.call(this)};ac.prototype.Wf=function(wc,jd){if(!jd){wc=sd.DOMElementExtensions.getElementById(this.domElement,
"LineagePaneFilterButton");if(!wc)return!1;sd.DOMElementExtensions.setFocus(wc)}return!jd};ac.prototype.sh=function(wc){return sd.DOMElementExtensions.Gf(this.uc,wc)};ac.prototype.jg=function(wc){this.Np=wc;var jd=this.taskPaneManager;if(this.isVisible=wc)this.$.frame.Qe.Vj("LineagePane"),this.Dqd=!1;if(rd.a.Ld(this.$))wc?jd.qS("LineageTaskPane",this.SI):jd.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.px();var xd=!!this.taskPaneManager.Ig&&15===this.taskPaneManager.Ig.taskPane.eh;wc&&
0<jd.fA.length&&(!xd||jd.isCollapsed)&&jd.CD(this,!0)}this.$.Bf()};ac.prototype.LM=function(){var wc=this.$.Lb;wc=rd.a.Ld(this.$)?this.domElement:document.getElementById(wc+Ad.a.mud);var jd=this.jH();wc.appendChild(jd);jd=Af.b("div","LineagePaneBodyId","LineageActivityBody");wc.appendChild(jd);this.Xrj();return jd};ac.prototype.H1c=function(){this.$.frame.Qe.Vj(this.$.frame.Qe.ZE||ld.AFrame.CU);this.Dqd=!0;this.jg(!1);this.raiseEvent("LineageTaskPaneClose")};ac.prototype.Wrj=function(wc){this.REb=
wc};ac.prototype.Xrj=function(){this.$.frame.Qe.ek("LineagePane");var wc=this.$.frame.Qe.Ai("LineagePane");wc.parent=ld.AFrame.CU;wc.XR=!0};ac.prototype.jH=function(){var wc=Af.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),jd=Af.b("h1","LineagePaneTitleId",Ef);jd.innerText=this.titleText;this.te=qb.a.Bb("LineagePaneCloseButtonId",Xf,ee.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.te.classList.add(ub.AFrameworkApplication.isRtl?Ad.a.Yaa:Ad.a.Zaa);Sb.a.instance.pa($b.a.click,this.te,
this.ak);this.BAe=tc.KeyInputManager.instance.zs(this.te,this.ak,Vc.a.ei);wc.appendChild(jd);wc.appendChild(this.te);return wc};ac.ka=function(wc,jd){var xd=wc.Lb,me=document.getElementById(xd+Ad.a.mud);me||(me=document.createElement("div"),me.id=wc.Lb+Ad.a.mud,me.classList.add("LineageActivityPane"),rd.a.Ld(wc)||document.getElementById(xd+Ad.a.iS).appendChild(me));return wc.da.Aa(365)||wc.da.Ga(365,new ac(me,wc,jd))};Ck.Object.defineProperties(ac.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(jf.a)(ac.prototype,this,"isVisible")},set:function(wc){Object(jf.a)(ac.prototype,this,"isVisible")!==wc&&(Object(jf.b)(ac.prototype,this,"isVisible",wc),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},thc:{configurable:!0,enumerable:!0,get:function(){return this.Dqd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},eh:{configurable:!0,enumerable:!0,get:function(){return 15}},ve:{configurable:!0,enumerable:!0,get:function(){return Sc.a.jti}},
Qk:{configurable:!0,enumerable:!0,get:function(){return Ge.a.Mvh}},lN:{configurable:!0,enumerable:!0,get:function(){return ee.a.instance.fa(1040)}},Do:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},uc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.aP.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return ee.a.instance.fa(1261)}},
SI:{configurable:!0,enumerable:!0,get:function(){var wc=this;return this.taskPaneManager.nva(this.uc,this.titleText,this.Do,this.isResizable,function(){wc.isVisible=!0;wc.REb?wc.REb():tb.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){wc.isVisible=!1},function(){wc.isVisible=!0},function(){wc.isVisible=!1},this.Do)}}});Object(La.a)(ac,"LineageTaskPane",Se.a,[788,2,548,438]);var Wb=Va.a;Am(kb,Wb);kb.prototype.create=function(){var wc=this,jd=bb.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.ub),xd=bb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub);dc.TaskExtensions.Ba(dc.TaskExtensions.ts(dc.TaskExtensions.xe([jd,xd],this.la),function(){return wc.qD},this.la),function(){wc.Eb(wc.lh)},this.la,3)};kb.prototype.dispose=function(){this.lh=this.wi=this.$=null;Wb.prototype.dispose.call(this)};kb.ka=function(wc){wc.da.Ga(364,new kb(wc))};Ck.Object.defineProperties(kb.prototype,{qD:{configurable:!0,enumerable:!0,get:function(){var wc=this;this.wi||(this.wi=dc.TaskExtensions.Ba(te.a(this.$),
function(jd){wc.lh=ac.ka(wc.$,jd.result)},this.la,3));return this.wi}}});Object(La.a)(kb,"LineageTaskPaneFactory",Va.a,[]);db.prototype.dispose=function(){this.BJd();this.$=null;tb.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};db.prototype.disable=function(){db.xxb||(db.xxb=!0,tb.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.BJd()};db.prototype.zWj=function(){var wc=this;ge.EwaSettings.ma(617)&&
!this.$.isAnonymousUser()&&ud.l(this.$.na.va,function(jd){wc.$?(jd=jd.Result,tb.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",jd),db.N7e=!0,jd&&wc.rag(0)):tb.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){tb.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};db.prototype.tWj=function(){ge.EwaSettings.ma(616)&&
!this.Cag()&&(this.$.ea.Ot(this.If),this.drd=!0)};db.prototype.Cag=function(){return this.$.ea&&this.$.ea.Rm&&this.$.ea.Rm.ShouldTriggerLineageCalloutOnMerge?(tb.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.rag(1),!0):!1};db.prototype.rag=function(wc){if(db.xxb)tb.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(db.xxb=!0,tb.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",wc),this.BJd(),ge.EwaSettings.ma(486)){wc=new de.a(-847286761,gg.a.Vb,this.$.fd,0,Ad.a.K0);var jd={};jd=(jd.CalloutName=4,jd);this.$.Ka.$b(wc,jd)}};db.prototype.BJd=function(){this.drd&&(this.drd=!1,this.$.ea.Gv(this.If))};db.xxb=!1;db.N7e=!1;Object(La.a)(db,"LineageTeachingCalloutTriggerManager",null,[787,2]);var Kc=Va.a;Am(sb,Kc);sb.prototype.create=function(){var wc=this;dc.TaskExtensions.Ba(bb.GetServiceTaskFactory.Ua(this.$.da,
458,459,this.ub),function(jd){jd=new db(wc.$,jd.result);wc.Eb(jd)},this.$.la,3)};sb.ka=function(wc){wc.da.Ga(402,new sb(wc))};Object(La.a)(sb,"LineageTeachingCalloutTriggerManagerFactory",Va.a,[]);var Id=b(1089),Bd=b(74);Ta.prototype.HX=function(wc,jd,xd,me){var Ae=this;return this.Thh(wc,void 0===me?null:me,function(Ze){return Ae.Wg.rZb(Ze,2,xd,jd,void 0,void 0,void 0,void 0,void 0,"2")})};Ta.prototype.Thh=function(wc,jd,xd){var me=this,Ae=!!jd&&""!==jd,Ze=wc;Ae&&(Ze=Jc.a.vU(wc,"perfTag",jd));var Bf=
new Date;return Id.a.then(xd(Ze),function(Qf){var Vg=+new Date-+Bf;if(!Qf||!Qf.gh||!Qf.gh.data)return Qf;Ae&&Qf.gh.data.request&&me.aoj(Qf.gh.data.request.getResolvedUrl(),jd,Vg);return Qf})};Ta.prototype.aoj=function(wc,jd,xd){wc=this.Su.IXh(wc);if(wc.count&&(wc=Bd.last(wc))){var me={Message:"Request durations for activities calls."};me.PerfTag=jd;me.CustomDuration=xd;me.PerformanceDuration=wc.duration;tb.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(me))}};Object(La.a)(Ta,"CatchUpNetworkingWrapper",
null,[182]);var oe=b(252),Hd=oe.a;Am(wa,Hd);wa.prototype.gba=function(){return 6};Object(La.a)(wa,"GetActivityFeedRequest",oe.a,[]);var we=oe.a;Am(qa,we);qa.prototype.gba=function(){return 7};Object(La.a)(qa,"UpdateActivityFeedStateRequest",oe.a,[]);var df=b(410);Aa.prototype.getActivityFeed=function(wc){var jd=this;return Id.a.then(this.IVa.execute(new wa(this.sVa(),null),function(xd,me,Ae){return jd.ttg.HX(xd,me,Ae,"ActivityFeed")},wc),function(xd){if(!xd)return tb.ULS.sendTraceTag(572846937,3012,
10,"GetActivityFeed: Response is null"),null;if(!xd.gh)return tb.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!xd.gh.data)return tb.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!xd.gh.data.me)return tb.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;xd=df.a.KIa(xd.gh.data.me);return xd?xd:(tb.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),
null)})};Object(La.a)(Aa,"CatchUpRequestHandler",null,[179]);var sf=b(515);va.prototype.Tui=function(){this.Evi()};va.prototype.Evi=function(){var wc=this;this.Nga?this.Nga.execute(function(jd){window.setTimeout(function(){wc.Ibe.contains("CatchUpChangesFeedback")||(wc.Ibe.add("CatchUpChangesFeedback"),jd.logActivity("CatchUpChangesFeedback",null))},2E4)}):tb.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(La.a)(va,"FloodgateEventLogger",
null,[]);var wf=b(201);Ck.Object.defineProperties(xa.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.oug.duration}}});Object(La.a)(xa,"PerformanceResourceTimingWrapper",null,[]);ka.prototype.IXh=function(wc){var jd=new wf.a;if(!this.Su)return jd;wc=this.Su.getEntriesByName(wc,"resource");if(!wc)return jd;wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next())jd.add(new xa(xd.value));return jd};Object(La.a)(ka,"PerformanceWrapper",null,[]);var $e=b(255);ha.prototype.fi=
function(wc){var jd=this;this.tb=wc;this.tb.register(Ta,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Ic().Oc(function(){return new Ta(ub.AFrameworkApplication.Jd,new ka(window.performance))});this.tb.register(Aa,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Ic().Oc(function(){return new Aa(jd.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return ub.AFrameworkApplication.oj},
new df.a)});this.tb.register(va,"Common.App.CatchUpActivity.FloodgateEventLogger").Ic().Oc(function(){return new va(jd.tb.lc("Common.ISystemInitiatedFeedback"))})};ha.prototype.init=function(){this.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.tb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ha.prototype.dispose=function(){};ha.main=function(){$e.a.instance.hj(new ha)};Ck.Object.defineProperties(ha.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});
Object(La.a)(ha,"CatchUpActivityPackage",null,[4,5]);na.prototype.$c=function(wc,jd){return this.catchUpActivityManager?-876699925===jd?!this.catchUpActivityManager.Scf:!1:!0};na.prototype.executeCommand=function(wc,jd){wc=!1;switch(jd.command){case -876699925:wc=this.catchUpActivityManager.oUi()}return wc?qd.Task.Ra(!0):Ac.a(jd.command)};na.prototype.Kc=function(wc,jd){return ge.EwaSettings.ma(440)&&-876699925===jd.command?!0:!1};na.prototype.jd=function(){return!1};Object(La.a)(na,"CatchUpActivityCommandHandler",
null,[424]);var pf=Ca.a;Am(aa,pf);aa.prototype.Nd=function(){var wc=this;this.$.da.$a(286,function(jd){wc.Dd([new na(wc.$,jd)])})};aa.ka=function(wc){Ca.a.he(285,new aa(wc))};Object(La.a)(aa,"CatchUpActivityCommandHandlerFactory",Ca.a,[]);var bg=b(276),Zd=b(566),Ma=b(90),Hb=b(83),ic=b(27);fa.prototype.doesContentExist=function(wc){if(!wc)return tb.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(wc.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!wc.navigationId)return tb.ULS.sendTraceTag(537168065,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var jd={};jd.NavigationId=atob(wc.navigationId);return 32===this.Ei.Be(ic.a.XIa,2,jd);default:return!1}};Object(La.a)(fa,"CatchUpActivityContentManager",null,[810]);var Lc=b(1034),td=b(1312);U.prototype.dispose=function(){this.sv.IQf(this.NEb);this.Fz=null};U.prototype.vrj=function(wc){this.Fz.push(wc)};U.prototype.jZg=function(){Array.clear(this.Fz)};U.prototype.H4f=function(wc){for(var jd=Cl(this.Fz),xd=jd.next();!xd.done;xd=
jd.next())xd=xd.value,xd.className=Lc.a.XVg,xd=document.getElementById(String.format("{0}-{1}",xd.id,Ad.a.Xxe)),sd.DOMElementExtensions.setVisible(xd,wc)};U.prototype.ZLb=function(wc){for(var jd=Cl(this.Fz),xd=jd.next();!xd.done;xd=jd.next())if(xd=xd.value)wc?xd.className=2===this.sv.model.state?Lc.a.t5i:Lc.a.u5i:this.H4f(!1)};Ck.Object.defineProperties(U.prototype,{sv:{configurable:!0,enumerable:!0,get:function(){return this.Aqg}}});Object(La.a)(U,"RangeCatchUpActivityView",null,[864,2]);var pd=
b(22),Qe=td.a;Am(L,Qe);L.prototype.dispose=function(){this.gridView=null;Qe.prototype.dispose.call(this)};L.prototype.cEg=function(wc){var jd=this.jgb[0];jd?jd.vrj(wc):tb.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Zma.activityId)};L.prototype.shj=function(){var wc=this.jgb[0];wc&&wc.jZg()};L.prototype.pCg=function(wc){this.Zma.addRange(wc)};L.prototype.MMh=function(){if(3!==this.Zma.activityType)return null;
tb.ULS.shipAssertTag(537168003,0,1===this.Zma.xMb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Re.D(this.Zma.xMb[0])};L.prototype.$Jb=function(wc){if(wc){if(!this.Zma)return;this.ryd(this.wij())}Qe.prototype.$Jb.call(this,wc)};L.prototype.e5c=function(){var wc=this.L4c();this.jgb.push(wc)};L.prototype.L4c=function(){return new U(this)};L.prototype.ryd=function(wc){wc?wc.SheetName?(this.gridView.ha.Oa.oH(null),this.gridView.focus(),
this.gridView.P5e(wc,3,!1,Md.a.s5i)):tb.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):tb.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};L.prototype.wij=function(){if(vg.e(this.Zma.xMb))return tb.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),
null;var wc=this.$.xa.qa;tb.ULS.shipAssertTag(537167970,0,!!wc,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");wc=this.JNj(wc.sheetName,this.Zma.xMb);if(!wc&&(wc=this.n1h(this.Zma.xMb),!wc))return null;var jd={};jd.SheetName=wc.SheetName;jd.FirstColumn=wc.FirstColumn;jd.FirstRow=wc.FirstRow;jd.LastColumn=wc.FirstColumn;jd.LastRow=wc.FirstRow;return jd};L.prototype.n1h=function(wc){if(vg.e(wc))return null;for(var jd=null,xd=0;xd<wc.length;xd++){var me=
wc[xd].SheetName;if(!pd.a.equals(me,jd,!1)&&(jd=me,me=this.$.xa.getItemByName(me),null===me||void 0===me?0:me.visible))return wc[xd]}return null};L.prototype.JNj=function(wc,jd){if(jd){jd=Cl(jd);for(var xd=jd.next();!xd.done;xd=jd.next())if(xd=xd.value,pd.a.equals(xd.SheetName,wc,!1))return xd}return null};Object(La.a)(L,"RangeCatchUpActivityHighlightController",td.a,[]);var ff=b(76),hf=ff.a;Am(H,hf);H.prototype.dispose=function(){this.y2d=null;hf.prototype.dispose.call(this)};Ck.Object.defineProperties(H.prototype,
{type:{configurable:!0,enumerable:!0,get:function(){return this.mC}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.y2d}},activityType:{configurable:!0,enumerable:!0,get:function(){return this.Tkg}}});Object(La.a)(H,"CatchUpActivityHighlightModelBase",ff.a,[]);Am(I,H);I.prototype.addRange=function(wc){wc=Cl(wc);for(var jd=wc.next();!jd.done;jd=wc.next())this.ranges.push(jd.value)};I.prototype.dispose=function(){this.ranges=null;H.prototype.dispose.call(this)};I.C3b=function(wc,
jd){if(!wc.SheetName||!jd.SheetName)return tb.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;var xd=wc.SheetName.localeCompare(jd.SheetName);return xd?xd:wc.FirstColumn<jd.FirstColumn||wc.FirstColumn===jd.FirstColumn&&wc.FirstRow<jd.FirstRow?-1:wc.FirstColumn===jd.FirstColumn&&wc.FirstRow===jd.FirstRow?0:1};Ck.Object.defineProperties(I.prototype,{xMb:{configurable:!0,enumerable:!0,get:function(){this.N7a||(this.ranges.sort(I.C3b),
this.N7a=!0);return this.ranges}}});Object(La.a)(I,"RangeCatchUpActivityHighlightModel",H,[]);var yg=b(354);ca.prototype.dispose=function(){this.Ele=this.oLb=this.E2c=null};ca.prototype.tej=function(wc){Ce.g(wc).Cb.Gn([24])};ca.prototype.j6g=function(wc,jd,xd){var me={};jd=Cl(jd);for(var Ae=jd.next();!Ae.done;Ae=jd.next())if((Ae=Ae.value)&&!vg.e(Ae.LocationList)){for(var Ze=[],Bf={},Qf=[],Vg=Cl(Ae.LocationList),Rf=Vg.next();!Rf.done;Rf=Vg.next()){Rf=Rf.value;if(!Rf){tb.ULS.shipAssertTag(537168013,
0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Ae.Id);break}switch(Rf.Type){case 0:var De=Rf;"0"in Bf?(Rf=Bf["0"],Rf.pCg(De.RangeList)):(Rf=new L(wc,new I(wc,Ae.Id,Ae.Type,0,De.RangeList),xd),Ze.push(Rf),Bf["0"]=Rf);De=Cl(De.RangeList);for(var Lg=De.next();!Lg.done;Lg=De.next()){Lg=Lg.value;Lg=new yg.a(Re.D(Lg),Ne.d(wc.xa.getItemByName(Lg.SheetName)));if(this.rxc(Lg)in this.oLb)this.oLb[this.rxc(Lg)].push(Rf);else{var $d=[];$d.push(Rf);
this.oLb[this.rxc(Lg)]=$d}Qf.push(Lg);this.E2c.push(Lg)}break;default:tb.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}tb.ULS.shipAssertTag(537168011,0,!(Ae.Id in me),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Ae.Id);this.Ele[Ae.Id]=Qf;me[Ae.Id]=Ze}this.G7g(wc,this.E2c,this.oLb);return me};ca.prototype.cZg=function(wc){for(var jd in wc)for(var xd=
Cl(wc[jd]),me=xd.next();!me.done;me=xd.next())me.value.shj()};ca.prototype.rxc=function(wc){return String.format("{0}-{1}",wc.range,wc.sheetId)};ca.prototype.G7g=function(wc,jd,xd){var me=this;this.cZg(xd);Ce.g(wc).Cb.lx(jd,[24],!0,function(Ae,Ze){var Bf=new yg.a(Ae.range,Ae.sheetId);Bf=me.rxc(Bf);var Qf=xd[Bf];if(Qf)for(Bf=Cl(Qf),Qf=Bf.next();!Qf.done;Qf=Bf.next())Qf=Qf.value,Qf.cEg(Ze),Ae.metadata=Qf;else tb.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+
Bf)})};Object(La.a)(ca,"CatchUpHighlightControllersCreator",null,[]);Object(La.a)(Z,"CreateIndicatorTooltipParameters",null,[]);Object(La.a)(ea,"DismissIndicatorTooltipParameters",null,[]);Object(La.a)(Q,"UpdateIndicatorTooltipParameters",null,[]);R.prototype.dispose=function(){this.ha.atc(this.il);this.ha.cG(this.kd);this.gridView.aG(this.Dp);this.Ya.kl(this.gj);this.vIe();this.Xbd=this.xka=this.Cec=this.GRa=this.Ya=this.ha=this.gridView=null};R.prototype.jpj=function(){var wc=[];this.vIe();if(!vg.e(wc)){tb.ULS.sendTraceTag(537168035,
0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.t5=this.n4b.j6g(this.$,wc,this)){wc=this.t5;for(var jd in wc)for(var xd=Cl(wc[jd]),me=xd.next();!me.done;me=xd.next())this.CMg(me.value)}this.n4b.tej(this.$)}};R.prototype.syc=function(wc){if(wc&&this.ald)tb.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(wc||this.Csb(),this.t5){var jd=this.t5,xd;for(xd in jd)for(var me=
Cl(jd[xd]),Ae=me.next();!Ae.done;Ae=me.next())Ae.value.ABj(wc)}};R.prototype.f8h=function(wc){this.xka&&this.Z6b(!0);this.M6c();if(wc=this.t5[wc.activityId]){wc=Cl(wc);for(var jd=wc.next();!jd.done;jd=wc.next())jd.value.$Jb(!0)}else tb.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};R.prototype.vIe=function(){if(this.t5){var wc=this.t5,jd;for(jd in wc)for(var xd=Cl(wc[jd]),me=xd.next();!me.done;me=xd.next())me=me.value,this.kaj(me),
me.dispose()}this.t5={};this.n4b.dispose();this.n4b=null};R.prototype.fAj=function(){if(this.excelCommentManager){var wc=this.t5[this.GRa];wc&&0<wc.length&&3===wc[0].model.activityType&&((wc=wc[0])?this.excelCommentManager.IAj(wc.MMh()):tb.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};R.prototype.y7h=function(){this.excelCommentManager&&this.excelCommentManager.ztb()};R.prototype.M6c=function(){if(this.GRa){var wc=
this.t5[this.GRa];if(wc){wc=Cl(wc);for(var jd=wc.next();!jd.done;jd=wc.next())jd.value.$Jb(!1);this.GRa=null}else tb.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};R.prototype.Csb=function(){this.M6c();this.Z6b(!0)};R.prototype.WNj=function(wc){if(!wc)return tb.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;wc=String.format("{0}-{1}",wc.id,
Ad.a.VVg);var jd=this.Xbd[wc];if(!jd){if(!this.gridView.domElement)return tb.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;jd=document.createElement("Div");jd.className=Lc.a.WVg;jd.id=wc;this.gridView.domElement.appendChild(jd);this.Xbd[wc]=jd}return jd};R.prototype.Z6b=function(wc){this.sfa&&(this.sfa.dismissActivityIndicatorTooltips(Object(Gb.a)(new ea,{clearSticky:wc})),this.Cec=null,wc&&(this.xka=null),this.Wgc&&!this.xka&&
(this.gridView.view.Yq(this.SBc),this.gridView.gx(this.SBc),this.Wgc=!1))};R.prototype.CMg=function(wc){wc.Vne(this.NEb);wc.IEg(this.G3f);wc.HEg(this.nJe)};R.prototype.kaj=function(wc){wc.IQf(this.NEb);wc.rbj(this.G3f);wc.qbj(this.nJe)};Ck.Object.defineProperties(R.prototype,{yAg:{configurable:!0,enumerable:!0,get:function(){return this.sfa},set:function(wc){this.sfa=wc}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.LDa||(this.LDa=this.$.da.Aa(65));return this.LDa}},n4b:{configurable:!0,
enumerable:!0,get:function(){this.o4b||(this.o4b=new ca);return this.o4b},set:function(wc){this.o4b=wc}}});Object(La.a)(R,"CatchUpActivityHighlightManager",null,[829,2]);T.prototype.navigateToActivity=function(wc){if(wc.fromSummaryString){var jd=new de.a(1834994092,gg.a.Vb,this.$.fd,18,null);this.$.Ka.$b(jd);return this.QUa(1)}wc=wc.activity;if(!this.ufi(wc))return this.QUa(4);if(!this.moi(wc))return this.QUa(7);var xd={};try{jd=window.self.atob(wc.navigationId);if(!jd)return this.QUa(5);xd.NavigationId=
jd}catch(me){return tb.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",me),this.QUa(5)}if(8===this.Ei.Be(ic.a.XIa,2,xd))return this.Ei.processAction(ic.a.I9a,2),this.QUa(2);jd=32===this.Ei.Be(ic.a.K0a,2,xd)?1:6;return this.QUa(jd)};T.prototype.ufi=function(wc){return wc&&wc.navigationId?!0:!1};T.prototype.moi=function(wc){switch(wc.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};T.prototype.QUa=function(wc){return Promise.resolve(wc)};
Object(La.a)(T,"CatchUpActivityNavigationManager",null,[811]);var bf=b(473);Object(La.a)(M,"GetRelevantActivitiesDataRequest",null,[]);Object(La.a)(A,"Activity",null,[]);Object(La.a)(C,"ActivityFeedItem",null,[]);Object(La.a)(v,"ActivityFeedPayload",null,[]);Object(La.a)(B,"ActivityRequestPayload",null,[]);Object(La.a)(u,"Person",null,[]);Am(t,A);Object(La.a)(t,"TaskActivity",A,[]);y.prototype.requestWYWAActivities=function(){var wc=this;return this.c7a?new Promise(function(jd,xd){x(wc.$.na.va,function(me){me=
jc.a(me)?null:me.Result;me=Object(Gb.a)(new B,{activities:[],actors:me?wc.Mgd(me.WywaAuthors):null,hasMore:!1,highWaterline:y.G1a,lowWaterline:y.G1a,wywaWaterline:y.G1a});jd(me)},function(){tb.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");xd(null)},null,null)}):Promise.resolve(y.r6b)};y.prototype.requestActivities=function(){return Promise.resolve(y.r6b)};y.prototype.requestRelevantActivities=function(){var wc=this;if(!this.$.ea.sc||this.$.ea.A5a)return tb.ULS.sendTraceTag(537168021,
3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.sc,this.$.ea.A5a),Promise.resolve(y.r6b);var jd=Object(Gb.a)(new M,{SetDaysBack:ub.AFrameworkApplication.ga.Cd("AppWaterlineOverrideDaysValue",0),SetTimestamp:ub.AFrameworkApplication.ga.Cd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(xd,me){r(wc.$.na.va,jd,function(Ae){var Ze=y.r6b;Ae?jc.a(Ae)?tb.ULS.sendTraceTag(578353159,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Xe.a.Xc(Ae.Errors)):Ze=wc.oXh(Ae.Result):tb.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");xd(Ze)},function(Ae){Ae=qf.a.pg(Ae.data);tb.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Xe.a.Xc(Ae));me(null)},null,null)})};y.prototype.requestActivityFeed=
function(){var wc=this;return Ve.b(this.getActivityFeed()).then(function(jd){return Object(Gb.a)(new v,{activityFeedItems:wc.AMj(jd)})})};y.prototype.updateActivityState=function(){return Promise.resolve(!1)};y.prototype.getActivityFeed=function(){return this.$xe?Id.a.uWd(this.$xe,function(wc){return wc.getActivityFeed(null)}):qd.Task.Ra([])};y.prototype.oXh=function(wc){if(!wc)return tb.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),
Object(Gb.a)(new B,{activities:[]});var jd=this.lag(wc.NewActivities,2);wc=this.lag(wc.OutstandingActivities,3);wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next())jd.push(xd.value);return Object(Gb.a)(new B,{activities:jd})};y.prototype.lag=function(wc,jd){jd=void 0===jd?1:jd;var xd=[];if(!wc||!wc.length)return xd;wc=Cl(wc);for(var me=wc.next();!me.done;me=wc.next())if(me=me.value){var Ae=y.HMj(me.Type);6===Ae||7===Ae||9===Ae||8===Ae?xd.push(Object(Gb.a)(new t,{activityId:me.Id,type:Ae,displayTimestamp:new Date(me.DisplayTimestamp),
navigationId:me.NavigationId,actors:this.Mgd(me.People),relevancy:jd,relationship:this.GMj(me.Relationship)})):xd.push(Object(Gb.a)(new A,{activityId:me.Id,type:Ae,displayTimestamp:new Date(me.DisplayTimestamp),navigationId:me.NavigationId,actors:this.Mgd(me.People),relevancy:jd}))}else tb.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return xd};y.prototype.GMj=function(wc){switch(wc){case 1:return 1;case 2:return 2;
case 3:return 3}tb.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};y.prototype.AMj=function(wc){var jd=[];wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=wc.next())xd=xd.value,xd=Object(Gb.a)(new C,{id:xd.id,type:xd.type,collectionId:xd.collectionId,activityState:xd.activityState,activityFeedItemPayload:xd.activityFeedItemPayload,timestamp:xd.timestamp}),jd.push(xd);return jd};y.prototype.Mgd=function(wc){var jd=[];if(!wc||!wc.length)return jd;wc=Cl(wc);for(var xd=wc.next();!xd.done;xd=
wc.next())(xd=xd.value)&&jd.push(this.xwb(xd));return jd};y.prototype.xwb=function(wc){return Object(Gb.a)(new u,{id:wc.Id,provider:wc.Provider,displayName:wc.DisplayName,email:wc.Email,imageUrl:this.lrc.jIa(wc.Email,wc.Provider,ub.AFrameworkApplication.oj,0),color:this.nGb.hid(new bf.a(null,void 0,wc.DisplayName),6)})};y.HMj=function(wc){switch(wc){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return tb.ULS.shipAssertTag(537168015,
3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};y.G1a="<WywaWaterline>DefaultWaterline</WywaWaterline>";y.r6b=Object(Gb.a)(new B,{activities:[],actors:[],hasMore:!1,highWaterline:y.G1a,lowWaterline:y.G1a,wywaWaterline:y.G1a});Object(La.a)(y,"CatchUpActivityRequestManager",null,[812]);h.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.G8a)return!1;if(!ge.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var wc=
this.$.da.Aa(365);return!wc||!wc.isVisible}return!0};h.prototype.onButtonClick=function(){var wc={};wc=(wc.InputMethod=gg.a.Vb,wc);this.$.Ka.$b(new de.a(1834994092,gg.a.Vb,this.$.fd,16,null),wc)};h.prototype.getExplanationText=function(){var wc=this.$.da.Aa(365);return ee.a.instance.Wa(wc&&wc.isVisible?644:643)};h.prototype.getCommandName=function(){return ee.a.instance.fa(442)};Object(La.a)(h,"CatchUpEmptyExperienceBehaviorManager",null,[813]);n.prototype.dispose=function(){Zb.a(this.$).Xz(this)};
n.prototype.Wf=function(wc,jd){if(jd)return!1;wc=document.getElementById("flyoutItem0");if(!wc)return tb.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;wc.focus();this.Agh(wc);return!0};n.prototype.sh=function(wc){return this.uc?sd.DOMElementExtensions.Gf(this.uc,wc):!1};n.prototype.Ej=function(){this.hasFocus=!0};n.prototype.Rj=function(){this.hasFocus=!1};n.prototype.Agh=function(wc){if(Sys.Browser.agent===Sys.Browser.Firefox){var jd=document.createEvent("KeyboardEvent");
jd.initKeyEvent($b.a.Xb,!0,!0,window.self,!1,!1,!1,!1,Vc.a.fDc,0);wc.dispatchEvent(jd)}else jd=document.createEvent("Events"),jd.initEvent($b.a.Xb,!0,!0),jd.keyCode=Vc.a.fDc,jd.which=Vc.a.fDc,wc.dispatchEvent(jd)};Ck.Object.defineProperties(n.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Aef&&!this.hasFocus}},ve:{configurable:!0,enumerable:!0,
get:function(){return Sc.a.e0c}}});Object(La.a)(n,"FlyoutFocus",null,[438,2]);var Cg=b(393);m.prototype.dispose=function(){this.Ojb=this.zzb=!1};m.prototype.registerButtonClickedEvent=function(wc){this.buttonClickedCallback&&tb.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=wc.buttonClickedCallback};m.prototype.onFlyoutInitialized=function(){this.zzb&&tb.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");
var wc=(new Date).getTime()-this.vEh.getTime();tb.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",wc);nb.c(ic.a.ZVg,!0,nb.e,0,0,wc);this.zzb=!0;Cg.a.gz&&Cg.a.gz.updateCommandUI(!0)};m.prototype.logFlightTriggers=function(){};m.prototype.toggleCatchUpFlyout=function(){this.zzb?this.buttonClickedCallback?this.buttonClickedCallback():tb.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):
tb.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};m.prototype.onFlyoutVisibilityChanged=function(wc){this.Ojb!==wc.flyoutIsVisible&&(this.Ojb=wc.flyoutIsVisible,Cg.a.gz&&Cg.a.gz.updateCommandUI(!0),this.Ojb||this.sVe&&this.sVe.Tui())};Ck.Object.defineProperties(m.prototype,{Aef:{configurable:!0,enumerable:!0,get:function(){return this.Ojb}}});Object(La.a)(m,"FlyoutRibbonButton",null,[828]);var Gg=b(572);Object(La.a)(f,"CatchUpConfiguration",
null,[]);Object(La.a)(e,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.pHa&&this.pHa.getWywaEvent().removeListener(this.wFf);this.pHa=this.$=null;Ma.a.Ha(this.$_a);this.flyoutRibbonButton=this.flyoutFocus=this.i4d=this.Yxe=this.Zxe=this.$_a=null};c.prototype.oUi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.xvi=function(){tb.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.scf()&&tb.ULS.sendTraceTag(526718752,
3012,50,"ActivityFeedData is enabled")};c.prototype.Ati=function(wc,jd){w("ScriptDownload");dc.TaskExtensions.Ba(bb.GetServiceTaskFactory.Ua(this.$.da,283,284,jd),function(xd){wc(Ve.c(xd.result.Jn.loadScript("catchUpActivity")))},this.$.da.la,3)};c.prototype.c7a=function(){return!!this.Alf&&this.Alf.c7a()&&this.$.ea.G8a};c.prototype.scf=function(){return ge.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.ZHi=function(wc){var jd=this;dc.TaskExtensions.Ba(wc,
function(){Pd.a(function(){jd.pHa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(Gb.a)(new e,{activityContentManager:Object(Hb.a)(810,jd.i4d),activityNavigationManager:Object(Hb.a)(811,jd.Yxe),activityRequestManager:Object(Hb.a)(812,jd.Zxe),dataCulture:jd.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Hb.a)(m,jd.flyoutRibbonButton),uiCulture:jd.$.ya.UICultureTag,ulsLogger:new Wd.a,emptyCatchUpBehaviorManager:Object(Hb.a)(813,jd.emptyCatchUpBehaviorManager)}))});jd.$_a.yAg=
jd.pHa.getActivityIndicatorTooltipManager();Gg.a(jd.$);jd.pHa.getWywaEvent().addListener(jd.wFf);w("InitializeCatchUpApp");jd.pHa.initialize(Object(Gb.a)(new f,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:jd.c7a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:ge.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:jd.scf()}))},this.$.la,3)};Ck.Object.defineProperties(c.prototype,{Scf:{configurable:!0,enumerable:!0,get:function(){var wc=
this.flyoutRibbonButton.zzb;wc&&!this.L7e&&(tb.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.L7e=!0);return wc}},Bgi:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Aef}}});Object(La.a)(c,"CatchUpActivityManager",null,[814,2]);var xg=Va.a;Am(a,xg);a.prototype.create=function(){var wc=this;dc.TaskExtensions.Ba(bb.GetServiceTaskFactory.Ua(this.$.da,458,459,this.ub),function(jd){jd=jd.result;wc.Eb(wc.$.da.Aa(286)||new c(wc.$,wc.ub,
null,jd))},this.$.la,3)};a.ka=function(wc){wc.da.Ga(287,new a(wc))};Object(La.a)(a,"CatchUpActivityManagerFactory",Va.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");ua.a.Fa(ec.ka);ua.a.Fa(Ya.ka);ua.a.Fa(mb.ka);ua.a.Fa(K.ka);ne.a.Li('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){ua.a.Fa(function(wc){kb.ka(wc);ta.ka(wc);cc.ka(wc);sb.ka(wc);nc.ka(wc)})})();Type.registerNamespace("Common.App.CatchUpActivity");ha.main();(function(){ua.a.Fa(function(wc){w("Begin");a.ka(wc);aa.ka(wc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/c76402573c4fd6e41b947a4c2088874e/EwaDS.catchup.js.map