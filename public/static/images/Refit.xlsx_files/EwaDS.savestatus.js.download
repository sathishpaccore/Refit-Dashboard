(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[38],{1463:function(z,E,b){function a(ca){var I=Z.call(this)||this;I.Rc=ca;I.Tb();return I}function c(ca,I){var H=this;this.Nge=this.qLc=!1;this.kza=function(L,U){(null===U||void 0===U?0:U.sH)&&Q.a.PLg([U.sH])&&(H.gvc=!0)};this.Io=function(){H.gvc=!1};this.qd=function(L,U){R.b(U)&&H.Wea(!0);H.gvc=!1};this.zd=function(){H.yR=H.$.yR;H.Wea()};this.SCf=function(){H.lT()};this.UBf=function(){H.yR=H.$.yR};this.zAd=function(){ea.g(H.$).Ea.Fv(H.zAd);
H.yR=H.$.yR};this.sWf=I;this.$=ca;this.$.userOperationManager.Wu(this.UBf);this.$.tl(this.zd);this.$.ea.xHg(this.SCf);this.$.ea.gk(this.qd);this.$.SZb(this.kza);this.$.ea.vM(this.Io);this.Wea()}function e(){this.$Qc=this.cQc=this.Zlb=this.tb=null}function f(ca,I,H,L){this.Ega=this.xga=this.Iga=this.Hga=null;this.BEa=0;this.hE=this.ZQc=this.VCa=this.KFc=this.xFa=null;this.Xd=ca;this.u9=I;this.j2=H;this.lj=L;this.p$d=!0;this.kM=!1;this.nA=3;this.Bra=!0}function m(ca,I){this.ms=null;this.Hga=CommonUIStrings.l_SavedStatus;
this.Iga=CommonUIStrings.l_SavingStatus;this.xga=CommonUIStrings.l_ReadOnlyStatus;this.Ega=CommonUIStrings.l_ReviewModeStatus;this.oTb=I;this.j2=ca;this.nA=3;this.Bra=!0}function n(ca){this.Ega=this.xga=this.Iga=this.Hga=null;this.A8d=this.Pae=this.vx=this.kM=!1;this.mQc=this.dbe=null;this.Wae=0;this.vb=this.bbe=null;this.j2=ca;this.nA=3;this.Ijb=!0}b.r(E);z=b(0);var w=b(82),h=b(14),y=b(176),r=b(39);n.prototype.initialize=function(ca,I,H){var L=this;this.Hga=this.jhd(ca,I);this.Iga=CommonUIStrings.l_SavingStatus;
this.xga=CommonUIStrings.l_ReadOnlyStatus;this.Ega=CommonUIStrings.l_ReviewModeStatus;this.j2&&this.j2.execute(function(U){U.XVc(Object(w.a)(L,L.LOb,"updateToSavingStatus"))});this.vx=!0;this.vb=H;return!0};n.prototype.Wea=function(ca,I){this.kM=ca;this.nA=I;this.lT(this.Ijb)};n.prototype.lT=function(ca){!this.Ijb&&ca&&(this.bbe=new Date);this.Ijb=ca;ca=null;3===this.nA&&(ca=this.Ijb?this.Hga:this.Iga);this.Bgh(ca)};n.prototype.jhd=function(ca,I){return ca?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):I&&I.length?String.format(CommonUIStrings.l_SavedToStatus,I):CommonUIStrings.l_SavedStatus};n.prototype.LOb=function(){this.lT(!1)};n.prototype.STh=function(){switch(this.nA){case 1:return this.xga;case 2:return this.Ega;default:return null}};n.prototype.Qhi=function(ca){return this.Pae===this.kM&&this.Wae===this.nA&&this.dbe===ca};n.prototype.m7c=function(ca){var I=this;appChrome.getHeaderApi().then(function(H){H.updateDocumentTitleStatus(I.kM,ca,I.STh(),I.bbe,I.Ijb);
I.A8d=!0;return null});this.mQc=null};n.prototype.Bgh=function(ca){var I=this;this.vx&&y.c()&&!this.Qhi(ca)&&(!this.A8d&&this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.m7c(ca):r.a.rTf()?(this.mQc&&h.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.mQc=window.requestIdleCallback(function(){I.m7c(ca)})):window.requestAnimationFrame(function(){I.m7c(ca)}),this.Pae=this.kM,this.dbe=ca,this.Wae=
this.nA)};Object(z.a)(n,"ReactSaveStatusUIHandler",null,[558]);var x=b(167);m.prototype.Ev=function(){var ca=this;this.j2&&this.j2.execute(function(I){I.XVc(Object(w.a)(ca,ca.LOb,"updateToSavingStatus"))});this.oTb.execute(function(I){ca.ms=I})};m.prototype.Wea=function(ca,I){this.nA=I;3===I?this.lT(this.Bra):2===I?this.qYd(this.Ega):this.qYd(this.xga)};m.prototype.LOb=function(){this.lT(!1)};m.prototype.lT=function(ca){this.Bra=ca;this.qYd(this.Bra?this.Hga:this.Iga)};m.prototype.qYd=function(ca){this.ms&&
this.ms.Jj(x.a.TOj,this.p2g(ca))};m.prototype.p2g=function(ca){var I={};I.StatusText=ca;return I};Object(z.a)(m,"SaveStatusPostMessageHandler",null,[558]);var t=b(94),u=b(122),B=b(57);f.prototype.initialize=function(ca,I){if(!this.Xd)return!1;this.Hga=this.jhd(ca,I);this.Iga=CommonUIStrings.l_SavingStatus;this.xga=CommonUIStrings.l_ReadOnlyStatus;this.Ega=CommonUIStrings.l_ReviewModeStatus;this.Ev();return!0};f.prototype.jhd=function(ca,I){return ca?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
I&&I.length?String.format(CommonUIStrings.l_SavedToStatus,I):CommonUIStrings.l_SavedStatus};f.prototype.Ev=function(){var ca=this;this.u9&&this.u9.execute(function(I){I.XGg(Object(w.a)(ca,ca.TFe,"createStatusAndModeElements"));I.OGg(Object(w.a)(ca,ca.WAj,"showHideSaveStatusElement"));I.PLj&&ca.TFe(null,null)});this.j2&&this.j2.execute(function(I){I.XVc(Object(w.a)(ca,ca.LOb,"updateToSavingStatus"))})};f.prototype.Vv=function(){this.hE&&this.Xd&&this.Xd.yG(this.hE)};f.prototype.WAj=function(ca,I){this.Wea("true"===
I,this.nA)};f.prototype.Wea=function(ca,I){this.kM=ca;this.nA=I;this.KFc&&(this.KFc.style.display=this.kM||3===this.nA||!this.xFa?"none":"");this.VCa&&(this.VCa.style.display=this.kM||3===this.nA?"none":"",this.VCa.innerText=1===this.nA?this.xga:this.Ega,this.VCa.title=1===this.nA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.ZQc&&(this.ZQc.style.display=this.kM||1===this.nA||!this.xFa&&!this.VCa?"none":"");this.hE&&(this.hE.style.display=this.kM||1===this.nA?
"none":"",this.lT(this.Bra),this.hE.title=CommonUIStrings.l_SaveStatusTooltip)};f.prototype.TFe=function(ca,I){ca=document.getElementById(t.CuiHelper.J8e);I&&I.TXj||!ca||""===this.Hga||""===this.Iga||""===this.xga||""===this.Ega||(this.xFa=document.getElementById(t.CuiHelper.h1b),this.KFc=t.CuiHelper.Dta(ca,"BreadcrumbAppModeDash","-",null,!1),this.VCa=t.CuiHelper.Dta(ca,"BreadcrumbAppModeStatus",1===this.nA?this.xga:this.Ega,null,!1),this.Adg(this.VCa),this.ZQc=t.CuiHelper.Dta(ca,"BreadcrumbSaveStatusDash",
"-",null,!1),this.hE=t.CuiHelper.Dta(ca,"BreadcrumbSaveStatus",this.Hga,null,!1),this.Adg(this.hE),this.Wea(this.kM,this.nA))};f.prototype.LOb=function(){this.lT(!1)};f.prototype.lT=function(ca){this.Bra=ca;this.KTj(this.Bra?this.Hga:this.Iga)};f.prototype.KTj=function(ca){!this.hE||3!==this.nA&&2!==this.nA||(this.p$d&&!this.Bra?(this.BEa=this.hE.offsetWidth<this.BEa?this.BEa:this.hE.offsetWidth,this.QQj(this.Iga),this.p$d=!1):this.hE.innerText=ca)};f.prototype.Adg=function(ca){ca.style.direction=
this.lj?"rtl":"ltr";ca.style.width="auto";ca.style.textAlign=this.lj?"right":"left";ca.style.display=this.kM?"none":"";ca.setAttribute("Unselectable","on")};f.prototype.QQj=function(ca){this.hE&&(this.hE.style.width="",this.hE.innerText=ca,this.BEa=this.hE.offsetWidth<this.BEa?this.BEa:this.hE.offsetWidth,ca=u.a.mB(this.hE),this.hE.style.width=this.BEa-B.a.rD(ca.paddingLeft)-B.a.rD(ca.paddingRight)+1+"px")};Object(z.a)(f,"SaveStatusUIHandler",null,[558]);var v=b(4),C=b(93);e.prototype.fi=function(ca){var I=
this;this.tb=ca;v.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&v.AFrameworkApplication.hideHeaderEmbedded?this.tb.register(m,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ic().Oc(function(){return new m(I.tb.lc("Common.App.HostNotification.EditNotificationEventSource"),I.tb.lc("Postmessage.IHostPostmessenger"))}):v.AFrameworkApplication.sa.Pa.qif||(v.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled?this.tb.register(n,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ic().Oc(function(){return new n(I.tb.lc("Common.App.HostNotification.EditNotificationEventSource"))}):
this.tb.register(f,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ic().Oc(function(){return new f(C.EventHandlerManager.instance,I.tb.lc("Common.App.Header.HeaderEventSource"),I.tb.lc("Common.App.HostNotification.EditNotificationEventSource"),v.AFrameworkApplication.isRtl)}))};e.prototype.init=function(){v.AFrameworkApplication.ga.tv(Object(w.a)(this,this.FB,"onFullAppSettingsReady"))};e.prototype.FB=function(){var ca=v.AFrameworkApplication.ga,I=!!v.AFrameworkApplication.sa.Pa&&
4===v.AFrameworkApplication.sa.Pa.Sj;if(ca.ra("WordEditorAutoSaveImprovementIsEnabled")||ca.ra("PptEditorSaveStatusInHeaderEnabled")||I&&ca.ra("SimplifiedReactRibbonUxIsEnabled")||ca.ra("ExcelSaveStatusInHeaderEnabled")||ca.ra("VisioSaveStatusInHeaderEnabled"))v.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&v.AFrameworkApplication.hideHeaderEmbedded?(this.$Qc=this.tb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.$Qc.Ev():v.AFrameworkApplication.sa.Pa.qif||(v.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled?
(this.cQc=this.tb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.cQc.initialize(ca.ra("IsSkyDrive"),ca.Va("HostNameToIncludeInSavedStatus"),v.AFrameworkApplication.ga):(this.Zlb=this.tb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.Zlb.initialize(ca.ra("IsSkyDrive"),ca.Va("HostNameToIncludeInSavedStatus")))};e.prototype.dispose=function(){this.Zlb&&this.Zlb.Vv()};Ck.Object.defineProperties(e.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});
Object(z.a)(e,"PackageManager",null,[4,5]);E=b(255);var A=b(11),M=b(85),T=b(226),R=b(229),Q=b(30),ea=b(21);c.prototype.dispose=function(){this.$&&(this.$.Ul(this.zd),this.$.stc(this.kza),this.$.userOperationManager&&this.$.userOperationManager.Cr(this.UBf),this.$.ea&&(this.$.ea.Idj(this.SCf),this.$.ea.Fk(this.qd),this.$.ea.AS(this.Io)),ea.g(this.$)&&ea.g(this.$).Ea&&ea.g(this.$).Ea.Fv(this.zAd))};c.prototype.Wea=function(ca){ca=!this.$.isEditMode||(void 0===ca?!1:ca);this.sWf.Wea(ca,this.$.isEditMode?
3:1);this.lT()};c.prototype.lT=function(){this.$.isEditMode&&this.sWf.lT(!this.yR&&!this.Gri&&!this.gvc)};Ck.Object.defineProperties(c.prototype,{Gri:{configurable:!0,enumerable:!0,get:function(){return this.$.ea?this.$.ea.Lkf:!1}},yR:{configurable:!0,enumerable:!0,get:function(){return this.qLc},set:function(ca){ca?this.qLc=!0:ea.g(this.$)&&ea.g(this.$).Ea&&(ea.g(this.$).Ea.y_()?this.qLc=!1:ea.g(this.$).Ea.Ix(this.zAd));this.lT()}},gvc:{configurable:!0,enumerable:!0,get:function(){return this.Nge},
set:function(ca){this.Nge=ca;this.lT()}}});Object(z.a)(c,"SaveStatusManager",null,[2]);var Z=T.a;Am(a,Z);a.prototype.create=function(){var ca=this,I=M.a.instance;I.lc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(H){var L=new c(ca.Rc,H);I.register(c,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Ic().Oc(function(){return L});ca.Eb(I.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};a.ka=function(ca){ca.da.Ga(299,new a(ca))};Object(z.a)(a,
"SaveStatusFactory",T.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");E.a.instance.hj(new e);A.a.Fa(a.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/cb9fcb57e767d5c0bc316474cc10c46f/EwaDS.savestatus.js.map